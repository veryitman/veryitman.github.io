<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Ruby on Rails å®è·µï¼šæ›´æ¢ aloe é¦–é¡µ</title>
      <link href="/2022/11/13/Ruby-on-Rails-%E5%AE%9E%E8%B7%B5%EF%BC%9A%E6%9B%B4%E6%8D%A2-aloe-%E9%A6%96%E9%A1%B5/"/>
      <url>/2022/11/13/Ruby-on-Rails-%E5%AE%9E%E8%B7%B5%EF%BC%9A%E6%9B%B4%E6%8D%A2-aloe-%E9%A6%96%E9%A1%B5/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åœ¨ <a href="https://veryitman.com/2022/09/04/Ruby-on-Rails-%E5%AE%9E%E8%B7%B5%EF%BC%9A%E5%88%9B%E5%BB%BA-aloe-%E9%A1%B9%E7%9B%AE/">Ruby on Rails å®è·µè¯¾ç¨‹ï¼šåˆ›å»º aloe é¡¹ç›®</a> ä¸­æˆ‘ä»¬å·²ç»çœ‹åˆ°äº† Rails è·‘èµ·æ¥çš„æ ·å­ï¼Œæˆªè‡³åˆ°ç›®å‰æˆ‘ä»¬è¿˜æ²¡æœ‰å†™ä¸€è¡Œä»£ç ï¼Œåªæ˜¯ç®€å•çš„æ‰§è¡Œäº†å‡ ä¸ªå‘½ä»¤ï¼Œé¡¹ç›®å°±è·‘èµ·æ¥äº†ã€‚æ˜¯ä¸æ˜¯ç®€å•åœ°ä»¤äººå‘æŒ‡ ğŸ˜„</p><p>åœ¨æœ¬ç¯‡ä¸­ï¼Œæœ‹å‹ä»¬å¯ä»¥äº†è§£åˆ°ï¼š</p><ul><li>å¦‚ä½•é€šè¿‡ rails g åˆ›å»ºæ§åˆ¶å™¨ï¼Ÿ</li><li>å¦‚ä½•é€šè¿‡ rails routes æŸ¥çœ‹æ§åˆ¶å™¨çš„è·¯ç”±ï¼Ÿ</li><li>å¦‚ä½•ä¿®æ”¹å·¥ç¨‹çš„è·¯ç”±é…ç½®ï¼Ÿ</li><li>ERB æ–‡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ</li></ul><p>æ¥ä¸‹æ¥æˆ‘ä»¬ç»™ <code>aloe</code> æ¢ä¸ªé¦–é¡µï¼Œè®©å®ƒæ˜¾ç¤º â€œHello aloeâ€ã€‚</p><h2 id="æ”¹å¤´æ¢é¢"><a href="#æ”¹å¤´æ¢é¢" class="headerlink" title="æ”¹å¤´æ¢é¢"></a>æ”¹å¤´æ¢é¢</h2><h3 id="1ã€åˆ›å»ºæ§åˆ¶å™¨"><a href="#1ã€åˆ›å»ºæ§åˆ¶å™¨" class="headerlink" title="1ã€åˆ›å»ºæ§åˆ¶å™¨"></a>1ã€åˆ›å»ºæ§åˆ¶å™¨</h3><p>åŒç†ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨ rails å‘½ä»¤åˆ›å»ºä¸€ä¸ª welcome æ§åˆ¶å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails g controller welcome index </span><br></pre></td></tr></table></figure><p>ç”¨ <code>rails g</code>ï¼ˆæ˜¯ <code>rails generate</code> çš„ç®€ç§°ï¼‰å‘½ä»¤åˆ›å»º <code>welcome</code> æ§åˆ¶å™¨çš„åŒæ—¶ä¹Ÿä¸ºå…¶å¢åŠ äº†ä¸€ä¸ª action å³ <code>index</code>ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><blockquote><p>create  app&#x2F;controllers&#x2F;welcome_controller.rb</p><p>route  get â€˜welcome&#x2F;indexâ€™<br>invoke  erb<br>create    app&#x2F;views&#x2F;welcome<br>create    app&#x2F;views&#x2F;welcome&#x2F;index.html.erb<br>invoke  test_unit<br>create    test&#x2F;controllers&#x2F;welcome_controller_test.rb<br>invoke  helper<br>create    app&#x2F;helpers&#x2F;welcome_helper.rb<br>invoke    test_unit</p></blockquote><p><code>index</code> è¿™ä¸ª action ä¹Ÿæ˜¯ rails é‡Œé¢ç»å¸¸è¯´çš„è·¯ç”±ï¼ˆrouteï¼‰ï¼Œå°±ç±»ä¼¼äºä½ åœ¨æµè§ˆå™¨è®¿é—®çš„åœ°å€ä¸€æ ·ã€‚</p><p>å¯è§ï¼Œæ‰§è¡Œ <code>rails g</code> å‘½ä»¤åï¼Œä¸ä»…å¸®æˆ‘ä»¬åˆ›å»ºäº†æ§åˆ¶å™¨ä¹Ÿåˆ›å»ºäº†å¯¹åº”çš„è§†å›¾æ–‡ä»¶ã€‚</p><h3 id="2ã€è·¯ç”±"><a href="#2ã€è·¯ç”±" class="headerlink" title="2ã€è·¯ç”±"></a>2ã€è·¯ç”±</h3><p>åœ¨è¿›è¡Œæ¥ä¸‹æ¥çš„æ“ä½œä¹‹å‰ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>rails routes</code> å‘½ä»¤çœ‹ä¸‹å½“å‰æ§åˆ¶å™¨ welcome æœ‰å“ªäº›è·¯ç”±äº†ã€‚</p><blockquote><p><strong>Usage</strong>:</p><p>rails routes [options]</p><p><strong>Options</strong>:</p><p>-c, [â€“controller&#x3D;CONTROLLER]   # Filter by a specific controller, e.g. PostsController or Admin::PostsController.</p><p>-g, [â€“grep&#x3D;GREP]         # Grep routes by a specific pattern.</p><p>-E, [â€“expanded], [â€“no-expanded] # Print routes expanded vertically with parts explained.</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails routes -c WelcomeController</span><br></pre></td></tr></table></figure><blockquote><p><strong>Prefix                        Verb        URI Pattern                            Controller#Action</strong></p><p>welcome_index         GET         &#x2F;welcome&#x2F;index(.:format)        welcome#index</p><p>root                           GET         &#x2F;                                              welcome#index</p></blockquote><p><strong>Verb</strong> æŒ‡çš„æ˜¯ HTTP æ–¹æ³•ã€‚</p><p>ä»ä¸Šé¢ç»“æœå¯ä»¥çœ‹å‡ºï¼Œ<code>WelcomeController</code> æœ‰ä¸¤ä¸ªè·¯ç”±ï¼Œå¯¹åº”çš„ action éƒ½æ˜¯ <code>welcome#index</code>ï¼Œå…¶è·¯ç”±åç§°åˆ†åˆ«ä¸º <code>welcome_index_path</code>ã€<code>root_path</code>ï¼Œåœ¨ä¸‹é¢çš„ erb æ–‡ä»¶ä¸­æˆ‘ä»¬ä¼šç”¨åˆ°è¿™ä¸¤ä¸ªè·¯ç”±åç§°ã€‚</p><p>æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹ <code>config/routes.rb</code> æ–‡ä»¶ï¼Œé…ç½®ä¸€ä¸‹é»˜è®¤é¡µé¢åœ°å€ä¸º <code>welcome#index</code></p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Rails.application.routes.draw <span class="keyword">do</span></span><br><span class="line">  get <span class="string">&#x27;welcome/index&#x27;</span></span><br><span class="line">  <span class="comment"># Define your application routes per the DSL in https://guides.rubyonrails.org/routing.html</span></span><br><span class="line">  <span class="comment"># Defines the root path route (&quot;/&quot;)</span></span><br><span class="line">  root <span class="string">&quot;welcome#index&quot;</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>é‡æ–°å¯åŠ¨ aole æœåŠ¡ï¼ˆ<code>rails s</code>ï¼‰ï¼Œä»æµè§ˆå™¨æ‰“å¼€ <a href="http://127.0.0.1:3000/">http://127.0.0.1:3000/</a></p><p><img src="/upload/2022/11/13/3.png"></p><h3 id="3ã€ERB"><a href="#3ã€ERB" class="headerlink" title="3ã€ERB"></a>3ã€ERB</h3><p>æ‰¾åˆ°å…³äº ERB çš„è§£é‡Šæ˜¯åœ¨ <a href="https://github.com/ruby/erb">github-ruby&#x2F;erb</a> ä¸Šé¢çœ‹åˆ°çš„ï¼Œå®ƒæ˜¯ä¸€ä¸ªç®€å•è€Œå¼ºå¤§çš„ ruby æ¨¡ç‰ˆç³»ç»Ÿï¼ˆ <code>An easy to use but powerful templating system for Ruby</code>ï¼‰ï¼Œå¾ˆå¤šäººè¯´å®ƒæ˜¯ <code>embedded Ruby</code> çš„ç®€ç§°ã€‚</p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° aole å·¥ç¨‹ä¸­çš„ view è§†å›¾æ–‡ä»¶æ˜¯ä»¥ <code>.erb</code> ä¸ºç»“å°¾çš„ï¼Œ <code>.erb</code> çš„æ¨¡æ¿æ–‡ä»¶æ··åˆä½¿ç”¨ ERBï¼ˆåµŒå…¥å¼ Rubyï¼‰å’Œ HTML ç¼–å†™ï¼Œæ‰©å±•åæ˜¯ <code>.builder</code> çš„æ¨¡æ¿æ–‡ä»¶ä½¿ç”¨ <code>Builder::XmlMarkup</code> åº“ç¼–å†™ã€‚</p><p>åœ¨ ERB æ¨¡æ¿ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>&lt;% %&gt;</code> å’Œ <code>&lt;%= %&gt;</code> æ ‡ç­¾æ¥åŒ…å« Ruby ä»£ç ã€‚</p><ul><li><p><code>&lt;% %&gt;</code> æ ‡ç­¾ç”¨äºæ‰§è¡Œä¸è¿”å›ä»»ä½•å†…å®¹çš„ Ruby ä»£ç ï¼Œä¾‹å¦‚æ¡ä»¶ã€å¾ªç¯æˆ–å—è¯­å¥ï¼›</p></li><li><p><code>&lt;%= %&gt;</code> æ ‡ç­¾ç”¨äºè¾“å‡º Ruby ä»£ç çš„æ‰§è¡Œç»“æœçš„è¯­å¥ï¼›</p></li></ul><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;% ä¸éœ€è¦æ˜¾ç¤ºå‡ºæ¥çš„ï¼ˆå†™é€»è¾‘è„šæœ¬(Rubyè¯­æ³•) ï¼‰ %&gt;</span><br><span class="line">&lt;%= éœ€è¦æ˜¾ç¤ºå‡ºæ¥çš„ï¼ˆå˜é‡å€¼æˆ–è¿ç®—ç»“æœï¼‰ %&gt;</span><br><span class="line">&lt;<span class="string">%- åˆ é™¤å‰é¢çš„ç©ºæ ¼  %&gt; </span></span><br><span class="line"><span class="string">&lt;% åˆ é™¤åé¢çš„ç©ºæ ¼ -</span>%&gt; </span><br><span class="line">&lt;<span class="string">%- åˆ é™¤å‰åçš„ç©ºæ ¼ -</span>%&gt; </span><br></pre></td></tr></table></figure><p>ä¸¾ä¸ªå®é™…çš„ä¾‹å­</p><figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">&lt;%</span><span class="language-ruby"> <span class="keyword">unless</span> logged_in? </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&lt;%=</span></span></span><span class="language-ruby"> new_user_path </span><span class="language-xml"><span class="tag"><span class="string">%&gt;&quot;</span>&gt;</span>æ³¨å†Œ<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&lt;%=</span></span></span><span class="language-ruby"> new_session_path </span><span class="language-xml"><span class="tag"><span class="string">%&gt;&quot;</span>&gt;</span>ç™»å½•<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  &lt;%</span><span class="language-ruby"> <span class="keyword">else</span> </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>æ¬¢è¿ &lt;%=</span><span class="language-ruby"> current_user.username </span><span class="language-xml">%&gt;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="comment">&lt;!--link_to åœ¨ä½¿ç”¨ delete æ–¹æ³•æ—¶æ€»æ˜¯è¢«å¼ºåˆ¶å»ä½¿ç”¨ get æ–¹æ³•--&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>&lt;%=</span><span class="language-ruby"> link_to <span class="string">&#x27;é€€å‡º&#x27;</span>, logout_path, <span class="symbol">method:</span> <span class="symbol">:delete</span> </span><span class="language-xml">%&gt;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">&lt;%</span><span class="language-ruby"> <span class="keyword">end</span> </span><span class="language-xml">-%&gt;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹ <code>aloe/app/views/welcome/index.html.erb</code> æ–‡ä»¶ä¿å­˜ï¼Œå†…å®¹å¦‚ä¸‹</p><figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>aole<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello aole<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&lt;%=</span></span></span><span class="language-ruby"> welcome_index_path </span><span class="language-xml"><span class="tag"><span class="string">%&gt;&quot;</span>&gt;</span>æ‚¨å¥½ï¼Œaole<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&lt;%=</span></span></span><span class="language-ruby"> root_path </span><span class="language-xml"><span class="tag"><span class="string">%&gt;&quot;</span>&gt;</span>è¿”å›<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>ä¸éœ€è¦é‡å¯ aole æœåŠ¡ï¼Œåˆ·æ–°æµè§ˆå™¨å¦‚ä¸‹å›¾æ‰€ç¤º</p><p><img src="/upload/2022/11/13/1.png"></p><p>ç»è¿‡ç®€å•çš„æ”¹é€ ï¼Œæˆ‘ä»¬çš„ aole é¦–é¡µè¢«æ”¹å˜äº†ã€‚ç‚¹å‡»â€œæ‚¨å¥½ï¼Œaoleâ€ï¼Œé¡µé¢æ˜¾ç¤ºçš„å†…å®¹ç›¸åŒæ˜¯ä½†åœ°å€æ çš„åœ°å€å˜äº†ã€‚</p><p><img src="/upload/2022/11/13/2.png"></p><p>è·¯ç”±ã€è§†å›¾æ˜¯ rails ä¸­æ¯”è¾ƒé‡è¦çš„å†…å®¹ï¼Œåç»­æˆ‘ä¹Ÿä¼šä¸“é—¨æ¥å†™è¿™ä¸¤å—çš„å†…å®¹ã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://ruby-china.github.io/rails-guides/action_view_overview.html">Action View å­¦ä¹ å‘å¯¼</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Ruby-on-Rails </category>
          
      </categories>
      
      
        <tags>
            
            <tag> railsâ€˜s routes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOS Install Passenger for ROR</title>
      <link href="/2022/11/06/CentOS-Install-Passenger-for-ROR/"/>
      <url>/2022/11/06/CentOS-Install-Passenger-for-ROR/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æœ¬ç¯‡æ–‡ç« æ¶‰åŠåˆ°çš„å†…å®¹éƒ½æ˜¯åŸºäºé˜¿é‡Œäº‘ä¸»æœºä¸Šé¢æ“ä½œçš„ï¼Œå…·ä½“ç³»ç»Ÿå’Œè½¯ä»¶ç‰ˆæœ¬å¦‚ä¸‹ï¼š</p><ul><li>CentOS<ul><li>LSB Version:    :core-4.1-amd64:core-4.1-noarch</li><li>Distributor ID: CentOS</li><li>Description:    CentOS Linux release 7.9.2009 (Core)</li><li>Release:          7.9.2009</li><li>Codename:     Core</li></ul></li><li>Rubyï¼š2.7.4</li><li>Railsï¼š7.0.4</li><li>Nginxï¼š1.20.1ï¼Œäº‘æœåŠ¡å·²ç»é»˜è®¤å®‰è£…äº†</li><li>Passengerï¼šPhusion Passenger(R) 6.0.15</li></ul><p>æœ¬ç¯‡æ–‡ç« ä¸»è¦ç›®çš„ï¼š</p><ul><li>å¦‚ä½•åœ¨ CentOS ä¸Šå®‰è£… Passenger</li><li>å¦‚ä½•é€šè¿‡ Passenger è¿è¡Œã€è®¿é—® ruby on rails åº”ç”¨</li></ul><h2 id="å®‰è£…-ruby"><a href="#å®‰è£…-ruby" class="headerlink" title="å®‰è£… ruby"></a>å®‰è£… ruby</h2><p>å¦‚æœç›´æ¥ä½¿ç”¨ <code>yum install -y ruby</code> å®‰è£… rubyï¼Œå…¶ç‰ˆæœ¬æ˜¯ 2.0.xï¼Œè€Œæˆ‘éœ€è¦å®‰è£… 2.7.x ç‰ˆæœ¬ã€‚</p><p>æˆåŠŸå®‰è£… ruby æ˜¯æ¥ä¸‹æ¥ä¸€åˆ‡æ“ä½œçš„åŸºç¡€ï¼Œä½¿ç”¨ <strong>root</strong> è´¦å·ç™»å½•äº‘ä¸»æœºï¼ŒæŒ‰ç…§ä¸‹é¢æ­¥éª¤æ“ä½œå³å¯ã€‚å¦‚æœä½¿ç”¨é root è´¦å·å®‰è£…ï¼Œéœ€è¦åœ¨ä¸‹é¢å‘½ä»¤å‰åŠ  sudoã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">å®‰è£…æº</span></span><br><span class="line">yum install centos-release-scl-rh</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">å®‰è£… ruby-devel</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">è¿™é‡Œä¸€å®šè¦å’Œ ruby ç‰ˆæœ¬å¯¹ä¸Šï¼Œå¦åˆ™åé¢å®‰è£… gems ä¼šæŠ¥é”™</span></span><br><span class="line">yum install rh-ruby27-ruby-devel</span><br><span class="line"></span><br><span class="line">yum install ruby</span><br></pre></td></tr></table></figure><p>æ£€æŸ¥ ruby ç‰ˆæœ¬ï¼Œå¦‚æœä¸æ˜¯ <code>ruby-2.7</code>ï¼Œå¯ä»¥é‡æ–°æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y rh-ruby27</span><br></pre></td></tr></table></figure><p>å®‰è£…å®Œæˆåï¼Œæ‰§è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scl enable rh-ruby27</span><br></pre></td></tr></table></figure><p>é…ç½®å¼€æœºè‡ªåŠ¨åˆ‡æ¢åˆ° ruby27ï¼Œæ–°å»ºå¹¶ç¼–è¾‘æ–‡ä»¶</p><p>vim &#x2F;etc&#x2F;profile.d&#x2F;rh-ruby27.sh</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">source /opt/rh/rh-ruby27/enable</span><br><span class="line">export X_SCLS=&quot;`scl enable rh-ruby27 &#x27;echo $X_SCLS&#x27;`&quot;</span><br></pre></td></tr></table></figure><p>å®‰è£…åçš„ ruby åœ¨ <code>/opt/rh/rh-ruby27/root/usr/bin/ruby</code> ä¸‹ã€‚</p><h2 id="å®‰è£…-rails"><a href="#å®‰è£…-rails" class="headerlink" title="å®‰è£… rails"></a>å®‰è£… rails</h2><p>å®‰è£… ruby ç¨å¾®éº»çƒ¦ä¸€ç‚¹ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å®‰è£… rails</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gem install rails</span><br><span class="line"></span><br><span class="line">gem install bundler</span><br></pre></td></tr></table></figure><p>æˆ‘åœ¨å®‰è£… rails é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼ˆæŠ¥é”™ï¼‰</p><blockquote><p>gem install rails<br>Building native extensions. This could take a whileâ€¦<br>ERROR:  Error installing rails:<br>     ERROR: Failed to build gem native extension.</p><p> current directory: &#x2F;opt&#x2F;rh&#x2F;rh-ruby27&#x2F;root&#x2F;usr&#x2F;local&#x2F;share&#x2F;gems&#x2F;gems&#x2F;racc-1.6.0&#x2F;ext&#x2F;racc&#x2F;cparse<br>&#x2F;opt&#x2F;rh&#x2F;rh-ruby27&#x2F;root&#x2F;usr&#x2F;bin&#x2F;ruby -I &#x2F;opt&#x2F;rh&#x2F;rh-ruby27&#x2F;root&#x2F;usr&#x2F;share&#x2F;rubygems -r .&#x2F;siteconf20221029-17728-1uvh5rb.rb extconf.rb<br>mkmf.rb canâ€™t find header files for ruby at &#x2F;opt&#x2F;rh&#x2F;rh-ruby27&#x2F;root&#x2F;usr&#x2F;share&#x2F;include&#x2F;ruby.h</p><p>You might have to install separate package for the ruby development<br>environment, ruby-dev or ruby-devel for example.</p><p>extconf failed, exit code 1</p><p>Gem files will remain installed in &#x2F;opt&#x2F;rh&#x2F;rh-ruby27&#x2F;root&#x2F;usr&#x2F;local&#x2F;share&#x2F;gems&#x2F;gems&#x2F;racc-1.6.0 for inspection.<br>Results logged to &#x2F;opt&#x2F;rh&#x2F;rh-ruby27&#x2F;root&#x2F;usr&#x2F;local&#x2F;lib64&#x2F;gems&#x2F;ruby&#x2F;racc-1.6.0&#x2F;gem_make.out</p></blockquote><p>å¸è½½å·²ç»å®‰è£…çš„ ruby-develï¼Œä¸€èˆ¬éƒ½æ˜¯å…¶ç‰ˆæœ¬å’Œ ruby ç‰ˆæœ¬ä¸ä¸€è‡´å¯¼è‡´çš„ï¼Œé‡æ–°å®‰è£…å¯¹åº”ç‰ˆæœ¬ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">å®‰è£…æº</span></span><br><span class="line">yum install centos-release-scl-rh</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">å®‰è£… ruby-devel</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">è¿™é‡Œä¸€å®šè¦å’Œ ruby ç‰ˆæœ¬å¯¹ä¸Šï¼Œå¦åˆ™åé¢å®‰è£… gems ä¼šæŠ¥é”™</span></span><br><span class="line">yum install rh-ruby27-ruby-devel</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…-Passenger"><a href="#å®‰è£…-Passenger" class="headerlink" title="å®‰è£… Passenger"></a>å®‰è£… Passenger</h2><p>å®‰è£… Passenger æ¯”è¾ƒç®€å•ï¼Œå¦‚æœä½ ä¸æ˜¯ä½¿ç”¨ <strong>root</strong> è´¦å·ç™»å½•ï¼Œä¸‹é¢å‘½ä»¤éœ€è¦åŠ ä¸Š <strong>sudo</strong>ã€‚</p><h3 id="1ã€enable-EPEL"><a href="#1ã€enable-EPEL" class="headerlink" title="1ã€enable EPEL"></a>1ã€enable EPEL</h3><blockquote><p>EPELï¼šExtra Packages for Enterprise Linux </p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum install -y yum-utils</span><br><span class="line">yum install -y https://dl.fedoraproject.org/pub/epel/epel-release-latest-$(&lt; /etc/redhat-release tr -dc &#x27;0-9.&#x27;|cut -d \. -f1).noarch.rpm</span><br><span class="line">yum-config-manager --enable epel</span><br><span class="line">yum clean all &amp;&amp; sudo yum update -y</span><br></pre></td></tr></table></figure><h3 id="2ã€repair-potential-system-issues"><a href="#2ã€repair-potential-system-issues" class="headerlink" title="2ã€repair potential system issues"></a>2ã€repair potential system issues</h3><blockquote><p>é¿å…åœ¨å®‰è£… Passenger æ—¶ï¼Œç”±äºä¸€äº›ç³»ç»Ÿé™åˆ¶å¯¼è‡´å®‰è£…å¤±è´¥</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">Ensure curl and nss/openssl are sufficiently up-to-date to talk to the repo</span></span><br><span class="line">yum update -y</span><br><span class="line"></span><br><span class="line">date</span><br><span class="line"><span class="meta"># </span><span class="language-bash"><span class="keyword">if</span> the output of <span class="built_in">date</span> is wrong, please follow these instructions to install ntp</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">è¿™é‡Œè¦æ³¨æ„ï¼Œæ£€æŸ¥ç³»ç»Ÿæ—¶é—´æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœä¸æ­£ç¡®éœ€è¦å…ˆè°ƒæ•´å¥½å†æ‰§è¡Œä¸‹é¢æ­¥éª¤</span></span><br><span class="line"></span><br><span class="line">yum install -y ntp</span><br><span class="line">chkconfig ntpd on</span><br><span class="line">ntpdate pool.ntp.org</span><br><span class="line">service ntpd start</span><br><span class="line"></span><br><span class="line">yum -y install chrony</span><br><span class="line">systemctl enable chronyd</span><br><span class="line">firewall-cmd --permanent --add-service=ntp</span><br><span class="line">firewall-cmd --reload</span><br><span class="line">systemctl restart chronyd</span><br></pre></td></tr></table></figure><h3 id="3ã€install-Passenger-packages"><a href="#3ã€install-Passenger-packages" class="headerlink" title="3ã€install Passenger packages"></a>3ã€install Passenger packages</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">Install various prerequisites</span></span><br><span class="line">yum install -y  curl</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">Add our el9 YUM repository</span></span><br><span class="line">curl --fail -sSLo /etc/yum.repos.d/passenger.repo https://oss-binaries.phusionpassenger.com/yum/definitions/el-passenger.repo</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">Install Passenger dynamic Nginx module</span></span><br><span class="line">yum install -y nginx-mod-http-passenger || &#123; yum-config-manager --enable cr &amp;&amp; yum install -y nginx-mod-http-passenger ; &#125;</span><br></pre></td></tr></table></figure><h3 id="4ã€restart-Nginx"><a href="#4ã€restart-Nginx" class="headerlink" title="4ã€restart Nginx"></a>4ã€restart Nginx</h3><blockquote><p>é‡å¯ nginx</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart nginx</span><br></pre></td></tr></table></figure><h3 id="5ã€check-installation"><a href="#5ã€check-installation" class="headerlink" title="5ã€check installation"></a>5ã€check installation</h3><blockquote><p>æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /usr/bin/passenger-config validate-install</span><br></pre></td></tr></table></figure><p>æ˜¾ç¤ºå¦‚ä¸‹ä¿¡æ¯è¡¨ç¤ºæˆåŠŸ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* Checking whether this Phusion Passenger install is in PATH... âœ“</span><br><span class="line">* Checking whether there are no other Phusion Passenger installations... âœ“</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤çœ‹ä¸‹è¿è¡ŒçŠ¶æ€</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /usr/sbin/passenger-memory-stats</span><br></pre></td></tr></table></figure><p>æ˜¾ç¤ºç±»ä¼¼å¦‚ä¸‹çŠ¶æ€è¡¨ç¤ºæ­£å¸¸</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Version: 6.0.15</span><br><span class="line"></span><br><span class="line">--------- Nginx processes ---------</span><br><span class="line">PID   PPID  VMSize   Private  Name</span><br><span class="line">-----------------------------------</span><br><span class="line">5672  1     44.1 MB  0.8 MB   nginx: master process nginx</span><br><span class="line">8713  5672  44.3 MB  1.0 MB   nginx: worker process</span><br><span class="line">8714  5672  44.3 MB  1.0 MB   nginx: worker process</span><br><span class="line"></span><br><span class="line">----- Passenger processes -----</span><br><span class="line">PID   VMSize     Private  Name</span><br><span class="line">-------------------------------</span><br><span class="line">8699  355.5 MB   2.2 MB   Passenger watchdog</span><br><span class="line">8703  1117.0 MB  4.3 MB   Passenger core</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼ŒPassenger å®‰è£…å®Œæˆã€‚</p><h2 id="åˆ›å»º-ROR-åº”ç”¨"><a href="#åˆ›å»º-ROR-åº”ç”¨" class="headerlink" title="åˆ›å»º ROR åº”ç”¨"></a>åˆ›å»º ROR åº”ç”¨</h2><p>é€šè¿‡ rails åˆ›å»ºåº”ç”¨æ¯”è¾ƒç®€å•ï¼Œåœ¨è¿™ä¸€æ­¥æˆ‘æ˜¯ç”¨é root è´¦å·åˆ›å»ºçš„å³æ™®é€šè´¦å·ï¼ˆptyhï¼‰ åˆ›å»ºçš„åº”ç”¨ã€‚</p><p>æ‚¨å¯ä»¥å»äº†è§£ä¸€ä¸‹å¦‚ä½•åœ¨ CentOS ä¸­æ·»åŠ ç”¨æˆ·ï¼ˆæ·»åŠ ç”¨æˆ·<code>adduser ptyh</code>ã€è®¾ç½®å¯†ç <code>passwd ptyh</code>ï¼‰ã€‚</p><p>åˆ›å»º articles åº”ç”¨ï¼Œå¦‚ä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails new articles</span><br></pre></td></tr></table></figure><p>åˆ›å»ºæˆåŠŸåçš„å·¥ç¨‹ <code>articles</code> åœ¨ç›®å½• <code>/home/ptyh/rails_projs</code> ä¸‹ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å¯åŠ¨ä¸€ä¸‹è¿™ä¸ªå·¥ç¨‹ï¼Œç¡®ä¿å®ƒæœ¬èº«æ˜¯æ­£å¸¸çš„ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails s -b 0.0.0.0 -p 8080</span><br></pre></td></tr></table></figure><p>æˆ‘åœ¨é˜¿é‡Œäº‘ä¸Šé¢æ˜¯å¼€æ”¾äº† 8080 ç«¯å£çš„ï¼Œè¿™æ ·ä½ å¯ä»¥é€šè¿‡ <code>äº‘ä¸»æœºå…¬ç½‘IP:8080</code> è®¿é—®åˆ°ï¼Œçœ‹åˆ°å¦‚ä¸‹ç•Œé¢è¡¨ç¤ºæˆåŠŸã€‚</p><p><img src="/upload/2022/11/06/1.png"></p><p>ç¡®ä¿æ‚¨çš„å·¥ç¨‹è¿è¡Œå’Œè®¿é—®æ²¡æœ‰é—®é¢˜åï¼Œ<strong>åœæ­¢è¯¥æœåŠ¡çš„è¿è¡Œ</strong>ï¼ˆctrl+cï¼‰ã€‚</p><p>æˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹ï½</p><h2 id="é…ç½®-Nginx-Passenger"><a href="#é…ç½®-Nginx-Passenger" class="headerlink" title="é…ç½® Nginx + Passenger"></a>é…ç½® Nginx + Passenger</h2><p>è¿™ä¸€æ­¥è‡³å…³é‡è¦ï¼Œå…³ç³»åˆ°æ˜¯å¦èƒ½é€šè¿‡ passenger æˆåŠŸè¿è¡Œå’Œè®¿é—® ROR åº”ç”¨ã€‚</p><p>æˆ‘ä»¬å»æ£€æŸ¥ä¸€ä¸‹ passenger é…ç½®ï¼Œè¯¥é…ç½®æ–‡ä»¶åœ¨ <code>/etc/nginx/conf.d/passenger.conf </code> ä¸‹ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">passenger_root /usr/share/ruby/vendor_ruby/phusion_passenger/locations.ini;</span><br><span class="line">passenger_ruby /usr/bin/ruby;</span><br><span class="line">passenger_instance_registry_dir /var/run/passenger-instreg;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡º ruby è·¯å¾„ä¸å¯¹ï¼Œä¿®æ”¹å¦‚ä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">passenger_root /usr/share/ruby/vendor_ruby/phusion_passenger/locations.ini;</span><br><span class="line">passenger_ruby /opt/rh/rh-ruby27/root/usr/bin/ruby;</span><br><span class="line">passenger_instance_registry_dir /var/run/passenger-instreg;</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸åšä¿®æ”¹ï¼ˆruby ç‰ˆæœ¬ä¸ä¸€è‡´ï¼‰ï¼Œåç»­åœ¨é€šè¿‡ passenger å¯åŠ¨çš„ ror åº”ç”¨ç¨‹åºä¼šæŠ¥ç±»ä¼¼ <code>cannot load such file -- bundler/setup (LoadError)</code> çš„é”™è¯¯ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é…ç½®ä¸€ä¸‹ nginxï¼Œå…¶é…ç½®æ–‡ä»¶åœ¨ <code>/etc/nginx/nginx.conf</code></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#user nginx;</span></span><br><span class="line"><span class="comment"># ä¿®æ”¹ä¸º nobody</span></span><br><span class="line"><span class="attribute">user</span> nobody;</span><br><span class="line"><span class="attribute">worker_processes</span> auto;</span><br><span class="line"><span class="attribute">error_log</span> /var/log/nginx/<span class="literal">error</span>.log;</span><br><span class="line"><span class="attribute">pid</span> /run/nginx.pid;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load dynamic modules. See /usr/share/doc/nginx/README.dynamic.</span></span><br><span class="line"><span class="attribute">include</span> /usr/share/nginx/modules/<span class="regexp">*.conf</span>;</span><br><span class="line"></span><br><span class="line"><span class="section">events</span> &#123;</span><br><span class="line">    <span class="attribute">worker_connections</span> <span class="number">1024</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">http</span> &#123;</span><br><span class="line">    <span class="attribute">log_format</span>  main  <span class="string">&#x27;<span class="variable">$remote_addr</span> - <span class="variable">$remote_user</span> [<span class="variable">$time_local</span>] &quot;<span class="variable">$request</span>&quot; &#x27;</span></span><br><span class="line">                      <span class="string">&#x27;<span class="variable">$status</span> <span class="variable">$body_bytes_sent</span> &quot;<span class="variable">$http_referer</span>&quot; &#x27;</span></span><br><span class="line">                      <span class="string">&#x27;&quot;<span class="variable">$http_user_agent</span>&quot; &quot;<span class="variable">$http_x_forwarded_for</span>&quot;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">access_log</span>  /var/log/nginx/access.log  main;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">sendfile</span>            <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">tcp_nopush</span>          <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">tcp_nodelay</span>         <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">keepalive_timeout</span>   <span class="number">65</span>;</span><br><span class="line">    <span class="attribute">types_hash_max_size</span> <span class="number">4096</span>;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">include</span>             /etc/nginx/mime.types;</span><br><span class="line">    <span class="attribute">default_type</span>        application/octet-stream;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Load modular configuration files from the /etc/nginx/conf.d directory.</span></span><br><span class="line">    <span class="comment"># See http://nginx.org/en/docs/ngx_core_module.html#include</span></span><br><span class="line">    <span class="comment"># for more information.</span></span><br><span class="line">    <span class="attribute">include</span> /etc/nginx/conf.d/<span class="regexp">*.conf</span>;</span><br><span class="line"></span><br><span class="line">    <span class="section">server</span> &#123;</span><br><span class="line">        <span class="attribute">listen</span>       <span class="number">80</span>;</span><br><span class="line">        <span class="attribute">listen</span>       [::]:<span class="number">80</span>;</span><br><span class="line">        <span class="attribute">server_name</span>  _;</span><br><span class="line">        <span class="comment">#root         /usr/share/nginx/html;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Load configuration files for the default server block.</span></span><br><span class="line">        <span class="attribute">include</span> /etc/nginx/default.d/<span class="regexp">*.conf</span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment"># æ–°å¢1ï¼šæŒ‡å®šç¯å¢ƒå’Œå¼€å¯ passenger</span></span><br><span class="line">        <span class="attribute">passenger_app_env</span> development;</span><br><span class="line">        <span class="attribute">passenger_enabled</span> <span class="literal">on</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ–°å¢2ï¼šæŒ‡å®š rails å·¥ç¨‹çš„ public ç›®å½•</span></span><br><span class="line">        <span class="attribute">root</span> /home/ptyh/rails_projs/articles/public;</span><br><span class="line">       </span><br><span class="line">        <span class="attribute">error_page</span> <span class="number">404</span> /<span class="number">404</span>.html;</span><br><span class="line">        <span class="section">location</span> = /<span class="number">404</span>.html &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="attribute">error_page</span> <span class="number">500</span> <span class="number">502</span> <span class="number">503</span> <span class="number">504</span> /50x.html;</span><br><span class="line">        <span class="section">location</span> = /50x.html &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹çš„åœ°æ–¹åœ¨æ–‡ä»¶ä¸­éƒ½æœ‰æ³¨é‡Šï¼Œä¿®æ”¹å®Œæˆåä¿å­˜ï¼Œè®°å¾—é‡æ–° reload è¯¥é…ç½®æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -s reload</span><br></pre></td></tr></table></figure><h2 id="è®¿é—®-ROR-Web-åº”ç”¨"><a href="#è®¿é—®-ROR-Web-åº”ç”¨" class="headerlink" title="è®¿é—® ROR Web åº”ç”¨"></a>è®¿é—® ROR Web åº”ç”¨</h2><p>åˆ°è¿™é‡Œï¼ŒåŸºæœ¬æå®šäº†ï¼Œè¿˜å‰©æœ€åä¸€å…¬é‡Œï¼Œå†²ã€‚ã€‚ã€‚</p><p>ä¹‹å‰è¯´è¿‡ï¼Œä¿®æ”¹äº† nginx é…ç½®åéœ€è¦é‡æ–° reloadï¼Œå¦å¤–æˆ‘ä»¬ä¸éœ€è¦å•ç‹¬å»å¯åŠ¨ articles è¿™ä¸ªé¡¹ç›®ã€‚</p><p>å¦‚æœæˆ‘çš„äº‘ä¸»æœºå…¬ç½‘IPæ˜¯ 12x.x12.13.10xï¼Œæˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸Šæ‰“å¼€ <a href="http://12x.x12.13.10x:80ï¼Œå¤§æ¦‚ç‡æ˜¯æ— æ³•æ­£å¸¸æ˜¾ç¤ºåº”ç”¨çš„é¦–é¡µçš„ã€‚">http://12x.x12.13.10x:80ï¼Œå¤§æ¦‚ç‡æ˜¯æ— æ³•æ­£å¸¸æ˜¾ç¤ºåº”ç”¨çš„é¦–é¡µçš„ã€‚</a></p><p>æŸ¥çœ‹ nginx error log å¯ä»¥å‘ç°è¿™æ ·çš„é”™è¯¯ï¼š</p><blockquote><p>Error opening â€˜&#x2F;home&#x2F;ptyh&#x2F;rails_projs&#x2F;articles&#x2F;Passengerfile.jsonâ€™ for reading: Permission denied (errno&#x3D;13);<br>This error means that the Nginx worker process (PID 7991, running as UID 99) does not have permission to access this file.<br>Please read this page to learn how to fix this problem:<br><a href="https://www.phusionpassenger.com/library/admin/nginx/troubleshooting/?a=upon-accessing-the-web-app-nginx-reports-a-permission-denied-error">https://www.phusionpassenger.com/library/admin/nginx/troubleshooting/?a=upon-accessing-the-web-app-nginx-reports-a-permission-denied-error</a>; </p></blockquote><p>æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹å·¥ç¨‹ç›®å½•æƒé™ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod -R g+x,o+x /home/ptyh/rails_projects/articles</span><br><span class="line">sudo chmod -R g+x,o+x /home/ptyh/rails_projects</span><br></pre></td></tr></table></figure><p>å†æ¬¡è®¿é—®  <a href="http://12x.x12.13.10x/">http://12x.x12.13.10x:80</a> å³å¯ã€‚</p><h2 id="å…³é”®æ–‡ä»¶"><a href="#å…³é”®æ–‡ä»¶" class="headerlink" title="å…³é”®æ–‡ä»¶"></a>å…³é”®æ–‡ä»¶</h2><p>æˆ‘åœ¨è¿™é‡Œç»™å¤§å®¶ç½—åˆ—ä¸€ä¸‹ç”¨åˆ°çš„é…ç½®æ–‡ä»¶åŠå…¶è·¯å¾„ã€‚</p><p>nginx é…ç½®æ–‡ä»¶ï¼š<code>/etc/nginx/nginx.conf</code></p><p>nginx æ—¥å¿—æ–‡ä»¶ï¼š<code>/var/log/nginx</code></p><p>ruby å¯æ‰§è¡Œæ–‡ä»¶ï¼š <code>/opt/rh/rh-ruby27/root/usr/bin/ruby</code> </p><p>passenger é…ç½®æ–‡ä»¶ï¼š <code>/etc/nginx/conf.d/passenger.conf </code> </p><p>é€šè¿‡ <code>nginx -t</code> å¯ä»¥æ‰¾åˆ° nginx é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œåœ¨å…¶é…ç½®æ–‡ä»¶ä¸­å¯ä»¥çœ‹åˆ°æ—¥å¿—æ–‡ä»¶è·¯å¾„ã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://centos.pkgs.org/7/centos-sclo-rh-x86_64/rh-ruby27-ruby-devel-2.7.1-128.el7.x86_64.rpm.html">centos-ruby-devel</a></li><li><a href="https://www.server-world.info/en/note?os=CentOS_7&p=ruby27">intall ruby27</a></li><li><a href="https://www.phusionpassenger.com/docs/advanced_guides/install_and_upgrade/nginx/install/oss/el9.html">Install Passenger</a></li><li><a href="https://www.phusionpassenger.com/library/admin/nginx/troubleshooting/ruby/#upon-accessing-the-web-app-nginx-reports-a-permission-denied-error">Troubleshooting Passenger + Nginx and Ruby</a></li><li><a href="https://guides.rubyonrails.org/getting_started.html">Getting Started with Rails</a> ä½¿ç”¨ Rails åˆ›å»ºé¡¹ç›®</li></ul>]]></content>
      
      
      <categories>
          
          <category> Ruby-on-Rails </category>
          
      </categories>
      
      
        <tags>
            
            <tag> rails passenger nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ruby on Rails å®è·µï¼šåˆ›å»º aloe é¡¹ç›®</title>
      <link href="/2022/09/04/Ruby-on-Rails-%E5%AE%9E%E8%B7%B5%EF%BC%9A%E5%88%9B%E5%BB%BA-aloe-%E9%A1%B9%E7%9B%AE/"/>
      <url>/2022/09/04/Ruby-on-Rails-%E5%AE%9E%E8%B7%B5%EF%BC%9A%E5%88%9B%E5%BB%BA-aloe-%E9%A1%B9%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<p>åœ¨çœ‹æ­£æ–‡ä¹‹å‰ï¼Œè¯´ä¸€ä¸ªå‘ç”Ÿçš„çœŸå®æ¡ˆä¾‹ã€‚</p><p>äº§å“çš„ä¸šåŠ¡åç«¯æ˜¯ PHP å†™çš„ï¼Œè€Œå…¶ä»–ä¸€äº›åŸºç¡€æœåŠ¡æ˜¯ C++ å¼€å‘çš„ã€‚ä¸å¹¸çš„æ˜¯äº§å“çº¿ä¸Šå‡ºäº†ä¸€ä¸ªäº‹æ•…ï¼ŒåŸå› æ˜¯ PHP å†™çš„ä¸€ä¸ª API å“åº”é€Ÿåº¦è¿‡æ…¢ï¼Œå¯¼è‡´æ•´ä¸ªå®¢æˆ·ç«¯å¡é¡¿ï¼Œå®¢æˆ·ç«¯åŒäº‹æŠ±æ€¨æœåŠ¡ç«¯å†™çš„ API åƒåœ¾ï¼ŒC++ åŒäº‹é„™è§† PHP çš„åŒäº‹ï¼ŒC++ åŒäº‹ç°åœºæ’¸äº†è¿™ä¸ª API å¹¶è¿›è¡Œäº†ä¸¥æ ¼çš„æµ‹è¯•ï¼Œç»“è®ºæ˜¯è¿™ä¸ª API å¦‚æœç”¨ C++ å†™ä¸ç”¨ 5 æ¯«ç§’å°±å¯ä»¥å“åº”ä»»ä½•å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚ä¸€æ—¶é—´é¡¹ç›®ç»„é™·å…¥äº†æ·±åº¦æ€€ç–‘ PHP çš„æ¼©æ¶¡ä¹‹ä¸­ï¼Œä»¿ä½›ç½ªé­ç¥¸é¦–å°±æ˜¯é‚£å¸®å†™ PHP çš„äººä¸€æ ·ã€‚æœ€åå¤ç›˜æ€»ç»“å‘ç°åŸæ¥æ˜¯ä¸šåŠ¡åç«¯æ¶æ„è®¾è®¡ä¸åˆç†å¯¼è‡´çš„è·Ÿç¼–ç¨‹è¯­è¨€æ²¡æœ‰åŠæ¯›é’±å…³ç³»ã€‚</p><p>ç¼–ç¨‹è¯­è¨€ä¹‹é—´ç¡®å®å­˜åœ¨ä¸€å®šçš„é„™è§†é“¾ï¼Œé€‰æ‹©å“ªç§ç¼–ç¨‹è¯­è¨€è¦æå‰åšå¥½è§„åˆ’ï¼Œç»¼åˆç°æœ‰çš„ä¸šåŠ¡åœºæ™¯ã€äººæ‰å‚¨å¤‡æ¥è€ƒè™‘ï¼Œèƒ½è§£å†³å½“ä¸‹é—®é¢˜æ‰æ˜¯ç‹é“ã€‚Ruby ä¸æ˜¯æœ€å¥½çš„ï¼Œä½†å®ƒèƒ½è§£å†³æˆ‘é‡åˆ°çš„é—®é¢˜ï¼Œæˆ‘çŸ¥é“æˆ‘ç›®å‰éœ€è¦å®ƒã€‚</p><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æœ¬æ¬¡è¯¾ç¨‹ä¸»è¦è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹ï¼Œå¦‚ä½•ä½¿ç”¨ rails å‘½ä»¤åˆ›å»ºå·¥ç¨‹ï¼ŒåŒæ—¶å¯ä»¥äº†è§£åˆ°ï¼š</p><ul><li><p>rails å·¥ç¨‹ç›®å½•ä»¥åŠä½œç”¨</p></li><li><p>é…ç½®å’Œä¿®æ”¹ gem æº</p></li></ul><h2 id="åˆ›å»ºé¡¹ç›®"><a href="#åˆ›å»ºé¡¹ç›®" class="headerlink" title="åˆ›å»ºé¡¹ç›®"></a>åˆ›å»ºé¡¹ç›®</h2><p>ä½¿ç”¨ rails åˆ›å»ºé¡¹ç›®çš„å‘½ä»¤å¦‚ä¸‹</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails new APP_PATH [options]</span><br></pre></td></tr></table></figure><p>åœ¨åˆ›å»ºé¡¹ç›®ä¹‹å‰ï¼Œæ£€æŸ¥ä¸€ä¸‹æ˜¯å¦å·²ç»å®‰è£…äº† <code>sqlite3</code> è¿™ä¸ªæ•°æ®åº“ï¼Œæ²¡æœ‰çš„è¯è¯·æŸ¥é˜…èµ„æ–™è‡ªè¡Œå®‰è£…ä¸€ä¸‹ã€‚</p><p>æ£€æŸ¥æ–¹æ³•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlite3 --version</span><br></pre></td></tr></table></figure><p>æŒ‡å®š rails ç‰ˆæœ¬åˆ›å»ºé¡¹ç›®ï¼Œé€‰é¡¹ <code>--skip-bundle</code> æ˜¯ä¸ºäº†è·³è¿‡å®‰è£… gemsï¼Œåé¢ä¼šè¯¦ç»†è¯´ã€‚</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails _7.<span class="number">0.3</span>.1_ new ~<span class="regexp">/work/aloe</span> --skip-bundle</span><br></pre></td></tr></table></figure><p>ä¸åˆ° 2s çš„æ—¶é—´ï¼Œä¼šåœ¨ä½ çš„ <code>~/work</code> ç›®å½•ä¸‹æœ‰ä¸ªåä¸º <code>aloe</code> çš„æ–‡ä»¶å¤¹ï¼Œå®ƒå°±æ˜¯æˆ‘ä»¬åˆ›å»ºçš„é¡¹ç›®ç›®å½•ã€‚</p><h2 id="å·¥ç¨‹ç›®å½•ä»‹ç»"><a href="#å·¥ç¨‹ç›®å½•ä»‹ç»" class="headerlink" title="å·¥ç¨‹ç›®å½•ä»‹ç»"></a>å·¥ç¨‹ç›®å½•ä»‹ç»</h2><p><img src="/upload/2022/09/04/1.png"></p><p>ä¸‹è¡¨åˆ—å‡ºäº†å¯¹åº”æ–‡ä»¶å¤¹åŒ…å«çš„å†…å®¹ä»¥åŠä½œç”¨ï¼Œä¾¿äºå¤§å®¶æŸ¥é˜…ã€‚</p><table><thead><tr><th align="center">åºå·</th><th align="left">æ–‡ä»¶&#x2F;æ–‡ä»¶å¤¹</th><th align="left">ä½œç”¨</th></tr></thead><tbody><tr><td align="center">1</td><td align="left"><code>app/</code></td><td align="left">åŒ…å«åº”ç”¨çš„ï¼ˆMVCï¼‰æ§åˆ¶å™¨ã€æ¨¡å‹ã€è§†å›¾ã€è¾…åŠ©æ–¹æ³•ã€é‚®ä»¶ç¨‹åºã€é¢‘é“ã€ä½œä¸šå’Œé™æ€èµ„æºæ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶å¤¹è·Ÿæˆ‘ä»¬æ—¥å¸¸å¼€å‘å…³ç³»æœ€å¤§</td></tr><tr><td align="center">2</td><td align="left"><code>bin/</code></td><td align="left">åŒ…å«ç”¨äºå¯åŠ¨åº”ç”¨çš„ rails è„šæœ¬ï¼Œä»¥åŠç”¨äºå®‰è£…ã€æ›´æ–°ã€éƒ¨ç½²æˆ–è¿è¡Œåº”ç”¨çš„å…¶ä»–è„šæœ¬</td></tr><tr><td align="center">3</td><td align="left"><code>config/</code></td><td align="left">é…ç½®åº”ç”¨çš„è·¯ç”±ã€æ•°æ®åº“ç­‰ã€‚</td></tr><tr><td align="center">4</td><td align="left"><code>config.ru</code></td><td align="left">åŸºäº Rack çš„æœåŠ¡å™¨æ‰€éœ€çš„ Rack é…ç½®ï¼Œç”¨äºå¯åŠ¨åº”ç”¨</td></tr><tr><td align="center">5</td><td align="left"><code>db/</code></td><td align="left">åŒ…å«å½“å‰æ•°æ®åº“çš„æ¨¡å¼ï¼Œä»¥åŠæ•°æ®åº“è¿ç§»æ–‡ä»¶</td></tr><tr><td align="center">6</td><td align="left"><code>Gemfile</code>, <code>Gemfile.lock</code></td><td align="left">è¿™ä¸¤ä¸ªæ–‡ä»¶ç”¨äºæŒ‡å®š Rails åº”ç”¨æ‰€éœ€çš„ gem ä¾èµ–ã€‚Bundler gem éœ€è¦ç”¨åˆ°è¿™ä¸¤ä¸ªæ–‡ä»¶</td></tr><tr><td align="center">7</td><td align="left"><code>lib/</code></td><td align="left">åº”ç”¨çš„æ‰©å±•æ¨¡å—</td></tr><tr><td align="center">8</td><td align="left"><code>log/</code></td><td align="left">åº”ç”¨æ—¥å¿—æ–‡ä»¶</td></tr><tr><td align="center">9</td><td align="left"><code>public/</code></td><td align="left">ä»…æœ‰çš„å¯ä»¥ç›´æ¥ä»å¤–éƒ¨è®¿é—®çš„æ–‡ä»¶å¤¹ï¼ŒåŒ…å«é™æ€æ–‡ä»¶å’Œç¼–è¯‘åçš„é™æ€èµ„æºæ–‡ä»¶</td></tr><tr><td align="center">10</td><td align="left"><code>Rakefile</code></td><td align="left">å®šä½å¹¶åŠ è½½å¯åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œçš„ä»»åŠ¡ã€‚è¿™äº›ä»»åŠ¡åœ¨ Rails çš„å„ä¸ªç»„ä»¶ä¸­å®šä¹‰ã€‚å¦‚æœè¦æ·»åŠ è‡ªå®šä¹‰ä»»åŠ¡ï¼Œè¯·ä¸è¦ä¿®æ”¹ Rakefileï¼Œç›´æ¥æŠŠè‡ªå®šä¹‰ä»»åŠ¡ä¿å­˜åœ¨ <code>lib/tasks</code> æ–‡ä»¶å¤¹ä¸­å³å¯</td></tr><tr><td align="center">11</td><td align="left"><code>README.md</code></td><td align="left">åº”ç”¨çš„è‡ªè¿°æ–‡ä»¶ï¼Œè¯´æ˜åº”ç”¨çš„ç”¨é€”ã€å®‰è£…æ–¹æ³•ç­‰</td></tr><tr><td align="center">12</td><td align="left"><code>storage</code></td><td align="left">ç£ç›˜æœåŠ¡çš„æ´»åŠ¨å­˜å‚¨æ–‡ä»¶ã€‚è·Ÿ Active Storage æœ‰å…³ï¼Œåé¢ç”¨åˆ°å†è¯´</td></tr><tr><td align="center">13</td><td align="left"><code>test/</code></td><td align="left">å•å…ƒæµ‹è¯•ã€å›ºä»¶å’Œå…¶ä»–æµ‹è¯•è£…ç½®ã€‚è¯¦æƒ…è¯·å‚é˜…<a href="https://clwy.cn/guide/pages/testing.html">Rails åº”ç”¨æµ‹è¯•æŒ‡å—</a></td></tr><tr><td align="center">14</td><td align="left"><code>tmp/</code></td><td align="left">ä¸´æ—¶æ–‡ä»¶ï¼ˆå¦‚ç¼“å­˜å’Œ PID æ–‡ä»¶ï¼‰</td></tr><tr><td align="center">15</td><td align="left"><code>vendor/</code></td><td align="left">åŒ…å«ç¬¬ä¸‰æ–¹ä»£ç å¦‚ç¬¬ä¸‰æ–¹ gemï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒæˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠ gems æ”¾åˆ°è¿™é‡Œ</td></tr><tr><td align="center">16</td><td align="left"><code>.gitignore</code></td><td align="left">å‘Šè¯‰ Git è¦å¿½ç•¥çš„æ–‡ä»¶ï¼ˆæˆ–æ¨¡å¼ï¼‰</td></tr><tr><td align="center">17</td><td align="left"><code>.ruby-version</code></td><td align="left">è®°å½•å·¥ç¨‹ä½¿ç”¨çš„ ruby ç‰ˆæœ¬</td></tr></tbody></table><h2 id="è¿è¡Œé¡¹ç›®"><a href="#è¿è¡Œé¡¹ç›®" class="headerlink" title="è¿è¡Œé¡¹ç›®"></a>è¿è¡Œé¡¹ç›®</h2><p>æ›´æ”¹ gem æºï¼Œä¿®æ”¹ Gemfile ä¿®æ”¹å®Œæˆåï¼Œä¿å­˜ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># source &quot;https://rubygems.org&quot;</span></span><br><span class="line"><span class="string">source</span> <span class="string">&quot;https://gems.ruby-china.com&quot;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œé¡¹ç›®ï¼Œæ‰§è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">å®‰è£… gems</span></span><br><span class="line">bundle install</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">è¿è¡Œé¡¹ç›®</span></span><br><span class="line">rails s</span><br></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨è®¿é—® <a href="http://127.0.0.1:3000/">http://127.0.0.1:3000</a> å°±å¯ä»¥çœ‹åˆ°å¯¹åº”çš„é¡µé¢ã€‚</p><p><img src="/upload/2022/09/04/2.png"></p><p>è¿™é‡Œè¡¥å……ä¸€ä¸ªå°çŸ¥è¯†ç‚¹ï¼Œ<code>rails s</code> æ˜¯ <code>rails server</code> å‘½ä»¤çš„ç®€å†™ã€‚å…³äºå®ƒçš„ç”¨æ³•è¿˜æœ‰å¾ˆå¤šï¼Œéšç€å¤§å®¶çš„æ·±å…¥å­¦ä¹ ä¹Ÿä¼šé€æ¸æ¥è§¦åˆ°çš„ã€‚</p><blockquote><p><strong>Usage</strong>:</p><p>rails server -u [thin&#x2F;puma&#x2F;webrick] [options]</p><p><strong>Options</strong>:</p><p>-e, [â€“environment&#x3D;ENVIRONMENT]   # Specifies the environment to run this server under (test&#x2F;development&#x2F;production).</p><p>-p, [â€“port&#x3D;port]              # Runs Rails on the specified port - defaults to 3000.</p><p>-b, [â€“binding&#x3D;IP]           # Binds Rails to the specified IP - defaults to â€˜localhostâ€™ in development and â€˜0.0.0.0â€™ in other environmentsâ€™.</p><p>-c, [â€“config&#x3D;file]            # Uses a custom rackup configuration.</p><p>â€‹                                       # Default: config.ru</p><p>-d, [â€“daemon], [â€“no-daemon]        # Runs server as a Daemon.</p><p>-u, [â€“using&#x3D;name]              # Specifies the Rack server used to run the application (thin&#x2F;puma&#x2F;webrick).</p><p>-P, [â€“pid&#x3D;PID]                    # Specifies the PID file - defaults to tmp&#x2F;pids&#x2F;server.pid.</p><p>-C, [â€“dev-caching], [â€“no-dev-caching]   # Specifies whether to perform caching in development.</p><p>â€‹       [â€“early-hints], [â€“no-early-hints]         # Enables HTTP&#x2F;2 early hints.</p><p>â€‹       [â€“log-to-stdout], [â€“no-log-to-stdout]  # Whether to log to stdout. Enabled by default in development when not daemonized.</p></blockquote><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://guides.rubyonrails.org/getting_started.html">Getting Started with Rails</a> ä½¿ç”¨ Rails åˆ›å»ºé¡¹ç›®</li></ul>]]></content>
      
      
      <categories>
          
          <category> Ruby-on-Rails </category>
          
      </categories>
      
      
        <tags>
            
            <tag> project ruby rails </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ruby on Rails å®è·µï¼šè¯¾ç¨‹å¯¼è¯»</title>
      <link href="/2022/09/04/Ruby-on-Rails-%E5%AE%9E%E8%B7%B5%EF%BC%9A%E8%AF%BE%E7%A8%8B%E5%AF%BC%E8%AF%BB/"/>
      <url>/2022/09/04/Ruby-on-Rails-%E5%AE%9E%E8%B7%B5%EF%BC%9A%E8%AF%BE%E7%A8%8B%E5%AF%BC%E8%AF%BB/</url>
      
        <content type="html"><![CDATA[<h2 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h2><p>ç¬¬ä¸€æ¬¡å¬è¯´ Ruby è¿™é—¨ç¼–ç¨‹è¯­è¨€æ˜¯åœ¨ 2012 å¹´ï¼Œé‚£ä¸ªæ—¶å€™çš„ Ruby æ˜¯ <code>1.9.x</code> ç‰ˆæœ¬ï¼Œæˆªè‡³åˆ°æœ¬æ–‡å†™çš„æ—¶å€™ Ruby å·²ç»å‘å¸ƒäº† <code>3.x</code> ç‰ˆæœ¬äº†ã€‚</p><p>Ruby åœ¨å›½å†…å¹¶æ²¡æœ‰é‚£ä¹ˆç«ï¼Œç”¨ Ruby è¿›è¡Œå¼€å‘çš„äººä¹Ÿå¾ˆå°‘ï¼Œå¦‚æœä¸æ˜¯ Rails ä¼°è®¡ Ruby æ—©å°±è¢«äººå¿˜å¾—ä¸€å¹²äºŒå‡€äº†ã€‚ç°åœ¨åœ¨å›½å†…æ‰¾ Ruby on Rails çš„å­¦ä¹ èµ„æ–™å°‘ä¹‹åˆå°‘ï¼Œæ— å½¢ä¹‹ä¸­ç»™è‡ªå·±çš„å­¦ä¹ å¸¦æ¥äº†ä¸€å®šçš„æˆæœ¬ã€‚åœ¨æˆ‘äº†è§£å’Œåˆæ­¥å­¦ä¹  Ruby on Rails ä¹‹åï¼Œå‘ç°å®ƒå­¦ä¹ æˆæœ¬ä¸é«˜ï¼Œå¹¶ä¸”èƒ½å¤Ÿå¾ˆå¿«çš„å®ç°ä½ çš„ä¸€äº›æƒ³æ³•ï¼Œåœ¨ Web å¼€å‘é¢†åŸŸï¼Œæœ‰å®ƒå°±å¤Ÿäº†ã€‚</p><p>ç¼–ç¨‹è¯­è¨€å’Œæ¡†æ¶æ— æ‰€è°“å¯¹é”™ï¼Œå°±çœ‹ä½ ç”¨å®ƒæ¥åšä»€ä¹ˆï¼Œæœ‰éœ€è¦å°±å­¦å§ã€‚æˆ‘æƒ³æŠŠè‡ªå·±çš„ä¸€äº›å­¦ä¹ å®è·µæ‹¿å‡ºæ¥è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©åˆ°æœ‰éœ€è¦çš„äººã€‚</p><p>å­¦ä¹ è¿™å¥—è¯¾ç¨‹éœ€è¦ä½ æœ‰ä¸€å®šçš„ç¼–ç¨‹åŸºç¡€ï¼Œè‡³å°‘ä½ éœ€è¦åšå¥½å¦‚ä¸‹å‡ ç‚¹å‡†å¤‡</p><ol><li>æœ‰ Java&#x2F;C#&#x2F;C&#x2F;C++&#x2F;Javascript&#x2F;Python&#x2F;PHP&#x2F;Rust ç­‰å…¶ä¸­ä¸€ç§ç¼–ç¨‹è¯­è¨€åŸºç¡€ï¼›</li><li>äº†è§£æˆ–è€…ç†Ÿæ‚‰ MVCï¼Œäº†è§£ B&#x2F;Sã€C&#x2F;S ç­‰æ¶æ„ï¼›</li><li>ä¼šåŸºæœ¬çš„ Ruby ç¼–ç¨‹ï¼Œå…³äº Ruby ç‰ˆæœ¬çš„å‘å¸ƒå†ç¨‹å¯ä»¥å‚è€ƒ <a href="https://www.ruby-lang.org/zh_cn/news/">Ruby News</a> ç½‘ç«™æ‹ï¼›</li><li>äº†è§£ HTML&#x2F;CSS å‰ç«¯ç¼–ç¨‹ï¼Œä¼šä¸€äº›åŸºæœ¬çš„ Linux å‘½ä»¤æ“ä½œï¼›</li><li>äº†è§£ Redis&#x2F;SQLite&#x2F;Mysql æˆ–è€…å…¶ä»–æ•°æ®åº“åŸºæœ¬çŸ¥è¯†ï¼Œä¼šä½¿ç”¨å¸¸ç”¨çš„ SQL è¯­å¥ã€‚</li></ol><p>å¦‚æœä½ æ²¡æœ‰ä¸Šé¢çš„å…¨éƒ¨åŸºç¡€ä¹Ÿæ²¡å…³ç³»ï¼Œå¯ä»¥è¾¹çœ‹è¾¹å­¦ï¼Œé‡åˆ°ä¸æ‡‚çš„çŸ¥è¯†å¯ä»¥ç•™è¨€è¯„è®ºç»™æˆ‘æˆ–è€…è‡ªå­¦ã€‚è¯·æ‚¨è®°ä½å…´è¶£æ‰æ˜¯æœ€å¥½çš„è€å¸ˆï¼Œå¿ƒé‡Œåªè¦å……æ»¡çˆ±ï¼Œé‚£é‡Œéƒ½æ˜¯é˜³å…‰æ˜åªšã€‚æˆ‘ä¹Ÿæ˜¯åˆ©ç”¨ä¸šä½™æ—¶é—´æ¥å®Œæˆè¿™å¥—è¯¾ç¨‹çš„ï¼Œå†…å®¹è‚¯å®šæœ‰ä¸å°‘é—æ¼å’Œä¸è¶³çš„åœ°æ–¹ï¼Œè¯·å¤§å®¶å¤šå¤šæŒ‡æ­£ã€‚</p><h2 id="è¯¾ç¨‹ç›®å½•"><a href="#è¯¾ç¨‹ç›®å½•" class="headerlink" title="è¯¾ç¨‹ç›®å½•"></a>è¯¾ç¨‹ç›®å½•</h2><p>ç›®å½•æ˜¯åŠ¨æ€æ›´æ–°çš„ï¼Œå¸Œæœ›å¤§å®¶è€å¿ƒç­‰å¾…âŒ›ï¸</p><h3 id="é¡¹ç›®ç¯‡"><a href="#é¡¹ç›®ç¯‡" class="headerlink" title="é¡¹ç›®ç¯‡"></a>é¡¹ç›®ç¯‡</h3><h4 id="1ã€åˆ›å»º-aloe-é¡¹ç›®"><a href="#1ã€åˆ›å»º-aloe-é¡¹ç›®" class="headerlink" title="1ã€åˆ›å»º aloe é¡¹ç›®"></a>1ã€åˆ›å»º aloe é¡¹ç›®</h4><p>æœ¬å°èŠ‚ä»‹ç»äº†é¡¹ç›®ç¯å¢ƒçš„å‡†å¤‡ä»¥åŠå¦‚ä½•åˆ›å»ºé¡¹ç›®ï¼Œæœ¬ç¯‡æ•™ç¨‹å¯ä»¥ <a href="https://veryitman.com/2022/09/04/Ruby-on-Rails-%E5%AE%9E%E8%B7%B5%EF%BC%9A%E5%88%9B%E5%BB%BA-aloe-%E9%A1%B9%E7%9B%AE/">ç‚¹å‡»æˆ‘</a> ç›´è¾¾ç°åœºã€‚</p><ul><li>å®‰è£…ç›¸å…³çš„è½¯ä»¶å’Œ Ruby ç‰ˆæœ¬</li><li><a href="http://veryitman.com/2022/03/14/Ruby-on-Rails-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">Ruby on Rails ç¯å¢ƒæ­å»º</a></li></ul><p>æœ¬æ¬¡è¯¾ç¨‹ä½¿ç”¨çš„ç‰ˆæœ¬</p><ul><li><p>Rubyï¼š3.0.0</p></li><li><p>Railsï¼š7.0.x</p></li></ul><h4 id="2ã€ç»™-aloe-ç”»ä¸ªç®€å¦†"><a href="#2ã€ç»™-aloe-ç”»ä¸ªç®€å¦†" class="headerlink" title="2ã€ç»™ aloe ç”»ä¸ªç®€å¦†"></a>2ã€ç»™ aloe ç”»ä¸ªç®€å¦†</h4><blockquote><p><a href="https://veryitman.com/2022/11/13/Ruby-on-Rails-%E5%AE%9E%E8%B7%B5%EF%BC%9A%E6%9B%B4%E6%8D%A2-aloe-%E9%A6%96%E9%A1%B5/">Ruby on Rails å®è·µï¼šæ›´æ¢ aloe é¦–é¡µ</a></p></blockquote><p>åœ¨è¿™ä¸€ä¸ªå°èŠ‚ä¸­ï¼Œæˆ‘ä»‹ç»äº†å¦‚ä¸‹å†…å®¹</p><ul><li>å¦‚ä½•é€šè¿‡ rails g åˆ›å»ºæ§åˆ¶å™¨ï¼Ÿ</li><li>å¦‚ä½•é€šè¿‡ rails routes æŸ¥çœ‹æ§åˆ¶å™¨çš„è·¯ç”±ï¼Ÿ</li><li>å¦‚ä½•ä¿®æ”¹å·¥ç¨‹çš„è·¯ç”±é…ç½®ï¼Ÿ</li><li>ERB æ–‡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ</li></ul><h3 id="éƒ¨ç½²ç¯‡"><a href="#éƒ¨ç½²ç¯‡" class="headerlink" title="éƒ¨ç½²ç¯‡"></a>éƒ¨ç½²ç¯‡</h3><h4 id="1ã€CentOS-Install-Passenger"><a href="#1ã€CentOS-Install-Passenger" class="headerlink" title="1ã€CentOS Install Passenger"></a>1ã€<a href="https://veryitman.com/2022/11/06/CentOS-Install-Passenger-for-ROR/">CentOS Install Passenger</a></h4><ul><li>å¦‚ä½•å®‰è£… nginx + passenger</li><li>å¦‚ä½•é€šè¿‡ passenger è®¿é—®åº”ç”¨</li></ul>]]></content>
      
      
      <categories>
          
          <category> Ruby-on-Rails </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tutorial ruby rails </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOS7.9 å®‰è£… mysql5.7</title>
      <link href="/2022/04/30/CentOS7-9-%E5%AE%89%E8%A3%85-mysql5-7/"/>
      <url>/2022/04/30/CentOS7-9-%E5%AE%89%E8%A3%85-mysql5-7/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åœ¨ CentOS 7 ä¸Šé¢å®‰è£… MySQL5.7 ç»å†äº†ä¸€ç‚¹å°æŒ«æŠ˜ï¼Œç‰¹æ­¤è®°å½•ï¼Œç»™æœ‰éœ€è¦çš„æœ‹å‹åšä¸ªå‚è€ƒã€‚</p><p>æˆ‘çš„äº‘ä¸»æœº CentOS ç‰ˆæœ¬</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt; </span><span class="language-bash">lsb_release -a</span></span><br><span class="line"></span><br><span class="line">LSB Version::core-4.1-amd64:core-4.1-noarch</span><br><span class="line">Distributor ID:CentOS</span><br><span class="line">Description:CentOS Linux release 7.9.2009 (Core)</span><br><span class="line">Release:7.9.2009</span><br><span class="line">Codename:Core</span><br></pre></td></tr></table></figure><p>å½“ç„¶ä½ è¦æ˜¯ä¸æƒ³å®‰è£…<strong>æŒ‡å®šç‰ˆæœ¬</strong>çš„ MySQLï¼Œç›´æ¥ä½¿ç”¨ <code>yum install mysql</code> ä¹Ÿå¯ä»¥ã€‚</p><h2 id="å®‰è£…-MySQL"><a href="#å®‰è£…-MySQL" class="headerlink" title="å®‰è£… MySQL"></a>å®‰è£… MySQL</h2><p>å› ä¸ºç°æœ‰å·¥ç¨‹çš„å„ç§ç¼˜æ•…ï¼Œæˆ‘éœ€è¦åœ¨äº‘ä¸»æœºä¸Šé¢å®‰è£… MySQL5.7 ç‰ˆæœ¬ã€‚</p><p>åœ¨ç½‘ä¸Šæ‰¾äº†æŒºå¤šå®‰è£…æ–¹æ³•ä½†æ€»æ˜¯äº‹ä¸æ„¿è¿ï¼Œä¼šå‡ºç°å„ç§å„æ ·çš„é—®é¢˜ï¼Œè¿˜å¥½åœ¨ <a href="https://dev.mysql.com/doc/refman/5.7/en/linux-installation-yum-repo.html">MySQL å®˜æ–¹æ–‡æ¡£</a> æ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆã€‚æ‰€ä»¥è¯´é‡åˆ°é—®é¢˜è¿˜æ˜¯è¦åˆ°å®˜ç½‘å»æ‰¾æ–¹æ¡ˆã€‚</p><p>å¦‚æœä½ å·²ç»ä½¿ç”¨ <code>root</code> èº«ä»½ç™»å½•äº†ä¸»æœºï¼Œåœ¨ä¸‹é¢çš„æ­¥éª¤ä¸­å¯ä»¥ä¸ä½¿ç”¨ <code>sudo</code>ã€‚</p><h3 id="1ã€Adding-the-Yum-Repository"><a href="#1ã€Adding-the-Yum-Repository" class="headerlink" title="1ã€Adding the Yum Repository"></a>1ã€Adding the Yum Repository</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum localinstall mysql57-community-release-el7-11.noarch.rpm</span><br></pre></td></tr></table></figure><p>å¦‚æœå‡ºç°ç±»ä¼¼ <code>Failed to set locale, defaulting to C</code> è¿™æ ·çš„é”™è¯¯ï¼Œè¯´æ˜è¯¥æºæ— æ³•æ‰¾åˆ°ï¼Œå¯ä»¥æ¢ä¸­æ–¹å¼ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum localinstall mysql57-community-release-el7.rpm</span><br></pre></td></tr></table></figure><p>å…³äºæºå¯ä»¥åœ¨ <a href="http://repo.mysql.com/">http://repo.mysql.com/</a> æ‰¾ã€‚</p><h3 id="2ã€Selecting-a-Release-Series"><a href="#2ã€Selecting-a-Release-Series" class="headerlink" title="2ã€Selecting a Release Series"></a>2ã€Selecting a Release Series</h3><p>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å‰ï¼Œè®°å¾—å®‰è£… <code>yum -y install yum-utils</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum repolist all | grep mysql</span><br><span class="line"></span><br><span class="line">yum-config-manager --enable mysql57-community</span><br><span class="line"></span><br><span class="line">yum repolist enabled | grep mysql</span><br></pre></td></tr></table></figure><h3 id="3ã€Install"><a href="#3ã€Install" class="headerlink" title="3ã€Install"></a>3ã€Install</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install mysql-community-server</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šå¦‚æœä½ æ˜¯ <code>CentOS8</code>ï¼Œè¿˜éœ€è¦åœ¨æ‰§è¡Œæ­¤æ­¥éª¤æ“ä½œå‰ï¼Œéœ€è¦æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum module disable mysql</span><br></pre></td></tr></table></figure><p>åœ¨å®‰è£…è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šå‡ºç°ä¸‹é¢çš„é”™è¯¯ï¼ˆæ­¤æ—¶ MySQL å¹¶æ²¡æœ‰å®‰è£…æˆåŠŸï¼‰</p><blockquote><p>Public key for mysql-community-libs-compat-5.7.38-1.el7.x86_64.rpm is not installed</p><p> Failing package is: mysql-community-libs-compat-5.7.38-1.el7.x86_64</p><p> GPG Keys are configured as: file:&#x2F;&#x2F;&#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-mysql</p></blockquote><p>éœ€è¦å‡çº§ä¸€ä¸‹ GPG ç„¶åé‡æ–°å®‰è£…ï¼Œæ–¹å¼å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rpm --import https://repo.mysql.com/RPM-GPG-KEY-mysql-2022</span><br><span class="line"></span><br><span class="line">yum install mysql-community-server</span><br></pre></td></tr></table></figure><h3 id="4ã€Start-mysqld"><a href="#4ã€Start-mysqld" class="headerlink" title="4ã€Start mysqld"></a>4ã€Start mysqld</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service mysqld start</span><br></pre></td></tr></table></figure><p>ä¸‹é¢ç»™å‡ºå®‰è£… MySQL æˆåŠŸåï¼Œé»˜è®¤çš„é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œæ–¹ä¾¿åç»­ä½¿ç”¨ã€‚</p><ul><li>é…ç½®æ–‡ä»¶ï¼š<code>/etc/my.cnf</code></li><li>æ—¥å¿—æ–‡ä»¶ï¼š<code>/var/log/mysqld.log</code></li><li>å¯åŠ¨è„šæœ¬ï¼š<code>/usr/lib/systemd/system/mysqld.service</code></li><li>socketæ–‡ä»¶ï¼š<code>/var/run/mysqld/mysqld.pid</code></li></ul><h2 id="ä½¿ç”¨-MySQL"><a href="#ä½¿ç”¨-MySQL" class="headerlink" title="ä½¿ç”¨ MySQL"></a>ä½¿ç”¨ MySQL</h2><p>ç»è¿‡ä¸Šé¢ç®€å• 4 æ­¥å°±å¯ä»¥è½»æ¾çš„å®Œæˆ MySQL çš„å®‰è£…ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹ä½¿ç”¨å®ƒã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p</span><br></pre></td></tr></table></figure><p>ç›´æ¥å›è½¦ï¼ˆ<code>Enter</code>ï¼‰ï¼Œæç¤ºå¦‚ä¸‹é”™è¯¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR 1045 (28000): Access denied for user &#x27;root&#x27;@&#x27;localhost&#x27; (using password: NO)</span><br></pre></td></tr></table></figure><p>è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œéœ€è¦å…ˆæƒ³åŠæ³•ç™»å…¥ MySQLï¼Œç„¶åå†ä¿®æ”¹ root ç”¨æˆ·çš„å¯†ç ã€‚</p><p>å¦‚ä½•è§£å†³è¿™ä¸ªé”™è¯¯è€Œè¿›è¡Œç™»å…¥å‘¢ï¼Ÿ</p><p>MySQL å®‰è£…å®Œæˆä¹‹åï¼Œç”Ÿæˆçš„é»˜è®¤å¯†ç åœ¨ <code>/var/log/mysqld.log</code> æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>grep</code> å‘½ä»¤åœ¨æ—¥å¿—ä¸­æ‰¾åˆ°ä¸´æ—¶å¯†ç ï¼ˆtemporary passwordï¼‰ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep &#x27;temporary password&#x27; /var/log/mysqld.log</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä¸´æ—¶å¯†ç ä¿¡æ¯ï¼š2022-04-30T04:40:47.234502Z 1 [Note] A temporary password is generated for root@localhost: <code>Tq%y:sUnC7;d</code>ï¼Œç”¨è¯¥å¯†ç ç™»å…¥ MySQL å³å¯ã€‚</p><p><code>MySQL 5.7</code> é»˜è®¤å®‰è£…äº†å¯†ç å®‰å…¨æ£€æŸ¥æ’ä»¶ï¼ˆvalidate_passwordï¼‰ï¼Œ<strong>é»˜è®¤å¯†ç æ£€æŸ¥ç­–ç•¥è¦æ±‚å¯†ç å¿…é¡»åŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—å’Œç‰¹æ®Šç¬¦å·ï¼Œå¹¶ä¸”é•¿åº¦ä¸èƒ½å°‘äº8ä½</strong>ã€‚å¦‚æœè®¾ç½®çš„å¯†ç ä¸ç¬¦åˆè§„èŒƒå’Œè¦æ±‚ï¼Œè¿›è¡Œå¯¹åº”çš„æ“ä½œä¼šæç¤ºç±»ä¼¼å¯†ç ä¸ç¬¦åˆè§„èŒƒçš„é”™è¯¯ã€‚å¯ä»¥æŸ¥çœ‹ <a href="https://links.jianshu.com/go?to=https://dev.mysql.com/doc/refman/5.7/en/validate-password-options-variables.html%23sysvar_validate_password_policy">MySQLå®˜ç½‘å¯†ç è¯¦ç»†ç­–ç•¥</a> äº†è§£æ›´å¤šè¿™æ–¹é¢çš„çŸ¥è¯†ã€‚</p><p>ç™»å…¥æˆåŠŸä¹‹åï¼Œä¿®æ”¹ root ç”¨æˆ·çš„å¯†ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER USER &#x27;root&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;MyNewPass4!&#x27;;</span><br></pre></td></tr></table></figure><p>åç»­å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼ï¼ˆupdateï¼‰ä¿®æ”¹ root ç”¨æˆ·çš„å¯†ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">update user set authentication_string=password(&#x27;MyNewPass4!&#x27;) where user=&#x27;root&#x27;;</span><br><span class="line"></span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šæ“ä½œå®Œæˆåï¼Œéœ€è¦é‡å¯ä¸€ä¸‹ MySQL æœåŠ¡ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysqld restart</span><br></pre></td></tr></table></figure><p>å¦å¤–è¿˜æœ‰ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œå°±æ˜¯ä¿®æ”¹ <code>my.cnf</code> é…ç½®æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/my.cnf</span><br></pre></td></tr></table></figure><p>åœ¨ [mysqld] ä¸‹é¢æ–°å¢ <code>skip-grant-tables</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">skip-grant-tables</span><br></pre></td></tr></table></figure><p>åŒç†ï¼Œä»¥ä¸Šæ“ä½œå®Œæˆåéœ€è¦é‡å¯ä¸€ä¸‹ MySQL æœåŠ¡ã€‚æ–°å¢çš„è¿™ä¸ªé…ç½®å†æ¬¡ç™»å½• MySQL æ— éœ€è¾“å…¥ root å¯†ç ã€‚</p><p>ç™»å…¥åå†ç”¨ä¸Šè¿°æ–¹æ³•è®¾ç½® root ç”¨æˆ·çš„å¯†ç å³å¯ï¼Œä¿®æ”¹å®Œæˆåè®°å¾—å»æ‰ <code>skip-grant-tables</code> è¿™ä¸ªé…ç½®ã€‚</p><h2 id="ä¿®æ”¹é»˜è®¤ç¼–ç "><a href="#ä¿®æ”¹é»˜è®¤ç¼–ç " class="headerlink" title="ä¿®æ”¹é»˜è®¤ç¼–ç "></a>ä¿®æ”¹é»˜è®¤ç¼–ç </h2><p>MySQL çš„å­—ç¬¦ç¼–ç ï¼Œå¯ä»¥é€šè¿‡ä¸‹è¿°æ–¹å¼æŸ¥çœ‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &#x27;character%&#x27;;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é€šè¿‡ç¼–è¾‘ <code>/etc/my.cnf</code> é…ç½®æ–‡ä»¶æ¥æ”¹å˜é»˜è®¤ç¼–ç ï¼Œåˆ†åˆ«åœ¨å¯¹åº”çš„æ ‡ç­¾ä¸‹é¢å¢åŠ å¦‚ä¸‹å†…å®¹å³å¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">character-set-server=utf8</span><br><span class="line"></span><br><span class="line">[client]</span><br><span class="line">default-character-set=utf8</span><br><span class="line"></span><br><span class="line">[mysql]</span><br><span class="line">default-character-set=utf8</span><br></pre></td></tr></table></figure><p>éœ€è¦é‡å¯ä¸€ä¸‹ MySQL æœåŠ¡ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysqld restart</span><br></pre></td></tr></table></figure><h2 id="å¢åŠ ç”¨æˆ·"><a href="#å¢åŠ ç”¨æˆ·" class="headerlink" title="å¢åŠ ç”¨æˆ·"></a>å¢åŠ ç”¨æˆ·</h2><p>é»˜è®¤åªå…è®¸ root ç”¨æˆ·åœ¨æœ¬åœ°ï¼ˆå³æœ¬æœºä¸Šï¼‰ç™»å½•ï¼Œå¦‚æœå…¶å®ƒæœºå™¨è¦è¿æ¥æˆ–è€…è®¿é—® mysqlï¼Œå¿…é¡»æ·»åŠ ä¸€ä¸ªå…è®¸è¿œç¨‹è¿æ¥æˆ–è€…è®¿é—®çš„å¸æˆ·ã€‚</p><p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥è®¾ç½®è®© root ç”¨æˆ·è¿›è¡Œè¿œç¨‹è®¿é—®ï¼Œä½†è¿™æ ·å°±å¾ˆä¸å®‰å…¨ï¼Œä¸€èˆ¬ä¹Ÿä¸ä¼šè¿™ä¹ˆåšã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select host,user,authentication_string from user;</span><br></pre></td></tr></table></figure><table><thead><tr><th>host</th><th>user</th><th>authentication_string</th></tr></thead><tbody><tr><td>localhost</td><td>root</td><td>*88195A6507F4892C6CED9F6E30BA6C609AF5AFA7</td></tr><tr><td>localhost</td><td>mysql.session</td><td>*THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE</td></tr><tr><td></td><td></td><td></td></tr></tbody></table><p>ä¸‹é¢æ–°å¢ä¸€ä¸ªå…è®¸è¿œç¨‹è¿æ¥çš„å¸æˆ· <code>lisi</code>ï¼Œæ³¨æ„è®¾ç½®çš„å¯†ç è¦ç¬¦åˆ MySQL å¤æ‚åº¦è¦æ±‚ï¼Œå¦åˆ™è®¾ç½®ä¼šå¤±è´¥ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GRANT ALL PRIVILEGES ON *.* TO &#x27;lisi&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;lisi2018!A&#x27; WITH GRANT OPTION;</span><br><span class="line"></span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><p>å†æ¬¡æŸ¥çœ‹ä¸€ä¸‹ç”¨æˆ·ä¼šå‘ç°å¤šäº† <code>lisi</code> è¿™ä¸ªç”¨æˆ·ã€‚</p><table><thead><tr><th>host</th><th>user</th><th>authentication_string</th></tr></thead><tbody><tr><td>localhost</td><td>root</td><td>*88195A6507F4892C6CED9F6E30BA6C609AF5AFA7</td></tr><tr><td>localhost</td><td>mysql.session</td><td>*THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE</td></tr><tr><td>%</td><td>lisi</td><td>*86BA32081A204071832FE6D1DECD57D9519D6411</td></tr></tbody></table><h2 id="é‡ç½®-root-å¯†ç "><a href="#é‡ç½®-root-å¯†ç " class="headerlink" title="é‡ç½® root å¯†ç "></a>é‡ç½® root å¯†ç </h2><p>å¦‚æœä¸å°å¿ƒå¿˜è®°äº† MySQL çš„ root ç”¨æˆ·ç™»å½•å¯†ç ï¼Œä¸è¦ç´§å¼ ï¼Œé€šè¿‡ä¸‹é¢ç®€å•å‡ æ­¥çš„æ“ä½œå°±å¯ä»¥é‡ç½®ã€‚</p><p>1ã€ä¿®æ”¹é…ç½®æ–‡ä»¶</p><p>åœ¨ <code>/etc/my.cnf</code> ï¼ˆå¯èƒ½ä½ çš„é…ç½®æ–‡ä»¶åœ¨å…¶ä»–ç›®å½•å¦‚ <code>/etc/mysql/my.cnf</code>ï¼‰ï¼Œæ–‡ä»¶ä¸­æ–°å¢</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">skip-grant-tables</span><br></pre></td></tr></table></figure><p>2ã€é‡å¯æœåŠ¡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysql restart</span><br></pre></td></tr></table></figure><p>3ã€ç™»å½•</p><p>åœ¨å‘½ä»¤è¡Œç›´æ¥è¾“å…¥ <code>mysql</code> å³å¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql</span><br></pre></td></tr></table></figure><p>4ã€é‡ç½® root å¯†ç </p><p>ä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">USE mysql;</span><br><span class="line"></span><br><span class="line"># æ³¨æ„ new_password æ˜¯ä½ è¦é‡æ–°è®¾ç½®çš„å¯†ç </span><br><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">user</span> <span class="keyword">SET</span> authentication_string <span class="operator">=</span> password (<span class="string">&#x27;new_password&#x27;</span>) <span class="keyword">WHERE</span> <span class="keyword">User</span> <span class="operator">=</span> <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line">flush privileges;</span><br><span class="line">quit</span><br></pre></td></tr></table></figure><p>5ã€å†æ¬¡ä¿®æ”¹é…ç½®æ–‡ä»¶</p><p>è®°å¾—æ³¨é‡Šæ‰åœ¨ç¬¬1æ­¥ä¸­å¢åŠ çš„å†…å®¹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">skip-grant-tables</span></span><br></pre></td></tr></table></figure><p>6ã€é‡å¯ mysql æœåŠ¡</p><p>7ã€ä½¿ç”¨ root ç™»å½•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -urot -p</span><br></pre></td></tr></table></figure><hr><p>å¦‚æœä½ åœ¨å®‰è£…è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°äº†æ–‡ä¸­æ²¡æœ‰æåˆ°çš„é—®é¢˜ï¼Œè¯·è€å¿ƒè§£å†³ä¹Ÿå¯ä»¥ç»™æˆ‘ç•™è¨€ï¼Œä¸€èµ·è¿›æ­¥ï¼</p><hr><p><strong>ç¥å¤§å®¶äº”ä¸€èŠ‚æ—¥å¿«ä¹ï¼Œç”Ÿæ´»å¹¸ç¦</strong></p><p><img src="/upload/me/qrcode_wx2022.png"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
          <category> Tools </category>
          
          <category> DB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL CentOS7 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ruby on Rails: RubyGems</title>
      <link href="/2022/03/16/Ruby-on-Rails-RubyGems/"/>
      <url>/2022/03/16/Ruby-on-Rails-RubyGems/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><strong>RubyGems is a package management framework for Ruby</strong>ï¼Œ<code>RubyGems</code> æ˜¯ Ruby ç¨‹åºåŒ…ç®¡ç†å™¨ï¼ˆå·¥å…·ï¼‰ã€‚å¾ˆå¤šç¼–ç¨‹è¯­è¨€æˆ–è€…å¹³å°éƒ½æœ‰è‡ªå·±çš„åŒ…ç®¡ç†å·¥å…·ï¼Œå¦‚ Rust çš„ cargoã€RedHat çš„ RPMï¼ŒUbuntu çš„ apt-get ç­‰ç­‰ã€‚RubyGems ç®€ç§° <code>gems</code>ï¼Œä½¿ç”¨å®ƒå¯ä»¥æ–¹ä¾¿åœ°ä¸‹è½½å®‰è£… Ruby çš„è½¯ä»¶åŒ…åˆ°è‡ªå·±çš„ç³»ç»Ÿæˆ–è€… Ruby å·¥ç¨‹ä¸­ï¼Œä¸€ä¸ªè½¯ä»¶åŒ…ç§°ä¹‹ä¸º <code>gem</code>ã€‚</p><p>ä¸ºäº†æ›´å¥½çš„ä½¿ç”¨å„ç§è½®å­ï¼ˆ<code>gem</code>ï¼‰ï¼Œåœ¨ <a href="https://rubygems.org/">rubygems</a> å¯ä»¥æ‰¾åˆ°å¾ˆå¤šå·²ç»ç”¨ ruby å†™å¥½çš„æ¡†æ¶ï¼ˆæˆ–è€…ç§°ä¹‹ä¸º libï¼‰ï¼Œæˆ‘ä»¬ç›´æ¥å¤ç”¨å³å¯ï¼Œå¦å¤–è‡ªå·±ä¹Ÿå¯ä»¥å¼€å‘ä¸€äº› ruby åº“æ”¾åˆ° <code>gems</code> ä¸­ä¾›å…¶ä»–äººäº«ç”¨ã€‚ </p><p>æ–‡ä¸­æåˆ°çš„ gems å’Œ RubyGems éƒ½è¡¨ç¤ºæ˜¯åŒä¸€ä¸ªæ„æ€ã€‚</p><h2 id="å®‰è£…-RubyGems"><a href="#å®‰è£…-RubyGems" class="headerlink" title="å®‰è£… RubyGems"></a>å®‰è£… RubyGems</h2><p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ macOSï¼Œç³»ç»Ÿå·²ç»è‡ªå¸¦æ¥ ruby å’Œ å¯¹åº”çš„ RubyGemsï¼Œä¸éœ€è¦å•ç‹¬å®‰è£…ã€‚è¯¦ç»†æƒ…å†µå¯ä»¥å‚è€ƒ  <a href="https://veryitman.com/2022/03/14/Ruby-on-Rails-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">Ruby å¼€å‘ç¯å¢ƒæ­å»º</a> è¿™ç¯‡æ–‡ç« ã€‚</p><p>å¦‚æœä½ æƒ³ç‹¬ç«‹å®‰è£… RubyGemsï¼Œå¯ä»¥å» <a href="https://rubygems.org/">RubyGems å®˜ç½‘</a> ä¸‹è½½å®‰è£…å³å¯ã€‚</p><p>å®‰è£…å®Œæˆä¹‹åï¼Œå¯ä»¥é€šè¿‡ <code>gem å‘½ä»¤</code>æŸ¥çœ‹ <code>gems</code> ç‰ˆæœ¬ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gem --version</span><br><span class="line"></span><br><span class="line">3.1.4</span><br></pre></td></tr></table></figure><h2 id="RubyGems-æº"><a href="#RubyGems-æº" class="headerlink" title="RubyGems æº"></a>RubyGems æº</h2><p>ä½¿ç”¨ <code>gems</code> ä¸‹è½½æ¯ä¸ª <code>gem</code>ï¼Œé»˜è®¤ä½¿ç”¨çš„ä¸‹è½½åœ°å€æ˜¯ <code>https://rubygems.org/</code>ï¼Œå³å¯¹åº”çš„åŒ…åœ°å€åœ¨å›½å¤–ï¼Œé€Ÿåº¦è¾ƒæ…¢ç”šè‡³ä¼šå‡ºç°ä¸‹è½½å¤±è´¥çš„æƒ…å†µã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ<a href="https://gems.ruby-china.com/">Ruby ä¸­å›½</a> æä¾›äº†å›½å†…ä¸‹è½½ <code>gem</code> çš„é€šé“ï¼Œé€Ÿåº¦è¾ƒå¿«ï¼Œæºæ›´æ–°ä¹Ÿæ¯”è¾ƒåŠæ—¶ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">æŸ¥çœ‹ gems æº</span></span><br><span class="line">gem sources -l</span><br></pre></td></tr></table></figure><p>å¯ä»¥é€šè¿‡ <code>gem å‘½ä»¤</code>æ›´æ”¹ <code>gems</code> æºã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gem sources -remove https://rubygems.org/</span><br><span class="line"></span><br><span class="line">gem sources --add https://gems.ruby-china.com/</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä¸¤æ¡å‘½ä»¤ç­‰åŒäºä¸‹é¢ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem sources --add https://gems.ruby-china.com/ --remove https://rubygems.org/</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥æŸ¥çœ‹æœ¬åœ°çš„æ–‡ä»¶ç¡®å®šæ˜¯å¦å·²ç»æ›´æ–°æº</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cat ~/.gemrc </span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">:backtrace: false</span><br><span class="line">:bulk_threshold: 1000</span><br><span class="line">:sources:</span><br><span class="line">- https://gems.ruby-china.com/</span><br><span class="line">:update_sources: true</span><br><span class="line">:verbose: true</span><br><span class="line">:concurrent_downloads: 8</span><br></pre></td></tr></table></figure><p>æ›´æ–°æºç¼“å­˜</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem sources -u</span><br></pre></td></tr></table></figure><p>æ›´å¤šå…³äº gem sources çš„å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹å¸®åŠ©</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem help sources</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä½¿ç”¨æ¸…åå¤§å­¦æä¾›çš„æºï¼š<code>https://mirrors.tuna.tsinghua.edu.cn/rubygems/</code>ï¼Œå¥½äººä¸€ç”Ÿå¹³å®‰ã€‚</p><h2 id="å¸¸ç”¨çš„-gem-å‘½ä»¤"><a href="#å¸¸ç”¨çš„-gem-å‘½ä»¤" class="headerlink" title="å¸¸ç”¨çš„ gem å‘½ä»¤"></a>å¸¸ç”¨çš„ gem å‘½ä»¤</h2><blockquote><p>ä¸‹é¢ä¸»è¦ä»¥ rails è¿™ä¸ª gem æ¥ä¸¾ä¾‹</p></blockquote><h3 id="search"><a href="#search" class="headerlink" title="search"></a>search</h3><p>æ ¹æ® <a href="http://guides.rubygems.org/rubygems-basics/#finding-gems">RubyGemçš„æŒ‡å—ï¼Œ</a>ä½¿ç”¨<code>search</code> å¯ä»¥æœç´¢ä»»ä½• gemã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem search rails --all</span><br></pre></td></tr></table></figure><p>ç¡®åˆ‡çš„æœç´¢ä½¿ç”¨ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem search &#x27;^rails$&#x27; --all</span><br></pre></td></tr></table></figure><p>åŒ…æ‹¬é¢„å‘å¸ƒç‰ˆæœ¬ä½¿ç”¨ <code>--pre</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem search &#x27;^rails$&#x27; --pre</span><br></pre></td></tr></table></figure><p>ä»æœ¬åœ°å’Œè¿œç¨‹æœåŠ¡å™¨ä¸ŠæŸ¥æ‰¾å«æœ‰railså­—ç¬¦ä¸²çš„åŒ…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem search rails --both </span><br></pre></td></tr></table></figure><p>åªä»è¿œç¨‹æœåŠ¡å™¨ä¸ŠæŸ¥æ‰¾å«æœ‰logå­—ç¬¦ä¸²çš„åŒ…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem search rails --remoter </span><br></pre></td></tr></table></figure><p>åªä»è¿œç¨‹æœåŠ¡å™¨ä¸ŠæŸ¥æ‰¾å«æœ‰logå­—ç¬¦ä¸²çš„åŒ…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem search -r rails </span><br></pre></td></tr></table></figure><h3 id="un-install"><a href="#un-install" class="headerlink" title="(un)install"></a>(un)install</h3><p>å®‰è£…æœ€æ–°ç‰ˆ rails</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem install rails</span><br></pre></td></tr></table></figure><p>å®‰è£…æŒ‡å®šç‰ˆæœ¬ rails</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem install rails --version 6.1.5</span><br></pre></td></tr></table></figure><p>å¸è½½ rails </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem uninstall rails</span><br></pre></td></tr></table></figure><p>å¸è½½æŒ‡å®šç‰ˆæœ¬çš„ rails </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem uninstall rails -v 6.1.5</span><br></pre></td></tr></table></figure><h3 id="list"><a href="#list" class="headerlink" title="list"></a>list</h3><p>æŸ¥çœ‹æœ¬åœ°å®‰è£…äº†å“ªäº› gem</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem list -l</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æœ¬åœ°å®‰è£…äº†å“ªäº›ç‰ˆæœ¬çš„ rails</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem list &#x27;^rails$&#x27; -l</span><br></pre></td></tr></table></figure><h3 id="update"><a href="#update" class="headerlink" title="update"></a>update</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="language-bash">æ›´æ–°æ‰€æœ‰åŒ…</span></span><br><span class="line">gem update </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="language-bash">æ›´æ–°æŒ‡å®šåŒ…</span></span><br><span class="line">gem update rails</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="language-bash">æ›´æ–°RubyGemsè½¯ä»¶è‡ªèº«</span></span><br><span class="line">gem update --system </span><br></pre></td></tr></table></figure><h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="language-bash">æŸ¥æ‰¾æœ¬åœ°å«æœ‰æ•°å­—çš„åŒ…</span></span><br><span class="line">gem query -n &#x27;&#x27;[0-9]&#x27;&#x27; --local </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="language-bash">æŠŠrake.gemspecç¼–è¯‘æˆrake.gem</span></span><br><span class="line">gem build rake.gemspec </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="language-bash">æ£€æµ‹rakeæ˜¯å¦æœ‰æ•ˆ</span></span><br><span class="line">gem check -v pkg/rake-0.4.0.gem </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="language-bash">æ¸…é™¤æ‰€æœ‰åŒ…æ—§ç‰ˆæœ¬ï¼Œä¿ç•™æœ€æ–°ç‰ˆæœ¬</span></span><br><span class="line">gem cleanup </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="language-bash">æ˜¾ç¤ºrakeåŒ…ä¸­æ‰€åŒ…å«çš„æ–‡ä»¶</span></span><br><span class="line">gem contents rails </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="language-bash">åˆ—å‡ºä¸railsç›¸äº’ä¾èµ–çš„åŒ…</span></span><br><span class="line">gem dependency rails -v 6.1.5 </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="language-bash">æŸ¥çœ‹gemçš„ç¯å¢ƒ</span></span><br><span class="line">gem environment </span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><ul><li>rubygems å­¦ä¹ æ‰‹å†Œï¼š<a href="https://guides.rubygems.org/rubygems-basics/">https://guides.rubygems.org/rubygems-basics/</a></li><li>ruby-chinaï¼š<a href="https://gems.ruby-china.com/">https://gems.ruby-china.com/</a></li></ul><hr><p><strong>ä»»ä½•å°äº‹éƒ½ä¸èƒ½å¿½è§†ï¼Œå¦åˆ™å¯èƒ½å°±ä¼šå‡ºå¤§äº‹</strong></p><p><img src="/upload/me/qrcode_wx2022.png"></p>]]></content>
      
      
      <categories>
          
          <category> Ruby-on-Rails </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ruby rails gem </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ruby on Rails: å¸¸ç”¨çš„å¼€å‘å·¥å…·</title>
      <link href="/2022/03/15/Ruby-on-Rails-%E5%B8%B8%E7%94%A8%E7%9A%84%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"/>
      <url>/2022/03/15/Ruby-on-Rails-%E5%B8%B8%E7%94%A8%E7%9A%84%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>å¥½çš„å·¥å…·èƒ½è®©å¼€å‘æ•ˆç‡äº‹åŠåŠŸå€ï¼Œæˆ‘æŠŠè‡ªå·±å¸¸ç”¨çš„å·¥å…·ä»‹ç»ç»™å¤§å®¶ï¼Œåç»­ä¼šæŒç»­æ›´æ–°ã€‚</p><p>å¦‚æœä½ æƒ³ä½¿ç”¨ ruby å¯ä»¥å‚è€ƒ <a href="https://veryitman.com/2022/03/14/Ruby-on-Rails-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">Ruby å¼€å‘ç¯å¢ƒæ­å»º</a>ã€‚</p><h2 id="å¸¸ç”¨ç½‘ç«™"><a href="#å¸¸ç”¨ç½‘ç«™" class="headerlink" title="å¸¸ç”¨ç½‘ç«™"></a>å¸¸ç”¨ç½‘ç«™</h2><ul><li>Ruby æ‰‹å†Œï¼š<a href="https://docs.ruby-lang.org/en/">ruby-doc</a>ï¼Œå¯ä»¥æŸ¥è¯¢ä¸åŒ ruby ç‰ˆæœ¬çš„æ–‡æ¡£</li><li>Ruby API æ‰‹å†Œï¼š <a href="https://rubyapi.org/">rubyapi</a></li><li>Gem å›½å†…é•œåƒï¼š<a href="https://gems.ruby-china.com/">gems.ruby-china</a></li><li>Ruby on Rails å®˜ç½‘ï¼š<a href="https://rubyonrails.org/">https://rubyonrails.org/</a></li><li>æŸ¥çœ‹ Rails æ‰€æœ‰ç‰ˆæœ¬ï¼š<a href="https://rubygems.org/gems/rails/versions">rail release</a></li><li><a href="https://ruby-china.github.io/rails-guides/">Ruby on Rails5.1 æŒ‡å—</a></li><li><a href="https://guides.rubyonrails.org/getting_started.html#creating-a-new-rails-project-installing-rails">Ruby on Rails7 æŒ‡å—</a></li><li><a href="https://api.rubyonrails.org/">Rails API</a></li></ul><h2 id="å¸¸ç”¨å·¥å…·"><a href="#å¸¸ç”¨å·¥å…·" class="headerlink" title="å¸¸ç”¨å·¥å…·"></a>å¸¸ç”¨å·¥å…·</h2><h3 id="é™æ€åˆ†æ"><a href="#é™æ€åˆ†æ" class="headerlink" title="é™æ€åˆ†æ"></a>é™æ€åˆ†æ</h3><ul><li><strong><a href="https://github.com/rubocop/rubocop">rubocop</a></strong></li></ul><blockquote><p>gem install rubocop</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd ruby-work-dir</span><br><span class="line"></span><br><span class="line">rubocop</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">æ£€æŸ¥æŒ‡å®šçš„æ–‡ä»¶</span></span><br><span class="line">rubocop xxx.rb</span><br></pre></td></tr></table></figure><h3 id="ä»£ç æ ¼å¼åŒ–"><a href="#ä»£ç æ ¼å¼åŒ–" class="headerlink" title="ä»£ç æ ¼å¼åŒ–"></a>ä»£ç æ ¼å¼åŒ–</h3><ul><li><strong><a href="https://github.com/ruby-formatter/rufo">rufo</a></strong></li></ul><blockquote><p>gem install rubocop</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd ruby-work-dir</span><br><span class="line"></span><br><span class="line">rufo .</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">æ ¼å¼åŒ–æŒ‡å®šçš„æ–‡ä»¶</span></span><br><span class="line">rufo xxx.rb</span><br></pre></td></tr></table></figure><p>æ­¤å·¥å…·ä¹Ÿä¼šåšä¸€äº›è¯­æ³•æ£€æµ‹çš„å·¥ä½œã€‚</p><h3 id="ä»£ç è§„èŒƒ"><a href="#ä»£ç è§„èŒƒ" class="headerlink" title="ä»£ç è§„èŒƒ"></a>ä»£ç è§„èŒƒ</h3><ul><li><p>ruby ä»£ç è§„èŒƒï¼š<a href="https://github.com/rubocop/ruby-style-guide">ruby-style-guide</a></p></li><li><p>rails ä»£ç è§„èŒƒï¼š<a href="https://github.com/rubocop/rails-style-guide">rails-style-guide</a></p></li></ul><h3 id="å¼€å‘-IDE"><a href="#å¼€å‘-IDE" class="headerlink" title="å¼€å‘ IDE"></a>å¼€å‘ IDE</h3><p>æ¨èä½¿ç”¨ <code>Visual Studio Code</code>ã€‚</p><p>å®‰è£…æ’ä»¶ï¼Œåœ¨ <code>VSCode</code> ä¸­æœç´¢å®‰è£…å³å¯ã€‚</p><ul><li><p><a href="https://marketplace.visualstudio.com/items?itemName=rebornix.Ruby">Ruby</a>ï¼›</p></li><li><p><a href="https://marketplace.visualstudio.com/items?itemName=hridoy.rails-snippets">Rails on Rails</a>ï¼›</p></li><li><p><a href="https://marketplace.visualstudio.com/items?itemName=castwide.solargraph">Ruby Solargraph</a>ï¼ŒåŠŸèƒ½æ¯”è¾ƒå¼ºå¤§ã€‚ä»£ç æç¤ºã€æ–¹æ³•æ–‡æ¡£æç¤ºç­‰ï¼›</p><blockquote><p>éœ€è¦ç”µè„‘ä¸Šå®‰è£… <code>solargraph</code></p></blockquote></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem install solargraph</span><br></pre></td></tr></table></figure><p><img src="/upload/images/2022/03/16/1.png" alt="image-20220316185104895"></p><p>å¦‚æœå¤§å®¶æœ‰è¶³å¤Ÿçš„ Moneyï¼Œå¯ä»¥è€ƒè™‘è´­ä¹° RubyMineï¼Œä¸è¿‡å»ºè®®åˆšå…¥é—¨çš„åŒå­¦è¿˜æ˜¯å…ˆä» <code>irb</code> ï¼ˆruby è‡ªå¸¦çš„å‘½ä»¤è¡Œäº¤äº’å·¥å…·ï¼Œç»ˆç«¯æ‰“å¼€ä½¿ç”¨å³å¯ï¼‰æˆ–è€… <code>VSCode</code> å¼€å§‹ã€‚</p><hr><p><strong>æœ¬æ˜¯åå±±äººï¼Œå¶åšå‰å ‚å®¢ï¼›é†‰èˆç»é˜åŠå·ä¹¦ï¼Œåäº•è¯´å¤©é˜”ã€‚</strong></p><p><img src="/upload/me/qrcode_wx2022.png"></p>]]></content>
      
      
      <categories>
          
          <category> Ruby-on-Rails </category>
          
      </categories>
      
      
        <tags>
            
            <tag> develop ruby rails </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ruby on Rails: ç¯å¢ƒæ­å»º</title>
      <link href="/2022/03/14/Ruby-on-Rails-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
      <url>/2022/03/14/Ruby-on-Rails-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æˆ‘çš„ç”µè„‘ä»¥åŠè‡ªå¸¦ Ruby ç¯å¢ƒå¦‚ä¸‹ã€‚</p><p>1ã€ç³»ç»Ÿç‰ˆæœ¬ï¼š<code>macOS Monterey 12.2.1</code></p><p>2ã€è‡ªå¸¦ ruby ç‰ˆæœ¬ï¼š<code>ruby 2.6.8p205 (2021-07-07 revision 67951) [universal.x86_64-darwin21]</code>ï¼Œå…¶äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ <code>/usr/bin/ruby</code> ä¸‹ã€‚</p><p>3ã€è‡ªå¸¦ gem ç‰ˆæœ¬ï¼š<code>3.1.6</code></p><p>è‡ªå¸¦çš„ ruby ç‰ˆæœ¬æ— æ³•æ”¯æŒ <code>rails 7.x</code> çš„ç‰ˆæœ¬ï¼ˆ<a href="https://rubygems.org/gems/rails/versions/7.0.2.3">å¯ä»¥æŸ¥çœ‹ Rails è¦æ±‚çš„ Ruby ç‰ˆæœ¬</a>ï¼‰ï¼Œæˆ‘éœ€è¦ä½¿ç”¨ <code>rvm</code> å¯¹ <code>ruby</code> ç‰ˆæœ¬è¿›è¡Œæ§åˆ¶ï¼Œä¸‹é¢é‡ç‚¹è®°å½•ä¸€ä¸‹å®‰è£…æ­¥éª¤å’Œè¿‡ç¨‹ã€‚</p><h2 id="å®‰è£…-Homebrew"><a href="#å®‰è£…-Homebrew" class="headerlink" title="å®‰è£… Homebrew"></a>å®‰è£… Homebrew</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/bin/bash -c <span class="string">&quot;<span class="subst">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)</span>&quot;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å‚è€ƒ <a href="https://brew.sh/">å®˜ç½‘</a> æœ€æ–°çš„å®‰è£…æ–¹å¼ã€‚</p><p>ä½¿ç”¨ brew å®‰è£… <code>git</code>ã€<code>curl</code> å·¥å…·ï¼Œå®‰è£…è¿‡ç¨‹ä¸­æç¤ºç¼ºå°‘å°±è€è€å®å®çš„å®‰è£…å•¥å°±å¥½äº†ã€‚</p><h2 id="å®‰è£…-RubyGems"><a href="#å®‰è£…-RubyGems" class="headerlink" title="å®‰è£… RubyGems"></a>å®‰è£… RubyGems</h2><p>ç®€ç§°ä¸º <code>gem</code> å·¥å…·ï¼Œ<code>macOS</code> ä¼šè‡ªå¸¦è¯¥å·¥å…·ä¸éœ€è¦å•ç‹¬å®‰è£…ï¼Œå¦‚æœæ²¡æœ‰å¯ä»¥ä½¿ç”¨ <code>brew</code> å®‰è£…ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt; </span><span class="language-bash">brew search gem</span></span><br><span class="line"><span class="meta">&gt; </span><span class="language-bash">If you meant <span class="string">&quot;gem&quot;</span> specifically:</span></span><br><span class="line">macOS provides gem as part of Ruby.</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥å» <a href="https://rubygems.org/pages/download">å®˜ç½‘</a> ä¸‹è½½å®‰è£…ã€‚</p><h2 id="å®‰è£…-rvm"><a href="#å®‰è£…-rvm" class="headerlink" title="å®‰è£… rvm"></a>å®‰è£… rvm</h2><p>å‚è€ƒï¼š<a href="https://rvm.io/">https://rvm.io/</a></p><p>å¦‚æœæ˜¯ Ubuntuï¼Œå¯ä»¥å‚è€ƒ <a href="https://github.com/rvm/ubuntu_rvm%EF%BC%9B">https://github.com/rvm/ubuntu_rvmï¼›</a></p><p>å®‰è£… <code>gpg2</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install gpg2 </span><br></pre></td></tr></table></figure><p>å¦‚æœå®‰è£…ä¸æˆåŠŸï¼Œå¯ä»¥å®‰è£… <code>gpg</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install gpg </span><br></pre></td></tr></table></figure><p>ç„¶åæ¥ç€åœ¨ç»ˆç«¯æ‰§è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg2 --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3 7D2BAF1CF37B13E2069D6956105BD0E739499BDB</span><br></pre></td></tr></table></figure><p>æˆ–è€…ä½¿ç”¨ <code>gpg</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3 7D2BAF1CF37B13E2069D6956105BD0E739499BDB</span><br></pre></td></tr></table></figure><p>æœ€åæ‰§è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\curl -sSL https://get.rvm.io | bash -s stable</span><br></pre></td></tr></table></figure><p>åœ¨ <code>ï½/.bash_profile</code> ä¸­æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œè®°å¾—ä¸‹é¢è¿™ä¸ªä¸€å®šè¦æ·»åŠ åœ¨æ–‡ä»¶çš„æœ€åï¼Œå¦åˆ™æ¯æ¬¡å¯åŠ¨å‘½ä»¤è¡Œéƒ½éœ€è¦è®¾ç½®ä¸€ä¸‹é»˜è®¤çš„ ruby ç‰ˆæœ¬ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">rvm</span></span><br><span class="line">[[ -s &quot;$HOME/.rvm/scripts/rvm&quot; ]] &amp;&amp; . &quot;$HOME/.rvm/scripts/rvm&quot;</span><br></pre></td></tr></table></figure><p>ä¿å­˜ååœ¨ç»ˆç«¯æ‰§è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source ï½/.bash_profile </span><br><span class="line"></span><br><span class="line">source ï½/.zshrc</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…-bundler"><a href="#å®‰è£…-bundler" class="headerlink" title="å®‰è£… bundler"></a>å®‰è£… <a href="https://www.bundler.cn/">bundler</a></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem install bundler</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…-ruby"><a href="#å®‰è£…-ruby" class="headerlink" title="å®‰è£… ruby"></a>å®‰è£… ruby</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1ã€brew update</span><br><span class="line"></span><br><span class="line">2ã€rvm get master</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">æŒ‡å®šå®‰è£…ç‰ˆæœ¬</span></span><br><span class="line">3ã€rvm install 2.7.5</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">æŸ¥çœ‹å·²ç»å®‰è£…çš„ruby</span></span><br><span class="line">4ã€rvm list</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">ä½¿ç”¨é»˜è®¤çš„ç‰ˆæœ¬</span></span><br><span class="line">5ã€rvm use ruby-2.7.5 --default</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…-rails"><a href="#å®‰è£…-rails" class="headerlink" title="å®‰è£… rails"></a>å®‰è£… rails</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">é»˜è®¤å®‰è£…æœ€æ–°ç‰ˆæœ¬</span></span><br><span class="line">sudo gem install rails </span><br></pre></td></tr></table></figure><p>å®‰è£…æˆåŠŸåï¼Œå¯ä»¥æŸ¥çœ‹ä¸€ä¸‹å®‰è£…çš„ç‰ˆæœ¬</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rails -v</span><br><span class="line"><span class="meta"># </span><span class="language-bash">æˆ‘å®‰è£…åçš„ rails ç‰ˆæœ¬æ˜¯ 7.0.2.3</span></span><br><span class="line">Rails 7.0.2.3</span><br></pre></td></tr></table></figure><h2 id="åˆ›å»ºé¡¹ç›®"><a href="#åˆ›å»ºé¡¹ç›®" class="headerlink" title="åˆ›å»ºé¡¹ç›®"></a>åˆ›å»ºé¡¹ç›®</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails new weibo --skip-bundle</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>weibo</code> æ˜¯é¡¹ç›®åç§°ï¼Œå‚æ•° <code>--skip-bundle</code> å¯ä»¥è·³è¿‡ä¾èµ–åº“çš„å®‰è£…ï¼Œè¿™æ ·åˆ›å»ºå·¥ç¨‹å¾ˆå¿«ã€‚</p><p>æ‰“å¼€å·¥ç¨‹ <code>weibo</code> ä¸‹é¢çš„ <code>Gemfile</code> æ–‡ä»¶ï¼Œä¿®æ”¹æºåœ°å€å³ä½¿ç”¨ <a href="https://gems.ruby-china.com,æ³¨æ„åŸæ¥çš„/">https://gems.ruby-china.comï¼Œæ³¨æ„åŸæ¥çš„</a> taobao æºå·²ç»åœæ­¢æ›´æ–°äº†ï¼Œå…¨éƒ¨æ”¾åˆ°äº† ruby-china ä¸Šäº†ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#source &quot;https://rubygems.org&quot;</span></span><br><span class="line"><span class="string">source</span> <span class="string">&quot;https://gems.ruby-china.com&quot;</span></span><br></pre></td></tr></table></figure><p>ä½ åœ¨ä½¿ç”¨ source é‡åˆ°äº†é—®é¢˜ï¼Œå¯ä»¥åœ¨ <a href="https://gems.ruby-china.com/">https://gems.ruby-china.com/</a> ä¸Šé¢æŸ¥æ‰¾ç­”æ¡ˆã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bundle install</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå®Œæˆåï¼Œå¯åŠ¨æœåŠ¡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails server</span><br></pre></td></tr></table></figure><p>æ‰“å¼€ <a href="http://127.0.0.1:3000/">http://127.0.0.1:3000</a> å¯ä»¥çœ‹åˆ°é»˜è®¤é¦–é¡µã€‚</p><hr><p><strong>å¾—å…ˆä»è‡ªå·±èº«ä¸Šæ‰¾é—®é¢˜</strong></p><p><img src="/upload/me/qrcode_wx2022.png"></p>]]></content>
      
      
      <categories>
          
          <category> Ruby-on-Rails </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ruby Rails Gem </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo+GithubPages 404</title>
      <link href="/2022/03/06/Hexo-GithubPages-404/"/>
      <url>/2022/03/06/Hexo-GithubPages-404/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>ç»§ä¸Šæ¬¡ <a href="http://veryitman.com/2018/02/02/Hi-2018-%E6%88%91%E5%8F%88%E6%9D%A5%E4%BA%86">2018ï¼Œæˆ‘åˆæ¥äº†</a> ä¸­è¯´ Hexo æ•°æ®ä¸¢å¤±å·²æœ‰å‡ ä¸ªå¹´å¤´äº†ï¼Œæ‰‹ä¸­çš„é‚£å°ç¬”è®°æœ¬è§è¯äº†æˆ‘å¤´å‘ç¨€ç–çš„è¿‡ç¨‹ï¼Œå®ƒå·²ç»åˆ°äº†é€€ä¼‘çš„å¹´é¾„ï¼Œè¿è¡Œé€Ÿåº¦å·²ç»æ— æ³•åŒ¹é…æˆ‘çš„æ‰‹é€Ÿäº†ã€‚äºæ˜¯æˆ‘çœåƒä¿­ç”¨æ¢äº†ä¸€å°ç”µè„‘ã€‚æˆ‘æœ€å…ˆè¿ç§»çš„å°±æ˜¯ Hexoï¼Œå› ä¸ºå®ƒå¤ªç®€å•å¥½ç”¨äº†å®åœ¨æ˜¯çˆ±ä¸é‡Šæ‰‹ã€‚ä¸‡ä¸‡æ²¡æƒ³åˆ°ä¸€ä¸ª 404 æŠ˜è…¾äº†æˆ‘å‡ å¤©å‡ å¤œï¼Œå‡ ä¹è®©æˆ‘å´©æºƒï¼Œè¿˜å¥½æœ€ç»ˆè§£å†³äº†ï¼Œä¸ç„¶æˆ‘çœŸçš„è¦å»ä½é™¢æ²»ç–—äº†ã€‚</p><h2 id="è¯¸å¤šæ–¹æ¡ˆ"><a href="#è¯¸å¤šæ–¹æ¡ˆ" class="headerlink" title="è¯¸å¤šæ–¹æ¡ˆ"></a>è¯¸å¤šæ–¹æ¡ˆ</h2><p>æˆ–è®¸ä½¿ç”¨ Hexo æ­å»ºä¸ªäººç½‘ç«™çš„æœ‹å‹è§è¿‡ä¸‹é¢è¿™å¼ å›¾</p><p><img src="/upload/images/2022/03/06/1.png"></p><p>å‡ºç°è¿™ç§ 404 æœ‰å¦‚ä¸‹å‡ ç§æƒ…å†µï¼Œä¸çŸ¥é“ä½ æ˜¯å“ªä¸€ç§ï¼Œå¬æˆ‘ä¸€ä¸€é“æ¥ã€‚</p><p><strong>1ã€github ä»“åº“åç§°ä¸åŒ¹é…</strong></p><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œæƒ³è¦éƒ¨ç½²è‡ªå·±çš„ github.ioï¼Œéœ€è¦åœ¨ github ä¸Šé¢åˆ›å»ºä»“åº“ã€‚</p><p>åœ¨ github ä¸Šé¢åˆ›å»ºçš„ä»“åº“åç§°æ²¡æœ‰ä½¿ç”¨è‡ªå·±çš„ github è´¦å·åç§°ï¼Œä¾‹å¦‚ä½ çš„ github è´¦å·åç§°æ˜¯ <code>zhanghao</code>ï¼Œè€Œä½ åˆ›å»ºçš„ä»“åº“åç§°æ˜¯ <code>suibian.github.io</code>ï¼Œè¿™æ ·ä½ ç¡®å®æ˜¯æ— æ³•è®¿é—®ä½ çš„åšå®¢ç½‘ç«™çš„ã€‚</p><p><strong>2ã€é…ç½®æ–‡ä»¶é”™è¯¯</strong></p><p>åœ¨ä½ çš„æœ¬åœ°åšå®¢ç›®å½•ä¸‹ï¼ˆæˆ‘åˆ›å»ºçš„åç§°æ˜¯ <code>hexo</code>ï¼Œæ³¨æ„ä¸æ˜¯ themes ä¸»é¢˜ç›®å½•ä¸‹çš„é‚£ä¸ªé…ç½®æ–‡ä»¶ï¼‰ï¼Œæœ‰ä¸ªé…ç½®æ–‡ä»¶ <code>_config.yml</code>ï¼Œé‡Œé¢å†…å®¹æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line"><span class="comment">#deploy: git@github.com:zhanghao/zhanghao.github.io.git</span></span><br><span class="line"><span class="comment">#type: git</span></span><br></pre></td></tr></table></figure><p>éœ€è¦ä¿®æ”¹ä¸€ä¸‹</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">git@github.com:zhanghao/zhanghao.github.io.git</span></span><br><span class="line">  <span class="comment">#branch: [master]</span></span><br><span class="line">  <span class="comment">#message: [message]</span></span><br></pre></td></tr></table></figure><p>ç‰¹åˆ«è¦æ³¨æ„ <code>repo</code> å’Œ <code>git</code> åé¢è¦æœ‰<strong>ç©ºæ ¼</strong>ã€‚</p><p><strong>3ã€åˆ†æ”¯é”™è¯¯</strong></p><p>ç°åœ¨åœ¨ github ä¸Šé¢åˆ›å»º repoï¼Œé»˜è®¤åˆ†æ”¯åç§°æ˜¯ <code>main</code> è€Œä¸æ˜¯ <code>master</code>ã€‚</p><p>æ‰€ä»¥ï¼Œä½ æœ¬åœ° Hexo æäº¤ï¼ˆ<code>hexo d</code> å‘½ä»¤ï¼‰çš„é»˜è®¤æ˜¯å»äº† <code>master</code> åˆ†æ”¯ï¼Œè¿™æ ·è®¿é—®ä¹Ÿæ˜¯æ²¡æœ‰å†…å®¹çš„ã€‚å¯ä»¥åœ¨ github ä¸Šé¢æŠŠä½ çš„ <code>zhanghao.github.io</code> ä»“åº“é»˜è®¤åˆ†æ”¯æ”¹ä¸º <code>master</code>ï¼Œå½“ç„¶è¿˜å¯ä»¥ä¿®æ”¹ Hexo çš„é…ç½®æ¥æ”¹å˜åˆ†æ”¯ä¸º <code>main</code>ï¼Œæˆ‘æ²¡æœ‰è¯•è¿‡å°±ä¸è¯¯äººå­å¼Ÿäº†ã€‚</p><p><strong>4ã€hexo ä¾èµ–ä¸å…¨</strong></p><p>æˆ‘åœ¨ hexo ç›®å½•ä¸‹ï¼Œæ£€æŸ¥äº†ä¸€ä¸‹ï¼Œå‘ç°è¯¥å®‰è£…çš„æ’ä»¶å·²ç»å¾ˆé½å…¨äº†ï¼Œæ¯•ç«Ÿæˆ‘æ˜¯æŠŠ <code>package.json</code> å¤åˆ¶è¿‡æ¥çš„ï¼Œä¸€ä¸ª <code>npm install</code> å¦¥å¦¥å®Œäº‹ã€‚</p><p>æ£€æŸ¥ä¾èµ–å®‰è£…æ˜¯å¦æœ‰ä¸å…¨çš„æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨ npm list å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm list --depth 0</span><br></pre></td></tr></table></figure><p>å¦‚æœæ£€æŸ¥æœ‰é—®é¢˜ï¼Œä¼šåœ¨æ§åˆ¶å°æç¤ºç±»ä¼¼ <code>npm ERR! missing xxxxx</code>ã€‚</p><p><strong>5ã€åŸŸåè§£æé”™è¯¯</strong></p><p>æˆ–è®¸ä½ é…ç½®äº†è‡ªå·±çš„åŸŸåï¼Œåœ¨é˜¿é‡Œäº‘æˆ–è€…è…¾è®¯äº‘ä¸Šé¢è´­ä¹°äº†è‡ªå·±çš„åŸŸåä¹Ÿé…ç½®äº†å¯¹åº”çš„ DNS è§£æï¼Œä½†å°±æ˜¯ 404ï¼Œä½ è¯´æ°”äººä¸ï¼Ÿï¼</p><p>å…³äºåœ¨äº‘ä¸Šé…ç½® CNAMEï¼Œæˆ‘å°±ä¸å¤šè®²äº†ï¼Œè¿™é‡Œä¸€å®šè¦åœ¨é…ç½®çš„æ—¶å€™æ£€æŸ¥ä¸€ä¸‹ä½ çš„ <code>zhanghao.github.io</code> IPï¼Œç„¶åå†å»é…ç½® A è®°å½•ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ping zhanghao.github.io</span><br><span class="line"></span><br><span class="line">PING veryitman.github.io (185.199.108.153): 56 data bytes</span><br><span class="line">64 bytes from 185.199.108.153: icmp_seq=0 ttl=43 time=78.002 ms</span><br><span class="line">64 bytes from 185.199.108.153: icmp_seq=1 ttl=43 time=119.590 ms</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ<code>185.199.108.153</code> å°±æ˜¯ <code>github.io</code> çš„ IPã€‚</p><p><strong>6ã€ä»“åº“ä¸­ CNAME ä¸ºç©º</strong></p><p>è¿™ç§é”™è¯¯ï¼Œå¯ä»¥åœ¨ source ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª CNAME æ–‡ä»¶ï¼Œå¡«å†™ä½ çš„åŸŸåå³å¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd hexo/source </span><br><span class="line"></span><br><span class="line">touch CNAME</span><br><span class="line"></span><br><span class="line">vim CNAME</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚æˆ‘çš„ CNAME æ–‡ä»¶å†…å®¹æ˜¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zhanghao.com</span><br></pre></td></tr></table></figure><p>ä¿å­˜å®Œæˆåï¼Œæ‰§è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure><h2 id="æˆ‘çš„é—®é¢˜"><a href="#æˆ‘çš„é—®é¢˜" class="headerlink" title="æˆ‘çš„é—®é¢˜"></a>æˆ‘çš„é—®é¢˜</h2><p>å¾ˆé—æ†¾çš„å‘Šè¯‰ä½ ï¼Œæˆ‘é‡åˆ°çš„é—®é¢˜ä¸Šé¢ 6 ç§æƒ…å†µéƒ½ä¸æ˜¯ã€‚</p><p>è€Œæ˜¯æˆ‘çš„ <code>node</code> ç‰ˆæœ¬å¤ªé«˜äº†ï¼ˆ17.xï¼‰ï¼Œæˆ‘ç”¨çš„ hexo ç‰ˆæœ¬æ˜¯ <code>4.2.1</code>ã€‚</p><p>å®˜æ–¹ç»™å‡ºäº†å¯¹åº”çš„å…¼å®¹ç‰ˆæœ¬è¦æ±‚ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><table><thead><tr><th>Hexo ç‰ˆæœ¬</th><th>æœ€ä½å…¼å®¹ Node.js ç‰ˆæœ¬</th></tr></thead><tbody><tr><td>6.0+</td><td>12.13.0</td></tr><tr><td>5.0+</td><td>10.13.0</td></tr><tr><td>4.1 - 4.2</td><td>8.10</td></tr><tr><td>4.0</td><td>8.6</td></tr><tr><td>3.3 - 3.9</td><td>6.9</td></tr><tr><td>3.2 - 3.3</td><td>0.12</td></tr><tr><td>3.0 - 3.1</td><td>0.10 or iojs</td></tr><tr><td>0.0.1 - 2.8</td><td>0.10</td></tr></tbody></table><p>åé¢æˆ‘å¸è½½äº† <code>node</code>ï¼Œé‡æ–°å®‰è£…äº† <code>node 12</code>ï¼Œä¸€é¡¿æ“ä½œã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">brew install node@12</span><br><span class="line"></span><br><span class="line">hexo clean</span><br><span class="line"></span><br><span class="line">hexo g</span><br><span class="line"></span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>å†æ¬¡æ‰“å¼€è‡ªå·±çš„ç½‘ç«™ï¼Œä¸€åˆ‡éƒ½æ­£å¸¸äº†ï¼Œå–œå‡ºæœ›å¤–ã€‚</p><p>å½“ä½ ç—´è¿·ä¸€ä»¶äº‹æƒ…çš„æ—¶å€™ï¼Œè¿åšæ¢¦éƒ½ä¼šå¸®ä½ æ€è€ƒè§£å†³æ–¹æ¡ˆã€‚</p><hr><p><strong>è€å¤©çš„äº‹å„¿ç®¡ä¸äº†ï¼ŒæŠŠè‡ªå·±çš„äº‹æƒ…åšå¥½å°±å¥½ã€‚</strong></p><p><img src="/upload/me/qrcode_wx2022.png"></p>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tool hexo githubpages </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSHé—®é¢˜æ±‡é›†ç¬”è®°</title>
      <link href="/2022/03/05/SSH%E9%97%AE%E9%A2%98%E6%B1%87%E9%9B%86%E7%AC%94%E8%AE%B0/"/>
      <url>/2022/03/05/SSH%E9%97%AE%E9%A2%98%E6%B1%87%E9%9B%86%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æœ€è¿‘æ¢äº†ç”µè„‘å¹¶ä¸”å‡çº§äº† macOSï¼Œå‘ç°åœ¨ä½¿ç”¨ SSH é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œåœ¨æ­¤è®°å½•å¸Œæœ›èƒ½å¸®åˆ°æ›´å¤šçš„æœ‹å‹ã€‚</p><h2 id="æ— æ³•è¿æ¥è¿œç¨‹æœåŠ¡å™¨"><a href="#æ— æ³•è¿æ¥è¿œç¨‹æœåŠ¡å™¨" class="headerlink" title="æ— æ³•è¿æ¥è¿œç¨‹æœåŠ¡å™¨"></a>æ— æ³•è¿æ¥è¿œç¨‹æœåŠ¡å™¨</h2><p>æ‰§è¡Œè¿œç¨‹è¿æ¥ï¼Œå¦‚ä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh root@ip.ip.ip.ip </span><br></pre></td></tr></table></figure><p>æ§åˆ¶å°æç¤ºå¦‚ä¸‹é”™è¯¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Unable to negotiate with legacyhost: no matching key exchange method found.</span><br><span class="line">Their offer: diffie-hellman-group1-sha1</span><br></pre></td></tr></table></figure><p><strong>è§£å†³æ–¹æ¡ˆ</strong></p><p>1ã€åˆ›å»º <code>ï½/.ssh</code> ç›®å½•</p><p>2ã€åœ¨<code>ï½/.ssh</code> ç›®å½•ä¸‹æ–°å»º <code>config</code> æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir ~/.ssh</span><br><span class="line"></span><br><span class="line">cd ~/.ssh</span><br><span class="line"></span><br><span class="line">touch config</span><br></pre></td></tr></table></figure><p>3ã€ç¼–è¾‘ <code>config</code> æ–‡ä»¶ï¼Œå†™å…¥å¦‚ä¸‹å†…å®¹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Host *</span><br><span class="line">    KexAlgorithms +diffie-hellman-group1-sha1</span><br></pre></td></tr></table></figure><h2 id="æ— æ³•æäº¤ä»£ç åˆ°-Github"><a href="#æ— æ³•æäº¤ä»£ç åˆ°-Github" class="headerlink" title="æ— æ³•æäº¤ä»£ç åˆ° Github"></a>æ— æ³•æäº¤ä»£ç åˆ° Github</h2><p>å½“æäº¤è‡ªå·±çš„ä»£ç åˆ°è‡ªå·±çš„ git ä»“åº“æ—¶ï¼Œå‘ç”Ÿäº†å°´å°¬çš„ä¸€å¹•ï¼Œæç¤ºçš„é”™è¯¯ä¿¡æ¯å¤§è‡´å¦‚ä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Please make sure you have the correct access rights and the repository exists.</span><br></pre></td></tr></table></figure><p>åé¢å‘ç°éœ€è¦è®¾ç½®æœ¬åœ°çš„å…¬é’¥ï¼Œè¯¥å…¬é’¥ç›¸å½“äºæœ¬åœ°å’Œè¿œç¨‹ github çš„é“¾æ¥æ¡¥æ¢ï¼Œæ’¸èµ·è¢–å­å¼€æã€‚å®Œæ•´æ•™ç¨‹å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼Œ<a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh">æˆ³æˆ‘</a>å³å¯ã€‚</p><p>å‡è®¾ä½ çš„ github è´¦å·åç§°æ˜¯ <code>zhanghao</code>ï¼Œé‚®ç®±æ˜¯ <code>zhanghao@126.com</code></p><p><strong>1ã€å…¨å±€é…ç½®è´¦å·å’Œé‚®ç®±</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git config --global  user.name &quot;zhanghao&quot;</span><br><span class="line"></span><br><span class="line">git config --global user.email &quot;zhanghao@126.com&quot;</span><br></pre></td></tr></table></figure><p><strong>2ã€ç”Ÿæˆå…¬ç§é’¥</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;zhanghao@126.com&quot;</span><br></pre></td></tr></table></figure><p>åœ¨æ¥ä¸‹æ¥æç¤ºçš„è¿‡ç¨‹ä¸­ï¼Œæœ€å¥½ä¸è¦è®¾ç½®å¯†ç å³ç›´æ¥å›è½¦ã€‚</p><p>å®Œæˆä¹‹åï¼Œä¸å‡ºæ„å¤–ä¼šåœ¨ <code>ï½/.ssh</code> ç›®å½•ä¸‹ç”Ÿæˆ <code>id_rsa.pub</code> å…¬é’¥æ–‡ä»¶å’Œ <code>id_rsa</code> ç§é’¥æ–‡ä»¶ã€‚</p><p><strong>3ã€é…ç½® github</strong> </p><p>ç™»å…¥ githubï¼Œåˆ†åˆ«ç‚¹å‡» Settings &#x2F; SSH and GPG keys &#x2F; New SSH keyï¼Œå¤åˆ¶ <code>id_rsa.pub</code> å…¬é’¥æ–‡ä»¶é‡Œé¢çš„å†…å®¹ç²˜è´´ä¿å­˜å³å¯ã€‚</p><p>åœ¨æ§åˆ¶å°æµ‹è¯•ä¸€ä¸‹æ˜¯å¦æˆåŠŸ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure><p>æç¤ºå¦‚ä¸‹ä¿¡æ¯å³å¯è¡¨ç¤ºæˆåŠŸ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hi zhanghao! You&#x27;ve successfully authenticated, but GitHub does not provide shell access</span><br></pre></td></tr></table></figure><p><strong>4ã€ç”Ÿæˆè®¿é—®ä»¤ç‰Œï¼ˆå¯é€‰ï¼‰</strong></p><p>å¦‚æœç›´æ¥ä½¿ç”¨è´¦å·å¯†ç åœ¨æ§åˆ¶å°ç™»å…¥ github æ˜¯ä¸€ä»¶æ¯”è¾ƒå±é™©çš„äº‹æƒ…ï¼Œæ‰€ä»¥ github é‡‡ç”¨äº†ä»¤ç‰Œçš„è®¿é—®æ–¹å¼ï¼Œä¸€æ—¦å‘ç”Ÿæ³„æ¼å¯ä»¥å³å¯åˆ é™¤è¯¥ä»¤ç‰Œã€‚</p><p>ç™»å…¥ githubï¼Œåˆ†åˆ«ç‚¹å‡» Settings &#x2F; Developer settings &#x2F; Personal access tokens &#x2F; Generate new token</p><p>ç”Ÿæˆä¹‹åï¼Œéœ€è¦ä½ è‡ªå·±ä¿å­˜ä¸‹æ¥ï¼Œåœ¨éœ€è¦ä½¿ç”¨å¯†ç çš„åœ°æ–¹ä½¿ç”¨è¯¥ä»¤ç‰Œå³å¯ã€‚</p><h2 id="æ¸…é™¤æœ¬åœ°å…¬é’¥"><a href="#æ¸…é™¤æœ¬åœ°å…¬é’¥" class="headerlink" title="æ¸…é™¤æœ¬åœ°å…¬é’¥"></a>æ¸…é™¤æœ¬åœ°å…¬é’¥</h2><p>æˆ‘çœ‹è‡ªå·±çš„äº‘ä¸»æœº CPU ä½¿ç”¨ç‡ä¸€ç›´å¾ˆé«˜ï¼Œæ€€ç–‘æ˜¯ä¸­æ¯’äº†ï¼Œå°±ç»™äº‘ä¸»æœºé‡æ–°å®‰è£…äº†ç³»ç»Ÿã€‚</p><p>ç³»ç»Ÿå®‰è£…å®Œæˆåï¼Œå‘ç° ssh è¿ä¸ä¸Šäº‘ä¸»æœºäº†ï¼Œå¹¶ä¸”åœ¨ç»ˆç«¯æç¤ºå¦‚ä¸‹ä¿¡æ¯ï¼š</p><blockquote><p>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@<br>@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @<br>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@<br>IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!<br>Someone could be eavesdropping on you right now (man-in-the-middle attack)!<br>It is also possible that a host key has just been changed.</p></blockquote><p>æ¸…é™¤æœ¬åœ°å…¬é’¥å‘½ä»¤å¦‚ä¸‹ï¼Œæ¸…é™¤å®Œæˆåé‡æ–°ä½¿ç”¨ ssh ç™»å½•å³å¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">æ¢æˆè‡ªå·±çš„äº‘æœåŠ¡å™¨å¤–ç½‘IP</span></span><br><span class="line">ssh-keygen -R ip-addr</span><br></pre></td></tr></table></figure><p>å‘½ä»¤ <code>ssh-keygen -R ip</code> æœ¬è´¨æ˜¯æ¸…ç©º <code>~/.ssh/known_hosts</code>æ–‡ä»¶å†…å®¹ï¼Œå¹¶ç»™ä½ åšä¸ªå¤‡ä»½é‡å‘½åä¸º <code>~/.ssh/known_hosts.old</code>ï¼Œåˆå­¦åˆ°ä¸€æ‹›ã€‚</p><hr><p><strong>å‹¿ä»¥å–„å°è€Œä¸ä¸º</strong></p><p><img src="/upload/me/qrcode_wx2022.png"></p>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SSH tool </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¿ƒæµ</title>
      <link href="/2022/02/13/%E5%BF%83%E6%B5%81/"/>
      <url>/2022/02/13/%E5%BF%83%E6%B5%81/</url>
      
        <content type="html"><![CDATA[<p>å†¬å­£çš„é˜³å…‰é€è¿‡çª—å¸˜æ´’åˆ°æ²™å‘ä¸Šï¼Œè™½æ²¡æœ‰å¤å­£é‚£èˆ¬çš„ç”ŸçŒ›ä½†ä¾æ—§é‚£ä¹ˆè€€çœ¼ã€‚æ¸…æ™¨å¦‚çº¦è€Œè‡³ï¼Œé©¬è·¯ä¸Šæ€¥ä¿ƒçš„å–‡å­å£°æš—ç¤ºä¸Šç­æ—¶é—´å·²ç»åˆ°äº†ï¼Œæˆ‘æˆ´ä¸Šè€³æœºéª‘ä¸Šå°é»„å¥”èµ´åŠå…¬å®¤ã€‚ä¸€å¤©çš„å·¥ä½œåœ¨è‡ªæˆ‘å®‰æ’ä¸­æ‚„ç„¶æœ‰åºçš„å¼€å§‹äº†ï¼Œæ¯å¤©å·¥ä½œçš„å†…å®¹ä¸ä¸€æ ·ä½†èŠ‚å¥åŸºæœ¬ä¸€è‡´ï¼Œæˆ‘å·²ç»ä¹ æƒ¯å¹¶äº«å—ç€è¿™ä»½å¿™ç¢Œçš„å¿«ä¹ï¼Œæ—¥å¤ä¸€æ—¥å¹´å¤ä¸€å¹´ã€‚æˆ–è®¸åœ¨æœ‹å‹çœ¼ä¸­æˆ‘å°±æ˜¯ä¸ªå·¥ä½œç‹‚è€Œä¸”ä¸ä¼šæ„Ÿè§‰åˆ°ç´¯çš„äººï¼Œå…¶å®ä»–ä»¬ä¸çŸ¥é“ï¼Œå“ªæœ‰å·¥ä½œä¸ç´¯çš„ï¼Œæˆ‘åªæ˜¯èƒ½åœ¨å·¥ä½œä¸­æ‰¾åˆ°è®©è‡ªå·±å¿«ä¹çš„â€œçµä¸¹å¦™è¯â€è€Œå·²ï¼Œæˆ‘å–œæ¬¢è®©è‡ªå·±å¿™ä¸€ç‚¹å»è®©å‘¨å›´çš„äººæ›´å¿«ä¹ä¸€äº›ï¼Œå›´ç»•ç€ç›®æ ‡å’Œä¸€ç¾¤æœ‰å·¥ä½œæ¿€æƒ…çš„äººåœ¨ä¸€èµ·å·¥ä½œæ˜¯ä¸€ä»¶å¾ˆå¹¸ç¦çš„äº‹æƒ…ã€‚å·¥ä½œä¸­æˆ‘ä¼šäº§ç”Ÿå¿ƒæµï¼Œå®ƒä¹Ÿä¸€ç›´è®©æˆ‘æˆé•¿ç€ã€‚</p><p>è¯´åˆ°å¿ƒæµï¼Œä¸å¾—ä¸æ¨èç±³å“ˆé‡ŒÂ·å¥‘å…‹æ£®ç±³å“ˆèµ–å¤§å¸ˆçš„ã€Šå¿ƒæµï¼šæœ€ä¼˜ä½“éªŒå¿ƒç†å­¦ã€‹è¿™æœ¬ä¹¦ã€‚ä¹¦ä¸­æåˆ°äº†ä¸‰ä¸ªæ ¸å¿ƒå…³é”®è¯å³å¹¸ç¦ã€æœ€ä¼˜ä½“éªŒï¼ˆä»–ç§°ä¹‹ä¸ºå¿ƒæµï¼‰å’Œç²¾ç¥ç†µã€‚ä¸ªäººä»ä¸­è·ç›Šè‰¯å¤šï¼Œç»“åˆè‡ªå·±å·¥ä½œä¸­çš„ä½“éªŒè®²è®²å¦‚ä½•è·å¾—å¿ƒæµğŸ˜„ã€‚</p><p>æˆ‘ä»¬å…ˆçœ‹çœ‹ä»€ä¹ˆæ˜¯ â€œç†µâ€ã€‚</p><h2 id="å„ç§ç†µ"><a href="#å„ç§ç†µ" class="headerlink" title="å„ç§ç†µ"></a>å„ç§ç†µ</h2><p>åœ¨å¾®ä¿¡ä¸­æœç´¢ â€œç†µâ€ï¼Œå„ç§å„æ ·çš„æ–‡ç« å±‚å‡ºä¸ç©·ã€‚</p><p><img src="/upload/images/2022/02/13/1.png"></p><p>ç†µï¼ˆshÄngï¼‰ï¼Œè‹±æ–‡æ˜¯ <code>Entropy</code> ï¼Œå±äºç‰©ç†å­¦ä¸­çš„çƒ­åŠ›å­¦æ¦‚å¿µã€‚çƒ­åŠ›å­¦ä¸­è¡¨å¾ç‰©è´¨çŠ¶æ€çš„å‚é‡ä¹‹ä¸€ï¼Œç”¨ç¬¦å· <code>S</code> è¡¨ç¤ºï¼Œå…¶ç‰©ç†æ„ä¹‰æ˜¯ <strong>ä½“ç³»æ··ä¹±ç¨‹åº¦çš„åº¦é‡</strong>ã€‚çƒ­åŠ›å­¦ç¬¬ä¸€å®šå¾‹æ˜¯èƒ½é‡å®ˆæ’åŸç†ï¼Œçƒ­åŠ›å­¦ç¬¬äºŒå®šå¾‹æ˜¯ç†µåŸç†ï¼Œè¿™ä¸¤ä¸ªå®šå¾‹æ˜¯æœ€åŸºç¡€çš„ç†è®ºã€‚æœ‰åºè¶‹äºæ— åºï¼Œæ— åºçš„é‡åº¦è¢«ç§°ä½œâ€œç†µâ€ã€‚</p><p>å¬èµ·æ¥äº‘é‡Œé›¾é‡Œçš„ï¼Œç¬¬ä¸€æ¬¡åœ¨é«˜ä¸­ç‰©ç†è¯¾å ‚ä¸Šå¬åˆ°ç†µè¿™ä¸ªä¸œè¥¿ï¼Œè€å¸ˆè®²çš„åæ²«æ¨ªé£ï¼Œæˆ‘å¬çš„æ˜¯æ‘‡æ‘‡æ¬²å ï¼Œè¿˜å¥½è€å¸ˆå½“æ—¶è¯´ï¼šâ€œå¤§å®¶å…ˆä¸ç†è§£æ²¡å…³ç³»ï¼Œå…ˆè®°ä½è¿™ä¸ªä¸œè¥¿ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªå•ä½ï¼Œåé¢æ…¢æ…¢å°±ä¼šç†è§£çš„â€ã€‚è€å¸ˆå½“æ—¶çš„å®‰æ…°å·²ç»è®©æˆ‘ä»¬å†…å¿ƒä¸å®‰çš„ä¸–ç•Œå¼€å§‹ç†µå‡äº†ã€‚</p><p>ä¸¾ä¸ªæ —å­ğŸŒ°~</p><p>ä½ åˆšæ¬è¿›ä¸€ä¸ªæ–°å®¶ï¼Œæ•´é½åˆ’ä¸€å¹²å‡€æ•´æ´çš„ç¯å¢ƒè®©ä½ è€³ç›®ä¸€æ–°ï¼Œå®¶å…·é¤å…·æ‘†æ”¾çš„æœ‰æ¡ä¸ç´Šï¼Œé€ç€é˜³å…‰çš„ç…§è€€ï¼Œåœ°æ¿æ˜¾å¾—æ ¼å¤–å…‰é²œäº®ä¸½ã€‚éšç€æ—¶é—´çš„æ¨ç§»å’Œä¸ªäººè´­ç‰©éœ€æ±‚çš„å¢é•¿ï¼Œä½ å®¶é‡Œå æ”¾çš„ä¸œè¥¿è¶Šæ¥è¶Šå¤šï¼Œæœ‰é™çš„ç©ºé—´ä¼šå˜å¾—è¶Šå‘æ··ä¹±ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªç†µå¢çš„è¿‡ç¨‹ã€‚å¾ˆå¤šäººä¼šæ”¶æ‹¾æ—§ä¸œè¥¿å¹¶ä¸”æŠŠå®ƒæ‰”æ‰æˆ–è€…æèµ ç»™åˆ«äººä¼šè§‰å¾—å¿ƒæ—·ç¥æ€¡ï¼ŒåŸæ¥ä»–ä»¬è¿™æ ·åšå¯ä»¥è®©æ•´ä¸ªå®¶å˜å¾—è¶Šæ¥è¶Šæœ‰ç§©åºï¼Œæ‡‚å¾—å–èˆå¾ˆå…³é”®ã€‚</p><p>å·¥ä½œä¹‹åï¼Œé™†é™†ç»­ç»­çœ‹åˆ°å¾ˆå¤šæ–‡ç« åœ¨è®²ç†µå½¢æ€ç›¸å…³çš„å†…å®¹ï¼Œä¾‹å¦‚ä¿¡æ¯ç†µã€åç†µã€å…±äº«ç†µã€å¿ƒçµä¹‹ç†µå’Œåˆ†å¸ƒå¼ä¹‹ç†µè¯¸å¦‚æ­¤ç±»ã€‚çœ‹åˆ°è¿™äº›æ–‡ç« çš„æ„Ÿå—ï¼Œå°±å¥½æ¯”æ— æ³•ç†è§£å¿ƒç†å­¦å®¶ä¸¹å°¼å°”Â·å¡å°¼æ›¼ä¸ºä»€ä¹ˆèƒ½è·å¾—è¯ºè´å°”ç»æµå­¦å¥–ä¸€æ ·è´¹è§£ã€‚ç›´åˆ°è‡ªå·±è®¤çœŸçœ‹å®Œç±³å“ˆé‡ŒÂ·å¥‘å…‹æ£®ç±³å“ˆèµ–çš„ã€Šå¿ƒæµï¼šæœ€ä¼˜ä½“éªŒå¿ƒç†å­¦ã€‹è¿™æœ¬ä¹¦ä¹‹åï¼Œæ„Ÿè§‰ç¡®å®å¯ä»¥ç”¨ç†µçš„ç‰©ç†å­¦æ¦‚å¿µè§£é‡Šå¾ˆå¤šå·¥ä½œã€ç”Ÿæ´»ã€å©šå§»æ–¹é¢çš„äº‹æƒ…ï¼Œå€æ„Ÿæ”¶ç›Šï¼Œå…¶å®å¾ˆå¤šçŸ¥è¯†æ˜¯ç›¸é€šçš„ã€‚</p><p>ã€Šå¿ƒæµï¼šæœ€ä¼˜ä½“éªŒå¿ƒç†å­¦ã€‹æå‡ºäº†ç²¾ç¥ç†µçš„æ¦‚å¿µã€‚ç±³å“ˆé‡Œè¯´ç²¾ç¥ç†µæ˜¯æŒ‡å„ç§èµ„è®¯ä¿¡æ¯ä¼šç»™äººä»¬æ„è¯†ä¸­çš„ç›®æ ‡å’Œç»“æ„å¸¦æ¥å¨èƒï¼ˆæ¯”å¦‚ <a href="http://www.veryitman.com/2021/11/28/%E8%A1%8C%E5%8A%A8%E8%B5%B7%E6%9D%A5%E6%89%8D%E8%83%BD%E8%A7%A3%E5%86%B3%E7%84%A6%E8%99%91/">ç„¦è™‘</a>ï¼‰ï¼Œå°†å¯¼è‡´å†…å¿ƒå¤±å»ç§©åºï¼Œå°±æ˜¯ç²¾ç¥ç†µã€‚</p><p>ç±³å“ˆé‡Œæ‰€è¯´çš„å¿ƒæµæŒ‡çš„æ˜¯å¿ƒç†ä¸Šå¯è·å¾—çš„æœ€ä¼˜ä½“éªŒï¼Œèƒ½ç»™ä½ å¸¦æ¥æ— æ³•è¨€è¯­çš„å¿ƒçµæ„Ÿå—ï¼Œæœ€é‡è¦çš„æ˜¯å¿ƒæµä¼šå¸¦ç»™ä½ æˆé•¿ã€‚ç±³å“ˆé‡Œè¯´â€œç²¾ç¥ç†µæ˜¯å¸¸æ€â€ï¼Œåœ¨ä»–çœ‹æ¥ç²¾ç¥ç†µçš„åé¢å°±æ˜¯æœ€ä¼˜ä½“éªŒï¼Œä»–ç§°ä¹‹ä¸ºâ€œå¿ƒæµâ€ã€‚ä»Šå¤©ä½ ç»™è‡ªå·±å®šäº†ä¸€ä¸ªå°ç›®æ ‡æ¯”å¦‚ä¿®å¤ä¸€ä¸ªå¾ˆéš¾å¤ç°çš„äº§å“ç¼ºé™·ï¼Œé€šè¿‡è‡ªå·±çš„ä¸“æ³¨åŠ›å’Œä¸“ä¸šèƒ½åŠ›åœ¨ä¸‹ç­å‰æå®šäº†ï¼Œä½ é‚£ä¸ªæ—¶åˆ»ç”šè‡³æ¥ä¸‹æ¥çš„å¾ˆé•¿ä¸€æ®µæ—¥å­é‡Œéƒ½æ˜¯æ»¡è¶³çš„ï¼Œå†…å¿ƒæ˜¯å¹¸ç¦çš„ï¼Œè‡³å°‘ä½ å‘è‡ªå·±è¯æ˜äº†è‡ªå·±çš„èƒ½åŠ›ã€‚</p><h2 id="è·å¾—å¿ƒæµ"><a href="#è·å¾—å¿ƒæµ" class="headerlink" title="è·å¾—å¿ƒæµ"></a>è·å¾—å¿ƒæµ</h2><p>æ¯ä¸ªäººå¯¹å¹¸ç¦çš„ç†è§£ä¸ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¾ˆéš¾ç”¨ä¸€å¥è¯è§£é‡Šæˆ–è€…è¯´æ˜åˆ°åº•ä»€ä¹ˆæ˜¯å¹¸ç¦ã€‚å¹¸ç¦å‘ç”Ÿçš„æ—¶åˆ»å¯èƒ½æ˜¯å¬åˆ°æœ‹å‹æˆ–è€…å®¶äººçš„ä¸€å¥è¯ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªå¾®ç¬‘ï¼Œä¹Ÿå¯èƒ½æ˜¯ä½ æ­£åœ¨é˜…è¯»ã€å†™ä½œæˆ–è€…å·¥ä½œçš„çŠ¶æ€ã€‚</p><p>å¹¸ç¦æ˜¯ä¸å®¹æ˜“å¾—åˆ°çš„ï¼Œå¤§è‡ªç„¶å¹¶ä¸æ˜¯ä¸ºäººç±»æ‰€æœåŠ¡çš„ã€‚æ¢å¥è¯è¯´ï¼Œå®‡å®™å…¶å®æ˜¯ä¸åœ¨ä¹æˆ‘ä»¬çš„ï¼Œäººç±»ä»è¯ç”Ÿåˆ°ç°åœ¨ä»ç„¶è¦é¢å¯¹å„ç§è‡ªç„¶ç¾å®³ä»¥åŠç”Ÿè€ç—…æ­»ã€‚äººçš„æ¬²æœ›ä¹Ÿæ˜¯æ— æ­¢å¢ƒçš„ï¼Œå¥½çš„æƒ³æ›´å¥½ã€‚æƒ³è·å¾—å¹¸ç¦ä½ éœ€è¦æœ‰ä¸ªå¹³å¸¸å¿ƒã€‚</p><p>èƒ½å¤Ÿç”¨è‡ªå·±çš„èƒ½åŠ›å®Œæˆè·³ä¸€è·³å¤Ÿå¾—ç€çš„äº‹æƒ…æ‰ä¼šè®©ä½ æœ‰æˆå°±æ„Ÿï¼Œå¯ä»¥é€ å°±å¿ƒæµçš„æ´»åŠ¨ä¸­éœ€è¦æœ‰åŠ¨æ€çš„æŒ‘æˆ˜ï¼Œå³å½“æŒ‘æˆ˜ä¸ä½ çš„æŠ€èƒ½åŒ¹é…æ—¶ï¼Œå°±ä¼šæœ‰å¿ƒæµã€‚å½“æŒ‘æˆ˜çš„ç›®æ ‡å¤§å¤§é«˜è¿‡ä½ çš„æŠ€èƒ½æ—¶ï¼Œå°†äº§ç”Ÿç„¦è™‘ï¼Œæ­¤æ—¶åº”é™ä½æŒ‘æˆ˜ç›®æ ‡ã€‚å½“ä½ çš„æŠ€èƒ½é«˜è¿‡è®¾å®šçš„ç›®æ ‡ï¼Œç»§ç»­æŒç»­è¿™ç§æ´»åŠ¨å°†äº§ç”ŸåŒå€¦ï¼Œä¾¿è¦æå‡ç›®æ ‡ï¼Œä»¥æ±‚æŒ‘æˆ˜å’Œå¿ƒæµçš„æŒç»­ã€‚æ­£æ˜¯åœ¨æŠ€å·§æé«˜ã€ç›®æ ‡ä¸Šè°ƒçš„è¿‡ç¨‹ä¸­ï¼Œå½“äº‹è€…æ„Ÿå—åˆ°äº†æˆé•¿çš„ä¹è¶£ã€‚æ­¤ä¸ºå¹¸ç¦ä¹‹çœŸè°›ã€‚æ­£å¦‚ä¸‹é¢è¿™å¼ å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2022/02/13/2.png"></p><p>é‚£æˆ‘ä»¬å¦‚ä½•æ‰èƒ½è·å¾—å¿ƒæµå‘¢ï¼Ÿ</p><p>ä¸ªäººæ‹™è§ï¼Œæœ€é‡è¦çš„ä¸€ç‚¹å°±æ˜¯åšè‡ªå·±å–œæ¬¢çš„äº‹æƒ…ï¼Œå¦åˆ™å¾ˆéš¾è¾¾åˆ°å¿ƒçµä¸Šçš„æœ€ä¼˜ä½“éªŒï¼Œå³ä½¿æœ‰å¿ƒæµçš„æ„Ÿè§‰ä¹Ÿæ˜¯æ˜™èŠ±ä¸€ç°ï¼Œé•¿æœŸæ¥çœ‹ä¹Ÿå¾ˆéš¾æœ‰æ‰€æˆé•¿ã€‚è¿™ä¹Ÿæ˜¯ç±³å“ˆé‡Œæ‰€è¯´çš„ï¼Œæƒ³è·å¾—å¿ƒæµï¼Œéœ€è¦æœ‰ä¸€ä¸ªèƒ½ä¸ºä¹‹ä»˜å‡ºçš„ç›®æ ‡ï¼Œå¹¶ä¸”èƒ½å¤Ÿé›†ä¸­æ³¨æ„åŠ›ï¼Œä¸“æ³¨çš„å»å®Œæˆã€‚å› å…¨ç¥è´¯æ³¨äºæ­¤ï¼Œæ—¥å¸¸æ¼äººçš„çäº‹è¢«å¿˜å´å’Œå±è”½ï¼Œè¿™æ ·ä¸€æ¥ä½ çš„ç²¾ç¥ç†µå°±ä¼šå‡å°‘ï¼Œè·å¾—å¿ƒæµçš„æ„Ÿå—å°±ä¼šè¶Šå¼ºã€‚</p><p>é‚£æˆ‘ä»¬èŠèŠè‡ªå¾‹ï¼Œæˆ‘å§‹ç»ˆç›¸ä¿¡è‡ªå¾‹çš„äººç”Ÿæ˜¯å¹¸ç¦çš„ã€‚</p><p>æ‰€è°“çš„è‡ªå¾‹ï¼Œå…¶å®ä¹Ÿæ˜¯ä¸€ç§å¿ƒæµçš„æ„Ÿè§‰ï¼ŒçœŸæ­£çš„è‡ªå¾‹æ˜¯ä¸å­˜åœ¨çš„æˆ–è€…è¯´æ˜¯éª—äººçš„ã€‚åªæœ‰åœ¨æŸä»¶äº‹æƒ…ä¸Šä½ å°åˆ°äº†ç”œå¤´ï¼Œä½ æ‰æ„¿æ„ä¸€ç›´åšæŒä¸‹å»ï¼Œè¿™æ‰å½¢æˆäº†æ‰€è°“çš„è‡ªå¾‹ã€‚ã€Šå°‘æœ‰äººèµ°çš„è·¯ã€‹è¿™æœ¬ä¹¦é‡Œè§£é‡Šäº†è‡ªå¾‹çš„å«ä¹‰ã€‚æ‰€è°“è‡ªå¾‹ï¼Œå°±æ˜¯ä»¥ç§¯æä¸»åŠ¨çš„æ€åº¦ï¼Œå»è§£å†³äººç”Ÿç—›è‹¦çš„é‡è¦åŸåˆ™ï¼Œä¸»è¦åŒ…æ‹¬å››ä¸ªæ–¹é¢ï¼šæ¨è¿Ÿæ»¡è¶³æ„Ÿã€æ‰¿æ‹…è´£ä»»ã€å°Šé‡äº‹å®ã€ä¿æŒå¹³è¡¡ã€‚è‡ªå¾‹ä¸ç­‰äºè¢«é€¼è¿«ã€‚å¦‚æœä¸€ä¸ªäººæ‹¼å¾—æ»¡å¤´å¤§æ±—ï¼Œå´ä»ç„¶å¼ºè¿«è‡ªå·±å»å®ŒæˆæŸä»¶äº‹ï¼Œé‚£ä¹ˆç»“æœå¾€å¾€ä¼šä¸å°½å¦‚äººæ„ã€‚æ‰€ä»¥ï¼ŒçœŸæ­£è‡ªå¾‹çš„äººå¾€å¾€éƒ½æ˜¯å› ä¸ºåšæŸä»¶äº‹çš„æˆå°±æ„Ÿè€Œå˜å¾—è‡ªå¾‹ã€‚æœ‰æˆå°±æ„Ÿæ‰æ˜¯ä»–ä»¬åšæŒä¸‹å»çš„åŸå› ã€‚</p><p>æ€»ä¹‹ï¼Œæƒ³è·å¾—å¿ƒæµï¼Œä½ è‡³å°‘éœ€è¦ï¼š</p><ul><li><p>æœ‰ç¡®å®šä¸”åˆé€‚çš„ç›®æ ‡ï¼Œå¹¶ä¸”æ„¿æ„ä¸ºä¹‹ä»˜å‡ºï¼›</p></li><li><p>èƒ½é›†ä¸­ç²¾åŠ›ï¼Œå…¨èº«å¿ƒæŠ•å…¥å¹¶å®ç°ç›®æ ‡ï¼›</p></li></ul><hr><p><strong>ä¸æ–­çš„æ‹¼æã€å¥‹æ–—ï¼Œä»è€Œè®©è‡ªå·±äº§ç”Ÿå¿ƒæµï¼Œäººç”Ÿæ‰æœ‰æ„ä¹‰</strong></p><p><img src="/upload/me/qrcode_wx2022.png"></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿ƒæµ å·¥ä½œ ç”Ÿæ´» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ€€å¿µ Ubuntuï¼šæŸ¥çœ‹ CPU ä¿¡æ¯</title>
      <link href="/2021/12/19/%E6%80%80%E5%BF%B5-Ubuntu%EF%BC%9A%E6%9F%A5%E7%9C%8B-CPU-%E4%BF%A1%E6%81%AF/"/>
      <url>/2021/12/19/%E6%80%80%E5%BF%B5-Ubuntu%EF%BC%9A%E6%9F%A5%E7%9C%8B-CPU-%E4%BF%A1%E6%81%AF/</url>
      
        <content type="html"><![CDATA[<p>åˆä¸­æ—¶æœŸç»“è¯†äº†ä¸€ä½æŒšå‹ï¼Œåœ¨åˆä¸­ç”Ÿæ¶¯æˆ‘ä¿©ç®—æ˜¯ç„¦ä¸ç¦»å­Ÿçš„å‹æƒ…ï¼Œæœ‰ä¸€æ¬¡æˆ‘ä»¬èŠå¤©ã€‚</p><p>æˆ‘è¯´ï¼šâ€œçœ‹åˆ°è‡ªå·±ä¹‹å‰å†™çš„å­—ï¼Œå®åœ¨å¤ªä¸‘äº†ã€‚ã€‚ã€‚â€</p><p>ä»–è¯´ï¼šâ€œè¯´æ˜ä½ è¿›æ­¥äº†ã€‚æ¯å½“ä½ å®¡è§†ä¹‹å‰åšçš„ä¸œè¥¿ä¸å¤Ÿå®Œç¾ï¼Œè¯´æ˜ä½ æ˜¯æœ‰è¿½æ±‚çš„äººã€‚â€</p><p>ç°åœ¨æƒ³æƒ³ï¼Œè¿™ä½æœ‹å‹å½“æ—¶çš„è§£é‡Šç®—æ˜¯å“²å­¦ç•Œçš„æ³°æ–—è§£è¯´äº†ã€‚</p><p>ä»Šå¤©åœ¨ç¿»é˜…ä¹‹å‰å†™çš„æŠ€æœ¯æ–‡ç« ï¼Œå‘ç°äº† <a href="https://veryitman.blog.csdn.net/article/details/7326536">linux å¸¸ç”¨å‘½ä»¤: æŸ¥çœ‹ CPU ä¿¡æ¯</a> è¿™ç¯‡æ–‡ç« ï¼Œé‚£æ˜¯æˆ‘åœ¨ 2012 å¹´å†™çš„ã€‚å½“æ—¶è‡ªå·±ä½¿ç”¨ Linux å·²ç»æœ‰ä¸¤å¹´å¤šçš„æ—¶é—´äº†ï¼Œå¾ˆå¤šå‘½ä»¤è¿˜æ˜¯è®°ä¸ä½ï¼Œæˆ‘å°±åœ¨ CSDN ä¸Šé¢å†™ä¸‹æ¥å½“ä½œå¤‡å¿˜äº†ã€‚å‡ å¹´è¿‡å»äº†ï¼Œä»Šå¤©ç¿»ç¿»è‡ªå·±ä¹‹å‰å†™çš„ä¸œè¥¿çªç„¶çœ‹åˆ°äº†å®ƒï¼Œæ–‡ç¬”ç¡®å®å¾ˆç³Ÿç³•ï¼ˆä»Šå¤©è¿˜é¡ºä¾¿ä¿®æ”¹äº†å‡ ä¸ªé”™åˆ«å­—ğŸ¤¦â€ï¼‰ï¼Œæˆªè‡³åˆ°ä»Šå¤©é˜…è¯»é‡åªæœ‰ 1.3ä¸‡+ä½†æœ€è¿‘7å¤©æŸ¥çœ‹è¾ƒå¤šå°±æƒ³ç€å‘å‡ºæ¥ç»™å¤§å®¶å…±äº«ä¸€ä¸‹ï¼Œå¸Œæœ›èƒ½å¸®åˆ°æ­£åœ¨åŠªåŠ›çš„ä½ ã€‚</p><p>è®°å¾—åœ¨å¤§å››çš„æ—¶å€™ï¼Œæˆ‘å°±å¼€å§‹æŠ˜è…¾ Ubuntuï¼Œè§‰å¾—è¿™ä¸ªä¸œè¥¿æŒºå¥½ç©çš„ï¼Œå®ƒæœ€å¸å¼•æˆ‘çš„åœ°æ–¹å°±æ˜¯å¯ä»¥åœ¨ä¸Šé¢ä¸ºæ‰€æ¬²ä¸ºçš„æ•²æ‰“å‘½ä»¤ï¼Œæ•´ä¸ªç³»ç»Ÿèƒ½è¢«è‡ªå·±æ•²æ‰“å‡ºæ¥çš„å‘½ä»¤æ‰€æ“æ§ï¼Œé‚£ç§æ„Ÿè§‰ä¸ä»…çˆ½è€Œä¸”è¿˜å¾ˆé…·ã€‚æ¯•ä¸šä¹‹åè´­ä¹°çš„ç¬¬ä¸€å°ç¬”è®°æœ¬æ˜¯è”æƒ³çš„ï¼Œæˆ‘è¿˜ç‰¹æ„è¦æ±‚è€æ¿ç»™è£…ä¸Šäº† Ubuntu çš„ç³»ç»Ÿã€‚å·¥ä½œäº†è¿™ä¹ˆå¤šå¹´ç”¨è¿‡ macOSã€Windowsï¼Œä½† Linux ç»™æˆ‘çš„é‚£ç§çº¯ç²¹çš„æ„Ÿè§‰è‡³ä»Šè®©äººéš¾ä»¥å¿˜å´ï¼Œæˆ‘çš„å°å¼æœºé‡Œé¢ä¸€ç›´ç»™ Ubuntu ç•™ç€ä½ç½®ï¼Œæ—¶ä¸æ—¶çš„è¦æ‹¿å‡ºæ¥çˆ½ä¸€æŠŠã€‚</p><hr><p><img src="/upload/images/2021/12/19/1.png"></p><p>åœ¨ Windows ä¸‹é¢å¯ä»¥å¾ˆæ–¹ä¾¿å¿«æ·çš„çœ‹å‡ºå½“å‰ CPU çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆåœ¨ Linux ä¸‹é¢å¦‚ä½•å¾ˆå¿«çš„çŸ¥é“å‘¢ï¼Ÿ</p><p>ä¹Ÿå¾ˆç®€å•ï¼Œä¸ä¿¡ä½ å¯ä»¥è¯•ä¸€è¯•ä¸‹é¢è¿™ä¸ªå‘½ä»¤ï¼š</p><p><strong>lscpu</strong></p><p><img src="/upload/images/2021/12/19/2.png"></p><p>å¯ä»¥çœ‹å‡ºï¼ŒCPU çš„ä¿¡æ¯å‡ºæ¥äº†ï¼Œçº¢è‰²éƒ¨åˆ†æ˜¯ CPU çš„ä½æ•°å’Œ CPU çš„æ ¸æ•°ã€‚</p><p>ä¹Ÿå¯ä»¥ç”¨ <code>cat -n /proc/cpuinfo</code> å‘½ä»¤æŸ¥çœ‹æ›´åŠ è¯¦ç»†çš„ä¿¡æ¯ï¼Œä½†æŸ¥å‡ºæ¥çš„å†…å®¹å¤ªå¤šï¼Œçœ‹èµ·æ¥æŒºè´¹åŠ²ã€‚</p><p>ä¸‹é¢ç»™å‡ºå‡ ä¸ªå¸¸ç”¨çš„å‘½ä»¤ã€‚<strong>wc</strong> ä¸»è¦ç”¨äºç»Ÿè®¡ï¼Œ<strong>uniq</strong> ä¸»è¦ç”¨äºé™¤å»é‡å¤è¡Œï¼Œåªæ˜¾ç¤ºå…¶ä¸­ç›¸åŒçš„æŸæ¡æ•°æ®ã€‚å¤§å®¶å¯ä»¥è‡ªè¡Œå»æœç´¢å’Œå­¦ä¹ è¿™ä¸¤ä¸ªå‘½ä»¤ã€‚</p><p><strong>1ã€æŸ¥çœ‹ç‰©ç† CPU çš„ä¸ªæ•°</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat  /proc/cpuinfo | grep &quot;physical id&quot; | sort  | uniq | wc -l</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šç‰©ç† CPU å°±æ˜¯å®å®åœ¨åœ¨çš„ç¡¬ä»¶ã€‚</p><p><strong>2ã€æŸ¥çœ‹é€»è¾‘ CPU çš„ä¸ªæ•°</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat  /proc/cpuinfo | grep &quot;processor&quot; | wc -l</span><br></pre></td></tr></table></figure><p><strong>3ã€æŸ¥çœ‹ CPU æ˜¯å‡ æ ¸</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat  /proc/cpuinfo | grep &quot;cores&quot; | uniq</span><br></pre></td></tr></table></figure><p><strong>4ã€æŸ¥çœ‹ CPU çš„ä¸»é¢‘</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat  /proc/cpuinfo | grep MHz | uniq</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢ç»“æœå¦‚ä¸‹å›¾ï¼Œæ‰€ç¤ºï¼š</p><p><img src="/upload/images/2021/12/19/3.png"></p><p>å½“ç„¶ä¸åŒçš„ CPU æ˜¾ç¤ºç»“æœä¼šä¸ä¸€æ ·ï¼Œä¸Šå›¾æ˜¯ 2012 å¹´è´­ä¹°çš„æœºå™¨å®‰è£…çš„ Ubuntuï¼Œä¸‹å›¾æ˜¯ç°åœ¨è™šæ‹Ÿæœºå®‰è£…çš„ Ubuntu ç³»ç»Ÿã€‚</p><p><img src="/upload/images/2021/12/19/4.png"></p><hr><p><strong>åšè‡ªå·±å–œæ¬¢åšçš„äº‹æƒ…ï¼Œè¿™ä¸ªå¾ˆé‡è¦ï¼</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux Ubuntu CPU </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¡ŒåŠ¨èµ·æ¥æ‰èƒ½è§£å†³ç„¦è™‘</title>
      <link href="/2021/11/28/%E8%A1%8C%E5%8A%A8%E8%B5%B7%E6%9D%A5%E6%89%8D%E8%83%BD%E8%A7%A3%E5%86%B3%E7%84%A6%E8%99%91/"/>
      <url>/2021/11/28/%E8%A1%8C%E5%8A%A8%E8%B5%B7%E6%9D%A5%E6%89%8D%E8%83%BD%E8%A7%A3%E5%86%B3%E7%84%A6%E8%99%91/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘é‡åˆ°å¾ˆå¤šæœ‹å‹æˆ–è€…åŒäº‹ï¼Œå¤šå¤šå°‘å°‘éƒ½æœ‰åœ¨è¯´è‡ªå·±æ¯”è¾ƒç„¦è™‘ï¼Œæ°å¥½è‡ªå·±æ­£åœ¨çœ‹ã€Šåº•å±‚é€»è¾‘ã€‹å’Œã€Šç»“æ„æ€è€ƒåŠ›ã€‹ï¼Œä»Šå¤©æˆ‘ä¹Ÿæ¥å‡‘ä¸ªçƒ­é—¹ï¼ŒèŠèŠç„¦è™‘ã€‚</p><p>ç„¦è™‘æ˜¯å¯¹äº²äººæˆ–è‡ªå·±ç”Ÿå‘½å®‰å…¨ã€å‰é€”å‘½è¿ç­‰çš„è¿‡åº¦æ‹…å¿ƒè€Œäº§ç”Ÿçš„ä¸€ç§çƒ¦èºæƒ…ç»ªã€‚å…¶ä¸­å«æœ‰ç€æ€¥ã€æŒ‚å¿µã€å¿§æ„ã€ç´§å¼ ã€ææ…Œã€ä¸å®‰ç­‰æˆåˆ†ã€‚</p><p><img src="/upload/images/2021/11/28/2.jpg"></p><p>æˆ‘æœ‰è¿‡ä¸€æ¬¡è®°å¿†çŠ¹æ–°çš„ç„¦è™‘ï¼Œæ¥è‡ªäºç«¥å¹´ã€‚</p><p>é‚£æ—¶æˆ‘å·²ç»7å²äº†ï¼Œå²æœ«å¹´åˆã€‚æ˜¥èŠ‚å¯¹äºå­©å­ä»¬æ¥è¯´æ˜¯è®©äººæœŸå¾…å’Œå…´å¥‹çš„ï¼Œå¤§é›ªåœ¨ç©ºä¸­é«˜å…´çš„é£èˆç€ï¼Œèƒ–èƒ–çš„é›ªäººç»™é™¢å­å¢æ·»äº†ä¸€ä»½æ¸©é¦¨ï¼Œç”¨æ ‘æåšçš„é¼»å­è®©å®ƒæ˜¾å¾—æ ¼å¤–å“åˆ«æ—ã€‚çˆ¶æ¯åœ¨å¨æˆ¿é‡Œå‡†å¤‡ç€å¹´å¤œé¥­ï¼Œæˆ‘ç‹¬è‡ªåœ¨æˆ¿é—´é‡Œé»¯ç„¶ç¥ä¼¤ã€‚æˆ‘çªç„¶è§‰å¾—å“ªä¸€å¤©çˆ¶æ¯è¦æ˜¯ç¦»å¼€äº†æˆ‘ä»¬ï¼Œçœ¼å‰è¿™ä¸€åˆ‡éƒ½ä¼šéšä¹‹æ¶ˆå¤±ï¼Œé‚£ç§å¯æ€•çš„æƒ³æ³•è®©æˆ‘æ½¸ç„¶æ³ªä¸‹ã€‚è¯´èµ·æ¥ä¹Ÿå¥‡æ€ªï¼Œé‚£ä¸ªæ—¶å€™çš„æˆ‘ä¸ºä»€ä¹ˆä¼šæœ‰è¿™æ ·çš„ç„¦è™‘ï¼Œç°åœ¨æƒ³æƒ³è¿˜æŒºå‚»çš„ã€‚</p><p>äººæœ‰æ‚²æ¬¢ç¦»åˆã€‚çæƒœå½“ä¸‹ï¼Œçæƒœå’Œäº²äººæˆ–è€…åŒäº‹åœ¨ä¸€èµ·çš„æ—¥å­ï¼Œè®°ä½å’Œä»–ä»¬åœ¨ä¸€èµ·åŠªåŠ›å¥‹æ–—å’Œç”Ÿæ´»çš„å²æœˆï¼Œæ¯”ä»€ä¹ˆéƒ½é‡è¦ã€‚</p><p>æœ‰ä¸ªåšäº’è”ç½‘å¼€å‘çš„æœ‹å‹ï¼Œå·¥ä½œäº†å¤§æ¦‚ä¸¤å¹´çš„æ—¶é—´ï¼Œä»–è¯´è‡ªå·±å½“åˆä¸ºäº†æ‰¾å·¥ä½œå°±å­¦ä¹ äº†æ¯”è¾ƒçƒ­é—¨çš„æŠ€æœ¯ï¼Œä½†æœ€è¿‘ä»–è§‰å¾—è¿™é—¨æŠ€æœ¯ä¼šå‡‰å‡‰ï¼Œå¼€å§‹æ‹…å¿ƒè‡ªå·±å°†æ¥ä¼šè¢«æ·˜æ±°ã€‚</p><p>æˆ‘é—®ä»–ï¼Œâ€œä½ ç”¨ç°åœ¨çš„æŠ€æœ¯åšçš„é¡¹ç›®å‰æ™¯å¦‚ä½•ï¼Ÿâ€</p><p>â€œé¡¹ç›®è¿˜å¯ä»¥å¹¶ä¸”å¾ˆæœ‰å‰æ™¯ï¼Œä¹Ÿæœ‰å¾ˆå¤šæŠ€æœ¯å¤§ç‰›ä¸€èµ·å·¥ä½œï¼Œèƒ½å­¦åˆ°ä¸å°‘çŸ¥è¯†â€ã€‚</p><p>â€œé‚£ä½ åº”è¯¥æå‡è‡ªå·±çš„èƒ½åŠ›è®©é¡¹ç›®å˜å¾—æ›´å¥½ï¼Œåœ¨é¡¹ç›®ä¸­å¤¯å®åŸºç¡€ï¼Œæˆ‘ç›¸ä¿¡ä½ å†å­¦ä¹ å…¶ä»–çš„ä¸“ä¸šç¼–ç¨‹çŸ¥è¯†ä¼šæ›´åŠ ä¸é±¼å¾—æ°´â€ã€‚</p><p>â€œé‚£æˆ‘åº”è¯¥åœ¨é¡¹ç›®ä¸­ä¸æ–­ç£¨ç»ƒè‡ªå·±çš„åŸºæœ¬åŠŸï¼Œç”¨æœ€å¥½çš„çŠ¶æ€ä¸ºé¡¹ç›®è´¡çŒ®åŠ›é‡â€ã€‚</p><p>â€œæ˜¯çš„ï¼Œè°ƒæ•´å¥½å¿ƒæ€ï¼Œè¡ŒåŠ¨èµ·æ¥â€ã€‚</p><p>æˆ‘ç›¸ä¿¡æ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„ç„¦è™‘ã€‚</p><ul><li>å­©å­æˆç»©æ€»æ˜¯å·®å¼ºäººæ„ï¼›</li><li>æ€»è§‰å¾—è€å…¬çš„å·¥èµ„æ¯æ°´è½¦è–ªï¼›</li><li>ç­‰ç€ä¹°æˆ¿è€Œæˆ¿ä»·æ€»æ˜¯å±…é«˜ä¸ä¸‹ï¼›</li><li>é¡¹ç›®äº¤ä»˜è´¨é‡å±‚æ¬¡ä¸é½ï¼›</li><li>å·¥ä½œä¸­å¤§å°äº‹åŠ¡å±‚å‡ºä¸ç©·ï¼›</li><li>èº«ä½“æƒ…ä¸è‡ªç¦åœ°å‘äº†ç¦ï¼Œå‡è‚¥å±¡å±¡å¤±è´¥ï¼›</li><li>ç­‰ç­‰ã€‚ã€‚ã€‚</li></ul><p>å¿ƒç†å­¦ç ”ç©¶è¡¨æ˜ï¼Œç„¦è™‘éƒ½æ˜¯æºè‡ªäºå¯¹äº‹ä»¶çš„â€œä¸ç¡®å®šæ€§â€ã€‚å¯¹äºä¸å¤ªç¡®å®šçš„äº‹æƒ…ï¼Œæˆ‘ä»¬ä¼šåœ¨è„‘æµ·ä¸åœåœ°çŒœæƒ³å¯èƒ½å‘ç”Ÿçš„åæœï¼Œä»è€Œæ„Ÿåˆ°ç„¦è™‘ã€ä¸å®‰ï¼Œéš¾ä»¥ä¸“å¿ƒåšå¥½çœ¼å‰çš„äº‹ã€‚</p><p>å¿ƒç†å­¦å®¶æ²³æ£®å ¡è¯´ï¼Œå¦‚æœä½ è§‰å¾—æŸä»¶äº‹è®©ä½ ç‰¹åˆ«ç„¦è™‘ï¼Œå‹å¾—ä½ å–˜ä¸è¿‡æ°”æ¥ï¼Œé‚£ä¹ˆæœ€å¥½çš„æ’è§£æ–¹æ³•å°±æ˜¯ç›´æ¥å»åšè¿™ä»¶äº‹ï¼Œä»€ä¹ˆéƒ½åˆ«ç®¡ï¼Œå°±æ˜¯ä½¿åŠ²åšï¼ŒåŠªåŠ›å»æ¨åŠ¨è¿›åº¦ã€‚ä½ æ¯å¾€å‰æ¨è¿›ä¸€ç‚¹è¿™ä»¶æ£˜æ‰‹çš„äº‹æƒ…ï¼Œä½ çš„ç„¦è™‘å°±ä¼šå‡å°‘ä¸€åˆ†ã€‚åŒæ—¶ï¼Œä½ çš„ç„¦è™‘è¶Šå°‘ï¼Œæ¨è¿›å·¥ä½œçš„é€Ÿåº¦ä¹Ÿå°±è¶Šå¿«ã€‚åªè¦å’¬ç´§ç‰™å…³ï¼Œä¸åœåœ°æ¨è¿›ï¼Œæ€»ä¼šæœ‰è§£è„±çš„é‚£ä¸€å¤©ã€‚è€Œä¸”ä½ æ¯å®Œæˆä¸€ä¸ªæ£˜æ‰‹çš„ä»»åŠ¡ï¼Œæˆ–å¤šæˆ–å°‘éƒ½ä¼šæ¯”ä¹‹å‰å¼ºå¤§ä¸€ç‚¹ï¼Œè¿™ä»¶è‹¦å·®äº‹æ€»ä¼šæ”¹å˜ä½ ä¸€ç‚¹ã€‚</p><p><img src="/upload/images/2021/11/28/3.jpg"></p><p>å¦‚æœä½ ä¸é‡‡å–ä»»ä½•è¡ŒåŠ¨ï¼Œç„¦è™‘æ…¢æ…¢çš„ä¼šå°†ä½ åå™¬ï¼Œè®©ä½ å˜å¾—æ¶ˆæç”šè‡³æŠ‘éƒã€‚</p><p>ä»æŸç§è§’åº¦æ¥çœ‹ï¼Œç„¦è™‘å¹¶ä¸æ˜¯ç»å¯¹çš„åäº‹ï¼Œäººæ— è¿œè™‘å¿…æœ‰è¿‘å¿§ã€‚å½“ç„¦è™‘æ¥ä¸´åï¼Œä½ æ›´åº”è¯¥å…·æœ‰å¿§æ‚£æ„è¯†ï¼Œå®¢è§‚çš„è¯„ä»·å½“å‰æƒ…å†µï¼Œè®©ç„¦è™‘å˜æˆè‡ªå·±å‰è¿›çš„åŠ¨åŠ›ã€‚ä»˜å‡ºæ›´å¤šçš„åŠªåŠ›æ”¹å˜ç°çŠ¶ï¼Œäº‰å–å–å¾—æ›´å¥½çš„æˆç»©ã€‚</p><p>é¢å¯¹ç„¦è™‘ï¼Œæˆ‘ä»¬åº”è¯¥æŒæœ‰æ›´å¼€æ”¾çš„å¿ƒæ€ï¼Œå­¦ä¼šé‡Šæ”¾å‹åŠ›ã€‚æ— è®ºå¦‚ä½•ï¼Œä½ è¦è¡ŒåŠ¨èµ·æ¥ä¸èƒ½åªæ˜¯ç„¦è™‘ï¼<a href="http://www.veryitman.com/2020/09/26/%E7%94%9F%E8%80%8C%E4%B8%BA%E4%BA%BA%EF%BC%8C%E6%88%91%E5%BE%88%E6%AC%A2%E5%96%9C/">ç”Ÿè€Œä¸ºäººï¼Œè¦èƒ½æ¬¢å–œ</a>ã€‚</p><p><img src="/upload/images/2021/11/28/1.png"></p><hr><p><strong>åŠªåŠ›å‘å‰ä¸€æ­¥ï¼Œç¦»æ¢¦æƒ³å°±æ›´è¿›ä¸€æ­¥</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç„¦è™‘ å·¥ä½œ ç”Ÿæ´» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŠ€æœ¯äººï¼Œä¹Ÿåº”å…·å¤‡é¡¹ç›®ç®¡ç†èƒ½åŠ›</title>
      <link href="/2021/11/07/%E6%8A%80%E6%9C%AF%E4%BA%BA%EF%BC%8C%E4%B9%9F%E5%BA%94%E5%85%B7%E5%A4%87%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E8%83%BD%E5%8A%9B/"/>
      <url>/2021/11/07/%E6%8A%80%E6%9C%AF%E4%BA%BA%EF%BC%8C%E4%B9%9F%E5%BA%94%E5%85%B7%E5%A4%87%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E8%83%BD%E5%8A%9B/</url>
      
        <content type="html"><![CDATA[<p>ä½ å³å°†è¦çœ‹åˆ°çš„å†…å®¹åœ¨æˆ‘è„‘æµ·é‡Œç¿»æ»šäº†å¾ˆä¹…~</p><p>è‡ªå·±å†™è¿‡ä¸å°‘æŠ€æœ¯åšå®¢ï¼Œå†™çš„è™½ç„¶ä¸å¥½ä½†æ˜¯æ€»èƒ½æ‹¼å‡‘å‡ºæ¥ã€‚ä¸€æ—¦å¼€å§‹å†™ç®¡ç†ç±»çš„æ–‡ç« ï¼Œå°±æ˜¾å¾—æœ‰äº›å±€ä¿ƒï¼Œä½†å†…å¿ƒè¿˜æ˜¯å‘Šè¯‰æˆ‘è¦åšæŒå†™ä¸‹å»ã€‚</p><p>è‡ªä»å†™å®Œ <a href="http://www.veryitman.com/2021/05/23/%E8%B5%B0%E4%B8%8A%E9%A1%B9%E7%AE%A1%E4%B9%8B%E8%B7%AF/">èµ°ä¸Šé¡¹ç®¡ä¹‹è·¯</a>ï¼Œè¿Ÿè¿Ÿæ²¡æœ‰åŠ¨æ‰‹å»å†™å…³äºé¡¹ç›®ç®¡ç†çš„æ–‡ç« ã€‚å€’ä¸æ˜¯å› ä¸ºè‡ªå·±æƒ³å·èµ–ï¼Œè€Œæ˜¯ç¡®å®ä¸çŸ¥é“å¦‚ä½•ä¸‹æ‰‹ã€‚è¿™ç§æ„Ÿè§‰ï¼Œå°±å¥½æ¯”ä½ åœ¨å²¸ä¸Šçœ‹åˆ°ä¸€æ¡è‚¥å˜Ÿå˜Ÿçš„å¤§é±¼æƒ³æ®ä¸ºå·±æœ‰è€Œåˆæ— è®¡å¯æ–½ä¸€èˆ¬è®©äººéš¾å—ã€‚</p><p>ä¸å…¶ä¸´æ¸Šç¾¡é±¼ï¼Œä¸å¦‚é€€è€Œç»“ç½‘ã€‚</p><p>æˆ‘æƒ³æŠŠè‡ªå·±åœ¨åšé¡¹ç›®ç»ç†è¿™ä¸ªèŒä¸šä¸­é‡åˆ°çš„ä¸€äº›å…³äºé¡¹ç›®ç®¡ç†çš„é—®é¢˜ã€æ„Ÿæ‚Ÿå’Œç»éªŒåˆ†äº«ç»™å¤§å®¶ï¼Œå°½é‡é€šä¿—æ˜“æ‡‚çš„å’Œç›˜æ‰˜å‡ºã€‚</p><p>å…³äºé¡¹ç›®ç®¡ç†æ–¹é¢çš„æ–‡ç« éƒ½ä¼šå½’çº³åœ¨ <a href="http://www.veryitman.com/categories/%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/">é¡¹ç›®ç®¡ç†</a> åˆé›†ä¸­ï¼Œä»Šå¤©åªåˆ†äº«çš„ä¸»é¢˜æ˜¯åœ¨é¡¹ç›®ç®¡ç†ä¸­å¸¸è§é—®é¢˜çš„è§£ç­”å’Œåˆ†æã€‚ä½œä¸ºä¸€åæŠ€æœ¯äººï¼Œé™¤äº†æŒæ¡ä¸“ä¸šçš„æŠ€èƒ½å’Œè§£å†³é—®é¢˜çš„èƒ½åŠ›ï¼Œè¿˜åº”è¯¥å…·å¤‡ä¸€å®šçš„é¡¹ç›®ç®¡ç†èƒ½åŠ›ï¼Œäº‰å–å°†æ¥èƒ½åšä¸€åå¸¦å…µæ‰“ä»—çš„å°†å†›å®ç°è‡ªæˆ‘æ›´å¤§çš„ä»·å€¼ã€‚</p><hr><p>çˆ¬è¿‡ä¸€åº§é«˜å±±ä¹‹åï¼Œé™¤äº†ç´¯ï¼Œè¿˜æœ‰å±±é¡¶çš„é£å…‰å´å’Œæ²¿é€”çš„æ™¯è‰²ã€‚åšé¡¹ç›®ç®¡ç†çš„ç»ç†äººä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p><hr><h2 id="è¯ä¹¦åœ¨æ‰‹ï¼Œå¤©ä¸‹æˆ‘æœ‰"><a href="#è¯ä¹¦åœ¨æ‰‹ï¼Œå¤©ä¸‹æˆ‘æœ‰" class="headerlink" title="è¯ä¹¦åœ¨æ‰‹ï¼Œå¤©ä¸‹æˆ‘æœ‰"></a>è¯ä¹¦åœ¨æ‰‹ï¼Œå¤©ä¸‹æˆ‘æœ‰</h2><blockquote><p>é—®ï¼šâ€è€ƒ PMP è¯ä¹¦åˆ°åº•æœ‰æ²¡æœ‰ç”¨â€œï¼Ÿ</p></blockquote><blockquote><p>å†é—®ï¼šâ€è€ƒè¿‡ PMPï¼Œæœˆè–ªæ˜¯ä¸æ˜¯å¯ä»¥ç¿»ä¸€ç•ªâ€œï¼Ÿ</p></blockquote><blockquote><p>åˆé—®ï¼šâ€æ‹¿åˆ° PMP è¯ä¹¦ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥å½“é¡¹ç›®ç»ç†äº†â€œï¼Ÿ</p></blockquote><p>ä¹‹å‰æœ‰ä¸å°‘äººé—®è¿‡æˆ‘ç›¸åŒçš„é—®é¢˜ï¼ŒåŒ…æ‹¬æˆ‘è‡ªå·±åœ¨åˆšåšé¡¹ç›®ç»ç†çš„åˆæœŸä¹Ÿæœ‰è¿‡ç±»ä¼¼çš„ç–‘é—®ã€‚</p><p>è¿™äº›é—®é¢˜éƒ½æ˜¯å¥½é—®é¢˜ï¼Œä½†æ¯ä¸ªé—®é¢˜åˆä¸å¯ä»¥éšä¾¿è¯´ <code>å¯ä»¥</code> æˆ–è€… <code>ä¸å¯ä»¥</code>ã€‚</p><p>PMPï¼Œå…¨ç§°æ˜¯ Project Management Professionalï¼ŒæŒ‡çš„æ˜¯é¡¹ç›®ç®¡ç†ä¸“ä¸šäººå£«èµ„æ ¼è®¤è¯ã€‚å®ƒæ˜¯ç”±ç¾å›½é¡¹ç›®ç®¡ç†åä¼š PMIï¼ˆProject Management Instituteï¼‰å‘èµ·çš„ï¼Œä¸¥æ ¼è¯„ä¼°é¡¹ç›®ç®¡ç†äººå‘˜çŸ¥è¯†æŠ€èƒ½æ˜¯å¦å…·æœ‰é«˜å“è´¨çš„èµ„æ ¼è®¤è¯è€ƒè¯•ã€‚é€šè¿‡è¯¥è€ƒè¯•å¯ä»¥æ‹¿åˆ° PMP è¯ä¹¦ã€‚</p><p>ä»æˆ‘ä¸ªäººç»å†å’Œæ„Ÿæ‚Ÿæ¥é€ä¸€å›ç­”ä¸Šé¢ä¸‰ä¸ªé—®é¢˜ã€‚</p><p><img src="/upload/images/2021/11/07/1.png"></p><p><strong>1ã€è€ƒ PMP è¯ä¹¦åˆ°åº•æœ‰æ²¡æœ‰ç”¨ï¼Ÿ</strong></p><p>å¦‚æœä½ æœ‰æ—¶é—´æˆ–è€…ç²¾åŠ›ï¼Œè€ƒ PMP è¯ä¹¦å¯¹ç»å¤§å¤šæ•°äººæ¥è¯´è‚¯å®šæ˜¯æœ‰ç”¨çš„ï¼Œè¿™ä¸ªæ¯‹åº¸ç½®ç–‘ã€‚</p><p>è€ƒ PMP è¯ä¹¦èŠ±è´¹å¤§æ¦‚åœ¨ 5000 - 6000 å·¦å³ï¼Œå‡†å¤‡å¤§æ¦‚ 2-3ä¸ªæœˆå°±å¯ä»¥äº†ï¼Œä¹Ÿç®—æ˜¯å¯¹è‡ªå·±çš„ä¸€ç§æŠ•èµ„ï¼Œè¯´ä¸å®šå“ªå¤©èƒ½å¤Ÿæ´¾ä¸Šç”¨åœºï¼Œæ— å¿ƒæ’æŸ³æŸ³æˆè«ã€‚</p><p>PMP è€ƒè¯•è¿‡ç¨‹ä¸­ä½ éœ€è¦çœ‹ç›¸å…³çš„ä¸“ä¸šä¹¦ç±ï¼Œè‡³å°‘è¦çœ‹ 2 éï¼Œåœ¨ä¹¦ä¸­å­¦åˆ°çš„ä¸€äº›ç†è®ºçŸ¥è¯†ä¸ä»…å¯ä»¥è¿ç”¨åˆ°å·¥ä½œå½“ä¸­ï¼Œè¿˜å¯ä»¥è¿ç”¨åˆ°ç”Ÿæ´»ã€å®¶åº­å’Œæ•™è‚²ä»¥åŠäººé™…å…³ç³»å½“ä¸­å»ã€‚</p><p>ä¸€åˆ‡çš†é¡¹ç›®ï¼Œåˆ©ç”¨è€ƒè¯çš„æœºä¼šå¯ä»¥å­¦åˆ°ä¸€äº›é¡¹ç›®ç®¡ç†çŸ¥è¯†ï¼Œæ—¢æ‹¿åˆ°äº† PMP è¯ä¹¦åˆå­¦åˆ°äº†æ–°çŸ¥è¯†ï¼Œä¸€ä¸¾ä¸¤å¾—ã€‚</p><p><strong>2ã€è€ƒè¿‡ PMPï¼Œæœˆè–ªæ˜¯ä¸æ˜¯å¯ä»¥ç¿»ä¸€ç•ªï¼Ÿ</strong></p><p>å¾ˆå¤šä¼ä¸šæ‹›è˜é¡¹ç›®ç»ç†ä¼šå†™ï¼šæœ‰ PMP è¯ä¹¦çš„ä¼˜å…ˆã€‚ä½†æ˜¯æ²¡æœ‰å†™ï¼šæœ‰ PMP è¯ä¹¦çš„è–ªèµ„æ¯”æ²¡æœ‰ PMP è¯ä¹¦çš„è–ªèµ„é«˜ N å€ã€‚</p><p>å¦‚æœä½ ä¹‹å‰æœ‰é¡¹ç›®ç®¡ç†çš„å·¥ä½œç»éªŒï¼Œå¹¶ä¸”æ‹…ä»»è¿‡å‡ å¹´çš„é¡¹ç›®ç»ç†ï¼Œåšè¿‡çš„é¡¹ç›®ä¸šç»©ä¹Ÿä¸é”™ï¼Œä½†å› ä¸ºå„ç§åŸå› æ²¡æœ‰è€ƒ PMP è¯ä¹¦ï¼Œçªç„¶æœ‰ä¸€å¤©ä½ å¿ƒè¡€æ¥æ½®ä¸€è„šæ²¹é—¨è€ƒè¿‡äº† PMP è€ƒè¯•ã€‚æ­¤æ—¶ï¼Œä½ å·²ä¸å†æ˜¯é‚£ä¸ªæ‡µæ‡‚çš„å°‘å¹´ï¼Œä¿¨ç„¶æ˜¯ä¸ªé¡¹ç›®ç®¡ç†è€å¸æœºäº†ï¼Œä¾¿å¯ä»¥ç†ç›´æ°”å£®åœ°è·Ÿå…¬å¸é¢†å¯¼è°ˆè°ˆå‡èŒåŠ è–ªçš„äº‹äº†ã€‚å¦‚æœä½ å¯¹è°ˆåˆ¤ç»“æœä¸æ»¡æ„ï¼Œå¤§ä¸äº†è·³ä¸ªæ§½ï¼Œè¯´ä¸å®šè–ªèµ„çœŸèƒ½ç¿»ä¸€ç•ªã€‚æ­¤å¤„ä¸ç•™çˆ·ï¼Œè‡ªæœ‰ç•™çˆ·å¤„å˜›ã€‚</p><p>è€ƒè¿‡äº† PMPï¼Œæ‹¿åˆ°äº†è¯ä¹¦ï¼Œåªèƒ½è¯´æ˜ä½ å¯¹é¡¹ç›®ç®¡ç†çš„ä¸“ä¸šçŸ¥è¯†æŠ€èƒ½æŒæ¡çš„è¿˜ä¸é”™ã€‚è‡³äºèƒ½ä¸èƒ½å‡èŒåŠ è–ªï¼Œè¿˜æ˜¯è¦çœ‹ä½ çš„ä¸ªäººå·¥ä½œèƒ½åŠ›ä»¥åŠä½ æ‰€å¸¦çš„é¡¹ç›®å¯¹å…¬å¸çš„è´¡çŒ®åº¦ã€‚</p><p>åœ¨æˆ‘çš„èŒä¸šç”Ÿæ¶¯ä¸­ï¼Œæœ‰å¾ˆå¤šé¡¹ç›®ç»ç†å¹¶æ²¡æœ‰è€ƒ PMPä½†ä¸€æ ·åšçš„é£ç”Ÿæ°´èµ·ï¼Œä»–ä»¬ç¡®å®æ¯”è¾ƒä¼˜ç§€ï¼Œèƒ½å¤Ÿç”¨è‡ªå·±çš„æ–¹å¼å’Œæ–¹æ³•å¸®å›¢é˜Ÿå’Œç»„ç»‡å®ç°ç›®æ ‡ã€‚</p><p><strong>3ã€æ‹¿åˆ° PMP è¯ä¹¦ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥å½“é¡¹ç›®ç»ç†äº†ï¼Ÿ</strong></p><p>å¯ä»¥è¿™ä¹ˆè¯´ï¼Œæ²¡æœ‰ PMP è¯ä¹¦ï¼Œä¹Ÿä¸€æ ·å¯ä»¥åšé¡¹ç›®ç»ç†ã€‚</p><blockquote><p> â€œå¦‚æœä½ æ¨ä¸€ä¸ªäººï¼Œå°±è®©ä»–å»å½“é¡¹ç›®ç»ç†ï¼Œå› ä¸ºåæœ‰å…«ä¹ä»–ä¼šè¢«å¤±è´¥çš„é¡¹ç›®æ¯äº†ã€‚â€œ</p></blockquote><p>è¿™æ˜¯ç½‘ä¸Šæ¯”è¾ƒæµè¡Œçš„ä¸€ä¸ªæ®µå­ï¼Œåªæœ‰åšè¿‡é¡¹ç›®ç»ç†çš„äººæ‰èƒ½é¢†æ‚Ÿè¿™å¥è¯çš„å«ä¹‰ã€‚</p><p>å¤§å¤šæ•°çš„å…¬å¸æˆ–è€…ä¼ä¸šï¼Œä¸€èˆ¬ä¼šä»å†…éƒ¨ææ‹”äººå‘˜æ‹…ä»»é¡¹ç›®ç»ç†çš„å²—ä½ï¼Œè€Œä¸ä¼šä»å¤–éƒ¨æ‹›è˜ï¼ˆä½†æœ‰å¯èƒ½ä¼šä»å¤–éƒ¨æ‹›è˜ä¸€åé¡¹ç›®ç®¡ç†ä¸“å®¶ï¼‰ã€‚</p><p>èƒ½ä»å…¶ä»–å²—ä½åšåˆ°é¡¹ç›®ç»ç†è¿™ä¸ªä½ç½®çš„äººï¼Œä¸€èˆ¬éƒ½æ˜¯ä¸šç»©æ¯”è¾ƒçªå‡ºï¼Œåœ¨å›¢é˜Ÿé‡Œæœ‰è¾ƒé«˜çš„å¨æœ›ï¼Œä¸€è¨€ä¹é¼ï¼Œåšäººåšäº‹éƒ½èƒ½æ‹¿æçš„æ°åˆ°å¥½å¤„ã€‚</p><p>ç»™æƒ³ä»äº‹é¡¹ç›®ç»ç†çš„åŒå­¦ä»¬ä¸€å¥åŠï¼Œæœ€å¥½å…ˆåšå¥½è‡ªå·±çš„ä¸šåŠ¡å†æ¥åšé¡¹ç›®ç»ç†ï¼Œåœ¨è‡ªå·±çš„ä¸šåŠ¡ä¸­ä¸æ–­çš„å®è·µé¡¹ç›®ç®¡ç†çŸ¥è¯†ï¼Œå¾…æ—¶æœºæˆç†Ÿåå†æ¥è€ƒè™‘æ˜¯å¦è¦åä¸Šé¡¹ç›®ç»ç†çš„å®åº§å§ï¼Œä¸”ä¸è¦æ“ä¹‹è¿‡æ€¥ã€‚</p><h2 id="ä¸“ä¸šæˆ‘æœ‰ï¼Œæªå°½èŒå®ˆ"><a href="#ä¸“ä¸šæˆ‘æœ‰ï¼Œæªå°½èŒå®ˆ" class="headerlink" title="ä¸“ä¸šæˆ‘æœ‰ï¼Œæªå°½èŒå®ˆ"></a>ä¸“ä¸šæˆ‘æœ‰ï¼Œæªå°½èŒå®ˆ</h2><p><img src="/upload/images/2021/11/07/4.png"></p><p>é¡¹ç›®ç®¡ç†æ˜¯ä¸€é—¨å­¦é—®å’Œè‰ºæœ¯ï¼Œä»»ä½•äººéƒ½å¯ä»¥å…·å¤‡é¡¹ç›®ç®¡ç†çš„èƒ½åŠ›ï¼Œé¡¹ç›®ç®¡ç†å¼ºè°ƒçš„æ˜¯æŠ€èƒ½å’Œä¸“ä¸šï¼›é¡¹ç›®ç»ç†æ˜¯ä¸€ä¸ªå²—ä½åç§°ï¼Œé¡¹ç›®ç»ç†è¦èƒ½å¤Ÿä½¿ç”¨é¡¹ç›®ç®¡ç†çš„æ–¹æ³•ã€æŠ€å·§å’Œæ‰‹æ®µå®Œæˆç»„ç»‡ç›®æ ‡ï¼Œå¼ºè°ƒçš„æ˜¯èŒä½å’ŒèŒèƒ½ã€‚</p><p>ä½ å¯ä»¥ä¸æ˜¯é¡¹ç›®ç»ç†ï¼Œä½†ä½ å¯èƒ½éœ€è¦é¡¹ç›®ç®¡ç†çš„èƒ½åŠ›ã€‚</p><p>ä¸€èˆ¬æœ‰é¡¹ç›®ç»ç†çš„å›¢é˜Ÿï¼Œç»„ç»‡ç»“æ„å¤§è‡´å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="/upload/images/2021/11/07/2.png"></p><p>è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯å›¢é˜Ÿä¸­æ²¡æœ‰ä¸“èŒçš„é¡¹ç›®ç»ç†ï¼Œéœ€è¦æœ‰äººèƒ½å¤Ÿå±¥è¡Œé¡¹ç›®ç»ç†çš„èŒèƒ½ï¼Œä¸€èˆ¬éƒ½æ˜¯ç”±ç»„é•¿æ‹…ä»»é¡¹ç›®ç®¡ç†çš„èŒè´£ã€‚</p><p><img src="/upload/images/2021/11/07/3.png"></p><p>å¸¸è§çš„è½¯ä»¶å¼€å‘é¡¹ç›®ä¸­ï¼Œæµ‹è¯•ç»„é•¿ä¼šå¸¦é¢†æµ‹è¯•æˆå‘˜è´Ÿè´£é¡¹ç›®çš„æµ‹è¯•å·¥ä½œï¼Œå‰åç«¯å¼€å‘ç»„é•¿ä¼šå®‰æ’å¼€å‘æˆå‘˜çš„å·¥ä½œï¼Œè´Ÿè´£é¡¹ç›®å¼€å‘å‘¨æœŸä»¥åŠå¼€å‘è´¨é‡ã€‚è¿™æ ·å„ä¸ªç»„çš„ç»„é•¿éƒ½æ˜¯å„ç»„çš„â€é¡¹ç›®ç»ç†â€œã€‚å½“é¡¹ç›®å‘å±•åˆ°ä¸€å®šé˜¶æ®µï¼ˆå¦‚å›¢é˜Ÿäººæ•°å¢åŠ äº†ã€äº§å“çº¿å˜å¤šäº†ç­‰ï¼‰ï¼Œäº§å“ç»ç†ä¼šæ‰¿æ‹…é¡¹ç›®ç»ç†çš„è§’è‰²ç»„ç»‡å’Œç®¡ç†å„ä¸ªç»„é•¿ï¼Œå‘é¡¹ç›®è´Ÿè´£äººï¼ˆä¸€èˆ¬æ˜¯éƒ¨é—¨è´Ÿè´£äººï¼‰æ±‡æŠ¥ï¼Œäº§å“ç»ç†è¦å¯¹ç”¨æˆ·å’Œç›¸å…³æ–¹è´Ÿè´£ï¼Œéœ€è¦ä¸æ–­çš„æé«˜äº§å“ç”¨æˆ·ä½“éªŒï¼Œèƒ½å¤Ÿç«™åœ¨æ›´é«˜çš„å±‚æ¬¡ç®¡ç†é¡¹ç›®ã€‚</p><p>ä»ä¸Šé¢çš„ä»‹ç»ä¸­ï¼Œå¯ä»¥çœ‹å‡ºæ— è®ºä½ æ˜¯äº§å“ç»ç†ï¼Œè¿˜æ˜¯å¼€å‘æˆ–è€…æµ‹è¯•ç»„é•¿ï¼Œéƒ½éœ€è¦ä¸€å®šçš„é¡¹ç›®ç®¡ç†çŸ¥è¯†ä½œä¸ºå‚¨å¤‡ã€‚</p><p>åœ¨å¾ˆå¤šäº’è”ç½‘å…¬å¸çš„èŒçº§æ™‹å‡è¦æ±‚ä¸­ï¼Œæ˜æ–‡è§„å®šï¼šâ€æ™‹å‡åˆ°æŸä¸ªèŒçº§å¿…é¡»è¦å…·å¤‡é¡¹ç›®ç®¡ç†çš„ä¸“ä¸šçŸ¥è¯†ï¼Œå¦åˆ™ä¸äºˆé€šè¿‡â€œã€‚å°±æ‹¿å¼€å‘ç»„é•¿æ¥è¯´ï¼Œå¯èƒ½ TA ç¼–å†™ä»£ç çš„é€Ÿåº¦å’Œä»£ç è´¨é‡åœ¨å›¢é˜Ÿä¸­å‡ºç±»æ‹”èƒï¼Œè§£å†³é—®é¢˜çš„æ€ç»´å’Œæ‰‹æ®µå‡ºå…¶ä¸æ„ï¼Œå¤§å®¶éƒ½ç§° TA ä¸ºå¤§ç¥ã€‚åªè¦è·Ÿ TA è®¨è®ºç¼–ç¨‹ï¼ŒTA èƒ½å¤Ÿæ»”æ»”ä¸ç»çš„ç»™ä½ æ¥ä¸Šå‡ æ®µï¼Œä½†ä¸€åˆ°äº‹æƒ…è§„åˆ’å’Œäººå‘˜ç®¡ç†ä¸Šå°±æ˜¾å¾—æ‰‹å¿™è„šä¹±ï¼Œæªæ‰‹ä¸åŠã€‚è¿™ç§äººéœ€è¦å…¬å¸æˆ–è€…ä¼ä¸šç»™ä¸ä¸€å®šçš„æŒ‡å¯¼å’ŒåŸ¹è®­ï¼Œé€‚å½“çš„è®© TA å¸¦é¢†äººå‘˜ä»å°äº‹åšèµ·ï¼Œæ…¢æ…¢çš„åŸ¹å…»é¡¹ç›®ç®¡ç†çš„èƒ½åŠ›å’Œè‡ªä¿¡ï¼Œæ¢å¥è¯è¯´å°±æ˜¯è¦èƒ½ç»™äºˆè¿™æ ·çš„äººæ‰èµ‹èƒ½ã€‚</p><p>ä½ è¦çŸ¥é“å¾ˆå¤šæˆåŠŸçš„ä¼ä¸šå®¶ï¼Œä»–ä»¬éƒ½æ˜¯ä»ç»„é•¿åšèµ·æ¥çš„ï¼Œä»–ä»¬é€šè¿‡ä¸æ–­çš„å­¦ä¹ å’Œå®è·µå…·å¤‡äº†è¾ƒå¼ºçš„é¡¹ç›®ç®¡ç†èƒ½åŠ›ï¼Œä¸ºåé¢è‡ªå·±çš„åˆ›ä¸šç”Ÿæ¶¯æ·»ä¸Šäº†æµ“å¢¨é‡å½©çš„ä¸€ç¬”ã€‚ä¸ç§¯è·¬æ­¥æ— ä»¥è‡³åƒé‡Œï¼Œç‚¹ç‚¹æ»´æ»´æ‰æ˜¯åŸºçŸ³ã€‚åœ¨åšå¥½æœ¬ä¸“ä¸šé¢†åŸŸçš„åŒæ—¶ï¼Œä¸å¦¨â€è¶Šä¿ä»£åº–â€œåœ°åšä¸€äº›ç®¡ç†é¡¹çš„å·¥ä½œï¼Œèƒ½è®©ä½ äº‹åŠåŠŸå€çš„å®Œæˆç›®æ ‡ã€‚</p><hr><p><strong>ä½ çš„ä½¿å‘½æ˜¯å¸¦é¢†ä¸€æ‰¹åˆé€‚çš„äººå®Œæˆç»„ç»‡çš„ç‰¹å®šç›®æ ‡</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> é¡¹ç›®ç®¡ç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¡¹ç›®ç®¡ç† å¸¸è§é—®é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GCC: __attribute__((visibility()))</title>
      <link href="/2021/08/08/GCC-attribute-visibility/"/>
      <url>/2021/08/08/GCC-attribute-visibility/</url>
      
        <content type="html"><![CDATA[<p>åœ¨ <code>objc-api.h</code> é‡Œé¢æœ‰å¾ˆå¤šå…³äº <code>__attribute__ </code> çš„å®šä¹‰ã€‚</p><p>ä¾‹å¦‚ä¸‹é¢çš„ä»£ç ç‰‡æ®µï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">if</span> !defined(OBJC_VISIBLE)</span></span><br><span class="line"><span class="meta">#   <span class="keyword">if</span> TARGET_OS_WIN32</span></span><br><span class="line"><span class="meta">#       <span class="keyword">if</span> defined(BUILDING_OBJC)</span></span><br><span class="line"><span class="meta">#           <span class="keyword">define</span> OBJC_VISIBLE __declspec(dllexport)</span></span><br><span class="line"><span class="meta">#       <span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#           <span class="keyword">define</span> OBJC_VISIBLE __declspec(dllimport)</span></span><br><span class="line"><span class="meta">#       <span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#   <span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#       <span class="keyword">define</span> OBJC_VISIBLE  __attribute__((visibility(<span class="string">&quot;default&quot;</span>)))</span></span><br><span class="line"><span class="meta">#   <span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼šOBJC_VISIBLE çš„å®šä¹‰æ–¹å¼æ˜¯ <code>__attribute__((visibility(&quot;default&quot;)))</code>ã€‚</p><p>é‚£ä¹ˆç©¶ç«Ÿæœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿä¸‹é¢ä¸¾ä¾‹è¯´æ˜ã€‚</p><hr><p>GCC æœ‰ä¸ª <code>visibility</code> å±æ€§ï¼Œå¯ç”¨è¿™ä¸ªå±æ€§æƒ…å†µå¦‚ä¸‹è¯´æ˜ã€‚</p><p>1ã€å½“ç¼–è¯‘æ—¶å¢åŠ  <code>-fvisibility=hidden</code> </p><p>åŠ¨æ€åº“ä¸­çš„å‡½æ•°é»˜è®¤æ˜¯è¢«éšè—çš„å³ hiddenï¼Œé™¤éæ˜¾ç¤ºå£°æ˜ä¸º <code>__attribute__((visibility(&quot;default&quot;)))</code></p><p>2ã€å½“ç¼–è¯‘æ—¶å¢åŠ  <code>-fvisibility=default</code> </p><p> åŠ¨æ€åº“ä¸­çš„å‡½æ•°é»˜è®¤æ˜¯å¯è§çš„ã€‚é™¤éæ˜¾ç¤ºå£°æ˜ä¸º <code>__attribute__((visibility(&quot;hidden&quot;)))</code></p><p><strong>ç‰¹åˆ«è¯´æ˜:ï¼šè¿™ä¸ªç‰¹æ€§æ˜¯ GCC4.0 ä»¥åæ‰æœ‰çš„ã€‚</strong></p><p>åŸºäº <a href="http://blog.csdn.net/veryitman/article/details/46754909">GCCç³»åˆ—: åŠ è½½é™æ€é“¾æ¥åº“</a> çš„ä¾‹å­ã€‚è°ˆè°ˆ visibilityã€‚</p><p><strong>Car.c</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;  </span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt; </span></span></span><br><span class="line"></span><br><span class="line">__attribute ((visibility(<span class="string">&quot;default&quot;</span>))) <span class="keyword">int</span> drive()</span><br><span class="line">&#123;</span><br><span class="line">    printf(<span class="string">&quot;Car driving...\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> stop()</span><br><span class="line">&#123;</span><br><span class="line">    printf(<span class="string">&quot;Car stop.\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼šattribute çš„å®šä¹‰å’Œä½¿ç”¨æ–¹æ³•</strong>ã€‚</p><p>ä½¿ç”¨ visibility å±æ€§æ¥ç¼–è¯‘åŠ¨æ€é“¾æ¥åº“ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g++<span class="number">-4.9</span> -shared -o libCar.so -fvisibility=hidden Car.c</span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¸€æ¥ï¼Œ<code>drive</code> æ–¹æ³•æ˜¯å¯è§çš„ï¼Œä½†æ˜¯ <code>stop</code> æ˜¯ä¸å¯è§çš„ã€‚</p><p><em><strong>main.c</strong></em></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;  </span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// åœ¨ gcc ç¼–è¯‘å™¨ä¸‹, å¿…é¡»å£°æ˜æ–¹æ³•</span></span><br><span class="line"><span class="comment">// åœ¨ clang ç¼–è¯‘ä¸‹, åªæ˜¯ç»™äº†è­¦å‘Š</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> drive();</span><br><span class="line"><span class="keyword">void</span> stop();</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    drive();</span><br><span class="line">    stop();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> ç¼–è¯‘</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g++<span class="number">-4.9</span> -o app main.c -L ./ -lCar</span><br></pre></td></tr></table></figure><p> æç¤ºä¿¡æ¯</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Undefined symbols <span class="keyword">for</span> architecture x86_64:</span><br><span class="line">  <span class="string">&quot;stop()&quot;</span>, referenced from:</span><br><span class="line">      _main <span class="keyword">in</span> ccZnwENu.o</span><br><span class="line">ld: symbol(s) not found <span class="keyword">for</span> architecture x86_64</span><br><span class="line">collect2: error: ld returned <span class="number">1</span> exit status</span><br></pre></td></tr></table></figure><p> è¿™è¯´æ˜äº†ä¸Šé¢æåˆ°çš„ç¬¬ä¸€ç§æƒ…å†µã€‚</p><p>é‡æ–°ç¼–è¯‘ <code>Car.c</code>ï¼Œæ¢ä¸ªæ–¹å¼ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g++<span class="number">-4.9</span> -shared -o libCar.so -fvisibility=<span class="keyword">default</span> Car.c</span><br></pre></td></tr></table></figure><p> <strong>æ³¨æ„: è¿™æ¬¡ä½¿ç”¨äº† default å±æ€§ã€‚</strong></p><p>ç¼–è¯‘ <code>main.c</code></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g++<span class="number">-4.9</span> -o app main.c -L ./ -lCar</span><br></pre></td></tr></table></figure><p> ç¼–è¯‘æˆåŠŸï¼Œè¿è¡Œç¨‹åº</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./app </span><br><span class="line">Car driving...</span><br><span class="line">Car stop.</span><br></pre></td></tr></table></figure><p> é‚£ä¹ˆä¿®æ”¹ä¸€ä¸‹ <code>Car.c</code> çš„ä»£ç </p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;  </span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt; </span></span></span><br><span class="line"></span><br><span class="line">__attribute ((visibility(<span class="string">&quot;default&quot;</span>))) <span class="keyword">int</span> drive()</span><br><span class="line">&#123;</span><br><span class="line">    printf(<span class="string">&quot;Car driving...\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">__attribute ((visibility(<span class="string">&quot;hidden&quot;</span>))) <span class="keyword">void</span> stop()</span><br><span class="line">&#123;</span><br><span class="line">    printf(<span class="string">&quot;Car stop.\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>visibility=default</code> å’Œ <code>visibility=hidden</code> åˆ†åˆ«ç¼–è¯‘ <code>Car.c</code>.</p><p>å¯ä»¥çŸ¥é“ï¼Œ<code>stop</code> å‡½æ•°éƒ½æ˜¯éšè—çš„ï¼Œè¿™ä¸ªä¹Ÿå¾ˆå¥½çš„è¯´æ˜äº†ä¸Šé¢ä¸¤ä¸ªé—®é¢˜ã€‚</p><p>å¦å¤–ï¼Œé™¤äº† <code>default</code> å’Œ <code>hidden</code>ï¼Œè¿˜æœ‰ <code>internal</code>ã€ <code>protected</code> ç­‰ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„ä½¿ç”¨åœºæ™¯é€‰æ‹©ä½¿ç”¨å³å¯ã€‚</p><hr><p><strong>é€‰æ‹©æ¯”åŠªåŠ›æ›´é‡è¦ï¼Œå°†å°±å¯ä»¥ä¸€æ—¶ä½†ä¸èƒ½ä¸€ä¸–~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gcc clang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windows+Nginx éƒ¨ç½² Flutter Web</title>
      <link href="/2021/07/09/Windows-Nginx-%C2%B2%C2%BF%C3%8A%C4%91-Flutter-Web/"/>
      <url>/2021/07/09/Windows-Nginx-%C2%B2%C2%BF%C3%8A%C4%91-Flutter-Web/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©çš„å†…å®¹æ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬ç›´æ¥è¿›å…¥ä¸»é¢˜ã€‚</p><hr><h2 id="åˆ›å»ºå·¥ç¨‹"><a href="#åˆ›å»ºå·¥ç¨‹" class="headerlink" title="åˆ›å»ºå·¥ç¨‹"></a>åˆ›å»ºå·¥ç¨‹</h2><p>ç›®å‰ç¬”è€…ç”¨çš„ Flutter SDK æ˜¯ Stable 2.xï¼Œå…¶å·²ç»æ”¯æŒ Webäº†ã€‚</p><p>ä½¿ç”¨ Android Studio åˆ›å»º Flutter å·¥ç¨‹ï¼Œéœ€è¦å‹¾é€‰ä¸Šå¯¹ Web çš„æ”¯æŒï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2021/07/09/1.png"></p><p>å¦‚æœä½ ä¹‹å‰åˆ›å»ºçš„å·¥ç¨‹æ²¡æœ‰å‹¾é€‰è¯¥é€‰é¡¹ï¼Œå¯ä»¥åœ¨å·¥ç¨‹ç›®å½•ä¸‹æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">flutter create &lt;output directory&gt;</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">Create a new Flutter project <span class="keyword">in</span> the specified directory.</span></span><br><span class="line">flutter create .</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Recreating project ....</span><br><span class="line">  web\favicon.png (created)</span><br><span class="line">  web\icons\Icon-192.png (created)</span><br><span class="line">  web\icons\Icon-512.png (created)</span><br><span class="line">  web\index.html (created)</span><br><span class="line">  web\manifest.json (created)</span><br><span class="line"></span><br><span class="line">Wrote 8 files.</span><br><span class="line"></span><br><span class="line">All done!</span><br></pre></td></tr></table></figure><p>å®Œæˆä¹‹åï¼Œåœ¨å·¥ç¨‹ç›®å½•ä¸‹å°±ä¼šç”Ÿæˆ web ç›®å½•ã€‚</p><p><img src="/upload/images/2021/07/09/2.png"></p><h2 id="ç¼–è¯‘-Web-ç‰ˆæœ¬"><a href="#ç¼–è¯‘-Web-ç‰ˆæœ¬" class="headerlink" title="ç¼–è¯‘ Web ç‰ˆæœ¬"></a>ç¼–è¯‘ Web ç‰ˆæœ¬</h2><p>ç¼–è¯‘ Web ç‰ˆæœ¬åªéœ€è¦ä¸€è¡Œå‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flutter build web</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘æˆåŠŸåï¼Œåœ¨å·¥ç¨‹çš„ build ç›®å½•ä¸‹é¢æœ‰ä¸ª web ç›®å½•ã€‚</p><h2 id="Nginx-é…ç½®"><a href="#Nginx-é…ç½®" class="headerlink" title="Nginx é…ç½®"></a>Nginx é…ç½®</h2><p>åœ¨ Nginx çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œå¢åŠ ä¸€ä¸ª server é…ç½®å³å¯ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">        <span class="attribute">listen</span>       <span class="number">8083</span>;</span><br><span class="line">        <span class="attribute">server_name</span>  localhost;</span><br><span class="line">        <span class="section">location</span> / &#123;</span><br><span class="line">            <span class="comment"># webç›®å½•çš„è·¯å¾„</span></span><br><span class="line">            <span class="attribute">root</span>   \project-path\build\web;</span><br><span class="line">            <span class="comment"># é»˜è®¤é¡µé¢</span></span><br><span class="line">            <span class="attribute">index</span>  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>å¯åŠ¨ Nginxï¼ˆå…³äº Windows ä¸Šé¢æ“ä½œ Nginx çš„å‘½ä»¤ï¼Œå¯ä»¥å‚è€ƒç¬”è€…çš„ <a href="http://www.veryitman.com/2019/09/08/%E5%87%8F%E5%B0%91%E8%B7%A8%E5%9F%9F%E4%B8%AD%E7%9A%84OPTIONS%E8%AF%B7%E6%B1%82/">å‡å°‘è·¨åŸŸä¸­çš„OPTIONSè¯·æ±‚</a>) ï¼Œç„¶ååœ¨æµè§ˆå™¨ä¸­è®¿é—® <code>http://localhost:8083/index.html</code> å³å¯ã€‚</p><hr><p><strong>å­¦ä¹ çŠ¹å¦‚çˆ¬å±±ï¼Œé€‚å½“çš„å’¬ç´§ç‰™å…³å†²åˆºä¸€æŠŠï¼Œå°±èƒ½ä¸€è§ˆä¼—å±±å°</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
          <category> Flutter </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter Nginx Windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQLä¸»é”®å€¼è¢«æˆ‘ç”¨å®Œäº†</title>
      <link href="/2021/06/12/MySQL%E4%B8%BB%E9%94%AE%E5%80%BC%E8%A2%AB%E6%88%91%E7%94%A8%E5%AE%8C%E4%BA%86/"/>
      <url>/2021/06/12/MySQL%E4%B8%BB%E9%94%AE%E5%80%BC%E8%A2%AB%E6%88%91%E7%94%A8%E5%AE%8C%E4%BA%86/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>å¯¹äºå…³ç³»è¡¨ï¼Œæœ‰ä¸ªå¾ˆé‡è¦çš„çº¦æŸï¼Œå°±æ˜¯ä»»æ„ä¸¤æ¡è®°å½•ä¸èƒ½é‡å¤ã€‚ä¸èƒ½é‡å¤æ˜¯æŒ‡èƒ½å¤Ÿé€šè¿‡æŸä¸ªå­—æ®µå”¯ä¸€åŒºåˆ†å‡ºä¸åŒçš„è®°å½•ï¼Œè¿™ä¸ªå­—æ®µè¢«ç§°ä¸º <em>ä¸»é”®</em>ã€‚</p><p>å¯¹è¡¨çš„ä¸»é”®è¦æ±‚æ¯”è¾ƒå…³é”®çš„ä¸€ç‚¹æ˜¯ï¼šè®°å½•ä¸€æ—¦æ’å…¥åˆ°è¡¨ä¸­ï¼Œä¸»é”®æœ€å¥½ä¸è¦å†ä¿®æ”¹ã€‚</p><p>é€‰å–è¡¨çš„ä¸»é”®ä¸€ä¸ªåŸºæœ¬åŸåˆ™æ˜¯ï¼šæ²¡æœ‰ç‰¹æ®Šæƒ…å†µï¼Œä¸ä½¿ç”¨ä»»ä½•ä¸šåŠ¡ç›¸å…³çš„å­—æ®µï¼ˆå¦‚è¯ä»¶å·ç ã€æ‰‹æœºå·ç ç­‰ï¼‰ä½œä¸ºä¸»é”®ã€‚</p><p>æœ¬ç¯‡ä¸»è¦è¯´æ˜ä¸‹é¢ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li>ä¸»é”®å€¼èŒƒå›´è¶Šç•Œäº†ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</li><li>ä¸è®¾ç½®ä¸»é”®è¡Œå—ï¼Ÿ</li></ul><p>çœ‹å®Œæ­£æ–‡ä¹‹åï¼Œå¯ä»¥åœ¨æœ¬ç¯‡çš„ã€å°ç»“ã€‘éƒ¨åˆ†æ‰¾åˆ°ç­”æ¡ˆã€‚</p><p>æ¨èä¸‹é¢å‡ ç¯‡å…³äº MySQL çš„æ–‡ç« ï¼š</p><ul><li><a href="http://www.veryitman.com/2019/11/10/MySQL8-0-15%E5%9C%A8Win10%E4%B8%8A%E7%9A%84%E6%8A%98%E8%85%BE%E8%AE%B0">MySQL8-0-15åœ¨Win10ä¸Šçš„æŠ˜è…¾è®°</a></li><li><a href="http://www.veryitman.com/2019/12/07/%E5%BE%AE%E6%9C%8D%E5%8A%A1-MySQL%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/">å¾®æœåŠ¡-MySQLåŸºæœ¬æ“ä½œ</a></li><li><a href="http://www.veryitman.com/2020/12/13/%E5%AF%BC%E5%85%A5MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E6%96%87%E4%BB%B6/">å¯¼å…¥MySQLæ•°æ®åº“æ–‡ä»¶</a></li></ul><h2 id="æ•°å€¼ç±»å‹çš„è¾¹ç•Œå€¼"><a href="#æ•°å€¼ç±»å‹çš„è¾¹ç•Œå€¼" class="headerlink" title="æ•°å€¼ç±»å‹çš„è¾¹ç•Œå€¼"></a>æ•°å€¼ç±»å‹çš„è¾¹ç•Œå€¼</h2><p>C æ ‡å‡†åº“  <code>limits.h</code> ä¸­å®šä¹‰äº†ä¸€äº›æ•°æ®ç±»å‹çš„å€¼çš„èŒƒå›´ã€é™åˆ¶å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥ç±»å‹çš„å€¼ä¸å¯ä»¥å¤§äºè¯¥ä¸Šç•Œæˆ–è€…å°äºè¯¥ç±»å‹å€¼çš„ä¸‹ç•Œã€‚</p><p>å’±ä»¬å…ˆçœ‹ä¸‹ä¸‹é¢è¿™ä¸ª C è¯­è¨€ä¾‹å­ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;limits.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 65535</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;unsigned short max value: %u\n&quot;</span>, USHRT_MAX);</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">short</span> yy = USHRT_MAX;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;xx = %hu\n&quot;</span>, yy); <span class="comment">//65535</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;xx + 1 = %hu\n&quot;</span>, yy+<span class="number">1</span>); <span class="comment">//0</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;xx + 2 = %hu\n&quot;</span>, yy+<span class="number">2</span>); <span class="comment">//1</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;unsigned short sizeof: %u\n&quot;</span>, <span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">short</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘è¿è¡Œï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">short</span> max value: <span class="number">65535</span></span><br><span class="line">xx = <span class="number">65535</span></span><br><span class="line">xx + <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">xx + <span class="number">2</span> = <span class="number">1</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">short</span> <span class="keyword">sizeof</span>: <span class="number">2</span></span><br></pre></td></tr></table></figure><p>ä»ç»“æœæ¥çœ‹ï¼Œæ— ç¬¦å·çš„ short æ•°æ®ç±»å‹çš„æœ€å¤§å€¼æ˜¯ 65535ï¼Œå½“ç„¶æœ€å°å€¼å°±æ˜¯ 0ï¼Œå³èŒƒå›´æ˜¯ 0 ~ 65535ã€‚</p><p>åœ¨è¿™é‡Œï¼Œè¿˜æ˜¯è¦å†æä¸€ä¸‹å…³äºæ ¼å¼åŒ–æ‰“å°é‡Œé¢çš„ä¸€äº›è¯´æ˜ï¼š</p><ul><li><p><code>i%</code> å’Œ <code>d%</code>ï¼Œéƒ½å¯ä»¥ç”¨æ¥è¡¨ç¤ºæœ‰ç¬¦å·çš„åè¿›åˆ¶æ•´æ•°ï¼Œä¸€èˆ¬ <code>ld%</code> ç”¨æ¥è¡¨ç¤º <code>long</code> ç±»å‹çš„ï¼›</p></li><li><p><code>o%</code> ç”¨æ¥è¡¨ç¤ºå…«è¿›åˆ¶æ•´æ•°ï¼Œ<code>x%</code>ï¼ˆ<code>X%</code>ï¼‰ç”¨æ¥è¡¨ç¤ºåå…­è¿›åˆ¶æ•´æ•°ï¼›</p></li><li><p>å¯¹ <code>short</code> ç±»å‹ä½¿ç”¨ <code>h</code> å‰ç¼€ï¼Œå› æ­¤ <code>%hd</code> è¡¨ç¤ºä»¥åè¿›åˆ¶æ˜¾ç¤º <code>short</code> æ•´æ•°ï¼Œ<code>%ho</code> è¡¨ç¤ºä»¥å…«è¿›åˆ¶æ˜¾ç¤º <code>short</code> æ•´æ•°ï¼›</p></li><li><p><code>%u</code> ç”¨æ¥è¡¨ç¤ºæ— ç¬¦å·æ•´æ•°ï¼Œå³ <code>unsigned int</code> ç±»å‹æ•°æ®ï¼›</p></li><li><p><code>h%</code> å’Œ <code>l%</code> å‰ç¼€éƒ½å¯ä»¥åŒ <code>u%</code> ç»“åˆä½¿ç”¨è¡¨ç¤ºæ— ç¬¦å·æ•´æ•°ã€‚å¦‚ <code>%lu</code> è¡¨ç¤ºæ‰“å° <code>unsigned long</code> ç±»å‹ã€<code>%hu</code> è¡¨ç¤ºæ‰“å° <code>unsigned short</code> ç±»å‹ï¼›</p></li><li><p>æ‰“å° <code>long</code> æ•°å€¼ï¼Œ<code>%ld</code> æ‰“å° <code>long</code> æ•°å€¼ï¼Œ<code>%lx</code> è¡¨ç¤ºä»¥åå…­è¿›åˆ¶æ ¼å¼æ‰“å°é•¿æ•´æ•°ï¼Œ<code>%lo</code> è¡¨ç¤ºä»¥å…«è¿›åˆ¶æ ¼å¼æ‰“å°é•¿æ•´æ•°ï¼›</p></li></ul><h2 id="å®è·µ"><a href="#å®è·µ" class="headerlink" title="å®è·µ"></a>å®è·µ</h2><p>ç»è¿‡ä¸Šé¢çš„è¯´æ˜ä¹‹åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥è¿›å…¥ä»Šå¤©çš„æ­£é¢˜äº†ã€‚</p><p>åˆ›å»ºæ•°æ®åº“ <code>play_db</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE play_db;</span><br><span class="line"></span><br><span class="line">USE play_db;</span><br></pre></td></tr></table></figure><h3 id="è®¾ç½®ä¸»é”®å¹¶è‡ªå¢"><a href="#è®¾ç½®ä¸»é”®å¹¶è‡ªå¢" class="headerlink" title="è®¾ç½®ä¸»é”®å¹¶è‡ªå¢"></a>è®¾ç½®ä¸»é”®å¹¶è‡ªå¢</h3><p>åˆ›å»ºè¡¨ <code>table0</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table0(id <span class="type">SMALLINT</span> unsigned AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY, name <span class="type">char</span>(<span class="number">10</span>)) AUTO_INCREMENT<span class="operator">=</span><span class="number">65535</span>;</span><br></pre></td></tr></table></figure><p>SMALLINT æ˜¯ MySQL æ”¯æŒçš„ä¸€ç§æ•°æ®ç±»å‹ï¼Œå ç”¨ 2 ä¸ªå­—èŠ‚ï¼Œæœ‰ç¬¦å·çš„å–å€¼èŒƒå›´æ˜¯ (-32 768ï¼Œ32 767)ï¼Œæ— ç¬¦å·çš„å–å€¼èŒƒå›´æ˜¯ (0ï¼Œ65 535)ã€‚</p><p>çœ‹ä¸‹åˆ›å»ºçš„è¡¨æƒ…å†µ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DESC</span> table0;</span><br></pre></td></tr></table></figure><p><img src="/upload/images/2021/06/12/1.png"></p><p>æ’å…¥æ•°æ®</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table0 (name) <span class="keyword">VALUES</span> (<span class="string">&#x27;veryitman&#x27;</span>);</span><br></pre></td></tr></table></figure><p><img src="/upload/images/2021/06/12/2.png"></p><p>å¯è§ï¼Œæ­¤æ—¶ id é»˜è®¤å€¼å·²ç»æ˜¯ 65535äº†ï¼Œè¯•å›¾å†æ’å…¥ä¸€æ¡æ•°æ®ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table0 (name) <span class="keyword">VALUES</span> (<span class="string">&#x27;.com&#x27;</span>);</span><br></pre></td></tr></table></figure><p><img src="/upload/images/2021/06/12/3.png"></p><p>é‚£ä¹ˆå¦å¤–ä¸€ä¸ªé—®é¢˜æ¥äº†ï¼Œå¦‚æœæˆ‘ä»¬ä¸è®¾ç½®ä¸»é”®å‘¢ï¼Ÿ</p><h3 id="ä¸è®¾ç½®ä¸»é”®æ— è‡ªå¢"><a href="#ä¸è®¾ç½®ä¸»é”®æ— è‡ªå¢" class="headerlink" title="ä¸è®¾ç½®ä¸»é”®æ— è‡ªå¢"></a>ä¸è®¾ç½®ä¸»é”®æ— è‡ªå¢</h3><p>åˆ›å»ºè¡¨ <code>table1</code></p><blockquote><p>TINYINT unsignedï¼Œè¡¨ç¤ºèŒƒå›´ 0 ~ 255</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table1(id TINYINT unsigned, name <span class="type">char</span>(<span class="number">10</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table1 (id, name) <span class="keyword">VALUES</span> (<span class="number">255</span>, <span class="string">&#x27;veryitman&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table1 (id, name) <span class="keyword">VALUES</span> (<span class="number">256</span>, <span class="string">&#x27;haha&#x27;</span>);</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ä¼šæŠ¥é”™ï¼š<code>ERROR 1264 (22003): Out of range value for column &#39;id&#39; at row 1</code></p><p>å¦‚æœä¸è®¾ç½®ä¸»é”®ï¼Œ InnoDB ä¼šè‡ªåŠ¨å¸®ä½ åˆ›å»ºä¸€ä¸ªä¸å¯è§çš„ã€é•¿åº¦ä¸º 6 å­—èŠ‚çš„ <code>row_id</code>ï¼Œè€Œä¸”è¿™ä¸ª <code>row_id</code> æ˜¯ç”± InnoDB ç»´æŠ¤å…¨å±€çš„ <code>dictsys.row_id</code>ï¼Œæ¯æ¬¡æ’å…¥ä¸€æ¡æ•°æ®æ—¶éƒ½ä¼šè®©å…¨å±€ <code>row_id</code> åŠ ä¸€ï¼ˆæœªå®šä¹‰ä¸»é”®çš„è¡¨ä¼šä½¿ç”¨å…¨å±€ <code>row_id</code> ä½œä¸ºä¸»é”® <code>id</code>ï¼‰ã€‚</p><p>å¦‚æœå…¨å±€ <code>row_id</code> ä¸€ç›´æ¶¨ï¼Œç›´åˆ°æ¶¨åˆ°2çš„48æ¬¡æ–¹-1æ—¶ï¼Œè¿™æ—¶å€™å†åŠ ä¸€å°±ä¼šè®©ä½ 48 ä½çš„ <code>row_id</code> éƒ½ä¸º 0ï¼Œæ­¤æ—¶å¦‚æœå†æ’å…¥ä¸€æ¡æ•°æ®ï¼Œå®ƒæ‹¿åˆ°çš„ <code>row_id</code> å°±æ˜¯ 0ï¼Œè¿™æ ·çš„è¯å°±æœ‰å¯èƒ½å­˜åœ¨ä¸»é”®å†²çªçš„ã€‚</p><p>æ‰€ä»¥åˆ›å»ºè¡¨çš„æ—¶å€™ï¼Œæœ€å¥½è®¾ç½®ä¸»é”®ã€‚</p><h3 id="è®¾ç½®è‡ªå¢ä½†æ— ä¸»é”®"><a href="#è®¾ç½®è‡ªå¢ä½†æ— ä¸»é”®" class="headerlink" title="è®¾ç½®è‡ªå¢ä½†æ— ä¸»é”®"></a>è®¾ç½®è‡ªå¢ä½†æ— ä¸»é”®</h3><p>åˆ›å»ºè¡¨ <code>table2</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table2(id TINYINT unsigned AUTO_INCREMENT, name <span class="type">char</span>(<span class="number">10</span>)) AUTO_INCREMENT<span class="operator">=</span><span class="number">255</span>;</span><br></pre></td></tr></table></figure><p>æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR <span class="number">1075</span> (<span class="number">42000</span>): Incorrect <span class="keyword">table</span> definition; there can be <span class="keyword">only</span> <span class="keyword">one</span> auto <span class="keyword">column</span> <span class="keyword">and</span> it must be defined <span class="keyword">as</span> a key</span><br></pre></td></tr></table></figure><p>é”™è¯¯ä¿¡æ¯çš„æ„æ€æ˜¯ï¼Œåªèƒ½æœ‰ä¸€ä¸ªè‡ªå¢åˆ—ï¼Œå®ƒå¿…é¡»è¢«å®šä¹‰ä¸ºé”®ã€‚</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>1ã€åœ¨è®¾è®¡æ•°æ®è¡¨æ—¶ï¼Œå°½é‡æ ¹æ®ä¸šåŠ¡éœ€æ±‚æ¥é€‰æ‹©åˆé€‚çš„å­—æ®µç±»å‹ã€‚æ•°æ®åº“è¡¨çš„è‡ªå¢ ID è¾¾åˆ°ä¸Šé™ä¹‹åï¼Œå†ç”³è¯·æ—¶å®ƒçš„å€¼å°±ä¸ä¼šåœ¨æ”¹å˜äº†ï¼Œç»§ç»­æ’å…¥æ•°æ®æ—¶ä¼šå¯¼è‡´æŠ¥ä¸»é”®å†²çªé”™è¯¯ã€‚</p><blockquote><p>ä¸€ä¸ªåº“æˆ–è€…è¡¨æ•°æ®å°½é‡ä¸è¦å¤ªå¤šï¼Œæ ¹æ®è‡ªå·±çš„ä¸šåŠ¡åˆé€‚è®¾ç½®å³å¯ã€‚å¦‚æœæ•°æ®è¾ƒå¤šè¦è¿›è¡Œåˆ†åº“åˆ†è¡¨ï¼Œåˆ†å¸ƒå¼ç¯å¢ƒä¸‹è¦æ³¨æ„ä¸»é”®ç”Ÿæˆé—®é¢˜ï¼Œåšåˆ°ä¸»é”®å”¯ä¸€ï¼›</p></blockquote><p>2ã€ä¸ºäº†é¿å…ä¸€äº›ä¸å¿…è¦çš„éº»çƒ¦å’Œéšæ€§é”™è¯¯ï¼Œè®¾è®¡è¡¨éƒ½åº”è¯¥è®¾ç½®ä¸»é”®ã€‚</p><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p><strong>MySQLæ”¯æŒçš„æ•°å€¼ç±»å‹</strong></p><p><img src="/upload/images/2021/06/12/4.png"></p><hr><p><strong>ä¸ç§¯è·¬æ­¥ï¼Œæ— ä»¥è‡³åƒé‡Œï¼›ä¸ç§¯å°æµï¼Œæ— ä»¥æˆæ±Ÿæµ·ã€‚</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>èµ°ä¸Šé¡¹ç®¡ä¹‹è·¯</title>
      <link href="/2021/05/23/%E8%B5%B0%E4%B8%8A%E9%A1%B9%E7%AE%A1%E4%B9%8B%E8%B7%AF/"/>
      <url>/2021/05/23/%E8%B5%B0%E4%B8%8A%E9%A1%B9%E7%AE%A1%E4%B9%8B%E8%B7%AF/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åœ¨å‡ å¹´å‰ï¼Œæˆ‘è¿˜ä¸çŸ¥é“é¡¹ç›®ç®¡ç†ç©¶ç«Ÿä¸ºä½•ç‰©ï¼Œè€Œå¦‚ä»Šè‡ªå·±å´ä¸å®ƒç´§ç´§ç›¸è¿ã€‚</p><p>è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹è‡ªå·±æ˜¯å¦‚ä½•èµ°ä¸Šé¡¹ç›®ç®¡ç†ä¹‹è·¯çš„ï¼Œå¸Œæœ›èƒ½å¯¹ä½ å°†æ¥çš„èŒä¸šè§„åˆ’æœ‰ç‚¹å¸®åŠ©ã€‚</p><h2 id="å¼€å‘ä¹‹è·¯"><a href="#å¼€å‘ä¹‹è·¯" class="headerlink" title="å¼€å‘ä¹‹è·¯"></a>å¼€å‘ä¹‹è·¯</h2><p>æœ¬äººå¤§å­¦çš„ä¸“ä¸šæ˜¯æç”µå­ä¿¡æ¯çš„ã€‚å¤§å­¦çš„ç”Ÿæ¶¯è®©æˆ‘å­¦åˆ°äº†å¾ˆå¤šé«˜æ·±è«æµ‹çš„çŸ¥è¯†ï¼Œä¹Ÿè®©æˆ‘ç»“è¯†äº†ä¸€å¸®å¿—åŒé“åˆçš„æœ‹å‹ï¼Œæœ‰å¹¸èƒ½å’Œä»–ä»¬ä¸€èµ·åœ¨å®éªŒå®¤é‡Œé¢æç ”ç©¶ã€‚å½“ç„¶å¤§å­¦æœ€é‡è¦çš„æ˜¯è®©æˆ‘è·å¾—äº†æ–‡å‡­ï¼Œä¸ºå°†æ¥æ‰¾å·¥ä½œåŸ‹ä¸‹äº†é‡è¦çš„åŸºç¡€ã€‚</p><p>æˆ‘æ˜¯ä» 2009 å¹´çœŸæ­£å¼€å§‹æ¥è§¦ç§»åŠ¨ç«¯ç¼–ç¨‹çš„ï¼Œé‚£ä¸ªæ—¶å€™ Android ç¼–ç¨‹æ…¢æ…¢çš„åœ¨ä¸€çº¿åŸå¸‚ç«äº†èµ·æ¥ï¼Œæœ‹å‹å»ºè®®æˆ‘è¶ç°åœ¨æœ‰æ—¶é—´èµ¶ç´§å­¦ä¸€å­¦ï¼šâ€œè¿™å¯èƒ½æ˜¯å°†æ¥è®©ä½ è¾‰ç…Œè…¾è¾¾çš„é¦–é€‰ä¹‹è·¯â€ã€‚å¬ç€ä»–ä¸­è‚¯çš„å»ºè®®ï¼Œä»¿ä½›è‡ªå·±å·²ç»èµ°ä¸Šäº†äººç”Ÿä¹‹é¢ ï¼Œæ¯”å½“å¹´å“¥ä¼¦å¸ƒå‘ç°æ–°å¤§é™†è¿˜ TM è¿˜å–œå‡ºæœ›å¤–ã€‚ç„¶é¹…æˆ‘ä¸ç¦ä¹æç”Ÿæ‚²ï¼ŒAndroid æ˜¯å•¥ï¼Ÿ</p><p>ç»è¿‡ä¸€ç•ªäº†è§£å’Œå­¦ä¹ ï¼Œç»ˆäºè®¤è¯†äº† Androidã€‚ä» Java ç¼–ç¨‹åˆ° Android ç¼–ç¨‹ï¼Œæˆ‘å¼€å§‹äº†è‡ªæˆ‘ä¿®ç‚¼ä¹‹è·¯ã€‚é‚£ä¸ªæ—¶å€™æˆ‘å°±åœ¨æƒ³ï¼Œè¿™ä¸ªç©æ„æŒºå¥½ç©çš„ï¼Œè¿™è¾ˆå­æˆ‘éƒ½è¦å­¦ä¹ å®ƒï¼Œç©è½¬å®ƒï¼ç°åœ¨æƒ³æƒ³é‚£ä¸ªæ—¶å€™çš„è‡ªå·±è¿˜æ˜¯æŒºç†æƒ³çš„ä¸€ä¸ªäººï¼Œå‘µå‘µï¼</p><p>æ¯•ä¸šåä¸ä¹…ï¼Œå°±æœ‰æ¨¡æœ‰æ ·çš„å¹²èµ·äº† Android å¼€å‘çš„å‹¾å½“ï¼Œè¿™ä¸€å¹²å°±æ˜¯ 5 å¹´ã€‚</p><p>ä»ä¸€ä¸ªæ„æ°”é£å‘çš„éªšå¹´å˜æˆäº†çœŸæ­£çš„ç å†œï¼Œé£˜é€¸çš„å¤´å‘ä¹Ÿæ¸æ¸çš„ç¨€ç–äº†èµ·æ¥ã€‚</p><p><img src="/upload/images/2021/05/23/1.jpg"></p><p>ç›´åˆ°æœ‰ä¸€å¤©ï¼Œé‡åˆ°ä¸€ä¸ªé¡¹ç›®ï¼Œå¤§ä½¬ï¼ˆé¡¹ç›®æŠ€æœ¯æ€»ç›‘ï¼‰å‘Šè¯‰æˆ‘è¯´ï¼šâ€œå›¢é˜Ÿç›®å‰æ²¡æœ‰ iOS å¼€å‘çš„äººå‘˜ï¼Œä½ æ˜¯å¦æ„¿æ„ä¸ºè‡ªå·±å¤šå¢åŠ ä¸€ç§æŠ€èƒ½ï¼Ÿâ€ã€‚</p><p>çœ‹ç€å¤§ä½¬è¯šæŒšçš„çœ¼ç¥ï¼Œå¹´å°‘è½»ç‹‚çš„æˆ‘æƒ³éƒ½æ²¡æƒ³å°±ç­”åº”äº†ã€‚ç°åœ¨å›æƒ³èµ·è‡ªå·±é‚£ç§å¾ˆè‡ªä¿¡çš„æ ·å­ï¼ŒæŒºå‚»çš„ã€‚</p><p>ä»é‚£ä»¥åï¼Œæˆ‘ä¾¿å¼€å§‹äº†æ²¡æ—¥æ²¡å¤œçš„èµ°ä¸Šäº†ç†Ÿæ‚‰å’Œå­¦ä¹  iOS ç¼–ç¨‹ä¹‹è·¯ï¼Œè‹¦å¹¶å¿«ä¹ç€ï¼Œå¯èƒ½æ˜¯å› ä¸ºè‡ªå·±çš„å‹¤å¥‹æ„ŸåŠ¨äº†ä¸Šè‹ï¼Œå¾ˆå¿«å°±ä¸Šæ‰‹äº† iOS å¼€å‘ï¼Œå¹¶åšå¾—å¦‚ç«å¦‚è¼ï¼Œä¸€å‘ä¸å¯æ”¶æ‹¾ã€‚</p><p>åœ¨ iOS å¼€å‘çš„åŒæ—¶ï¼Œæˆ‘å¹¶æ²¡æœ‰æ”¾å¼ƒå¯¹ Android å¼€å‘çš„å­¦ä¹ å’Œè¿›æ­¥ï¼Œä¸¤æ‰‹éƒ½è¦æŠ“å°½é‡éƒ½è¦ç¡¬ã€‚åœ¨åç»­çš„ç¼–ç¨‹é“è·¯é‡Œï¼Œæˆ‘è¶Šæ¥è¶Šå‘ç°ç¼–ç¨‹æ˜¯ç›¸é€šçš„ï¼Œåªè¦ä½ è‚¯åŠªåŠ›ï¼Œå°±æ²¡æœ‰å…‹æœä¸äº†çš„å›°éš¾ã€‚å”¯ä¸€è¦å…‹æœçš„å°±æ˜¯ä½ çš„æ‡’æƒ°å’Œå€Ÿå£ã€‚</p><p>æ…¢æ…¢åœ°æˆ‘åˆå¼€å§‹æ¥è§¦äº† Java åç«¯ç¼–ç¨‹ï¼Œç§»åŠ¨ç«¯æ¸¸æˆå¼€å‘ç­‰å·¥ä½œã€‚å”¯ä¸€é—æ†¾çš„æ˜¯æ²¡æœ‰æ¥è§¦è¿‡å‰ç«¯ç¼–ç¨‹ï¼Œå½“å…¨æ ˆå·¥ç¨‹å¸ˆçš„æ¢¦æƒ³ä¹Ÿå°±ç ´ç­äº†ã€‚</p><p><img src="/upload/images/2021/05/23/2.png"></p><p>ä»»ä½•äººéƒ½æœ‰é€‰æ‹©çš„æƒåŠ›ï¼Œåœ¨æŸä¸ªé£å’Œæ—¥ä¸½çš„æ—©ä¸Šæˆ‘æ¯…ç„¶é€‰æ‹©è¦æ”¾å¼ƒç¼–ç¨‹ä¹‹è·¯ï¼Œå‡†å¤‡è¸ä¸Šé¡¹ç›®ç®¡ç†ä¹‹è·¯ã€‚</p><p>æœ‰å¾ˆå¤šäººä¼šè¯´ï¼Œä½ æ˜¯å› ä¸ºå¹´é¾„çš„é—®é¢˜æ‰æƒ³ç€è½¬ç®¡ç†è·¯çº¿çš„å§ï¼</p><p>æˆ‘åªèƒ½è¯´ï¼Œå¹´é¾„åªæ˜¯å¾ˆå°çš„ä¸€éƒ¨åˆ†å› ç´ ã€‚æ¯•ç«Ÿè¿™ä¸ªä¸–ç•Œä¸Šè¿˜æœ‰å¾ˆå¤šäº‹æƒ…ï¼Œæˆ‘è¿˜æ²¡æœ‰ç»å†è¿‡ï¼Œä¹Ÿæƒ³åœ¨æœ‰ç”Ÿä¹‹å¹´æ¢ä¸€ç§æ±‚ç”Ÿä¹‹è·¯ã€‚</p><h2 id="é¡¹ç›®ç®¡ç†ä¹‹è·¯"><a href="#é¡¹ç›®ç®¡ç†ä¹‹è·¯" class="headerlink" title="é¡¹ç›®ç®¡ç†ä¹‹è·¯"></a>é¡¹ç›®ç®¡ç†ä¹‹è·¯</h2><p>èƒ½ä»ç¼–ç¨‹ä¹‹è·¯è½¬åˆ°é¡¹ç®¡ä¹‹è·¯ï¼Œè·Ÿå½“æ—¶çš„é¡¹ç›®æœ‰å…³ï¼Œå¯¹æˆ‘æ¥è¯´ä¹Ÿæ˜¯ä¸€ä¸ªæœºä¼šã€‚</p><p>èµ°ä¸Šé¡¹ç®¡çš„å†ç¨‹ï¼Œè®©æˆ‘æƒ³èµ·äº†ç”µå½±ã€ŠåŠŸå¤«ã€‹é‡Œé¢çš„ä¸€ä¸ªç‰‡æ®µï¼š</p><p><img src="/upload/images/2021/05/23/3.png"></p><blockquote><p>â€œå”‰ï¼Œå°å¼Ÿï¼Œå°å¼Ÿï¼Œåˆ«èµ°å•Šâ€</p><p>â€œå“‡ï¼Œä¸å¾—äº†ï¼Œä¸å¾—äº†å•Šï¼</p><p>ä½ æœ‰é“çµå…‰ä»å¤©çµç›–å–·å‡ºæ¥ï¼Œä½ çŸ¥é“å—ï¼Ÿ</p><p>å¹´çºªè½»è½»çš„å°±æœ‰ä¸€èº«æ¨ªç»ƒçš„ç­‹éª¨ï¼Œç®€ç›´ç™¾å¹´ä¸€è§çš„ç»ƒæ­¦å¥‡æ‰å•Šï¼</p><p>å¦‚æœæœ‰ä¸€å¤©ï¼Œè®©ä½ æ‰“é€šä»»ç£äºŒè„‰ï¼Œé‚£è¿˜ä¸é£é¾™ä¸Šå¤©å“ªï¼Ÿï¼</p><p>æ­£æ‰€è°“ï¼šæˆ‘ä¸å…¥åœ°ç‹±ï¼Œè°å…¥åœ°ç‹±ã€‚è­¦æ¶æƒ©å¥¸ï¼Œç»´æŠ¤ä¸–ç•Œå’Œå¹³è¿™ä¸ªä»»åŠ¡ï¼Œå°±äº¤ç»™ä½ äº†ï¼Œå¥½å—ï¼Ÿâ€</p></blockquote><blockquote><p>â€œå””â€</p></blockquote><p>ã€‚ã€‚ã€‚</p><p>å½“ç„¶äº†ï¼Œç”µå½±ä¸­çš„ç‰‡æ®µå­˜åœ¨ä¸€å®šå¿½æ‚ çš„æˆåˆ†ã€‚è¿™é‡Œæƒ³è¡¨è¾¾çš„æ˜¯ï¼šå½“æœºä¼šæ¥ä¸´çš„æ—¶å€™ï¼Œåšä¸€ä¸‹å¯¹æ¯”å’Œè¡¡é‡ï¼Œé€‚åˆå°±ä¸Šå§ï¼</p><p>æˆ‘å¾ˆæ„Ÿè°¢å½“åˆè®©æˆ‘è½¬è¡Œçš„å¤§ä½¬ï¼Œç»™äº†æˆ‘å¾ˆå¤šä¸“ä¸šçš„å»ºè®®ï¼Œè®©æˆ‘åœ¨è¿™æ¡è·¯ä¸Šèƒ½å¤Ÿæœ‰ä¸ªå¾ˆå¥½çš„å¼€å§‹ã€‚</p><p>åœ¨è½¬è¡Œåï¼Œè‡ªå·±ä¹Ÿæ˜¯ç§¯æçš„å­¦ä¹ é¡¹ç›®ç®¡ç†çŸ¥è¯†ï¼Œè™½æ²¡æœ‰æ‚¬æ¢åˆºè‚¡å€’ä¹Ÿä¼šé—»é¸¡èµ·èˆã€‚</p><p>åœ¨é¡¹ç›®ç®¡ç†çš„èŒä¸šç”Ÿæ¶¯ä¸­ï¼Œå¹¶éæ˜¯ä¸€å¸†é£é¡ºçš„ï¼Œè·Ÿç¼–ç¨‹ä¸€æ ·éœ€è¦ä¸æ–­çš„å­¦ä¹ ã€‚è®©é¡¹ç›®æˆåŠŸï¼Œæ˜¯é¡¹ç›®ç®¡ç†ä¸­çš„é‡è¦ä½¿å‘½ã€‚</p><p>è¿™é‡Œè¦ç»™åœ¨åº§çš„å„ä½æä¸ªé†’ï¼Œé¡¹ç›®ç®¡ç†ä¸æ˜¯è®©ä½ æ¥é¢æŒ‡æ°”ä½¿ç®¡äººçš„ï¼Œè€Œæ˜¯è®©ä½ èƒ½å¤ŸæŠŠæ¡å¤§å±€ï¼Œè¥é€ æ°›å›´è®©å¤§å®¶åˆ›é€ ä¸€ä¸ªåˆä¸€ä¸ªæˆåŠŸçš„é¡¹ç›®ã€‚</p><p>åœ¨å›¢é˜Ÿä¸­ï¼Œä½ åº”è¯¥åšæŒå…¬å¹³å…¬æ­£çš„åŸåˆ™ï¼Œç»´æŒé¡¹ç›®çš„å¯æŒç»­å¥åº·å‘å±•ï¼Œåšå¥½æœåŠ¡å¤§ä¼—çš„è§’è‰²å’Œä¹‰åŠ¡ï¼</p><p>~</p><p>ä»Šå¤©å°±åˆ°è¿™å§ï¼Œåç»­æˆ‘ä¼šåˆ†äº«æ›´å¤šå…³äºè‡ªå·±åœ¨é¡¹ç›®ç®¡ç†ä¸­çš„å®é™…æ¡ˆä¾‹ç»™å¤§å®¶~</p><hr><p><strong>ä»»ä½•äº‹éƒ½æ²¡æœ‰è¡¨é¢çœ‹èµ·æ¥çš„é‚£ä¹ˆç®€å•ï¼Œæ—¢ç„¶é€‰æ‹©äº†ä½ è®¤ä¸ºé€‚åˆè‡ªå·±çš„å°±åšæŒä¸‹å»ï¼ç»ˆå¯è§ï¼</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> é¡¹ç›®ç®¡ç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¡¹ç›®ç®¡ç† èŒä¸šè§„åˆ’ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ASã€VSCodeä¸­å®æ—¶æ˜¾ç¤ºæ¯è¡Œä»£ç çš„ä¿®æ”¹è®°å½•</title>
      <link href="/2021/04/12/AS%E3%80%81VSCode%E4%B8%AD%E5%AE%9E%E6%97%B6%E6%98%BE%E7%A4%BA%E6%AF%8F%E8%A1%8C%E4%BB%A3%E7%A0%81%E7%9A%84%E4%BF%AE%E6%94%B9%E8%AE%B0%E5%BD%95/"/>
      <url>/2021/04/12/AS%E3%80%81VSCode%E4%B8%AD%E5%AE%9E%E6%97%B6%E6%98%BE%E7%A4%BA%E6%AF%8F%E8%A1%8C%E4%BB%A3%E7%A0%81%E7%9A%84%E4%BF%AE%E6%94%B9%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>é˜…è¯»ä¸‹é¢å†…å®¹å¼€å§‹ä¹‹å‰ï¼Œå‡è®¾ä½ å·²ç»åœ¨ä½¿ç”¨ git ç®¡ç†è‡ªå·±çš„ä»£ç äº†ã€‚</p><p>é˜…è¯»æœ¬ç¯‡ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹å†…å®¹ï¼š</p><p>1ã€å¦‚ä½•åœ¨ Android Studio ä¸­å®æ—¶æ˜¾ç¤ºæ¯è¡Œä»£ç çš„æäº¤å†å²è®°å½•ï¼›</p><p>2ã€å¦‚ä½•åœ¨ Android Studio ä¸­æŸ¥çœ‹å•ä¸ªæ–‡ä»¶çš„ä¿®æ”¹å†å²è®°å½•ï¼›</p><p>3ã€å¦‚ä½•åœ¨ Visual Studio Code ä¸­å®æ—¶æ˜¾ç¤ºæ¯è¡Œä»£ç çš„æäº¤å†å²è®°å½•ï¼›</p><h2 id="plugin-ä¹‹åŠŸ"><a href="#plugin-ä¹‹åŠŸ" class="headerlink" title="plugin ä¹‹åŠŸ"></a>plugin ä¹‹åŠŸ</h2><p>å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼Œåœ¨ä½¿ç”¨ IDE å·¥å…·çš„æ—¶å€™æ‰¾åˆ°é€‚åˆè‡ªå·±çš„æ’ä»¶å¯ä»¥è®©ä½ çš„å·¥ä½œäº‹åŠåŠŸå€ã€‚</p><p>å¤§å®¶å¯ä»¥åœ¨ åœ¨ AS ä¸­å®‰è£…å¦‚ä¸‹ä¸¤ä¸ªæ’ä»¶ï¼š</p><ul><li>Git</li><li>GitToolBox</li></ul><p><img src="/upload/images/2021/04/12/01.png"></p><p>å®‰è£…æ–¹å¼å¾ˆç®€å•ï¼Œ<code>File/Setttings/Plugins</code>ï¼Œæœç´¢æ’ä»¶åç§°ç›´æ¥å®‰è£…å®Œæˆé‡å¯ AS å³å¯ã€‚</p><p>åœ¨ VSCode ä¸­å®‰è£…å¦‚ä¸‹æ’ä»¶ï¼š</p><ul><li>GitLens</li></ul><p><img src="/upload/images/2021/04/12/02.png"></p><p>ä½¿ç”¨å¿«æ·é”® <code>Ctrl + Shift + P</code>ï¼Œè¾“å…¥ <code>Install Extensions</code>ï¼Œå†æœç´¢ <code>GitLens</code> å®‰è£…å³å¯ã€‚</p><p>å®‰è£…å®Œæˆä¹‹åï¼Œå°±å¯ä»¥å¦‚ä¸‹åˆ†åˆ«åœ¨ VSCode å’Œ AS ä¸­çš„æ•ˆæœäº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p>VSCode æ˜¾ç¤ºæ•ˆæœï¼š</p><p><img src="/upload/images/2021/04/12/03.png"></p><p>AS æ˜¾ç¤ºæ•ˆæœï¼š</p><p><img src="/upload/images/2021/04/12/04.png"></p><h2 id="AS-è®¾ç½®-GitToolBox"><a href="#AS-è®¾ç½®-GitToolBox" class="headerlink" title="AS è®¾ç½® GitToolBox"></a>AS è®¾ç½® GitToolBox</h2><p>å¯ä»¥åœ¨ <code>File/Setting</code> ä¸­å¯¹ <code>GitToolBox</code> è¿›è¡Œç›¸å…³çš„è®¾ç½®ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="/upload/images/2021/04/12/07.png"></p><h2 id="AS-æŸ¥çœ‹å•æ–‡ä»¶ä¿®æ”¹è®°å½•"><a href="#AS-æŸ¥çœ‹å•æ–‡ä»¶ä¿®æ”¹è®°å½•" class="headerlink" title="AS æŸ¥çœ‹å•æ–‡ä»¶ä¿®æ”¹è®°å½•"></a>AS æŸ¥çœ‹å•æ–‡ä»¶ä¿®æ”¹è®°å½•</h2><p>æŒ‰ç…§ä¸‹é¢æˆªå›¾çš„æ­¥éª¤æ“ä½œå³å¯æŸ¥çœ‹ï¼Œä¾‹å¦‚æŸ¥çœ‹ <code>main.dart</code> çš„ä¿®æ”¹è®°å½•ã€‚</p><p><img src="/upload/images/2021/04/12/05.png"></p><p><img src="/upload/images/2021/04/12/06.png"></p><p><code>Show History</code> åï¼Œåœ¨æ‰“å¼€çš„é¡µé¢ä¸­å³å¯æŸ¥çœ‹è¯¥æ–‡ä»¶çš„ä¿®æ”¹è®°å½•ã€‚</p><p>å¦‚æœä½ ä¹ æƒ¯ä½¿ç”¨ git å‘½ä»¤è¡Œæ“ä½œï¼Œä¹Ÿå¯ä»¥ç»“åˆ <code>git log --pretty=oneline æ–‡ä»¶å</code> å’Œ <code>git show COMMITID</code> çš„æ–¹å¼æ¥æŸ¥çœ‹ã€‚</p><h2 id="å‘½ä»¤è¡Œä½¿ç”¨-code"><a href="#å‘½ä»¤è¡Œä½¿ç”¨-code" class="headerlink" title="å‘½ä»¤è¡Œä½¿ç”¨ code"></a>å‘½ä»¤è¡Œä½¿ç”¨ code</h2><p>æˆ‘ä»¬æœ‰æ—¶å€™æƒ³åœ¨å‘½ä»¤è¡Œä¸­ç›´æ¥ä½¿ç”¨ VSCode æ‰“å¼€å½“å‰ç›®å½•ï¼Œå¯ä»¥å®‰è£… <code>code</code> å‘½ä»¤ï¼Œåœ¨ macos ä¸Šé¢ä½¿ç”¨ <code>CMD+Shift+ P</code> æ‰“å¼€è¾“å…¥æ¡†ç„¶åè¾“å…¥ <code>shell command</code>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="/upload/images/2021/04/12/08.png"></p><p>å®‰è£…æˆåŠŸåï¼Œå°±å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨ <code>code</code> å‘½ä»¤äº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰“å¼€ VSCode</span></span><br><span class="line">code</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ VSCode æ‰“å¼€å½“å‰ç›®å½•</span></span><br><span class="line">code .</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ VSCode æ–°å»ºæ–‡ä»¶</span></span><br><span class="line">code custom.txt</span><br></pre></td></tr></table></figure><hr><p><strong>ä¸€å‘³çš„å¦¥åå’Œè®©æ­¥åªä¼šè®©äº‹æƒ…æ„ˆå‘ä»¥æ§åˆ¶ï¼Œç›´è‡³ç¾éš¾æ¥ä¸´~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git AS VSCode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡: Token ç›¸å…³çš„é‡æ„</title>
      <link href="/2021/01/17/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Token-%E7%9B%B8%E5%85%B3%E7%9A%84%E9%87%8D%E6%9E%84/"/>
      <url>/2021/01/17/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Token-%E7%9B%B8%E5%85%B3%E7%9A%84%E9%87%8D%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åœ¨ä¸Šä¸€ç¯‡ <a href="http://www.veryitman.com/2021/01/03/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Token%E7%9A%84%E5%A4%84%E7%90%86/">å¾®æœåŠ¡-Tokençš„å¤„ç†</a> ä¸­ï¼Œå†™äº†ä¸€ä¸ª <code>MSAuthTokenUtil</code> ç±»ï¼Œç”¨æ¥ç”Ÿæˆã€åˆ·æ–°ã€æ ¡éªŒ tokenï¼Œè¯¥ç±»çš„æ–¹æ³•éƒ½æ˜¯ <code>static</code> çš„ã€‚åç»­æƒ³äº†ä¸€ä¸‹ï¼Œè¿˜æ˜¯å°†å…¶æ”¹ä¸ºæ™®é€šçš„ç»„ä»¶è¾ƒå¥½ï¼Œåœ¨æœ€æ–°ä»£ç ä¸­å¯¹å…¶åšäº†ä¸¤ä¸ªè¾ƒå¤§çš„é‡æ„ã€‚</p><h2 id="é‡æ„ä¸ºç»„ä»¶"><a href="#é‡æ„ä¸ºç»„ä»¶" class="headerlink" title="é‡æ„ä¸ºç»„ä»¶"></a>é‡æ„ä¸ºç»„ä»¶</h2><p>å°†å…¶æ”¹åä¸º <code>MSAuthTokenHelper</code>ï¼Œå¹¶å°†å…¶ä¸­çš„æ‰€æœ‰ <code>static</code> æ–¹æ³•æ”¹ä¸ºå®ä¾‹æ–¹æ³•ï¼Œç”¨æ³¨è§£ <code>@Component </code> ä¿®é¥°ã€‚ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSAuthTokenHelper</span> &#123;</span><br><span class="line">    <span class="comment">///....</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æ‰€æœ‰ä½¿ç”¨åˆ° <code>MSAuthTokenHelper</code> çš„åœ°æ–¹ï¼Œå¢åŠ å¯¹åº”çš„è‡ªåŠ¨æ³¨å…¥åè°ƒç”¨å³å¯ã€‚å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> MSAuthTokenHelper tokenHelper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setTokenHelper</span><span class="params">(MSAuthTokenHelper tokenHelper)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.tokenHelper = tokenHelper;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> MSResponse <span class="title function_">refreshUserToken</span><span class="params">(String token)</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    </span><br><span class="line">    <span class="type">String</span> <span class="variable">refreshToken</span> <span class="operator">=</span> tokenHelper.refreshToken(token);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != refreshToken) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">userID</span> <span class="operator">=</span> tokenHelper.userIDfromToken(token);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¡ºä¾¿æä¸€ä¸‹ï¼Œ<code>@Controller</code>ï¼Œ<code>@Service</code>ï¼Œ<code>@Repository</code> ä»¥åŠ <code>@Component</code> çš„åŒºåˆ«ä»¥åŠè”ç³»ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><table><thead><tr><th align="left">æ³¨è§£</th><th align="left">å«ä¹‰</th></tr></thead><tbody><tr><td align="left">@Component</td><td align="left">æœ€æ™®é€šçš„ç»„ä»¶ï¼Œå¯ä»¥è¢«æ³¨å…¥åˆ°springå®¹å™¨è¿›è¡Œç®¡ç†</td></tr><tr><td align="left">@Repository</td><td align="left">ä½œç”¨äºæŒä¹…å±‚</td></tr><tr><td align="left">@Service</td><td align="left">ä½œç”¨äºä¸šåŠ¡é€»è¾‘å±‚</td></tr><tr><td align="left">@Controller</td><td align="left">ä½œç”¨äºè¡¨ç°å±‚ï¼ˆspring-mvcçš„æ³¨è§£ï¼‰</td></tr></tbody></table><p><code>@Controller</code>ï¼Œ<code>@Service</code>ï¼Œ<code>@Repository</code> éƒ½ç»§æ‰¿äº† <code>@Component</code> çš„åŠŸèƒ½ï¼Œå¯ä»¥çœ‹è¿™å‡ ä¸ªæ³¨è§£çš„æºç å¾—çŸ¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// Repository æ³¨è§£</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Repository &#123;</span><br><span class="line">    <span class="meta">@AliasFor(</span></span><br><span class="line"><span class="meta">        annotation = Component.class</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Controller æ³¨è§£</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Controller &#123;</span><br><span class="line">    <span class="meta">@AliasFor(</span></span><br><span class="line"><span class="meta">        annotation = Component.class</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Service æ³¨è§£</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Service &#123;</span><br><span class="line">    <span class="meta">@AliasFor(</span></span><br><span class="line"><span class="meta">        annotation = Component.class</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“ä¸€ä¸ªç±»è¢« <code>@Component</code> æ‰€æ³¨è§£ï¼Œé‚£ä¹ˆå°±æ„å‘³ç€åŒæ ·å¯ä»¥ç”¨ <code>@Repository</code>, <code>@Service</code>, <code>@Controller</code> æ¥æ›¿ä»£å®ƒï¼ŒåŒæ—¶è¿™ä¸‰ä¸ªæ³¨è§£ä¼šå…·å¤‡æœ‰æ›´å¤šçš„åŠŸèƒ½ï¼Œè€Œä¸”åŠŸèƒ½å„å¼‚ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦ä½¿ç”¨ä¸åŒçš„æ³¨è§£æ¥è¡¨ç¤ºä¸åŒçš„ä¸šåŠ¡å’Œé€»è¾‘ã€‚å…·ä½“å¯ä»¥å‚è€ƒ <a href="https://www.cnblogs.com/greatLong/articles/11910303.html">Spring&#x2F;Spring-Boot å­¦ä¹  @Controller,@Component,@Service,@Repositoryçš„å¼‚åŒ</a> è¿™ç¯‡æ–‡ç« ï¼Œå†™çš„å¾ˆæ¸…æ¥šäº†ã€‚</p><h2 id="ä»é…ç½®æ–‡ä»¶è¯»å–-token-çš„é…ç½®"><a href="#ä»é…ç½®æ–‡ä»¶è¯»å–-token-çš„é…ç½®" class="headerlink" title="ä»é…ç½®æ–‡ä»¶è¯»å– token çš„é…ç½®"></a>ä»é…ç½®æ–‡ä»¶è¯»å– token çš„é…ç½®</h2><p>åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­ï¼Œåˆ†äº«è¿‡å¦‚ä½•é€šè¿‡ SpringBoot çš„ <code>@ConfigurationProperties</code> æ³¨è§£æ¥è¯»å–é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥å‚è€ƒ <a href="http://www.veryitman.com/2020/08/02/%E5%BE%AE%E6%9C%8D%E5%8A%A1-ConfigurationProperties%E9%85%8D%E7%BD%AE/">å¾®æœåŠ¡-ConfigurationPropertiesé…ç½®</a> è¿™ç¯‡æ–‡ç« ã€‚</p><p>åœ¨ <code>properties</code> æ–‡ä»¶ä¸­ï¼Œæ–°å¢å¦‚ä¸‹çš„é…ç½®ä¿¡æ¯:</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Auth token config</span></span><br><span class="line"><span class="comment"># --------------------------------------------</span></span><br><span class="line"><span class="attr">msconfig.authtoken.claims_jwtsid</span>=<span class="string">restful_api</span></span><br><span class="line"><span class="attr">msconfig.authtoken.claims_subject</span>=<span class="string">admin</span></span><br><span class="line"><span class="attr">msconfig.authtoken.claims_audience</span>=<span class="string">client</span></span><br><span class="line"><span class="comment">#token è¿‡æœŸæ—¶é—´24å°æ—¶(24 * 60 * 60 * 1000)</span></span><br><span class="line"><span class="attr">msconfig.authtoken.token_expire_time</span>=<span class="string">86400000</span></span><br><span class="line"><span class="comment">#å¯†é’¥ç›</span></span><br><span class="line"><span class="attr">msconfig.authtoken.token_secret</span>=<span class="string">token123</span></span><br></pre></td></tr></table></figure><p>è¿™äº›é…ç½®ä¿¡æ¯å¯¹åº”çš„ model æ˜¯ <code>MSAuthTokenPropertyConfig</code>ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;msconfig.authtoken&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSAuthTokenPropertyConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String claims_jwtsid;</span><br><span class="line">    <span class="keyword">private</span> String claims_subject;</span><br><span class="line">    <span class="keyword">private</span> String claims_audience;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> token_expire_time;<span class="comment">//token è¿‡æœŸæ—¶é—´24å°æ—¶</span></span><br><span class="line">    <span class="keyword">private</span> String token_secret;<span class="comment">//å¯†é’¥ç›</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ <code>MSAuthTokenHelper</code>ç›´æ¥ä½¿ç”¨å³å¯ï¼Œå…³é”®ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSAuthTokenHelper</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> MSAuthTokenPropertyConfig authTokenPropertyConfig;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAuthTokenPropertyConfig</span><span class="params">(MSAuthTokenPropertyConfig authTokenPropertyConfig)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.authTokenPropertyConfig = authTokenPropertyConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">generateToken</span><span class="params">(String userID)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">tokenExpireTime</span> <span class="operator">=</span> authTokenPropertyConfig.getToken_expire_time();</span><br><span class="line">        <span class="type">String</span> <span class="variable">jwtsid</span> <span class="operator">=</span> authTokenPropertyConfig.getClaims_jwtsid();</span><br><span class="line">        <span class="type">String</span> <span class="variable">subject</span> <span class="operator">=</span> authTokenPropertyConfig.getClaims_subject();</span><br><span class="line">        <span class="type">String</span> <span class="variable">audience</span> <span class="operator">=</span> authTokenPropertyConfig.getClaims_audience();</span><br><span class="line">        <span class="type">String</span> <span class="variable">tokenSecret</span> <span class="operator">=</span> authTokenPropertyConfig.getToken_secret();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> token;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JWT Token Refractor </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡: Tokençš„å¤„ç†</title>
      <link href="/2021/01/03/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Token%E7%9A%84%E5%A4%84%E7%90%86/"/>
      <url>/2021/01/03/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Token%E7%9A%84%E5%A4%84%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åœ¨ <a href="http://www.veryitman.com/2020/11/15/Win10-%E5%AE%89%E8%A3%85-Redis/">Win10-å®‰è£…-Redis</a> å’Œ <a href="http://www.veryitman.com/2020/12/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-SpringBoot-%E9%9B%86%E6%88%90-Redis/">å¾®æœåŠ¡-SpringBoot-é›†æˆ-Redis</a> åˆ†åˆ«ä»‹ç»äº†å¦‚ä½•å®‰è£…å’Œä½¿ç”¨ Redisï¼Œä»Šå¤©ç»§ç»­ç»“åˆ Redisï¼ŒèŠèŠ token æˆæƒç™»å½•çš„äº‹æƒ…ã€‚</p><p>ä»Šå¤©èŠçš„ä¸»è§’æ˜¯ JWTï¼ŒèŠå®Œ JWT ä¹‹åå†ç»“åˆå®ä¾‹å®ç°ç”¨æˆ· token ç™»å½•ã€‚</p><h2 id="JWT-ä»‹ç»"><a href="#JWT-ä»‹ç»" class="headerlink" title="JWT ä»‹ç»"></a>JWT ä»‹ç»</h2><p>JWTï¼ŒJSON Web Token çš„ç¼©å†™ï¼ŒåŸºäº <a href="https://tools.ietf.org/html/rfc7519">RFC 7519</a> æ ‡å‡†ã€‚</p><p>ä¸‹é¢å†…å®¹æ¥è‡ª <a href="https://jwt.io/">jwd.io</a>ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JSON Web Tokens are an open, industry standard RFC 7519 method for representing claims securely between two parties.</span><br></pre></td></tr></table></figure><p>JWT å®šä¹‰äº†ä¸€ç§ç´§å‡‘çš„ã€è‡ªåŒ…å«çš„æ–¹å¼ï¼Œç”¨äºä½œä¸º JSON å¯¹è±¡åœ¨å„æ–¹ä¹‹é—´å®‰å…¨åœ°ä¼ è¾“ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯å¯ä»¥è¢«éªŒè¯å’Œä¿¡ä»»ï¼ˆå› ä¸ºå®ƒæ˜¯æ•°å­—ç­¾åçš„ï¼‰ã€‚</p><p>JWT å¯åº”ç”¨äºä½†ä¸ä»…é™äºä¸‹é¢çš„å‡ ç§åœºæ™¯ï¼š</p><p><strong>1ã€è·¨åŸŸè®¤è¯</strong></p><p>JWT æ˜¯ä¸€ç§æ¯”è¾ƒæµè¡Œçš„è·¨åŸŸè®¤è¯è§£å†³æ–¹æ¡ˆï¼ŒJWT çš„è¯ç”Ÿå¹¶ä¸æ˜¯è§£å†³ CSRF è·¨åŸŸæ”»å‡»ï¼Œè€Œæ˜¯è§£å†³è·¨åŸŸè®¤è¯çš„éš¾é¢˜ã€‚</p><p>A ç½‘ç«™å’Œ B ç½‘ç«™æ˜¯åŒä¸€å®¶å…¬å¸çš„å…³è”æœåŠ¡ï¼Œç°åœ¨è¦æ±‚ï¼Œç”¨æˆ·åªè¦åœ¨å…¶ä¸­ä¸€ä¸ªç½‘ç«™ç™»å½•ï¼Œå†è®¿é—®å¦ä¸€ä¸ªç½‘ç«™å°±ä¼šè‡ªåŠ¨ç™»å½•ï¼Œè¿™åº”è¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿå®¢æˆ·ç«¯ä¿å­˜ Tokenï¼Œæ¯æ¬¡è¯·æ±‚éƒ½å‘å›ç»™æœåŠ¡å™¨å³å¯ã€‚</p><p><strong>2ã€æˆæƒ</strong>ï¼ˆAuthorizationï¼‰</p><p>ç”¨æˆ·ä¸€æ—¦ç™»å½•æˆåŠŸåï¼Œåç»­ç”¨æˆ·çš„æ¯ä¸ªè¯·æ±‚éƒ½å°†åŒ…å« JWTï¼Œå…è®¸ç”¨æˆ·è®¿é—®è¯¥ä»¤ç‰Œå…è®¸çš„è·¯ç”±ã€æœåŠ¡å’Œèµ„æºã€‚å•ç‚¹ç™»å½•æ˜¯ç°åœ¨å¹¿æ³›ä½¿ç”¨çš„ JWT çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå› ä¸ºå®ƒçš„å¼€é”€å¾ˆå°ï¼Œå¹¶ä¸”å¯ä»¥è½»æ¾åœ°è·¨åŸŸä½¿ç”¨ã€‚æˆæƒï¼Œæ˜¯ä½¿ç”¨ JWT çš„æœ€å¸¸è§çš„åœºæ™¯ä¹‹ä¸€ã€‚</p><p><strong>3ã€ä¿¡æ¯äº¤æ¢</strong>ï¼ˆInformation Exchangeï¼‰ </p><p>å¯¹äºå®‰å…¨çš„åœ¨å„æ–¹ä¹‹é—´ä¼ è¾“ä¿¡æ¯è€Œè¨€ï¼ŒJWT æ˜¯ä¸€ç§å¾ˆå¥½çš„æ–¹å¼ã€‚JWT å¯ä»¥è¢«ç­¾åï¼Œä¾‹å¦‚ï¼Œç”¨å…¬é’¥&#x2F;ç§é’¥å¯¹ï¼Œå¯ä»¥ç¡®å®šå‘é€äººå°±æ˜¯å®ƒä»¬æ‰€è¯´çš„é‚£ä¸ªäººã€‚å¦å¤–ï¼Œç”±äºç­¾åæ˜¯ä½¿ç”¨å¤´å’Œæœ‰æ•ˆè´Ÿè½½è®¡ç®—çš„ï¼Œè¿˜å¯ä»¥éªŒè¯å†…å®¹æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚</p><p>å¯ä»¥å‚è€ƒé˜®ä¸€å³°è€å¸ˆçš„ <a href="http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html">JSON Web Token å…¥é—¨æ•™ç¨‹</a>ï¼Œæ›´å¤šè¯¦ç»†çš„ä»‹ç»å¯ä»¥å‚è€ƒ <a href="https://jwt.io/">jwd.io</a> çš„ç›¸å…³èµ„æ–™ã€‚</p><h2 id="ä½¿ç”¨-JWT"><a href="#ä½¿ç”¨-JWT" class="headerlink" title="ä½¿ç”¨ JWT"></a>ä½¿ç”¨ JWT</h2><h3 id="Spring-Boot-é›†æˆ-jjwt"><a href="#Spring-Boot-é›†æˆ-jjwt" class="headerlink" title="Spring Boot é›†æˆ jjwt"></a>Spring Boot é›†æˆ jjwt</h3><p>æœ¬æ–‡ä»¥é›†æˆ <a href="https://github.com/jwtk/jjwt">https://github.com/jwtk/jjwt</a> ä¸ºä¾‹ã€‚å¦‚æœä½ æœ‰å…´è¶£ä¹Ÿå¯ä»¥è¯•ç€å»ä½¿ç”¨ <a href="https://github.com/auth0/java-jwt%EF%BC%8C%E5%AE%83%E6%98%AF">https://github.com/auth0/java-jwtï¼Œå®ƒæ˜¯</a> JWT çš„å¦ä¸€ä¸ª Java å®ç°ã€‚</p><p>æˆªæ­¢åˆ°è¯¥æ–‡å‘å¸ƒï¼Œåœ¨ maven repository ä»“åº“ä¸­ <a href="https://mvnrepository.com/artifact/io.jsonwebtoken/jjwt?__cf_chl_jschl_tk__=40ed76b98ea56a31b34ae41068be356abf8e7c14-1609035481-0-AXWqPSMWrV3GrvD-HnJUNECglQaslmvbqqmHDG7k-9M_29qE9GRZ7nwtHkgj20FyvUbV-IqHyAZKdY10ws0QZectFAnTTF6idWvIqF2O-g_hc4soVukN5OssNoHWgnIAyGNWw2Q28eih-vEnuqJVLpkcsI2TrmW6Iv7vTrhFqSCplqYa9vntXVPeRuAcH174hq_Ep4XROJH84lwN__3I9NOG41A64oXIsyPC5i6ZfBwLTt7T1VC0JISbVfnGAAsekbFItQYPA_gfd_jnUDVG9ygyaW0luOrMFoejVThPtzAPr04IX-A7CNQJKVwpZgAMbb1WsjCwGHgKLdoOmkEkzwC66AmNlIh4tz2zEca4TO1-0TzHk9sz8u78f2sMQfdL8WyiXwUVJ5F30CB3tiN8wHw">jjwt</a> æœ€æ–°ç‰ˆæœ¬æ˜¯ <code>0.9.1</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.jsonwebtoken<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jjwt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹äº†å“ªäº›æ–‡ä»¶"><a href="#ä¿®æ”¹äº†å“ªäº›æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹äº†å“ªäº›æ–‡ä»¶"></a>ä¿®æ”¹äº†å“ªäº›æ–‡ä»¶</h3><p>æœ¬æ¬¡æ¶‰åŠä¿®æ”¹å’Œæ–°å¢çš„æ–‡ä»¶å¦‚ä¸‹ï¼š</p><ul><li>ã€ä¿®æ”¹ã€‘<code>MSUserSigninService.java</code>ï¼šç™»å½•æœåŠ¡çš„æ¥å£ï¼›</li><li>ã€ä¿®æ”¹ã€‘<code>MSUserSigninServiceImpl.java</code>ï¼šç™»å½•æœåŠ¡çš„æ¥å£å®ç°ï¼›</li><li>ã€ä¿®æ”¹ã€‘<code>MSSigninController.java</code>ï¼šç™»å½•çš„Controllerï¼›</li><li>ã€æ–°å¢ã€‘<code>MSAuthTokenUtil.java</code>ï¼štokenå·¥å…·ç±»ï¼›</li><li>ã€æ–°å¢ã€‘<code>MSAuthConfigurer.java</code>ï¼štokené…ç½®ç®¡ç†ï¼›</li><li>ã€æ–°å¢ã€‘<code>MSAuthInterceptor.java</code>ï¼šè‡ªå®šä¹‰æ‹¦æˆªå™¨ï¼›</li></ul><p>å…·ä½“çš„å®ç°æ­¥éª¤ä¸ºï¼š</p><ul><li>å†™ token å·¥å…·ç±»ï¼Œå®ç° token çš„ç”Ÿæˆï¼Œæ ¡éªŒç­‰å·¥ä½œå³ <code>MSAuthTokenUtil.java</code>;</li><li>å†™è‡ªå®šä¹‰æ‹¦æˆªå™¨ï¼Œå³ <code>MSAuthInterceptor.java</code>ï¼Œè¯¥ç±»å®ç°äº† <code>HandlerInterceptor</code> æ¥å£ï¼›<ul><li>æ‹¦æˆªå®¢æˆ·ç«¯ç›¸å…³çš„ API è¯·æ±‚ï¼Œå¯¹ç›¸å…³çš„æ¥å£è¿›è¡Œtokençš„æ ¡éªŒï¼›</li><li>æœ‰äº†ç»Ÿä¸€çš„æ‹¦æˆªå™¨ä¸éœ€è¦åœ¨æ¯ä¸ª Controller æˆ–è€…å¯¹åº”çš„ Service ä¸­å»åš token çš„åˆ¤æ–­ï¼›</li></ul></li><li>å†™è‡ªå®šä¹‰æ‹¦æˆªå™¨çš„é…ç½®ç®¡ç†ç±»å³ <code>MSAuthConfigurer.java</code>ï¼Œè¯¥ç±»å®ç°äº† <code>WebMvcConfigurer</code> æ¥å£ï¼›</li><li>å¢åŠ  token ç™»å½•çš„ APIï¼Œå¹¶å®ç° Redis ç¼“å­˜ token çš„é€»è¾‘ï¼›</li></ul><h3 id="å®ä¾‹æ¼”ç»ƒ"><a href="#å®ä¾‹æ¼”ç»ƒ" class="headerlink" title="å®ä¾‹æ¼”ç»ƒ"></a>å®ä¾‹æ¼”ç»ƒ</h3><p>ç”¨æˆ·ç™»å½•å®Œæˆåï¼Œæ ¹æ® userID ç”Ÿæˆ tokenï¼Œå°† token ä¿å­˜åˆ° Redis ä¸­æŒ‰ç…§ userID ä¸º key æ¥è¿›è¡Œå­˜å‚¨çš„ã€‚</p><p><code>MSAuthInterceptor.java</code> æ˜¯è‡ªå®šä¹‰çš„æ‹¦æˆªå™¨ï¼Œåœ¨è¯¥æ‹¦æˆªå™¨ä¸­è·å–è¯·æ±‚çš„ token å¹¶è¿›è¡Œç›¸å…³çš„æ ¡éªŒã€‚æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSAuthInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">REQUEST_TOKEN_KEY</span> <span class="operator">=</span> <span class="string">&quot;token&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">requestMethod</span> <span class="operator">=</span> request.getMethod();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;OPTIONS&quot;</span>.equalsIgnoreCase(requestMethod)) &#123;</span><br><span class="line">            response.setStatus(HttpServletResponse.SC_OK);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è¯·æ±‚çš„Headerä¸­æ‹¿</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> request.getHeader(REQUEST_TOKEN_KEY);</span><br><span class="line">        <span class="comment">// Headerä¸­æ‹¿ä¸åˆ°token</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == token) &#123;</span><br><span class="line">            String[] tokens = request.getParameterValues(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != tokens &amp;&amp; tokens.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                token = tokens[<span class="number">0</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (MSAuthTokenUtil.verifyToken(token)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">writer</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        response.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        response.setContentType(<span class="string">&quot;application/json; charset=utf-8&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            writer = response.getWriter();</span><br><span class="line">            Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">2</span>);</span><br><span class="line">            result.put(<span class="string">&quot;code&quot;</span>, <span class="number">400</span>);</span><br><span class="line">            result.put(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;ç”¨æˆ·ä»¤ç‰Œtokenæ— æ•ˆ&quot;</span>);</span><br><span class="line">            result.put(<span class="string">&quot;data&quot;</span>, <span class="literal">null</span>);</span><br><span class="line">            writer.print(result);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != writer) &#123;</span><br><span class="line">                writer.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‹¦æˆªå™¨çš„é…ç½®åœ¨ <code>MSAuthConfigurer.java</code> ä¸­è¿›è¡Œç®¡ç†ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSAuthConfigurer</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> MSAuthInterceptor authInterceptor;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MSAuthConfigurer</span><span class="params">(MSAuthInterceptor authInterceptor)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.authInterceptor = authInterceptor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        <span class="comment">// å¦‚ä¸‹è·¯å¾„ä¸åšæ‹¦æˆª</span></span><br><span class="line">        List&lt;String&gt; excludePaths = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        excludePaths.add(<span class="string">&quot;/signup/**&quot;</span>); <span class="comment">//æ³¨å†Œ</span></span><br><span class="line">        excludePaths.add(<span class="string">&quot;/signin/name/**&quot;</span>); <span class="comment">//ç”¨æˆ·åç™»å½•</span></span><br><span class="line">        excludePaths.add(<span class="string">&quot;/signin/get/token/**&quot;</span>); <span class="comment">//è·å–token</span></span><br><span class="line">        excludePaths.add(<span class="string">&quot;/signout/**&quot;</span>); <span class="comment">//ç™»å‡º</span></span><br><span class="line">        excludePaths.add(<span class="string">&quot;/static/**&quot;</span>);  <span class="comment">//é™æ€èµ„æº</span></span><br><span class="line">        excludePaths.add(<span class="string">&quot;/assets/**&quot;</span>);  <span class="comment">//é™æ€èµ„æº</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// é™¤äº† excludePaths å¤–çš„è¯·æ±‚åœ°å€éƒ½åšæ‹¦æˆª</span></span><br><span class="line">        registry.addInterceptor(authInterceptor)</span><br><span class="line">                .addPathPatterns(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">                .excludePathPatterns(excludePaths);</span><br><span class="line"></span><br><span class="line">        WebMvcConfigurer.<span class="built_in">super</span>.addInterceptors(registry);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥é‡ç‚¹è¯´ä¸€ä¸‹ <code>MSAuthTokenUtil.java</code> é‡Œé¢å¦‚ä½•ç”Ÿæˆ token çš„ï¼Œ<code>MSAuthTokenUtil.java</code> ä¸»è¦æ˜¯å®Œæˆç”Ÿæˆã€æ£€éªŒã€åˆ·æ–° token ç­‰å·¥ä½œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">generateToken</span><span class="params">(String userID)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">Date</span> <span class="variable">date</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    <span class="comment">// è¿‡æœŸæ—¶é—´</span></span><br><span class="line">    <span class="type">Date</span> <span class="variable">expireDate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>(System.currentTimeMillis() + TOKEN_EXPIRE_TIME);</span><br><span class="line"></span><br><span class="line">    token = Jwts.builder().setId(JWTSID)</span><br><span class="line">        .setSubject(SUBJECT)</span><br><span class="line">        .setAudience(AUDIENCE)</span><br><span class="line">        .setIssuedAt(date)</span><br><span class="line">        .setExpiration(expireDate)</span><br><span class="line">        .claim(CLAIMS_USERID, userID)</span><br><span class="line">        .signWith(SignatureAlgorithm.HS256, TOKEN_SECRET)</span><br><span class="line">        .compact();</span><br><span class="line"></span><br><span class="line">    log.info(<span class="string">&quot;generateToken token: &quot;</span> + token);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> token;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¹æ®ç”¨æˆ·ID ç”Ÿæˆ tokenï¼Œå…¶ä¸­ <code>claim(CLAIMS_USERID, userID)</code> æ˜¯ç”¨äºè‡ªå®šä¹‰å­—æ®µçš„ï¼Œä¾¿äºè§£æ token æ—¶è·å–ç›¸å…³çš„ä¿¡æ¯ã€‚</p><p>å½“æˆ‘ä»¬è°ƒç”¨ç”¨æˆ·å+å¯†ç ç™»å½•çš„æ—¶å€™ï¼Œä¼šç”Ÿæˆå¯¹åº”çš„ tokenï¼Œç„¶åå°†è¯¥ token ä¿å­˜åˆ° Redis ä¸­ã€‚ä¸‹æ¬¡è°ƒç”¨ token ç™»å½•çš„æ¥å£æ—¶ï¼Œä¼šä» Redis ä¸­å–å‡ºå¯¹åº”çš„ token ä¿¡æ¯è¿›è¡Œæ ¡å¯¹ï¼Œæ ¡å¯¹é€šè¿‡å°±è¿”å›æˆåŠŸï¼Œå¦åˆ™è¿”å›å¤±è´¥æ— æ³•ç™»å½•ã€‚</p><p>åœ¨ <code>MSSigninController.java</code> åˆ†åˆ«å®ç°äº†è·å– tokenã€åˆ·æ–° tokenï¼Œtoken ç™»å½•ä¸‰ä¸ªæ¥å£ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/get/token&quot;, method = RequestMethod.GET)</span></span><br><span class="line"><span class="meta">@ApiOperation(value = &quot;è·å–token&quot;, httpMethod = &quot;GET&quot;, notes = &quot;è·å–ç™»å½•&quot;)</span></span><br><span class="line"><span class="meta">@ApiImplicitParams(&#123;</span></span><br><span class="line"><span class="meta">    @ApiImplicitParam(name = &quot;userID&quot;, value = &quot;userID&quot;, required = true)</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="keyword">public</span> MSResponse <span class="title function_">getToken</span><span class="params">(<span class="meta">@RequestParam(value = &quot;userid&quot;)</span> String userID)</span> &#123;</span><br><span class="line">    <span class="type">MSResponse</span> <span class="variable">response</span> <span class="operator">=</span> userSigninService.fetchUserToken(userID);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/token&quot;, method = RequestMethod.GET)</span></span><br><span class="line"><span class="meta">@ApiOperation(value = &quot;Tokenç™»å½•&quot;, httpMethod = &quot;GET&quot;, notes = &quot;Tokenç™»å½•&quot;)</span></span><br><span class="line"><span class="meta">@ApiImplicitParams(&#123;</span></span><br><span class="line"><span class="meta">    @ApiImplicitParam(name = &quot;userID&quot;, value = &quot;userID&quot;, required = true),</span></span><br><span class="line"><span class="meta">    @ApiImplicitParam(name = &quot;token&quot;, value = &quot;token&quot;, required = true)</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="keyword">public</span> MSResponse <span class="title function_">siginWithToken</span><span class="params">(<span class="meta">@RequestParam(value = &quot;userid&quot;)</span> String userID, <span class="meta">@RequestParam(value = &quot;token&quot;)</span> String token)</span> &#123;</span><br><span class="line">    <span class="type">MSResponse</span> <span class="variable">response</span> <span class="operator">=</span> userSigninService.signinUsingToken(userID, token);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/refresh/token&quot;, method = RequestMethod.GET)</span></span><br><span class="line"><span class="meta">@ApiOperation(value = &quot;åˆ·æ–°Token&quot;, httpMethod = &quot;GET&quot;, notes = &quot;Tokenåˆ·æ–°&quot;)</span></span><br><span class="line"><span class="meta">@ApiImplicitParams(&#123;</span></span><br><span class="line"><span class="meta">    @ApiImplicitParam(name = &quot;token&quot;, value = &quot;token&quot;, required = true)</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="keyword">public</span> MSResponse <span class="title function_">refreshToken</span><span class="params">(<span class="meta">@RequestParam(value = &quot;token&quot;)</span> String token)</span> &#123;</span><br><span class="line">    <span class="type">MSResponse</span> <span class="variable">response</span> <span class="operator">=</span> userSigninService.refreshUserToken(token);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨äº† GET æ–¹å¼è¿›è¡Œç½‘ç»œè¯·æ±‚ã€‚åç»­å¯ä»¥æ”¹ä¸º POST è¯·æ±‚ã€‚</p><p>ç™»å½•é€»è¾‘éƒ½åœ¨ <code>MSUserSigninServiceImpl.java</code> ä¸­ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œå»çœ‹æºç ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</p><h3 id="API-è°ƒç”¨æ•ˆæœ"><a href="#API-è°ƒç”¨æ•ˆæœ" class="headerlink" title="API è°ƒç”¨æ•ˆæœ"></a>API è°ƒç”¨æ•ˆæœ</h3><p>å¯åŠ¨ MySQLï¼Œå¯åŠ¨ Redisï¼Œå†å¯åŠ¨é¡¹ç›®å³å¯ã€‚</p><p>ç”¨æˆ·ç™»å½•æˆåŠŸåï¼Œè°ƒç”¨ <code>/get/token</code> APIï¼Œå¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2021/01/03/1.png"></p><p>è°ƒç”¨ <code>/token</code> è¿›è¡Œç™»å½•çš„ APIï¼Œå¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2021/01/03/2.png"></p><p>è°ƒç”¨ <code>refresh/token</code> API å¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2021/01/03/3.png"></p><h2 id="å¾…åŠäº‹é¡¹"><a href="#å¾…åŠäº‹é¡¹" class="headerlink" title="å¾…åŠäº‹é¡¹"></a>å¾…åŠäº‹é¡¹</h2><ul><li><input checked="" disabled="" type="checkbox"> token é…ç½®ä¿¡æ¯æ”¾ç½®åˆ°é…ç½®æ–‡ä»¶ä¸­ï¼›2021.01.17 Done <a href="http://www.veryitman.com/2021/01/17/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Token-%E7%9B%B8%E5%85%B3%E7%9A%84%E9%87%8D%E6%9E%84/">å¾®æœåŠ¡-Token-ç›¸å…³çš„é‡æ„</a>;</li><li><input disabled="" type="checkbox"> Redis ä¸­è®¾ç½® token çš„è¿‡æœŸæ—¶é—´ï¼›</li><li><input disabled="" type="checkbox"> è°ƒç”¨åˆ·æ–° token çš„ API åæ›´æ–° Redis ä¸­ token çš„æœ‰æ•ˆæ—¶é—´ï¼›</li><li><input disabled="" type="checkbox"> åˆ·æ–° tokenã€ä½¿ç”¨ token ç™»å½•çš„ API ä¿®æ”¹ä¸º POST æ–¹å¼ï¼›</li><li><input disabled="" type="checkbox"> Token çš„åŠ å¯†ï¼Œå‡å°‘ Token ç™»å½•çš„æ•°æ®åº“æŸ¥è¯¢æ¬¡æ•°ï¼›</li></ul><hr><p><strong>åªæœ‰å¼±è€…æ‰å»äº‰å–å…¬å¹³ï¼Œè¿™å¥è¯è™½ç„¶æ®‹å¿ä½†å¾ˆç°å®~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis JWT Token </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£å†³bash profileä¸ç”Ÿæ•ˆçš„æ–¹æ³•</title>
      <link href="/2020/12/13/%E8%A7%A3%E5%86%B3bash-profile%E4%B8%8D%E7%94%9F%E6%95%88%E7%9A%84%E6%96%B9%E6%B3%95/"/>
      <url>/2020/12/13/%E8%A7%A3%E5%86%B3bash-profile%E4%B8%8D%E7%94%9F%E6%95%88%E7%9A%84%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>æˆ‘å–œæ¬¢æŠŠ <code>macOS</code> ä¸Šé¢çš„ä¸€äº›ç¯å¢ƒå˜é‡ï¼ˆä¸»è¦æ˜¯ä¸€äº›å¼€å‘å¥—ä»¶å¦‚ <code>Javaã€Androidã€Flutter</code> ç­‰ï¼‰æ”¾åˆ°  <code>~/.bash_profile</code> è¿™ä¸ªæ–‡ä»¶ä¸­ï¼ŒButâ€¦</p><p>è‡ªä»åœ¨ <code>macOS</code> ä¸Šé¢å®‰è£…äº† <a href="https://ohmyz.sh/">ohmyz.sh</a> ä¹‹åï¼Œæ¯æ¬¡é‡å¯ç”µè„‘æˆ–è€…æ–°å¼€ç»ˆç«¯çš„æ—¶å€™ï¼Œæˆ‘åœ¨  <code>~/.bash_profile</code> è¿™ä¸ªæ–‡ä»¶ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½æ— æ³•ä½¿ç”¨äº†ã€‚é™¤éå†æ¬¡æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bash_profile</span><br></pre></td></tr></table></figure><p>é€šè¿‡ç½‘å‹ä»¬çš„ç¾¤åŠ›ç¾¤ç­–ï¼Œè¿˜æ˜¯å¾ˆå¿«æ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆã€‚</p><p>åœ¨ <code>~/.zshrc</code> æ–‡ä»¶æœ€åå¢åŠ ä¸€è¡Œï¼š<code>source ~/.bash_profile</code> å³å¯å®Œç¾è§£å†³ã€‚</p><p>å¦‚æœä½ å‘ç°æœ¬æœº <code>~/</code> ç›®å½•ä¸‹é¢æ²¡æœ‰ <code>.zshrc</code> è¿™ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥æ–°å»ºä¸€ä¸ªï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/</span><br><span class="line"></span><br><span class="line">touch .zshrc</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ æ˜¯ç”¨çš„æ˜¯ macOS Catalina(10.15) ç‰ˆæœ¬çš„ç³»ç»Ÿï¼Œå…¶å®ç³»ç»Ÿå·²ç»ç”¨ <code>Zsh</code> å–ä»£äº† <code>Bash</code>ï¼Œæˆä¸ºæ“ä½œç³»ç»Ÿçš„é»˜è®¤ <code>Shell</code>ã€‚ç›¸æ¯” <code>Bash</code> æ¥è¯´ï¼Œ<code>Zsh</code> ä¹Ÿæ‹¥æœ‰è®¸å¤šæ›´å¼ºå¤§çš„åŠŸèƒ½ï¼š</p><ul><li><p>æ›´æ™ºèƒ½çš„è‡ªåŠ¨è¡¥å…¨ï¼›</p></li><li><p>å‘½ä»¤é€‰é¡¹æç¤ºï¼›</p></li><li><p>æ›´ä¸°å¯Œçš„ä¸»é¢˜ï¼Œç­‰ç­‰ã€‚</p></li></ul><p>å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æŸ¥è¯¢ä¸€ä¸‹å½“å‰ä½ çš„ç³»ç»Ÿé»˜è®¤ <code>Shell</code> æ˜¯å“ªä¸ªï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -p $$</span><br></pre></td></tr></table></figure><p>æˆ‘åœ¨ <code>macOS</code> ç»ˆç«¯ä¸Šæ‰§è¡Œï¼Œç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PID TTY        TIME CMD</span><br><span class="line">692 ttys000    0:00.91 -zsh</span><br></pre></td></tr></table></figure><p>ç½‘ä¸Šè¿˜æœ‰äº›æœ‹å‹è¯´åœ¨ <code>~/.profile</code> ä¸­å¢åŠ  <code>source ~/.bash_profile</code> ä¹Ÿå¯ä»¥è§£å†³é—®é¢˜ï¼Œä½†æˆ‘äº²æµ‹åå‘ç°å¯¹äºè‡ªå·±å½“å‰çš„ macOS å¹¶æ²¡æœ‰ç”Ÿæ•ˆã€‚</p><hr><p><strong>ç›®æ ‡ä¸€æ—¦ç¡®ç«‹ï¼Œé‡åˆ°ä»»ä½•å›°éš¾è¯·ä¸è¦è½»æ˜“æ”¾å¼ƒ~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> MacOS </category>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> macOS ohmyz bash </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯¼å…¥MySQLæ•°æ®åº“æ–‡ä»¶</title>
      <link href="/2020/12/13/%E5%AF%BC%E5%85%A5MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E6%96%87%E4%BB%B6/"/>
      <url>/2020/12/13/%E5%AF%BC%E5%85%A5MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p> <code>user.sql</code> æ˜¯æˆ‘åœ¨ <code>Windows 10</code> ç³»ç»Ÿä¸­å†™çš„æ•°æ®åº“æ–‡ä»¶ï¼Œä¸‹é¢çš„ä¸¾ä¾‹éƒ½æ˜¯åŸºäºè¿™ä¸ªç³»ç»Ÿå’Œæ–‡ä»¶è¿›è¡Œæ“ä½œçš„ã€‚</p><p>å…¶ä»–ç³»ç»Ÿå¦‚ <code>macOS</code>ï¼Œæ“ä½œå‘½ä»¤ä¹ŸåŸºæœ¬ä¸€æ ·ï¼Œåªæ˜¯æ–‡ä»¶è·¯å¾„ä¸ä¸€æ ·ç½¢äº†ã€‚</p><p>~æ¥ä¸‹æ¥ç»™å¤§å®¶ä»‹ç»ä¸¤ç§å¯¼å…¥æ•°æ®åº“æ–‡ä»¶çš„æ–¹æ³•ã€‚</p><h3 id="1ã€å…ˆè¿›åå¯¼å¼"><a href="#1ã€å…ˆè¿›åå¯¼å¼" class="headerlink" title="1ã€å…ˆè¿›åå¯¼å¼"></a>1ã€å…ˆè¿›åå¯¼å¼</h3><blockquote><p>è¿™ç§æ–¹å¼æ˜¯å…ˆè¿›å…¥ MySQLï¼Œç„¶åå†å¯¼å…¥æ•°æ®åº“æ–‡ä»¶</p></blockquote><p>è¿›å…¥ <code>MySQL</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u username -p password</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>username</code>ã€<code>password</code> åˆ†åˆ«æ˜¯ä½ è¿æ¥ <code>MySQL</code> çš„ç”¨æˆ·åå’Œå¯†ç ï¼›</p><p>è¿›å…¥ä¹‹åï¼Œå¼€å§‹å¯¼å…¥æ•°æ®åº“æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source sql-file-path</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>sql-file-path</code> æ˜¯ä½ æ•°æ®åº“æ–‡ä»¶çš„è·¯å¾„ï¼Œä¾‹å¦‚ </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source E:/work/db/user.sql</span><br></pre></td></tr></table></figure><h3 id="2ã€åŒè¿›åŒå¯¼å¼"><a href="#2ã€åŒè¿›åŒå¯¼å¼" class="headerlink" title="2ã€åŒè¿›åŒå¯¼å¼"></a>2ã€åŒè¿›åŒå¯¼å¼</h3><blockquote><p>è¿™ç§æ–¹å¼æ˜¯è¿›å…¥ <code>MySQL</code> çš„åŒæ—¶ä¹Ÿå¯¼å…¥æ•°æ®åº“æ–‡ä»¶</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u username -p password -D data &lt; sql-file-path</span><br></pre></td></tr></table></figure><p>åŒç†ï¼Œ<code>username</code>ã€<code>password</code> åˆ†åˆ«æ˜¯ä½ è¿æ¥ <code>MySQL</code> çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œåé¢çš„å‚æ•° <code>-D</code> ä¸€å®šè¦å¤§å†™ï¼Œ <code>sql-file-path</code> æ˜¯ä½ æ•°æ®åº“æ–‡ä»¶çš„è·¯å¾„ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u username -p password -D data &lt; E:/work/db/user.sql</span><br></pre></td></tr></table></figure><p>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å…ˆä¸è¾“å…¥ <code>password</code>ï¼Œç­‰å‘½ä»¤è¡Œæç¤ºè¾“å…¥å¯†ç çš„æ—¶å€™å†è¾“å…¥ä¹Ÿå¯ä»¥ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u username -p -D data &lt; E:/work/db/user.sql</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰å…¶ä»–å§¿åŠ¿ï¼Œå¤§å®¶è‡ªè¡Œæ¢ç´¢å§~</p><hr><p><strong>éœ€æ±‚åªæ˜¯å®¢æˆ·éœ€è¦çš„ä¸€å°éƒ¨åˆ†è€Œå·²ï¼Œè€Œä¸æ˜¯éœ€æ±‚ç­‰äºéœ€è¦~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
          <category> Tools </category>
          
          <category> DB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL Windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡: SpringBoot é›†æˆ Redis</title>
      <link href="/2020/12/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-SpringBoot-%E9%9B%86%E6%88%90-Redis/"/>
      <url>/2020/12/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-SpringBoot-%E9%9B%86%E6%88%90-Redis/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>å¿™ç¢Œäº†ä¸€å‘¨ï¼Œæ„Ÿè§‰åªæœ‰æ­¤åˆ»å†™æ–‡å­—çš„æ—¶é—´æ‰æ˜¯æœ€æƒ¬æ„çš„ã€‚æœ€è¿‘å·¥ä½œæ¯”è¾ƒå¿™ï¼Œæ–‡ç« æ›´æ–°çš„è¾ƒæ…¢è¿˜æœ›å¤§å®¶å¤šå¤šè§è°…ğŸ™‡â€ï¼</p><p>åœ¨é˜…è¯»ä¸‹é¢çš„å†…å®¹ä¹‹å‰ï¼Œå¸Œæœ›ä½ å·²ç»å®‰è£…å¹¶ä¸”åšå¥½äº†å­¦ä¹  Spring Boot é›†æˆ Redis çš„å‡†å¤‡äº†ã€‚</p><p>å¦‚æœä½ è¿˜æ²¡æœ‰æ­å»º Redis ç¯å¢ƒï¼Œ<a href="http://www.veryitman.com/2020/11/15/Win10-%E5%AE%89%E8%A3%85-Redis/">Win10-å®‰è£…-Redis</a> è¿™ç¯‡æ–‡ç« æˆ–è®¸å¯ä»¥å¸®åˆ°æ‚¨ã€‚</p><p>åœ¨ <code>Spring Boot 1.x</code> ç‰ˆæœ¬ä¸­é»˜è®¤çš„ Redis å®¢æˆ·ç«¯æ˜¯ Jedis å®ç°çš„ï¼Œ<code>Spring Boot 2.x</code> ç‰ˆæœ¬ä¸­é»˜è®¤å®¢æˆ·ç«¯æ˜¯ç”¨ Lettuce å®ç°çš„ã€‚å¯ä»¥ä»åŠ å…¥çš„ä¾èµ–åŒ…ä¸­çœ‹å‡ºï¼Œ<code>Spring Boot 2.2.x</code> ä¸­çš„ <code>spring-data-redis</code> ä»æ—§åŒ…æ‹¬äº† Jedis å’Œ Lettuceï¼Œä½†æ˜¯é»˜è®¤ä½¿ç”¨äº† Lettuceï¼ˆæ¢å¥è¯è¯´ï¼Œå¦‚æœä½ ä¸æƒ³ä½¿ç”¨é»˜è®¤çš„ Lettuce å®ç°å¯ä»¥æ¢æˆ  Jedis çš„å®ç°ï¼‰ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="/upload/images/2020/12/05/1.png"></p><p>Lettuce å’Œ Jedis çš„éƒ½æ˜¯è¿æ¥ Redis Server çš„å®¢æˆ·ç«¯ï¼Œç®€å•å¼‚åŒç‚¹å¦‚ä¸‹ï¼š</p><ul><li><strong>Jedis</strong> åœ¨å®ç°ä¸Šæ˜¯ç›´è¿ Redis Serverï¼Œå¤šçº¿ç¨‹ç¯å¢ƒä¸‹éçº¿ç¨‹å®‰å…¨ï¼Œé™¤éä½¿ç”¨è¿æ¥æ± ï¼Œä¸ºæ¯ä¸ª Redis å®ä¾‹å¢åŠ ç‰©ç†è¿æ¥ï¼›</li><li><strong>Lettuce</strong> æ˜¯ ä¸€ç§å¯ä¼¸ç¼©ï¼Œçº¿ç¨‹å®‰å…¨ï¼Œå®Œå…¨éé˜»å¡çš„ Redis å®¢æˆ·ç«¯ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥å…±äº«ä¸€ä¸ª <code>RedisConnection</code>ï¼Œå®ƒåˆ©ç”¨ <code>Netty NIO</code> æ¡†æ¶æ¥é«˜æ•ˆåœ°ç®¡ç†å¤šä¸ªè¿æ¥ï¼Œä»è€Œæä¾›äº†å¼‚æ­¥å’ŒåŒæ­¥æ•°æ®è®¿é—®æ–¹å¼ï¼Œç”¨äºæ„å»ºéé˜»å¡çš„ååº”æ€§åº”ç”¨ç¨‹åºï¼›</li></ul><p>æœ¬ç¯‡åªåˆ†äº«åœ¨ Spring Boot é¡¹ç›®ä¸­å¦‚ä½•é›†æˆ Jedis å®ç°çš„ Redis å®¢æˆ·ç«¯å’Œç®€å•ä½¿ç”¨ï¼Œå…³äº Redis çš„ä½¿ç”¨æœ‰å¾ˆå¤šåº”ç”¨åœºæ™¯ï¼Œåç»­å†åšæ¢è®¨å’Œåˆ†äº«ï¼ˆRedis ç¡®å®å¾ˆå¼ºå¤§ï¼Œå€¼å¾—æˆ‘ä»¬æ·±å…¥å­¦ä¹ å’Œç ”ç©¶ï¼‰ã€‚</p><h2 id="åŠ å…¥ä¾èµ–åŒ…"><a href="#åŠ å…¥ä¾èµ–åŒ…" class="headerlink" title="åŠ å…¥ä¾èµ–åŒ…"></a>åŠ å…¥ä¾èµ–åŒ…</h2><p>åœ¨ <code>pom.xml</code> æ–‡ä»¶ä¸­æ·»åŠ  redis çš„ä¾èµ–ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œé¡¹ç›®åï¼Œä¼šæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.beans.factory.BeanCreationException: </span><br><span class="line">Error creating bean with name &#x27;redisConnectionFactory&#x27; defined in class path resource </span><br><span class="line">[org/springframework/boot/autoconfigure/data/redis/LettuceConnectionConfiguration.class]: Bean instantiation via factory method failed; </span><br><span class="line">nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory]: </span><br><span class="line">Factory method &#x27;redisConnectionFactory&#x27; threw exception; </span><br><span class="line">nested exception is java.lang.NoClassDefFoundError: org/apache/commons/pool2/impl/GenericObjectPoolConfig</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ï¼Œéœ€è¦åœ¨ä½ çš„ pom æ–‡ä»¶ä¸­æ·»åŠ è¿æ¥æ±  <code>commons-pool2</code> çš„ä¾èµ–ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-pool2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Lettuce éœ€è¦ä¾èµ– Apacheçš„ <code>common-pool2</code>ï¼ˆè‡³å°‘æ˜¯2.2ç‰ˆæœ¬ï¼‰æä¾›è¿æ¥æ± ï¼Œæœ¬ç¯‡ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯ 2.6.0ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ <a href="https://github.com/lettuce-io/lettuce-core/wiki/Connection-Pooling">Connection-Pooling</a> çš„ä»‹ç»ã€‚</p><h2 id="é…ç½®-properties"><a href="#é…ç½®-properties" class="headerlink" title="é…ç½® properties"></a>é…ç½® properties</h2><p>é…ç½® <code>application.properties</code> æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ------------------------------------------</span></span><br><span class="line"><span class="comment"># é…ç½® redis for lettuce</span></span><br><span class="line"><span class="comment"># ------------------------------------------</span></span><br><span class="line"><span class="attr">spring.redis.host</span>=<span class="string">127.0.0.1</span></span><br><span class="line"><span class="attr">spring.redis.port</span>=<span class="string">6379</span></span><br><span class="line"><span class="attr">spring.redis.database</span>=<span class="string">0</span></span><br><span class="line"><span class="attr">spring.redis.password</span>=<span class="string"></span></span><br><span class="line"><span class="comment">#è¿æ¥æ± æœ€å¤§è¿æ¥æ•°ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰</span></span><br><span class="line"><span class="attr">spring.redis.lettuce.pool.max-active</span>=<span class="string">8</span></span><br><span class="line"><span class="comment"># è¿æ¥æ± ä¸­çš„æœ€å¤§ç©ºé—²è¿æ¥ é»˜è®¤ 8</span></span><br><span class="line"><span class="attr">spring.redis.lettuce.pool.max-idle</span>=<span class="string">8</span></span><br><span class="line"><span class="comment"># è¿æ¥æ± ä¸­çš„æœ€å°ç©ºé—²è¿æ¥ é»˜è®¤ 0</span></span><br><span class="line"><span class="attr">spring.redis.lettuce.pool.min-idle</span>=<span class="string">0</span></span><br><span class="line"><span class="comment"># è¿æ¥æ± æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰</span></span><br><span class="line"><span class="attr">spring.redis.lettuce.pool.max-wait</span>=<span class="string">-1</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šå› ä¸ºæˆ‘çš„å·¥ç¨‹ä¸­ä½¿ç”¨äº†å¤šä¸ª properties æ–‡ä»¶ç”¨äºåŒºåˆ†ä¸åŒçš„ç¯å¢ƒï¼Œæ‰€ä»¥ä½ æ ¹æ®è‡ªå·±çš„é…ç½®æ–‡ä»¶æ¥é…ç½® Redis å³å¯ã€‚</p><h2 id="çœŸçš„æ˜¯-Lettuce-å˜›ï¼Ÿ"><a href="#çœŸçš„æ˜¯-Lettuce-å˜›ï¼Ÿ" class="headerlink" title="çœŸçš„æ˜¯ Lettuce å˜›ï¼Ÿ"></a>çœŸçš„æ˜¯ Lettuce å˜›ï¼Ÿ</h2><p>ä¸ºäº†è¯æ˜æˆ‘ä»¬ç°åœ¨ä½¿ç”¨çš„æ˜¯ Lettuce å®ç°çš„ Redis å®¢æˆ·ç«¯ï¼Œæˆ‘å†™äº†ä¸€æ®µæµ‹è¯•ä»£ç ï¼Œæ”¾åˆ°ç™»å½•çš„ <code>MSSigninController</code> è¿›è¡Œäº†æµ‹è¯•ï¼ˆå…·ä½“ä»£ç å¯ä»¥å‚è€ƒ <a href="https://github.com/veryitman/MSTutorial/tree/veryitman-feature">GitHub</a>ï¼‰ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> RedisTemplate&lt;String, Object&gt; redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRedisTemplate</span><span class="params">(RedisTemplate redisTemplate)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.redisTemplate = redisTemplate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/redisconn&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">redis</span><span class="params">()</span> &#123;</span><br><span class="line">        log.info(redisTemplate.getValueSerializer().toString() + <span class="string">&quot;, &quot;</span> + redisTemplate.getHashValueSerializer().toString());</span><br><span class="line">        <span class="type">RedisConnectionFactory</span> <span class="variable">connectionFactory</span> <span class="operator">=</span> redisTemplate.getConnectionFactory();</span><br><span class="line">        log.info(connectionFactory.toString());</span><br><span class="line">        <span class="keyword">if</span> (connectionFactory <span class="keyword">instanceof</span> LettuceConnectionFactory) &#123;</span><br><span class="line">            <span class="type">LettuceConnectionFactory</span> <span class="variable">lettuceConnectionFactory</span> <span class="operator">=</span> (LettuceConnectionFactory) connectionFactory;</span><br><span class="line">            log.info(lettuceConnectionFactory.getHostName() + <span class="string">&quot;, &quot;</span> + lettuceConnectionFactory.getPort());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> connectionFactory.toString();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œé¡¹ç›®ï¼Œæ‰“å¼€ <a href="http://localhost:8080/signin/redisconn">http://localhost:8080/signin/redisconn</a> å³å¯çœ‹åˆ°æµè§ˆå™¨ä¸Šé¢æ˜¾ç¤ºç±»ä¼¼å¦‚ä¸‹çš„è¾“å‡ºä¿¡æ¯ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory@5e91612a</span><br></pre></td></tr></table></figure><p>åŒæ—¶ï¼Œæ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.data.redis.serializer.JdkSerializationRedisSerializer@7fd8e94e, </span><br><span class="line">org.springframework.data.redis.serializer.JdkSerializationRedisSerializer@7fd8e94e</span><br><span class="line">org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory@34212775</span><br><span class="line">127.0.0.1, 6379</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„ä¿¡æ¯å¯ä»¥çœ‹å‡ºï¼š</p><ul><li>Redis çš„å®¢æˆ·ç«¯å®ç°é»˜è®¤ä½¿ç”¨çš„æ˜¯ Lettuceï¼›</li><li>é»˜è®¤çš„åºåˆ—åŒ–ç±»æ˜¯ <code>JdkSerializationRedisSerializer</code>ï¼Œä¸‹é¢æˆ‘ä»¬å¯ä»¥é…ç½® RedisTemplate æ¥æ”¹å˜é»˜è®¤çš„åºåˆ—åŒ–ç±»ï¼›</li></ul><h2 id="é…ç½®-RedisTemplate"><a href="#é…ç½®-RedisTemplate" class="headerlink" title="é…ç½® RedisTemplate"></a>é…ç½® RedisTemplate</h2><p>å…³äº RedisTemplate çš„é…ç½®ï¼Œé…ç½®çš„å®ä¾‹ä»£ç éƒ½åœ¨ <code>MSRedisConfig</code> è¿™ä¸ªç±»ä¸­ï¼Œè¿™é‡Œä¸å†ç²˜è´´ä»£ç ï¼Œæœ‰éœ€è¦çš„å¯ä»¥ç›´æ¥ç‚¹å‡»  <a href="https://github.com/veryitman/MSTutorial/tree/veryitman-feature">GitHub</a> æŸ¥çœ‹ã€‚</p><p>é…ç½®å®Œæˆåé‡æ–°è¿è¡Œå·¥ç¨‹ï¼Œå†æ¬¡è®¿é—® <a href="http://localhost:8080/signin/redisconn%EF%BC%8C%E6%8E%A7%E5%88%B6%E5%8F%B0%E8%BE%93%E5%87%BA%E5%A6%82%E4%B8%8B%E5%86%85%E5%AE%B9%EF%BC%9A">http://localhost:8080/signin/redisconnï¼Œæ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹å†…å®¹ï¼š</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer@3151bece, </span><br><span class="line">org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer@7248212a</span><br><span class="line">org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory@6bcda66f</span><br><span class="line">127.0.0.1, 6379</span><br></pre></td></tr></table></figure><p>å¯è§ï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸæ”¹å˜äº†é»˜è®¤çš„åºåˆ—åŒ–ç±»ã€‚</p><h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><p>è¿™æ¬¡çš„ä¾‹å­ï¼Œä»æ˜¯åœ¨åŸæ¥çš„å·¥ç¨‹ <a href="http://www.veryitman.com/2020/04/11/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E7%BB%93%E5%90%88MySQL%E5%AE%9E%E7%8E%B0%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C/">å¾®æœåŠ¡-ç»“åˆMySQLå®ç°ç™»å½•æ³¨å†Œ</a> çš„åŸºç¡€ä¸Šé¢æ”¹é€ çš„ï¼Œåç»­åˆ†äº«çš„å†…å®¹åŸºæœ¬éƒ½æ˜¯åœ¨è¿™ä¸ªå·¥ç¨‹ä¸Šé¢æ‹“å±•ã€‚</p><p>ç”¨æˆ·ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç ç™»å½•ï¼Œé¦–å…ˆå» Redis é‡Œé¢æŸ¥æ‰¾ï¼ŒæŸ¥æ‰¾åˆ°äº†ç›´æ¥è¿”å›ä¸ç”¨å» MySQL æ•°æ®åº“ä¸­æŸ¥æ‰¾äº†ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å†å» MySQL æ•°æ®åº“ä¸­æŸ¥æ‰¾ï¼ŒæŸ¥æ‰¾æˆåŠŸåå­˜å‚¨åˆ° Redis ä¸­ï¼Œæœ¬æ¬¡åˆ†äº«åªæ˜¯ä¸ºäº†è¯´æ˜å¦‚ä½•é›†æˆ Redisä»¥åŠå…¶ç®€å•ä½¿ç”¨ï¼Œæµç¨‹æ¯”è¾ƒç®€å•æ²¡æœ‰è€ƒè™‘å…¶ä»–å› ç´ å’Œä¼˜åŒ–ï¼Œä»…ä¾›å­¦ä¹ ä½¿ç”¨ã€‚</p><p>ä¿®æ”¹çš„é€»è¾‘éƒ¨åˆ†ï¼Œä»£ç è´´åœ¨ä¸‹é¢ï¼Œå¯ä»¥ç»“åˆæ³¨é‡Šçœ‹ä¸€ä¸‹å¾ˆç®€å•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@CrossOrigin(origins = &#123;&quot;*&quot;, &quot;http://localhost:63344&quot;&#125;)</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/name&quot;, method = RequestMethod.GET)</span></span><br><span class="line"><span class="meta">@ApiOperation(value = &quot;ç”¨æˆ·åç™»å½•&quot;, httpMethod = &quot;GET&quot;, notes = &quot;ç”¨æˆ·åç™»å½•&quot;)</span></span><br><span class="line"><span class="meta">@ApiImplicitParams(&#123;</span></span><br><span class="line"><span class="meta">    @ApiImplicitParam(name = &quot;username&quot;, value = &quot;ç”¨æˆ·å&quot;, required = true),</span></span><br><span class="line"><span class="meta">    @ApiImplicitParam(name = &quot;userpwd&quot;, value = &quot;å¯†ç &quot;, required = true)</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="keyword">public</span> MSResponse <span class="title function_">sigin</span><span class="params">(<span class="meta">@RequestParam(value = &quot;username&quot;)</span> String userName, <span class="meta">@RequestParam(value = &quot;userpwd&quot;)</span> String userPwd)</span> &#123;</span><br><span class="line">    <span class="type">MSResponse</span> <span class="variable">response</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MSResponse</span>();</span><br><span class="line">    <span class="type">MSUser</span> <span class="variable">user</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> == userName || <span class="literal">null</span> == userPwd || userName.length() &lt;= <span class="number">0</span> || userPwd.length() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="type">MSUserResponseEnum</span> <span class="variable">responseEnum</span> <span class="operator">=</span> MSUserResponseEnum.Login4SiginInvalidInfo;</span><br><span class="line">        response.setCode(responseEnum.getCode());</span><br><span class="line">        response.setMsg(responseEnum.getMsg());</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">/** ä»Redisé‡Œé¢æŸ¥æ‰¾è¯¥ç”¨æˆ· */</span></span><br><span class="line">        <span class="type">MSUser</span> <span class="variable">redisUser</span> <span class="operator">=</span> (MSUser) redisTemplate.opsForValue().get(userName);</span><br><span class="line">        <span class="type">String</span> <span class="variable">query_user_pwd</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != redisUser &amp;&amp; userPwd.equals(redisUser.getAccountName())) &#123; <span class="comment">// Redis é‡Œé¢æœ‰è¯¥ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">            log.info(<span class="string">&quot;Redis ä¸­æ‰¾åˆ°äº† &quot;</span> + userName);</span><br><span class="line">            <span class="type">MSUserResponseEnum</span> <span class="variable">rspEnum</span> <span class="operator">=</span> MSUserResponseEnum.SUCCESS;</span><br><span class="line">            user = redisUser;</span><br><span class="line">            response.setCode(rspEnum.getCode());</span><br><span class="line">            response.setMsg(rspEnum.getMsg());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// Redis é‡Œé¢æ²¡æœ‰è¯¥ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">            log.info(<span class="string">&quot;Redis ä¸­æ²¡æœ‰æ‰¾åˆ° &quot;</span> + userName);</span><br><span class="line">            <span class="comment">/** æŸ¥æ•°æ®åº“çš„â€˜userâ€™è¡¨ä¸­æ˜¯å¦æœ‰è¯¥ç”¨æˆ·ï¼Ÿ*/</span></span><br><span class="line">            List&lt;Map&gt; query_users = userService.queryUserByUserName(userName);</span><br><span class="line">            <span class="keyword">if</span> (query_users.isEmpty()) &#123;<span class="comment">// æ²¡æœ‰è¯¥ç”¨æˆ·</span></span><br><span class="line">                <span class="type">MSUserResponseEnum</span> <span class="variable">responseEnum</span> <span class="operator">=</span> MSUserResponseEnum.LoginNoSuchUser;</span><br><span class="line">                response.setCode(responseEnum.getCode());</span><br><span class="line">                response.setMsg(responseEnum.getMsg());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;<span class="comment">// æœ‰è¿™ä¸ªç”¨æˆ·</span></span><br><span class="line">                <span class="type">Map</span> <span class="variable">user_map</span> <span class="operator">=</span> query_users.get(<span class="number">0</span>);</span><br><span class="line">                query_user_pwd = (String) user_map.get(<span class="string">&quot;accountPwd&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (!query_user_pwd.equals(userPwd)) &#123;</span><br><span class="line">                    <span class="type">MSUserResponseEnum</span> <span class="variable">responseEnum</span> <span class="operator">=</span> MSUserResponseEnum.LoginUserPwdError;</span><br><span class="line">                    response.setCode(responseEnum.getCode());</span><br><span class="line">                    response.setMsg(responseEnum.getMsg());</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// å°†æŸ¥è¯¢å‡ºæ¥çš„mapå¯¹è±¡ä½¿ç”¨FastJsonè½¬æ¢ä¸ºMSUserå¯¹è±¡</span></span><br><span class="line">                    user = JSON.parseObject(JSON.toJSONString(user_map), MSUser.class);</span><br><span class="line">                    <span class="comment">// ç¼“å­˜åˆ° Redisï¼Œä½¿ç”¨userNameä½œä¸ºkey</span></span><br><span class="line">                    <span class="type">String</span> <span class="variable">userNameKey</span> <span class="operator">=</span> String.valueOf(user.getAccountName());</span><br><span class="line">                    redisTemplate.opsForValue().set(userNameKey, user);</span><br><span class="line">                    log.info(<span class="string">&quot;MySQL ä¸­æ‰¾åˆ°äº† &quot;</span> + userName + <span class="string">&quot;, å¹¶å­˜åˆ° Redis ä¸­&quot;</span>);</span><br><span class="line"></span><br><span class="line">                    <span class="type">MSUserResponseEnum</span> <span class="variable">rspEnum</span> <span class="operator">=</span> MSUserResponseEnum.SUCCESS;</span><br><span class="line">                    response.setCode(rspEnum.getCode());</span><br><span class="line">                    response.setMsg(rspEnum.getMsg());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    response.setResults(user);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿ç»­ä¸¤æ¬¡ç™»å½•è¯·æ±‚ <code>http://localhost:8080/signin/name?username=foobar&amp;userpwd=foobar</code> ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Redis ä¸­æ²¡æœ‰æ‰¾åˆ° foobar</span><br><span class="line">MySQL ä¸­æ‰¾åˆ°äº† foobar, å¹¶å­˜åˆ° Redis ä¸­</span><br><span class="line"></span><br><span class="line">... çœç•¥å…¶ä»–æ—¥å¿—</span><br><span class="line"></span><br><span class="line">Redis ä¸­æ‰¾åˆ°äº† foobar</span><br></pre></td></tr></table></figure><p>æ‰“å¼€ Redis çš„ CLIï¼Œå¯ä»¥æŸ¥è¯¢ä¸€ä¸‹æ˜¯å¦å­˜å‚¨æˆåŠŸï¼Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; get foobar</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&#123;\&quot;@class\&quot;:\&quot;com.veryitman.user.model.MSUser\&quot;,\&quot;userID\&quot;:1723068547,\&quot;accountName\&quot;:\&quot;foobar\&quot;,\&quot;accountPwd\&quot;:\&quot;foobar\&quot;,\&quot;nickName\&quot;:\&quot;foobar\&quot;,\&quot;age\&quot;:20,\&quot;gender\&quot;:1,\&quot;motto\&quot;:\&quot;\&quot;,\&quot;phone\&quot;:\&quot;\&quot;&#125;&quot;</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://lettuce.io/core/release/reference/">Lettuce</a></li><li><a href="https://github.com/lettuce-io/lettuce-core">Lettuce-Core</a></li><li><a href="https://github.com/lettuce-io/lettuce-core/wiki/Connection-Pooling">Lettuce-Connection-Pooling</a> </li><li><a href="http://tool.oschina.net/uploads/apidocs/redis/clients/jedis/Jedis.html">Jedis</a></li></ul><hr><p><strong>é€‚å½“çš„èµç¾å¯ä»¥è®©å¯¹æ–¹åšå‡ºå¥½çš„æ”¹å˜~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis SpringBoot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Win10 å®‰è£… Redis</title>
      <link href="/2020/11/15/Win10-%E5%AE%89%E8%A3%85-Redis/"/>
      <url>/2020/11/15/Win10-%E5%AE%89%E8%A3%85-Redis/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>å…³äºå¾®æœåŠ¡ç›¸å…³çš„åˆ†äº«ï¼Œæˆ‘éƒ½æ˜¯åœ¨ <code>Windows 10</code> ç³»ç»Ÿä¸‹å®è·µçš„ï¼Œæ‰€ä»¥è·Ÿ <code>Spring Boot</code> é…å¥—çš„è½¯ä»¶ä¹Ÿæ˜¯åœ¨æ­¤ç³»ç»Ÿä¸Šé¢å®‰è£…çš„ã€‚</p><p>ä»Šå¤©è·Ÿå¤§å®¶ä»‹ç»ä¸€ä¸‹å¦‚ä½•åœ¨ <code>Win10</code> ä¸‹å®‰è£… <code>Redis</code>ï¼Œè¯¥ç¯‡æ˜¯ <code>Spring Boot</code> ä½¿ç”¨ <code>Redis</code> çš„å¤„å¥³ç¯‡ï¼Œä¸‹ç¯‡ç»“åˆä¹‹å‰ç™»å½•åœºæ™¯ä¸¾ä¾‹å¦‚ä½•åœ¨ <code>Spring Boot</code> ä¸­ä½¿ç”¨ <code>Redis</code>ã€‚</p><p>å¾€æœŸ <code>Win10</code> ä¸‹é¢å®‰è£… <code>MySQL</code> çš„æ–‡ç« ï¼š<a href="http://www.veryitman.com/2019/11/10/MySQL8-0-15%E5%9C%A8Win10%E4%B8%8A%E7%9A%84%E6%8A%98%E8%85%BE%E8%AE%B0/">MySQL8-0-15åœ¨Win10ä¸Šçš„æŠ˜è…¾è®°</a> æ¨èç»™æœ‰éœ€è¦çš„ä¼™ä¼´ã€‚</p><h2 id="å®‰è£…-Redis"><a href="#å®‰è£…-Redis" class="headerlink" title="å®‰è£… Redis"></a>å®‰è£… Redis</h2><p><strong>Step1ï¼šä¸‹è½½</strong></p><p>ä¸‹è½½ <code>Windows</code> ç‰ˆæœ¬çš„ <code>Redis</code>ï¼Œç‚¹å‡»è¿™é‡Œ <a href="https://github.com/MicrosoftArchive/redis/releases">ä¸‹è½½ Redis</a>ã€‚</p><p>æˆ‘ä¸‹è½½çš„æ˜¯ <code>3.0.504</code> ç‰ˆæœ¬ã€‚</p><p><img src="/upload/images/2020/11/15/1.png"></p><p><strong>Step2ï¼šè§£å‹</strong></p><p>è§£å‹ä¸‹è½½çš„ <code>zip</code> åŒ…åˆ°ä»»æ„ç›®å½•ï¼Œå¦‚æˆ‘çš„ç›®å½•ï¼š</p><p><img src="/upload/images/2020/11/15/2.png"></p><p><strong>Step3ï¼šå¯åŠ¨</strong></p><p>å‘½ä»¤è¡Œè¿›å…¥åˆšæ‰è§£å‹æ–‡ä»¶çš„æ ¹ç›®å½•ä¸‹ï¼Œç„¶åæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./redis-server.exe redis.windows.conf</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°å¦‚ä¸‹ç•Œé¢è¡¨ç¤ºæˆåŠŸã€‚</p><p><img src="/upload/images/2020/11/15/3.png"></p><p>è¿™ç§æ–¹å¼ä¸€æ—¦å…³é—­å‘½ä»¤è¡Œï¼Œ<code>Redis</code> æœåŠ¡å°±å…³é—­äº†ï¼Œæ‰€ä»¥éœ€è¦å°† <code>Redis</code> å®‰è£…æˆç³»ç»Ÿï¼ˆWindowsï¼‰æœåŠ¡ã€‚</p><p><strong>Step4ï¼šæ—¥å¿—æ–‡ä»¶</strong></p><p>åœ¨ <code>Redis</code> è§£å‹åçš„æ ¹ç›®å½•ï¼Œæ–°å»º <code>Logs</code> ç›®å½•ï¼Œç„¶ååœ¨è¯¥ç›®å½•ä¸‹æ–°å»º <code>redis_log.txt</code> æ–‡ä»¶ã€‚</p><p>å¦åˆ™ï¼Œåœ¨è¿›è¡Œä¸‹é¢æ“ä½œçš„æ—¶å€™ä¼šæŠ¥ <code> Redis service failed to start.</code> é”™è¯¯ã€‚</p><p>å¦‚æœä½ æŒ‰ç…§è¯¥è¦æ±‚æ–°å»ºäº†è¿˜æ˜¯æŠ¥é”™ï¼Œéœ€è¦ç»è¿‡ä¸‹é¢çš„æ“ä½œè§£å†³ã€‚</p><p>åœ¨å‘½ä»¤è¡Œä¸­ï¼ˆå¦‚æœä½¿ç”¨çš„æ˜¯ <code>git bash</code> ç»ˆç«¯ï¼Œéœ€è¦åœ¨ä¸‹é¢çš„å‘½ä»¤å‰åŠ ä¸Š <code>winpty</code>ï¼‰ä¸‹å¼€å¯ <code>CLI</code> æ¨¡å¼ï¼Œè¿è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./redis-cli.exe</span><br></pre></td></tr></table></figure><p>ç„¶åå†è¿è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shutdown</span><br><span class="line"></span><br><span class="line">exit</span><br></pre></td></tr></table></figure><p>é‡æ–°å¯åŠ¨æœåŠ¡å³å¯ã€‚</p><p><strong>Step5ï¼šè®¾ç½® Redis æˆ Windows æœåŠ¡</strong></p><p>å¦å¤–æ‰“å¼€ä¸€ä¸ªå‘½ä»¤è¡Œçª—å£ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./redis-server.exe --service-install redis.windows-service.conf --loglevel verbose --service-name Redis</span><br></pre></td></tr></table></figure><p>æ‰§è¡ŒæˆåŠŸåï¼Œä½ å¯ä»¥åœ¨ <code>Windows</code> çš„ç³»ç»ŸæœåŠ¡ï¼ˆ<code>CMD+R/services.msc</code>ï¼‰ä¸­æ‰¾åˆ°è¯¥æœåŠ¡ï¼ˆæœåŠ¡åç§°ä¸º <code>Redis</code>ï¼‰ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="/upload/images/2020/11/15/4.png"></p><p>å¦å¤–ä»ä¸‹å›¾å¯ä»¥çœ‹åˆ°å…¶å±æ€§ï¼Œå¯¹åº”çš„é…ç½®æ–‡ä»¶æ˜¯ <code>redis.windows-service.conf</code>ï¼Œå¯¹åº”ä¸Šé¢æ³¨å†ŒæœåŠ¡æ—¶ä½¿ç”¨çš„é…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥åç»­çš„è‡ªå®šä¹‰é…ç½®å°±éœ€è¦ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ï¼Œä¸è¦æé”™äº†ã€‚</p><p>å¦‚æœä½ ä½¿ç”¨ <code>redis.windows.conf</code> é‚£ä¹ˆè¿™é‡Œå°±åº”è¯¥æ˜¯è¿™ä¸ªæ–‡ä»¶ã€‚</p><p><img src="/upload/images/2020/11/15/5.png"></p><p><strong>Step6ï¼šå¯åŠ¨æœåŠ¡</strong></p><p>æ‰§è¡Œå¦‚ä¸‹å¯åŠ¨å‘½ä»¤å³å¯ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./redis-server.exe --service-start</span><br></pre></td></tr></table></figure><p>åœ¨æœåŠ¡åˆ—è¡¨ä¸­åˆ·æ–°ä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ° <code>Redis</code> æ­£åœ¨è¿è¡Œã€‚</p><p><img src="/upload/images/2020/11/15/6.png"></p><p>æ³¨å†ŒæœåŠ¡æˆåŠŸåï¼Œå°±ä¸éœ€è¦åƒ <strong>Step3</strong> é‚£æ ·å¼€å¯æœåŠ¡äº†ï¼Œåœ¨ <strong>Step3</strong> ä¸­å¼€å¯çš„æœåŠ¡çª—å£ä¹Ÿå¯ä»¥å…³é—­äº†ã€‚åç»­ä½¿ç”¨ <strong>Step6</strong> æ–¹å¼å¯åŠ¨å³å¯ï¼Œæˆ–è€…å°†è¯¥æœåŠ¡è®¾ç½®ä¸ºå¼€æœºè‡ªå¯åŠ¨ä¹Ÿå¯ä»¥ã€‚</p><p>å¦‚æœåœ¨å¯åŠ¨ redis æœåŠ¡çš„æ—¶å€™æŠ¥å¦‚ä¸‹çš„é”™è¯¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[18236] 29 Nov 10:52:01.070 # HandleServiceCommands: system error caught. error code=1056, message = StartService failed: unknown error</span><br></pre></td></tr></table></figure><p>è¯´æ˜ä½ çš„ redis æœåŠ¡å·²ç»å¯åŠ¨äº†ï¼Œå¯ä»¥æŸ¥çœ‹ Windows çš„æœåŠ¡ï¼ˆ<code>CMD+R/services.msc</code>ï¼‰ä¸­æ˜¯å¦å·²ç»å¯åŠ¨æˆåŠŸã€‚</p><h2 id="ä½¿ç”¨-Redis"><a href="#ä½¿ç”¨-Redis" class="headerlink" title="ä½¿ç”¨ Redis"></a>ä½¿ç”¨ Redis</h2><h3 id="Redis-ç›¸å…³å‘½ä»¤"><a href="#Redis-ç›¸å…³å‘½ä»¤" class="headerlink" title="Redis ç›¸å…³å‘½ä»¤"></a>Redis ç›¸å…³å‘½ä»¤</h3><blockquote><p>å†æ¬¡å¼ºè°ƒä¸€ä¸‹ï¼Œå¦‚æœä½¿ç”¨äº† <code>git bash</code> ç»ˆç«¯æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æ²¡æœ‰ååº”æˆ–è€…å¡ä½å¾ˆä¹…çš„è¯ï¼Œéœ€è¦åœ¨ä¸‹é¢å‘½ä»¤å‰åŠ ä¸Š <code>winpty</code> å³å¯ã€‚</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// å®‰è£…æœåŠ¡</span><br><span class="line">./redis-server.exe --service-install</span><br><span class="line"></span><br><span class="line">// å¸è½½æœåŠ¡</span><br><span class="line">./redis-server.exe --service-uninstall</span><br><span class="line"></span><br><span class="line">// å¼€å¯æœåŠ¡</span><br><span class="line">./redis-server.exe --service-start</span><br><span class="line"></span><br><span class="line">// åœæ­¢æœåŠ¡</span><br><span class="line">./redis-server.exe --service-stop</span><br><span class="line"></span><br><span class="line">// å¼€å¯ CLI æ¨¡å¼</span><br><span class="line">./redis-cli.exe -h 127.0.0.1 -p 6379</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯•-Redis"><a href="#æµ‹è¯•-Redis" class="headerlink" title="æµ‹è¯• Redis"></a>æµ‹è¯• Redis</h3><p>åœ¨å‘½ä»¤è¡Œå¼€å¯ CLI ï¼ˆå‘½ä»¤è¡Œç•Œé¢ <code>command-line interface</code>ï¼‰æ¨¡å¼ï¼Œä»»æ„è®¾ç½®ä¸€ä¸ªå˜é‡ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2020/11/15/7.png"></p><hr><p><strong>åªæœ‰å¼±è€…æ‰å»äº‰å–å…¬å¹³ï¼Œè¿™å¥è¯è™½ç„¶æ®‹å¿ä½†å¾ˆç°å®~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
          <category> DB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis Windows10 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç”Ÿè€Œä¸ºäººï¼Œæˆ‘å¾ˆæ¬¢å–œ</title>
      <link href="/2020/09/26/%E7%94%9F%E8%80%8C%E4%B8%BA%E4%BA%BA%EF%BC%8C%E6%88%91%E5%BE%88%E6%AC%A2%E5%96%9C/"/>
      <url>/2020/09/26/%E7%94%9F%E8%80%8C%E4%B8%BA%E4%BA%BA%EF%BC%8C%E6%88%91%E5%BE%88%E6%AC%A2%E5%96%9C/</url>
      
        <content type="html"><![CDATA[<p>è®°å¾—ç¬¬ä¸€æ¬¡è¯»æŒªå¨çš„æ£®æ—ï¼Œè¿˜æ˜¯ä¸Šé«˜ä¸€çš„æ—¶å€™ã€‚</p><p>è¿™æœ¬ä¹¦æ˜¯ä¸€ä¸ªåŒç­åŒå­¦å€Ÿç»™æˆ‘çœ‹çš„ï¼Œè¿™ä½åŒå­¦æ˜¯è¢«å¤§å®¶å…¬è®¤çš„åšè§ˆç¾¤ä¹¦çš„ç¿©ç¿©æ‰å­ã€‚ç°åœ¨çœ‹æ¥ï¼Œä»–å’Œã€ŠæŒªå¨çš„æ£®æ—ã€‹è¿™æœ¬ä¹¦ä¸­çš„æ°¸æ³½è¿˜çœŸæ˜¯æœ‰å¾—ä¸€æ‹¼ã€‚ä»–å‘Šè¯‰æˆ‘è¯´ä¹¦é‡Œé¢å†™çš„å¾ˆåˆºæ¿€ï¼Œå€¼å¾—ä¸€çœ‹ã€‚æˆ‘å½“æ—¶ä»¥ä¸ºè¿™æ˜¯ä¸€æœ¬æ¤ç‰©å­¦å®¶å†™çš„å…³äºäººä¸è‡ªç„¶ã€æ¢ç´¢ä¸–ç•Œçš„ä¹¦ç±ï¼Œä½†ä»ä»–çŒ¥ççš„ç¬‘å®¹é‡Œæˆ‘é€æ¸æ„Ÿè§‰åˆ°æˆ‘å¯èƒ½çŒœé”™äº†ã€‚</p><p>å½“æ—¶ç²—ç•¥çš„è¯»å®Œäº†è¿™æœ¬ä¹¦ï¼Œå†…å¿ƒæ»¡æ˜¯è‰æ³¥é©¬ï¼Œè§‰å¾—æ¸¡è¾¹å°±ä¸€æ··è›‹ã€æ¸£ç”·ã€‚åœ¨é‚£ä¸ªæ—¶å€™ï¼Œæ¸£ç”·è¿™ä¸ªè¯å¹¶ä¸å¥‰è¡Œä½†ä¸–ç•Œä¸Šæ—©å·²ç»æœ‰äº†è¿™æ ·çš„ä¸€ç¾¤äººğŸ¤¢ã€‚</p><p>å‰æ®µæ—¶é—´åœ¨å¶ç„¶çš„æœºä¼šä¸‹ï¼Œæˆ‘åœ¨ä¹¦åº—åˆçœ‹åˆ°äº†è¿™æœ¬ä¹¦ï¼Œéš¾æ©å¿ƒä¸­çš„è¿·æƒ‘åˆä»å®¹çš„è¯»äº†ä¸€éï¼Œå‘ç°æ ¹æœ¬ä¸æ˜¯è‡ªå·±åŸæ¥çœ‹åˆ°å’Œæƒ³åˆ°çš„é‚£æ ·ã€‚ç»“åˆå½“æ—¶çš„æ—¥æœ¬ç¤¾ä¼šèƒŒæ™¯å’Œæ–‡åŒ–ï¼Œè¿™æœ¬ä¹¦æ›´å¤šçš„æ˜¯åœ¨å†™äººç²¾ç¥å±‚é¢çš„ä¸œè¥¿ï¼Œç”Ÿæ´»ç»™æˆ‘ä»¬çš„æ˜¯ä¹åä¹ä»¶ä¸å¦‚æ„å’Œä¸€ä»¶æ— å¥ˆï¼Œæ‰€æœ‰çš„ä¸å¼€å¿ƒ ã€æŠ‘éƒã€å›°æƒ‘éƒ½åœ¨äºæœ¬å¿ƒï¼Œåªè¦å¿ƒæ€å¥½ï¼Œé›¨åä¾¿æ˜¯æ™´å¤©ã€‚äººéœ€è¦å­¦ä¼šè‡ªæˆ‘æ•‘èµã€‚</p><p>æ—¥æœ¬å¾ˆå¤šä½œå®¶çš„ä¹¦ç±ï¼Œè¯»æ¥éƒ½æ¯”è¾ƒå‹æŠ‘ï¼Œåƒå¤ªå®°æ²»çš„ã€Šäººé—´å¤±æ ¼ã€‹ï¼Œè¿™æœ¬ä¹¦æˆ‘å¾ˆæ—©ä¹‹å‰å°±ä¹°äº†ä½†è¿Ÿè¿Ÿæ²¡æœ‰æƒ³å¥½ä»€ä¹ˆæ—¶å€™å»çœ‹ï¼Œç›´åˆ°æˆ‘è¯»å®Œä¸œé‡åœ­å¾çš„å¤§éƒ¨åˆ†å°è¯´åæ‰é¼“èµ·å‹‡æ°”è¯»å®Œäº†ã€Šäººé—´å¤±æ ¼ã€‹ï¼Œè¯»å®Œæˆ‘æ‰çŸ¥é“ï¼Œåƒæˆ‘è¿™ç§å¿ƒæ€åƒèŠ±ä¸€æ ·çš„äººæ ¹æœ¬ä¸ç•æƒ§ä»€ä¹ˆã€‚åœ¨å‡ºç¤¾ä¼šä¹‹å‰ï¼Œæˆ‘è‡ªå·±ä¹Ÿæ˜¯ä¸ªç»å¸¸æ„çœ‰è‹¦è„¸çš„å®¶ä¼™ï¼Œå¾ˆå¤šæœ‹å‹éƒ½å‘Šè¯‰æˆ‘åŒ…æ‹¬æˆ‘çš„å¤§å­¦è€å¸ˆï¼ˆè‰¯å¸ˆç›Šå‹ï¼‰ï¼Œè¯´æˆ‘çœ‰å¤´å°±å¥½åƒæ˜¯è¢«ä¸€æŠŠæ— å­”çš„é”æ­»æ­»çš„é”ä½ä¸€æ ·ï¼Œç¬‘å®¹åœ¨æˆ‘çš„è„¸ä¸Šæ˜¾å¾—å¾ˆåå•¬ã€‚åœ¨é‚£ä¸ªæ—¶å€™ï¼Œæˆ‘å¯¹å¤§å­¦æ¯•ä¸šå…¶å®æ˜¯å¾ˆææƒ§çš„ï¼Œå®¶åº­æ²¡æœ‰ä»»ä½•èƒŒæ™¯ï¼Œè‡ªå·±å¯¹æœªæ¥ä¹Ÿå¾ˆè¿·èŒ«ï¼Œå¤§è„‘é‡Œä¹±ç³Ÿç³Ÿçš„ã€‚ä¸è¿‡æˆ‘å†…å¿ƒå¾ˆçŸ¥é“è¿™ä¸€åˆ‡éœ€è¦é è‡ªå·±å»æ”¹å˜ï¼Œåªæœ‰åŠªåŠ›å¥‹æ–—æ‰èƒ½æ‘†è„±å†…å¿ƒçš„æŸç¼šã€‚æ…¢æ…¢çš„ï¼Œæˆ‘è‡ªå·±æŠŠå¾ˆå¤šäº‹æƒ…æƒ³æ˜ç™½äº†ï¼Œåšäº‹æƒ…ä¹Ÿå¾ˆæœ‰ä¸»è§äº†ï¼Œå¿ƒæ€è°ƒæ•´çš„ç›¸å½“å¥½ã€‚</p><p>å½“ç”Ÿæ´»ä»¥ç—›å»æˆ‘ï¼Œæˆ‘è¦æŠ¥ä¹‹ä»¥æ­Œï¼</p><p>å‰æ®µæ—¶é—´ï¼Œå¬åˆ°ä¸€ä½è€å¸ˆè®²è§£ä¹¦ç±ï¼Œé‡Œé¢æåˆ°ã€ç”Ÿè€Œä¸ºäººï¼Œæˆ‘å¾ˆæŠ±æ­‰ã€‘è¿™å¥è¯ï¼Œä»–è¯´è¿™æ˜¯å¤ªå®°æ²»å†™çš„ã€‚æ–‡ç« ä¸‹é¢çš„è¯„è®ºå¾ˆå¤šäººéƒ½åœ¨å–·ä»–ï¼Œè¯´ä»–æ²¡æœ‰æ–‡åŒ–ï¼Œè¿™å¥è¯æ ¹æœ¬ä¸æ˜¯å¤ªå®°æ²»å†™çš„ã€‚äººå°±æ˜¯è¿™æ ·ï¼ŒæŒ‘æ¯›ç—…æœ€æ‹¿æ‰‹ã€‚æˆ‘é»˜é»˜çš„å»æŸ¥äº†ä¸€ä¸‹ï¼Œè¿™å¥è¯æœ€æ—©æ˜¯å‡ºè‡ªè¯—äºº <code>å¯ºå†…å¯¿å¤ªéƒ</code> ä¹‹æ‰‹ä½†ç¡®å®æ˜¯å› ä¸ºå¤ªå®°æ²»è®©è¿™å¥è¯å‘æ‰¬å…‰å¤§çš„ã€‚</p><p>è¯—äººå¯ºå†…å¯¿å¤ªéƒåŸåˆ›äºã€Šé—ä¹¦ã€‹çš„ä¸€ç»„è¯—æ­Œï¼Œå¤§è‡´æ„æ€æ˜¯ï¼šç”Ÿè€Œä¸ºäººï¼Œæ·±æ„Ÿæ­‰æ„ï¼›</p><p>ç„¶åï¼Œåœ¨æ—¥æœ¬ä½œå®¶å¤ªå®°æ²»æ‰€å†™çš„çŸ­å°è¯´ã€ŠäºŒåä¸–çºªæ——æ‰‹ã€‹ä¸­ï¼Œä½œè€…æŠŠè¿™å¥è¯ä½œä¸ºäº†ä¸€ä¸ªå‰¯æ ‡é¢˜ï¼Œ1937å¹´é¦–æ¬¡åœ¨ã€Šæ”¹é€ ã€‹æ‚å¿—ä¸Šå‘è¡¨ï¼Œæ”¶å½•åœ¨ã€Šäººé—´å¤±æ ¼ã€‹ä½œè€…é›†ä¸­ã€‚</p><p><img src="/upload/images/2020/09/26/1.png"></p><p>å¯ºå†…å¯¿å¤ªéƒå’Œå¤ªå®°æ²»æ˜¯è®¤è¯†çš„ã€‚</p><p>æ®è¯´æ˜¯ä¸€ä¸ªåä¸è§ç»ä¼ çš„æ–‡å­¦é’å¹´å¯ºå†…å¯¿å¤ªéƒï¼Œä»–çš„è¡¨å…„å¼Ÿæ˜¯å¤ªå®°çš„æœ‹å‹ã€‚è¿™ä¸ªé’å¹´ç›¸å½“å‘½é€”å¤šèˆ›ï¼Œå¹´è½»æ—¶å¤±å»äº†åŒäº²ï¼Œé äº²æˆšæŠšå…»ï¼Œä¸Šäº†åº†åº”å¤§å­¦ã€‚æ›¾ç»å¤šæ¬¡æ„Ÿåˆ°äººç”Ÿçš„æ— å¥ˆï¼Œç¦»å®¶å‡ºèµ°ã€‚ä¸€é¢—è¿½æ±‚æ–‡å­¦çš„è¯—å¿ƒï¼Œè®©ä»–å†™ä¸‹äº†é¢˜ä¸ºã€Šé—ä¹¦ã€‹çš„ä¸€ç»„è¯—æ­Œã€‚å…¶ä¸­æœ‰ä¸€é¦–å°±æ˜¯â€œä¸€å¥è¯—â€ï¼šç”Ÿè€Œä¸ºäººæ·±æ„Ÿæ­‰æ„ã€‚ç„¶åè¿™ä¸ªå€’éœ‰è›‹å„¿å¼æ–‡å­¦é’å¹´çš„å¤§å˜´è¡¨å“¥å°±åœ¨ä¸€æ¬¡è·Ÿå¤ªå®°æºœè¾¾èŠå¤©çš„æ—¶å€™è°ˆåˆ°äº†è¿™ä¸ªè¡¨å¼Ÿçš„è¯—å¥ã€‚å½“æ—¶å¤ªå®°ä»–ä»¬è®¤ä¸ºæœ‰äº†å¥½ç‚¹å­ï¼Œè°å…ˆç”¨ï¼Œç®—è°çš„ã€‚äºæ˜¯å¤ªå®°å°±å‡ºå…¶ä¸æ„åœ°åœ¨ã€ŠäºŒåä¸–çºªæ——æ‰‹ã€‹çš„å¼€å¤´ï¼Œç”¨äº†è¿™ä¹ˆä¸€å¥è¯ã€‚è¿™ä¸ªå¯æ€œçš„æ–‡å­¦é’å¹´ï¼Œæ€€ç€ä¸€é¢—èµ¤è¯šçš„æ–‡å­¦ä¹‹å¿ƒé˜…è¯»ä»–å´‡æ‹œçš„ä½œå®¶å¤ªå®°å¤§ä½œçš„æ—¶å€™ï¼Œç¬¬ä¸€å¥è¯å°±è¢«å™æˆé‡ä¼¤ï¼Œæ®è¯´è„¸æ°”å¾—å‘é’å»æ‰¾ä»–è¡¨å“¥ç®—è´¦ï¼Œä»–è¡¨å“¥æ‰¾åˆ°å¤ªå®°ç®—è´¦ï¼Œå¤ªå®°è£…å‚»ï¼Œå“å‘€ï¼Œæˆ‘ä»¥ä¸ºæ˜¯ä½ çš„ä¸»æ„å‘¢ï¼ŒçœŸæ˜¯æ·±æ„Ÿæ­‰æ„å•Šã€‚äºæ˜¯è¿™ä¸ªå¯æ€œçš„é’å¹´å¤§å“­ç€ï¼Œä¸€åˆ‡éƒ½å®Œå•¦ï¼Œæ‚£ä¸Šä¸¥é‡çš„å¿§éƒç—‡ã€‚å¤šæ¬¡ç¦»å®¶å‡ºèµ°ï¼Œæœ€åä¸€æ¬¡è¢«äººç›®å‡»æ˜¯æˆ˜ååœ¨ä¸€ä¸ªè½¦ç«™ã€‚ä¹‹åå°±ä¸çŸ¥æ‰€ç»ˆäº†ã€‚</p><p>ç„¶é¹…åœ¨2006å¹´çš„ç”µå½±ã€Šè¢«å«Œå¼ƒçš„æ¾å­çš„ä¸€ç”Ÿã€‹ä¸­ï¼Œè¿™å¥è¯ä¹Ÿè¢«è¯´äº†ä¸€æ¬¡ã€‚å·å°»æ¾å­åœ¨è‡ªæ€å‰ï¼ŒæŠ„å†™æ—¥æœ¬å°è¯´å®¶å¤ªå®°æ²»çŸ­ç¯‡å°è¯´ã€ŠäºŒåä¸€ä¸–çºªæ——æ‰‹ã€‹çš„å¼€ç¯‡è¯­ã€Œç”Ÿã¾ã‚Œã¦ã€ã™ã¿ã¾ã›ã‚“ã€‚ã€(ä¸­æ–‡æ„æ€ï¼šç”Ÿè€Œä¸ºäººï¼Œæˆ‘å¾ˆæŠ±æ­‰ï¼‰ä½œä¸ºé—è¨€ã€‚</p><p><img src="/upload/images/2020/09/26/2.jpg"></p><p>ç„¶åæˆ‘åœ¨é‚£ç¯‡æ–‡ç« çš„ä¸‹é¢å†™äº†è‡ªå·±çš„è¯„è®ºï¼š</p><blockquote><p>æ‰€æœ‰æ‰¹è¯„è€å¸ˆè®²è§£é”™è¯¯çš„äººï¼Œä½ ä»¬çœŸçš„çŸ¥é“è¿™å¥è¯çš„æ¥æºå—ï¼Ÿæœ‰è¿™ä¸ªæ’•é€¼çš„æ—¶é—´ï¼Œä¸å¦‚å»è¯»è¯»æˆ‘çš„æ–‡ç« ğŸ˜„</p></blockquote><p>ç”Ÿæ´»ä¸­ï¼Œç¾å¥½çš„äº‹ç‰©å¾€å¾€éƒ½æ˜¯çŸ­æš‚çš„ç”šè‡³æ˜¯ä¸´æ—¶çš„ï¼Œä¸å¦‚æ„çš„äº‹æƒ…åä¹‹å…«ä¹ï¼Œåªæœ‰è°ƒæ•´å¥½è‡ªå·±çš„å¿ƒæ€æ‰èƒ½è¿æ¥æ›´ç¾å¥½çš„æ˜å¤©ã€‚æƒ…ç»ªæ˜¯å¯ä»¥æ„ŸæŸ“çš„ï¼Œçƒ­çˆ±ç”Ÿæ´»æ˜¯æˆ‘ä»¬ä¸è¢«åæƒ…ç»ªä¾µæ²¡å’Œè¿·å¤±çš„å¤ªé˜³ã€‚ç”Ÿæ´»ä¸­éœ€è¦æ­£èƒ½é‡ï¼Œå¾ˆå¤šäº‹æƒ…åªè¦ä½ æ¢ä¸ªæ€è·¯æ¥æƒ³å¯èƒ½å®ƒçš„å‘ç”Ÿå¹¶ä¸æ˜¯ä¸€ä»¶åäº‹ã€‚ä¸è¦æŠŠè‡ªå·±é”åœ¨é‚£å£æš—æ— å¤©æ—¥çš„äº•ä¸­ï¼Œå¥‹åŠ›å‰è¡Œæ‰æœ‰ç¾å¥½çš„æ˜å¤©ã€‚</p><p>ç”Ÿè€Œä¸ºäººï¼Œæˆ‘å¾ˆæ¬¢å–œï¼</p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æƒ…ç»ªç®¡ç† å¿ƒæ€ é˜³å…‰ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++ä¸­ç”¨charæ•°ç»„æ„é€ string</title>
      <link href="/2020/09/05/C-%E4%B8%AD%E7%94%A8char%E6%95%B0%E7%BB%84%E6%9E%84%E9%80%A0string/"/>
      <url>/2020/09/05/C-%E4%B8%AD%E7%94%A8char%E6%95%B0%E7%BB%84%E6%9E%84%E9%80%A0string/</url>
      
        <content type="html"><![CDATA[<p>åœ¨ <code>C++</code> ä¸­å¦‚ä½•ä½¿ç”¨ç”¨ <code>char æ•°ç»„</code> æ„é€  <code>string</code>ï¼Œç¡®å®æ˜¯ä¸€ä¸ªè€æ‰ç‰™çš„è¯é¢˜ï¼Œä½†æ˜¯ç¨åŠ ä¸æ³¨æ„ä½ å°±ä¼šå‡ºé”™ã€‚</p><p>æœ€è¿‘åœ¨å†™ä¸€ä¸ªå¯ä»¥è·¨å¹³å°æ‰“å°çš„æ—¥å¿—ç¨‹åºï¼Œé‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œæ•…è®°ä¹‹ï¼Œå…±å‹‰!</p><p><strong>ç”¨ char æ•°ç»„åˆå§‹åŒ– string ç¤ºä¾‹</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> std::string;</span><br><span class="line"><span class="keyword">using</span> std::cout;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> * argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> chArray[] = &#123;<span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;l&#x27;</span>&#125;;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;array size = &quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(chArray)/<span class="built_in">sizeof</span>(<span class="type">char</span>) &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; chArray &lt;&lt; endl;</span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">(chArray)</span></span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str = &quot;</span> &lt;&lt; str &lt;&lt; <span class="string">&quot; and str&#x27;s size = &quot;</span> &lt;&lt; str.<span class="built_in">length</span>() &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é’ˆå¯¹ä¸Šé¢çš„ä»£ç ï¼Œä¸åŒçš„ç¼–è¯‘å™¨è¾“å‡ºç»“æœä¸ä¸€è‡´ï¼Œå…·æœ‰ä¸€å®šçš„éšæœºæ€§ã€‚</p><p>åœ¨ macos ç³»ç»Ÿä¸‹ï¼Œè¾“å‡ºç»“æœ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">array size = <span class="number">4</span></span><br><span class="line">hell\<span class="number">310</span>\<span class="number">367</span>\<span class="number">277</span>_\<span class="number">377</span></span><br><span class="line">str = hell\<span class="number">310</span>\<span class="number">367</span>\<span class="number">277</span>_\<span class="number">377</span> <span class="keyword">and</span> str<span class="number">&#x27;</span>s size = <span class="number">10</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°è¿™ç§ç»“æœï¼Œç®€ç›´è¦æ³•å…‹â€¦</p><p>ä½†æ˜¯æœ‰æ—¶å€™è¾“å‡ºç»“æœåˆæ˜¯ä¸‹é¢é‚£æ ·çš„</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">array size = <span class="number">4</span></span><br><span class="line">hell</span><br><span class="line">str = hell <span class="keyword">and</span> str<span class="number">&#x27;</span>s size = <span class="number">5</span></span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾ï¼Œ<code>string</code> çš„ <code>size</code> ä¸å¯¹.</p><p>æ€è€ƒä¸€ä¸‹ï¼ŒåŸæ¥æ˜¯å°‘äº† â€˜\0â€™ï¼Œä¿®æ”¹ä¸Šé¢ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> std::string;</span><br><span class="line"><span class="keyword">using</span> std::cout;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> * argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> chArray[] = &#123;<span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;\0&#x27;</span>&#125;;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;array size = &quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(chArray)/<span class="built_in">sizeof</span>(<span class="type">char</span>) &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; chArray &lt;&lt; endl;</span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">(chArray)</span></span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str = &quot;</span> &lt;&lt; str &lt;&lt; <span class="string">&quot; and str&#x27;s size = &quot;</span> &lt;&lt; str.<span class="built_in">length</span>() &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ä¹‹åï¼Œä»£ç çš„ç»“æœè¾“å‡ºæ­£å¸¸äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">array size = <span class="number">5</span></span><br><span class="line">hell</span><br><span class="line">str = hell <span class="keyword">and</span> str<span class="number">&#x27;</span>s size = <span class="number">4</span></span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>char</code> æ•°ç»„åˆå§‹åŒ– <code>string</code> å¯¹è±¡ï¼Œæ•°ç»„çš„ç»“æŸç¬¦ â€˜\0â€™ ä¸è¦å¿˜è®°äº†ã€‚</p><p>å¦å¤–ï¼Œè¦æ³¨æ„ <code>string</code> çš„ <code>size</code> è¦æ¯” <code>char æ•°ç»„</code> çš„ <code>size</code> å°ã€‚</p><p>ä¸çŸ¥é“ä¸Šé¢çš„ä¸œè¥¿ï¼Œä½ æœ‰æ²¡æœ‰çœ‹æ˜ç™½?</p><p>é‚£ä¹ˆä¸‹é¢çš„ä»£ç è¾“å‡ºï¼Œä½ è§‰å¾—ä¼šè¾¾åˆ°è‡ªå·±çš„é¢„æœŸå—?</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">char</span> * cp = str.<span class="built_in">c_str</span>();</span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> size = str.<span class="built_in">length</span>();</span><br><span class="line"><span class="type">char</span> chArray2[size];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;size; i++) &#123;</span><br><span class="line">    chArray2[i] = cp[i];</span><br><span class="line">    cout &lt;&lt; chArray2[i] &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">string <span class="title">str2</span><span class="params">(chArray2)</span></span>;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;str2 = &quot;</span> &lt;&lt; str2 &lt;&lt; <span class="string">&quot; and str2&#x27;s size = &quot;</span> &lt;&lt; str2.<span class="built_in">length</span>() &lt;&lt; endl;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¾ˆæ˜¾ç„¶æ˜¯é”™è¯¯çš„ï¼Œè‡³å°‘ä¸¤å¤„æ˜¯ä¸å¯¹çš„ã€‚</p><p>1ã€<code>chArray2</code> çš„å¤§å°ï¼›</p><p>2ã€<code>chArray2</code> çš„ç»“æŸç¬¦æ²¡æœ‰æ·»åŠ  â€˜\0â€™ï¼›</p><p>ä¿®æ”¹ä¸€ä¸‹ï¼Œç»™å‡ºå®Œæ•´ç¤ºä¾‹</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> std::string;</span><br><span class="line"><span class="keyword">using</span> std::cout;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> * argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// char[] ---&gt; string</span></span><br><span class="line">    <span class="type">char</span> chArray[] = &#123;<span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;\0&#x27;</span>&#125;;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;array size = &quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(chArray)/<span class="built_in">sizeof</span>(<span class="type">char</span>) &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; chArray &lt;&lt; endl;</span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">(chArray)</span></span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str = &quot;</span> &lt;&lt; str &lt;&lt; <span class="string">&quot; and str&#x27;s size = &quot;</span> &lt;&lt; str.<span class="built_in">length</span>() &lt;&lt; endl;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// string --&gt; char[]</span></span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> * cp = str.<span class="built_in">c_str</span>();</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> size = str.<span class="built_in">length</span>();</span><br><span class="line">    <span class="type">char</span> chArray2[size + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;size; i++) &#123;</span><br><span class="line">        chArray2[i] = cp[i];</span><br><span class="line">        cout &lt;&lt; chArray2[i] &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    chArray2[size] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function">string <span class="title">str2</span><span class="params">(chArray2)</span></span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str2 = &quot;</span> &lt;&lt; str2 &lt;&lt; <span class="string">&quot; and str2&#x27;s size = &quot;</span> &lt;&lt; str2.<span class="built_in">length</span>() &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¹Ÿè®¸æœ‰äººä¼šè¯´ï¼Œä¸ºä»€ä¹ˆè¦ç”¨ <code>char æ•°ç»„</code> å»æ„é€  <code>string</code> å¯¹è±¡ï¼Œç”¨ <code>char *</code>(æŒ‡é’ˆ)ä¸æ˜¯æ›´å¥½å—?</p><p>çš„ç¡®æ˜¯è¿™æ ·ï¼Œä½†æ˜¯æœ‰æ—¶å€™éœ€è¦ <code>char</code> æ•°ç»„æ¥æ“ä½œï¼Œæˆ‘ä¹Ÿæ˜¯æŠŠè‡ªå·±é‡åˆ°çš„é—®é¢˜,åŠ ä»¥æ€»ç»“è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹ã€‚</p><p>æŠŠç¤ºä¾‹ä»£ç ä¸­çš„</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> chArray[] = &#123;<span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;\0&#x27;</span>&#125;;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸º</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> chArray[] = <span class="string">&quot;hell&quot;</span>;</span><br></pre></td></tr></table></figure><p>æˆ–è€…</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">char</span> *chArray = <span class="string">&quot;hell&quot;</span>;</span><br></pre></td></tr></table></figure><p>ä»£ç ä¹Ÿå¯ä»¥æ­£å¸¸æ­£ç¡®çš„è¾“å‡ºã€‚</p><p>å¦‚æœä½ æœ‰å…´è¶£ï¼Œå¯ä»¥çœ‹æˆ‘ä¹‹å‰æ€»ç»“çš„ä¸€ç¯‡æ–‡ç«  <a href="http://www.veryitman.com/2019/03/07/%E4%B8%8D%E8%A7%81%E5%BE%97%E4%BD%A0%E4%BC%9A%E8%AE%A1%E7%AE%97C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%95%BF%E5%BA%A6/">ä¸è§å¾—ä½ ä¼šè®¡ç®—Cå­—ç¬¦ä¸²é•¿åº¦</a>, ğŸ™‡â€ï¼</p><hr><p><strong>å¿ƒè‹¥ç›¸çŸ¥ï¼Œæ— è¨€ä¹Ÿé»˜å¥‘ã€‚</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> macOS C++ string </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡: å¤š Module ç®¡ç†å·¥ç¨‹</title>
      <link href="/2020/08/29/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E5%A4%9A-Module-%E7%AE%A1%E7%90%86%E5%B7%A5%E7%A8%8B/"/>
      <url>/2020/08/29/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E5%A4%9A-Module-%E7%AE%A1%E7%90%86%E5%B7%A5%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åœ¨ <a href="http://www.veryitman.com/2019/06/02/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E6%83%B3%E5%8A%9E%E6%B3%95%E8%AE%A9%E9%A1%B9%E7%9B%AE%E8%BF%90%E8%A1%8C%E8%B5%B7%E6%9D%A5/">å¾®æœåŠ¡-æƒ³åŠæ³•è®©é¡¹ç›®è¿è¡Œèµ·æ¥</a> è¿™ç¯‡æ–‡ç« ä¸­ï¼Œä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ <code>IDEA</code> å¼€å‘å·¥å…·æ­å»ºæœ¬åœ°çš„å¾®æœåŠ¡å¼€å‘ç¯å¢ƒï¼Œé€šå¸¸æˆ‘ä»¬ä¼šæŠŠä¸€ä¸ªå¾®æœåŠ¡é¡¹ç›®åˆ†è§£æˆå¤šä¸ªæœåŠ¡ï¼Œé‚£ä¹ˆä¸ºäº†æ›´å¥½çš„ç®¡ç†è¯¥é¡¹ç›®ï¼Œå¤§å®¶ä¸€èˆ¬éƒ½ä¼šåœ¨ IDE é‡Œé¢é€šè¿‡å¤š <code>Module</code> æ¥è¿›è¡Œç®¡ç†ã€‚è¿™é‡Œçš„å¤š <code>Module</code> å¯ä»¥ç†è§£ä¸ºå¤šä¸ª <code>SpringBoot</code> é¡¹ç›®ã€‚</p><p>è¿‘æœŸæ”¶åˆ°ä¸€äº›å°ä¼™ä¼´çš„åé¦ˆï¼Œåœ¨ä½¿ç”¨ <code>IDEA</code> æ­å»ºå¤š <code>Module</code> çš„æ—¶å€™æ€»ä¼šé‡åˆ°ä¸€äº›è«åå…¶å¦™çš„é—®é¢˜ï¼Œç”šæ˜¯è®©äººçƒ¦æ¼ã€‚è¶æ­¤æœºä¼šç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹ã€‚</p><p>ä¸‹é¢çš„å®è·µï¼Œä½¿ç”¨çš„æ˜¯ <code>IntelliJ IDEA 2020.2</code> ç‰ˆæœ¬ï¼Œ<code>2019.x</code> ç‰ˆæœ¬ä¹Ÿæ˜¯åŒæ ·çš„åˆ›å»ºæ–¹æ³•ã€‚</p><h2 id="è¯´å¹²å°±å¹²"><a href="#è¯´å¹²å°±å¹²" class="headerlink" title="è¯´å¹²å°±å¹²"></a>è¯´å¹²å°±å¹²</h2><p>ä¸€äº›åœ¨ä½ çœ‹æ¥å¹¶ä¸èµ·çœ¼çš„å·¥ä½œï¼Œå¯¹äºåˆ«äººæ¥è¯´å¯èƒ½æ˜¯éš¾ä»¥é€¾è¶Šçš„é¸¿æ²Ÿã€‚</p><p>ä¸åºŸè¯ï¼Œç›´æ¥å®è·µå¼€å¹²ï¼</p><p>1ã€æ‰“å¼€ IDEAï¼ŒFile&#x2F;New Project</p><p><img src="/upload/images/2020/08/29/1.png"></p><p>é€‰æ‹© <code>Spring Initializr</code>ï¼Œå·¥ç¨‹ç±»å‹é€‰æ‹© Mavenã€‚</p><p><img src="/upload/images/2020/08/29/3.png"></p><p>åœ¨æ¥ä¸‹æ¥çš„æ­¥éª¤ä¸­ï¼Œä¸éœ€è¦é€‰æ‹©ä»»ä½•ä¾èµ–ã€‚å¡«å†™å®Œæˆåï¼Œç‚¹å‡» <code>Finish</code> å³å¯ã€‚</p><p>åˆ é™¤å·¥ç¨‹çš„ <code>src</code>ã€<code>.mvn</code>ã€<code>mvnw</code> ã€<code>mvnw.cmd</code>  è¿™å‡ ä¸ªç›®å½•ã€‚</p><p><img src="/upload/images/2020/08/29/4.png"></p><p>åˆ é™¤åï¼Œå·¥ç¨‹ç›®å½•å¦‚ä¸‹</p><p><img src="/upload/images/2020/08/29/5.png"></p><p>ä¿®æ”¹ <code>pom.xml</code> æ–‡ä»¶ï¼Œå¢åŠ å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨ <code>Maven</code> é¡¹ç›®ä¸­ï¼Œ<code>packaging</code> ç»™å‡ºäº†é¡¹ç›®çš„æ‰“åŒ…ç±»å‹ï¼Œå³ä½œä¸ºé¡¹ç›®çš„å‘å¸ƒå½¢å¼ï¼Œå…¶å¯èƒ½çš„ç±»å‹ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç»§æ‰¿è¯´æ˜ï¼šè¿™é‡Œç»§æ‰¿SpringBootæä¾›çš„çˆ¶å·¥ç¨‹ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.8.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- é¡¹ç›®è¯´æ˜ï¼šè¿™é‡Œä½œä¸ºèšåˆå·¥ç¨‹çš„çˆ¶å·¥ç¨‹ï¼Œä¿®æ”¹æ‰“åŒ…ä¸ºpomèšåˆå·¥ç¨‹ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.veryitman.main<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>blog-main-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>blog-main-server<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">description</span>&gt;</span>Blog of main project for Spring Boot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨ <code>Maven 3</code> ä¸­ï¼Œå…¶å¯ç”¨çš„æ‰“åŒ…ç±»å‹å¦‚ä¸‹ï¼š</p><ul><li>jarï¼Œé»˜è®¤ç±»å‹</li><li>war</li><li>ejb</li><li>ear</li><li>rar</li><li>par</li><li>pom</li><li>maven-plugin</li></ul><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2020/08/29/6.png"></p><p>2ã€åˆ›å»º <code>Module</code></p><p>åœ¨å·¥ç¨‹åç§°ä¸Šé¢å³é”®æ–°å»º <code>module</code>ï¼Œå¦‚ä¸‹å›¾</p><p><img src="/upload/images/2020/08/29/7.png"></p><p>è¿™é‡Œä»¥åˆ›å»º SpringBoot Module ä¸ºä¾‹ï¼Œä½¿ç”¨ <code>Spring Initializr</code> åˆ›å»º <code>Module</code></p><p><img src="/upload/images/2020/08/29/8.png"></p><p>æŒ‰ç…§ä½ è‡ªå·±çš„éœ€æ±‚å¡«å†™å¯¹åº”çš„ä¿¡æ¯å³å¯è¿›å…¥åˆ°ä¸‹ä¸€æ­¥ç›´è‡³ <code>Finish</code>.</p><p><img src="/upload/images/2020/08/29/9.png"></p><p>æ­¤æ—¶ï¼Œä¿®æ”¹è¯¥ module çš„ pom æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼ˆå°†ä»å·¥ç¨‹ç»§æ‰¿è€Œä¸æ˜¯ä»spring bootç»§æ‰¿ï¼‰æ‰€ç¤ºï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.veryitman.main<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>project-xxx-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span> <span class="comment">&lt;!-- å·¥ç¨‹åç§° --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åŒç†ï¼Œå†æ–°å»ºä¸€ä¸ª <code>mz-payment-inone</code> çš„ <code>Module</code>ï¼Œæœ€åå·¥ç¨‹ç›®å½•å¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2020/08/29/10.png"></p><p>åŒç†ï¼Œ <code>mz-payment-inone</code> å»ºç«‹å¥½ä¹‹åä¹Ÿä¿®æ”¹ä¸€ä¸‹å®ƒçš„ pom æ–‡ä»¶ä¸­çš„ <code>&lt;parent&gt;</code> æ ‡ç­¾å†…å®¹ã€‚</p><p>æ‰€æœ‰çš„ module å»ºç«‹å®Œæˆä¹‹åï¼Œåœ¨ <strong>å·¥ç¨‹çš„</strong> pom ä¸­å¢åŠ  module çš„è¯´æ˜å³å¢åŠ  <code>&lt;module&gt;</code> æ ‡ç­¾ ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ¨¡å—è¯´æ˜ï¼šè¿™é‡Œå£°æ˜å¤šä¸ªå­æ¨¡å— --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span>&gt;</span>ms-login-inone<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span>&gt;</span>mz-payment-inone<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">modules</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œå·¥ç¨‹ä¸­å¤š <code>Module</code> å·²ç»åˆ›å»ºå®ŒæˆğŸ‘ï¼Œæ¥ä¸‹æ¥å†ç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹ <code>Module</code> ä¹‹é—´å¦‚ä½•ç›¸äº’è°ƒç”¨ã€‚</p><h3 id="Module-ä¹‹é—´çš„è°ƒç”¨"><a href="#Module-ä¹‹é—´çš„è°ƒç”¨" class="headerlink" title="Module ä¹‹é—´çš„è°ƒç”¨"></a>Module ä¹‹é—´çš„è°ƒç”¨</h3><p>æŒ‰ç…§ä¸Šé¢çš„æ–¹æ³•ï¼Œæˆ‘å†æ¬¡åˆ›å»ºäº†ä¸€ä¸ª <code>mz-core</code> çš„ <code>Module</code>ï¼Œè¯¥ <code>Module</code> ä¸º ä¸Šé¢ä¸¤ä¸ª SpringBoot Module æä¾›åŸºç¡€çš„æ–¹æ³•ã€‚</p><p>åœ¨ <code>mz-core</code> ä¸­å¢åŠ äº†ä¸€ä¸ª <code>MZDateUtil</code> ç±»å’Œå¯¹åº”çš„æ–¹æ³•</p><p><img src="/upload/images/2020/08/29/11.png"></p><p>åœ¨ <code>mz-login-inone</code> ä¸­ä½¿ç”¨è¯¥ç±»çš„æ–¹æ³•ã€‚</p><p>ä¸º <code>mz-login-inone</code> æ·»åŠ ä¾èµ– <code>ms-core</code>ï¼Œå¦‚å›¾</p><p><img src="/upload/images/2020/08/29/12.png"></p><p>åœ¨ <code>mz-login-inone</code> çš„ <code>pom.xml</code> æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç </p><p><img src="/upload/images/2020/08/29/13.png"></p><p>ç¼–å†™ <code>API</code> è¿›è¡Œæµ‹è¯•ï¼Œåœ¨ <code>mz-login-inone</code> çš„ <code>MZLoginInoneController</code> ä¸­å¢åŠ å¦‚ä¸‹ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;login&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MZLoginInoneController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;inone&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">loginInone</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Current date: &quot;</span> + MZDateUtil.currentDate();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œ <code>mz-login-inone</code>ï¼Œåœ¨æµè§ˆå™¨è®¿é—®è¯¥æ¥å£ï¼Œæ˜¾ç¤ºå¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2020/08/29/14.png"></p><hr><p>å¦‚æœä½ åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­è¿˜æœ‰é‡åˆ°å¥‡è‘©çš„é—®é¢˜ï¼Œæ¬¢è¿ç•™è¨€è¯„è®ºï¼Œæ„Ÿè°¢é˜…è¯»ï¼</p><hr><p><strong>è©¹å§†æ–¯Â·é«˜æ–¯æ— ï¼ˆJames Goslingï¼‰æ˜¯ä¸€åè½¯ä»¶ä¸“å®¶ï¼Œ1955å¹´5æœˆ19æ—¥å‡ºç”ŸäºåŠ æ‹¿å¤§ï¼ŒJava ç¼–ç¨‹è¯­è¨€çš„å…±åŒåˆ›å§‹äººä¹‹ä¸€ï¼Œä¸€èˆ¬å…¬è®¤ä»–ä¸ºâ€œJavaä¹‹çˆ¶â€ã€‚</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¾®æœåŠ¡ å¤šModule SpringBoot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç˜¦èº«ç§˜ç¬ˆ: é¥®é£Ÿè¿åŠ¨ç›¸å¾—ç›Šå½°</title>
      <link href="/2020/08/15/%E7%98%A6%E8%BA%AB%E7%A7%98%E7%AC%88-%E9%A5%AE%E9%A3%9F%E8%BF%90%E5%8A%A8%E7%9B%B8%E5%BE%97%E7%9B%8A%E5%BD%B0/"/>
      <url>/2020/08/15/%E7%98%A6%E8%BA%AB%E7%A7%98%E7%AC%88-%E9%A5%AE%E9%A3%9F%E8%BF%90%E5%8A%A8%E7%9B%B8%E5%BE%97%E7%9B%8A%E5%BD%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åœ¨ <a href="http://www.veryitman.com/2020/05/10/%E7%A8%8B%E5%BA%8F%E5%91%98%E4%BF%9D%E5%85%BB%E7%A7%98%E7%AC%88-%E5%85%BB%E6%88%90%E5%A5%BD%E4%B9%A0%E6%83%AF/">ç˜¦èº«ç§˜ç¬ˆ: å…»æˆå¥½ä¹ æƒ¯</a> è¿™ç¯‡æ–‡ç« ä¸­ç»™å¤§å®¶ä»‹ç»äº†ä¸€äº›ä¿æŠ¤è‡ªå·±å¥åº·çš„å¥½ä¹ æƒ¯ï¼Œå¸Œæœ›æ‚¨åœ¨çœ‹ä¸‹é¢å†…å®¹ä¹‹å‰ï¼Œå¯ä»¥å…ˆçœ‹çœ‹ä¹‹å‰çš„æ–‡ç« ã€‚</p><p>ä»Šå¤©è·Ÿå¤§å®¶åˆ†äº«å…³äºé¥®é£Ÿå’Œè¿åŠ¨ç»“åˆå¦‚ä½•è®©è‡ªå·±æ›´åŠ å¥åº·èµ·æ¥ï¼Œæˆ‘ä¸æ˜¯ä¸“ä¸šçš„ç˜¦èº«ä¸“å®¶ğŸ˜…ï¼Œåªèƒ½æ ¹æ®è‡ªå·±çš„äº²èº«ç»å†æŠ›ç –å¼•ç‰ï¼Œå¸Œæœ›æ¯ä¸ªä¸ºå®¶åº­ä»˜å‡ºçš„ITå·¥ä½œè€…éƒ½èƒ½å¥åº·ã€‚</p><p>ä½ å¯èƒ½ç»å¸¸ä¼šå¬åˆ°æœ‰äººè¯´â€œæˆ‘å–å£å‡‰æ°´éƒ½èƒ½èƒ–â€ï¼Œä¹Ÿçœ‹åˆ°å¾ˆå¤šåƒå¾—å†å¤šä¹Ÿé•¿ä¸èƒ–çš„äººï¼Œè½®åˆ°è‡ªå·±æƒ³ç˜¦ä¸€ç‚¹çš„æ—¶å€™æ„Ÿè§‰æ€ä¹ˆé‚£ä¹ˆéš¾ï¼Œç»å¸¸é™·å…¥ä¸‹é¢çš„æ­»å¾ªç¯ä¸­ã€‚</p><p><img src="/upload/images/2020/08/15/1.png"></p><p>ä¸ªäººè§‰å¾—åªè¦è‡ªå·±ä¸æ˜¯èƒ–çš„å¤ªè¿‡ç¦»è°±ï¼ˆBMIå¤§äº30äº†ï¼‰å³ä½¿èƒ–ä¸€ç‚¹ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œèº«ä½“å¥åº·å°±å¥½ã€‚ä½ éè¦æè‡´çš„èº«æï¼Œåªèƒ½è¿›è¡Œè‡ªæˆ‘æ¯ç­å¼çš„å‡è‚¥äº†ã€‚</p><p>ä¸Šæ¬¡å»çˆ¬å±±ï¼Œå¬åˆ°æœ‰ä¸€å“¥ä»¬å–˜ç€æ°”è¯´é•¿è‚¥è‚‰å®¹æ˜“ï¼Œæ‰è‚¥è‚‰éš¾ã€‚æ„ŸåŒèº«å—ï¼Œå¿…é¡»å°† <code>é¥®é£Ÿ+è¿åŠ¨</code> ç»“åˆå¥½ï¼Œä½ æ‰èƒ½åœ¨ä¸è‚¥è‚‰ææ–—ä¸­ç«‹äºä¸è´¥ä¹‹åœ°ã€‚</p><p>æˆ‘ç›¸ä¿¡åªè¦ä½ èƒ½åšæŒä¸‹æ¥ï¼Œå¥‡è¿¹ä¸€å®šä¼šåœ¨ä½ èº«ä¸Šå‘ç”Ÿã€‚</p><h2 id="äº†è§£æ¦‚å¿µ"><a href="#äº†è§£æ¦‚å¿µ" class="headerlink" title="äº†è§£æ¦‚å¿µ"></a>äº†è§£æ¦‚å¿µ</h2><p><strong>çƒ­é‡å•ä½</strong></p><hr><p>æˆ‘ä»¬ç»å¸¸çœ‹åˆ°è¯¸å¦‚ <code>å¡</code>ã€<code>åƒå¡</code>ã€<code>ç„¦</code>ã€<code>åƒç„¦</code>ã€<code>å¤§å¡</code> ä¹‹ç±»çš„çƒ­é‡å•ä½ï¼Œè®©äººå‚»å‚»åˆ†ä¸æ¸…ã€‚</p><p>ä¸€èˆ¬æè¿°é£Ÿç‰©çš„çƒ­é‡å•ä½æ˜¯å¡è·¯é‡Œï¼ˆCalorieï¼‰, 1å¡è·¯é‡Œç®€ç§°1å¡ï¼Œä½†æ˜¯ç”±äºç”¨ <code>å¡</code> æ¥è¡¨ç¤ºçƒ­é‡åˆå¤ªå°äº†ï¼Œæ‰€ä»¥äººä»¬æ€»æ˜¯ç”¨ <code>åƒå¡</code> ï¼ˆKCalï¼‰æ¥è¡¨ç¤ºé£Ÿç‰©çš„çƒ­é‡ã€‚1åƒå¡çƒ­é‡æœ‰å¤šå°‘ï¼Ÿå°±æ˜¯æŠŠ1å‡æ°´å‡é«˜1æ‘„æ°åº¦éœ€è¦çš„çƒ­é‡ã€‚ä¾‹å¦‚æ¯100gç±³é¥­å¤§æ¦‚æ˜¯116åƒå¡çš„çƒ­é‡ï¼Œæˆ‘ä»¬å¹³æ—¶ç”¨å°ç¢—ç››ä¸€ç¢—ç±³é¥­ç›®æµ‹æœ‰200å¤šå…‹ã€‚</p><p>é‚£ä¹ˆæ—¢ç„¶ <code>åƒå¡</code> å·²ç»èƒ½å¾ˆå¥½çš„è¡¨ç¤ºé£Ÿç‰©çƒ­é‡äº†ï¼Œä¸ºä½•è¿˜éœ€è¦ <code>å¤§å¡</code> å‘¢ï¼Ÿ</p><p>å…¶å®å‘¢ <code>å¤§å¡</code> å°±æ˜¯ <code>åƒå¡</code> ğŸ˜„ï¼Œåªä¸è¿‡æœ‰äº›äººå¯¹å…¶çš„å«æ³•ä¸åŒè€Œå·²ï¼Œè¿™å°±å¥½æ¯”æœ‰äº›äººæŠŠè¥¿çº¢æŸ¿å«åšç•ªæŸ¿æ˜¯ä¸€æ ·çš„é“ç†ã€‚</p><p>çƒ­é‡çš„å•ä½è¿˜å¯ä»¥ç”¨ <code>åƒç„¦</code>ï¼ˆKJï¼‰å’Œ <code>ç„¦</code> ï¼ˆJï¼Œä¹Ÿç§°ä¹‹ä¸ºç„¦è€³ï¼‰ä½œå•ä½ï¼Œä½†è¿™ä¸ªå•ä½ä¸€èˆ¬ç”¨ä½œå­¦æœ¯ä¸Šé¢ï¼Œæ²¡æœ‰ <code>åƒå¡</code> é‚£ä¹ˆæ¥åœ°æ°”ã€‚</p><blockquote><p>ç„¦è€³ï¼ˆç®€ç§°ç„¦ï¼Œç¬¦å·ä¸ºJï¼‰ï¼Œæ˜¯å›½é™…å•ä½èƒ½é‡å’ŒåšåŠŸçš„å•ä½ã€‚1ç„¦è€³èƒ½é‡ç›¸ç­‰äº1ç‰›é¡¿åŠ›çš„ä½œç”¨ç‚¹åœ¨åŠ›çš„æ–¹å‘ä¸Šç§»åŠ¨1ç±³è·ç¦»æ‰€åšçš„åŠŸ ã€‚</p><p>ç¬¦å·Jä¸ºçºªå¿µè‹±å›½ç‰©ç†å­¦å®¶ç„¦è€³è€Œå‘½åã€‚1ç„¦&#x3D;1ç‰›Â·ç±³ï¼Œä¹Ÿç­‰äº1ç“¦çš„åŠŸç‡åœ¨1ç§’å†…æ‰€åšçš„åŠŸï¼Œ1ç„¦&#x3D;1ç“¦Â·ç§’ã€‚</p></blockquote><p>åƒç„¦å’Œåƒå¡æ¢ç®—å¦‚ä¸‹ï¼š</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>åƒå¡ <span class="operator">=</span> <span class="number">4.184</span>åƒç„¦ <span class="operator">=</span> <span class="number">1</span>å¤§å¡ <span class="operator">=</span> <span class="number">1000</span>å¡ <span class="operator">=</span> <span class="number">4184</span>ç„¦</span><br></pre></td></tr></table></figure><p>ä»¥åä½ åªéœ€è¦è®°ä½ï¼Œåƒå¡å’Œå¤§å¡éƒ½æ˜¯ä¸€æ ·çš„å°±å¯ä»¥äº†ï¼Œåœ¨è¯„ä¼°é£Ÿç‰©çš„çƒ­é‡ä¸Šé¢æš‚æ—¶å¿˜è®°ç„¦è€³è¿™ä¸ªå•ä½å§ï¼Œç®—èµ·æ¥è„‘å£³ä¼šbulinbulinçš„ç—›ã€‚</p><p><strong>è„‚è‚ªå’Œçƒ­é‡</strong></p><hr><p>1 å…‹è„‚è‚ªå«æœ‰ 9 å¤§å¡çƒ­é‡ï¼Œ1 æ–¤è„‚è‚ªä¸º 500 å…‹ï¼Œé‚£ä¹ˆ 1 æ–¤è„‚è‚ªå«æœ‰çš„çƒ­é‡ä¸ºï¼š</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">500</span>Ã—<span class="number">9</span> ï¼ <span class="number">4500</span>åƒå¡</span><br></pre></td></tr></table></figure><p>æ ¹æ®è¿™æ ·æ¥è®¡ç®—ï¼Œ1 åƒå…‹ï¼ˆKGï¼Œå³1å…¬æ–¤ï¼‰è„‚è‚ªå«æœ‰ 9000 åƒå¡çƒ­é‡ã€‚äººä½“å†…æ¯å…‹çº¯è„‚è‚ªçš„çƒ­é‡æ˜¯ 9 åƒå¡ï¼Œä½†äººä½“è„‚è‚ªå†…è¿˜æœ‰ä¸€äº›éè„‚è‚ªç‰©è´¨ï¼Œæ¯”å¦‚çº¦ 10% çš„æ°´åˆ†ï¼Œæ‰€ä»¥ 1 å…¬æ–¤çš„è„‚è‚ªå‚¨å­˜ç€å¤§æ¦‚ <strong>7000ï½7700 åƒå¡</strong> çš„çƒ­é‡ã€‚</p><p>æ¢å¥è¯æ¥è¯´ï¼Œä½ æ¶ˆè€—æ‰å¤§æ¦‚ **7000ï½7700 åƒå¡ **çš„çƒ­é‡æ‰èƒ½ç˜¦ 1 å…¬æ–¤å·¦å³ã€‚é¥®é£Ÿç›¸å½“äºæ‘„å…¥çƒ­é‡ï¼Œè¿åŠ¨å¯ä»¥æ¶ˆè€—çƒ­é‡ï¼Œè¿™ä¸ªé“ç†å¾ˆå¥½æ‡‚å§ï¼Ÿæ‰€ä»¥ï¼Œæ§åˆ¶é¥®é£Ÿå’Œé€‚å½“çš„è¿åŠ¨æ‰èƒ½æ›´å¥½çš„æ§åˆ¶çƒ­é‡çš„æ‘„å…¥å’Œæ¶ˆè€—ã€‚</p><h2 id="é¥®é£Ÿ"><a href="#é¥®é£Ÿ" class="headerlink" title="é¥®é£Ÿ"></a>é¥®é£Ÿ</h2><h3 id="æ—©ç¡æ—©èµ·"><a href="#æ—©ç¡æ—©èµ·" class="headerlink" title="æ—©ç¡æ—©èµ·"></a>æ—©ç¡æ—©èµ·</h3><p>å¾ˆå¤šå°ä¼™ä¼´ç¡å¾—æ™šæ—©æ™¨èµ·æ¥çš„ä¹Ÿæ™šï¼Œå°¤å…¶æ˜¯å‘¨æœ«è¿™ç§ç°è±¡æ›´åŠ ä¸¥é‡ã€‚</p><p><img src="/upload/images/2020/08/15/2.png"></p><p>å¦‚æœä½ åƒä¸Šå›¾ä¸­é‚£æ ·æ—¥å¤ä¸€æ—¥ï¼Œè¿Ÿæ—©ä¼šä¸å¥åº·èµ·æ¥çš„ğŸ™ï¼Œä¹Ÿéå¸¸å®¹æ˜“è®©ä½ èƒ–èµ·æ¥ã€‚æ­£ç¡®çš„å¾ªç¯åº”è¯¥æ˜¯ä¸‹é¢é‚£æ ·ï¼š</p><p><img src="/upload/images/2020/08/15/3.png"></p><p>æ­£å¸¸é¥®é£Ÿä»æ—©ç¡æ—©èµ·å¼€å§‹ã€‚</p><p>å°½é‡æ¯å¤©æ—©ä¸Š8ç‚¹å·¦å³åƒå®Œæ—©é¤ï¼Œæ—©é¤ä¸è¦è¿‡äºæ²¹è…»ã€‚</p><blockquote><p>é¸¡è›‹ğŸ¥š+çº¢è–¯ï¼ˆæ™®é€šï¼‰+é«˜é’™ç‰›å¥¶ï¼›</p><p>é¸¡è›‹ğŸ¥š+é«˜é’™ç‰›å¥¶+ç‰ç±³ï¼›</p><p>é¸¡è›‹ğŸ¥š+å…¨éº¦é¢åŒ…+åšæœï¼›</p><p>é¸¡è›‹ğŸ¥š+è’¸é¥ºï¼ˆç˜¦è‚‰&#x2F;è”¬èœé¦…å„¿ï¼‰ï¼›</p><p>é¸¡è›‹ğŸ¥š+çº¢è–¯ï¼ˆç´«è–¯ï¼‰+é’ç“œï¼›</p><p>è›‹ç™½ç²‰ï¼ˆå†²æ°´ï¼‰+å…¨éº¦é¢åŒ…+åšæœï¼›</p><p>è¥¿çº¢æŸ¿é¸¡è›‹é¢ğŸ¥š+æŸ æª¬æ°´+è”¬èœï¼›</p></blockquote><p>ä¸Šé¢æ˜¯æˆ‘æ¯å‘¨çš„æ—©é¤æ­é…ï¼Œæ²¡æœ‰å›ºå®šå“ªå¤©æ—©ä¸Šåƒä»€ä¹ˆï¼Œéƒ½æ˜¯è½®ç€æ¥ã€‚ä½ ä¼šå‘ç°æˆ‘åŸºæœ¬ä¼šä¿è¯æ¯æ—©éƒ½æœ‰ä¸ªæ°´ç…®é¸¡è›‹ï¼Œå¹¶ä¸”æ²¡æœ‰ä»»ä½•ä¸€ç§æ²¹ç‚¸çš„é£Ÿç‰©ã€‚</p><p>æ—©ä¸Šèµ·æ¥åï¼Œè®°å¾—å…ˆå–ä¸€æ¯çƒ­å¼€æ°´ï¼Œç¡äº†ä¸€å¤œåèº«ä½“æ°´åˆ†ä¼šæµå¤±å¾ˆå¤šï¼Œæ‰€ä»¥éœ€è¦æ—©ä¸Šèµ·åºŠåè¡¥å……ä¸€å®šçš„æ°´åˆ†ï¼ˆ300ml~500mlå·¦å³å³å¯ï¼‰ã€‚æ¯æ¬¡æ—©ä¸Šå–çƒ­å¼€æ°´çš„æ—¶å€™ï¼Œä»¿ä½›èƒ½å¬åˆ°ç»†èƒåœ¨èº«ä½“é‡Œçš„æ¬¢å‘¼å£°ğŸ˜„ï¼Œä½ å¯¹èº«ä½“çš„ä»»ä½•å¥½ï¼Œå®ƒéƒ½èƒ½æ„Ÿè§‰å¾—åˆ°ï¼Œä¸ä¿¡çš„è¯ä½ å¯ä»¥åšæŒå‡ å¤©è¯•è¯•ã€‚</p><h3 id="å°‘åƒå¤šé¤"><a href="#å°‘åƒå¤šé¤" class="headerlink" title="å°‘åƒå¤šé¤"></a>å°‘åƒå¤šé¤</h3><p>æˆ‘ä¹‹å‰æ€»å–œæ¬¢æŠŠåƒä¸å®Œçš„é¥­èœå…¨éƒ¨åŒ…æ½ï¼Œç›´æ¥å€’è¿›ç¢—é‡Œæ‹Œé¥­åƒé‚£ç§ï¼Œå—ï¼æ€»è§‰å¾—æ‰”æ‰æŒºå¯æƒœçš„ã€‚æ®Šä¸çŸ¥ï¼Œç›˜å­é‡Œé¢å‰©ä¸‹çš„èœä¸‹é¢å…¨éƒ¨æ˜¯åšåšçš„æ²¹ï¼Œä¼´ç€ç±³é¥­åƒèµ·æ¥æ˜¯å¾ˆçˆ½ä½†æ˜¯ä¹Ÿä¼šè®©çƒ­é‡ä¹˜è™šè€Œå…¥ã€‚</p><p>åé¢å‘ç°è‡ªå·±é€æ¸å£®å¤§çš„è‚šå­ï¼Œå°±å¼€å§‹æ…¢æ…¢æˆ’æ‰ <code>åƒé”…åº•</code> çš„ä¹ æƒ¯äº†ã€‚</p><p>åˆé¤å¯ä»¥é€‚å½“çš„æ²¹è…»ä¸€ç‚¹ï¼Œä½†æ˜¯ä¸è¦å¤ªè¿‡åˆ†å“Ÿã€‚å¯ä»¥ç»™å‡è‚¥çš„è‡ªå·±åŠ ä¸ªå¤é¸¡è…¿ï¼Œè®°å¾—æ‰”æ‰é¸¡çš®ï¼ˆçƒ­é‡æœ‰ç‚¹é«˜ï¼‰ï¼Œåˆé¤åå¯ä»¥åƒç‚¹é’ç“œã€‚</p><p>æ¯å¤©ä¸­åˆåˆé¤ï¼Œå°½é‡å¤šåƒè”¬èœï¼Œè”¬èœé‡Œé¢çš„è†³é£Ÿçº¤ç»´å¯ä»¥é€‚å½“çš„é˜»æ­¢è„‚è‚ªçš„æˆé•¿ï¼Œå¸®ä½ é˜»æŒ¡ä¸€éƒ¨åˆ†çƒ­é‡è‚†è™æ»‹é•¿ã€‚</p><p>æ™šé¤å°½é‡åœ¨ 18 ç‚¹ä¹‹å‰åƒï¼Œä¸è¦åƒå¤ªå¤šï¼ŒåŒæ ·ä¸è¦åƒçš„è¿‡äºæ²¹è…»ã€‚å¦‚æœæ™šä¸Šå°¤å…¶æ˜¯ä¸‹ç­æ¯”è¾ƒæ™šçš„å°ä¼™ä¼´ï¼Œå¯ä»¥ç»™è‡ªå·±è¡¥å……ä¸€ç‰‡å…¨éº¦é¢åŒ…æˆ–è€…ä¸€æ¯é«˜é’™è„±è„‚ç‰›å¥¶ã€‚</p><p>æ™šé¤å¯ä»¥ç›¸å¯¹æ¸…æ·¡ä¸€ç‚¹ï¼Œå¦‚æœä½ ä¸å°å¿ƒåƒå¤šäº†ï¼Œé‚£ä½ æ™šä¸Šå°½é‡å¤šè¿åŠ¨ä¸€ä¼šï¼Œå“ªæ€•æ•£æ­¥ä¹Ÿå¥½ã€‚</p><p>æ™šä¸Šä¸´ç¡å‰2å°æ—¶å†…å°±ä¸è¦åƒä¸œè¥¿äº†ï¼Œå¯¹ï¼ä¸åƒ anythingã€‚</p><p>åˆé¤å’Œæ™šé¤ï¼Œæˆ‘ç°åœ¨éƒ½æ˜¯åƒä¸ª7æˆé¥±ï¼Œå¦‚æœä½ æ˜¯åˆšå¼€å§‹å‡è‚¥ï¼Œå»ºè®®ä»9æˆé¥±å¼€å§‹é€æ­¥é€’å‡åˆ°åŠé¥±ã€‚ä¸‹åˆå¦‚æœé¥¿äº†å°±ç»™è‡ªå·±è¡¥å……ç‚¹æ°´æœæˆ–è€…é¢åŒ…ï¼Œåˆ‡è®°åœ¨è¿™ä¸¤é¤å½“ä¸­åƒçš„å¤ªå¤šï¼Œè¿™æ ·ä¸ä»…ä¼šåŠ å¤§çƒ­é‡çš„æ‘„å…¥ï¼Œè¿˜ä¼šè®©ä½ çš„èƒƒä¸å ªé‡è´Ÿã€‚</p><p>è‡³äºä»€ä¹ˆæ˜¯å‡ æˆé¥±ï¼Œæˆ‘ä¹Ÿæ²¡æœ‰å®é™…æµ‹é‡è¿‡ã€‚ä¸è¿‡ï¼Œæœ‰ä¸ªç®€å•çš„åŠæ³•ï¼ŒæŠŠä½ å¹³æ—¶åƒçš„ç±³é¥­æˆ–è€…å…¶ä»–ä¸»é£Ÿé€‚å½“çš„å‡å°‘ä¸€äº›åˆ†é‡ã€‚</p><p>æœ‰å¾ˆå¤šäººè¯´ä¸åƒæ™šé¤ï¼Œå¯ä»¥å¾ˆå¿«çš„ç˜¦ä¸‹æ¥ï¼Œè¿™ä¸ªæˆ‘æ‰¿è®¤ã€‚2018å¹´æˆ‘åšæŒäº†ä¸€ä¸ªåŠæœˆæ²¡æœ‰åƒæ™šé¤ï¼Œç¡®å®ç˜¦äº†ä¸å°‘ï¼Œä½†æ˜¯æ¯å¤©æ™šä¸Šè‚šå­å‡„æƒ¨çš„å«å£°ç€å®è®©äººéš¾å—ã€‚ä¸€ä¸ªåŠæœˆåï¼Œæˆ‘å®åœ¨æ˜¯åšæŒä¸ä¸‹æ¥äº†ï¼Œè‡ªå·±çš„å†…å¿ƒå°±æ„Ÿè§‰ä½ç€å¦å¤–ä¸€ä¸ªè‡ªå·±æ€»æ˜¯è¯´ï¼šâ€ç®—äº†å§ï¼Œå¤ªè¾›è‹¦äº†ï¼Œæ”¾å¼ƒå§ï¼â€œï¼Œè¿™ç§å£°éŸ³ä¼šæŒç»­åˆ°ä½ æ¯«æ— åæŠ—ä¹‹åŠ›ä¸ºæ­¢ã€‚ç„¶åæˆ‘å°±å¼€å§‹å›å½’åˆ°æ­£å¸¸çš„æ™šé¤ç”Ÿæ´»ï¼Œèƒƒå£å°±åƒå†³å ¤çš„å¤§åï¼Œä½“é‡åˆå¦‚æ—¥ä¸­å¤©çš„ä¸Šæ¥äº†ğŸ˜³ã€‚æŠ›å¼€ç»å¸¸ä¸åƒæ™šé¤å¯¹èº«ä½“æœ‰æ— åå¤„æ¥è¯´ï¼Œä½ è¦æ˜¯èƒ½åšæŒä¸‹æ¥æˆ‘è§‰å¾—ä½ ä¸å»åˆ›ä¸šå½“ CEO å°±å¯¹ä¸èµ·ä½ è¿™é¢—åšå¼ºçš„å¿ƒã€‚</p><h2 id="è¿åŠ¨"><a href="#è¿åŠ¨" class="headerlink" title="è¿åŠ¨"></a>è¿åŠ¨</h2><p>ä¸Šé¢ç®€å•è¯´äº†ä¸€ä¸‹ç˜¦èº«æœŸé—´å¦‚ä½•è°ƒèŠ‚è‡ªå·±çš„é¥®é£Ÿï¼Œä¸‹é¢æˆ‘ä»¬è¯´è¯´ç»“åˆè¿åŠ¨ï¼Œè®©ä½ çš„ç˜¦èº«è®¡åˆ’å¦‚è™æ·»ç¿¼ã€‚</p><p>æ ¹æ®ç¾å›½çš„è¿åŠ¨åä¼šæ‰€åšçš„ç ”è®¨è¡¨æ˜ï¼Œåœ¨äººåˆæ­¥è¿åŠ¨ 10 åˆ†é’Ÿä¹‹åï¼Œè„‚è‚ªç»„ç»‡ä¸­çš„è¡€æµé‡ä¼šå¢åŠ ï¼Œè¡¨æ˜è„‚è‚ªçš„è¿›è¡Œåˆæ­¥çš„ç‡ƒçƒ§ï¼Œåœ¨è¿åŠ¨ 30 åˆ†é’Ÿåï¼Œè„‚è‚ªç»„ç»‡å†…çš„è¡€æµé‡è¾¾åˆ°æœ€é«˜ï¼Œå¦‚æœé—´æ–­è¿åŠ¨ï¼Œå…¶è„‚è‚ªç»„ç»‡è¡€æµé‡æœ€é«˜æµ“åº¦ä»å¯æŒç»­6å°æ—¶ã€‚</p><p>å¦‚æœä½ èƒ½åšæŒï¼Œæœ€å¥½è¶çƒ­æ‰“é“ï¼Œè¿ç»­è¿åŠ¨ 30 åˆ†é’Ÿï¼Œè¿™æ ·å¯ä»¥çƒ§è„‚è‚ªé•¿è¾¾ 6 å°æ—¶ã€‚ä½†æ˜¯è¿åŠ¨æ—¶é•¿ä¹Ÿå¹¶ä¸éœ€è¦å¤ªé•¿ï¼Œç ”ç©¶è¡¨æ˜ï¼Œè¿åŠ¨æ—¶é•¿å³ä½¿è¶…è¿‡ 30 åˆ†é’Ÿï¼Œè„‚è‚ªä¹Ÿåªèƒ½ç‡ƒçƒ§ 6 å°æ—¶ã€‚</p><p>å¦å¤–è¿åŠ¨æœ€å¥½æ˜¯æ¯å¤©éƒ½èƒ½åšæŒåšï¼Œä¸è¦ä¸‰å¤©æ‰“é±¼ä¸¤å¤©æ™’ç½‘ã€‚</p><p>æˆ‘æ¨èç»™å¤§å®¶ä¸¤ç§è¿åŠ¨ï¼Œæˆæœ¬æ¯”è¾ƒä½çš„é‚£ç§ã€‚å³æ­¥è¡Œã€è·‘æ­¥ã€‚</p><h3 id="æ­¥è¡Œ"><a href="#æ­¥è¡Œ" class="headerlink" title="æ­¥è¡Œ"></a>æ­¥è¡Œ</h3><p>æˆ‘ä¹‹å‰ä¸€ç›´æ€€ç–‘æ­¥è¡Œåˆ°åº•èƒ½å¦è®©äººç˜¦èº«ï¼Œåé¢åšæŒäº†ä¸‰ä¸ªæœˆï¼Œå‘ç°æ­¥è¡Œåªè¦åšæŒä¸‹æ¥å¯¹ç˜¦èº«æ˜¯å¤§æœ‰è„¾ç›Šçš„ã€‚</p><p>ä¸‹é¢æ˜¯æˆ‘å¯¹æ­¥è¡Œçš„å¿ƒè·¯å†ç¨‹ã€‚</p><p><img src="/upload/images/2020/08/15/4.png"></p><p>æ¯å¤©åšæŒæœ€å°‘ 30 åˆ†é’Ÿçš„æ­¥è¡Œï¼Œåˆ©ç”¨åˆé¤æˆ–è€…æ™šé¤åæ•£æ­¥ï¼Œä¸‹ç­å›å®¶èµ°ä¸€æ®µç­‰æ—¶é—´æ®µæ¥æ­¥è¡Œã€‚æ¯èµ°1å…¬é‡Œï¼Œå¤§æ¦‚æ¶ˆè€—æ‰50åƒå¡çš„çƒ­é‡ã€‚</p><p>æˆ‘ç€é‡è¯´ä¸€ä¸‹è°ƒæ•´éƒ¨åˆ†ã€‚</p><p>åˆšå¼€å§‹ï¼Œèµ°è·¯æ²¡æœ‰æ³¨æ„è‡ªå·±çš„èµ°å§¿ï¼Œåé¢é€šè¿‡æœ‹å‹å’Œä¹¦ç±çš„æŒ‡å¯¼ï¼Œæˆ‘åšå‡ºäº†å‡ ä¸ªæ”¹å˜ã€‚</p><p>1ã€å°½é‡å¤§æ­¥èµ°ï¼Œä½†æ˜¯æ³¨æ„é‡åŠ›è€Œè¡Œï¼›</p><p>2ã€åè„šè·Ÿå…ˆç€åœ°ï¼Œä¸è¦è®©è„šæŒå…ˆç€åœ°ï¼›</p><p>3ã€æ”¶è…¹ï¼Œæ­£å¸¸å‘¼å¸ä¸è¦æ†‹æ°”ï¼›</p><p>4ã€å°½é‡æ‘†åŠ¨è‡ªå·±çš„åŒè‡‚ï¼Œä¸»è¦ä¸è¦æ‰“ç€è·¯äººï¼›</p><p>5ã€è…°ç›´èµ·æ¥ï¼Œæè‡€ï¼Œç›®è§†å‰æ–¹ï¼›</p><p>6ã€æ¯æ¬¡è‡³å°‘è¦èµ° 30 åˆ†é’Ÿæˆ–è€…ä»¥ä¸Šæ‰æœ‰æ•ˆï¼Œè¿™ä¸ªæ—¶å€™è„‚è‚ªæ‰ä¼šæ…¢æ…¢å¼€å§‹ç‡ƒçƒ§ï¼›</p><p>å¯¹äº†ï¼ŒæŠ¬å¤´çœ‹çº¢ç»¿ç¯ğŸš¦ï¼Œä¸è¦åªå¿™ç€èµ°è·¯ï¼Œå®‰å…¨ç¬¬ä¸€ï¼</p><h3 id="è·‘æ­¥"><a href="#è·‘æ­¥" class="headerlink" title="è·‘æ­¥"></a>è·‘æ­¥</h3><p>å¦‚æœä½ ç°åœ¨æ¯”è¾ƒèƒ–ï¼Œè¿˜æ˜¯å»ºè®®ä¸è¦è·‘æ­¥ï¼Œå¯¹è†ç›–çš„ä¼¤å®³æœ‰ç‚¹å¤§ã€‚</p><p>æˆ‘è¿™é‡Œè¯´çš„ç˜¦èº«è·‘æ­¥æŒ‡çš„æ˜¯æ…¢è·‘ï¼Œæ¯”å¦‚ä½ æ­¥è¡Œä¸€å…¬é‡Œéœ€è¦12åˆ†é’Ÿï¼Œé‚£ä¹ˆè·‘æ­¥ä¸€å…¬é‡Œç”¨7~8åˆ†é’Ÿå°±å¯ä»¥äº†ã€‚</p><p>æ…¢è·‘æ›´æœ‰åŠ©äºç˜¦èº«å‡è„‚ï¼Œå¿«è·‘å¯ä»¥è®©ä½ å¢è‚Œã€‚</p><p>æˆ‘ç°åœ¨ä¸€å‘¨ä¸€èˆ¬è·‘2~3æ¬¡æ­¥ï¼Œæ¯æ¬¡2å…¬é‡Œå·¦å³ï¼Œç­‰ä½“é‡å†ä¸‹æ¥ä¸€ç‚¹åå†å¢å¤§è·‘æ­¥çš„å¼ºåº¦ã€‚æ¯æ…¢è·‘1å…¬é‡Œçš„æ­¥ï¼Œå¤§æ¦‚æ¶ˆè€—æ‰80åƒå¡çš„çƒ­é‡ã€‚</p><p>å¯ä»¥æ‰¾ä¸ªå…¬å›­è·‘æ­¥ï¼Œç©ºæ°”å’Œæ°›å›´ä¼šå¥½ç‚¹æ›´èƒ½è®©ä½ åšæŒä¸‹æ¥ï¼Œå¦‚æœæœ‰æ¡ä»¶å¯ä»¥å¸¦ä¸Šå…¥è€³å¼çš„è“ç‰™è€³æœºï¼Œå¬ç€éŸ³ä¹æ”¾é£è‡ªæˆ‘ã€‚</p><p>è¿åŠ¨æ—¶ä½“å†…æ°´ä¸¢å¤±åŠ å¿«ï¼Œå¦‚æœä¸åŠæ—¶è¡¥å……ä¼šå¼•èµ·æ°´ä¸è¶³ã€‚åœ¨è¿åŠ¨å¼ºåº¦è¾ƒå¤§æ—¶ï¼Œè¦æ³¨æ„è¿åŠ¨ä¸­æ°´å’ŒçŸ¿ç‰©è´¨çš„åŒæ—¶è¡¥å……ï¼Œè¿åŠ¨åï¼Œåº”æ ¹æ®éœ€è¦åŠæ—¶è¡¥å……è¶³é‡çš„é¥®æ°´ã€‚</p><p>ç™»å±±ä¹Ÿæ˜¯ä¸€é¡¹å¾ˆä¸é”™çš„è¿åŠ¨ï¼Œæ ¹æ®è‡ªå·±çš„æƒ…å†µå¯ä»¥æ¯ä¸ªæœˆå¯ä»¥è¿›è¡Œä¸€æ¬¡ç™»å±±è¿åŠ¨ï¼Œèµ°è¿›å¤§è‡ªç„¶å‘¼å¸æ–°é²œç©ºæ°”ï¼Œè¿˜èƒ½é”»ç‚¼è‡ªå·±çš„æ„å¿—ã€‚</p><p>åˆ‡è®°æ¯æ¬¡è¿åŠ¨å‰åï¼Œä¸€å®šè¦è¿›è¡Œé€‚é‡çš„æ‹‰ä¼¸è¿åŠ¨ï¼Œé˜²æ­¢è‚Œè‚‰è¿‡åé…¸ç—›å½±å“æ¥ä¸‹æ¥çš„è¿åŠ¨ã€‚</p><p>å‡è‚¥ä¸ä»…ä»…æ˜¯æ§åˆ¶å¡è·¯é‡Œï¼Œæ›´é‡è¦çš„æ˜¯ä»æ ¹æœ¬ä¸Šè§£å†³è‚¥èƒ–é—®é¢˜ï¼Œæ”¹å˜æ˜“èƒ–ä½“è´¨ï¼Œåˆ«è®©è„‚è‚ªç¼ ä¸Šä½ ã€‚å‡è‚¥çš„çœŸç†å°±æ˜¯ç®¡ä½å˜´è¿ˆå¼€è…¿ï¼Œé€šè¿‡å‡å°‘æ‘„å…¥ã€å¢åŠ èƒ½è€—ä¸¤æ–¹é¢å®ç°ï¼Œä¹Ÿå°±æ˜¯è¯´å¼€æºèŠ‚æµæ‰èƒ½å®ç°è¶³å¤Ÿå¤šçš„çƒ­é‡äºç©ºã€‚</p><p>è‚¥è‚‰ä¸æ˜¯ä¸€å¤©çªç„¶é•¿èµ·æ¥çš„ï¼Œåˆ‡è®°ä¸è¦å¦„æƒ³ä¸€å¤©å°±æŠŠè‚¥è‚‰ç»™å‡ä¸‹å»ï¼Œå¾ªåºæ¸è¿›çš„å‡è‚¥æ‰æ˜¯ç‹é“ï¼Œæ‰¾åˆ°é€‚åˆè‡ªå·±çš„å‡è‚¥æ–¹æ³•æ‰èƒ½äº‹åŠåŠŸå€ï¼</p><hr><p><strong>çœŸæ­£è‡ªå¾‹çš„äººï¼Œæ˜¯ä¸ä¼šæŠŠè‡ªå¾‹æŒ‚å˜´è¾¹çš„~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¿åŠ¨ é¥®é£Ÿ å¥åº· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡: ConfigurationPropertiesé…ç½®</title>
      <link href="/2020/08/02/%E5%BE%AE%E6%9C%8D%E5%8A%A1-ConfigurationProperties%E9%85%8D%E7%BD%AE/"/>
      <url>/2020/08/02/%E5%BE%AE%E6%9C%8D%E5%8A%A1-ConfigurationProperties%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æˆ‘ä»¬åœ¨å¼€å‘çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šé‡åˆ°è¿™æ ·çš„åœºæ™¯ï¼š</p><blockquote><p>å˜é‡å¸Œæœ›èƒ½å¤Ÿè¢«åœ¨é…ç½®æ–‡ä»¶ä¸­åŠ¨æ€é…ç½®ï¼Œåªè¦ä¿®æ”¹è¿™äº›é…ç½®ï¼Œå¯¹åº”çš„ Java ç±»å¯¹è±¡çš„å˜é‡å€¼å°±å¯ä»¥æ”¹å˜ï¼Œä»è€Œæ”¹å˜ä»£ç çš„è¡Œä¸ºã€‚è¿™æ ·æˆ‘ä»¬é€šè¿‡ä¿®æ”¹é…ç½®å°±å¯ä»¥æ»¡è¶³ä¸šåŠ¡è¯‰æ±‚ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹ä¸€è¡Œä»£ç ã€‚</p></blockquote><p>åœ¨ SpringBoot ä¸­ï¼Œå¯ä»¥é€šè¿‡ <code>@ConfigurationProperties</code> å’Œ <code>@Values</code> ä¸¤ä¸ªæ³¨è§£é…åˆ properties æ–‡ä»¶è¾¾åˆ°ä¸Šè¿°ç›®çš„ã€‚</p><p>æ¯”å¦‚æˆ‘çš„ <code>application.properties</code> æ–‡ä»¶é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ------------------------</span></span><br><span class="line"><span class="comment"># Swagger config</span></span><br><span class="line"><span class="comment"># ------------------------</span></span><br><span class="line"><span class="attr">msconfig.swagger.enableSwagger</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># ------------------------</span></span><br><span class="line"><span class="comment"># Security config</span></span><br><span class="line"><span class="comment"># ------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="attr">msconfig.security.enableCSRF</span>=<span class="string">false</span></span><br><span class="line"><span class="attr">msconfig.security.defToken</span>=<span class="string">&quot;token-xx-yy-kk-token-end&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">msconfig.security.testList[0]</span>=<span class="string">&quot;list0&quot;</span></span><br><span class="line"><span class="attr">msconfig.security.testList[1]</span>=<span class="string">&quot;list1&quot;</span></span><br><span class="line"><span class="attr">msconfig.security.testList[2]</span>=<span class="string">&quot;list2&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">msconfig.security.testMap.KeyTest</span>=<span class="string">&quot;map-key&quot;</span></span><br><span class="line"><span class="attr">msconfig.security.testMap.ValueTest</span>=<span class="string">&quot;map-value&quot;</span></span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œé€šè¿‡ <code>@ConfigurationProperties</code> å’Œ <code>@Values</code> æ¥åˆ†åˆ«è¯»å–å¯¹åº”çš„é…ç½®ã€‚</p><p>æœ¬æ–‡æ¶‰åŠçš„ä»£ç éƒ½å·²ç»æ›´æ–°åˆ° <a href="https://github.com/veryitman/MSTutorial/tree/veryitman-feature">Github å·¥ç¨‹</a> ä¸­äº†ï¼Œå¤§å®¶å¯ä»¥ä¸‹è½½æŸ¥çœ‹ã€‚</p><p><strong>å…³äºå¾®æœåŠ¡çš„ç›¸å…³æ–‡ç« ç›®å½•</strong>ï¼Œå¯ä»¥â˜ <a href="%5Bhttp://www.veryitman.com/2019/05/28/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%A1%B9%E7%9B%AE%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/%5D(http://www.veryitman.com/2019/05/28/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%A1%B9%E7%9B%AE%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/)">ç‚¹æˆ‘</a> æŸ¥çœ‹æ›´å¤šå†…å®¹ã€‚</p><h2 id="ConfigurationProperties"><a href="#ConfigurationProperties" class="headerlink" title="ConfigurationProperties"></a>ConfigurationProperties</h2><p>å¯¹åº”çš„ï¼Œæ–°å»ºä¸¤ä¸ªå®ä½“ç±»ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2020/08/02/1.png"></p><p>å®ä½“ç±» <code>MSSecurityPropertyConfigModel</code> çš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"><span class="keyword">import</span> lombok.Setter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;msconfig.security&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSSecurityPropertyConfigModel</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> enableCSRF;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String defToken;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Listçš„é…ç½®</span></span><br><span class="line">    <span class="keyword">private</span> List testList;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Mapçš„é…ç½®</span></span><br><span class="line">    <span class="keyword">private</span> Map testMap;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¿™é‡Œéœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ä¸ªé—®é¢˜</strong>ï¼š</p><p>1ã€å¿…é¡»æä¾› setter æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨äº† <code>lombok</code>ï¼›</p><p>2ã€å¿…é¡»ä½¿ç”¨ <code>@Component</code> æ³¨è§£ï¼Œæ ‡æ³¨åœ¨å®ä½“ç±»ä¸Šé¢ï¼›</p><p>3ã€åœ¨ <code>@ConfigurationProperties</code> çš„ <code>prefix</code> ä¸­å¿…é¡»å’Œé…ç½®æ–‡ä»¶å‘½åä¿æŒä¸€è‡´ï¼›</p><p>4ã€éœ€è¦åœ¨ç±»ä¸ŠåŠ ä¸Š <code>@Component</code> æ³¨è§£ï¼›</p><p>å…³äº <code>MSSwaggerPropertyConfigModel</code> å¤§å®¶å¯ä»¥è‡ªè¡ŒæŸ¥çœ‹ä»£ç ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</p><p>å†™ä¸ªæµ‹è¯•ç±»ï¼ŒéªŒè¯ä¸€ä¸‹é…ç½®ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSPropertyConfigTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    MSSwaggerPropertyConfigModel swaggerPropertyConfigModel;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    MSSecurityPropertyConfigModel securityPropertyConfigModel;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(MSPropertyConfigTests.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">primitiveDataConfig</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">enableSwagger</span> <span class="operator">=</span> swaggerPropertyConfigModel.isEnableSwagger();</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">enableCSRF</span> <span class="operator">=</span> securityPropertyConfigModel.isEnableCSRF();</span><br><span class="line"></span><br><span class="line">        logger.info(<span class="string">&quot;primitiveDataConfig-enableSwagger: &quot;</span> + enableSwagger + <span class="string">&quot;, enableCSRF: &quot;</span> + enableCSRF);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">defToken</span> <span class="operator">=</span> securityPropertyConfigModel.getDefToken();</span><br><span class="line">        logger.info(<span class="string">&quot;securityPropertyConfigModel deftoken: &quot;</span> + defToken);</span><br><span class="line"></span><br><span class="line">        <span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> securityPropertyConfigModel.getTestList();</span><br><span class="line">        <span class="keyword">for</span> (Object v : list) &#123;</span><br><span class="line">            logger.info(<span class="string">&quot;securityPropertyConfigModel value: &quot;</span> + v);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> securityPropertyConfigModel.getTestMap();</span><br><span class="line">        logger.info(<span class="string">&quot;securityPropertyConfigModel map: &quot;</span> + map);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œè¯¥æµ‹è¯•æ–¹æ³•ï¼Œå¾—åˆ°å¦‚ä¸‹çš„è¾“å‡ºå†…å®¹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">primitiveDataConfig-enableSwagger: <span class="literal">true</span>, enableCSRF: <span class="literal">false</span></span><br><span class="line">securityPropertyConfigModel deftoken: <span class="string">&quot;token-xx-yy-kk-token-end&quot;</span></span><br><span class="line">securityPropertyConfigModel value: <span class="string">&quot;list0&quot;</span></span><br><span class="line">securityPropertyConfigModel value: <span class="string">&quot;list1&quot;</span></span><br><span class="line">securityPropertyConfigModel value: <span class="string">&quot;list2&quot;</span></span><br><span class="line">securityPropertyConfigModel map: &#123;KeyTest=<span class="string">&quot;map-key&quot;</span>, ValueTest=<span class="string">&quot;map-value&quot;</span>&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæ‚¨åœ¨ä½¿ç”¨ <code>@ConfigurationProperties</code> æ³¨è§£è¿‡ç¨‹ä¸­ï¼Œæç¤ºå¦‚ä¸‹é”™è¯¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â€œSpring Boot Configuration Annotation Processor not found in classpath â€</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶éœ€è¦åœ¨ä½ çš„ <code>pom.xml</code> æ–‡ä»¶ä¸­å¼•è¿› <code>configuration-processor</code> ä¾èµ–å³å¯è§£å†³ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--ConfigurationProperties--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Value"><a href="#Value" class="headerlink" title="Value"></a>Value</h2><p>ä½¿ç”¨ <code>@Values</code> æ³¨è§£å¯ä»¥ç›´æ¥ä½œç”¨åˆ°æŸä¸ªç±»çš„æŸä¸ªå­—æ®µä¸Šé¢ï¼Œä½¿ç”¨ä¸Šé¢æ¯”è¾ƒæ–¹ä¾¿ã€‚</p><p>å¯¹äºè¯»å–é›†åˆçš„æ–¹æ³•è·Ÿ <code>@ConfigurationProperties</code> æ³¨è§£æœ‰ç‚¹ä¸åŒã€‚</p><p>åœ¨ <code>application.properties</code> æ–‡ä»¶ä¸­å¢åŠ  <code>testList1</code> å’Œ <code>testMap1</code> é…ç½®å¦‚ä¸‹:</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ------------------------</span></span><br><span class="line"><span class="comment"># Security config</span></span><br><span class="line"><span class="comment"># ------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="attr">msconfig.security.enableCSRF</span>=<span class="string">false</span></span><br><span class="line"><span class="attr">msconfig.security.defToken</span>=<span class="string">&quot;token-xx-yy-kk-token-end&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">msconfig.security.testList1</span>=<span class="string">list0,list1,list2</span></span><br><span class="line"><span class="attr">msconfig.security.testMap1</span>=<span class="string">&#123;name:&quot;map-key&quot;, age:20&#125;</span></span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šåœ¨é…ç½®æ–‡ä»¶ä¸­çš„ <code>testList1</code> å’Œ <code>testMap1</code> é…ç½®æ ¼å¼å’Œä¹‹å‰çš„ä¸ä¸€æ ·ï¼Œå¦åˆ™è§£æä¼šæŠ¥é”™ã€‚</p><p>æµ‹è¯•ç±»ä¸­éªŒè¯ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼Œæ³¨æ„ <code>@Values</code> æ³¨è§£å¯¹é›†åˆçš„ä¹¦å†™æ ¼å¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Value(&quot;$&#123;msconfig.security.enableCSRF&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> geEnableCSRF;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value(&quot;$&#123;msconfig.security.defToken&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String defUserToken;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value(&quot;#&#123;&#x27;$&#123;msconfig.security.testList1&#125;&#x27;.split(&#x27;,&#x27;)&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> List list1;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value(&quot;#&#123;$&#123;msconfig.security.testMap1&#125;&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> Map map1;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">primitiveDataConfig</span><span class="params">()</span> &#123;</span><br><span class="line">    logger.info(<span class="string">&quot;annotation value. geEnableCSRF: &quot;</span> + geEnableCSRF);</span><br><span class="line">    logger.info(<span class="string">&quot;annotation value. defUserToken: &quot;</span> + defUserToken);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Object v : list1) &#123;</span><br><span class="line">        logger.info(<span class="string">&quot;annotation value. list: &quot;</span> + v);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    logger.info(<span class="string">&quot;annotation value. map: &quot;</span> + map1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯»å–ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">annotation value. geEnableCSRF: <span class="literal">false</span></span><br><span class="line">annotation value. defUserToken: <span class="string">&quot;token-xx-yy-kk-token-end&quot;</span></span><br><span class="line">annotation value. list: list0</span><br><span class="line">annotation value. list: list1</span><br><span class="line">annotation value. list: list2</span><br><span class="line">annotation value. map: &#123;name=map-key, age=<span class="number">20</span>&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†  <code>@ConfigurationProperties</code> å’Œ <code>@Values</code> è¿™ä¸¤ä¸ªæ³¨è§£é…åˆä½¿ç”¨ã€‚</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">msconfig.security.alias</span>=<span class="string">&quot;play-game&quot;</span></span><br></pre></td></tr></table></figure><p>åœ¨ä»£ç ä¸­é‡æ–°å®šä¹‰å˜é‡åç§°ä¸º <code>aliasPlayGame</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>@Values</code> å®šä½å®é™…é…ç½®çš„å˜é‡åç§°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;msconfig.security&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSSecurityPropertyConfigModel</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> enableCSRF;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String defToken;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List testList;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map testMap;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å’Œ ConfigurationProperties ä¸€èµ·ä½¿ç”¨</span></span><br><span class="line">    <span class="meta">@Value(&quot;msconfig.security.alias&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String aliasPlayGame;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p><strong>ä½ ä»¥ä¸ºçš„ä¸ä¸€å®šæ˜¯ä½ ä»¥ä¸ºçš„</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¾®æœåŠ¡ ConfigurationProperties SpringBoot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ngrokè®©æœåŠ¡è¿‘åœ¨å’«å°º</title>
      <link href="/2020/07/16/ngrok%E8%AE%A9%E6%9C%8D%E5%8A%A1%E8%BF%91%E5%9C%A8%E5%92%AB%E5%B0%BA/"/>
      <url>/2020/07/16/ngrok%E8%AE%A9%E6%9C%8D%E5%8A%A1%E8%BF%91%E5%9C%A8%E5%92%AB%E5%B0%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æœ€è¿‘åœ¨å’Œä¸€ä¸ªç¬¬ä¸‰æ–¹æœåŠ¡åšè”è°ƒï¼Œå³æˆ‘æ–¹æœåŠ¡è°ƒç”¨ç¬¬ä¸‰æ–¹çš„æœåŠ¡ API-Aï¼Œç„¶åç¬¬ä¸‰æ–¹æŠŠç»“æœå›è°ƒç»™æˆ‘æ–¹æœåŠ¡ API-Bï¼Œå› ä¸ºæˆ‘æ˜¯åœ¨æœ¬åœ°æ­å»ºçš„ <code>SpringBoot</code> æœåŠ¡ï¼Œåˆæ¶‰åŠåˆ°é¢‘ç¹çš„æ”¹åŠ¨ï¼Œæ‰€ä»¥å°±æ²¡æœ‰éƒ¨ç½²åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸Šé¢ã€‚</p><p>API-A å›è°ƒåˆ° API-B éœ€è¦æˆ‘æ–¹æœåŠ¡èƒ½è¢«å¤–ç½‘è®¿é—®ï¼Œå¦‚æ˜¯æˆ‘å°±ä½¿ç”¨äº† <code>ngrok</code> è¿™ä¸ªå·¥å…·è¿›è¡Œäº†å†…ç½‘ç©¿é€ï¼Œè®©ç¬¬ä¸‰æ–¹æœåŠ¡å¾ˆå®¹æ˜“çš„å°±è®¿é—®åˆ°æˆ‘çš„æœ¬åœ°æœåŠ¡ã€‚</p><blockquote><p>æ‰€è°“çš„å†…ç½‘ç©¿é€ï¼Œä¹Ÿå³ NAT ç©¿é€ï¼Œè¿›è¡Œ NAT ç©¿é€æ˜¯ä¸ºäº†ä½¿å…·æœ‰æŸä¸€ä¸ªç‰¹å®šæº IP åœ°å€å’Œæºç«¯å£å·çš„æ•°æ®åŒ…ä¸è¢« NAT è®¾å¤‡å±è”½è€Œæ­£ç¡®è·¯ç”±åˆ°å†…ç½‘ä¸»æœºã€‚</p></blockquote><p>ä¸‹é¢å…·ä½“è®²ä¸€è®²è¯¥å·¥å…·çš„å®‰è£…ã€é…ç½®å’Œä½¿ç”¨ã€‚</p><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p><strong>Step1ï¼šä¸‹è½½å·¥å…·</strong></p><p>ç‚¹å‡» <a href="https://ngrok.com/download">è¿™é‡Œ</a> å¯ä»¥è¿›å…¥ä¸‹è½½é¡µé¢æ ¹æ®è‡ªå·±æ‰€åœ¨çš„å¹³å°é€‰æ‹©ä¸‹è½½ <code>ngrok</code>ã€‚</p><p>ç›®å‰ <code>ngrok</code> æ”¯æŒ Mac OS Xã€Linux Mac (32-bit) ã€Windows (32-bit)ã€Windows (64-bit)ã€ Linux (ARM)ã€ Linux (ARM64) ã€Linux (32-bit) ã€FreeBSD (64-Bit) ã€FreeBSD (32-bit) ç­‰æ“ä½œç³»ç»Ÿã€‚</p><p>æˆ‘ä½¿ç”¨çš„æ˜¯ Windows ç³»ç»Ÿï¼Œä¸‹é¢æˆ‘ä»¥æ­¤ç³»ç»Ÿå®‰è£…é…ç½®åšä¸€ä¸ªè¯´æ˜ã€‚</p><p>ä¸‹è½½å®Œæˆåï¼Œè§£å‹åˆ°ä½ çš„ç£ç›˜ä»»æ„ç›®å½•ï¼Œå¦‚æˆ‘çš„æ”¾åˆ°äº†ä¸‹é¢ç›®å½•ä¸­ï¼š</p><p><img src="/upload/images/2020/07/16/1.png"></p><p><strong>Step2ï¼šé…ç½® ngrok</strong></p><p>é…ç½® ngrok éœ€è¦åœ¨å…¶å®˜ç½‘æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œç‚¹å‡» <a href="https://dashboard.ngrok.com/signup">Sign UP</a> å®Œæˆæ³¨å†Œå³å¯ã€‚</p><p>æ³¨å†Œå®Œæˆä¹‹åè¿›å…¥ <a href="https://dashboard.ngrok.com/get-started/setup">æ§åˆ¶å°</a>ï¼Œè·å–ä½ çš„ <a href="https://dashboard.ngrok.com/auth/your-authtoken">Your Authtoken</a>ï¼Œå¤åˆ¶ä¸€ä¸‹å³å¯åé¢æœ‰ç”¨ã€‚</p><p>æ‰“å¼€ Windows è‡ªå¸¦çš„å‘½ä»¤è¡Œå·¥å…·ï¼ˆCMDï¼Œæ›¹å­Ÿå¾·ï¼‰ï¼Œæ‰§è¡Œä¸‹é¢</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./ngrok.exe authtoken &#x27;your-authtoken&#x27;</span><br></pre></td></tr></table></figure><p>å®Œæˆåï¼Œä¼šåœ¨ <code>C:\Users\your-name\.ngrok2\ngrok.yml</code> æ–‡ä»¶ä¸­æ³¨å†ŒæˆåŠŸã€‚</p><p><strong>Step3ï¼šå¯åŠ¨ ngrok</strong></p><p>æˆ‘çš„æœåŠ¡ç«¯å£å·æ˜¯ <code>8080</code>ï¼Œ æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./ngrok.exe http 8080</span><br></pre></td></tr></table></figure><p>å¯ä»¥åœ¨å‘½ä»¤è¡Œçœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Session Status                online</span><br><span class="line">Account                       name (Plan: Free)</span><br><span class="line">Version                       2.3.35</span><br><span class="line">Region                        United States (us)</span><br><span class="line">Web Interface                 http://127.0.0.1:4040</span><br><span class="line">Forwarding                    http://1a9d2e7e1e2d.ngrok.io -&gt; http://localhost:8080</span><br><span class="line">Forwarding                    https://1a9d2e7e1e2d.ngrok.io -&gt; http://localhost:8080</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è®¿é—® <code>SpringBoot</code> çš„æœåŠ¡ APIï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://1a9d2e7e1e2d.ngrok.io/pay/callback</span><br></pre></td></tr></table></figure><p>æˆ–è€…è®¿é—® HTTPS ä¹Ÿå¯ä»¥çš„ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://1a9d2e7e1e2d.ngrok.io/pay/callback</span><br></pre></td></tr></table></figure><p>åœ¨å¤–ç½‘è®¿é—®è¿™ä¸ªæ¥å£ä¹Ÿæ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚</p><h2 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h2><p>å†…ç½‘ç©¿é€å·¥å…· <code>ngrok</code> è¿˜æœ‰å…¶ä»–ä½¿ç”¨åœºæ™¯ã€‚</p><ul><li><p>å¤–ç½‘è¿æ¥è‡ªå·±çš„å†…ç½‘æœåŠ¡å™¨ï¼Œåœ¨å¤–ç½‘æ¼”ç¤ºå†…ç½‘ WEB ç«™ç‚¹ï¼›</p></li><li><p>æ— éœ€éƒ¨ç½²å¼€å‘çš„æœåŠ¡åˆ°å¤–ç½‘æœåŠ¡å™¨ï¼Œå¿«é€Ÿè°ƒè¯•æœ¬åœ°ç¨‹åºï¼Œæ¯”å¦‚å¾®ä¿¡å…¬ä¼—å·çš„å¼€å‘ç­‰ï¼›</p></li><li><p><code>ngrok</code> æ”¯æŒ HTTPã€HTTPS åè®®ç«™ç‚¹ï¼ŒHTTP åè®®ç«™ç‚¹ç›´æ¥å‡çº§ä¸º HTTPS ç«™ç‚¹ï¼›</p></li><li><p><code>ngrok</code> æ”¯æŒ TCPï¼ŒUDP åè®®ç«¯å£è½¬å‘ã€‚</p></li><li><p><code>ngrok</code> æ”¯æŒæ•°æ®åº“ã€SSHã€è¿œç¨‹æ¡Œé¢ã€ç½‘ç»œæ‘„åƒå¤´ç­‰ç­‰å¼€æ”¾åˆ°å¤–ç½‘å¯ä»¥è®¿é—®ï¼›</p></li></ul><p>è¿˜æœ‰å…¶ä»–çš„å†…ç½‘ç©¿é€å·¥å…·ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œæœç´¢ã€‚</p><hr><p><strong>ä½ ä»¥ä¸ºçš„ä¸ä¸€å®šæ˜¯ä½ ä»¥ä¸ºçš„</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ngrok å†…ç½‘ç©¿é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡-Androidå®¢æˆ·ç«¯: å®ç°æ³¨å†Œå’Œç™»å½•</title>
      <link href="/2020/06/20/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Android%E5%AE%A2%E6%88%B7%E7%AB%AF-%E5%AE%9E%E7%8E%B0%E6%B3%A8%E5%86%8C%E5%92%8C%E7%99%BB%E5%BD%95/"/>
      <url>/2020/06/20/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Android%E5%AE%A2%E6%88%B7%E7%AB%AF-%E5%AE%9E%E7%8E%B0%E6%B3%A8%E5%86%8C%E5%92%8C%E7%99%BB%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åœ¨ <a href="http://www.veryitman.com/2019/05/28/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%A1%B9%E7%9B%AE%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/">å¾®æœåŠ¡é¡¹ç›®ç³»åˆ—æ–‡ç« </a> ä¸­è·Ÿå¤§å®¶ä¸€èµ·å­¦ä¹ äº†å¦‚ä½•æ­å»ºã€éƒ¨ç½²ï¼ˆæœ¬æœºå’Œè¿œç¨‹éƒ¨ç½²ã€çƒ­éƒ¨ç½²ã€Nginxç­‰ï¼‰ã€è¿è¡Œä¸€ä¸ª <code>SpringBoot</code> æœåŠ¡ä»¥åŠ <code>MySQL</code> æ•°æ®åº“çš„æ“ä½œã€æ–‡æ¡£ï¼ˆSwaggerï¼‰çš„ç”Ÿæˆç­‰æ“ä½œï¼Œå®¢æˆ·ç«¯é‡‡ç”¨æµè§ˆå™¨çš„æ–¹å¼å®ç°äº†ç”¨æˆ·æ³¨å†Œã€ç™»å½•çš„æµç¨‹ã€‚æ ¹æ® <a href="http://www.veryitman.com/2019/07/03/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E7%AB%8B%E5%BF%97%E5%81%9A%E4%B8%AA%E4%BC%9F%E5%A4%A7%E7%9A%84%E9%A1%B9%E7%9B%AE/">å¾®æœåŠ¡-ç«‹å¿—åšä¸ªä¼Ÿå¤§çš„é¡¹ç›®</a> ç«‹ä¸‹çš„ã€èª“è¨€ã€‘å¯ä»¥å¾ªåºæ¸è¿›çš„å®ç°æˆ‘ä»¬ä¼Ÿå¤§çš„ç†æƒ³äº†ï¼Œä»Šå¤©æˆ‘ä»¬æ­£å¼è¿›å…¥ Android å®¢æˆ·ç«¯çš„å­¦ä¹ ï¼Œå¸Œæœ›å¯¹å¾®æœåŠ¡ã€Android å¼€å‘æ„Ÿå…´è¶£çš„åŒå­¦æœ‰ç‚¹å¸®åŠ©ã€‚</p><p>å¦‚æœä½ å¯¹ Android ä¸äº†è§£ï¼Œå»ºè®®å…ˆå­¦ä¹  Google å®˜ç½‘å…³äº Android å¼€å‘çš„å…¥é—¨çŸ¥è¯†ï¼Œæœ€èµ·ç ä½ èƒ½ç”¨ <code>Android Studio</code> è·‘èµ·ä¸€ä¸ªå·¥ç¨‹ã€‚å¦‚æœä½ å¯¹ Java ä¹Ÿä¸äº†è§£æˆ–è€…å‹æ ¹éƒ½æ²¡æœ‰å­¦ä¹ è¿‡ Javaï¼Œé‚£ä¹ˆä½ å¯èƒ½è¦åŠ æ²¹äº†äº‰å–ç”¨ä¸€å‘¨çš„æ—¶é—´ææ‡‚ Java è¯­æ³•äº†ï¼Œç„¶ååœ¨ Android å­¦ä¹ çš„è¿‡ç¨‹ä¸­å†å»æ·±å…¥ Java è¯­è¨€çš„å­¦ä¹ ã€‚å½“ç„¶äº†ä½ ä¼š <code>Kotlin</code> ç¼–ç¨‹è¯­è¨€ä¹Ÿå¯ä»¥ã€‚è¿™é‡Œæƒ³å‘Šè¯‰å¤§å®¶ï¼Œä»»ä½•ä¸€é—¨ç¼–ç¨‹è¯­è¨€æƒ³ç²¾é€šéœ€è¦æ¯”è¾ƒé•¿çš„æ—¶é—´ï¼Œä½†æ˜¯åˆçº§å…¥é—¨èƒ½å†™ç®€å•çš„ä»£ç åªè¦ç”¨å¿ƒä¸åº”è¯¥è¶…è¿‡ä¸€å‘¨ã€‚ä½ åªéœ€è¦å…‹æœå†…å¿ƒçš„ææƒ§ç¬ƒå®šè‡ªå·±ä¸€å®šè¡Œï¼Œé‚£ä¹ˆå¾ˆå¿«ä½ å°±å…¥é—¨äº†ã€‚</p><p><strong>é˜…è¯»ä¸‹é¢çš„å†…å®¹éœ€è¦ä½ </strong>ï¼š</p><ul><li>çœ‹è¿‡ <a href="http://www.veryitman.com/2019/05/28/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%A1%B9%E7%9B%AE%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/">å¾®æœåŠ¡é¡¹ç›®ç³»åˆ—æ–‡ç« </a> ä¸­çš„æ–‡ç« ï¼Œä¸è¦æ±‚éƒ½çœ‹è¿‡è‡³å°‘å…³äºå¦‚ä½•ä½¿ç”¨ <code>SpringBoot</code> çš„éƒ¨åˆ†çœ‹è¿‡ï¼›</li><li>ä¼š Java ç¼–ç¨‹æˆ–è€… Kotlin ç¼–ç¨‹ï¼Œå…¥é—¨çš„çŸ¥è¯†å³å¯ï¼›</li><li>äº†è§£ Android å¼€å‘ï¼ŒçŸ¥é“å¦‚ä½•ä½¿ç”¨ <code>Android Studio</code> è¿™ä¸ª IDEï¼›</li></ul><p><strong>æœ¬ç¯‡ä¸»è¦å†…å®¹ï¼š</strong></p><ul><li>æ­å»º <code>Android</code> å·¥ç¨‹çš„åŸºæœ¬æ¡†æ¶ï¼›</li><li>å®ç° Android ç«¯çš„ç”¨æˆ·æ³¨å†Œå’Œç™»å½•åŠŸèƒ½ï¼›</li></ul><p>å·¥ç¨‹æºç åœ¨ <a href="https://github.com/veryitman/MSTutorial/tree/veryitman-feature">Github</a> ä¸Šé¢ï¼Œå¤§å®¶å¯ä»¥å»ä¸‹è½½ä¸€èµ·å­¦ä¹ ï¼Œå·¥ç¨‹ç›¸å…³ç›®æ ‡å¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2020/06/20/1.png"></p><p>é¡¹ç›®ç›®å‰åªå®ç°äº†æ³¨å†Œã€ç™»å½•çš„åŠŸèƒ½ï¼Œåç»­ä¼šä¸°å¯Œå…¶å†…å®¹ã€‚</p><h2 id="æ­å»º-Android-å·¥ç¨‹"><a href="#æ­å»º-Android-å·¥ç¨‹" class="headerlink" title="æ­å»º Android å·¥ç¨‹"></a>æ­å»º Android å·¥ç¨‹</h2><p>è¯¥å·¥ç¨‹åç§°ä¸º <code>MSBlog</code>ï¼Œæˆ‘çš„æœ¬æœºç¯å¢ƒå®‰è£…äº†ï¼š</p><ul><li>JDK 1.8ï¼›</li><li>Android Studio 4.0ï¼›</li><li>Android SDK ï¼›</li></ul><p>é¦–å…ˆï¼Œæ‰“å¼€ <code>Android Studio</code>ï¼Œé€‰æ‹© <code>File/New/New Project...</code>ï¼Œæ‰“å¼€ä¸‹é¢è§†å›¾</p><p><img src="/upload/images/2020/06/20/2.png"></p><p>ç´§æ¥ç€ï¼Œç‚¹å‡» <code>Next</code>ï¼Œå¡«å†™ç›¸å…³çš„é¡¹ç›®åç§°å’ŒåŒ…åç­‰ä¿¡æ¯å³å¯ã€‚</p><p>å·¥ç¨‹å¤§è‡´ç»“æ„å¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2020/06/20/3.png"></p><p>åœ¨ <code>com.veryitman.msblog.http</code>ã€<code>com.veryitman.msblog.model</code> è¿™ä¸¤ä¸ªåŒ…ä¸­æ˜¯ç½‘ç»œè¯·æ±‚ã€æ•°æ®æ¨¡å‹ç­‰çš„ Java å®ç°ï¼Œ<code>MZOkHTTPWrapper</code> æ˜¯å¯¹ <code>okhttp</code> çš„å°è£…ã€‚</p><p>è¯¥å·¥ç¨‹ä¸­ï¼Œä½¿ç”¨äº†ä¸¤ä¸ªç¬¬ä¸‰æ–¹åº“åˆ†åˆ«æ˜¯ <code>gson</code>ï¼ˆjsonè§£æç­‰ï¼‰ã€<code>okhttp</code>ï¼ˆHTTPè¯·æ±‚ï¼‰ï¼Œè¯¦ç»†é…ç½®åœ¨ <code>app/build.gradle</code> æ–‡ä»¶ä¸­ã€‚</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">implementation(<span class="string">&quot;com.squareup.okhttp3:okhttp:4.7.2&quot;</span>)</span><br><span class="line">implementation <span class="string">&#x27;com.google.code.gson:gson:2.8.6&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="å®ç°-Android-æ³¨å†Œ"><a href="#å®ç°-Android-æ³¨å†Œ" class="headerlink" title="å®ç° Android æ³¨å†Œ"></a>å®ç° Android æ³¨å†Œ</h2><p>ç”¨æˆ·æ³¨å†Œæ•ˆæœå›¾</p><p><img src="/upload/images/2020/06/20/4.png"></p><p>å¯åŠ¨ <code>SpringBoot</code> æœåŠ¡ï¼Œæ³¨æ„åœ¨ <code>MZHttpUrlModel</code> ä¸­ä¿®æ”¹ä¸€ä¸‹è¿æ¥è¯¥æœåŠ¡çš„ IP åœ°å€ï¼ˆç”¨ä½ è‡ªå·±æœ¬æœºçš„IPï¼‰ã€‚</p><p>ç‚¹å‡» <code>Signup</code>ï¼Œæ ¹æ®ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯è¯·æ±‚æœåŠ¡ç«¯çš„APIå»æ³¨å†Œï¼Œç‚¹å‡» <code>Had Account</code> å»ç™»å½•é¡µé¢ï¼Œç‚¹å‡» <code>Guest</code> ç›´æ¥è¿›å…¥åº”ç”¨ã€‚</p><p>å…·ä½“çš„ä»£ç æ˜¯åœ¨ <code>MZSigninActivity</code> ä¸­å®ç°çš„ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥çœ‹çœ‹æºç ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</p><p>åœ¨è¿›è¡Œç½‘ç»œè¯·æ±‚ä¹‹å‰ï¼Œæ³¨æ„éœ€è¦åœ¨ <code>AndroidManifest.xml</code> æ–‡ä»¶ä¸­æ·»åŠ è®¿é—®ç½‘ç»œçš„æƒé™ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.INTERNET&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="å®ç°-Android-ç™»å½•"><a href="#å®ç°-Android-ç™»å½•" class="headerlink" title="å®ç° Android ç™»å½•"></a>å®ç° Android ç™»å½•</h2><p>ç”¨æˆ·ç™»å½•æ•ˆæœå›¾</p><p><img src="/upload/images/2020/06/20/5.png"></p><p>å…·ä½“çš„ä»£ç æ˜¯åœ¨ <code>MZSignupActivity</code> ä¸­å®ç°çš„ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥çœ‹çœ‹æºç ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</p><p>ç‚¹å‡» <code>Signup</code>ï¼Œæ ¹æ®ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯è¯·æ±‚æœåŠ¡ç«¯çš„APIå»ç™»å½•ã€‚</p><p>è¿›å…¥ä¸»ç•Œé¢åï¼Œå°±å¯ä»¥çœ‹åˆ°å››ä¸ªTabé¡µé¢ï¼Œåˆ†åˆ«æ˜¯ä¸»é¡µã€åˆ†ç±»ã€å¥½å‹ã€ä¸ªäººä¸­å¿ƒã€‚</p><p><img src="/upload/images/2020/06/20/6.png"></p><p>ç›®å‰è¿™å‡ ä¸ªé¡µé¢å°šæœªå®ç°ï¼Œåç»­ä¼šé™†ç»­å®Œæˆã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ–°å»ºä¸€ä¸ª Android å·¥ç¨‹è¿˜ç®—æ˜¯è›®ç®€å•çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œå¸Œæœ›å¤§å®¶èƒ½æŠŠå·¥ç¨‹è·‘èµ·æ¥ï¼Œå¦‚æœæœ‰ä»»ä½•é—®é¢˜å¯ä»¥ç•™è¨€ç»™æˆ‘ã€‚</p><p>ä»Šå¤©çš„åˆ†äº«å°±è¿™ä¹ˆå¤šï¼Œç®€å•çš„åšä¸ªå°ç»“ï¼š</p><ul><li>ä»æ­å»ºå®Œæˆ <code>SpringBoot</code> å†åˆ°ä½¿ç”¨ Android å®ç°ä¸€ä¸ªç®€å•çš„å®¢æˆ·ç«¯ï¼Œéœ€è¦åˆå­¦è€…ä»˜å‡ºè¾ƒå¤šçš„åŠªåŠ›ï¼Œæœ€å…³é”®çš„æ˜¯æˆ‘ä»¬ä¸€èµ·è¿ˆå‡ºäº†ç¬¬ä¸€æ­¥ï¼›</li><li>åœ¨ä»£ç ä¸­å°½é‡ä¸è¦ä½¿ç”¨é­”æœ¯æ•°å­—ï¼ŒæŠŠé€šç”¨çš„å¸¸é‡æ”¾åˆ°å¯¹åº”çš„ç±»ä¸­è¿›è¡Œç®¡ç†ï¼Œå‡å°‘åç»­çš„ç»´æŠ¤æˆæœ¬ï¼›</li><li>å°½é‡å¤šçš„è¾“å‡º Logï¼Œå¹¶ä¸”ä½¿ç”¨ Tag å¯¹ Log è¿›è¡Œåˆ†ç±»ï¼Œæ–¹ä¾¿åç»­æ’æŸ¥é—®é¢˜ï¼Œæé«˜è§£å†³é—®é¢˜çš„æ•ˆç‡ï¼›</li></ul><hr><p><strong>ä¸è¦æŠ±æ€¨è‡ªå·±æ²¡æœ‰å¤©èµ‹ï¼Œå¦‚æœä½ èƒ½åšæŒåšå¥½ä¸€ä»¶äº‹æƒ…ï¼Œæœ¬èº«å°±æ˜¯å¤©èµ‹ã€‚</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®€è°ˆäº²å­æ•™è‚²</title>
      <link href="/2020/06/06/%E7%AE%80%E8%B0%88%E4%BA%B2%E5%AD%90%E6%95%99%E8%82%B2/"/>
      <url>/2020/06/06/%E7%AE%80%E8%B0%88%E4%BA%B2%E5%AD%90%E6%95%99%E8%82%B2/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>ç½‘ä¸Šæµä¼ ç€è¿™æ ·ä¸€å¥è¯ï¼šâ€œæ²¡æœ‰ä¸€ä¸ªæ•™å­©å­å­¦ä¹ çš„å®¶é•¿ä¸æ˜¯å¿ƒæ¢—çš„â€ã€‚</p><p>å½“ç„¶äº†ï¼Œè¿™å¥ç©ç¬‘è¯æ˜¾ç„¶æ˜¯å¤¸å¼ äº†ä¸€äº›ï¼Œä½†å®ƒè¶³ä»¥è¡¨æ˜å®¶é•¿å’Œå­©å­ä¹‹é—´åœ¨å­¦ä¹ è¿™ä¸ªè¯é¢˜ä¸Šå­˜åœ¨ç€ä¸å¯è°ƒå’Œçš„çŸ›ç›¾ã€‚</p><p>ä»Šå¤©æƒ³è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹åœ¨å­¦ä¹ è¿™ä»¶äº‹æƒ…ä¸Šï¼Œæ€ä¹ˆåšåˆ°æ›´å¥½çš„ä¸è‡ªå·±çš„å­©å­ç›¸å¤„æ‰èƒ½ä¸ä¼¤å®³å½¼æ­¤ã€‚</p><p>çœ‹åˆ°æœ¬ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œæˆ–è®¸ä½ è¿˜æ˜¯æœªå©šè€…ï¼Œæˆ–è€…æ˜¯å‡†çˆ¶æ¯è€…ï¼ŒæŠ‘æˆ–æ˜¯å·²ä¸ºäººçˆ¶æ¯äº†ï¼Œä½†æˆ‘å»ºè®®ä½ çœ‹ä¸‹å»ï¼Œè¯´ä¸å®šæœ‰äº›æ”¶è·å‘¢ã€‚</p><h2 id="ä¸å¯é€†çš„ä¼¤å®³"><a href="#ä¸å¯é€†çš„ä¼¤å®³" class="headerlink" title="ä¸å¯é€†çš„ä¼¤å®³"></a>ä¸å¯é€†çš„ä¼¤å®³</h2><p>ä»Šå¹´æ˜¯ä¸ªç‰¹åˆ«å¹´ï¼Œå† çŠ¶ç—…æ¯’è®©å…¨å›½å®¶é•¿å¢åŠ äº†é™ªä¼´å­©å­çš„æ—¶é—´ã€‚åˆ«äººéƒ½è¯´ï¼šâ€é™ªä¼´æ˜¯æœ€å¥½çš„æ•™è‚²â€œï¼Œè€Œæˆ‘å´å‘ç°è‡ªå·±åœ¨é™ªä¼´çš„æ—¥å­é‡Œå¹¶æ²¡æœ‰é‚£ä¹ˆç†æ€§ï¼ŒåŠ¨è¾„ä¸ºäº†æ•™å­©å­å†™ä½œä¸šå˜å¾—å‹ƒç„¶å¤§æ€’ï¼Œä¿¨ç„¶å°±æ˜¯ä¸€å¤´å¤±å»ç†æ€§çš„é‡å…½ï¼Œåæƒ³èµ·æ¥æŒºå¥½ç¬‘çš„ã€‚</p><p><img src="/upload/images/2020/06/06/1.jpg"></p><p>æˆ‘å°çš„æ—¶å€™ç»å¸¸æŒ¨çˆ¶äº²çš„æï¼Œç»å¸¸å› ä¸ºæ²¡æœ‰åšå¥½ä¸€äº›å°äº‹æƒ…ï¼Œå°±ä¼šè¢«çªå¦‚å…¶æ¥çš„é­å­æ”¶æ‹¾çš„æœæœå¸–å¸–ã€‚ç›´åˆ°è‡ªå·±ä¸Šäº†åˆä¸­ï¼ŒæŒ¨æçš„è¿¹è±¡æ‰é€æ¸æ¶ˆå¤±ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯æˆ‘å¯¹çˆ¶äº²çš„å†·æ¼ å’Œæ•·è¡ä»¥åŠå¯¹å®¶çš„å¤±æœ›ã€‚ä½ å¯¹å­©å­æ— ç¼˜æ— æ•…çš„å¤§éª‚ï¼Œæ¢æ¥çš„å¹¶ä¸æ˜¯æœ›å­æˆé¾™è€Œæ˜¯ä¸å¯é€†çš„ä¼¤å®³ï¼Œä¼šè®©å­©å­å¯¹ä½ å¤±å»ä¿¡ä»»ï¼Œå®ƒä¼šè®©ä½ ä»¬å½¼æ­¤çš„äº¤æµå˜å¾—å±ˆæŒ‡å¯æ•°ï¼Œåˆ°é‚£ä¸ªæ—¶å€™å°±åæ‚”è«åŠäº†ã€‚</p><p>å­©å­æ¥åˆ°è¿™ä¸ªä¸–ç•Œä¸Šï¼Œä¸ä¼šçš„ä¸œè¥¿å®åœ¨å¤ªå¤šäº†ï¼Œæˆ‘ä»¬æ´»äº†è¿™éº½å¤šå¹´ä¸è¿˜ä»æ—§åœ¨å­¦ä¹ å˜›ï¼Ÿä¸Šå­¦åªæ˜¯å­©å­åœ¨æœªæ¥çš„é“è·¯ä¸Šçš„ä¸€ä¸ªé˜¶æ®µè€Œå·²ï¼Œè€Œæˆ‘ä»¬åº”è¯¥å°½è‡ªå·±æœ€å¤§çš„åŠªåŠ›è®©ä»–åœ¨è¿™ä¸ªé“è·¯ä¸Šèµ°å¾—æ›´ç¨³æ›´å®‰å…¨æ‰æ˜¯æ­£ç¡®çš„åšæ³•ã€‚åªå‡­æ‹³è„šæˆ–è€…å¤§å¼å¤§å«æ˜¯æ— æ³•è®©å­©å­ä¿¡æœçš„ï¼Œä¸‰å­—ç»è¯´â€å­ä¸æ•™çˆ¶ä¹‹è¿‡â€œï¼Œä½†æ˜¯â€æ•™â€œå¾—å¤ªâ€è¿‡â€œäº†å°±ä¸å¥½äº†ã€‚æ¨èå¤§å®¶è¯»è¯» <a href="http://www.veryitman.com/2019/10/26/%E7%9C%8B%E3%80%8A%E9%93%B6%E6%B2%B3%E8%A1%A5%E4%B9%A0%E7%8F%AD%E3%80%8B%E6%9C%89%E6%84%9F/">çœ‹ã€Šé“¶æ²³è¡¥ä¹ ç­ã€‹æœ‰æ„Ÿ</a> è¿™ç¯‡æ–‡ç« ï¼Œé¼“åŠ±å’Œç›¸ä¿¡è‡ªå·±çš„å­©å­ï¼Œæ‰æ˜¯ç»™ä»–å‰è¿›çš„é“è·¯ä¸Šæœ€å¤§çš„åŠ¨åŠ›ã€‚æ¯ä¸ªå­©å­éƒ½æ˜¯èªæ˜çš„ï¼Œä»–ä»¬ä¼šç”¨è‡ªå·±çš„å¿ƒçµæ„Ÿå—ä½ å¯¹ä»–çš„ç‚¹ç‚¹æ»´æ»´ã€‚</p><h2 id="çŸ¥è¯†çš„è¯…å’’"><a href="#çŸ¥è¯†çš„è¯…å’’" class="headerlink" title="çŸ¥è¯†çš„è¯…å’’"></a>çŸ¥è¯†çš„è¯…å’’</h2><p><img src="/upload/images/2020/06/06/2.jpg"></p><p>å¤§å®¶åº”è¯¥è€ƒè¿‡é©¾ç…§è¢«æ•™ç»ƒå¸¦ç€ç»ƒè¿‡è½¦å§ï¼Œæˆ‘ç›¸ä¿¡æœ‰å¾ˆå¤šå­¦å‘˜éƒ½è¢«æ•™ç»ƒéª‚å“­è¿‡ç”šè‡³è¿˜ä¸æ­¢ä¸€æ¬¡ã€‚è‹¥ä¸æ˜¯è‡ªå·±äº¤äº†é’±ä»˜å‡ºäº†é‚£ä¹ˆå¤šï¼Œåº”è¯¥æ—©å°±æ‹”æ–¹å‘ç›˜èµ°äººäº†å§ã€‚æˆ‘ä¹Ÿå¬è¿‡èº«è¾¹å¾ˆå¤šåŒäº‹æŠ±æ€¨è¿‡å¯¹æ•™ç»ƒçš„å„ç§ä¸æ»¡ï¼Œå¹´è½»æ°”ç››ç‚¹çš„å­¦å‘˜ä¹Ÿæœ‰å½“é¢æ€¼æ•™ç»ƒçš„ã€‚</p><p>æˆ‘è‡ªå·±äº²èº«ç»å†çš„ä¸€ä»¶äº‹æƒ…ï¼Œè¯´èµ·æ¥ä¹ŸæŒºé€—ã€‚é‚£å¤©å»è€ƒç§‘ç›®ä¸‰ï¼ˆè·¯è€ƒï¼‰ï¼Œå‡Œæ™¨å¤©ä¸äº®å°±å‡ºå‘åˆ°è€ƒè¯•åœ°äº†ï¼Œå¦‚æœå½“å¤©ç§‘ç›®ä¸‰èƒ½è€ƒè¯•é€šè¿‡å°±å¯ä»¥æ¥ç€è€ƒç§‘ç›®å››äº†ï¼Œæ‹¿é©¾ç…§å°±æŒ‡æ—¥å¯å¾…ã€‚åœ¨ç»ƒè½¦çš„è¿‡ç¨‹ä¸­ï¼Œæ•™ç»ƒå¯¹ç€æˆ‘ä»¬å‡ ä¸ªå­¦å‘˜åˆ†åˆ«ç—›æ–¥äº†ä¸€é¡¿ï¼Œè¿™ä¸ªéƒ½è¯´äº†å‡ ç™¾éäº†é‚£ä¸ªå·²ç»è®²äº†ä¸Šåƒéäº†æ€ä¹ˆè¿˜æ˜¯ä¸æ³¨æ„ï¼Œæˆ‘çœ‹ä½ ä»¬è€ƒè¯•æŒ‚äº†ä¹Ÿæ˜¯æ´»è¯¥ã€‚è¿™ç§æ„Ÿè§‰å°±åƒä½ æ¸…æ™¨åˆšä¸€èµ·åºŠå°±è¢«äººç”¨å†°æ°´æµ‡çŒäº†ä¸€ç•ªã€‚æˆ‘ç¡®å®æ˜¯æ²¡æœ‰å¿ä½å°±æ€¼äº†æ•™ç»ƒä¸€ç•ªï¼Œæˆ‘ç”¨ç›¸å¯¹æ–‡æ˜çš„æˆè¯­èƒ¡ä¹±è¯´äº†ä»–ä¸€é€šï¼Œè¿˜å¥½å¤§å®¶éƒ½æ²¡æœ‰åŠ¨èµ·æ‰‹æ¥ğŸ˜„ï¼Œé‚£å¤©è€ƒè¯•è¿˜ç®—é¡ºåˆ©å¤§å®¶éƒ½è€ƒè¯•é€šè¿‡äº†ã€‚</p><p>åœ¨å›æ¥çš„è·¯ä¸Šï¼Œæˆ‘é—®ä¸€ä¸ªå­¦å‘˜ä½ ç°åœ¨æœ€æƒ³åšçš„ä¸€ä»¶äº‹æ˜¯ä»€ä¹ˆï¼Ÿä»–è¯´åˆ äº†æ•™ç»ƒçš„å¾®ä¿¡è€æ­»ä¸ç›¸å¾€æ¥ï¼Œæˆ‘ä¸¾èµ·äº†å·¦æ‰‹ï¼Œä»–ä¸¾èµ·äº†å³æ‰‹ï¼Œæˆ‘ä»¬ä¸çº¦è€ŒåŒçš„å‡»äº†ä¸€æŒï¼Œé‚£å“å£°å“å½»äº‘éœ„ï¼Œæ„Ÿè§‰é‚£æ˜¯ç»ƒè½¦ä»¥æ¥æœ€çˆ½çš„ä¸€æ¬¡å°±å¥½æ¯”æŠ¥äº†ä¸€ä¸ªå¤§ä»‡ä¸€æ ·ã€‚</p><p>æ•™ç»ƒå¼€è½¦å¤šå¹´ä¿¨ç„¶æ˜¯ä¸€ä¸ªè€å¸æœºï¼Œè€Œä½œä¸ºä»æ¥æ²¡æœ‰æ¥è§¦è¿‡æ±½è½¦çš„å­¦å‘˜ï¼Œç»ƒè½¦å’Œè€ƒè¯•å¯¹äºä»–ä»¬æ¥è¯´é™¤äº†ä¸ç†Ÿæ‚‰æ›´å¯æ€•çš„æ˜¯å†…å¿ƒçš„é‚£ä»½å¯¹è½¦çš„ææƒ§ã€‚å†åŠ ä¸Šæ•™ç»ƒçš„å’†å“®å°±ä¼šæ›´åŠ ä¹±äº†æ–¹å¯¸ã€‚è¿™å°±æ˜¯çŸ¥è¯†çš„è¯…å’’ã€‚</p><p>é‚£ä»€ä¹ˆæ˜¯çŸ¥è¯†çš„è¯…å’’<code>å‘¢ï¼Ÿè‹±æ–‡ç§°ä¹‹ä¸º</code>The Curse of Knowledge&#96;ï¼Œæˆ‘ä»¬ä¸€æ—¦çŸ¥é“äº†æŸäº‹ï¼Œå°±æ— æ³•æƒ³è±¡è¿™ä»¶äº‹åœ¨æœªçŸ¥è€…çœ¼ä¸­çš„æ ·å­ã€‚å½“æˆ‘ä»¬æŠŠè‡ªå·±çŸ¥é“çš„çŸ¥è¯†è§£é‡Šç»™åˆ«äººçš„æ—¶å€™ï¼Œå› ä¸ºä¿¡æ¯çš„ä¸å¯¹ç­‰ï¼Œæˆ‘ä»¬å¾ˆéš¾æŠŠè‡ªå·±çŸ¥é“çš„å®Œå®Œå…¨å…¨ç»™å¯¹æ–¹è§£é‡Šæ¸…æ¥šã€‚æ€»æ˜¯ï¼Œæˆ‘ä»¬çš„çŸ¥è¯†â€œè¯…å’’â€äº†æˆ‘ä»¬ã€‚</p><p>ç®€å•çš„ç”¨ä¸€å¥è¯æ¥è¯´ï¼Œ<code>çŸ¥è¯†çš„è¯…å’’</code> å°±æ˜¯ä½ è‡ªå·±çŸ¥é“çš„ä¸œè¥¿å¾ˆéš¾é€šè¿‡ç®€å•çš„äº¤æµæˆ–è€…æ•™è‚²è®©å¯¹æ–¹å…¨éƒ¨getåˆ°ã€‚</p><p>ç”Ÿæ´»ä¸­æœ‰å¾ˆå¤šè¿™æ ·çš„ä¾‹å­ï¼Œå¯¹äºå­©å­çš„å­¦ä¹ ï¼ŒåŒæ ·å­˜åœ¨çŸ¥è¯†çš„è¯…å’’ã€‚æˆ‘ä»¬æ€»æ˜¯è®¤ä¸ºè¿™äº›ä½œä¸šå¤ªç®€å•ï¼Œåº”è¯¥è®²ä¸€ä¸¤éå­©å­éƒ½ä¼šäº†ï¼Œä»–ä»¬ä¸ºä½•æ€»æ˜¯åå¤çš„åœ¨é”™å‘¢ï¼Ÿä¸ºäº†é˜²æ­¢çŸ¥è¯†çš„è¯…å’’å¯¹æˆ‘ä»¬çš„å½±å“ï¼Œæˆ‘ä»¬æ›´åº”è¯¥å¤šä¸€äº›è€å¿ƒï¼Œæˆ–è€…æ¢ä¸ªæ€è·¯æƒ³ä¸€æƒ³æ˜¯ä¸æ˜¯è‡ªå·±çš„æ•™è‚²å’Œè¡¨è¾¾æ–¹å¼æœ‰é—®é¢˜ï¼Ÿæ¢ä¸ªæ€è·¯å’Œåšæ³•ï¼Œå­©å­æ˜¯ä¸æ˜¯å°±èƒ½å­¦çš„æ›´è½»æ¾å‘¢ï¼Ÿ</p><h2 id="ç“¦æ‹‰èµ«æ•ˆåº”"><a href="#ç“¦æ‹‰èµ«æ•ˆåº”" class="headerlink" title="ç“¦æ‹‰èµ«æ•ˆåº”"></a>ç“¦æ‹‰èµ«æ•ˆåº”</h2><p>åœ¨äº†è§£äº† <code>çŸ¥è¯†çš„è¯…å’’</code> è¿™ä¸ªçŸ¥è¯†ç‚¹åï¼Œæˆ‘ä»¬å†æ¥èŠèŠä»€ä¹ˆæ˜¯ <code>ç“¦æ‹‰èµ«æ•ˆåº”</code>ã€‚</p><p><img src="/upload/images/2020/06/06/3.jpeg"></p><p>åœ¨è¯´ <code>ç“¦æ‹‰èµ«æ•ˆåº”</code> ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜æ˜¯å…ˆçœ‹çœ‹èº«è¾¹çš„çœŸå®äº‹ä»¶ã€‚</p><p>æˆ‘æœ‰ä¸ªåŒå­¦ï¼Œåˆä¸­æˆç»©å¾ˆä¸€èˆ¬ï¼Œçˆ¶æ¯èŠ±é’±æ±‚é¢†å¯¼è®©ä»–ä¸Šäº†ä¸€ä¸ªå¿é«˜ä¸­ã€‚åœ¨é«˜ä¸­çš„æ–‡ç†ç§‘åˆ†ç­ä¹‹å‰ï¼Œä»–æ•´ä½“æˆç»©ä¹Ÿå¾ˆä¸€èˆ¬ï¼Œæ²¡æœ‰äººä¼šç›¸ä¿¡ä»–æœ€åå±…ç„¶å¯ä»¥è€ƒä¸Š985çš„å¤§å­¦ã€‚åæ¥åŒå­¦èšä¼šï¼Œä»–è·Ÿæˆ‘ä»¬è®²å…¶å®è‡ªå·±å¾ˆå–œæ¬¢ç†ç§‘å°¤å…¶æ˜¯æ•°å­¦å’Œç‰©ç†ï¼Œå¯¹æ–‡ç§‘æ²¡æœ‰ä»»ä½•å…´è¶£è€ƒè¯•ä¹Ÿæ˜¯çè’™çš„ã€‚ä»–éå¸¸æ„Ÿè°¢æ–‡ç†åˆ†ç§‘è®©è‡ªå·±æœ‰äº†æ›´å¥½çš„é€‰æ‹©ï¼Œå¦åˆ™è‡ªå·±çš„ä¸€ç”Ÿå¯èƒ½æ˜¯å¦å¤–ä¸€ç•ªæ™¯è±¡ã€‚</p><p>å­¦ç”Ÿçš„æ™ºèƒ½å‘å±•éƒ½æ˜¯ä¸å‡è¡¡çš„ï¼Œéƒ½æœ‰æ™ºèƒ½çš„å¼ºç‚¹å’Œå¼±ç‚¹ï¼Œä»–ä»¬ä¸€æ—¦æ‰¾åˆ°è‡ªå·±æœ€ä½³ç‚¹ï¼Œä½¿æ½œåŠ›å¾—åˆ°å……åˆ†çš„å‘æŒ¥ï¼Œä¾¿å¯å–å¾—æƒŠäººçš„æˆç»©ã€‚è¿™ä¸€ç°è±¡äººä»¬ç§°ä¹‹ä¸ºâ€œç“¦æ‹‰èµ«æ•ˆåº”â€ã€‚</p><blockquote><p>å¥¥æ‰˜Â·ç“¦æ‹‰èµ«æ˜¯è¯ºè´å°”åŒ–å­¦å¥–è·å¾—è€…ï¼Œä»–çš„æˆæ‰è¿‡ç¨‹æå¯Œä¼ å¥‡è‰²å½©ã€‚ç“¦æ‹‰èµ«åœ¨å¼€å§‹è¯»ä¸­å­¦æ—¶ï¼Œçˆ¶æ¯ä¸ºä»–é€‰æ‹©çš„æ˜¯ä¸€æ¡æ–‡å­¦ä¹‹è·¯ï¼Œä¸æ–™ä¸€ä¸ªå­¦æœŸä¸‹æ¥ï¼Œæ•™å¸ˆä¸ºä»–å†™ä¸‹äº†è¿™æ ·çš„è¯„è¯­ï¼šâ€œç“¦æ‹‰èµ«å¾ˆç”¨åŠŸï¼Œä½†è¿‡åˆ†æ‹˜æ³¥ã€‚è¿™æ ·çš„äººå³ä½¿æœ‰ç€å®Œç¾çš„å“å¾·ï¼Œä¹Ÿå†³ä¸å¯èƒ½åœ¨æ–‡å­—ä¸Šå‘æŒ¥å‡ºæ¥ã€‚â€æ­¤åï¼Œä»–æ”¹å­¦æ²¹ç”»ã€‚å¯ç“¦æ‹‰èµ«æ—¢ä¸å–„äºæ„å›¾ï¼Œåˆä¸ä¼šè°ƒè‰²ï¼Œå¯¹è‰ºæœ¯çš„ç†è§£åŠ›ä¹Ÿä¸å¼ºï¼Œæˆç»©åœ¨ç­ä¸Šæ˜¯å€’æ•°ç¬¬ä¸€ï¼Œå­¦æ ¡çš„è¯„è¯­æ›´æ˜¯éš¾ä»¥ä»¤äººæ¥å—ï¼šâ€œä½ æ˜¯ç»˜ç”»è‰ºæœ¯æ–¹é¢çš„ä¸å¯é€ å°±ä¹‹æ‰ã€‚â€é¢å¯¹å¦‚æ­¤â€œç¬¨æ‹™â€çš„å­¦ç”Ÿï¼Œç»å¤§å¤šæ•°è€å¸ˆè®¤ä¸ºä»–å·²æˆæ‰æ— æœ›ï¼Œåªæœ‰åŒ–å­¦è€å¸ˆè®¤ä¸ºä»–åšäº‹ä¸€ä¸ä¸è‹Ÿï¼Œå…·å¤‡åšå¥½åŒ–å­¦å®éªŒåº”æœ‰çš„å“æ ¼ï¼Œå»ºè®®ä»–è¯•å­¦åŒ–å­¦ï¼Œçˆ¶æ¯æ¥å—äº†åŒ–å­¦è€å¸ˆçš„å»ºè®®ã€‚è¿™ä¸‹ï¼Œç“¦æ‹‰èµ«æ™ºæ…§çš„ç«èŠ±ä¸€ä¸‹è¢«ç‚¹ç€äº†ï¼Œæ–‡å­¦è‰ºæœ¯çš„â€œä¸å¯é€ ä¹‹æ‰â€ä¸€ä¸‹å­å˜æˆå…¬è®¤çš„åŒ–å­¦æ–¹é¢çš„â€œå‰ç¨‹è¿œå¤§ çš„é«˜æ‰ç”Ÿâ€ã€‚</p></blockquote><p>å¦‚æœä½ è¿˜åœ¨å¼ºè¿«è‡ªå·±çš„å­©å­å»ä¸Šæ‰€è°“çš„å…´è¶£ç­çš„çˆ¶æ¯ï¼Œæ˜¯æ—¶å€™è€ƒè™‘ä¸€ä¸‹ç»§ç»­è¿™æ ·ä¸‹å»ä¼šä¸ä¼šå¯¹å­©å­é€ æˆæ›´å¤§çš„ä¼¤å®³ï¼Ÿ</p><p>åœ¨è¿™ä¸ªå¹´ä»£ï¼Œæ¯ä¸ªäººéƒ½æœ‰å¾ˆå¤§çš„å‹åŠ›åŒ…æ‹¬å­©å­è‡ªå·±ï¼Œå³ä½¿ä½ åœ¨ç­çº§é‡Œè€ƒäº†80åˆ†ä¹Ÿå¯èƒ½æ˜¯å€’æ•°ç¬¬ä¸€ï¼ŒåŸ¹å…»å­©å­çš„å…´è¶£æ˜¯å¾ˆé‡è¦ä½†å‰ææ˜¯ä½ è®©ä»–æŠŠæœ€åŸºæœ¬çš„å­¦ä¹ æå¥½ã€‚å¼ºè¿«ä»–å»ä¸Šå…´è¶£ç­æ˜¯æ²¡æœ‰ä»»ä½•æ„ä¹‰çš„ã€‚</p><hr><p>è‡ªå·±ä¹±ä¸ƒå…«ç³Ÿçš„è¯´äº†è®¸å¤šï¼Œæ€»ç»“ä¸€ä¸‹å§ï¼</p><ul><li>å­©å­åœ¨å­¦ä¹ æ–¹é¢ä¸æ‡‚çš„æœ‰å¾ˆå¤šï¼Œå®¶é•¿è¦æ›´åŠ æœ‰è€å¿ƒçš„æ•™å¯¼ä»–ä»¬ï¼Œåˆ«è¢«çŸ¥è¯†è¯…å’’äº†ï¼›</li><li>æ¯ä¸ªå­©å­çš„æ™ºèƒ½å‘å±•æ˜¯ä¸å‡è¡¡çš„ï¼Œå½“ä»–ä»¬é‡åˆ°é—®é¢˜åï¼Œè¯•ç€æ¢ä¸ªæ–¹å¼å»å¼•å¯¼å’Œæ•™è‚²ä»–ä»¬ï¼Œå¸®åŠ©ä»–ä»¬æ‰¾åˆ°é‚£ä¸ªå¹³è¡¡ç‚¹ï¼›</li><li>æ‹³æ‰“è„šè¸¢ã€å£°å˜¶åŠ›ç«­åªèƒ½è®©å®¶é•¿å’Œå­©å­ä¹‹é—´çš„å…³ç³»å˜å¾—æ›´åŠ çŸ›ç›¾ï¼Œé€ æˆçš„ä¼¤å®³ä¸å¯é€†ï¼›</li><li>ä¸è¦ç§è‡ªç»™å­©å­ä¸‹å†³å®šï¼Œå°½é‡å½¼æ­¤è¿›è¡Œå•†é‡ï¼Œé€‚å½“çš„æ—¶å€™å¯ä»¥è¿›è¡Œé€‚åº¦çš„â€œéª—â€ï¼›</li></ul><hr><p><strong>å¯¹å­©å­çš„æ­‡æ–¯åº•é‡Œï¼Œæ¢æ¥çš„åªä¸è¿‡æ˜¯ä¸¤è´¥ä¿±ä¼¤ã€‚</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> äº²å­ æ•™è‚² çŸ¥è¯†çš„è¯…å’’ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡: é…ç½®Nginxåå‘ä»£ç†</title>
      <link href="/2020/05/23/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E9%85%8D%E7%BD%AENginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/"/>
      <url>/2020/05/23/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E9%85%8D%E7%BD%AENginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æœ¬æ¥æ˜¯ä¸€ä»¶å¾ˆå°çš„äº‹æƒ…ï¼Œä½†æˆ‘è§‰å¾—è¿˜æ˜¯å¾ˆæœ‰å¿…è¦è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹ï¼Œå‹¿ä»¥å–„å°è€Œä¸ä¸ºã€‚</p><p>äº‹æƒ…æ˜¯è¿™æ ·çš„â€¦</p><p>æœ‰ä¸ªå°ä¼™ä¼´å‘Šè¯‰æˆ‘è¯´è‡ªå·±æƒ³å­¦ä¹ ä¸€ä¸‹ <code>SpringBoot</code> ç»“åˆ <code>Nginx</code>ï¼Œæ¯•ç«Ÿç”¨äº† <code>Tomcat</code> é‚£ä¹ˆä¹…ï¼ˆå¯åŠ¨ <code>SpringBoot</code> é¡¹ç›®ä¼šè‡ªåŠ¨å¯åŠ¨ <code>Tomcat</code>ï¼‰ä¹Ÿæ˜¯æ—¶å€™ç©ç© <code>Nginx</code> äº†ã€‚è¿™ä¸ªæƒ³æ³•å¾ˆèµï¼Œå»æ¢ç´¢å’Œäº†è§£è‡ªå·±æ²¡æœ‰å­¦è¿‡çš„ä¸œè¥¿æœ¬æ¥å°±æ˜¯ä¸€ç§è¿›æ­¥ã€‚</p><p>ä»–è¯´æŒ‰ç…§ç½‘ä¸Šæ•™ç¨‹é…ç½®äº†ä¸€ä¸‹ <code>Nginx</code>ï¼Œä½†æ˜¯é€šè¿‡é…ç½®çš„æ–¹å¼è®¿é—® <code>Nginx</code> æ­»æ´»éƒ½ä¸èƒ½è®¿é—®åˆ°  <code>SpringBoot Web</code> é¡¹ç›®æä¾›çš„æ¥å£ä¸­å»ã€‚</p><p>ä»Šå¤©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä¹ŸæŠŠå®è·µçš„å†…å®¹åˆ†äº«ç»™å¤§å®¶ï¼Œå¸Œæœ›èƒ½å¸®åŠ©åˆ°æœ‰éœ€è¦çš„äººã€‚</p><p>å…³äºå¾®æœåŠ¡ç›¸å…³çš„æ–‡ç« ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å‚é˜… <a href="http://www.veryitman.com/2019/05/28/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%A1%B9%E7%9B%AE%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/">å¾®æœåŠ¡é¡¹ç›®ç³»åˆ—</a> è¿™ç¯‡æ–‡ç« ã€‚</p><h2 id="å¤§å†™çš„-404"><a href="#å¤§å†™çš„-404" class="headerlink" title="å¤§å†™çš„ 404"></a>å¤§å†™çš„ 404</h2><p>ç»è¿‡ä¸€ç•ªçš„æ²Ÿé€šï¼Œä»–ç»™æˆ‘å¤§è‡´æè¿°äº†ä¸€ä¸‹ç»è¿‡ï¼Œæˆ‘å°±å¼€å§‹äº†å¤ç°ä¹‹è·¯ã€‚</p><p>è¿™ä¸ªå°ä¼™ä¼´æ˜¯æƒ³é€šè¿‡ <code>Nginx</code> çš„åå‘ä»£ç†èƒ½åŠ›è®¿é—®æ‰€æœ‰ <code>SpringBoot Web</code> é¡¹ç›®çš„æ¥å£ï¼Œå…³äºä»€ä¹ˆæ˜¯åå‘ä»£ç†ã€æ­£å‘ä»£ç†ï¼Œå¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰åä¸º <a href="http://www.veryitman.com/2019/04/14/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/">åå‘ä»£ç†</a> çš„ä¸€ç¯‡æ–‡ç« ã€‚</p><p>æˆ‘æ‰€ç”¨ä¾æ—§æ˜¯ <a href="https://github.com/veryitman/MSTutorial/tree/master/server-project">SpringBoot é¡¹ç›®æºä»£ç </a> ä¸­çš„ä»£ç ï¼Œä»£ç æ‰˜ç®¡åœ¨ Github ä¸Šé¢äº†ï¼Œæœ‰éœ€è¦çš„æœ‹å‹å¯ä»¥ clone ä¸‹æ¥ã€‚</p><p>æŠ¥é”™å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2020/05/23/1.png"></p><p>æˆ‘åœ¨æœ¬æœºï¼ˆWindows 10ç³»ç»Ÿï¼‰å®‰è£…çš„ <code>Nginx</code> ç‰ˆæœ¬æ˜¯ <strong>1.15.12</strong>ï¼Œä¸Šå›¾å¯ä»¥çœ‹å‡ºè®¿é—®å¯¹åº”çš„ <code>url</code> å‡ºç°äº† 404 é”™è¯¯ï¼Œå…³äº 404 è¿™ä¸ªé”™è¯¯ç ï¼Œç™¾åº¦ç™¾ç§‘æ˜¯è¿™æ ·è§£é‡Šçš„ï¼š</p><blockquote><p>404ï¼Œæ˜¯ä¸€ç§HTTPçŠ¶æ€ç ï¼ŒæŒ‡ç½‘é¡µæˆ–æ–‡ä»¶æœªæ‰¾åˆ°ã€‚</p><p>HTTP 404æˆ–Not Foundé”™è¯¯ä¿¡æ¯æ˜¯HTTPçš„å…¶ä¸­ä¸€ç§â€œæ ‡å‡†å›åº”ä¿¡æ¯â€ï¼ˆHTTPçŠ¶æ€ç ï¼‰ï¼Œæ­¤ä¿¡æ¯ä»£è¡¨å®¢æˆ·ç«¯åœ¨æµè§ˆç½‘é¡µæ—¶ï¼ŒæœåŠ¡å™¨æ— æ³•æ­£å¸¸æä¾›ä¿¡æ¯ï¼Œæˆ–æ˜¯æœåŠ¡å™¨æ— æ³•å›åº”ä¸”ä¸çŸ¥åŸå› ã€‚</p></blockquote><p>ç›´ç™½æ¥è®²ï¼Œå°±æ˜¯æ‰¾ä¸åˆ°èµ„æºã€‚é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æˆ‘æ˜¯å¦‚ä½•é…ç½® <code>Nginx</code> åå‘ä»£ç†çš„ã€‚</p><p>é…ç½®æ–‡ä»¶ <code>nginx.conf</code> ï¼ˆåœ¨Nginxå®‰è£…ç›®å½•confç›®å½•ä¸‹ï¼‰ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">worker_processes</span>  <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="section">events</span> &#123;</span><br><span class="line">    <span class="attribute">worker_connections</span>  <span class="number">1024</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">http</span> &#123;</span><br><span class="line">    <span class="attribute">include</span>       mime.types;</span><br><span class="line">    <span class="attribute">default_type</span>  application/octet-stream;</span><br><span class="line">    <span class="attribute">sendfile</span>        <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">keepalive_timeout</span>  <span class="number">65</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªå®šä¹‰è™šæ‹Ÿä¸»æœº1</span></span><br><span class="line">    <span class="section">server</span> &#123;</span><br><span class="line">        <span class="attribute">listen</span>       <span class="number">80</span>;</span><br><span class="line">        <span class="attribute">server_name</span>  localhost;</span><br><span class="line">        <span class="section">location</span> / &#123;</span><br><span class="line">            <span class="attribute">root</span>   html;</span><br><span class="line">            <span class="attribute">index</span>  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è‡ªå®šä¹‰è™šæ‹Ÿä¸»æœº2ï¼šé…ç½®è½¬å‘ç»™ms-useræœåŠ¡ï¼ˆspringbootï¼‰</span></span><br><span class="line">    <span class="section">server</span> &#123;</span><br><span class="line">        <span class="attribute">listen</span>       <span class="number">80</span>;</span><br><span class="line">        <span class="attribute">server_name</span>  user.com;</span><br><span class="line">        <span class="section">location</span> / &#123;</span><br><span class="line">            <span class="attribute">proxy_pass</span> http://localhost:8080;</span><br><span class="line">            <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">            <span class="attribute">proxy_set_header</span> X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line">            <span class="attribute">proxy_set_header</span> X-Forwarded-Port <span class="variable">$server_port</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä»é…ç½®å¯ä»¥çœ‹åˆ°ï¼Œé…ç½®äº†ä¸¤ä¸ªè™šæ‹Ÿä¸»æœºï¼Œé—®é¢˜å°±å‡ºç°åœ¨è¿™é‡Œã€‚</p><h2 id="è®©-404-æ¶ˆå¤±"><a href="#è®©-404-æ¶ˆå¤±" class="headerlink" title="è®© 404 æ¶ˆå¤±"></a>è®© 404 æ¶ˆå¤±</h2><p>æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹åˆšæ‰æŠ¥ 404 çš„è®¿é—®åœ°å€ <code>http://localhost/signin/name?username=fooboy&amp;userpwd=123</code>ï¼Œå…¶ä¸­ <code>http://localhost</code> æœ¬è´¨æ˜¯  <code>http://localhost:80</code>ï¼Œå†ç»“åˆçœ‹ä¸€ä¸‹ <code>Nginx</code> çš„é…ç½®æ–‡ä»¶ï¼Œå…¶å®æ˜¯è®¿é—®åˆ°äº† <code>è‡ªå®šä¹‰è™šæ‹Ÿä¸»æœº1</code> ä¸Šé¢äº†ã€‚</p><p>æœ‰ä¸¤ä¸ªæ¯”è¾ƒç®€å•çš„è§£å†³æ–¹æ¡ˆï¼Œä¸‹é¢çš„ä¸¤ç§æ–¹æ¡ˆ<strong>æ— éœ€ä¿®æ”¹</strong> <code>SpringBoot</code> é¡¹ç›®çš„ä»»ä½•é…ç½®ï¼Œä½ åªéœ€è¦å¯åŠ¨ä½ çš„ <code>SpringBoot</code> é¡¹ç›®å³å¯ã€‚</p><p><strong>æ–¹æ¡ˆä¸€ï¼šé…ç½®ä¸»æœº host</strong></p><p>ä¿®æ”¹ç³»ç»Ÿä¸»æœº <code>C:\Windows\System32\drivers\etc</code> ç›®å½•ä¸‹é¢çš„ HOSTS æ–‡ä»¶ï¼Œè®°å¾—è¦ç”¨ç®¡ç†å‘˜èº«ä»½æ‰“å¼€æ‰æœ‰æƒé™å»å†™ã€‚</p><p>åœ¨ HOSTS æ–‡ä»¶ä¸­ï¼Œå¢åŠ å¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 user.com</span><br></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨è®¿é—® <code>http://user.com/signin/name?username=fooboy&amp;userpwd=123</code> å°±å¯ä»¥æˆåŠŸäº†ï¼ˆæ³¨æ„è®¿é—®çš„åŸŸåæ˜¯ <code>user.com</code>ï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆè¯¥APIéœ€è¦è¾“å…¥ç™»å½•è´¦å·å’Œå¯†ç ï¼‰ï¼š</p><p><img src="/upload/images/2020/05/23/2.png"></p><p><strong>æ–¹æ¡ˆäºŒï¼šä¿®æ”¹è™šæ‹Ÿä¸»æœºçš„ç«¯å£</strong></p><p>è¿™ä¸ªéœ€è¦ä¿®æ”¹ Nginx çš„é…ç½®æ–‡ä»¶ï¼Œå°† <code>è‡ªå®šä¹‰è™šæ‹Ÿä¸»æœº2</code> ä¸­çš„ç«¯å£æ”¹ä¸ºé 80 ç«¯å£å·ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è‡ªå®šä¹‰è™šæ‹Ÿä¸»æœº2ï¼šé…ç½®è½¬å‘ç»™ms-useræœåŠ¡ï¼ˆspringbootï¼‰</span></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span>       <span class="number">8085</span>;</span><br><span class="line">    <span class="attribute">server_name</span>  user.com;</span><br><span class="line">    <span class="section">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://localhost:8080;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-Port <span class="variable">$server_port</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹å®Œæˆåï¼Œä¿å­˜æ–‡ä»¶ã€‚</p><p>éœ€è¦é‡æ–°åŠ è½½ <code>Nginx çš„é…ç½®</code>ï¼Œå¯ä»¥åœ¨ç»ˆç«¯è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx.exe -s reload</span><br></pre></td></tr></table></figure><p>é‡æ–°åŠ è½½æˆåŠŸåï¼Œåœ¨æµè§ˆå™¨è®¿é—® <code>http://localhost:8085/signin/name?username=fooboy&amp;userpwd=123</code> å°±å¯ä»¥æˆåŠŸäº†ï¼ˆæ³¨æ„è®¿é—®çš„ç«¯å£æ”¹ä¸ºäº† <code>8085</code>ï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2020/05/23/3.png"></p><p>è‡³æ­¤é—®é¢˜è§£å†³ã€‚</p><hr><p><strong>åªè¦ä½ æ„¿æ„ï¼Œä¸€åˆ‡éƒ½æ¥å¾—åŠ~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot Nginx åå‘ä»£ç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç˜¦èº«ç§˜ç¬ˆ: å…»æˆå¥½ä¹ æƒ¯</title>
      <link href="/2020/05/10/%E7%98%A6%E8%BA%AB%E7%A7%98%E7%AC%88-%E5%85%BB%E6%88%90%E5%A5%BD%E4%B9%A0%E6%83%AF/"/>
      <url>/2020/05/10/%E7%98%A6%E8%BA%AB%E7%A7%98%E7%AC%88-%E5%85%BB%E6%88%90%E5%A5%BD%E4%B9%A0%E6%83%AF/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¹ æƒ¯çš„åŠ›é‡"><a href="#ä¹ æƒ¯çš„åŠ›é‡" class="headerlink" title="ä¹ æƒ¯çš„åŠ›é‡"></a>ä¹ æƒ¯çš„åŠ›é‡</h2><p>å¾—æ­¤ç§˜ç¬ˆè€…ç»ˆç”Ÿå—ç›Šï¼Œç»ƒæ­¤ç§˜ç¬ˆæ— é¡»è‡ªå®«ã€‚</p><hr><p>è¿‡å¹´å› ç–«æƒ…è‚†è™ï¼Œå¤§å®¶åŸºæœ¬éƒ½æ˜¯å¾…åœ¨å®¶ä¸­ã€‚è€å©†è·Ÿæˆ‘è¯´ï¼Œä½ èƒ½ä¸èƒ½å†™ç‚¹éæŠ€æœ¯çš„ä¸œè¥¿å‘€ï¼ŒæŠ€æœ¯æ–‡ç« æˆ‘ä»¬éƒ½çœ‹ä¸æ‡‚ï¼Œä½ å¯ä»¥å†™ç‚¹ç¨‹åºå‘˜å¹³å¸¸æ˜¯æ€ä¹ˆç”Ÿæ´»çš„æ–‡ç« å‘€ï¼Ÿé¢å¯¹å¥¹æ¨é“ä¸æˆé’¢çš„â€œæ„¤æ€’â€ï¼Œæˆ‘ä¹Ÿhinhinçš„åæ€äº†ä¸€æŠŠï¼Œé™¤äº†ä»£ç ä¹‹å¤–ï¼Œç¡®å®æœ‰å¾ˆå¤šä¸œè¥¿å€¼å¾—è¯´å€¼å¾—å†™ã€‚æ¯•ç«Ÿäººä¸èƒ½æ€»æ˜¯é™·å…¥èƒ½åŠ›çš„é™·é˜±ä¸­ï¼Œè¦ä¸æ–­çš„æ‰“ç ´çŸ¥è¯†çš„è¯…å’’ï¼Œä¸æ–­çš„å»æ¢ç´¢å’Œè¡¨è¾¾è‡ªå·±ã€‚</p><p>äºæ˜¯ï¼Œä»Šå¤©åˆ†äº«çš„è¯é¢˜ä¸æŠ€æœ¯åŸºæœ¬æ²¡æœ‰å…³ç³»ï¼Œæˆ‘ä»¬èŠèŠå…³äºå¥åº·ç®¡ç†çš„è¯é¢˜ã€‚</p><p>ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰è¿™æ ·ä¸€ç§æ„Ÿè§‰ï¼Œæ¯å½“åˆ«äººç»™ä½ åˆ†äº«å…³äºä»–è‡ªå·±ä¸€äº›ç»éªŒçš„æ—¶å€™ï¼Œå°¤å…¶è¿™äº›ç»éªŒæˆ‘ä»¬è¿˜æ²¡æœ‰ä½“éªŒè¿‡ï¼Œå°±è§‰å¾—å¯¹æ–¹è¯´çš„ä¸œè¥¿è·ç¦»è‡ªå·±å¾ˆé¥è¿œï¼Œå“ªæ€•å¯¹æ–¹æ˜¯è‹¦å£å©†å¿ƒçš„è°†è°†æ•™å¯¼ï¼Œè‡ªå·±å¯èƒ½ä¹Ÿåªæ˜¯å¿ƒä¸åœ¨ç„‰çš„å¬å¬è€Œå·²ã€‚</p><p>ä»Šå¤©è¦åˆ†äº«çš„æ˜¯å…³äºå¦‚ä½•è°ƒæ•´è‡ªå·±çš„ç”Ÿæ´»ä¹ æƒ¯çš„è¯é¢˜ï¼Œä¸ºäº†èƒ½è®©å¤§å®¶â€œæ¬£ç„¶æ¥å—â€ï¼ˆå¥¢æ±‚ğŸ™ï¼‰ï¼Œæˆ‘ç”¨å®é™…è¡ŒåŠ¨ç¡®å®è®©è‡ªå·±æœ‰æ‰€æ”¹å˜ï¼Œæ‰æ•¢å‘æ–‡ã€‚å¸Œæœ›å¯¹å¤§å®¶æœ‰ç›Šã€‚</p><p>å¯¹äº <code>ç¨‹åºå‘˜ä¿å…»ç§˜ç¬ˆ</code> è¿™ä¸ªè¯é¢˜ï¼Œæˆ‘å‡†å¤‡åˆ†ä¸ºå‡ ç¯‡æ–‡ç« è·Ÿå¤§å®¶åˆ†äº«ï¼Œæœ¬ç¯‡ç®—æ˜¯ä¸€ä¸ªå¯¼è¯»ã€‚æ— è®ºä½ ç°åœ¨æ˜¯å¤„äºç¨‹åºå¼€å‘çš„åˆçº§é˜¶æ®µï¼ˆå°ç™½ğŸ¤ï¼‰ï¼Œè¿˜æ˜¯é«˜çº§ï¼ˆè„±å‘ğŸ˜œï¼‰é˜¶æ®µï¼Œéƒ½å¸Œæœ›ä½ èƒ½åšæŒçœ‹å®Œã€‚å‡è‚¥çš„å‰ææ˜¯ä½ èƒ½å…»æˆå¥½ä¹ æƒ¯å¹¶ä¸”åšæŒä¸‹æ¥ï¼Œåƒä¸‡ä¸è¦è½»æ˜“ç›¸ä¿¡ç½‘ä¸Šæ‰€è°“çš„å‡è‚¥æœºæ„ä»¥åŠä¸€äº›è™šå‡å®£ä¼ ã€‚</p><p>æˆ‘å§‹ç»ˆè®¤ä¸ºåªè¦è‡ªå·±çš„èº«ä½“å„é¡¹æŒ‡æ ‡æ­£å¸¸ï¼ˆæ¯”å¦‚æ²¡æœ‰è„‚è‚ªè‚ï¼Œæ²¡æœ‰é«˜è¡€å‹ç­‰ï¼‰ï¼Œç”Ÿæ´»ä¹ æƒ¯è‰¯å¥½ï¼Œå³ä½¿èƒ–ä¸€ç‚¹ä¹Ÿæ— æ‰€è°“ã€‚ä¸€æ—¦ä½ èƒ½å…»æˆè‰¯å¥½çš„ä¹ æƒ¯ï¼Œæƒ³ä¸ç˜¦éƒ½éš¾å¹¶ä¸”å¯ä»¥å—ç›Šç»ˆç”Ÿã€‚</p><p>ä¸‹é¢æ­£å¼è¿›å…¥å¹ğŸ‚ğŸºçš„æ—¶é—´ã€‚</p><h2 id="BMI-é è°±ä¸ï¼Ÿ"><a href="#BMI-é è°±ä¸ï¼Ÿ" class="headerlink" title="BMI é è°±ä¸ï¼Ÿ"></a>BMI é è°±ä¸ï¼Ÿ</h2><p>åœ¨2019å¹´10æœˆä»½ï¼Œæˆ‘ä½“é‡è¾¾åˆ°äº† <strong>86.5kg</strong>ï¼Œæˆ‘çš„èº«é«˜175cmï¼Œè¿™ä¸ªä½“é‡å¯¹æˆ‘æ¥è¯´å·²ç»è¶…æ ‡äº†ã€‚å½“æ—¶çš„BMIï¼ˆèº«ä½“è´¨é‡æŒ‡æ•°ï¼Œç®€ç§°ä½“è´¨æŒ‡æ•°ï¼‰æŒ‡æ•°å€¼ä¸º <strong>28.2</strong>ï¼Œä¸‹å›¾æ˜¯BMIç›¸å…³çš„æ ‡å‡†ã€‚</p><p><img src="/upload/images/2020/05/10/1.jpg"></p><p>ä»ä¸Šé¢çš„å›¾ä¸­å°±å¯ä»¥çœ‹å‡ºï¼Œæˆ‘å·²ç»å±äºè¿‡åº¦è‚¥èƒ–äº†ã€‚</p><p>è‡ªä»æˆ‘æ”¹å˜äº†çš„ç”Ÿæ´»æ–¹å¼åï¼Œç°åœ¨çš„BMIæŒ‡æ•°å€¼ä¸º23.4ï¼Œè™½ç„¶è¾¾æ ‡äº†ä½†è¿˜æœ‰å¾ˆå¤§çš„ç¼©å‡ç©ºé—´ï¼Œè¿˜éœ€è¦ç»§ç»­åŠªåŠ›ã€‚</p><p>è¿™é‡Œæˆ‘è¦æ™®åŠä¸€ä¸‹å…³äºBMIçš„ç›¸å…³çŸ¥è¯†ï¼Œè¯·å„ä½æ¬å¥½å°æ¿å‡³è®¤çœŸå¬ã€‚</p><p>BMIå°±æ˜¯æ‰€è°“çš„â€œä½“è´¨æŒ‡æ•°â€ï¼Œè®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š<br>$$<br>BMI &#x3D; ä½“é‡kg &#x2F; ï¼ˆèº«é«˜mï¼‰^2<br>$$<br>å³ä½“é‡é™¤ä»¥èº«é«˜çš„å¹³æ–¹å¾—åˆ°çš„å€¼å°±æ˜¯ BMI å€¼ã€‚çœ‹åˆ°è¿™ä¸ªå…¬å¼ï¼Œè°ƒçš®çš„å°ä¼™ä¼´å¯èƒ½ä¼šè¯´ä½ æ˜¯ä¸æ˜¯é•¿é«˜äº†æ‰€ä»¥BMIå€¼æ‰å˜ä½çš„ğŸ¤­ï¼Œæˆ‘éƒ½å‡ åå²çš„äººäº†ï¼Œé•¿é«˜å·²ç»æ˜¯å¯æœ›ä¸å¯åŠäº†ã€‚</p><p>ä¸‹é¢æ˜¯å¼•ç”¨è‡ªä½œè€… <code>ä»°æœ›å°¾è¿¹äº‘</code> çš„ ã€Šæˆ‘çš„æœ€åä¸€æœ¬å‡è‚¥ä¹¦ã€‹é‡Œé¢çš„å†…å®¹ã€‚</p><blockquote><p>ä»å…¬å¼ä¸Šçœ‹ï¼ŒBMIå°±ç›¸å½“äºæŠŠäººå‡åŒ€åœ°å‰æˆå‡ æ®µï¼Œç§°ä¸€ç§°å•ä½èº«é«˜é‡Œäººçš„ä½“é‡ã€‚æ‰€ä»¥ï¼Œä½“é‡è¶Šé‡ï¼Œèº«é«˜è¶Šä½ï¼ŒBMIä¹Ÿå°±è¶Šé«˜ã€‚BMIåæ˜ äº†äººâ€œæ¨ªå‘å‘å±•â€çš„ç¨‹åº¦ï¼Œè¶Šèƒ–çš„ äººï¼ŒBMIè‡ªç„¶è¶Šé«˜ã€‚BMIè‡ª20ä¸–çºªäº”å…­åå¹´ä»£å°±å¼€å§‹ç”¨ã€‚ä½†BMIå¤šå°‘ç®—è‚¥èƒ–ï¼Œå¤šå°‘ç®—æ­£å¸¸ï¼Œä¸åŒå›½å®¶å’Œç»„ç»‡ï¼Œè§„å®šéƒ½ä¸ä¸€æ ·ã€‚è¥¿æ–¹çš„æ ‡å‡†ä¸€èˆ¬ç•¥ä½ã€‚æˆ‘å›½çš„æ ‡å‡†ï¼ŒBMIå€¼18.5ï½24ç®—ä½“é‡æ­£å¸¸ï¼Œ24ï½28ç®—è¶…é‡ï¼Œä½†è¿˜ä¸ç®—è‚¥èƒ–ï¼Œè¶…è¿‡28ç®—è‚¥èƒ–ã€‚</p></blockquote><blockquote><p>ä½†BMIä¹Ÿä¸æ˜¯ç»å¯¹æ ‡å‡†ã€‚å¯¹å¤§å¤šæ•°æ™®é€šäººæ¥è¯´ï¼ŒBMIæœ‰ç›¸å¯¹è¾ƒå¥½çš„æŒ‡å¯¼æ„ä¹‰ï¼Œä½†BMIä¹Ÿæœ‰ä¸¤ä¸ªé‡è¦ç¼ºé™·ã€‚</p><p>é¦–å…ˆï¼ŒBMIä¸åŒºåˆ†è„‚è‚ªå’Œè‚Œè‚‰ï¼Œæœ‰äº›äººè¶…é‡ï¼Œæ˜¯è„‚è‚ªå¤ªå¤šï¼›ä½†ä¹Ÿæœ‰äº›äººè¶…é‡ï¼Œæ˜¯è‚Œè‚‰æ¯”ä¾‹å¤§ï¼Œæ¯”å¦‚åŠ›é‡å‹è¿åŠ¨å‘˜ã€‚ä»–ä»¬ä½“é‡å¤§æ˜¯å› ä¸ºè‚Œè‚‰å‘è¾¾ï¼Œæ‰€ä»¥ä¸èƒ½å«â€œèƒ–â€ã€‚ç”¨BMIè¡¡é‡è¿™äº›äººçš„å¥åº·æˆ–è€…èƒ–ç˜¦ï¼Œä»–ä»¬å°±å¾ˆå†¤æ‰ã€‚æœ‰æ•°æ®ç§°ï¼Œç¾å›½2004â€”2005èµ›å­£çš„1124åæ©„æ¦„çƒè¿åŠ¨å‘˜ä¸­ï¼ŒBMIè¶…è¿‡30çš„æœ‰43%ï¼Œè¶…è¿‡35çš„æœ‰14%ã€‚çœ‹èµ·æ¥å¾ˆå¯æ€•ï¼Œä½†å…¶å®è¿™äº›è¿åŠ¨å‘˜èº«ä½“å¥åº·å¾—ä¸å¾—äº†ï¼Œä¸€ä¸ªä¸ªä¹Ÿéƒ½ä¸èƒ–ã€‚</p><p>å…¶æ¬¡ï¼ŒBMIä¸åŒºåˆ†è„‚è‚ªçš„åˆ†å¸ƒä½ç½®ï¼Œè¿™ä¹Ÿæ˜¯ä¸ªå¤§é—®é¢˜ã€‚ä»å¥åº·çš„è§’åº¦è®²ï¼Œå†…è„è„‚è‚ªå’Œçš®ä¸‹è„‚è‚ªï¼Œå‰è€…è¦æ¯”åè€…å±é™©å¾—å¤šï¼Œä½†BMIå¯åˆ†ä¸å‡ºè„‚è‚ªé•¿åœ¨å“ªå„¿ã€‚ä¸¤ä¸ªèº«é«˜ä½“é‡ä¸€æ ·çš„äººï¼Œä¸€ä¸ªèƒ–å¾—å¾ˆå‡åŒ€ï¼Œä¸€ä¸ªè„‚è‚ªéƒ½é›†ä¸­åœ¨å†…è„å¤„ï¼Œä»å¥åº·å’Œå®¡ç¾çš„è§’åº¦è®²ï¼Œè¿™ä¸¤ä¸ªäººå®Œå…¨ä¸åŒï¼Œä½†BMIå´æ˜¯ä¸€æ ·çš„ã€‚æ‰€ä»¥ï¼ŒBMIé«˜ï¼Œä¸ä¸€å®šå°±æ˜¯èƒ–ï¼Œä¹Ÿä¸ä¸€å®šå°±ä¸å¥åº·ï¼›BMIä½ï¼Œä¸ä¸€å®šå°±ä¸èƒ–ï¼Œä¹Ÿä¸ä¸€å®šç»å¯¹å¥åº·ã€‚BMIå¤ªç²—ç•¥ï¼Œæ‰€ä»¥æœ‰äº›é—®é¢˜è¿˜è¦å…·ä½“æ¥çœ‹ã€‚é‚£ä¸ºä»€ä¹ˆBMIåœ¨å…¨ä¸–ç•Œè¢«å¹¿æ³›ä½¿ç”¨äº†åŠä¸ªä¸–çºªï¼Ÿå®é™…ä¸Šè¿™ä¹Ÿæ˜¯æ²¡åŠæ³•çš„åŠæ³•ã€‚å‡†ç¡®åœ°æµ‹é‡äººçš„è„‚è‚ªå«é‡ï¼Œå¹¶ä¸”æ˜ç¡®è„‚è‚ªçš„åˆ†å¸ƒä½ç½®ï¼Œéš¾åº¦å¾ˆå¤§ï¼Œåªæœ‰åœ¨å®éªŒå®¤æˆ–è€…åŒ»é™¢æ‰èƒ½æµ‹å‡ºæ¥ã€‚ç»å¤§å¤šæ•°äººï¼Œä¸å¯èƒ½æœ‰æ¡ä»¶ç»å¸¸å»åšä½“æˆåˆ†æµ‹è¯•ã€‚</p></blockquote><blockquote><p>BMIæœ€å¤§çš„å¥½å¤„å°±æ˜¯ç®€å•ï¼ŒçŸ¥é“èº«é«˜ä½“é‡å°±èƒ½ç®—å‡ºæ¥ã€‚è™½ç„¶æœ‰è¯¯åˆ¤ï¼Œä½†ç›¸å¯¹æ¥è¯´ï¼Œæ•ˆç”¨ä»·æ ¼æ¯”è¿˜æ˜¯å¾ˆé«˜çš„ï¼Œé€‚åˆå¤§èŒƒå›´äººç¾¤ä½¿ç”¨ã€‚ä¸ç”¨BMIçš„è¯ï¼Œä¹Ÿç¡®å®æ²¡æœ‰æ›´å¥½çš„åŠæ³•æ¥è¡¡é‡äººçš„èº«é«˜ä½“é‡å’Œå¥åº·çš„å…³ç³»äº†ã€‚</p></blockquote><p>æ€»ä¹‹ï¼Œå¦‚æœä½ æ²¡æœ‰ç»å¸¸è¿åŠ¨æˆ–è€…å»å¥èº«ï¼ˆä½å¤´çœ‹çœ‹è‡ªå·±è‚šå­ä¸Šé¢çš„è‚‰å§ï¼‰ç”¨BMIæ¥çœ‹è‡ªå·±æ˜¯å¦åèƒ–ï¼Œç®—æ˜¯æ¯”è¾ƒé è°±çš„è¡¡é‡æ ‡å‡†äº†ã€‚å¦‚æœä½ åç˜¦çš„è¯ï¼Œå°±éœ€è¦ç¨å¾®è¡¥å……ä¸€ä¸‹è¥å…»äº†ï¼Œæ¯•ç«Ÿå¤ªç˜¦äº†å¯¹èº«ä½“ä¹Ÿä¸å¥½è¿˜å½±å“åŠ ç­çš„æ•ˆç‡ï¼</p><h2 id="ç®—æ˜¯å¥½ä¹ æƒ¯å§"><a href="#ç®—æ˜¯å¥½ä¹ æƒ¯å§" class="headerlink" title="ç®—æ˜¯å¥½ä¹ æƒ¯å§"></a>ç®—æ˜¯å¥½ä¹ æƒ¯å§</h2><p>è¯´å®è¯ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆæ¥å®šä¹‰ä»€ä¹ˆæ˜¯å¥½ä¹ æƒ¯ï¼Œå‡¡æ˜¯è®©ä½ å—ç›Šçš„ä¹ æƒ¯æˆ‘è§‰å¾—éƒ½ç®—æ˜¯å¥½ä¹ æƒ¯ã€‚æˆ‘æŠŠè‡ªå·±å—ç›Šçš„é‚£äº›ä¹ æƒ¯åˆ†äº«ç»™æ­£åœ¨çœ‹æ­¤æ–‡çš„ä½ ã€‚</p><p>ä¸‹é¢è¿™äº›ä¹ æƒ¯æš‚æ—¶ä¸å±•å¼€è¯´ï¼Œåç»­çš„æ–‡ç« ä¼šè¯¦ç»†çš„ä»‹ç»ã€‚</p><p><strong>1ã€æ—©ç¡æ—©èµ·</strong></p><p>å¯¹äºç»å¤§éƒ¨åˆ†ç”Ÿæ´»åœ¨å¤§åŸå¸‚çš„å¹´è½»äººï¼Œå°¤å…¶è¿™äº›å¹´è½»äººæ˜¯ç¨‹åºå‘˜çš„è¯ï¼Œæ—©ç¡ç®€ç›´æ˜¯è®©äººæœ›å°˜è«åŠäº†ï¼Œ996ç”šè‡³997çš„æ—¥å­ä¹ ä»¥ä¸ºå¸¸ï¼Œæ¯æ™šå›åˆ°å®¶åŸºæœ¬éƒ½æ˜¯22ç‚¹åäº†ï¼Œæ´—ä¸ªæ¾¡åˆ·ä¸ªdéŸ³èŠä¸ªwä¿¡å†ç»™è‡ªå·±è¿œæ–¹çš„å¥³æœ‹å‹æ‰“ä¸ªç”µè¯ï¼Œä¼°è®¡éƒ½å‡Œæ™¨äº†ï¼ŒçŒ›ä¸€ç‚¹çš„å¯èƒ½è¦åˆ°å‡Œæ™¨2ã€3ç‚¹æ‰å¼€å§‹ç¡è§‰ï¼Œæ—©èµ·å°±å˜å¾—æ›´éš¾äº†ã€‚</p><p>æ™šç¡çš„åå¤„è‡ªç„¶ä¸ç”¨æˆ‘å¤šè¯´ï¼Œå¤§å®¶å¿ƒé‡Œéƒ½è·Ÿæ˜é•œä¼¼çš„ã€‚æˆ‘ä¸ªäººè§‰å¾—åœ¨å¤§åŸå¸‚å¥‹æ–—çš„å¹´è½»äººï¼Œèƒ½åœ¨24ç‚¹å‰ä¸€ç‚¹ç‚¹ç¡è§‰ï¼Œæ”¾ä¸‹æ‰‹æœºä¹Ÿç®—æ˜¯â€˜ç«‹åœ°æˆä½›â€™äº†ã€‚ä¸è¿‡æ…¢æ…¢å…»æˆä¹ æƒ¯å§ï¼ŒåšæŒä¸€æ®µæ—¶é—´åå†æŠŠæ—©ç¡æ—¶é—´å¾€å‰è°ƒæ•´ä¸€ç‚¹ï¼Œå¾ªåºæ¸è¿›çš„å»è°ƒæ•´è‡ªå·±ã€‚æ—©ä¸Šå°½é‡åœ¨8å‰èµ·åºŠï¼Œæœ‰æ¡ä»¶çš„æœ‹å‹å¯ä»¥è‡ªåˆ¶æ—©é¤ï¼Œä¸€æ¯çƒ­ç‰›å¥¶ï¼Œä¸€ä¸ªæ–°é²œé¸¡è›‹ï¼Œä¸€ä¸ªè‹¹æœæˆ–è€…é¦™è•‰å°±æå®šäº†ã€‚</p><p><strong>2ã€è§„å¾‹é¥®é£Ÿ</strong></p><p>æ—©é¤å°½é‡åœ¨<strong>9ç‚¹å‰</strong>æå®šï¼Œæ ¹æ®è‡ªå·±çš„å–œå¥½ï¼Œæ—©ä¸Šå¯ä»¥å¤šåƒä¸€ç‚¹ï¼Œå°¤å…¶æ˜¯ç–«æƒ…æœŸé—´è›‹ç™½è´¨çš„è¡¥å……åƒä¸‡ä¸èƒ½å°‘ã€‚</p><p>åˆé¤ä»¥è”¬èœä¸ºä¸»ï¼ŒåŠ ç‚¹ç‰ç±³æˆ–è€…çº¢è–¯ä¹‹ç±»çš„ç²—ç²®ï¼Œä¹Ÿå¯ä»¥é€‚å½“çš„åƒç‚¹è‚‰ä½†åƒä¸‡ä¸è¦å¤ªæ²¹è…»ï¼ŒåƒçŒªè‚˜å­å‘€åˆ«äººåƒä¸€ä¸ªï¼Œä½ æœ€å¥½åƒä¸€åŠç”šè‡³æ›´å°‘ä¸€ç‚¹ã€‚æœ‰äººè¯´äº†ä¸‡ä¸€è¦æ˜¯æ²¡å¿ä½åƒå¤šäº†å‘¢ï¼Œé‚£æ€ä¹ˆåŠï¼Ÿé…’è‚‰ç©¿è‚ è¿‡ï¼Œä½›ç¥–å¿ƒä¸­ç•™ğŸ˜„ã€‚å—¯ï¼Œå¶å°”å‡ ä¸‹ä¹Ÿæ²¡æœ‰å…³ç³»äº†ï¼Œä½ åªè¦åœ¨æ¥ä¸‹æ¥çš„ä¸€ä¸¤å¤©å†…é€šè¿‡è¿åŠ¨æŠŠä»–æ¶ˆè€—æ‰å°±å¯ä»¥äº†ã€‚</p><p>æ™šé¤æœ€å¥½åœ¨<strong>19ç‚¹å‰</strong>å°±åƒå®Œï¼Œä¸»é£Ÿé€‚å½“çš„å°‘ä¸€ç‚¹ï¼Œä¸»é£Ÿè¿˜æ˜¯ä»¥å¤§ç±³ä¸ºä¸»å§ï¼ŒåŒç­‰è´¨é‡çš„é¢é£Ÿè¦æ¯”å¤§ç±³çš„çƒ­é‡é«˜ï¼Œå¤šåƒç‚¹èœã€‚å¦‚æœæ™šä¸Šä½ èƒ½å¿ä½ä¸åƒè‚‰é‚£å°±æ›´å¥½äº†ï¼Œæ™šé¤å°½é‡ä¿è¯ä½ç›ä½æ²¹é¥®é£Ÿï¼Œé‡åˆ°æ™šä¸ŠåŠ ç­æˆ–è€…å¼€ä¼šè‚šå­é¥¿äº†å¯ä»¥é€‚å½“è¡¥å……ä¸€ç‚¹é«˜çº¤ç»´é¢åŒ…å’Œç‰›å¥¶ï¼Œç¡è§‰å‰2ä¸ªå°æ—¶å†…å°±ä¸è¦åƒä¸œè¥¿äº†ã€‚</p><p>æ€»ä¹‹ï¼Œä¸€æ—¥ä¸‰é¤æŒ‰æ—¶åƒé¥­ï¼Œè”¬èœä¸ºä¸»ï¼Œä¸»é£Ÿä¸ºè¾…ï¼Œ8åˆ†é¥±å°±å¯ä»¥äº†ï¼Œé€‚å½“çš„ç»™èƒƒå’Œè‚ é“ç•™ç‚¹è¿åŠ¨çš„ç©ºé—´ï¼Œåªæœ‰å®ƒä»¬èˆ’æœäº†ä½ æ‰èƒ½é«˜æ•æ— å¿§ã€‚</p><p><strong>PS</strong>ï¼šæˆ‘ä¹‹å‰ä½¿ç”¨è¿‡ä¸åƒæ™šé¤çš„æ–¹æ³•æ¥å‡è‚¥ï¼Œè‹¦è‹¦çš„åšæŒäº†40å¤šå¤©ï¼Œç»“æœä¸€ä¸ªæœ‹å‹çš„æ™šå®´è®©æˆ‘å½»åº•çªç ´äº†è‡ªå·±çš„é˜²çº¿ï¼Œæˆ‘æ‰¿è®¤é‚£ä¸€æ™šæˆ‘æ’‘åˆ°äº†ã€‚æœ€åå¯æƒ³è€ŒçŸ¥ï¼Œä½“é‡è¿˜æ˜¯åå¼¹å›æ¥äº†å¹¶ä¸”æ¯”ä¹‹å‰æ›´èƒ½åƒäº†ã€‚æ‰€ä»¥ï¼Œä¸åƒé¥­å‡è‚¥å¯¹äºç»å¤§å¤šæ•°çš„äººæ¥è¯´æ˜¯è¡Œä¸é€šçš„ï¼Œåªæœ‰åƒé¥±äº†æ‰èƒ½æœ‰åŠ›æ°”å‡è‚¥å˜›ï¼</p><p><strong>3ã€ç»å¸¸å–æ°´</strong></p><p>è¿™é‡Œçš„æ°´æŒ‡çš„ä¸æ˜¯å¯ä¹ï¼Œé›ªç¢§ä¹‹ç±»çš„é¥®æ–™ï¼Œè€Œæ˜¯ç™½å¼€æ°´ï¼ˆé€‚å½“çš„åŠ ç‚¹æ–™ä¹Ÿå¯ä»¥ï¼Œæ¯”å¦‚æŸ æª¬ç‰‡ï¼Œæ¸æï¼ŒèŒ¶å¶ï¼‰ã€‚</p><p>ç»å¸¸å–æ°´æœ‰åŠ©äºèº«ä½“çš„æ–°é™ˆä»£è°¢ï¼Œç‰¹åˆ«æ˜¯åƒç˜¦ä¸‹æ¥çš„æœ‹å‹ä»¬ï¼Œå¤šå–æ°´å¯ä»¥ä¿ƒè¿›è„‚è‚ªçš„ç‡ƒçƒ§ã€‚è¿˜æœ‰å¦‚æœä½ æœ‰è‚¾ç»“çŸ³ä¹‹ç±»çš„ç–¾ç—…æ›´åº”è¯¥å¤šå–æ°´ï¼Œæ°´å–çš„é‡å¤Ÿäº†ä¸Šå•æ‰€ä¹Ÿä¼šé¢‘ç¹ï¼Œè¿˜å¯ä»¥ä¿ƒè¿›è¿åŠ¨ï¼Œä¸€ä¸¾ä¸¤å¾—ã€‚</p><p>å–æ°´å¯ä»¥ä¿æŒæ¯15åˆ†é’Ÿå–2~3å£çš„æ ·å­ï¼Œä¸è¦è±ªé¥®ï¼Œæ…¢æ…¢å…»æˆä¹ æƒ¯å°±å¥½äº†ï¼Œæœ€å¥½ä¸è¦ç­‰ç€è‡ªå·±æ¸´äº†å†æ¥å–æ°´ï¼Œè®©å–æ°´å˜æˆè‚Œè‚‰è®°å¿†ã€‚æ—©èµ·ä¸€æ¯æ¸©å¼€æ°´å¯ä»¥æ¸…è‚ é“ï¼Œç”¨é¤å‰ä¸€æ¯æ°´æœ‰åˆ©äºå¢å¼ºé¥±è…¹æ„Ÿå‡å°‘ç”¨é¤é‡ï¼Œé—´æ¥åœ°å¯ä»¥å‡å°‘çƒ­é‡çš„æ‘„å…¥ã€‚</p><p><strong>4ã€é€‚å½“è¿åŠ¨</strong></p><p>ä½ æ˜¯å¦ç»å¸¸ååœ¨ä½ç½®ä¸Šç‚¹å¤–å–åƒï¼Ÿå¦‚æœæ˜¯æˆ‘å»ºè®®ä½ æ”¹å˜ä¸€ä¸‹è‡ªå·±è¿™ä¸ªä¹ æƒ¯ï¼Œå¯ä»¥é€‰æ‹©å»æ¥¼ä¸‹è·ŸåŒäº‹ä¸€èµ·ç”¨é¤ï¼Œæ—¢å¯ä»¥å¢åŠ è¿åŠ¨åˆå¯ä»¥ä¿ƒè¿›ä¸åŒäº‹ä¹‹é—´çš„äº¤æµï¼Œé¥­å‰é¥­åèµ°ä¸€èµ°ï¼Œæœ‰åŠ©äºæ¶ˆåŒ–å’Œå¸æ”¶ï¼Œå‡å°‘è„‚è‚ªçš„å †ç§¯ã€‚</p><p>ä¸€æåˆ°è¿åŠ¨ï¼Œå¤§å®¶å¿ƒé‡Œé¢æƒ³åˆ°çš„ä¸€èˆ¬éƒ½æ˜¯é‚£ç§å¤§æ±—æ·‹æ¼“çš„åœºé¢æ‰ç®—æ˜¯è¿åŠ¨ã€‚å…¶å®è¿åŠ¨æœ‰å¾ˆå¤šç§ï¼Œå¦‚æœä½ ä¸èƒ½è·‘æ­¥å°±é€‰æ‹©å¿«èµ°ï¼Œå¦‚æœä½ è§‰å¾—å¿«èµ°è¿˜æ˜¯å¾ˆç´¯é‚£å°±æ…¢èµ°ï¼Œåæ­£åŠ¨èµ·æ¥æ¯”åä¸‹æ¥è¦å¥½ä¸€äº›ã€‚ç‰¹åˆ«æ˜¯æ¯”è¾ƒèƒ–çš„äººï¼Œè·‘æ­¥è¦ç‰¹åˆ«æ³¨æ„è‡ªå·±çš„è†ç›–ï¼Œä½“é‡åèƒ–å¯¹è†ç›–çš„ä¼¤å®³æ˜¯å¾ˆå¤§çš„ã€‚</p><p>å¯ä»¥ä½¿ç”¨ NEATï¼ˆNon-Exercise Activity Thermogenesisï¼Œå³éè¿åŠ¨æ€§çƒ­æ¶ˆè€—ï¼‰æ³•æ¥å¢åŠ è‡ªå·±çš„çƒ­é‡æ¶ˆè€—ï¼Œæˆ‘æ€»ç»“äº†ä¸€ä¸‹è‡ªå·±ä½¿ç”¨çš„ NEAT å°ä¹ æƒ¯ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="/upload/images/2020/05/10/2.png"></p><p>è¿™é‡Œæˆ‘ç€é‡æä¸€ä¸‹æ”¶è…¹è¿™ä¸ªå°åŠ¨ä½œï¼Œç»å¸¸ä¿æŒæ”¶è…¹çš„åŠ¨ä½œå¯ä»¥å¢å¼ºè…¹éƒ¨çš„ç»ƒä¹ ï¼Œæœ‰åˆ©äºç˜¦è‚šå­ã€‚å½“ç„¶äº†è¿™ä¸ªè¿‡ç¨‹å¾ˆæ…¢ï¼Œä¸€æ—¦ä½ ä¹ æƒ¯äº†è¿™ä¸ªåŠ¨ä½œï¼Œæˆ‘æ•¢ä¿è¯è¦ä¸äº†å¤šä¹…è‚¯å®šæœ‰åŒäº‹è¯´ä½ ç˜¦äº†è®¸å¤šã€‚</p><p><strong>5ã€æˆ’çƒŸé™é…’</strong></p><p>ä¹‹å‰æœ‰å¾ˆå¤šæœ‹å‹éƒ½æˆ’çƒŸäº†ï¼Œæœ‰çš„æˆ’äº†åŠå¹´ï¼Œæœ‰çš„æˆ’äº†å‡ å¹´ï¼Œæœ€åè¿˜æ˜¯æŠ½ä¸Šäº†ï¼Œæˆ’çƒŸæ˜¯ä¸€ä¸ªå€¼å¾—ç ”ç©¶å’Œæ¢è®¨çš„è¯¾é¢˜ã€‚æ‰€ä»¥ï¼Œæˆ‘å¹¶æ²¡æœ‰æœŸæœ›ä½ è¯»åˆ°è¿™é‡Œå°±ç«‹å³æˆ’çƒŸäº†ã€‚</p><p>æˆ’çƒŸæœ€éš¾çš„æ˜¯å¦‚ä½•æ¶ˆé™¤å†…å¿ƒçš„é‚£ç§å¤±è½çš„ææƒ§æ„Ÿï¼Œä¸€çƒŸåœ¨æ‰‹ï¼Œå¤©ä¸‹æˆ‘æœ‰çš„æ„Ÿè§‰è®©äººéš¾ä»¥å‰²èˆã€‚</p><p>æˆ‘è‡ªå·±æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªçƒŸæ°‘ï¼Œæ­£åœ¨æˆ’çƒŸçš„è‹¦éš¾ä¸­è‹¦è‹¦æŒ£æ‰ç€ï¼Œç­‰æˆ‘å“ªä¸€å¤©çœŸæ­£æˆ’æ‰äº†å†æ¥åˆ†äº«è¿™ä¸ªå¿ƒè·¯å†ç¨‹ã€‚</p><p>æˆ’é…’ï¼Œå¯¹äºæœ‰é…’ç˜¾çš„æœ‹å‹ä¹Ÿæ˜¯å¾ˆéš¾çš„ä¸€ä»¶äº‹æƒ…ï¼Œä½†æ˜¯é™é…’æˆ‘è§‰å¾—è¿˜æ˜¯è¦å»å°è¯•ä¸€ä¸‹çš„ï¼Œå°‘å–ç‚¹ä¸è‡³äºé‚£ä¹ˆä¼¤è‚å§ã€‚æœ¬äººå¯¹é…’ä¸æ„Ÿå…´è¶£ï¼Œä¹ŸåŸºæœ¬ä¸å–ï¼Œå› ä¸ºä¸€å–å°±é†‰ï¼Œå®åœ¨æ²¡æœ‰è¿™ä¸ªå¤©èµ‹ã€‚</p><p>è¿˜æœ‰å¾ˆå¤šå¥½çš„ä¹ æƒ¯æ²¡æœ‰ä¸€ä¸€åˆ—ä¸¾å‡ºæ¥ï¼Œæ¯”å¦‚æ—©æ™šåˆ·ç‰™ï¼ˆå¦‚æœä½ å–œæ¬¢ç”šè‡³å¯ä»¥æ—©ä¸­æ™šåˆ·ç‰™ğŸ˜œï¼‰ã€è¿˜æœ‰é™ä½åƒé¥­é€Ÿåº¦ã€åˆä¼‘ç­‰ç­‰ï¼Œæ€»ä¹‹ä½ æœ‰å¤šè‡ªå¾‹å°±æœ‰å¤šè‡ªç”±ï¼</p><hr><p><strong>å‹¿ä»¥æ¶å°è€Œä¸ºä¹‹ï¼Œå‹¿ä»¥å–„å°è€Œä¸ä¸º~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¹ æƒ¯ è‡ªå¾‹ å¥åº· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡: Adminä¸æœåŠ¡ç›‘æµ‹å’Œç®¡ç†</title>
      <link href="/2020/05/03/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Admin%E4%B8%8E%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%B5%8B%E5%92%8C%E7%AE%A1%E7%90%86/"/>
      <url>/2020/05/03/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Admin%E4%B8%8E%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%B5%8B%E5%92%8C%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><code>Spring Boot Admin</code> å¹¶ä¸æ˜¯ Spring Boot å®˜æ–¹å‡ºå“çš„ï¼Œå¼€æºåœ°å€ <a href="https://github.com/codecentric/spring-boot-admin">SpringBoot Admin</a>ï¼Œä¼´éšç€ SpringBoot çš„æ›´æ–°ï¼Œ<code>Spring Boot Admin</code> ä¹Ÿåšäº†ç›¸å¯¹åº”çš„æ›´æ–°ã€‚Spring Boot æ¨å‡º 2.X ç‰ˆæœ¬æ—¶ï¼Œ<code>Spring Boot Admin</code> ä¹ŸåŠæ—¶è¿›è¡Œäº†æ›´æ–°ã€‚æœ¬ç¯‡ä½¿ç”¨çš„å°±æ˜¯ <code>Spring Boot Admin</code> 2.2.1ç‰ˆæœ¬ï¼Œæœ€æ–°ç‰ˆæœ¬æ˜¯ <code>2.2.2</code>ã€‚ <code>Spring Boot Admin</code>  åˆ†ä¸º <code>client</code> å’Œ <code>server</code> ç«¯ï¼Œ<code>server</code> ç«¯ä¸€èˆ¬ç‹¬ç«‹ä¸ºä¸€ä¸ªæœåŠ¡ï¼Œ<code>client</code> å¯ä»¥æ˜¯ä½ å·²ç»å¼€å‘å®Œæˆçš„æœåŠ¡ï¼Œä¹Ÿå¯ä»¥æ˜¯ä½ å³å°†è¦å¼€å‘çš„æœåŠ¡ã€‚</p><p>å¯¹ <code>Spring Boot Admin</code>  2.x ç‰ˆæœ¬çš„å…·ä½“çš„æ›´æ–°å†…å®¹å’Œå˜åŒ–æ„Ÿå…´è¶£çš„æœ‹å‹ï¼Œå¯ä»¥å‚è€ƒ <a href="https://github.com/codecentric/spring-boot-admin/blob/master/spring-boot-admin-docs/src/main/asciidoc/changes-2.x.adoc">changes-2.x.adoc</a> æ–‡æ¡£ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</p><p>ç»§ä¸Šä¸€ç¯‡ <a href="http://www.veryitman.com/2020/05/01/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Actuator%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%B5%8B/">å¾®æœåŠ¡-Actuatorå®ç°æœåŠ¡ç›‘æµ‹</a>ï¼Œæˆ‘ä»¬è¯´åˆ°ä½¿ç”¨ <code>Actuator</code> ç»„ä»¶å¯ä»¥å®ç°å¯¹æœåŠ¡çš„ç›‘æµ‹ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼æ²¡æœ‰ç®¡ç†ç•Œé¢ä½“éªŒå¾ˆä¸å‹å¥½ã€‚æœ¬ç¯‡ç»§ç»­å­¦ä¹ å…³äº Admin çš„çŸ¥è¯†ï¼Œè¯¥ç»„ä»¶ä¸ä»…å›Šæ‹¬äº† <code>Actuator</code> çš„åŠŸèƒ½ï¼Œè¿˜æä¾›äº†ç®¡ç†ç•Œé¢ï¼Œä½¿ç”¨èµ·æ¥æ¯”è¾ƒæ–¹ä¾¿ã€‚</p><p>æœ¬ç¯‡ä¸»è¦å†…å®¹ï¼Œå¦‚ä¸‹ï¼š</p><ul><li><p>é€šè¿‡ HTTP æ–¹å¼é›†æˆå’Œä½¿ç”¨ <code>spring-boot-admin-server</code>ï¼›</p></li><li><p>å¦‚ä½•å®‰å…¨çš„ä½¿ç”¨ <code>spring-boot-admin</code>ï¼Œè¿™é‡ŒåˆåŒ…å«ä¸¤ä¸ªå†…å®¹:</p></li><li><ul><li>å¦‚ä½•å°† <code>spring-boot-admin-server</code> ç»“åˆ <code>spring-boot-security</code>ï¼Œå®ç°å®‰å…¨ç®¡æ§ä»¥åŠå¦‚ä½•é…ç½®ï¼›</li><li>å¦‚ä½•å°† <code>spring-boot-admin-client</code> ç»“åˆ <code>spring-boot-security</code>ï¼Œå®ç°å®‰å…¨ç®¡æ§ä»¥åŠå¦‚ä½•é…ç½®ï¼›</li></ul></li></ul><p>å®Œæ•´å·¥ç¨‹ä»£ç ï¼Œè¯·ç§»æ­¥ <a href="https://github.com/veryitman/MSTutorial">Github</a> ä¸‹è½½ã€‚åç»­ä¼šç»“åˆ  <code>spring-cloud</code> ä¸­çš„ <code>Eureka</code> ç»„ä»¶å†æ¬¡å­¦ä¹ å’Œåˆ†äº«ä½¿ç”¨  <code>spring-boot-admin</code>ã€‚  </p><h2 id="é…ç½®-Admin-Server"><a href="#é…ç½®-Admin-Server" class="headerlink" title="é…ç½® Admin Server"></a>é…ç½® Admin Server</h2><p>ä¸ºäº†å­¦ä¹ å’ŒéªŒè¯ <code>Spring Boot Admin</code> çš„ä½¿ç”¨ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ª <code>Admin-Server</code>å·¥ç¨‹å³ <code>ms-admin</code>ï¼Œåˆ›å»ºäº†ä¸¤ä¸ª <code>Admin-Client</code> å·¥ç¨‹å³ <code>ms-user</code> å’Œ <code>ms-admin-client</code>ï¼Œå·¥ç¨‹ç»“æ„å¦‚ä¸‹å›¾:</p><p><img src="/upload/images/2020/05/03/1.png"></p><p><code>ms-user</code> å’Œ <code>ms-admin-client</code> ä¸åŒç‚¹åœ¨äºï¼š<code>ms-user</code> ä½¿ç”¨äº† <code>spring-boot-security</code> æ¨¡å—ï¼Œè€Œ <code>ms-admin-client</code> æ²¡æœ‰ä½¿ç”¨  <code>spring-boot-security</code>  æ¨¡å—ï¼Œæ˜¯ä¸€ä¸ªç›¸å¯¹æ¯”è¾ƒç®€å•çš„ SpringBoot æœåŠ¡ã€‚</p><h3 id="1ã€é…ç½®-ms-admin"><a href="#1ã€é…ç½®-ms-admin" class="headerlink" title="1ã€é…ç½® ms-admin"></a>1ã€é…ç½® <code>ms-admin</code></h3><p>åœ¨è¯¥ module çš„ <code>properties</code> æ–‡ä»¶ä¸­ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">spring.application.name=Admin-Server</span><br><span class="line"># ---------------------------------</span><br><span class="line"># é…ç½®è¯¥æœåŠ¡çš„ç‹¬ç«‹ç«¯å£</span><br><span class="line"># ---------------------------------</span><br><span class="line">server.port=8087</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼šè¯¥æœåŠ¡çš„ç«¯å£ä¸º <code>8087</code>ã€‚</strong></p><p>è¯¥ module çš„ pom æ–‡ä»¶ï¼Œä½¿ç”¨äº† <code>spring-boot</code> ç‰ˆæœ¬ä¸º <code>2.2.6.RELEASE</code>ï¼Œ<code>spring-boot-admin</code> ç‰ˆæœ¬ä¸º <code>2.2.1</code>ï¼Œè¿™é‡Œä¸€å®šè¦æ³¨æ„ç‰ˆæœ¬çš„åŒ¹é…ï¼Œå¦åˆ™å·¥ç¨‹è¿è¡Œä¼šå­˜åœ¨å„ç§å¥‡è‘©é—®é¢˜ã€‚è¿™é‡Œæ•™å¤§å®¶ä¸€ä¸ªæ–¹æ³•ï¼Œå¦‚æœä½ ä¸çŸ¥é“å¦‚ä½•åŒ¹é…ç‰ˆæœ¬ï¼Œç›´æ¥ä½¿ç”¨ <a href="https://start.spring.io/">spring initializr</a> åˆ›å»ºå·¥ç¨‹ï¼Œç„¶åä¸‹è½½åˆ›å»ºçš„å·¥ç¨‹ï¼Œçœ‹ä¸€ä¸‹é‡Œé¢çš„ pomæ–‡ä»¶ä¸­å„ä¸ªæ¨¡å—çš„ç‰ˆæœ¬å·å°±å¯ä»¥äº†ã€‚</p><p>ä¿®æ”¹ä¸€ä¸‹å¯åŠ¨ç±»ï¼Œå¢åŠ  <code>@EnableAdminServer</code> æ³¨è§£ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> de.codecentric.boot.admin.server.config.EnableAdminServer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="meta">@EnableAdminServer</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MZAdminApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(MZAdminApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€é…ç½®-ms-admin-client"><a href="#2ã€é…ç½®-ms-admin-client" class="headerlink" title="2ã€é…ç½® ms-admin-client"></a>2ã€é…ç½® <code>ms-admin-client</code></h3><p>åœ¨è¯¥ module çš„ <code>properties</code> æ–‡ä»¶ä¸­ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">spring.application.name=Admin-Client</span><br><span class="line">server.port=8083</span><br><span class="line"></span><br><span class="line"># ------------------------</span><br><span class="line"># Actuator config</span><br><span class="line"># ------------------------</span><br><span class="line"># å¯ä»¥è®¿é—®ä»»æ„æ§åˆ¶ç‚¹</span><br><span class="line">management.endpoints.web.exposure.include=*</span><br><span class="line"></span><br><span class="line"># ------------------------------------------</span><br><span class="line"># é…ç½® spring boot admin</span><br><span class="line"># ------------------------------------------</span><br><span class="line">spring.boot.admin.client.url=http://localhost:8087</span><br><span class="line">management.endpoint.health.show-details=always</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼šè¯¥æœåŠ¡çš„ç«¯å£ä¸º <code>8083</code>ã€‚å¦‚æœ admin-client å’Œ admin-server æ²¡æœ‰éƒ¨ç½²åœ¨åŒä¸€å°æœåŠ¡å™¨ï¼Œè¿™é‡Œçš„<code>spring.boot.admin.client.url</code> ä¸€å®šè¦å†™ä¸Š admin-server æ‰€åœ¨æœåŠ¡å™¨çš„ipåœ°å€ã€‚</strong></p><p>åœ¨è¯¥ module çš„ <code>pom</code> æ–‡ä»¶ä¸­ï¼Œå¼•å…¥å¦‚ä¸‹ä¾èµ–å³å¯ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- springboot admin client --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>de.codecentric<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-admin-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å…¶ä½™çš„ä¸éœ€è¦ä¿®æ”¹ä»»ä½•ä¸œè¥¿ã€‚</p><h3 id="3ã€å¯åŠ¨éªŒè¯"><a href="#3ã€å¯åŠ¨éªŒè¯" class="headerlink" title="3ã€å¯åŠ¨éªŒè¯"></a>3ã€å¯åŠ¨éªŒè¯</h3><p>åˆ†åˆ«å¯åŠ¨ <code>ms-admin</code>ã€<code>ms-admin-client</code>ï¼Œå¯åŠ¨æˆåŠŸåï¼Œåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ <code>http://localhost:8087</code> å°±å¯ä»¥çœ‹åˆ°å¦‚ä¸‹æ•ˆæœï¼Œå¯ä»¥çœ‹åˆ° <code>ms-admin-client</code> è¢«å‘ç°äº†ã€‚</p><p><img src="/upload/images/2020/05/03/2.png"></p><p>ç‚¹è¿›å»ï¼Œå¯ä»¥çœ‹åˆ° <code>ms-admin-client</code> çš„è¿è¡ŒçŠ¶å†µã€‚å¤§å®¶å¯ä»¥è‡ªå·±è¯•è¯•ï¼Œæˆ‘å°±ä¸æˆªå›¾äº†ã€‚</p><h2 id="é…ç½®å¸¦-security-çš„-Admin-Client"><a href="#é…ç½®å¸¦-security-çš„-Admin-Client" class="headerlink" title="é…ç½®å¸¦ security çš„ Admin-Client"></a>é…ç½®å¸¦ security çš„ Admin-Client</h2><p>ä¸Šé¢æˆ‘ä»¬è¯´äº†ï¼Œ<code>ms-user</code> ä¹Ÿæ˜¯ä¸€ä¸ª Admin-Clientï¼Œæˆ‘ä¹Ÿå¸Œæœ›ä»–èƒ½è¢«ç›‘æ§å’Œç®¡ç†ï¼Œä½†æ˜¯ <code>ms-user</code> æœ‰ç‚¹ç‰¹æ®Šå®ƒä½¿ç”¨äº† security æ¨¡å—ï¼Œé‚£ä¹ˆå¦‚ä½•è®©ä»–è¢« Admin-Server å‘ç°å‘¢ï¼Œæˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹ã€‚</p><p><strong>PS</strong>ï¼š<code>ms-user</code> æ¨¡å—å…¶å®æ˜¯æˆ‘ä¹‹å‰ä¸€ç›´åœ¨ <a href="http://www.veryitman.com/2019/05/28/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%A1%B9%E7%9B%AE%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/">å¾®æœåŠ¡ç›¸å…³æ–‡ç« </a> ä¸­ä½¿ç”¨çš„å·¥ç¨‹æ¨¡å—ï¼Œè¿™é‡Œåªæ˜¯é‡æ„äº†ä¸€ä¸‹å·¥ç¨‹ç»“æ„å¹¶ä¸”ä¿®æ”¹äº†ä¸€ä¸‹åç§°è€Œå·²ã€‚</p><p>å› ä¸º <code>ms-user</code> åŒ…å«äº†æ¯”è¾ƒå¤šçš„å†…å®¹ï¼Œå…¶ pom æ–‡ä»¶ä¹Ÿç›¸å¯¹å¤æ‚ä¸€äº›ï¼Œè¿™é‡Œç²˜è´´ä¸€éƒ¨åˆ†ï¼ˆMySQLå’ŒSwaggerç›¸å…³é…ç½®å°±ä¸å†™äº†ï¼‰ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">spring.application.name=User-Server</span><br><span class="line"></span><br><span class="line"># ------------------------</span><br><span class="line"># Actuator config</span><br><span class="line"># ------------------------</span><br><span class="line"># å¯ä»¥è®¿é—®ä»»æ„æ§åˆ¶ç‚¹</span><br><span class="line">management.endpoints.web.exposure.include=*</span><br><span class="line"># é…ç½®ç‹¬ç«‹çš„ç«¯å£</span><br><span class="line">management.server.port=1012</span><br><span class="line"># è‡ªå®šä¹‰è®¿é—®æ§åˆ¶ç‚¹çš„è·¯å¾„</span><br><span class="line">management.endpoints.web.base-path=/monitor</span><br><span class="line">management.endpoint.shutdown.enabled=true</span><br><span class="line"></span><br><span class="line"># -----------------------------------------------</span><br><span class="line"># Spring Security Default user name and password</span><br><span class="line"># -----------------------------------------------</span><br><span class="line">spring.security.user.name=admin</span><br><span class="line">spring.security.user.password=admin</span><br><span class="line">spring.security.user.roles=ACTUATOR_ADMIN</span><br><span class="line"></span><br><span class="line"># ------------------------------------------</span><br><span class="line"># é…ç½® spring boot admin</span><br><span class="line"># ------------------------------------------</span><br><span class="line">spring.boot.admin.client.url=http://localhost:8087</span><br><span class="line">management.endpoint.health.show-details=always</span><br><span class="line"># å‘Šè¯‰admin-serverç”¨æˆ·åå’Œå¯†ç ï¼Œå¦åˆ™ç›‘æ§ä¸åˆ°</span><br><span class="line">spring.boot.admin.client.instance.metadata.user.name=$&#123;spring.security.user.name&#125;</span><br><span class="line">spring.boot.admin.client.instance.metadata.user.password=$&#123;spring.security.user.password&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¦ç‰¹åˆ«æ³¨æ„ï¼Œ <code>ms-user</code> ä½¿ç”¨äº†securityå¹¶ä¸”è®¾ç½®äº†ç”¨æˆ·åå’Œå¯†ç ï¼Œä¸€å®šè¦å‘Šè¯‰ Admin-Serverï¼Œå¦åˆ™æ— æ³•è¢«ç›‘æ§åˆ°ã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚ä¸‹çš„é…ç½®å¿…é¡»å†™ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># å‘Šè¯‰admin-serverç”¨æˆ·åå’Œå¯†ç ï¼Œå¦åˆ™ç›‘æ§ä¸åˆ°</span><br><span class="line">spring.boot.admin.client.instance.metadata.user.name=$&#123;spring.security.user.name&#125;</span><br><span class="line">spring.boot.admin.client.instance.metadata.user.password=$&#123;spring.security.user.password&#125;</span><br></pre></td></tr></table></figure><p>ç´§æ¥ç€æˆ‘ä»¬å¯åŠ¨ <code>ms-user</code> è¿™ä¸ªæœåŠ¡ï¼Œåˆ·æ–°ä¸€ä¸‹æµè§ˆå™¨ï¼Œæ•ˆæœå¦‚ä¸‹å›¾ï¼š</p><p><img src="/upload/images/2020/05/03/3.png"></p><p>å¯ä»¥çœ‹åˆ° <code>ms-user</code> è¿™ä¸ªæœåŠ¡è¢«å¦‚æ„¿ä»¥å¿çš„å‘ç°äº†ã€‚</p><h2 id="Admin-Server-ä½¿ç”¨-security"><a href="#Admin-Server-ä½¿ç”¨-security" class="headerlink" title="Admin-Server ä½¿ç”¨ security"></a>Admin-Server ä½¿ç”¨ security</h2><p>åœ¨  <code>ms-admin</code> çš„ pom æ–‡ä»¶ä¸­å¼•å…¥ security æ¨¡å—ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ properties æ–‡ä»¶ï¼Œå¢åŠ ç”¨æˆ·åå’Œå¯†ç çš„é…ç½®ï¼Œå®Œæ•´é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">spring.application.name=Admin-Server</span><br><span class="line"># ---------------------------------</span><br><span class="line"># é…ç½®è¯¥æœåŠ¡çš„ç‹¬ç«‹ç«¯å£</span><br><span class="line"># ---------------------------------</span><br><span class="line">server.port=8087</span><br><span class="line"></span><br><span class="line"># ---------------------------------</span><br><span class="line"># security é…ç½®</span><br><span class="line"># ---------------------------------</span><br><span class="line">spring.security.user.name=admin</span><br><span class="line">spring.security.user.password=admin</span><br></pre></td></tr></table></figure><p>é…ç½®å®Œæˆåï¼Œæˆ‘ä»¬åˆ†åˆ«é‡æ–°å¯åŠ¨ä¸€ä¸‹ <code>ms-admin</code>ã€<code>ms-admin-client</code> è¿™ä¸¤ä¸ªæœåŠ¡ã€‚</p><p>å†æ¬¡æ‰“å¼€ <code>localhost:8087</code>ï¼Œä¼šå‡ºç°å¦‚ä¸‹ç•Œé¢ï¼š</p><p><img src="/upload/images/2020/05/03/4.png"></p><p>è¾“å…¥åœ¨ <code>properties</code> æ–‡ä»¶ä¸­é…ç½®çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œè¿™é‡Œæˆ‘é…ç½®çš„ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯ <code>admin</code>ï¼Œä½ ä¹Ÿå¯ä»¥é…ç½®å…¶ä»–çš„ã€‚</p><p>è¾“å…¥ä¹‹åå¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç•Œé¢ï¼Œå†æ¬¡è¾“å…¥ä¸Šé¢çš„ç”¨æˆ·åå’Œå¯†ç å³å¯ã€‚</p><p><img src="/upload/images/2020/05/03/5.png"></p><p>åˆæ¬¡è¿›å…¥æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹æˆªå›¾ï¼Œå±…ç„¶æ²¡æœ‰å‘ç° <code>ms-admin-client</code> è¿™ä¸ªæœåŠ¡ã€‚</p><p><img src="/upload/images/2020/05/03/6.png"></p><p>è¿™æ˜¯å› ä¸ºæ²¡æœ‰åœ¨å®¢æˆ·ç«¯é…ç½®è¿›å…¥ Admin-Server çš„å¯†ç ï¼Œå®‰æ’ä¸Šã€‚</p><p>åœ¨ <code>ms-admin-client</code>  çš„ properties ä¸­é…ç½®ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># ------------------------------------------</span><br><span class="line"># é…ç½® spring boot admin</span><br><span class="line"># ------------------------------------------</span><br><span class="line">spring.boot.admin.client.url=http://localhost:8087</span><br><span class="line">management.endpoint.health.show-details=always</span><br><span class="line"># é…ç½® admin server çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå¦åˆ™æ³¨å†Œä¸ä¸Š</span><br><span class="line">spring.boot.admin.discovery.instances-metadata.user.name=$&#123;spring.security.user.name&#125;</span><br><span class="line">spring.boot.admin.discovery.instances-metadata.user.password=$&#123;spring.security.user.password&#125;</span><br></pre></td></tr></table></figure><p>åŒç†ï¼Œåœ¨ <code>ms-user</code> çš„é…ç½®æ–‡ä»¶ properties ä¸­ä¹Ÿå¢åŠ ç›¸å…³çš„é…ç½®å³å¯ã€‚</p><p><strong>è®°å¾—ç»§æ‰¿è‡ª <code>WebSecurityConfigurerAdapter</code> å†™ä¸€ä¸ªé…ç½®ç±»</strong>ï¼Œå¯ä»¥å‚è€ƒ <a href="https://github.com/anandvarkeyphilips/spring-boot-admin/blob/master/spring-boot-admin-samples/spring-boot-admin-server-with-security/src/main/java/de/codecentric/boot/admin/server/SpringBootAdminServerApplication.java">SpringBootAdminServerApplication</a> ç¤ºä¾‹ä»£ç ï¼Œä¸ç„¶å®¢æˆ·ç«¯æœ‰å¯èƒ½æ— æ³•æ³¨å†ŒæˆåŠŸã€‚</p><p>é‡æ–°å¯åŠ¨ <code>ms-admin</code> æœåŠ¡ç„¶åç™»å½•è¿›å»å†å¯åŠ¨å®¢æˆ·ç«¯ï¼Œå°±å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç•Œé¢ï¼š</p><p><img src="/upload/images/2020/05/03/7.png"></p><p>å¦å¤–ï¼ŒAdmin-Server è¿˜å¯ä»¥é›†æˆ <code>spring-boot-starter-mail</code> æ¨¡å—å†ç®€å•çš„é…ç½®ä¸€ä¸‹ï¼Œå°±å¯ä»¥å®ç°å‘é€é‚®ä»¶çš„åŠŸèƒ½ï¼Œè¿™æ ·æœåŠ¡çš„è¿è¡ŒçŠ¶æ€å¯ä»¥åŠæ—¶é€šçŸ¥åˆ°å¯¹åº”çš„æ”¶ä»¶äººäº†ã€‚</p><hr><p><strong>é¢æœå¤§æµ·ï¼Œæ˜¥æš–èŠ±å¼€ã€‚å°šæ‹™èƒ½æˆæ‰ï¼Œä½ æ²¡æœ‰æ¯”åˆ«äººèªæ˜ï¼Œä½ åªæ˜¯æ›´åŠ åŠªåŠ›ç½¢äº†~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot Actuator Admin </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡: Actuatorå®ç°æœåŠ¡ç›‘æµ‹</title>
      <link href="/2020/05/01/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Actuator%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%B5%8B/"/>
      <url>/2020/05/01/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Actuator%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%B5%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>SpringBoot Actuator å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç›‘æ§ SpringBoot åº”ç”¨çš„è¿è¡Œæƒ…å†µï¼ŒæœåŠ¡ä¸Šçº¿åå¦‚ä½•ç›‘æ§å’Œç®¡ç†è‡ªå·±çš„æœåŠ¡æ˜¯æˆ‘ä»¬è¦è€ƒè™‘çš„ä¸€ä¸ªé‡è¦é—®é¢˜ã€‚</p><p>Actuator æ˜¯ SpringBoot çš„ä¸€ä¸ªé™„åŠ ç»„ä»¶ï¼ˆéœ€è¦è‡ªå·±æ‰‹åŠ¨é›†æˆï¼‰ï¼ŒActuator èƒ½å¸®åŠ©åº”ç”¨ç¨‹åºå®ç°åœ¨å„ä¸ªç¯å¢ƒè¿è¡Œæ—¶çš„ç›‘æ§ã€‚å¯ä»¥ä½¿ç”¨ HTTP çš„å„ä¸ªè¯·æ±‚è·¯å¾„æ¥è¿›è¡Œå¥åº·æ£€æŸ¥ã€å®¡è®¡ã€æ”¶é›†å¼•ç”¨çš„è¿è¡Œæƒ…å†µï¼Œå¯¹äºåº”ç”¨çŠ¶æ€ã€å†…å­˜ã€çº¿ç¨‹ã€å †æ ˆç­‰ç­‰éƒ½å¯ä»¥è¿›è¡Œç›‘æ§ï¼Œæ¯”è¾ƒå…¨é¢çš„ç›‘æ§äº† SpringBoot åº”ç”¨çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸã€‚å¯¹äºå¾®æœåŠ¡çš„ç®¡ç†ååˆ†æœ‰æ„ä¹‰ï¼Œåœ¨ä¼ä¸šçº§åº”ç”¨ä¸­ï¼Œå¯¹ç³»ç»Ÿè¿›è¡Œè¿è¡ŒçŠ¶æ€ç›‘æ§æ˜¯ä¸å¯æˆ–ç¼ºçš„ã€‚</p><p>Actuator ä¸ä»…æ”¯æŒ HTTP æ–¹å¼è®¿é—®ï¼Œè¿˜æ”¯æŒ JMXï¼ˆJava Management Extensionsï¼Œå³Javaç®¡ç†æ‰©å±•ï¼‰ã€SSHã€Telnet æ–¹å¼è®¿é—®ã€‚Actuator è¿˜æ”¯æŒç«¯ç‚¹æ‰©å±•ï¼Œæ‰©å±• Actuator çš„ç«¯ç‚¹ï¼ˆEndpointï¼‰ å¯ä»¥è‡ªå®šä¹‰ç›‘æ§æŒ‡æ ‡ï¼Œå®ç°æ›´å¤šçš„è¿ç»´èƒ½åŠ›ã€‚</p><p>è®¿é—® spring-boot-actuator ç»™æˆ‘ä»¬å±•ç°çš„æ˜¯çº¯ JSON æ ¼å¼çš„æ•°æ®ï¼Œå¯¹äºéå¼€å‘äººå‘˜æ¥è¯´ä¸å¤Ÿç›´è§‚å’Œä¸å¤Ÿäººæ€§åŒ–ã€‚<code>Spring Boot Admin</code> å°±æ˜¯ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ï¼Œä½¿ç”¨ <code>Spring Boot Admin</code> å¯ä»¥å®ç°è¿™äº› JSON æ¥å£æ•°æ®çš„ç•Œé¢å±•ç°ï¼Œæ–¹ä¾¿è¿è¥äººå‘˜æŸ¥çœ‹å’Œç®¡ç†ã€‚æœ¬ç¯‡æˆ‘ä»¬åªå­¦ä¹  spring-boot-actuator çš„ä½¿ç”¨ï¼Œå…³äº  <code>Spring Boot Admin</code> ä¸‹ä¸€ç¯‡å†ä¸€èµ·å­¦ä¹ ã€‚</p><p>æœ¬ç¯‡ä¸»è¦å†…å®¹ï¼š</p><ul><li>å¦‚ä½•ä½¿ç”¨ spring-boot-actuatorï¼ˆç®—æ˜¯ç®€å•å…¥é—¨ï¼‰ï¼›</li><li>ç»“åˆ spring-boot-security å¢åŠ å¯¹ spring-boot-actuator çš„è®¿é—®é™åˆ¶ï¼›</li></ul><p>æ›´å¤šå…³äºå¾®æœåŠ¡ç›¸å…³æ–‡ç« ï¼Œå¯ä»¥é€šè¿‡ <a href="http://www.veryitman.com/2019/05/28/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%A1%B9%E7%9B%AE%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/">å¾®æœåŠ¡é¡¹ç›®ç³»åˆ—æ–‡ç« </a> å­¦ä¹ ã€‚</p><h2 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h2><p>åœ¨ä½ çš„å·¥ç¨‹çš„ pom.xml æ–‡ä»¶ä¸­ï¼ŒåŠ å…¥å¦‚ä¸‹ä¾èµ–å°±å¯ä»¥å¼•å…¥ spring-boot-actuator ç»„ä»¶ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç­‰å¾…åŠ è½½å®Œæˆï¼ˆå°±æ˜¯å¯¹åº”çš„jaråŒ…æ–‡ä»¶ä¸‹è½½å®Œæˆä¸”ideåŠ è½½jaræ­£å¸¸ï¼‰ï¼Œå¯ä»¥çœ‹åˆ°å¤šäº†å¦‚ä¸‹ä¸¤ä¸ªjaråŒ…ã€‚</p><p><img src="/upload/images/2020/05/01/1.png"></p><p><code>actuator</code> æ˜¯å…¶åŠŸèƒ½å®ç°ï¼Œ<code>actuator-autoconfigure</code> æ˜¯å…¶è‡ªåŠ¨é…ç½®çš„å®ç°ã€‚</p><p>å¯åŠ¨å·¥ç¨‹ï¼Œç„¶ååœ¨æµè§ˆå™¨æ‰“å¼€ <code>http://localhost:8080/actuator</code>ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹ json æ•°æ®ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;_links&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;self&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;href&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://localhost:8080/actuator&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;templated&quot;</span><span class="punctuation">:</span> <span class="keyword">false</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;health&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;href&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://localhost:8080/actuator/health&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;templated&quot;</span><span class="punctuation">:</span> <span class="keyword">false</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;health-path&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;href&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://localhost:8080/actuator/health/&#123;*path&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;templated&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;info&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;href&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://localhost:8080/actuator/info&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;templated&quot;</span><span class="punctuation">:</span> <span class="keyword">false</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥è®¿é—®å¦‚ä¸‹çš„ URLï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/actuator/health</span><br><span class="line">http://localhost:8080/actuator/info</span><br></pre></td></tr></table></figure><p>åœ¨ Actuator çš„ 2.x ç‰ˆæœ¬ä¸­ï¼Œå¤§å¤šæ•°ç«¯ç‚¹é»˜è®¤è¢«ç¦æ‰äº†ï¼Œä¸”é»˜è®¤ç«¯ç‚¹å¢åŠ äº† <code>/actuator</code> å‰ç¼€ã€‚é»˜è®¤æš´éœ²çš„ä¸¤ä¸ªç«¯ç‚¹ä¸º <code>/actuator/health</code> å’Œ  <code>/actuator/info</code>ï¼Œæ­£æ˜¯å¦‚ä¸Šå¯ä»¥è®¿é—®çš„ä¸¤ä¸ª URL.</p><p>å¦‚æœæƒ³å¼€å¯æ‰€æœ‰çš„æ–­ç‚¹å¯ä»¥è¢«è®¿é—®ï¼Œéœ€è¦åœ¨å·¥ç¨‹çš„ properties æ–‡ä»¶ä¸­ï¼Œå¢åŠ å¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">management.endpoints.web.exposure.include=*</span><br></pre></td></tr></table></figure><p>å†æ¬¡è®¿é—® <code>http://localhost:8080/actuator</code>ï¼Œå°±ä¼šæœ‰æ›´å¤šçš„URLå¯ä»¥è¢«è®¿é—®äº†ã€‚å¦‚ <code>http://localhost:8080/actuator/env</code>ã€<code>http://localhost:8080/actuator/beans</code> ç­‰ã€‚</p><p>å®˜æ–¹æ–‡æ¡£ <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-features.html#production-ready-endpoints">Spring Boot Actuator: Production-ready Features</a> å®Œæ•´çš„ä»‹ç»äº†ç›¸å…³çš„å†…å®¹ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡ŒæŸ¥é˜…ã€‚</p><p>ä»ä¸Šé¢çš„è®¿é—®è·¯å¾„å¯ä»¥çœ‹å‡ºï¼Œé»˜è®¤è®¿é—® Actuator æ‰€æœ‰çš„ç›‘æ§ç‚¹è·¯å¾„éƒ½åœ¨<code>/actuator/*</code>ï¼Œæ˜¯å¦å¯ä»¥è‡ªå®šä¹‰å‘¢ï¼Ÿæ˜¯çš„ï¼Œå¯ä»¥è‡ªå®šä¹‰è¿™ä¸ªå‰ç¼€ï¼Œåªéœ€è¦åœ¨ properties ä¸­é…ç½®å¦‚ä¸‹å†…å®¹å³å¯ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">management.endpoints.web.base-path=/monitor</span><br></pre></td></tr></table></figure><p>å†æ¬¡è®¿é—®ä¸Šé¢çš„ URLï¼Œå°±éœ€è¦å°† <code>actuator/</code> æ¢æˆ <code>monitor/</code> äº†ã€‚</p><h2 id="å®‰å…¨"><a href="#å®‰å…¨" class="headerlink" title="å®‰å…¨"></a>å®‰å…¨</h2><p>è™½ç„¶ Actuator æä¾›äº†å¾ˆæ–¹ä¾¿çš„ç›‘æ§å’Œç®¡ç†æœåŠ¡çš„èƒ½åŠ›ï¼Œä½†æ˜¯è¯•æƒ³ä¸€ä¸‹è®©ä»»ä½•å…¶ä»–çš„æœåŠ¡éƒ½å¯ä»¥è®¿é—®ï¼Œä¼šå­˜åœ¨ä¸€äº›å®‰å…¨éšæ‚£ï¼ŒSpringBoot æä¾›äº† <code>security </code> æ¨¡å—ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´åŠ å®‰å…¨çš„ä½¿ç”¨ Actuatorã€‚é›†æˆ <code>security</code> ä¹Ÿå¾ˆç®€å•ï¼Œä¸‹é¢æˆ‘ä»¬å…·ä½“è¯´è¯´å¦‚ä½•ä½¿ç”¨å§ã€‚</p><p>é¦–å…ˆï¼Œéœ€è¦åœ¨ pom æ–‡ä»¶ä¸­ï¼Œæ·»åŠ å¦‚ä¸‹ä¾èµ–ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å…¶æ¬¡ï¼Œé…ç½®å·¥ç¨‹çš„ properties æ–‡ä»¶ï¼ŒåŠ å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spring.security.user.name=actuator-self</span><br><span class="line">spring.security.user.password=actuator-admin</span><br><span class="line">spring.security.user.roles=ACTUATOR_ADMIN</span><br></pre></td></tr></table></figure><p>ç”¨æˆ·åï¼ˆnameï¼‰å’Œå¯†ç ï¼ˆpasswordï¼‰ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µè‡ªå®šä¹‰ã€‚</p><p>æœ€åï¼Œæ·»åŠ ä¸€ä¸ªé…ç½®ç±» MSActuatorSecurityConfigï¼Œè¯¥ç±»ç»§æ‰¿ WebSecurityConfigurerAdapter.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.actuate.autoconfigure.security.servlet.EndpointRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.security.servlet.PathRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSActuatorSecurityConfig</span> <span class="keyword">extends</span> <span class="title class_">WebSecurityConfigurerAdapter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">        http.authorizeRequests()</span><br><span class="line">                .requestMatchers(EndpointRequest.toAnyEndpoint())</span><br><span class="line">                .hasRole(<span class="string">&quot;ACTUATOR_ADMIN&quot;</span>)</span><br><span class="line">                .requestMatchers(PathRequest.toStaticResources().atCommonLocations())</span><br><span class="line">                .permitAll()</span><br><span class="line">                .antMatchers(<span class="string">&quot;/&quot;</span>)</span><br><span class="line">                .permitAll()</span><br><span class="line">                .antMatchers(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">                .authenticated()</span><br><span class="line">                .and()</span><br><span class="line">                .httpBasic();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹æ¬¡å†æ¬¡è®¿é—®  <code>http://localhost:8080/monitor</code>ï¼Œå°±ä¼šæç¤ºä½ è¾“å…¥ç”¨æˆ·åå’Œå¯†ç äº†ã€‚</p><p>ä¸‹å›¾æ˜¯ä½¿ç”¨ Chrome æµè§ˆå™¨æ˜¾ç¤ºçš„æ•ˆæœã€‚</p><p><img src="/upload/images/2020/05/01/2.png"></p><p>è¾“å…¥é…ç½®çš„ç”¨æˆ·åå’Œå¯†ç ç™»å½•å°±å¯ä»¥è®¿é—®åˆ°æ•°æ®äº†ã€‚</p><p>å¦å¤–ä¸ºäº†å®‰å…¨ï¼Œå¯ä»¥å•ç‹¬è®¾ç½® Actuator çš„ç®¡ç†ç«¯å£å¹¶é…ç½®ä¸å¯¹å¤–ç½‘å¼€æ”¾ï¼Œå¦‚ä¸‹é…ç½®ç‹¬ç«‹çš„ç«¯å£ <code>1102</code>ï¼Œç„¶åå¯ä»¥åœ¨é˜²ç«å¢™ä¸Šåšä¸‹é™åˆ¶å³ <code>1102</code> ç«¯å£ä»…ç”¨äºå†…ç½‘è®¿é—®å³å¯ã€‚</p><p>åœ¨ properties ä¸­å¢åŠ å¦‚ä¸‹é…ç½®ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># é…ç½®ç‹¬ç«‹çš„ç«¯å£</span><br><span class="line">management.server.port=1012</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ•ˆæœï¼š</p><p><img src="/upload/images/2020/05/01/3.png"></p><hr><p><strong>äººæ— åƒæ—¥å¥½ï¼ŒèŠ±æ— ç™¾æ—¥çº¢ï¼Œæ—©æ—¶ä¸ç®—è®¡ï¼Œè¿‡åä¸€åœºç©ºã€‚~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot Actuator å¾®æœåŠ¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡: ç»“åˆMySQLå®ç°ç™»å½•æ³¨å†Œ</title>
      <link href="/2020/04/11/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E7%BB%93%E5%90%88MySQL%E5%AE%9E%E7%8E%B0%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C/"/>
      <url>/2020/04/11/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E7%BB%93%E5%90%88MySQL%E5%AE%9E%E7%8E%B0%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>ç»§ <a href="http://www.veryitman.com/2019/11/10/MySQL8-0-15%E5%9C%A8Win10%E4%B8%8A%E7%9A%84%E6%8A%98%E8%85%BE%E8%AE%B0/">MySQL8.0.15åœ¨Win10ä¸Šçš„æŠ˜è…¾è®°</a> å’Œ <a href="http://www.veryitman.com/2019/12/07/%E5%BE%AE%E6%9C%8D%E5%8A%A1-MySQL%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/">å¾®æœåŠ¡: MySQLåŸºæœ¬æ“ä½œ</a> åï¼Œç”±äºä¸ªäººåŸå› æ²¡èƒ½ç»§ç»­åˆ›ä½œï¼Œä»ä»Šå¤©å¼€å§‹è¡¥ä¸Šï¼Œç»§ç»­å‰è¿›ğŸ’ªã€‚</p><p>æœ¬ç¯‡æ˜¯ <a href="http://www.veryitman.com/2019/05/28/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%A1%B9%E7%9B%AE%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/">å¾®æœåŠ¡ç³»åˆ—</a> çš„ç¬¬ N ç¯‡ï¼Œæœ¬ç¯‡ç»“åˆ MySQL å’Œ SpringBoot å®ç°ç”¨æˆ·ç™»å½•æ³¨å†Œï¼Œç®—æ˜¯ä¸€ä¸ªå°å®æˆ˜ä¹Ÿæ˜¯å¯¹ä¹‹å‰çŸ¥è¯†ç‚¹çš„ä¸€ä¸ªå°ç»“ã€‚</p><p>åœ¨é˜…è¯»æœ¬ç¯‡å†…å®¹ä¹‹å‰ï¼Œéœ€è¦å¤§å®¶åšå¥½å¦‚ä¸‹å‡ ä»¶äº‹æƒ…ï¼š</p><ul><li>åœ¨æœ¬æœºå®‰è£…äº† MySQLï¼Œå¹¶ä¸”å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼›å¦‚æœä½ ç”¨çš„æ˜¯ Windows10ï¼Œå¯ä»¥å‚è€ƒ <a href="http://www.veryitman.com/2019/11/10/MySQL8-0-15%E5%9C%A8Win10%E4%B8%8A%E7%9A%84%E6%8A%98%E8%85%BE%E8%AE%B0/">MySQL8.0.15åœ¨Win10ä¸Šçš„æŠ˜è…¾è®°</a> è¿™ç¯‡æ–‡ç« ï¼›</li><li>å·²ç»æ­å»ºå¥½äº† SpringBoot çš„å¼€å‘ç¯å¢ƒï¼›å¯ä»¥å‚è€ƒ <a href="http://www.veryitman.com/2019/06/02/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E6%83%B3%E5%8A%9E%E6%B3%95%E8%AE%A9%E9%A1%B9%E7%9B%AE%E8%BF%90%E8%A1%8C%E8%B5%B7%E6%9D%A5/">å¾®æœåŠ¡: æƒ³åŠæ³•è®©é¡¹ç›®è¿è¡Œèµ·æ¥</a> æ¥æ­å»ºç¯å¢ƒï¼›</li><li>èƒ½ä½¿ç”¨ SpringBoot æ­£ç¡®è¿æ¥ MySQLï¼Œå®ç°ç®€å•çš„å¢åˆ æ”¹æŸ¥ï¼ˆCRUDï¼‰ï¼›å¯ä»¥å‚è€ƒ <a href="http://www.veryitman.com/2019/12/07/%E5%BE%AE%E6%9C%8D%E5%8A%A1-MySQL%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/">å¾®æœåŠ¡: MySQLåŸºæœ¬æ“ä½œ</a> è¿™ç¯‡æ–‡ç« ï¼›</li><li>ç†è§£è·¨åŸŸé—®é¢˜ï¼Œè¯·åŠ¡å¿…å…ˆé˜…è¯» <a href="%5Bhttp://www.veryitman.com/2019/08/31/%E8%B7%A8%E5%9F%9F%E5%92%8COPTIONS%E8%BF%99%E5%AF%B9%E6%AC%A2%E5%96%9C%E5%86%A4%E5%AE%B6/">è·¨åŸŸå’ŒOPTIONSè¿™å¯¹æ¬¢å–œå†¤å®¶</a>ï¼›</li><li>æ ‘ç«‹ä¿¡å¿ƒï¼ŒåšæŒä¸æ‡ˆï¼Œä¸æ€•å›°éš¾ï¼›</li></ul><p>æœ¬ç¯‡æ–‡ç« ä¸»è¦å†…å®¹ï¼š</p><ul><li>ç½‘é¡µç«¯ï¼Œæä¾›æ³¨å†Œã€ç™»å½•çš„å…¥å£ï¼Œè¯·æ±‚æœåŠ¡ç«¯æä¾›çš„ APIï¼Œè¯·æ±‚é‡‡ç”¨ Ajaxï¼›</li><li>æœåŠ¡ç«¯ï¼Œæä¾›æ³¨å†Œã€ç™»å½•çš„ APIï¼Œå¤„ç†ç”¨æˆ·æ³¨å†Œå’Œç™»å½•çš„è¯·æ±‚ï¼Œå¹¶èƒ½æ­£ç¡®è¯»å†™ MySQL æ•°æ®åº“ï¼›</li></ul><p>ä»£ç å…¨éƒ¨æ”¾åœ¨ <a href="https://github.com/veryitman/MSTutorial/tree/master">Github</a>ï¼Œæœ‰éœ€è¦çš„æœ‹å‹ä»¬å¯ä»¥è‡ªè¡Œè·å–ã€‚</p><h2 id="ç™»å½•æ³¨å†Œæµç¨‹å›¾"><a href="#ç™»å½•æ³¨å†Œæµç¨‹å›¾" class="headerlink" title="ç™»å½•æ³¨å†Œæµç¨‹å›¾"></a>ç™»å½•æ³¨å†Œæµç¨‹å›¾</h2><p>æœ¬ç¯‡åˆ†äº«çš„ç”¨æˆ·æ³¨å†Œå’Œç™»å½•æµç¨‹æ¯”è¾ƒç®€å•ï¼Œçœ‹å›¾è¯´è¯ã€‚</p><p><img src="/upload/images/2020/04/11/7.png" alt="1568529858131"></p><h2 id="å‰ç«¯æ•ˆæœ"><a href="#å‰ç«¯æ•ˆæœ" class="headerlink" title="å‰ç«¯æ•ˆæœ"></a>å‰ç«¯æ•ˆæœ</h2><p>æœ¬ç¯‡ä¸­çš„å‰ç«¯é¡µé¢å¾ˆç®€å•ï¼Œæˆ‘æœ¬äººå¯¹å‰ç«¯çš„è®¤çŸ¥æ˜¯ä¸ªäºŒåŠåŠå­ï¼Œç°å­¦ç°å–ï¼Œä¸»è¦æ˜¯é…åˆæ¥å£åšä¸€äº›å®ä¾‹ï¼Œæ²¡å•¥æŠ€æœ¯å«é‡ã€‚ä½¿ç”¨å‰ç«¯å¼€å‘ï¼Œç»™æˆ‘æœ€å¤§çš„æ„Ÿè§‰å°±æ˜¯æ–¹ä¾¿ï¼Œç®€æ´ã€‚</p><p><strong>1ã€æ³¨å†Œé¡µé¢</strong></p><p><img src="/upload/images/2020/04/11/1.png" alt="1568529858131"></p><p>æ³¨å†ŒæˆåŠŸä¼šè‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µé¢ã€‚</p><p><strong>2ã€ç™»å½•é¡µé¢</strong></p><p><img src="/upload/images/2020/04/11/2.png" alt="1568529858131"></p><p>ç™»å½•å¤±è´¥ä¼šè‡ªåŠ¨è·³è½¬åˆ°æ³¨å†Œé¡µé¢ã€‚</p><p>é¡µé¢å’Œé€»è¾‘çš„æºä»£ç å¯¹åº”åˆ†åˆ«å¦‚ä¸‹</p><p><img src="/upload/images/2020/04/11/3.png" alt="1568529858131"></p><p><strong><font color=red>1</font></strong> -&gt; <code>ms_login.html</code> æ˜¯ç™»å½•é¡µé¢çš„ HTML æ–‡ä»¶ï¼›</p><p><strong><font color=red>2</font></strong> -&gt; <code>ms_signup.html</code> æ˜¯æ³¨å†Œé¡µé¢çš„ HTML æ–‡ä»¶ï¼›</p><p><strong><font color=red>3</font></strong> -&gt; <code>ms_user.js</code> æ˜¯ Ajax çš„è¯·æ±‚é€»è¾‘çš„ JavaScript ä»£ç ã€‚</p><h2 id="é…ç½®-MySQL-çš„è¿æ¥"><a href="#é…ç½®-MySQL-çš„è¿æ¥" class="headerlink" title="é…ç½® MySQL çš„è¿æ¥"></a>é…ç½® MySQL çš„è¿æ¥</h2><p>æ—¢ç„¶è¦ä½¿ç”¨ MySQLï¼Œé¦–å…ˆè¦åœ¨å·¥ç¨‹ä¸­é…ç½®è·Ÿ MySQL ç›¸å…³çš„è¿æ¥å‚æ•°ã€‚ </p><p>åœ¨å·¥ç¨‹çš„ <code>application.properties</code> æ–‡ä»¶ä¸­ï¼Œé…ç½®ä¸‹é¢å‚æ•°å³å¯ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># jdbc</span><br><span class="line">spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver</span><br><span class="line"># charset=utf8mb4</span><br><span class="line">spring.datasource.url=jdbc:mysql://127.0.0.1:3306/mzc_user?serverTimezone=GMT%2B8&amp;useUnicode=true&amp;characterEncoding=utf-8</span><br><span class="line">spring.datasource.username=root</span><br><span class="line"># è®¾ç½®ä¸ºä½ è‡ªå·± MySQL çš„å¯†ç </span><br><span class="line">spring.datasource.password=root</span><br></pre></td></tr></table></figure><p>å…·ä½“çš„è¿™äº›å‚æ•°å«ä¹‰åœ¨ <a href="http://www.veryitman.com/2019/12/07/%E5%BE%AE%E6%9C%8D%E5%8A%A1-MySQL%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/">å¾®æœåŠ¡: MySQLåŸºæœ¬æ“ä½œ</a>  è¿™ç¯‡æ–‡ç« ä¸­æœ‰è¯¦ç»†çš„è®²è§£ã€‚</p><h2 id="ç¼–å†™-API"><a href="#ç¼–å†™-API" class="headerlink" title="ç¼–å†™ API"></a>ç¼–å†™ API</h2><p>æºæ–‡ä»¶ <code>MSSigninController</code> å®ç°äº†ç™»å½•çš„ APIï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;signup&quot;)</span> <span class="comment">// æ³¨æ„è¿™é‡Œä¸è¦åœ¨signupå‰ååŠ &quot;/&quot;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSSignupController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MSUserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@CrossOrigin(origins = &#123;&quot;*&quot;&#125;)</span></span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;/name&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> MSResponse <span class="title function_">signup</span><span class="params">(<span class="meta">@RequestParam(value = &quot;username&quot;)</span> String userName, <span class="meta">@RequestParam(value = &quot;userpwd&quot;)</span> String userPwd)</span> &#123;</span><br><span class="line">        <span class="type">MSResponse</span> <span class="variable">response</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MSResponse</span>();</span><br><span class="line">        <span class="type">MSUser</span> <span class="variable">user</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == userName || <span class="literal">null</span> == userPwd || userName.length() &lt;= <span class="number">0</span> || userPwd.length() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">MSResponseEnum</span> <span class="variable">signupError</span> <span class="operator">=</span> MSResponseEnum.SignupInvalidInfo;</span><br><span class="line">            response.setMsg(signupError.getMsg());</span><br><span class="line">            response.setCode(signupError.getCode());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// åˆ›å»ºuserè¡¨</span></span><br><span class="line">            userService.createUserTable();</span><br><span class="line">            <span class="comment">// æ£€æŸ¥ç”¨æˆ·æ•°æ®åº“çš„â€˜userâ€™è¡¨ä¸­æ˜¯å¦æœ‰è¯¥ç”¨æˆ·ï¼Ÿ</span></span><br><span class="line">            List&lt;Map&gt; query_users = userService.queryUserByUserName(userName);</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> == query_users || query_users.isEmpty()) &#123;<span class="comment">// æ²¡æœ‰è¯¥ç”¨æˆ·çš„æ•°æ®</span></span><br><span class="line">                user = MSUserUtil.createUser(userName, userPwd);</span><br><span class="line">                <span class="comment">// æ’å…¥ä¸€æ¡ç”¨æˆ·æ•°æ®åˆ°æ•°æ®è¡¨ä¸­</span></span><br><span class="line">                userService.addUser(user);</span><br><span class="line">                response.setCode(MSResponseEnum.SUCCESS.getCode());</span><br><span class="line">                response.setMsg(MSResponseEnum.SUCCESS.getMsg());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;<span class="comment">// ç”¨æˆ·æ•°æ®åº“çš„â€˜userâ€™è¡¨ä¸­æœ‰è¯¥ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">                <span class="comment">// è¿”å›é”™è¯¯ä¿¡æ¯ï¼šè¯¥ç”¨æˆ·å·²ç»æ³¨å†Œè¿‡äº†</span></span><br><span class="line">                <span class="type">MSResponseEnum</span> <span class="variable">signupError</span> <span class="operator">=</span> MSResponseEnum.SignupHasExistUser;</span><br><span class="line">                response.setMsg(signupError.getMsg());</span><br><span class="line">                response.setCode(signupError.getCode());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        response.setResults(user);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> response;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æºæ–‡ä»¶ <code>MSSignupController</code> å®ç°äº†æ³¨å†Œçš„ APIï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;signin&quot;)</span> <span class="comment">// æ³¨æ„è¿™é‡Œä¸è¦åœ¨signinå‰ååŠ &quot;/&quot;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSSigninController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MSUserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@CrossOrigin(origins = &#123;&quot;*&quot;, &quot;http://localhost:8082&quot;&#125;)</span></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/name&quot;, method = RequestMethod.GET)</span></span><br><span class="line">    <span class="keyword">public</span> MSResponse <span class="title function_">sigin</span><span class="params">(<span class="meta">@RequestParam(value = &quot;username&quot;)</span> String userName, <span class="meta">@RequestParam(value = &quot;userpwd&quot;)</span> String userPwd)</span> &#123;</span><br><span class="line">        <span class="type">MSResponse</span> <span class="variable">response</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MSResponse</span>();</span><br><span class="line">        <span class="type">MSUser</span> <span class="variable">user</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == userName || <span class="literal">null</span> == userPwd || userName.length() &lt;= <span class="number">0</span> || userPwd.length() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">MSResponseEnum</span> <span class="variable">responseEnum</span> <span class="operator">=</span> MSResponseEnum.Login4SiginInvalidInfo;</span><br><span class="line">            response.setCode(responseEnum.getCode());</span><br><span class="line">            response.setMsg(responseEnum.getMsg());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// æ£€æŸ¥ç”¨æˆ·æ•°æ®åº“çš„â€˜userâ€™è¡¨ä¸­æ˜¯å¦æœ‰è¯¥ç”¨æˆ·ï¼Ÿ</span></span><br><span class="line">            List&lt;Map&gt; query_users = userService.queryUserByUserName(userName);</span><br><span class="line">            <span class="keyword">if</span> (query_users.isEmpty()) &#123;<span class="comment">// æ²¡æœ‰è¯¥ç”¨æˆ·</span></span><br><span class="line">                <span class="type">MSResponseEnum</span> <span class="variable">responseEnum</span> <span class="operator">=</span> MSResponseEnum.LoginNoSuchUser;</span><br><span class="line">                response.setCode(responseEnum.getCode());</span><br><span class="line">                response.setMsg(responseEnum.getMsg());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;<span class="comment">// æœ‰è¿™ä¸ªç”¨æˆ·</span></span><br><span class="line">                <span class="type">Map</span> <span class="variable">user_map</span> <span class="operator">=</span> query_users.get(<span class="number">0</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">query_user_name</span> <span class="operator">=</span> (String) user_map.get(<span class="string">&quot;accountName&quot;</span>);</span><br><span class="line">                <span class="comment">// æ²¡æœ‰å¯¹åº”çš„ç”¨æˆ·å</span></span><br><span class="line">                <span class="keyword">if</span> (!query_user_name.equals(userName)) &#123;</span><br><span class="line">                    <span class="type">MSResponseEnum</span> <span class="variable">responseEnum</span> <span class="operator">=</span> MSResponseEnum.LoginNoSuchUser;</span><br><span class="line">                    response.setCode(responseEnum.getCode());</span><br><span class="line">                    response.setMsg(responseEnum.getMsg());</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;<span class="comment">// æŸ¥è¯¢åˆ°äº†è¯¥ç”¨æˆ·</span></span><br><span class="line">                    <span class="comment">// å°†æŸ¥è¯¢å‡ºæ¥çš„mapå¯¹è±¡ä½¿ç”¨FastJsonè½¬æ¢ä¸ºMSUserå¯¹è±¡</span></span><br><span class="line">                    user = JSON.parseObject(JSON.toJSONString(user_map), MSUser.class);</span><br><span class="line">                    <span class="type">MSResponseEnum</span> <span class="variable">rspEnum</span> <span class="operator">=</span> MSResponseEnum.SUCCESS;</span><br><span class="line">                    response.setCode(rspEnum.getCode());</span><br><span class="line">                    response.setMsg(rspEnum.getMsg());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        response.setResults(user);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> response;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›¸æ¯”äºä¹‹å‰çš„ä»£ç é€»è¾‘ï¼Œç°åœ¨çš„ä»£ç æ— éå°±æ˜¯åŠ å…¥äº†æ“ä½œæ•°æ®åº“çš„é€»è¾‘ã€‚ä»£ç æ¯”è¾ƒç®€å•ï¼Œçœ‹æ³¨é‡Šå°±å¯ä»¥çœ‹æ˜ç™½ã€‚</p><p>æ“ä½œæ•°æ®åº“çš„ä»£ç ï¼Œéƒ½åœ¨ <code>MSUserServiceImpl</code> è¿™ä¸ªå®ç°ç±»ä¸­ã€‚æˆ‘å°±ä¸ä¸€ä¸€çš„ç²˜è´´ä»£ç äº†ã€‚æœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥è‡ªè¡Œåˆ° <a href="https://github.com/veryitman/MSTutorial/tree/master">Github</a> ä¸‹è½½ã€‚</p><h2 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h2><p>é¦–å…ˆï¼Œå¯åŠ¨å·¥ç¨‹ï¼Œè®©å·¥ç¨‹åœ¨æœ¬åœ°æ­£å¸¸è¿è¡Œèµ·æ¥ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰æ­å»º SpringBoot çš„å¼€å‘ç¯å¢ƒï¼Œå»ºè®®å‚è€ƒ <a href="http://www.veryitman.com/2019/06/02/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E6%83%B3%E5%8A%9E%E6%B3%95%E8%AE%A9%E9%A1%B9%E7%9B%AE%E8%BF%90%E8%A1%8C%E8%B5%B7%E6%9D%A5/">å¾®æœåŠ¡-æƒ³åŠæ³•è®©é¡¹ç›®è¿è¡Œèµ·æ¥</a> è¿™ç¯‡æ–‡ç« ã€‚</p><p>ç„¶ååœ¨æµè§ˆå™¨æ‰“å¼€æ³¨å†Œé¡µé¢ï¼Œå»ºè®®ä½¿ç”¨ Chrome æµè§ˆå™¨æ“ä½œã€‚å¦‚ä¸‹å›¾ï¼Œæˆ‘ä½¿ç”¨ <code>foobar</code> ç”¨æˆ·åå’Œ <code>foobar</code> å¯†ç è¿›è¡Œæ³¨å†Œã€‚</p><p><img src="/upload/images/2020/04/11/4.png" alt="1568529858131"></p><p>ç‚¹å‡»æ³¨å†ŒæŒ‰é’®ï¼ŒæˆåŠŸåç”¨ç»ˆç«¯ç™»å½• MySQL æ•°æ®åº“ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰æ•°æ®ã€‚å¦‚ä¸‹å›¾ï¼Œå¯ä»¥çœ‹åˆ°æ•°æ®åº“å’Œå¯¹åº”çš„è¡¨ã€‚</p><p><img src="/upload/images/2020/04/11/5.png" alt="1568529858131"></p><p>å¯ä»¥ä»ä¸‹å›¾çœ‹å‡ºï¼Œæ•°æ®å·²ç»æˆåŠŸçš„å†™å…¥æ•°æ®åº“ä¸­äº†ã€‚</p><p><img src="/upload/images/2020/04/11/6.png" alt="1568529858131"></p><p>æœ€åï¼Œæ‰“å¼€ç™»å½•ç•Œé¢ï¼Œè¾“å…¥ç”¨æˆ·åç§°å’Œå¯†ç éƒ½æ˜¯ <code>foobar</code> çš„å°±å¯ä»¥ç™»å½•æˆåŠŸï¼Œè¯´æ˜ä»æ•°æ®åº“è¯»å–æ•°æ®ä¹Ÿæ˜¯æ­£å¸¸çš„ã€‚</p><p>ä»Šå¤©å°±è¯´è¿™ä¹ˆå¤šå§ï¼Œä¸‹æ¬¡å†è§ï¼</p><hr><p><strong>ä»ç°åœ¨åšèµ·ï¼Œä¸€åˆ‡éƒ½è¿˜æ¥å¾—åŠã€‚</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
          <category> DB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL Springboot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OCå‘é›†ä¹‹blockä½œä¸ºå‡½æ•°å‚æ•°</title>
      <link href="/2020/02/27/OC%E5%9D%91%E9%9B%86%E4%B9%8Bblock%E4%BD%9C%E4%B8%BA%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0/"/>
      <url>/2020/02/27/OC%E5%9D%91%E9%9B%86%E4%B9%8Bblock%E4%BD%9C%E4%B8%BA%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<p>å¯¹äº OCï¼ˆObjective-Cï¼Œè‹¹æœæ¨å‡ºçš„è‡ªå®¶ç¼–ç¨‹è¯­è¨€ï¼‰ çš„äº‰è®ºä¸€ç›´ä¸ä¼‘ï¼Œå¯¹äºä¸€é—¨è¯­è¨€ï¼Œæˆ‘è§‰å¾—åªè¦èƒ½è§£å†³ä½ çš„é—®é¢˜å°±å¤Ÿäº†ã€‚</p><p>è¯„è®ºä¸€é—¨ç¼–ç¨‹è¯­è¨€çš„å¥½åä¹‹å‰ï¼Œéœ€è¦æˆ‘ä»¬çœŸæ­£çš„å»ç”¨å®ƒï¼ŒOC å­°å¥½å­°åï¼Œéœ€è¦ä½ è‡ªå·±å»å°è¯•ã€‚</p><p>OC å‘é›†ï¼Œä¸»è¦è®°è½½ä½¿ç”¨ OC å¼€å‘é¡¹ç›®é‡åˆ°çš„é—®é¢˜ï¼Œå°½é‡ç®€æ´æ˜äº†ï¼Œå¸Œæœ›å¤§å®¶å–œæ¬¢ã€‚</p><p><code>block</code> è¯­å¥å—å¯ä»¥ä½œä¸ºå‡½æ•°çš„å‚æ•°, åœ¨é¡¹ç›®ä¸­éƒ½ç»å¸¸è¢«ä½œä¸ºå›è°ƒæ¥ä½¿ç”¨ã€‚</p><p>å¦‚æœä½ è¿˜ä¸ç†Ÿæ‚‰ <code>block</code> è¯­æ³•ï¼Œè¯·è‡ªè¡Œ googleï¼Œè¿™é‡Œä¸è®² <code>block</code> è¯­æ³•ã€‚æˆ‘ä»¬ä¸‹é¢ç›´æ¥è¿›å…¥ä¸»é¢˜ã€‚</p><p><strong>åˆ›å»ºä¸€ä¸ª OC ç±»</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">FoolBar</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)makeFool:(<span class="keyword">void</span>(^)(<span class="built_in">NSString</span> *))callback;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="string">&quot;FoolBar.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">FoolBar</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)makeFool:(<span class="keyword">void</span> (^)(<span class="built_in">NSString</span> *))callback</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;makeFool | callback.&quot;</span>);</span><br><span class="line">    callback(<span class="string">@&quot;This is a block parameter.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p><strong>main.m</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="string">&quot;FoolBar.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        FoolBar *fb = [[FoolBar alloc] init];</span><br><span class="line">        [fb makeFool:^(<span class="built_in">NSString</span> *) &#123;</span><br><span class="line">            </span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤§å®¶çœ‹åˆ°è¿™é‡Œï¼Œåº”è¯¥è§‰å¾—æ²¡ä»€ä¹ˆé—®é¢˜ã€‚</p><p>æˆ‘åˆšå¼€å§‹ä¹Ÿæ˜¯è¡Œäº‹å†²å†²çš„ï¼Œä½†ç¼–è¯‘å™¨ç»™äº†ä¸ªå¤§å¤§çš„ Error, å¤§è‡´æ„æ€æ˜¯å‚æ•°ä¸¢å¤±ã€‚</p><p>ç»è¿‡ä¸€ç•ªæ€æƒ³ä¸Šé¢çš„æ–—äº‰ï¼Œç»ˆäºè§£å†³äº†é—®é¢˜ã€‚</p><p>åœ¨å£°æ˜å¸¦æœ‰ <code>block</code> è¯­å¥çš„æ–¹æ³•æ—¶ï¼Œéœ€è¦å¸¦ä¸Šå‚æ•°åç§°æˆ–è€…è°ƒç”¨è€…è‡ªå·±å†™ä¸Šå‚æ•°åç§°ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)makeFool:(<span class="keyword">void</span>(^)(<span class="built_in">NSString</span> *param))callback;</span><br></pre></td></tr></table></figure><p>é‡æ–°ç»™å®ƒæ•´ä¸Šï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="string">&quot;FoolBar.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        FoolBar *fb = [[FoolBar alloc] init];</span><br><span class="line">        [fb makeFool:^(<span class="built_in">NSString</span> *param) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@&quot;param = %@&quot;</span>, param);</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>block</code> ä½œä¸ºå‡½æ•°å‚æ•°çš„æ—¶å€™ï¼Œå»ºè®®ä½¿ç”¨ <code>typedef</code> å®šä¹‰ <code>block</code>.</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">void</span> (^OnFoolCallback)(<span class="built_in">NSString</span> *name);</span><br></pre></td></tr></table></figure><p>å®šä¹‰å’Œå®ç°</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)productFool:(OnFoolCallback)callback;</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)productFool:(OnFoolCallback)callback</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;productFool | callback.&quot;</span>);</span><br><span class="line">    callback(<span class="string">@&quot;This is a block parameter: mark.&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•å’Œä½¿ç”¨ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="string">&quot;FoolBar.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        FoolBar *fb = [[FoolBar alloc] init];</span><br><span class="line">        [fb makeFool:^(<span class="built_in">NSString</span> *param) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@&quot;param = %@&quot;</span>, param);</span><br><span class="line">        &#125;];</span><br><span class="line">        </span><br><span class="line">        [fb productFool:^(<span class="built_in">NSString</span> *name) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@&quot;name = %@&quot;</span>, name);</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p><strong>ç›¼æœ›ç–«æƒ…æ—©æ—¥ç»“æŸï¼Œæ¯ä¸ªäººéƒ½èƒ½å›å½’åˆ°æ­£å¸¸çš„ç”Ÿæ´»å½“ä¸­å»ï¼</strong></p><p><img src="http://www.veryitman.com/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Objective-C block </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenSSL: å®æˆ˜-RSAåˆ†æ®µè§£å¯†</title>
      <link href="/2020/01/05/OpenSSL-%E5%AE%9E%E6%88%98-RSA%E5%88%86%E6%AE%B5%E8%A7%A3%E5%AF%86/"/>
      <url>/2020/01/05/OpenSSL-%E5%AE%9E%E6%88%98-RSA%E5%88%86%E6%AE%B5%E8%A7%A3%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æœ¬ç¯‡æ˜¯ç»§ <a href="http://www.veryitman.com/2019/12/29/OpenSSL-%E7%AE%80%E5%8D%95%E6%98%93%E4%B8%8A%E6%89%8B%E7%9A%84RSA%E5%8A%A0%E8%A7%A3%E5%AF%86/">OpenSSL: ç®€å•æ˜“ä¸Šæ‰‹çš„RSAåŠ è§£å¯†</a> åçš„è¡¥å……ç¯‡ï¼Œå®æˆ˜ç¯‡ã€‚</p><p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå¹¶æ²¡æœ‰åƒä¸Šç¯‡æ–‡ç« å†™çš„é‚£ä¹ˆç®€å•ï¼Œå®é™…æƒ…å†µè¦å¤æ‚çš„å¤šã€‚ä¸‡å˜ä¸ç¦»å…¶å®—ï¼ŒæŠ½ä¸å‰¥èŒ§ï¼Œå¤æ‚äº‹åŠ¡çš„èƒŒåä¸€å®šæ˜¯æœ‰å…¶æœ¬è´¨åŸå› å’ŒåŸç†çš„å­˜åœ¨ï¼Œè€Œæˆ‘ä»¬å°±æ˜¯æŒ–æ˜åŸç†ï¼Œæ¢ç´¢æœ¬è´¨çš„ç¦å°”æ‘©æ–¯ã€‚</p><p>ä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼Œå¸¦é¢†å¤§å®¶å‚ä¸åˆ°å®é™…é¡¹ç›®ä¸­è¿ç”¨RSAåŠ è§£å¯†ï¼Œåœ¨é˜…è¯»ä¸‹é¢å†…å®¹ä¹‹å‰ï¼ŒæœŸæœ›å¤§å®¶å¯ä»¥ä¸‹è½½ <code>openssl</code> çš„æºç ï¼Œæˆ–è€…ä¸‹è½½æˆ‘ <a href="http://www.veryitman.com/2019/12/29/OpenSSL-%E7%AE%80%E5%8D%95%E6%98%93%E4%B8%8A%E6%89%8B%E7%9A%84RSA%E5%8A%A0%E8%A7%A3%E5%AF%86/">ä¸Šç¯‡æ–‡ä¸­</a> çš„ä»£ç ç¤ºä¾‹ã€‚</p><p>æˆ‘ä¸‹è½½çš„æ˜¯ <a href="https://github.com/openssl/openssl/releases/tag/OpenSSL_1_1_0f">openssl-source-1.1.0f</a> è¿™ä¸ªç‰ˆæœ¬çš„æºç ï¼Œæ­£å¥½å¯¹åº”æˆ‘ä» <a href="https://www.npcglib.org/~stathis/blog/precompiled-openssl/">precompiled-openssl</a> ä¸‹è½½çš„ç¼–è¯‘ç‰ˆæœ¬ã€‚</p><p><img src="/upload/images/2020/01/05/1.png" alt="1"></p><h2 id="é¡¹ç›®æ¦‚è¿°"><a href="#é¡¹ç›®æ¦‚è¿°" class="headerlink" title="é¡¹ç›®æ¦‚è¿°"></a>é¡¹ç›®æ¦‚è¿°</h2><p>è¯¥é¡¹ç›®çš„å¼€å‘è¯­è¨€ä»ç„¶é‡‡ç”¨Cè¯­è¨€æ¥å®ç°ï¼Œæˆ‘ä»¬å€ŸåŠ© <code>openssl</code> æ¥æ¨¡æ‹Ÿå®é™…é¡¹ç›®ä¸­çš„æ¡ˆä¾‹ã€‚</p><p>æœåŠ¡ç«¯ä½¿ç”¨ RSA åŠ å¯†åŸå§‹æ•°æ®ï¼Œç„¶åé‡‡ç”¨ Base64 ç¼–ç è¯¥åŠ å¯†æ•°æ®ç»è¿‡ HTTP ä¼ è¾“ç»™åˆ°å®¢æˆ·ç«¯ï¼›</p><p>å®¢æˆ·ç«¯æ¥æ”¶åˆ°è¯¥æ•°æ®ï¼Œå…ˆä½¿ç”¨ Base64 è§£ç æ•°æ®ï¼Œç„¶åå†ä½¿ç”¨ RSA è§£å¯†æ•°æ®ï¼Œæœ€ç»ˆå¾—åˆ°åŸå§‹æ•°æ®ã€‚</p><p><strong>è¿™é‡Œç‰¹åˆ«æ³¨æ„ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°çš„æ•°æ®å¤§å°å¯èƒ½ä¼šå¤§äº 128 å­—èŠ‚ï¼Œæˆ‘ä»¬çŸ¥é“ RSA åŠ å¯†æ˜æ–‡æœ€å¤§é•¿åº¦ 117 å­—èŠ‚ï¼Œè€Œè§£å¯†çš„æœ€å¤§å€¼æ˜¯ 128 å­—èŠ‚ï¼Œæ‰€ä»¥è¶…è¿‡è¯¥å¤§å°éœ€è¦åˆ†æ®µè§£å¯†æ•°æ®ã€‚</strong></p><p>å¤§æ¦‚æµç¨‹å›¾å¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2020/01/05/2.png" alt="1"></p><p>å¾ˆç®€å•çš„ä¸€ä¸ªé¡¹ç›®ï¼Œå¯¹å§ï¼Œæ¥ç€å¾€ä¸‹çœ‹å§ :)-</p><h2 id="è§£ä¸ªå°æƒ‘"><a href="#è§£ä¸ªå°æƒ‘" class="headerlink" title="è§£ä¸ªå°æƒ‘"></a>è§£ä¸ªå°æƒ‘</h2><p>ä¹Ÿè®¸æœ‰äº›æœ‹å‹ä¼šé—®ï¼Œä¸ºæ¯› RSA åŠ å¯†çš„æ˜æ–‡å¤§å°æ˜¯ 117 å­—èŠ‚ï¼Œè€Œè§£å¯†çš„æœ€å¤§å­—èŠ‚æ•°æ˜¯ 128 å­—èŠ‚ï¼Œä¸¤è€…ä¸€æ ·ä¸æ˜¯æ›´å¥½å—ï¼Œè‡³å°‘å¥½ç†è§£å‘€ï¼Ÿ</p><p>å¾—å‡ºä¸Šé¢ç»“è®ºçš„å‰ææ˜¯æˆ‘ä»¬RSAå¯†é’¥é•¿åº¦æ˜¯ 1024 ä½å³ 128 å­—èŠ‚ï¼ˆ1024&#x2F;8&#x3D;128ï¼‰ï¼ŒåŒç†å¦‚æœæ˜¯ 512 ä½çš„å¯†é’¥ï¼Œé‚£ä¹ˆæœ€å¤§çš„ RSA è§£å¯†å­—èŠ‚é•¿åº¦åº”è¯¥æ˜¯ï¼ˆ512&#x2F;8ï¼‰64 å­—èŠ‚ï¼Œæœ€å¤§åŠ å¯†çš„æ˜æ–‡é•¿åº¦æ˜¯ï¼ˆ64-11ï¼‰53 å­—èŠ‚ã€‚</p><p>åœ¨ openssl æºç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># <span class="keyword">define</span> RSA_PKCS1_PADDING_SIZE  11</span></span><br></pre></td></tr></table></figure><p>åœ¨ <code>rsa_sign.c</code> æ–‡ä»¶ä¸­å¯ä»¥çœ‹åˆ° RSA_sign å‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">RSA_sign</span><span class="params">(<span class="type">int</span> type, <span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *m, <span class="type">unsigned</span> <span class="type">int</span> m_len,</span></span><br><span class="line"><span class="params">             <span class="type">unsigned</span> <span class="type">char</span> *sigret, <span class="type">unsigned</span> <span class="type">int</span> *siglen, RSA *rsa)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> encrypt_len, encoded_len = <span class="number">0</span>, ret = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *tmps = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *encoded = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (rsa-&gt;meth-&gt;rsa_sign) &#123;</span><br><span class="line">        <span class="keyword">return</span> rsa-&gt;meth-&gt;rsa_sign(type, m, m_len, sigret, siglen, rsa);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Compute the encoded digest. */</span></span><br><span class="line">    <span class="keyword">if</span> (type == NID_md5_sha1) &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * NID_md5_sha1 corresponds to the MD5/SHA1 combination in TLS 1.1 and</span></span><br><span class="line"><span class="comment">         * earlier. It has no DigestInfo wrapper but otherwise is</span></span><br><span class="line"><span class="comment">         * RSASSA-PKCS1-v1_5.</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">if</span> (m_len != SSL_SIG_LENGTH) &#123;</span><br><span class="line">            RSAerr(RSA_F_RSA_SIGN, RSA_R_INVALID_MESSAGE_LENGTH);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        encoded_len = SSL_SIG_LENGTH;</span><br><span class="line">        encoded = m;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!encode_pkcs1(&amp;tmps, &amp;encoded_len, type, m, m_len))</span><br><span class="line">            <span class="keyword">goto</span> err;</span><br><span class="line">        encoded = tmps;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (encoded_len &gt; RSA_size(rsa) - RSA_PKCS1_PADDING_SIZE) &#123;</span><br><span class="line">        RSAerr(RSA_F_RSA_SIGN, RSA_R_DIGEST_TOO_BIG_FOR_RSA_KEY);</span><br><span class="line">        <span class="keyword">goto</span> err;</span><br><span class="line">    &#125;</span><br><span class="line">    encrypt_len = RSA_private_encrypt(encoded_len, encoded, sigret, rsa,</span><br><span class="line">                                      RSA_PKCS1_PADDING);</span><br><span class="line">    <span class="keyword">if</span> (encrypt_len &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">goto</span> err;</span><br><span class="line"></span><br><span class="line">    *siglen = encrypt_len;</span><br><span class="line">    ret = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">err:</span><br><span class="line">    OPENSSL_clear_free(tmps, (<span class="type">size_t</span>)encoded_len);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œ<code>RSA_PKCS1_PADDING</code> è¿™ç§å¡«å……æ¨¡å¼æ˜¯å ç”¨äº† 11 ä¸ªå­—èŠ‚çš„ï¼Œé‚£ä¹ˆ 127+11 æ­£å¥½ä¹Ÿæ˜¯ 128 å­—èŠ‚ã€‚</p><p>æ¯æ¬¡RSAåŠ å¯†çš„æ˜æ–‡çš„é•¿åº¦æ˜¯å—RSAå¡«å……æ¨¡å¼é™åˆ¶çš„ï¼Œå¦‚ä¸‹è¡¨ï¼š</p><table><thead><tr><th>å¡«å……æ–¹å¼</th><th>è¾“å…¥</th><th>è¾“å‡º</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>RSA_PKCS1_PADDING</td><td>å¿…é¡»æ¯”RSAé’¥æ¨¡é•¿(modulus) çŸ­è‡³å°‘11ä¸ªå­—èŠ‚, ä¹Ÿå°±æ˜¯RSA_size(rsa) â€“ 11ï¼Œå¯¹äº1024bitçš„å¯†é’¥ï¼ŒRSA_size(rsa)&#x3D;128å­—èŠ‚ï¼Œå³æ˜æ–‡ä¸º128-11&#x3D;117å­—èŠ‚ï¼›å¦‚æœè¾“å…¥çš„æ˜æ–‡è¿‡é•¿ï¼Œå¿…é¡»åˆ‡å‰²ï¼Œç„¶åå¡«å……ã€‚</td><td>å’Œmodulusä¸€æ ·é•¿</td><td>æœ€å¸¸ç”¨çš„å¡«å……æ–¹å¼</td></tr><tr><td>RSA_PKCS1_OAEP_PADDING</td><td>RSA_size(rsa) â€“ 41</td><td>å’Œmodulusä¸€æ ·é•¿</td><td>æœ€ä¼˜éå¯¹ç§°å¡«å……OAEPï¼Œå®‰å…¨æ€§æ˜¯æœ€é«˜çš„</td></tr><tr><td>RSA_NO_PADDING</td><td>å¯ä»¥å’ŒRSAé’¥æ¨¡é•¿ä¸€æ ·é•¿ï¼Œå¦‚æœè¾“å…¥çš„æ˜æ–‡è¿‡é•¿ï¼Œå¿…é¡»åˆ‡å‰²ï¼Œç„¶åå¡«å……ã€‚</td><td>å’Œmodulusä¸€æ ·é•¿</td><td>-</td></tr></tbody></table><p>è¿™é‡Œæ³¨æ„ä¸‹é¢ç»“è®ºï¼š</p><ul><li>åœ¨ä¸åŒçš„paddingæ¨¡å¼ä¸‹ï¼Œä½¿ç”¨ç›¸åŒé•¿åº¦çš„å¯†é’¥å¯ä»¥åŠ å¯†çš„æ•°æ®æœ€å¤§é•¿åº¦ä¸åŒï¼›</li><li>åœ¨ä¸åŒå¯†é’¥é•¿åº¦ä¸‹ï¼Œä½¿ç”¨ç›¸åŒçš„paddingæ¨¡å¼å¯ä»¥åŠ å¯†çš„æ•°æ®æœ€å¤§é•¿åº¦ä¹Ÿä¸åŒï¼›</li></ul><p>å¯ä»¥é˜…è¯» <a href="https://tools.ietf.org/html/rfc2313">rfc2313</a> ä¸­å…³äº <code>PKCS #1: RSA Encryption Version 1.5</code> çš„éƒ¨åˆ†ã€‚</p><h2 id="å¼€æˆ˜"><a href="#å¼€æˆ˜" class="headerlink" title="å¼€æˆ˜"></a>å¼€æˆ˜</h2><blockquote><p>å®æˆ˜ä»£ç ä¸»è¦åœ¨ <code>main.c</code> æ–‡ä»¶ä¸­çš„ <code>example_rsa3()</code> å‡½æ•°ä¸­ã€‚</p></blockquote><p>åŸå§‹æ•°æ®æ˜¯å­—ç¬¦ä¸² <code>www.veryitman.com</code>ï¼Œå¦‚ä¸‹è¿˜åŒ…æ‹¬äº†å…¬ç§é’¥ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŸå§‹æ•°æ®ä¸ºå­—ç¬¦ä¸²ï¼šwww.veryitman.com</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> plainText[] = <span class="string">&quot;www.veryitman.com&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> publicKey[] = <span class="string">&quot;-----BEGIN PUBLIC KEY-----\n&quot;</span></span><br><span class="line"><span class="string">&quot;MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCrPgCMJW17JN2DW7tZFk/FB6pU\n&quot;</span></span><br><span class="line"><span class="string">&quot;pLvLOo6G/EuND8XZptffXbyiY2VscMRhP+kKVeaLO9HuEYR3Zl78x8oR6prytstc\n&quot;</span></span><br><span class="line"><span class="string">&quot;/MueersWDxh4iGSHsZXGxA41hXrXLRElrSTRc43ea18o0zMxZoVZiR2JFt7QcgM+\n&quot;</span></span><br><span class="line"><span class="string">&quot;T6eOrvj59MhXv9O46QIDAQAB\n&quot;</span></span><br><span class="line"><span class="string">&quot;-----END PUBLIC KEY-----\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> privateKey[] = <span class="string">&quot;-----BEGIN RSA PRIVATE KEY-----\n&quot;</span></span><br><span class="line"><span class="string">&quot;MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAKs+AIwlbXsk3YNb\n&quot;</span></span><br><span class="line"><span class="string">&quot;u1kWT8UHqlSku8s6job8S40Pxdmm199dvKJjZWxwxGE/6QpV5os70e4RhHdmXvzH\n&quot;</span></span><br><span class="line"><span class="string">&quot;yhHqmvK2y1z8y556uxYPGHiIZIexlcbEDjWFetctESWtJNFzjd5rXyjTMzFmhVmJ\n&quot;</span></span><br><span class="line"><span class="string">&quot;HYkW3tByAz5Pp46u+Pn0yFe/07jpAgMBAAECgYBj1YH8MtXhNVzveEuBZMCc3hsv\n&quot;</span></span><br><span class="line"><span class="string">&quot;vdq+YSU3DV/+nXN7sQmp77xJ8CjxT80t5VS38dy2z+lUImJYOhamyNPGHkC2y84V\n&quot;</span></span><br><span class="line"><span class="string">&quot;7i5+e6ScQve1gnwHqRKGBjtSCaYOqm9rTDECCTT1oMU26sfYznWlJqMrkJp1jWn7\n&quot;</span></span><br><span class="line"><span class="string">&quot;aAwr+3FcX2XhD74ZAQJBAN34Y6fmHLRPv21MsdgGqUjKgyFvJfLUmtFFgb6sLEWc\n&quot;</span></span><br><span class="line"><span class="string">&quot;k22J3BAFAcNCTLYHFZwMhL/nwaw9/7rIUJD+lcl6n3cCQQDFfrN14qKC3GJfoBZ8\n&quot;</span></span><br><span class="line"><span class="string">&quot;k9S6F7Ss514DDPzIuenbafhoUjZDVcjLw9EmYZQjpfsQ3WdNICUKRrDHZay1Pz+s\n&quot;</span></span><br><span class="line"><span class="string">&quot;YkKfAkB+OKfaquS5t/t/2LPsxuTuipIEqiKnMjSTOfYsidVnBEFlcZZc2awF76aV\n&quot;</span></span><br><span class="line"><span class="string">&quot;f/PO1+OJCO2910ebXBtMSCi++GbDAkEAmc7zNPwsVH4OnyquWJdJNSUBMSd/sCCN\n&quot;</span></span><br><span class="line"><span class="string">&quot;PkaMOrVtINHmMMq+dvMqEBoupRS/U4Ma0JYYQsiLJL+qof2AOWDNQQJAcquLGHLT\n&quot;</span></span><br><span class="line"><span class="string">&quot;eGDDLluHo+kkIGwZi4aK/fDoylZ0NCEtYyMtShQ3JmllST9kmb9NJX2gMsejsirc\n&quot;</span></span><br><span class="line"><span class="string">&quot;H6ObxqZPbka6UA==\n&quot;</span></span><br><span class="line"><span class="string">&quot;-----END RSA PRIVATE KEY-----\n&quot;</span>;</span><br></pre></td></tr></table></figure><p>å¯¹æ•°æ®è¿›è¡Œç§é’¥åŠ å¯†ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç§é’¥åŠ å¯†</span></span><br><span class="line"><span class="type">int</span> encrypted_length = private_key_encrypt(plainText, len, privateKey, encrypted_str);</span><br><span class="line"><span class="keyword">if</span> (<span class="number">-1</span> == encrypted_length)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Private Encrypt failed\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç§é’¥åŠ å¯†ä¹‹åï¼Œè¿›è¡Œ Base64 ç¼–ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *base64_content;</span><br><span class="line"><span class="type">size_t</span> encrypted_str_length = <span class="built_in">strlen</span>(encrypted_str);</span><br><span class="line"><span class="type">int</span> encode_res = mzc_base64_encode(encrypted_str, encrypted_str_length, &amp;base64_content);</span><br><span class="line"><span class="keyword">if</span> (<span class="number">0</span> != encode_res)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Base64 encode failed\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Base64 encode content: %s\n\n&quot;</span>, base64_content);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Base64 encode content&#x27;s length: %i\n\n&quot;</span>, <span class="built_in">strlen</span>(base64_content));</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œä¸Šé¢ä¸¤ä¸ªæ­¥éª¤å°±æ¨¡æ‹Ÿå®Œæˆäº†æœåŠ¡ç«¯åŠ å¯†çš„è¿‡ç¨‹ã€‚ä¸‹é¢æˆ‘ä»¬æ¥ç»§ç»­æ¨¡æ‹Ÿå®¢æˆ·ç«¯è§£å¯†çš„è¿‡ç¨‹ã€‚</p><p>é¦–å…ˆï¼Œå¯¹ Base64 ç¼–ç ä¹‹åçš„æ•°æ®è¿›è¡Œ Base64 è§£ç ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *base64DecodeOutput;</span><br><span class="line"><span class="type">size_t</span> decode_output_length;</span><br><span class="line"><span class="type">int</span> decode_res = mzc_base64_decode(base64_content, &amp;base64DecodeOutput, &amp;decode_output_length);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;base64 decode content: %s\n\n&quot;</span>, base64DecodeOutput);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;base64 decode content&#x27;s length: %i\n\n&quot;</span>, decode_output_length);</span><br><span class="line"><span class="keyword">if</span> (<span class="number">0</span> != decode_res)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Base64 decode failed\n&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹ä¸€ä¸‹æ‰“å°ç»“æœï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">base64 decode content<span class="number">&#x27;</span>s length: <span class="number">160</span></span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾ï¼Œé•¿åº¦è¦å¤§äº 128ï¼Œéœ€è¦è¿›è¡Œåˆ†æ®µå¤„ç†ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ€å¤§è§£å¯†é•¿åº¦</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RSA_MAX_DECRYPT_SIZE 128</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¯æ®µè§£å¯†çš„é•¿åº¦</span></span><br><span class="line"><span class="type">int</span> chunk = <span class="number">0</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> tmp_dstr[RSA_MAX_DECRYPT_SIZE];</span><br><span class="line"><span class="built_in">memset</span>(tmp_dstr, <span class="string">&#x27;\0&#x27;</span>, <span class="keyword">sizeof</span>(tmp_dstr));</span><br><span class="line"></span><br><span class="line"><span class="comment">// ï¼ˆæ•°æ®è¢«ï¼‰åˆ†æ®µè§£å¯†ï¼ˆå…¬é’¥è§£å¯†ï¼‰</span></span><br><span class="line"><span class="keyword">while</span> (chunk &lt;= decode_output_length)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> decrypted_length = public_key_decrypt(base64DecodeOutput, RSA_MAX_DECRYPT_SIZE, publicKey, tmp_dstr);</span><br><span class="line">    <span class="built_in">memcpy</span>(decrypted_str, tmp_dstr, decrypted_length);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Current decrypted content length =%d\n&quot;</span>, decrypted_length);</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">-1</span> == decrypted_length)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Public Decrypt failed\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    chunk += decrypted_length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;......\n\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Final decrypted string =%s\n&quot;</span>, decrypted_str);</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line"></span><br><span class="line">Final decrypted <span class="built_in">string</span> =www.veryitman.com</span><br></pre></td></tr></table></figure><p>è‡³æ­¤æ•´ä¸ªè¿‡ç¨‹ç®€å•æ¨¡æ‹Ÿç»“æŸã€‚</p><p>å¤§å®¶å¦‚æœæ„Ÿå…´è¶£çš„è¯ï¼Œå¯ä»¥å®ç°åˆ†æ®µåŠ å¯†çš„è¿‡ç¨‹ã€‚æˆ‘å°±ä¸å†æ¼”ç¤ºè¿™ä¸ªè¿‡ç¨‹äº†ï¼Œåç»­åŠ å…¥åˆ°æºä»£ç ä¸­å»ã€‚</p><hr><p><strong>é—®å›èƒ½æœ‰å‡ å¤šæ„ï¼Œæ°ä¼¼ä¸€æ±Ÿæ˜¥æ°´å‘ä¸œæµã€‚</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OpenSSL VS2017 RSA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenSSL: ç®€å•æ˜“ä¸Šæ‰‹çš„RSAåŠ è§£å¯†</title>
      <link href="/2019/12/29/OpenSSL-%E7%AE%80%E5%8D%95%E6%98%93%E4%B8%8A%E6%89%8B%E7%9A%84RSA%E5%8A%A0%E8%A7%A3%E5%AF%86/"/>
      <url>/2019/12/29/OpenSSL-%E7%AE%80%E5%8D%95%E6%98%93%E4%B8%8A%E6%89%8B%E7%9A%84RSA%E5%8A%A0%E8%A7%A3%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>è¿™ç¯‡æ–‡ç« æ˜¯ç»§ <a href="%5Bhttp://www.veryitman.com/2019/11/23/OpenSSL-%E7%94%A8VS2017%E5%88%9B%E5%BB%BAC%E5%B7%A5%E7%A8%8B/">OpenSSL: ç”¨VS2017åˆ›å»ºCå·¥ç¨‹</a>ã€<a href="http://www.veryitman.com/2019/11/23/OpenSSL-%E5%AE%8C%E6%88%90VS2017%E7%9A%84%E9%85%8D%E7%BD%AE/">OpenSSL: å®ŒæˆVS2017çš„é…ç½®</a> ä¸¤ç¯‡æ–‡ç« çš„ç¬¬3ç¯‡ï¼Œå‰ä¸¤ç¯‡åˆ†åˆ«è·Ÿå¤§å®¶åˆ†äº«äº†å¦‚ä½•åœ¨ <code>visual studio2017</code> ä¸­åˆ›å»ºCå·¥ç¨‹ï¼Œé…ç½®OpenSSLçš„å¼€å‘ç¯å¢ƒä»¥åŠä½¿ç”¨ <code>openssl</code> å¼€æºåº“å®ç°base64çš„ç¼–è§£ç ã€‚</p><p>æœ¬ç¯‡è·Ÿå¤§å®¶åˆ†äº«å¦‚ä½•ä½¿ç”¨  <code>openssl</code> å¼€æºåº“å®ç° RSA çš„åŠ å¯†å’Œè§£å¯†ï¼Œä¸è¿‡è¿™ä¸€ç¯‡æ˜¯å¯¹ç®€å•çš„æ•°æ®è¿›è¡ŒåŠ è§£å¯†ï¼Œä¸‹ä¸€ç¯‡ç»§ç»­è·Ÿå¤§å®¶åˆ†äº«å¤æ‚ä¸€ç‚¹çš„ RSA åŠ è§£å¯†è¿‡ç¨‹ä»¥åŠå®ä¾‹ä»£ç ã€‚</p><p>2019 å³å°†è¢«ç”»ä¸Šå¥å·ï¼Œè‡ªå·±è¿˜æœ‰å¾ˆå¤šæ„¿æœ›æ²¡æœ‰å®ç°ã€‚ä¸€æ‹¿èµ·ä¹¦å°±æ„Ÿè§‰å›°ï¼Œä¸€æ‹¿èµ·æ‰‹æœºè§‰å¾—é»‘å¤œé‡Œé˜³å…‰æ˜åªšï¼Œæ— è¯å¯æ•‘äº†å‘€ï¼</p><h2 id="è·å–å…¬ã€ç§é’¥"><a href="#è·å–å…¬ã€ç§é’¥" class="headerlink" title="è·å–å…¬ã€ç§é’¥"></a>è·å–å…¬ã€ç§é’¥</h2><p>åœ¨ <a href="https://www.npcglib.org/~stathis/blog/precompiled-openssl/">precompiled-openssl</a> è·å–çš„å‹ç¼©åŒ…ä¸­ï¼Œè§£å‹å¯ä»¥åœ¨ bin64æˆ–è€…binï¼ˆ32ä½æ“ä½œç³»ç»Ÿä½¿ç”¨ï¼‰ ç›®å½•ä¸‹é¢æ‰¾åˆ° <code>openssl.exe</code> æ–‡ä»¶ï¼ŒåŒå‡»æ‰“å¼€å³å¯ã€‚</p><h3 id="ç”Ÿæˆç§é’¥"><a href="#ç”Ÿæˆç§é’¥" class="headerlink" title="ç”Ÿæˆç§é’¥"></a>ç”Ÿæˆç§é’¥</h3><p>æ‰§è¡Œä¸‹é¢ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">genrsa -out rsa_private_key.pem 1024</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶åœ¨ bin64 ç›®å½•ä¸‹ä¼šç”Ÿæˆ <code>rsa_private_key.pem</code> æ–‡ä»¶ï¼Œå³ç§é’¥æ–‡ä»¶ï¼›</p><p>å°† RSA ç§é’¥è½¬æ¢æˆ <code>PKCS8</code> æ ¼å¼ï¼Œæ‰§è¡Œå¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkcs8 -topk8 -inform PEM -in rsa_private_key.pem -outform PEM -nocrypt</span><br></pre></td></tr></table></figure><h3 id="ç”Ÿæˆå…¬é’¥"><a href="#ç”Ÿæˆå…¬é’¥" class="headerlink" title="ç”Ÿæˆå…¬é’¥"></a>ç”Ÿæˆå…¬é’¥</h3><p>æ‰§è¡Œä¸‹é¢ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsa -in rsa_private_key.pem -pubout -out rsa_public_key.pem</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶åœ¨ bin64 ç›®å½•ä¸‹ä¼šç”Ÿæˆ <code>rsa_public_key.pem</code> æ–‡ä»¶ï¼Œå³å…¬é’¥æ–‡ä»¶ï¼›</p><p>ç”¨VS Codeæ‰“å¼€è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°å…·ä½“å†…å®¹ï¼Œåœ¨æˆ‘çš„æœºå™¨ä¸Šç”Ÿæˆçš„å…¬é’¥ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCrPgCMJW17JN2DW7tZFk/FB6pU</span><br><span class="line">pLvLOo6G/EuND8XZptffXbyiY2VscMRhP+kKVeaLO9HuEYR3Zl78x8oR6prytstc</span><br><span class="line">/MueersWDxh4iGSHsZXGxA41hXrXLRElrSTRc43ea18o0zMxZoVZiR2JFt7QcgM+</span><br><span class="line">T6eOrvj59MhXv9O46QIDAQAB</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure><p>ç§é’¥ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAKs+AIwlbXsk3YNb</span><br><span class="line">u1kWT8UHqlSku8s6job8S40Pxdmm199dvKJjZWxwxGE/6QpV5os70e4RhHdmXvzH</span><br><span class="line">yhHqmvK2y1z8y556uxYPGHiIZIexlcbEDjWFetctESWtJNFzjd5rXyjTMzFmhVmJ</span><br><span class="line">HYkW3tByAz5Pp46u+Pn0yFe/07jpAgMBAAECgYBj1YH8MtXhNVzveEuBZMCc3hsv</span><br><span class="line">vdq+YSU3DV/+nXN7sQmp77xJ8CjxT80t5VS38dy2z+lUImJYOhamyNPGHkC2y84V</span><br><span class="line">7i5+e6ScQve1gnwHqRKGBjtSCaYOqm9rTDECCTT1oMU26sfYznWlJqMrkJp1jWn7</span><br><span class="line">aAwr+3FcX2XhD74ZAQJBAN34Y6fmHLRPv21MsdgGqUjKgyFvJfLUmtFFgb6sLEWc</span><br><span class="line">k22J3BAFAcNCTLYHFZwMhL/nwaw9/7rIUJD+lcl6n3cCQQDFfrN14qKC3GJfoBZ8</span><br><span class="line">k9S6F7Ss514DDPzIuenbafhoUjZDVcjLw9EmYZQjpfsQ3WdNICUKRrDHZay1Pz+s</span><br><span class="line">YkKfAkB+OKfaquS5t/t/2LPsxuTuipIEqiKnMjSTOfYsidVnBEFlcZZc2awF76aV</span><br><span class="line">f/PO1+OJCO2910ebXBtMSCi++GbDAkEAmc7zNPwsVH4OnyquWJdJNSUBMSd/sCCN</span><br><span class="line">PkaMOrVtINHmMMq+dvMqEBoupRS/U4Ma0JYYQsiLJL+qof2AOWDNQQJAcquLGHLT</span><br><span class="line">eGDDLluHo+kkIGwZi4aK/fDoylZ0NCEtYyMtShQ3JmllST9kmb9NJX2gMsejsirc</span><br><span class="line">H6ObxqZPbka6UA==</span><br><span class="line">-----END PRIVATE KEY-----</span><br></pre></td></tr></table></figure><p>ç´§æ¥ç€æˆ‘ä¼šä½¿ç”¨è¿™å¯¹å…¬ç§é’¥è¿›è¡Œç¼–ç ã€‚</p><h2 id="RSA-å®æˆ˜"><a href="#RSA-å®æˆ˜" class="headerlink" title="RSA å®æˆ˜"></a>RSA å®æˆ˜</h2><blockquote><p>RSAåŠ å¯†ç®—æ³•æ˜¯ä¸€ç§éå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚åœ¨å…¬å¼€å¯†é’¥åŠ å¯†å’Œç”µå­å•†ä¸šä¸­RSAè¢«å¹¿æ³›ä½¿ç”¨ã€‚RSAæ˜¯1977å¹´ç”±ç½—çº³å¾·Â·æç»´æ–¯ç‰¹ï¼ˆRon Rivestï¼‰ã€é˜¿è¿ªÂ·è¨è«å°”ï¼ˆAdi Shamirï¼‰å’Œä¼¦çº³å¾·Â·é˜¿å¾·æ›¼ï¼ˆLeonard Adlemanï¼‰ä¸€èµ·æå‡ºçš„ã€‚å½“æ—¶ä»–ä»¬ä¸‰äººéƒ½åœ¨éº»çœç†å·¥å­¦é™¢å·¥ä½œã€‚RSAå°±æ˜¯ä»–ä»¬ä¸‰äººå§“æ°å¼€å¤´å­—æ¯æ‹¼åœ¨ä¸€èµ·ç»„æˆçš„ã€‚</p><p>1973å¹´ï¼Œåœ¨è‹±å›½æ”¿åºœé€šè®¯æ€»éƒ¨å·¥ä½œçš„æ•°å­¦å®¶å…‹åˆ©ç¦å¾·Â·æŸ¯å…‹æ–¯ï¼ˆClifford Cocksï¼‰åœ¨ä¸€ä¸ªå†…éƒ¨æ–‡ä»¶ä¸­æå‡ºäº†ä¸€ä¸ªç›¸åŒçš„ç®—æ³•ï¼Œä½†ä»–çš„å‘ç°è¢«åˆ—å…¥æœºå¯†ï¼Œä¸€ç›´åˆ°1997å¹´æ‰è¢«å‘è¡¨ã€‚</p><p>å¯¹æå¤§æ•´æ•°åšå› æ•°åˆ†è§£çš„éš¾åº¦å†³å®šäº†RSAç®—æ³•çš„å¯é æ€§ã€‚æ¢è¨€ä¹‹ï¼Œå¯¹ä¸€æå¤§æ•´æ•°åšå› æ•°åˆ†è§£æ„ˆå›°éš¾ï¼ŒRSAç®—æ³•æ„ˆå¯é ã€‚å‡å¦‚æœ‰äººæ‰¾åˆ°ä¸€ç§å¿«é€Ÿå› æ•°åˆ†è§£çš„ç®—æ³•çš„è¯ï¼Œé‚£ä¹ˆç”¨RSAåŠ å¯†çš„ä¿¡æ¯çš„å¯é æ€§å°±è‚¯å®šä¼šæåº¦ä¸‹é™ã€‚ä½†æ‰¾åˆ°è¿™æ ·çš„ç®—æ³•çš„å¯èƒ½æ€§æ˜¯éå¸¸å°çš„ã€‚ä»Šå¤©åªæœ‰çŸ­çš„RSAé’¥åŒ™æ‰å¯èƒ½è¢«å¼ºåŠ›æ–¹å¼è§£ç ´ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä¸–ç•Œä¸Šè¿˜æ²¡æœ‰ä»»ä½•å¯é çš„æ”»å‡»RSAç®—æ³•çš„æ–¹å¼ã€‚åªè¦å…¶é’¥åŒ™çš„é•¿åº¦è¶³å¤Ÿé•¿ï¼Œç”¨RSAåŠ å¯†çš„ä¿¡æ¯å®é™…ä¸Šæ˜¯ä¸èƒ½è¢«è§£ç ´çš„ã€‚</p><p>1983å¹´éº»çœç†å·¥å­¦é™¢åœ¨ç¾å›½ä¸ºRSAç®—æ³•ç”³è¯·äº†ä¸“åˆ©ã€‚è¿™ä¸ªä¸“åˆ©2000å¹´9æœˆ21æ—¥å¤±æ•ˆã€‚ç”±äºè¯¥ç®—æ³•åœ¨ç”³è¯·ä¸“åˆ©å‰å°±å·²ç»è¢«å‘è¡¨äº†ï¼Œåœ¨ä¸–ç•Œä¸Šå¤§å¤šæ•°å…¶å®ƒåœ°åŒºè¿™ä¸ªä¸“åˆ©æƒä¸è¢«æ‰¿è®¤ã€‚</p></blockquote><p>æ–°å»ºå¤´æ–‡ä»¶ <code>mzc_rsa.h</code>ï¼Œå£°æ˜å‡ ä¸ªå‡½æ•°ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* å…¬é’¥è§£å¯† */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">public_key_decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *enc_data, <span class="type">int</span> data_len, <span class="type">unsigned</span> <span class="type">char</span> *key, <span class="type">unsigned</span> <span class="type">char</span> *decrypted)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ç§é’¥åŠ å¯† */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">private_key_encrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *data, <span class="type">int</span> data_len, <span class="type">unsigned</span> <span class="type">char</span> *key, <span class="type">unsigned</span> <span class="type">char</span> *encrypted)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å…¬é’¥åŠ å¯† */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">public_key_encrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *data, <span class="type">int</span> data_len, <span class="type">unsigned</span> <span class="type">char</span> *key, <span class="type">unsigned</span> <span class="type">char</span> *encrypted)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ç§é’¥è§£å¯† */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">private_key_decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *enc_data, <span class="type">int</span> data_len, <span class="type">unsigned</span> <span class="type">char</span> *key, <span class="type">unsigned</span> <span class="type">char</span> *decrypted)</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„å®ç°æ–‡ä»¶ <code>mzc_rsa.c</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mzc_rsa.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/pem.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/ssl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/rsa.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/evp.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/bio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/err.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/buffer.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> PADDING = RSA_PKCS1_PADDING;</span><br><span class="line"></span><br><span class="line">RSA *<span class="title function_">createRSA</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *key, <span class="type">int</span> public_token)</span></span><br><span class="line">&#123;</span><br><span class="line">RSA *rsa = <span class="literal">NULL</span>;</span><br><span class="line">BIO *keybio;</span><br><span class="line">keybio = BIO_new_mem_buf(key, <span class="number">-1</span>);</span><br><span class="line"><span class="keyword">if</span> (keybio == <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Failed to create key BIO&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (public_token)</span><br><span class="line">&#123;</span><br><span class="line">rsa = PEM_read_bio_RSA_PUBKEY(keybio, &amp;rsa, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">rsa = PEM_read_bio_RSAPrivateKey(keybio, &amp;rsa, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (rsa == <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Failed to create RSA&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> rsa;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">public_key_decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *enc_data, <span class="type">int</span> data_len, <span class="type">unsigned</span> <span class="type">char</span> *key, <span class="type">unsigned</span> <span class="type">char</span> *decrypted)</span></span><br><span class="line">&#123;</span><br><span class="line">RSA *rsa = createRSA(key, <span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> result = RSA_public_decrypt(data_len, enc_data, decrypted, rsa, PADDING);</span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">private_key_encrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *data, <span class="type">int</span> data_len, <span class="type">unsigned</span> <span class="type">char</span> *key, <span class="type">unsigned</span> <span class="type">char</span> *encrypted)</span></span><br><span class="line">&#123;</span><br><span class="line">RSA *rsa = createRSA(key, <span class="number">0</span>);</span><br><span class="line"><span class="type">int</span> result = RSA_private_encrypt(data_len, data, encrypted, rsa, PADDING);</span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">public_key_encrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *data, <span class="type">int</span> data_len, <span class="type">unsigned</span> <span class="type">char</span> *key, <span class="type">unsigned</span> <span class="type">char</span> *encrypted)</span></span><br><span class="line">&#123;</span><br><span class="line">RSA *rsa = createRSA(key, <span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> result = RSA_public_encrypt(data_len, data, encrypted, rsa, PADDING);</span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">private_key_decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *enc_data, <span class="type">int</span> data_len, <span class="type">unsigned</span> <span class="type">char</span> *key, <span class="type">unsigned</span> <span class="type">char</span> *decrypted)</span></span><br><span class="line">&#123;</span><br><span class="line">RSA *rsa = createRSA(key, <span class="number">0</span>);</span><br><span class="line"><span class="type">int</span> result = RSA_private_decrypt(data_len, enc_data, decrypted, rsa, PADDING);</span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„è¿™é‡Œä½¿ç”¨çš„ RSA å¯¹é½æ¨¡å¼æ˜¯ <code>RSA_PKCS1_PADDING</code>ã€‚</p><p>åœ¨æµ‹è¯•çš„ä¸»å‡½æ•°ï¼ˆmainï¼‰ä¸­ï¼Œä½¿ç”¨æ˜æ–‡ <code>www.veryitman.com</code> ä½œä¸ºç¤ºä¾‹è¿›è¡ŒåŠ å¯†å’Œè§£å¯†æ“ä½œï¼Œæˆ‘åœ¨ä¸‹é¢åªåˆ—å‡ºå…³é”®å®ç°ã€‚å…·ä½“ä»£ç å¯ä»¥å» <a href="https://github.com/veryitman/c-openssl">Github</a> ä¸‹è½½ï¼Œ<strong>æ³¨æ„</strong> clone <code>rsa-feature</code> è¿™ä¸ªåˆ†æ”¯ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å…¬é’¥åŠ å¯†ï¼Œ ç§é’¥è§£å¯† */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//åŸå§‹æ•°æ®ä¸ºå­—ç¬¦ä¸²ï¼šwww.veryitman.com</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> plainText[] = <span class="string">&quot;www.veryitman.com&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> publicKey[] = <span class="string">&quot;-----BEGIN PUBLIC KEY-----\n&quot;</span></span><br><span class="line"><span class="string">&quot;MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCrPgCMJW17JN2DW7tZFk/FB6pU\n&quot;</span></span><br><span class="line"><span class="string">&quot;pLvLOo6G/EuND8XZptffXbyiY2VscMRhP+kKVeaLO9HuEYR3Zl78x8oR6prytstc\n&quot;</span></span><br><span class="line"><span class="string">&quot;/MueersWDxh4iGSHsZXGxA41hXrXLRElrSTRc43ea18o0zMxZoVZiR2JFt7QcgM+\n&quot;</span></span><br><span class="line"><span class="string">&quot;T6eOrvj59MhXv9O46QIDAQAB\n&quot;</span></span><br><span class="line"><span class="string">&quot;-----END PUBLIC KEY-----\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> privateKey[] = <span class="string">&quot;-----BEGIN RSA PRIVATE KEY-----\n&quot;</span></span><br><span class="line"><span class="string">&quot;MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAKs+AIwlbXsk3YNb\n&quot;</span></span><br><span class="line"><span class="string">&quot;u1kWT8UHqlSku8s6job8S40Pxdmm199dvKJjZWxwxGE/6QpV5os70e4RhHdmXvzH\n&quot;</span></span><br><span class="line"><span class="string">&quot;yhHqmvK2y1z8y556uxYPGHiIZIexlcbEDjWFetctESWtJNFzjd5rXyjTMzFmhVmJ\n&quot;</span></span><br><span class="line"><span class="string">&quot;HYkW3tByAz5Pp46u+Pn0yFe/07jpAgMBAAECgYBj1YH8MtXhNVzveEuBZMCc3hsv\n&quot;</span></span><br><span class="line"><span class="string">&quot;vdq+YSU3DV/+nXN7sQmp77xJ8CjxT80t5VS38dy2z+lUImJYOhamyNPGHkC2y84V\n&quot;</span></span><br><span class="line"><span class="string">&quot;7i5+e6ScQve1gnwHqRKGBjtSCaYOqm9rTDECCTT1oMU26sfYznWlJqMrkJp1jWn7\n&quot;</span></span><br><span class="line"><span class="string">&quot;aAwr+3FcX2XhD74ZAQJBAN34Y6fmHLRPv21MsdgGqUjKgyFvJfLUmtFFgb6sLEWc\n&quot;</span></span><br><span class="line"><span class="string">&quot;k22J3BAFAcNCTLYHFZwMhL/nwaw9/7rIUJD+lcl6n3cCQQDFfrN14qKC3GJfoBZ8\n&quot;</span></span><br><span class="line"><span class="string">&quot;k9S6F7Ss514DDPzIuenbafhoUjZDVcjLw9EmYZQjpfsQ3WdNICUKRrDHZay1Pz+s\n&quot;</span></span><br><span class="line"><span class="string">&quot;YkKfAkB+OKfaquS5t/t/2LPsxuTuipIEqiKnMjSTOfYsidVnBEFlcZZc2awF76aV\n&quot;</span></span><br><span class="line"><span class="string">&quot;f/PO1+OJCO2910ebXBtMSCi++GbDAkEAmc7zNPwsVH4OnyquWJdJNSUBMSd/sCCN\n&quot;</span></span><br><span class="line"><span class="string">&quot;PkaMOrVtINHmMMq+dvMqEBoupRS/U4Ma0JYYQsiLJL+qof2AOWDNQQJAcquLGHLT\n&quot;</span></span><br><span class="line"><span class="string">&quot;eGDDLluHo+kkIGwZi4aK/fDoylZ0NCEtYyMtShQ3JmllST9kmb9NJX2gMsejsirc\n&quot;</span></span><br><span class="line"><span class="string">&quot;H6ObxqZPbka6UA==\n&quot;</span></span><br><span class="line"><span class="string">&quot;-----END RSA PRIVATE KEY-----\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> encrypted_str[<span class="number">128</span>];</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> decrypted_str[<span class="number">128</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// éœ€è¦åˆå§‹åŒ–ï¼Œå¦åˆ™è§£å¯†å‡ºæ¥çš„å­—ç¬¦ä¸²ä¼šæœ‰å¤šä½™çš„ä¹±ç </span></span><br><span class="line"><span class="built_in">memset</span>(encrypted_str, <span class="string">&#x27;\0&#x27;</span>, <span class="keyword">sizeof</span>(encrypted_str));</span><br><span class="line"><span class="built_in">memset</span>(decrypted_str, <span class="string">&#x27;\0&#x27;</span>, <span class="keyword">sizeof</span>(decrypted_str));</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> len = <span class="built_in">strlen</span>((<span class="type">const</span> <span class="type">char</span> *)plainText);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Encrypted length =%d\n&quot;</span>, len);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…¬é’¥åŠ å¯†</span></span><br><span class="line"><span class="type">int</span> encrypted_length = public_key_encrypt(plainText, len, publicKey, encrypted_str);</span><br><span class="line"><span class="keyword">if</span> (encrypted_length == <span class="number">-1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Private Encrypt failed\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç§é’¥è§£å¯†</span></span><br><span class="line"><span class="type">int</span> decrypted_length = private_key_decrypt(encrypted_str, encrypted_length, privateKey, decrypted_str);</span><br><span class="line"><span class="keyword">if</span> (decrypted_length == <span class="number">-1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Public Decrypt failed\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Decrypted Text =%s\n&quot;</span>, decrypted_str);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Decrypted Length =%d\n&quot;</span>, decrypted_length);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»Šå¤©åˆ°æ­¤ä¸ºæ­¢ï¼Œç´¯äº†ï¼Œç¡è§‰äº†ğŸ˜œã€‚</p><hr><p><strong>æ´»ç€ä¸æ˜¯é æ³ªæ°´æå–åŒæƒ…ï¼Œè€Œæ˜¯é æ±—æ°´è·å¾—æŒå£°~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OpenSSL VS2017 RSA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Androidä¸­å€¼å¾—è¯´çš„Handlerä¹‹æ›´æ–°UI</title>
      <link href="/2019/12/21/Android%E4%B8%AD%E5%80%BC%E5%BE%97%E8%AF%B4%E7%9A%84Handler%E4%B9%8B%E6%9B%B4%E6%96%B0UI/"/>
      <url>/2019/12/21/Android%E4%B8%AD%E5%80%BC%E5%BE%97%E8%AF%B4%E7%9A%84Handler%E4%B9%8B%E6%9B%B4%E6%96%B0UI/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹ç”µè§†å‰§ã€Šåº†ä½™å¹´ã€‹ï¼Œè¢«è°ƒçš®çš„ç¼–å‰§é€—å¾—çˆ±ä¸é‡Šæ‰‹ï¼ŒèŒƒé—²åŒå¿—ä»â€œæ½œé¾™å‹¿ç”¨â€ç›´åˆ°å¤§æ®¿é†‰é…’èƒŒè¯µå”è¯—300é¦–ï¼Œè®©ä¼—å®˜ç ç›®ç»“èˆŒï¼Œä¹Ÿç®—æ˜¯â€œé£é¾™åœ¨å¤©â€äº†ï¼Œè¿™ä¸€é›†(ç¬¬27é›†)çœ‹çš„é‚£å«ä¸€ä¸ªè¿‡ç˜¾ã€‚å°¤å…¶èŒƒé—²é‚£å¥â€œæˆ‘é†‰æ¬²çœ å›ä¸”å»ï¼Œå»ä½ å¦ˆçš„â€¦â€ï¼Œå·®ç‚¹è®©æˆ‘å–·é¥­ã€‚</p><p>æ¨èå¤§å®¶å‘¨æœ«å¯ä»¥çœ‹çœ‹ï¼Œç®—æ˜¯ä¼‘é—²ä¸€ä¸‹å§ï¼</p><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>ä¸ªäººæ€»æ˜¯æ„Ÿè§‰ Androidä¸­æ›´æ–° UI å¾ˆè®©äººçº ç»“ï¼ç‰¹æ­¤å°ç»“ä¸€ä¸‹ï¼Œç®—æ˜¯æŠ›ç –å¼•ç‰ã€‚</p><p>è¯»è¿™ç¯‡æ–‡ç« ä¹‹å‰ï¼Œå‡è®¾ä½ å·²ç»æ˜ç™½å¤šçº¿ç¨‹ã€Handler å¦‚ä½•ä½¿ç”¨ã€‚</p><p>åœ¨æ–‡ç« çš„æœ€åï¼Œ<strong>é™„å½•ä¸€å¼ è‰å›¾ï¼Œä¸»è¦ç”¨äºè¯´æ˜ Handlerã€Messageã€MessageQueueã€Looper ä¹‹é—´çš„å…³ç³»ã€‚</strong></p><h3 id="æ›´æ–°UIçš„éªšæ“ä½œ"><a href="#æ›´æ–°UIçš„éªšæ“ä½œ" class="headerlink" title="æ›´æ–°UIçš„éªšæ“ä½œ"></a>æ›´æ–°UIçš„éªšæ“ä½œ</h3><h3 id="1ã€åœ¨-onCreate-æ–¹æ³•ä¸­å¼€å¯çº¿ç¨‹æ›´æ–°-UI"><a href="#1ã€åœ¨-onCreate-æ–¹æ³•ä¸­å¼€å¯çº¿ç¨‹æ›´æ–°-UI" class="headerlink" title="1ã€åœ¨ onCreate() æ–¹æ³•ä¸­å¼€å¯çº¿ç¨‹æ›´æ–° UI"></a>1ã€åœ¨ onCreate() æ–¹æ³•ä¸­å¼€å¯çº¿ç¨‹æ›´æ–° UI</h3><p>ç›´æ¥ä¸Šä¾‹å­ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MasterActivity</span> <span class="keyword">extends</span> <span class="title class_">Activity</span> &#123; </span><br><span class="line"><span class="type">TextView</span> <span class="variable">tv</span> <span class="operator">=</span> <span class="literal">null</span>; <span class="type">Button</span> <span class="variable">btn</span> <span class="operator">=</span> <span class="literal">null</span>; </span><br><span class="line"><span class="meta">@Override</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123; </span><br><span class="line">    <span class="built_in">super</span>.onCreate(savedInstanceState); </span><br><span class="line">    setContentView(R.layout.main); </span><br><span class="line">    System.out.println(Thread.currentThread().getName() + <span class="string">&quot;: &quot;</span> + Thread.currentThread().getId()); </span><br><span class="line">    tv = (TextView)findViewById(R.id.text); </span><br><span class="line">    <span class="comment">/*onCreateä¸­å¼€å¯æ–°çº¿ç¨‹ï¼Œæ›´æ–°UIã€‚æ²¡æœ‰æŠ¥é”™æˆ–è€…å¼‚å¸¸ä¿¡æ¯ï¼*/</span> </span><br><span class="line">    btn = (Button)findViewById(R.id.btn); </span><br><span class="line">    <span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123; </span><br><span class="line">        <span class="meta">@Override</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123; </span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;: &quot;</span> + Thread.currentThread().getId()); </span><br><span class="line">            tv.setText(<span class="string">&quot;update UI is success!&quot;</span>); </span><br><span class="line">            btn.setText(<span class="string">&quot;update UI is success!&quot;</span>); </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;); </span><br><span class="line">    thread.start(); </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><p>éšä¾¿æŠ˜è…¾ï¼Œä¸ä¼šæŠ¥é”™ä¹Ÿä¸ä¼šæŠ¥ä»»ä½•å¼‚å¸¸ï¼</p><p>ä»¥ä¸ºå¼€å¯çš„çº¿ç¨‹å’Œ UI çº¿ç¨‹ï¼ˆä¸»çº¿ç¨‹ï¼‰æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ï¼Œä½†æ˜¯å¾ˆä¸å¹¸ï¼Œä»–ä»¬çš„çº¿ç¨‹<code>id</code>é£ç‰›é©¬ä¸ç›¸åŠï¼</p><p>å¤§å®¶å¯ä»¥æŸ¥ä¸€ä¸‹ Android æºç ï¼Œè¿™ä¸ªä¸»è¦æ˜¯å› ä¸ºåœ¨åŠ è½½ Activity çš„æ—¶å€™ï¼Œè¿˜æ²¡æœ‰è§¦å‘æ£€æŸ¥å•çº¿ç¨‹çš„æ¨¡å‹ï¼ˆå³å­çº¿ç¨‹ä¸å¯ä»¥æ›´æ–°UIï¼‰ã€‚</p><p>å¦‚æœä½ ä¸ç›¸ä¿¡çš„è¯ï¼Œå¯ä»¥åœ¨ä¸Šé¢çš„çº¿ç¨‹é‡Œé¢ <code>while true</code>ï¼Œé‚£ä¹ˆä¸€å®šä¼šæŠ¥é”™çš„ã€‚</p><h3 id="2ã€åœ¨-Activity-ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­æ›´æ–°-UI"><a href="#2ã€åœ¨-Activity-ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­æ›´æ–°-UI" class="headerlink" title="2ã€åœ¨ Activity ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­æ›´æ–° UI"></a>2ã€åœ¨ Activity ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­æ›´æ–° UI</h3><p>å¦‚ Activity çš„ <code>onResume</code>ã€<code>onStart</code>ã€åæ­£æ˜¯ä»¥ <code>on</code> å¼€å¤´çš„å›è°ƒæ–¹æ³•ä¸­åœ¨éä¸»çº¿ç¨‹ä¸­æ›´æ–° UIï¼Œå®ä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onRestart</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.onRestart(); <span class="comment">/*onRestartä¸­å¼€å¯æ–°çº¿ç¨‹ï¼Œæ›´æ–°UI*/</span></span><br><span class="line">    <span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;: &quot;</span> + Thread.currentThread().getId());</span><br><span class="line">            tv.setText(<span class="string">&quot;update UI is success!&quot;</span>);</span><br><span class="line">            btn.setText(<span class="string">&quot;update UI is success!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    thread.start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸å¥½æ„æ€ï¼ŒæŒ‰ä¸‹è¿”å›æŒ‰é’®åœ¨å¯åŠ¨ç¨‹åºï¼Œæˆ–è€…æŒ‰ Home é”®å†å¯åŠ¨ç¨‹åºï¼Œå°±è¿™ä¹ˆæŠ˜è…¾å‡ ä¸‹ï¼Œå°±ä¼šåŒ…å¼‚å¸¸ï¼</p><p>å¼‚å¸¸ä¿¡æ¯å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">UI.view.ViewRoot$CalledFromWrongThreadException: </span><br><span class="line">Only the original thread that created a view hierarchy can touch its views.</span><br></pre></td></tr></table></figure><p>å¤§æ¦‚æ„æ€æ˜¯ï¼šåªæœ‰åœ¨ä¸»çº¿ç¨‹ä¸­æ‰å¯ä»¥è¿›è¡Œæ›´æ–° UI çš„æ“ä½œã€‚</p><p>è¿™ä¸ªæ—¶å€™ï¼Œå¤§å®¶éƒ½åº”è¯¥æƒ³åˆ° <code>postInvalidate()</code> è¿™ä¸ªæ–¹æ³•äº†ã€‚ä¿®æ”¹å®ä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span> <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onRestart</span><span class="params">()</span> &#123; </span><br><span class="line">    <span class="built_in">super</span>.onRestart(); <span class="comment">/*onRestartä¸­å¼€å¯æ–°çº¿ç¨‹ï¼Œæ›´æ–°UI*/</span> </span><br><span class="line">    <span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123; </span><br><span class="line">        <span class="meta">@Override</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123; </span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;: &quot;</span> + Thread.currentThread().getId()); </span><br><span class="line">            tv.postInvalidate(); btn.postInvalidate(); </span><br><span class="line">            tv.setText(<span class="string">&quot;update UI is success!&quot;</span>); </span><br><span class="line">            btn.setText(<span class="string">&quot;update UI is success!&quot;</span>); </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;); </span><br><span class="line">    thread.start(); </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>postInvalidate()</code> æ–¹æ³•ï¼Œæºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postInvalidate</span><span class="params">()</span> &#123; </span><br><span class="line">    postInvalidateDelayed(<span class="number">0</span>); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postInvalidateDelayed</span><span class="params">(<span class="type">long</span> delayMilliseconds)</span> &#123; </span><br><span class="line">    <span class="comment">// We try only with the AttachInfo because there&#x27;s no point in invalidating </span></span><br><span class="line">    <span class="comment">// if we are not attached to our window </span></span><br><span class="line">    <span class="keyword">if</span> (mAttachInfo != <span class="literal">null</span>) &#123; </span><br><span class="line">        <span class="type">Message</span> <span class="variable">msg</span> <span class="operator">=</span> Message.obtain(); </span><br><span class="line">        msg.what = AttachInfo.INVALIDATE_MSG; </span><br><span class="line">        msg.obj = <span class="built_in">this</span>; </span><br><span class="line">        mAttachInfo.mHandler.sendMessageDelayed(msg, delayMilliseconds); </span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œ<code>postInvalidate()</code> æœ¬è´¨æ˜¯ä½¿ç”¨äº† Handler å¤„ç†æ¶ˆæ¯çš„æœºåˆ¶ï¼è¯¥æ–¹æ³•å¯ä»¥åœ¨å­çº¿ç¨‹ä¸­ç›´æ¥ç”¨æ¥æ›´æ–°UIã€‚å¯¹åº”çš„è¿˜æœ‰ä¸€ä¸ªæ–¹æ³• **invalidate()**ï¼Œç¨å€™å†è¯´ï¼</p><h3 id="3ã€åœ¨-Button-çš„äº‹ä»¶ä¸­å¼€å¯çº¿ç¨‹ï¼Œæ›´æ–°-UI"><a href="#3ã€åœ¨-Button-çš„äº‹ä»¶ä¸­å¼€å¯çº¿ç¨‹ï¼Œæ›´æ–°-UI" class="headerlink" title="3ã€åœ¨ Button çš„äº‹ä»¶ä¸­å¼€å¯çº¿ç¨‹ï¼Œæ›´æ–° UI"></a>3ã€åœ¨ Button çš„äº‹ä»¶ä¸­å¼€å¯çº¿ç¨‹ï¼Œæ›´æ–° UI</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MasterActivity</span> <span class="keyword">extends</span> <span class="title class_">Activity</span> &#123;</span><br><span class="line">    <span class="type">TextView</span> <span class="variable">tv</span> <span class="operator">=</span> <span class="literal">null</span>; <span class="type">Button</span> <span class="variable">btn</span> <span class="operator">=</span> <span class="literal">null</span>; </span><br><span class="line">    <span class="meta">@Override</span> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123; </span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState); </span><br><span class="line">        setContentView(R.layout.main); </span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">&quot;: &quot;</span> + Thread.currentThread().getId()); </span><br><span class="line">        tv = (TextView)findViewById(R.id.text); </span><br><span class="line">        btn = (Button)findViewById(R.id.btn); </span><br><span class="line">        btn.setOnClickListener(<span class="keyword">new</span> <span class="title class_">OnClickListener</span>() &#123; </span><br><span class="line">            <span class="meta">@Override</span> </span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123; </span><br><span class="line">                <span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123; </span><br><span class="line">                    <span class="meta">@Override</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123; </span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">&quot;: &quot;</span> + Thread.currentThread().getId()); </span><br><span class="line">                    tv.setText(<span class="string">&quot;update UI is success!&quot;</span>); </span><br><span class="line">                    btn.setText(<span class="string">&quot;update UI is success!&quot;</span>); </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;); </span><br><span class="line">            thread.start(); </span><br><span class="line">        &#125;</span><br><span class="line">     &#125;); </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p> Sorryï¼ŒæŠ¥é”™ï¼å³ä½¿ä½ åŠ ä¸Š <code>postInvalidate()</code> æ–¹æ³•ï¼Œä¹Ÿä¼šæŠ¥è¿™ä¸ªé”™è¯¯ã€‚</p> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UI.view.ViewRoot$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views.</span><br></pre></td></tr></table></figure><p><img src="/upload/images/2019/12/21/1.jpg" alt="1"></p><h3 id="4ã€ä½¿ç”¨-Handler-ç»“åˆå¤šçº¿ç¨‹æ›´æ–°-UI"><a href="#4ã€ä½¿ç”¨-Handler-ç»“åˆå¤šçº¿ç¨‹æ›´æ–°-UI" class="headerlink" title="4ã€ä½¿ç”¨ Handler ç»“åˆå¤šçº¿ç¨‹æ›´æ–° UI"></a>4ã€ä½¿ç”¨ Handler ç»“åˆå¤šçº¿ç¨‹æ›´æ–° UI</h3><p>a. å¼€å¯ä¸€ä¸ªçº¿ç¨‹ï¼Œåœ¨ run æ–¹æ³•ä¸­é€šçŸ¥ Handler</p><p>b. Handler ä¸­ä½¿ç”¨ handleMessage æ–¹æ³•æ›´æ–° UI</p><h3 id="5ã€Handler-å’Œ-invalidate-æ–¹æ³•ç»“åˆå¤šçº¿ç¨‹æ›´æ–°-UI"><a href="#5ã€Handler-å’Œ-invalidate-æ–¹æ³•ç»“åˆå¤šçº¿ç¨‹æ›´æ–°-UI" class="headerlink" title="5ã€Handler å’Œ invalidate æ–¹æ³•ç»“åˆå¤šçº¿ç¨‹æ›´æ–° UI"></a>5ã€Handler å’Œ invalidate æ–¹æ³•ç»“åˆå¤šçº¿ç¨‹æ›´æ–° UI</h3><p>æ–¹æ³• <code>invalidate</code> ä¸»è¦ç”¨åœ¨ä¸»çº¿ç¨‹ä¸­ï¼ˆå³UI çº¿ç¨‹ä¸­ï¼‰ï¼Œ<strong>ä¸å¯ä»¥ç”¨äºå­çº¿ç¨‹ã€‚</strong>å¦‚æœåœ¨å­çº¿ç¨‹ä¸­éœ€è¦ä½¿ç”¨ <code>postInvalidate</code> æ–¹æ³•ã€‚</p><p>Android çš„ API æœ‰è¯´æ˜ï¼š</p><blockquote><p>public void invalidate () Since: API Level 1 Invalidate the whole view.</p><p>If the view is visible, onDraw(Canvas) will be called at some point in the future.</p><p>This must be called from a UI thread. To call from a non-UI thread, call postInvalidate(). </p></blockquote><p>çœ‹çœ‹è¯¥æ–¹æ³•æºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">invalidate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (ViewDebug.TRACE_HIERARCHY) &#123;</span><br><span class="line">            ViewDebug.trace(<span class="built_in">this</span>, ViewDebug.HierarchyTraceType.INVALIDATE);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((mPrivateFlags &amp; (DRAWN | HAS_BOUNDS)) == (DRAWN | HAS_BOUNDS)) &#123;</span><br><span class="line">            mPrivateFlags &amp;= ~DRAWN &amp; ~DRAWING_CACHE_VALID;</span><br><span class="line">            <span class="keyword">final</span> <span class="type">ViewParent</span> <span class="variable">p</span> <span class="operator">=</span> mParent;</span><br><span class="line">            <span class="keyword">final</span> <span class="type">AttachInfo</span> <span class="variable">ai</span> <span class="operator">=</span> mAttachInfo;</span><br><span class="line">            <span class="keyword">if</span> (p != <span class="literal">null</span> &amp;&amp; ai != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">final</span> <span class="type">Rect</span> <span class="variable">r</span> <span class="operator">=</span> ai.mTmpInvalRect;</span><br><span class="line">                r.set(<span class="number">0</span>, <span class="number">0</span>, mRight - mLeft, mBottom - mTop); <span class="comment">// Don&#x27;t call invalidate -- we don&#x27;t want to internally scroll // our own bounds p.invalidateChild(this, r); &#125; &#125; &#125; </span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>invalidate</code> æ–¹æ³•å¦‚æœä½ ç›´æ¥åœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨ï¼Œæ˜¯çœ‹ä¸åˆ°ä»»ä½•æ›´æ–°çš„ã€‚éœ€è¦ä¸ Handler ç»“åˆï¼</p><p>Android  åœ¨ <code>onDraw</code> äº‹ä»¶å¤„ç†ç»˜å›¾ï¼Œè€Œ <code>invalidate()</code> å‡½æ•°å¯ä»¥å†ä¸€æ¬¡è§¦å‘ <code>onDraw</code> äº‹ä»¶ï¼Œç„¶åå†ä¸€æ¬¡è¿›è¡Œç»˜å›¾åŠ¨ä½œã€‚å®ä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MasterActivity</span> <span class="keyword">extends</span> <span class="title class_">Activity</span> &#123;</span><br><span class="line"><span class="keyword">static</span> <span class="type">int</span> <span class="variable">times</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/** Called when the activity is first created. */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line"> </span><br><span class="line">        setContentView( <span class="keyword">new</span> <span class="title class_">View</span>(<span class="literal">null</span>) &#123;</span><br><span class="line"> </span><br><span class="line">            <span class="type">Paint</span> <span class="variable">vPaint</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Paint</span>();  <span class="comment">//ç»˜åˆ¶æ ·å¼ç‰©ä»¶</span></span><br><span class="line">            <span class="keyword">private</span> <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;           <span class="comment">//å¼§å½¢è§’åº¦</span></span><br><span class="line"> </span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onDraw</span> <span class="params">(Canvas canvas)</span> &#123;</span><br><span class="line">                <span class="built_in">super</span>.onDraw(canvas);</span><br><span class="line">                System.out.println(<span class="string">&quot;this run &quot;</span> + (times++) +<span class="string">&quot; times!&quot;</span>);</span><br><span class="line"> </span><br><span class="line">                <span class="comment">// è®¾å®šç»˜å›¾æ ·å¼</span></span><br><span class="line">                vPaint.setColor( <span class="number">0xff00ffff</span> ); <span class="comment">//ç”»ç¬”é¢œè‰²</span></span><br><span class="line">                vPaint.setAntiAlias( <span class="literal">true</span> );   <span class="comment">//åé”¯é½¿</span></span><br><span class="line">                vPaint.setStyle( Paint.Style.STROKE );</span><br><span class="line"> </span><br><span class="line">                <span class="comment">// ç»˜åˆ¶ä¸€ä¸ªå¼§å½¢</span></span><br><span class="line">                canvas.drawArc(<span class="keyword">new</span> <span class="title class_">RectF</span>(<span class="number">60</span>, <span class="number">120</span>, <span class="number">260</span>, <span class="number">320</span>), <span class="number">0</span>, i, <span class="literal">true</span>, vPaint );</span><br><span class="line"> </span><br><span class="line">                <span class="comment">// å¼§å½¢è§’åº¦</span></span><br><span class="line">                <span class="keyword">if</span>( (i+=<span class="number">10</span>) &gt; <span class="number">360</span> ) &#123;</span><br><span class="line">                    i = <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line"> </span><br><span class="line">                <span class="comment">// é‡ç»˜, å†ä¸€æ¬¡æ‰§è¡ŒonDraw ç¨‹åº</span></span><br><span class="line">                invalidate();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»è¿‡æµ‹è¯•ï¼Œå‘ç° <code>times</code> ä¸€ç›´åœ¨è¢« <code>++</code>ï¼Œè¯´æ˜ <code>onDraw</code> è¢«å¤šæ¬¡è°ƒç”¨ï¼Œå¹¶ä¸”ä¸€ç›´åœ¨ç”»å›¾ï¼</p><p>Android çš„ API æœ‰æ—¶å€™è®©äººçœ‹çš„å¾ˆéƒé—·å¾ˆæ— è¯­â€¦..å…³äº <code>invalidate</code> çš„ä½¿ç”¨ï¼Œè¿˜å¾…æ¢ç´¢ã€‚é©å‘½å°šæœªæˆåŠŸï¼ŒåŒå¿—ä»éœ€åŠªåŠ›ï¼</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p><strong>é™„å½•ï¼š Handlerã€Messageã€MessageQueueã€Looper ä¹‹é—´çš„å…³ç³»</strong></p><p><img src="/upload/images/2019/12/21/2.jpg" alt="1"></p><p><strong>è¿™é‡Œè¯´æ˜</strong></p><ul><li><p>Looper ä½¿ç”¨æ— é™å¾ªç¯å–å‡ºæ¶ˆæ¯ï¼Œæ˜¯æœ‰ UI OS æ§åˆ¶çš„ï¼›</p></li><li><p>UI çº¿ç¨‹æ˜¯éå®‰å…¨çš„ï¼Œå³ä¸è¦åœ¨å­çº¿ç¨‹ä¸­æ›´æ–° UIï¼›</p></li><li><p>Looper å–å‡ºæ¥çš„æ¶ˆæ¯ï¼ŒHandler å¯ä»¥é€šè¿‡ <code>what</code>ã€<code>obj</code>  ç­‰é‡æ¥åŒºåˆ«åˆ†åˆ«è·å–å±äºè‡ªå·±çš„æ¶ˆæ¯ï¼Œæ‰€ä»¥æ¨èä½¿ç”¨è¿™äº›å†…ç½®å˜é‡ã€‚</p></li></ul><hr><p><strong>å¤©ç”Ÿæˆ‘æå¿…æœ‰ç”¨ï¼Œåƒé‡‘æ•£å°½è¿˜å¤æ¥ã€‚</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> UI Handler </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡: MySQLåŸºæœ¬æ“ä½œ</title>
      <link href="/2019/12/07/%E5%BE%AE%E6%9C%8D%E5%8A%A1-MySQL%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/"/>
      <url>/2019/12/07/%E5%BE%AE%E6%9C%8D%E5%8A%A1-MySQL%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æœ¬ç¯‡æ˜¯ <a href="http://www.veryitman.com/2019/05/28/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%A1%B9%E7%9B%AE%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/">å¾®æœåŠ¡ç³»åˆ—</a> çš„ç¬¬ N ç¯‡ï¼Œä»æœ¬ç¯‡å¼€å§‹æˆ‘ä»¬å°±è¦æ¥è§¦å’Œå­¦ä¹ æ•°æ®åº“ç›¸å…³çš„çŸ¥è¯†äº†ã€‚</p><p>æ•°æ®åº“æˆ‘ä»¬é€‰æ‹© MySQL æ•°æ®åº“ï¼Œå…è´¹ä¸”èµ„æ–™å¤šï¼Œå¤§éƒ¨åˆ†å…¬å¸éƒ½ä¼šä½¿ç”¨è¯¥æ•°æ®åº“ã€‚æˆ‘æ˜¯åœ¨ <code>Windows 10</code> ä¸Šé¢æ­å»ºçš„å¾®æœåŠ¡å¼€å‘ç¯å¢ƒï¼ŒåŒç†ï¼ŒMySQL æ•°æ®åº“ä¹Ÿæ˜¯åœ¨è¿™ä¸ªç³»ç»Ÿä¸Šé¢å®‰è£…çš„å¹¶ä¸”ä½¿ç”¨çš„æ˜¯ MySQL8.0 ç‰ˆæœ¬ï¼Œå¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£…æˆ–è€…åœ¨å®‰è£… MySQL8.0 é‡åˆ°é—®é¢˜å¯ä»¥å‚è€ƒ <a href="http://www.veryitman.com/2019/11/10/MySQL8-0-15%E5%9C%A8Win10%E4%B8%8A%E7%9A%84%E6%8A%98%E8%85%BE%E8%AE%B0/">MySQL8.0.15åœ¨Win10ä¸Šçš„æŠ˜è…¾è®°</a> è¿™ç¯‡æ–‡ç« ã€‚</p><p>ä»Šå¤©ä¸»è¦è·Ÿå¤§å®¶åˆ†äº«å¦‚ä½•ä½¿ç”¨ SpringBoot ç»“åˆ JDBC è¿æ¥å’Œæ“ä½œ MySQL æ•°æ®åº“ï¼Œä¸»è¦è¿˜æ˜¯ä»¥å®ä¾‹ä¸ºä¸»ã€‚</p><h2 id="JDBCã€ODBCã€MySQL-Connectors"><a href="#JDBCã€ODBCã€MySQL-Connectors" class="headerlink" title="JDBCã€ODBCã€MySQL Connectors"></a>JDBCã€ODBCã€MySQL Connectors</h2><p>åœ¨è¯´å®ä¾‹ä¹‹å‰ï¼Œå¸¦å¤§å®¶å…ˆäº†è§£ä¸€ä¸‹æ ‡é¢˜ä¸­å‡ ä¸ªåè¯çš„æ¦‚å¿µã€‚</p><p>JDBCï¼ˆJava database connectivityï¼Œæ•°æ®è¿æ¥ï¼‰ï¼Œæ˜¯ Sun å…¬å¸ç¼–çš„ä¸€å †ç±»å’Œæ–¹æ³•ï¼Œéƒ½å°è£…åœ¨ <code>java.sql</code> åŒ…ä¸­ï¼Œå¯ä»¥åˆ©ç”¨è¿™äº›ç±»å’Œæ–¹æ³•æ¥æŠŠä½ çš„ Java ç¨‹åºå’Œä»»æ„çš„æ•°æ®åº“è¿é€šã€‚å³é€šè¿‡ä½¿ç”¨ JDBCï¼ŒJava å¼€å‘äººå‘˜å¯ä»¥å°† SQL è¯­å¥ä¼ é€ç»™å‡ ä¹ä»»ä½•ä¸€ç§æ•°æ®åº“ã€‚ </p><p>å¯¹åº”çš„è¿˜æœ‰ ODBCï¼ˆ Open Database Connectivityï¼Œ å¼€æ”¾æ•°æ®åº“äº’è¿ï¼‰ï¼ŒODBC æ˜¯ Microsoft æå‡ºçš„æ•°æ®åº“è®¿é—®æ¥å£æ ‡å‡†ã€‚å¼€æ”¾æ•°æ®åº“äº’è¿å®šä¹‰äº†è®¿é—®æ•°æ®åº“ API çš„ä¸€ä¸ªè§„èŒƒï¼ŒMicrosoft çš„ ODBC æ–‡æ¡£æ˜¯ç”¨ C è¯­è¨€æè¿°çš„ï¼Œè®¸å¤šå®é™…çš„ ODBC é©±åŠ¨ç¨‹åºä¹Ÿæ˜¯ç”¨ C è¯­è¨€å†™çš„ã€‚ODBC æä¾›äº†å¯¹ SQL è¯­è¨€çš„æ”¯æŒï¼Œç”¨æˆ·å¯ä»¥ç›´æ¥å°† SQL è¯­å¥é€ç»™ ODBCã€‚</p><p>JDBC å’Œ ODBC éƒ½æ˜¯ç”¨æ¥è¿æ¥æ•°æ®åº“çš„å¯åŠ¨ç¨‹åºï¼Œä¸¤è€…å…·æœ‰æ•°æ®åº“ç‹¬ç«‹æ€§ç”šè‡³å¹³å°æ— å…³æ€§ã€‚</p><p><a href="https://www.mysql.com/products/connector/">MySQL Connectors</a> æ˜¯ MySQL æ•°æ®åº“çš„é©±åŠ¨ï¼ˆç¨‹åºï¼‰ï¼Œæœ‰å¯¹å„ç§è¯­è¨€çš„æ”¯æŒã€‚<code>mysql-connector-java</code>ï¼ˆä¹Ÿç§°ä¹‹ä¸º Connector&#x2F;J æˆ–è€… mysql-connector-jdbcï¼‰ æ˜¯ MySQL-Connectors çš„ Java ç‰ˆæœ¬çš„ä¸€ä¸ªå®ç° ï¼Œç”¨å®ƒå¯ä»¥è¿æ¥ MySQL ç³»ç»Ÿã€‚ </p><p>åŒç†ï¼Œè¿˜æœ‰ <code>mysql-connector-python</code>ã€<code>mysql-connector-c</code>ã€ <code>mysql-connector-ODBC</code>ã€<code>mysql-connector-jdbc</code> ç­‰ï¼Œå¦‚ä¸‹å›¾ï¼ˆæ¥è‡ª <a href="https://www.mysql.com/products/connector/">MySQL Connectors</a> å®˜ç½‘ï¼‰ï¼š</p><p><img src="/upload/images/2019/12/07/1.png" alt="1568529858131"></p><p>å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å›¾ç®€å•æè¿°ä¸€ä¸‹JDBCå’Œæ•°æ®è¿æ¥çš„ç¤ºæ„å›¾ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="/upload/images/2019/12/07/2.png" alt="1568529858131"></p><p>ä¸€å›¾èƒœåƒè¨€ï¼ŒJava åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡ JDBC å’Œæ•°æ®åº“é©±åŠ¨ç¨‹åºè¿æ¥ã€è®¿é—®ã€æ“ä½œæ•°æ®åº“ï¼ˆMySQLã€Oracleç­‰ï¼‰ã€‚</p><h2 id="é…ç½®-pom-æ–‡ä»¶"><a href="#é…ç½®-pom-æ–‡ä»¶" class="headerlink" title="é…ç½® pom æ–‡ä»¶"></a>é…ç½® pom æ–‡ä»¶</h2><p>æˆ‘è¿˜æ˜¯ç”¨ <a href="https://github.com/veryitman/MSTutorial">Github</a> ä»£ç ä»“åº“çš„ä¾‹å­ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œ Clone ä»£ç ã€‚</p><p>æ‰“å¼€å·¥ç¨‹çš„ <code>pom.xml</code> æ–‡ä»¶ï¼Œå¢åŠ  <code>mysql-connector-java</code> å’Œ <code>spring-boot-starter-jdbc</code> ä¾èµ–ï¼Œä»ä¸Šé¢å†…å®¹å¤§å®¶åº”è¯¥å¯ä»¥ç†è§£ä¸ºä»€ä¹ˆè¦åŠ å…¥è¿™ä¸¤é¡¹äº†å§ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--mysql-connector-java--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç­‰å¾… Maven ä¸‹è½½å®Œæˆè¿™ä¸¤é¡¹ä¾èµ–ã€‚</p><h2 id="é…ç½®-properties"><a href="#é…ç½®-properties" class="headerlink" title="é…ç½® properties"></a>é…ç½® properties</h2><p>æ‰“å¼€ <code>application-dev.properties</code> æ–‡ä»¶ï¼Œå¢åŠ å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># jdbc</span><br><span class="line"># spring.datasource.driver-class-name=com.mysql.jdbc.Driver</span><br><span class="line"># JDBC </span><br><span class="line">spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver</span><br><span class="line"># è¿æ¥çš„æ•°æ®åº“</span><br><span class="line"># spring.datasource.url=jdbc:mysql://127.0.0.1:3306/mzc_user</span><br><span class="line">spring.datasource.url=jdbc:mysql://127.0.0.1:3306/mzc_user?serverTimezone=GMT%2B8&amp;useUnicode=true&amp;characterEncoding=utf-8</span><br><span class="line"># æ•°æ®åº“ç”¨æˆ·å</span><br><span class="line">spring.datasource.username=root</span><br><span class="line"># æ•°æ®åº“å¯†ç </span><br><span class="line">spring.datasource.password=pwd123</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>mzc_user</code> æ˜¯æˆ‘åˆ›å»ºçš„æ•°æ®åº“æ–‡ä»¶åç§°ï¼Œå¤§å®¶è¦æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µåšç›¸å…³çš„ä¿®æ”¹ã€‚é…ç½® properties æ³¨æ„ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ã€‚</p><h3 id="1ã€spring-datasource-driver-class-name-çš„é…ç½®"><a href="#1ã€spring-datasource-driver-class-name-çš„é…ç½®" class="headerlink" title="1ã€spring.datasource.driver-class-name çš„é…ç½®"></a>1ã€spring.datasource.driver-class-name çš„é…ç½®</h3><p>å¦‚æœé…ç½®å€¼ä¸º <code>com.mysql.jdbc.Driver</code>ï¼Œä¼šæŠ¥ä¸‹é¢çš„è­¦å‘Šï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Loading class `com.mysql.jdbc.Driver&#x27;. This is deprecated. </span><br><span class="line">The new driver class is `com.mysql.cj.jdbc.Driver&#x27;. </span><br><span class="line">The driver is automatically registered via the SPI and manual loading of the driver class is generally unnecessary.</span><br></pre></td></tr></table></figure><p>æ„æ€æ˜¯è¿™ä¸ªç±»å·²ç»è¿‡æ—¶äº†ï¼Œè¯·ä½¿ç”¨æœ€æ–°çš„ <code>jdbc.driver</code> ä¿®æ”¹æ•°æ®æºé…ç½®ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.datasource.driver<span class="operator">-</span>class<span class="operator">-</span>name<span class="operator">=</span>com.mysql.cj.jdbc.Driver</span><br></pre></td></tr></table></figure><h3 id="2ã€spring-datasource-url-çš„é…ç½®"><a href="#2ã€spring-datasource-url-çš„é…ç½®" class="headerlink" title="2ã€spring.datasource.url çš„é…ç½®"></a>2ã€spring.datasource.url çš„é…ç½®</h3><p>å…³äºè¿™ä¸ªurl çš„é…ç½®ï¼Œå®˜æ–¹æœ‰æ›´åŠ è¯¦ç»†çš„é…ç½®è¯´æ˜ï¼Œå¯ä»¥å‚è€ƒ <a href="https://dev.mysql.com/doc/connector-j/8.0/en/connector-j-reference-jdbc-url-format.html">Connection URL Syntax</a> å’Œ <a href="https://dev.mysql.com/doc/connector-j/8.0/en/connector-j-reference-configuration-properties.html">Configuration Properties</a> ä¸¤ç¯‡æ–‡æ¡£ã€‚</p><p>å¦‚æœé…ç½®ä¸º <code>spring.datasource.url=jdbc:mysql://127.0.0.1:3306/mzc_user</code>ï¼Œä¼šä¸€ç›´æŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">The server time zone value &#x27;ï¿½Ğ¹ï¿½ï¿½ï¿½×¼Ê±ï¿½ï¿½&#x27; is unrecognized or represents more than one time zone. </span><br><span class="line">You must configure either the server or JDBC driver (via the serverTimezone configuration property) to use a more specifc time zone value if you want to utilize time zone support.</span><br></pre></td></tr></table></figure><p>è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ‰å¦‚ä¸‹3ç§è§£å†³æ–¹æ¡ˆã€‚</p><p><strong>1ã€æŒ‡å®šæ—¶åŒº</strong></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// åŒ—äº¬æ—¶é—´ä¸œå…«åŒº</span><br><span class="line">serverTimezone=GMT%2B8</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œ<code>%2B</code> æ˜¯ <code>+</code> çš„ç¼–ç æ ¼å¼ã€‚<br>å¦‚æœä½ è®¾ç½® <code>serverTimezone=UTC</code>ï¼Œè¿æ¥ä¸æŠ¥é”™ï¼Œ ä½†åœ¨ç”¨javaä»£ç æ’å…¥åˆ°æ•°æ®åº“æ—¶é—´çš„æ—¶å€™å´å‡ºç°äº†é—®é¢˜ã€‚ </p><p>æ¯”å¦‚åœ¨ Java ä»£ç é‡Œé¢æ’å…¥çš„æ—¶é—´ä¸º <code>2018-06-24 17:29:56</code>ï¼Œä½†æ˜¯åœ¨æ•°æ®åº“é‡Œé¢æ˜¾ç¤ºçš„æ—¶é—´å´ä¸º <code>2018-06-24 09:29:56</code>ï¼Œè¿™æ ·å°±æœ‰äº†8ä¸ªå°æ—¶çš„æ—¶å·®ã€‚UTC ä»£è¡¨çš„æ˜¯å…¨çƒæ ‡å‡†æ—¶é—´ ï¼Œè€Œæˆ‘ä»¬ä½¿ç”¨çš„æ—¶é—´æ˜¯åŒ—äº¬æ—¶åŒºä¹Ÿå°±æ˜¯ä¸œå…«åŒºï¼Œé¢†å…ˆ UTC å…«ä¸ªå°æ—¶ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// äº¬æ—¶é—´ä¸œå…«åŒº</span><br><span class="line">serverTimezone=GMT%2B8</span><br><span class="line"></span><br><span class="line">// æˆ–è€…ä½¿ç”¨ä¸Šæµ·æ—¶é—´</span><br><span class="line">serverTimezone=Asia/Shanghai</span><br></pre></td></tr></table></figure><p><strong>2ã€ä¿®æ”¹ MySQL é…ç½®æ–‡ä»¶</strong></p><p>æˆ‘åœ¨ <code>Windows 10</code> æ‰¾åˆ° MySQL é…ç½®æ–‡ä»¶ <code>my.ini</code> ï¼Œå¦‚æœä½ æ²¡æœ‰æ‰¾åˆ°å¯ä»¥å‚è€ƒ <a href="http://www.veryitman.com/2019/11/10/MySQL8-0-15%E5%9C%A8Win10%E4%B8%8A%E7%9A%84%E6%8A%98%E8%85%BE%E8%AE%B0/">MySQL8.0.15åœ¨Win10ä¸Šçš„æŠ˜è…¾è®°</a>  è¿™ç¯‡æ–‡ç« ï¼Œé <code>Windows</code> ç³»ç»Ÿå¯èƒ½é…ç½®æ–‡ä»¶æ—¶ <code>my.cnf</code>ã€‚</p><p>åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œå¢åŠ é»˜è®¤æ—¶åŒºé…ç½®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">default-time-zone=&#x27;+08:00&#x27;</span><br></pre></td></tr></table></figure><p>åœ¨ <code>my.ini</code> æˆ–è€… <code>my.cnf</code> æ–‡ä»¶çš„ <code>[mysqld]</code> ä¸‹é¢å¢åŠ ä¸Šé¢é…ç½®ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line"></span><br><span class="line"># Set default time-zone</span><br><span class="line">default-time-zone=&#x27;+08:00&#x27;</span><br><span class="line"></span><br><span class="line"># The TCP/IP Port the MySQL Server will listen on</span><br><span class="line">port=3306</span><br><span class="line"></span><br><span class="line"># ...</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹é…ç½®æ–‡ä»¶ä¹‹åï¼Œé‡å¯MySQLæœåŠ¡å°±å¯ä»¥äº†ã€‚</p><p><strong>3ã€ä¿®æ”¹æ•°æ®åº“ï¼Œ é…ç½®å…¨å±€æ—¶åŒº</strong> </p><p>åˆ‡æ¢åˆ°åç§°ä¸º <code>mysql</code> çš„æ•°æ®åº“ï¼Œç„¶åæ‰§è¡Œä¸‹é¢çš„è¯­å¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%time_zone%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"># è®¾ç½®å…¨å±€æ—¶åŒºï¼Œå³æ—¶ç”Ÿæ•ˆï¼Œä½œç”¨äºæ‰€æœ‰session</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> time_zone<span class="operator">=</span><span class="string">&#x27;+8:00&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="/upload/images/2019/12/07/3.png" alt="1568529858131"></p><p>è®¾ç½®å®Œæˆåï¼Œå¯ä»¥ä½¿ç”¨ <code>show variables like &#39;%time_zone%&#39;;</code> çœ‹çœ‹æ˜¯å¦ä¿®æ”¹æˆåŠŸã€‚</p><p>ä½ ä¹Ÿå¯ä»¥æ‰§è¡Œï¼Œä½†æ˜¯åªèƒ½å¯¹å½“å‰çš„ session ç”Ÿæ•ˆï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># è®¾ç½®å½“å‰sessionæ—¶åŒºï¼Œå³æ—¶ç”Ÿæ•ˆï¼Œä½†ä»…ä½œç”¨äºå½“å‰session</span><br><span class="line"><span class="keyword">set</span> time_zone<span class="operator">=</span><span class="string">&#x27;+8:00&#x27;</span>;</span><br></pre></td></tr></table></figure><p>æˆ‘ä¸ªäººä½¿ç”¨çš„æ˜¯ä¸Šè¿°ä¸­çš„ç¬¬<strong>1</strong>ç§æ–¹æ³•ï¼Œæˆ‘ä¹Ÿæ¨èå¤§å®¶ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œç®€å•ä¸”æ— å‰¯ä½œç”¨ã€‚</p><p>è¿™é‡Œæœ‰ä¸€ç¯‡å‘è®° <a href="https://my.oschina.net/purely/blog/1477281">jdbc mysql connector 6 æ—¶åŒºé—®é¢˜</a>ï¼Œå…³äºè®¾ç½® <code>time_zone</code> çš„å‘ï¼Œå¤§å®¶å¯ä»¥çœ‹çœ‹ã€‚</p><h2 id="ä¸‡äº‹ä¿±å¤‡ï¼Œåªæ¬ ä»£ç "><a href="#ä¸‡äº‹ä¿±å¤‡ï¼Œåªæ¬ ä»£ç " class="headerlink" title="ä¸‡äº‹ä¿±å¤‡ï¼Œåªæ¬ ä»£ç "></a>ä¸‡äº‹ä¿±å¤‡ï¼Œåªæ¬ ä»£ç </h2><p>é…ç½®å®Œæˆä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å†™ç‚¹æµ‹è¯•ä»£ç äº†ã€‚</p><p>æœ¬èŠ‚çš„ä»£ç ä¸»è¦é›†ä¸­åœ¨ <code>MSUserService</code>ã€<code>MSUserServiceImpl</code>ã€<code>MSDBTests</code> ä¸­ï¼Œå…¶ä¸­ <code>MSUserService</code> æ˜¯æ¥å£ï¼Œå®šä¹‰äº†ä¸€äº›æ•°æ®åº“æ“ä½œçš„æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MSUserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">createUser</span><span class="params">(MSUser user)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">deleteByUid</span><span class="params">(Integer uid)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;Map&gt; <span class="title function_">queryUserByUid</span><span class="params">(Integer uid)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;Map&gt; <span class="title function_">queryUserByUserName</span><span class="params">(String userName)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">deleteUserTable</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œ <code>MSUserServiceImpl</code> åˆ™æ˜¯  <code>MSUserService</code> çš„å®ç°ç±»ï¼Œ <code>MSDBTests</code> ä¸»è¦æ˜¯æµ‹è¯•ç±»ï¼Œç”¨æ¥æµ‹è¯•æ“ä½œ MySQL æ•°æ®è¡¨çš„å¦‚åˆ›å»ºè¡¨ã€æŸ¥è¯¢ã€åˆ é™¤ç­‰æ“ä½œã€‚å¤§å®¶è‡ªè¡Œ Clone ä»£ç å»çœ‹å®ç°å³å¯ï¼Œæˆ‘å°±ä¸åœ¨è¿™é‡Œå ç”¨ç¯‡å¹…è´´ä»£ç äº†ã€‚</p><p>åœ¨æœ¬èŠ‚ä»£ç ä¸­ï¼Œæ–°å¢åŠ äº†ä¸¤ä¸ªæ³¨è§£çš„ä½¿ç”¨å³ <code>@Service</code> å’Œ <code>@Slf4j</code>ï¼Œ<code>@Slf4j</code> è¿™ä¸ªæ³¨è§£ä¸»è¦ç”¨æ¥ç®€åŒ–ä½¿ç”¨æ—¥å¿—ã€‚è€Œ <code>@Service</code> æ³¨è§£æ‰¿æ‹…äº†ä¸¤ä¸ªèŒè´£ä¸€æ˜¯ Bean çš„åˆ›å»ºï¼ŒäºŒæ˜¯å°†ä¸€ä¸ªç±»æ ‡è¯†ä¸ºä¸€ä¸ªæœåŠ¡ã€‚åç»­æˆ‘ä¼šå†æ·±å…¥è·Ÿå¤§å®¶åˆ†äº«  <code>@Service</code> è¿™ä¸ªæ³¨è§£ï¼Œç›®å‰ä½ åªéœ€è¦ç”¨ä¸Šå®ƒå°±å¯ä»¥äº†ã€‚</p><p>åœ¨æœ¬èŠ‚çš„ä¾‹å­ä¸­ï¼Œç”¨åˆ°çš„æ•°æ®è¡¨ï¼ˆuserï¼‰çš„æ•°æ®ç»“æ„å¤§æ¦‚å¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/12/07/4.png" alt="1568529858131"></p><p>å¯åŠ¨ MySQL æœåŠ¡ï¼Œç„¶åå¯åŠ¨ <code>MSDBTests</code> ä¸­çš„æµ‹è¯•ä»£ç ï¼Œå°±å¯ä»¥çœ‹åˆ°å®é™…æ•ˆæœäº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">createUserSQLTest</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">MSUser</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MSUser</span>();</span><br><span class="line">    user.setUserID(<span class="number">1</span>);</span><br><span class="line">    user.setAccountName(<span class="string">&quot;mzc&quot;</span>);</span><br><span class="line">    user.setAccountPwd(<span class="string">&quot;123&quot;</span>);</span><br><span class="line">    user.setNickName(<span class="string">&quot;veryitman&quot;</span>);</span><br><span class="line">    user.setMotto(<span class="string">&quot;foo&quot;</span>);</span><br><span class="line">    user.setAge(<span class="number">25</span>);</span><br><span class="line">    user.setGender(MSUser.GENDER_MALE);</span><br><span class="line">    user.setPhone(<span class="string">&quot;17122036530&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¢åŠ useræ•°æ®</span></span><br><span class="line">    msUserService.createUser(user);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">queryUserBySQLTest</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// æ ¹æ®user_idæŸ¥è¯¢</span></span><br><span class="line">    List&lt;Map&gt; userJson = msUserService.queryUserByUid(<span class="number">1</span>);</span><br><span class="line">    logger.info(<span class="string">&quot;MSBlog Test, userJson by query user&#x27;s id: &quot;</span> + userJson.get(<span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ¹æ®user_nameæŸ¥è¯¢</span></span><br><span class="line">    userJson = msUserService.queryUserByUserName(<span class="string">&quot;mzc&quot;</span>);</span><br><span class="line">    logger.info(<span class="string">&quot;MSBlog Test, userJson by query user&#x27;s name: &quot;</span> + userJson.get(<span class="number">0</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»Šå¤©å°±åˆ†äº«åˆ°è¿™é‡Œï¼Œä¸‹æ¬¡ç»“åˆç™»å½•æ³¨å†Œä¾‹å­æ“ä½œ MySQL æ•°æ®åº“ã€‚</p><hr><p><strong>åšäº‹æƒ…ï¼Œä¸é—®èƒ½ä¸èƒ½åšæˆï¼Œè¦é—®åº”ä¸åº”è¯¥åšã€‚</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
          <category> DB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL JDBC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çŸ­åœ°å€åŸç†</title>
      <link href="/2019/11/24/%E7%9F%AD%E5%9C%B0%E5%9D%80%E5%8E%9F%E7%90%86/"/>
      <url>/2019/11/24/%E7%9F%AD%E5%9C%B0%E5%9D%80%E5%8E%9F%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>ä¸€ä¸ªåŒäº‹é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œä»–è¯´å—é™äºç¬¬ä¸‰æ–¹çš„æœåŠ¡ï¼Œè‡ªå·±è¯·æ±‚æ‰€å¸¦è¿‡å»çš„å­—ç¬¦ä¸²å› ä¸ºå¤ªé•¿ï¼Œæ— æ³•ä»ç¬¬ä¸‰æ–¹æœåŠ¡è·å–ä¿¡æ¯ï¼Œå¾ˆæ˜¯è‹¦æ¼ğŸ˜´ã€‚åæ¥æˆ‘ä»¬å•†é‡äº†ä¸€ä¸‹ï¼Œæœ€ç»ˆå€Ÿé‰´çŸ­åœ°å€çš„æ€æƒ³è§£å†³äº†é—®é¢˜ã€‚é“ç†å¾ˆç®€å•ï¼Œå› ä¸ºæˆ‘ä»¬è¯·æ±‚ä¸­çš„é™„åŠ å­—ç¬¦ä¸²ä¿¡æ¯ç¬¬ä¸‰æ–¹æœåŠ¡åªæ˜¯é€ä¼ å›æ¥ç»™æˆ‘ä»¬ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠè¿™äº›é™„åŠ ä¿¡æ¯è¿›è¡Œå­—ç¬¦å‹ç¼©å°±å¯ä»¥äº†ï¼Œè¿™æ ·è¯·æ±‚å¸¦è¿‡å»çš„å­—ç¬¦ä¸²é•¿åº¦å°±æ»¡è¶³äº†è¦æ±‚ğŸ˜Šã€‚</p><p>æ— è®ºæ˜¯å†™æ–‡ç« è¿˜æ˜¯åˆ¶ä½œä¸€äº›è¡¨æ ¼çš„æ—¶å€™ï¼Œæˆ‘ä¼šæ—¶å¸¸ç”¨åˆ°çŸ­åœ°å€ã€‚çŸ­åœ°å€çš„ä¼˜åŠ¿åœ¨äºå…¶çŸ­ï¼ˆå­—ç¬¦å°‘ï¼‰ã€ç®€æ´ï¼Œæ–¹ä¾¿ä¹¦å†™åˆä¸å ä½ç½®ã€‚æ–¹ä¾¿åœ¨ç¤¾äº¤ç½‘ç»œå’Œç¬¬ä¸‰æ–¹å¹³å°ä¸Šåˆ†äº«é“¾æ¥ï¼ŒæŠ•æ”¾å¹¿å‘Šã€‚æ¯”å¦‚æœ‰äººä¼šåœ¨å‘æœ‹å‹åœˆçš„æ—¶å€™å¸¦ä¸ŠçŸ­åœ°å€ï¼Œè¿˜æœ‰ä¸€äº›è¥é”€çŸ­ä¿¡é‡Œé¢ä¹Ÿä¼šå¸¦ä¸€äº›çŸ­åœ°å€é“¾æ¥ã€‚</p><p>æœ‰ç°æˆçš„çŸ­åœ°å€ç”Ÿæˆå™¨ï¼Œå¸¸ç”¨çš„çŸ­åœ°å€è½¬æ¢æœ‰ <a href="http://dwz.cn/">ç™¾åº¦çŸ­ç½‘å€è½¬æ¢</a>ã€<a href="https://goo.gl/">GoogleçŸ­ç½‘å€è½¬æ¢</a> å’Œ <a href="http://dwz.wailian.work/">æ–°æµªçŸ­åœ°å€è½¬æ¢</a>ï¼Œå¯æƒœçš„æ˜¯è°·æ­Œå…³é—­äº†è¯¥æœåŠ¡ï¼Œå®˜æ–¹å‘è¨€å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">On March 30, 2018, we turned down support for goo.gl URL shortener. </span><br><span class="line">From April 13, 2018, only existing users were able to create short links on the goo.gl console.</span><br><span class="line">Analytics data was available for up to one year, until March 30, 2019, when goo.gl was discontinued. </span><br><span class="line">Previously created links will continue to redirect to their intended destination. </span><br><span class="line">Please see this blog post for more details.</span><br></pre></td></tr></table></figure><p>æˆ‘ç»å¸¸ä½¿ç”¨ç™¾åº¦çš„çŸ­åœ°å€æœåŠ¡ï¼Œåœ¨å›½å†…è®¿é—®å®ƒæ˜¯æœ€å¿«çš„ä¹Ÿèƒ½æ»¡è¶³æˆ‘çš„å·¥ä½œå’Œå­¦ä¹ éœ€æ±‚ï¼Œå®ƒä¹Ÿæä¾› API æœåŠ¡å¯ä»¥å‚è€ƒ <a href="https://dwz.cn/console/apidoc">çŸ­ç½‘å€ç”Ÿæˆæ¥å£æ–‡æ¡£</a> å­¦ä¹ å’Œäº†è§£ã€‚</p><p>æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ HTTP åè®®ä¸­é‚£äº›é‡å®šå‘çš„äº‹ã€‚</p><h2 id="HTTP-è¯·æ±‚é‡å®šå‘"><a href="#HTTP-è¯·æ±‚é‡å®šå‘" class="headerlink" title="HTTP è¯·æ±‚é‡å®šå‘"></a>HTTP è¯·æ±‚é‡å®šå‘</h2><p>HTTP ä¸­çš„ <code>301</code>ã€<code>302</code>ã€<code>303</code>ã€<code>307</code>ã€<code>308</code> å“åº”çŠ¶æ€ç ï¼Œéƒ½è¡¨ç¤ºé‡å®šå‘çš„å“åº”ã€‚</p><p>å…¶ä¸­ï¼Œ<code>301</code>ã€<code>308</code> å“åº”çŠ¶æ€ç è¡¨ç¤ºæ°¸ä¹…é‡å®šå‘ï¼Œ<code>302</code>ã€<code>303</code>ã€<code>307</code> è¡¨ç¤ºä¸´æ—¶é‡å®šå‘ã€‚</p><p>é‚£æˆ‘ä»¬æ¥è¯´ä¸€ä¸‹ä»€ä¹ˆæ˜¯é‡å®šå‘ï¼Ÿ</p><p>é‡å®šå‘(Redirect)å°±æ˜¯é€šè¿‡å„ç§æ–¹æ³•å°†å„ç§ç½‘ç»œè¯·æ±‚é‡æ–°å®šä¸ªæ–¹å‘è½¬åˆ°å…¶å®ƒä½ç½®ï¼ˆå¦‚ï¼šç½‘é¡µé‡å®šå‘ã€åŸŸåçš„é‡å®šå‘ã€è·¯ç”±é€‰æ‹©çš„å˜åŒ–ä¹Ÿæ˜¯å¯¹æ•°æ®æŠ¥æ–‡ç»ç”±è·¯å¾„çš„ä¸€ç§é‡å®šå‘ï¼‰ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œä½ è¦å» A æœºæ„åŠç†ä¸€ä¸ªè¯ä»¶ï¼Œç­‰ä½ å»äº†ä¹‹åAæœºæ„çš„æŸäººå‘Šè¯‰ä½ ä»–ä»¬ä¸å†å—ç†æ­¤äº‹äº†ï¼Œéœ€è¦ä½ å» B æœºæ„åŠç†ï¼Œç„¶åä½ å°±è‡ªå·±å»äº† B æœºæ„ã€‚è¿™ä¸ªè¿‡ç¨‹å°±ç±»ä¼¼äºé‡å®šå‘ã€‚</p><p>é‚£ä¹ˆï¼ŒHTTP åè®®ä¸­å®šä¹‰çš„è¿™äº›30Xå“åº”çŠ¶æ€ç å°±å¥½æ¯” <code>Aæœºæ„çš„æŸäºº</code> å®ƒä»¬å‘Šè¯‰å®¢æˆ·ç«¯ï¼Œä½ éœ€è¦è®¿é—®å¦å¤–ä¸€ä¸ªåœ°å€äº†ã€‚</p><p>é‡å®šå‘åšäº†ä¸¤æ¬¡ HTTP è¯·æ±‚ï¼Œ ç¬¬ä¸€æ¬¡ï¼Œå®¢æˆ·ç«¯è¯·æ±‚ A æœåŠ¡å™¨ï¼ŒA å“åº”å‘Šè¯‰æµè§ˆå™¨ï¼Œä½ åº”è¯¥å» B æœåŠ¡å™¨è®¿é—®ã€‚æ­¤æ—¶å°±å»è®¿é—®æœåŠ¡å™¨ Bï¼Œè¿™ä¸ªæ—¶å€™ä½ å¯ä»¥çœ‹åˆ°æµè§ˆå™¨ä¸­çš„ç½‘å€å˜äº†ï¼Œè¿™å°±æ˜¯ç¬¬äºŒæ¬¡ HTTP è¯·æ±‚ã€‚</p><p><strong>é‡å®šå‘è¿‡ç¨‹ï¼š</strong></p><p>Step-1ã€æµè§ˆå™¨ï¼ˆå®¢æˆ·ç«¯ï¼‰å‘é€ HTTP è¯·æ±‚ï¼›</p><p>Step-2ã€WebæœåŠ¡å™¨Aæ¥æ”¶åå‘é€ <code>302</code> çŠ¶æ€ç å“åº”ï¼Œå¹¶åœ¨å“åº”å¤´ä¸­æŠŠå¯¹åº”çš„ <code>Location</code> ç»™æµè§ˆå™¨ï¼›</p><p>Step-3ã€æµè§ˆå™¨æ”¶åˆ°æœåŠ¡å™¨è¿”å›çš„ <code>302</code> å“åº”ç ï¼Œå°±è‡ªåŠ¨å†å‘é€ä¸€ä¸ªæ–°çš„ HTTP è¯·æ±‚ï¼ˆè¯·æ±‚URLæ˜¯æ–°çš„ <code>Location</code> ä¸­çš„åœ°å€ï¼‰ï¼›</p><p>Step-4ã€WebæœåŠ¡å™¨ï¼ˆå¯èƒ½æ˜¯ A ä¹Ÿå¯èƒ½æ˜¯å…¶ä»–æœåŠ¡å™¨ï¼‰æ ¹æ®æ­¤è¯·æ±‚å¯»æ‰¾èµ„æºå¹¶å‘é€ç»™æµè§ˆå™¨ï¼Œæœ€ç»ˆå±•ç¤ºç»™ç”¨æˆ·ã€‚</p><p>å…³äº <code>Location</code> å¯ä»¥çœ‹ä¸‹é¢çš„æˆªå›¾ï¼ˆè¿™æ˜¯ä¸€ä¸ªé‡å®šå‘çš„ HTTP è¯·æ±‚ç¤ºä¾‹ï¼‰ï¼Œå®ƒæ˜¯è¢«æ”¾åœ¨å“åº”å¤´ä¸­çš„ï¼Œå…¶å€¼æ˜¯éœ€è¦é‡å®šå‘çš„ç½‘å€ <code>http://www.veryitman.com</code>ï¼Œä»è¿™ä¸ªè¿‡ç¨‹æ¥çœ‹å¯ä»¥çœ‹å‡ºé‡å®šå‘æ˜¯å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰è¡Œä¸ºã€‚</p><p><img src="/upload/images/2019/11/24/1.png"></p><p>è¿˜æœ‰ä¸ªå«è½¬å‘çš„æŠ€æœ¯ï¼Œè¿™ä¸ªå’Œé‡å®šå‘æ˜¯ä¸ä¸€æ ·çš„ï¼Œè½¬å‘æ˜¯æœåŠ¡å™¨è¡Œä¸ºï¼Œè¿˜æ‹¿ä¸Šé¢çš„ A æœºæ„ä¾‹å­æ¥è¯´ï¼Œä½ è¦å» A æœºæ„åŠç†ä¸€ä¸ªè¯ä»¶ï¼Œç­‰ä½ å»äº†ä¹‹å A æœºæ„çš„æŸäººå‘Šè¯‰ä½ ä»–ä»¬ä¸å†å—ç†æ­¤äº‹äº†ï¼Œä½†æ˜¯ A æœºæ„å¯ä»¥è‡ªå·±åè°ƒèµ„æºå¸®ä½ å®Œæˆè€Œä¸éœ€è¦ä½ å»å…¶ä»–æœºæ„åŠç†äº†ã€‚è¿™ä¸ªè¿‡ç¨‹å°±ç±»ä¼¼äºè½¬å‘ã€‚</p><h2 id="æ¨¡æ‹Ÿé‡å®šå‘"><a href="#æ¨¡æ‹Ÿé‡å®šå‘" class="headerlink" title="æ¨¡æ‹Ÿé‡å®šå‘"></a>æ¨¡æ‹Ÿé‡å®šå‘</h2><p>ç°åœ¨ä½¿ç”¨ SpringBoot æ¨¡æ‹Ÿä¸€ä¸‹é‡å®šå‘ï¼Œæˆ‘ç”¨çš„ SpringBoot æ˜¯ <code>2.2.0.RELEASE</code> ç‰ˆæœ¬ã€‚</p><p><strong>â‘ ã€</strong>æ–°å»º SpringBoot Web å·¥ç¨‹ï¼Œå¯ä»¥å‚è€ƒ <a href="http://www.veryitman.com/2019/06/02/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E6%83%B3%E5%8A%9E%E6%B3%95%E8%AE%A9%E9%A1%B9%E7%9B%AE%E8%BF%90%E8%A1%8C%E8%B5%B7%E6%9D%A5/">å¾®æœåŠ¡-æƒ³åŠæ³•è®©é¡¹ç›®è¿è¡Œèµ·æ¥</a> è¿™ç¯‡æ–‡ç« ã€‚</p><p><strong>â‘¡ã€</strong>ä¿®æ”¹ pom æ–‡ä»¶ï¼Œå¢åŠ  <code>fastjson</code>ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.62<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>â‘¢ã€</strong>æ–°å»º <code>MSTestRedirectController</code> æ–‡ä»¶ï¼Œæºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;testredirect&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSTestRedirectController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/access/web&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">redirect</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:/testredirect/index/realweb?parameter=coming&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/index/realweb&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">real</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect happenedï¼š&quot;</span> + JSON.toJSONString(request.getParameterMap());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¦æ³¨æ„å‡ ä¸ªé—®é¢˜ï¼š</p><ul><li><p>æ—¢ç„¶æ˜¯é‡å®šå‘ï¼Œè¯¥ Controller ä¸èƒ½ä½¿ç”¨ <code>@RestController</code> æ³¨è§£è€Œè¦ä½¿ç”¨ <code>@Controller</code> æ³¨è§£ï¼›</p></li><li><p>è¿™é‡Œä½¿ç”¨äº†å…³é”®å­— <code>redirect</code> å®ç°é‡å®šå‘ï¼›</p></li></ul><p><strong>â‘£ã€</strong>å¯åŠ¨å·¥ç¨‹ï¼Œå¹¶åœ¨æµè§ˆå™¨è®¿é—®ä¸‹é¢çš„ç½‘å€</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/testredirect/access/web</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æµè§ˆå™¨å‘ç”Ÿäº†é‡å®šå‘ï¼Œæˆªå›¾å¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/11/24/2.png"></p><p>é™¤äº†ä¸Šé¢çš„æ–¹æ³•å¯ä»¥å®ç°é‡å®šå‘å¤–è¿˜å¯ä½¿ç”¨ <code>HttpServletResponse</code> çš„ <code>sendRedirect</code> æ–¹æ³•ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(value = &quot;/access/web2&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">redirect2</span><span class="params">(HttpServletResponse response)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// æ–¹æ³•1ï¼šè‡ªå®šä¹‰çŠ¶æ€ç æ–¹å¼</span></span><br><span class="line">        <span class="comment">// String url = &quot;http://localhost:8080/testredirect/index/realweb?parameter=coming&quot;;</span></span><br><span class="line">        <span class="comment">//response.setHeader(&quot;Location&quot;, url);</span></span><br><span class="line">        <span class="comment">//response.sendError(301);</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ–¹æ³•2ï¼šsendRedirectï¼Œé»˜è®¤è¿”å›çš„çŠ¶æ€ç æ˜¯ 302</span></span><br><span class="line">        response.sendRedirect(<span class="string">&quot;/testredirect/index/realweb?parameter=coming&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è¯·æ±‚çŸ­åœ°å€è¿‡ç¨‹"><a href="#è¯·æ±‚çŸ­åœ°å€è¿‡ç¨‹" class="headerlink" title="è¯·æ±‚çŸ­åœ°å€è¿‡ç¨‹"></a>è¯·æ±‚çŸ­åœ°å€è¿‡ç¨‹</h2><p>æˆ‘æ‹¿ç½‘å€ <code>http://www.veryitman.com/</code> æ¥ä¸¾å®ä¾‹ï¼Œä½¿ç”¨ç™¾åº¦çŸ­åœ°å€æœåŠ¡ã€‚</p><p>åœ¨ <a href="http://dwz.cn/">ç™¾åº¦çŸ­åœ°å€é¡µé¢</a> å»ç”Ÿæˆ <code>http://www.veryitman.com/</code> å¯¹åº”çš„çŸ­åœ°å€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2019/11/24/3.png"></p><p>å¾—åˆ°çŸ­åœ°å€æ˜¯ <code>https://dwz.cn/hnmau4Zs</code> å¤åˆ¶è¯¥åœ°å€æ‹·è´åˆ°æµè§ˆå™¨ï¼ˆæˆ‘ç”¨çš„æ˜¯ Chrome æµè§ˆå™¨ï¼‰çš„åœ°å€æ ä¸­ï¼Œå¹¶æ‰“å¼€ Chrome çš„å®¡æŸ¥è§†å›¾ã€‚åˆ‡æ¢åˆ° Network é€‰é¡¹ï¼Œæ­¤æ—¶å›è½¦æ‰“å¼€çŸ­ç½‘å€ã€‚</p><p><img src="/upload/images/2019/11/24/4.png"></p><p>HTTP å‘é€äº† GET è¯·æ±‚ï¼ˆ<strong>çº¢è‰²1</strong>ï¼‰ï¼Œè¯·æ±‚åœ°å€æ˜¯  <code>https://dwz.cn/hnmau4Zs</code> ï¼ŒæœåŠ¡å™¨ï¼ˆç™¾åº¦çš„çŸ­åœ°å€æœåŠ¡ï¼‰è¿”å›ç»™ Chrome æµè§ˆå™¨ <code>302</code> çŠ¶æ€ç ï¼Œæµè§ˆå™¨å‘ç°æ˜¯è¯¥é‡å®šå‘ç å°±å†æ¬¡ç”¨ <code>Location</code> é‡Œé¢åŒ…å«çš„åœ°å€å‘é€äº†ç¬¬äºŒæ¬¡è¯·æ±‚å³é‡å®šå‘è¯·æ±‚ã€‚</p><p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å¾®åšçš„çŸ­åœ°å€æœåŠ¡ï¼Œæé†’ä¸€ç‚¹ï¼Œå¾®åšçš„çŸ­åœ°å€è¯·æ±‚è¿”å›ç æ˜¯ <code>301</code> è€Œç™¾åº¦è¿”å›çš„æ˜¯ <code>302</code> å“åº”ç ã€‚<code>302</code> çŠ¶æ€ç å…è®¸å„ç§å„æ ·çš„é‡å®šå‘ï¼Œä¸€èˆ¬æƒ…å†µä¸‹éƒ½ä¼šå®ç°ä¸ºåˆ° GET çš„é‡å®šå‘ï¼Œä½†æ˜¯ä¸èƒ½ç¡®ä¿ POST ä¼šé‡å®šå‘ä¸º POSTï¼Œ<code>302</code> è¡¨ç¤ºæ—§åœ°å€Açš„èµ„æºè¿˜åœ¨ï¼ˆä»ç„¶å¯ä»¥è®¿é—®ï¼‰ï¼Œè¿™ä¸ªé‡å®šå‘åªæ˜¯ä¸´æ—¶åœ°ä»æ—§åœ°å€Aè·³è½¬åˆ°åœ°å€Bï¼›è€Œ <code>301</code> çŠ¶æ€ç è¡¨æ˜ç›®æ ‡èµ„æºè¢«æ°¸ä¹…çš„ç§»åŠ¨åˆ°äº†ä¸€ä¸ªæ–°çš„ URIï¼Œä»»ä½•æœªæ¥å¯¹è¿™ä¸ªèµ„æºçš„å¼•ç”¨éƒ½åº”è¯¥ä½¿ç”¨æ–°çš„ URIã€‚</p><h2 id="çŸ­åœ°å€åŸç†"><a href="#çŸ­åœ°å€åŸç†" class="headerlink" title="çŸ­åœ°å€åŸç†"></a>çŸ­åœ°å€åŸç†</h2><p>åˆšå¼€å§‹æˆ‘å¾ˆå¥½å¥‡ï¼Œä¸ºä»€ä¹ˆæˆ‘æŠŠé•¿åœ°å€ A è½¬æ¢ä¸ºçŸ­åœ°å€ Bï¼Œç„¶åç”¨ B å»è®¿é—®å±…ç„¶è¿˜æ˜¯ A åœ°å€çš„å†…å®¹ï¼Œæµè§ˆå™¨æ˜¯æ€ä¹ˆåšåˆ°çš„ï¼Ÿ</p><p>é€šè¿‡ä¸Šé¢çš„è¯·æ±‚è¿‡ç¨‹ç¤ºä¾‹ï¼Œç›¸ä¿¡å¤§å®¶åº”è¯¥å¤§æ¦‚ç†è§£äº†è¯·æ±‚çŸ­åœ°å€çš„åŸç†äº†ã€‚</p><p>åœ¨ç™¾åº¦çŸ­åœ°å€æœåŠ¡ä¸­ï¼Œæˆ‘ä»¬å°† <code>http://www.veryitman.com/</code> è½¬æ¢ä¸º <code>https://dwz.cn/hnmau4Zs</code>  ï¼Œæ­¤æ—¶ç™¾åº¦çŸ­åœ°å€æœåŠ¡ç»´æŒäº† <code>çŸ­-é•¿</code> åœ°å€çš„æ˜ å°„å…³ç³»äº†è€Œä¸”æ˜¯å”¯ä¸€çš„ï¼Œå½“æˆ‘ä»¬å»è®¿é—® <code>https://dwz.cn/hnmau4Zs</code> ï¼Œå…¶å®è¯·æ±‚çš„æ˜¯ç™¾åº¦çŸ­åœ°å€æœåŠ¡ï¼Œè¯¥æœåŠ¡å°†çŸ­åœ°å€å¯¹åº”çš„é•¿åœ°å€ï¼ˆæ”¾åœ¨å“åº”å¤´çš„ <code>Location</code> ä¸­ï¼‰è¿”å›ç»™æˆ‘ä»¬çš„æµè§ˆå™¨ï¼Œå¹¶è¿”å› 302 çŠ¶æ€ç ï¼Œæ­¤æ—¶æµè§ˆå™¨å°±é‡å®šå‘åˆ°äº† <code>http://www.veryitman.com/</code> è¿™ä¸ªç½‘å€ä¸Šäº†ã€‚</p><p><strong>ç®€å•æ€»ç»“ä¸€ä¸‹å…¶æ­¥éª¤å¦‚ä¸‹ï¼š</strong></p><p>Step-1ã€ç”¨æˆ·åœ¨æµè§ˆå™¨é‡Œè¾“å…¥ <code>https://dwz.cn/hnmau4Zs</code>  è¿™ä¸ªç½‘å€å»è®¿é—®;</p><p>Step-2ã€æµè§ˆå™¨è§£æ DNSï¼Œè·å–è¯¥åŸŸåå¯¹åº”çš„ IP åœ°å€;</p><p>Step-3ã€è·å–åˆ° IP åï¼Œæµè§ˆå™¨å‘é€ HTTP GET è¯·æ±‚æŸ¥è¯¢ <code>hnmau4Zs</code> å¹¶è·å–åˆ° <code>https://dwz.cn/hnmau4Zs</code>  å¯¹åº”çš„é•¿åœ°å€;</p><p>Step-4ã€HTTP é€šè¿‡ <code>302</code> çŠ¶æ€ç è½¬åˆ°å»è¯·æ±‚å¯¹åº”çš„é•¿åœ°å€  <code>http://www.veryitman.com/</code> ä¸Šé¢äº†ã€‚</p><p>æˆ‘æŠŠ <code>http://www.veryitman.com/</code> æ”¾åˆ°ç™¾åº¦å’Œå¾®åšçš„çŸ­åœ°å€ç”Ÿæˆåˆ†åˆ«æ˜¯ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// ç™¾åº¦çŸ­åœ°å€</span><br><span class="line">https://dwz.cn/hnmau4Zs</span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// å¾®åšæ®µåœ°å€</span><br><span class="line">http://1t.click/aMtD</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºç™¾åº¦ç”Ÿæˆè¾ƒå¤æ‚ï¼Œé¦–å…ˆåè®®å˜æˆäº† <code>HTTPS</code>ï¼Œå…¶æ¬¡ç”Ÿæˆä»£ç æ˜¯ 8 ä½ï¼ˆ<code>hnmau4Zs</code>ï¼‰ï¼Œè€Œå¾®åšç”Ÿæˆçš„æ˜¯ 4 ä½ï¼ˆ<code>aMtD</code>ï¼‰ä»£ç ã€‚</p><p>çŸ­åœ°å€ç ä¸€èˆ¬éƒ½æ˜¯ç”±26ä¸ªå¤§å†™å­—æ¯  <code>A-Z</code> ã€26ä¸ªå°å†™å­—æ¯ <code>a-z</code> å’Œ10ä¸ªæ•°å­—  <code>0-9</code> å…±62ä¸ªå­—ç¬¦éšæœºç»„åˆè€Œæˆï¼Œé‚£ä¹ˆå¯ä»¥è¿™æ ·æ¥ç”ŸæˆçŸ­åœ°å€ç ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ª62è¿›åˆ¶ï¼ŒæŠŠè¿™62ä¸ªå­—ç¬¦æŒ‰ç…§10è¿›åˆ¶æ•°è½¬æˆ62è¿›åˆ¶æ•°ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾—åˆ°æ¯ä¸ªå­—ç¬¦å¯¹åº”çš„62è¿›åˆ¶æ•°äº†ã€‚åŒç†ï¼Œå°†çŸ­åœ°å€è¿˜åŸçš„æ—¶å€™æŠŠ62è¿›åˆ¶è½¬æ¢ä¸ºå¯¹åº”çš„10è¿›åˆ¶å°±å¯ä»¥äº†ã€‚</p><p>æ ¹æ®ä¸Šé¢ç®—æ³•ï¼Œå¯ä»¥çœ‹å‡ºç™¾åº¦å¯ä»¥æ”¯æŒ 62^8 ä¸ªçŸ­åœ°å€ï¼Œå¾®åšå¯ä»¥æ”¯æŒ 62^4 ä¸ªçŸ­åœ°å€ã€‚</p><p>å…³äºçŸ­åœ°å€ç”Ÿæˆçš„ç®—æ³•ï¼Œå¤§å®¶å¯ä»¥ç”¨SpringBootè‡ªå·±æ’¸ä¸€ä¸ªæˆ–è€…å»ç½‘ä¸Šæ‰¾æ‰¾åˆ«äººå·²ç»å®ç°çš„ã€‚</p><hr><p><strong>æ´»ç€ä¸æ˜¯é æ³ªæ°´æå–åŒæƒ…ï¼Œè€Œæ˜¯é æ±—æ°´è·å¾—æŒå£°~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Short-URL SpringBoot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenSSL: å®ŒæˆVS2017çš„é…ç½®</title>
      <link href="/2019/11/23/OpenSSL-%E5%AE%8C%E6%88%90VS2017%E7%9A%84%E9%85%8D%E7%BD%AE/"/>
      <url>/2019/11/23/OpenSSL-%E5%AE%8C%E6%88%90VS2017%E7%9A%84%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åœ¨ <a href="http://www.veryitman.com/2019/11/23/OpenSSL-%E7%94%A8VS2017%E5%88%9B%E5%BB%BAC%E5%B7%A5%E7%A8%8B/">OpenSSL: ç”¨VS2017åˆ›å»ºCå·¥ç¨‹</a>  ä¸­è·Ÿå¤§å®¶åˆ†äº«äº†å¦‚ä½•åœ¨ Visual Studio 2017 ä¸­åˆ›å»º C å·¥ç¨‹å’Œæ³¨æ„äº‹é¡¹ä»¥åŠé‡åˆ°é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œä»Šå¤©æˆ‘ä»¬å¼€å§‹åœ¨ Visual Studio 2017 ä¸­æ­å»º OpenSSL çš„å¼€å‘ç¯å¢ƒã€‚</p><p>å¾ˆå¤šäººåœ¨é…ç½® OpenSSL ç¯å¢ƒä¸­é‡åˆ°äº†ä¸å°‘é—®é¢˜ï¼Œç”šè‡³è¿˜æœ‰æ”¾å¼ƒçš„ã€‚è¯´å®è¯ï¼Œæˆ‘ä¹Ÿå·®ç‚¹å¥”æºƒäº†:(ï¼Œé…ç½®è¿™äº›é¬¼ä¸œè¥¿ç¡®å®æœ‰ç‚¹å¤æ‚ï¼Œè¯´ä¸€å¥æ²ƒèŒ¨å¥¥ä¸€ç‚¹ä¹Ÿä¸è¿‡åˆ†ã€‚</p><p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å’Œä½ ä¸æœŸè€Œé‡ï¼Œèƒ½å¤Ÿå¸®åˆ°ä½ ï¼å†™æ–‡ä¸æ˜“ï¼Œå¦‚æœæ–‡ä¸­æœ‰ä»»ä½•é”™è¯¯ä¹‹å¤„è¿˜æœ›å¤§å®¶ä¸åèµæ•™ã€‚</p><h2 id="ä¸‹è½½OpenSSL"><a href="#ä¸‹è½½OpenSSL" class="headerlink" title="ä¸‹è½½OpenSSL"></a>ä¸‹è½½OpenSSL</h2><p>ä½¿ç”¨ OpenSSL æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€æ˜¯è‡ªå·±ä¸‹è½½å…¶æºç æŒ‰ç…§é…ç½®å»ç¼–è¯‘ï¼Œç„¶åä½¿ç”¨ç¼–è¯‘åçš„åº“ï¼›å¦ä¸€ç§æ˜¯ä½¿ç”¨åˆ«äººå·²ç»ç¼–è¯‘å¥½çš„åº“æ–‡ä»¶ã€‚</p><p>æˆ‘ä½¿ç”¨çš„æ˜¯ç¬¬äºŒç§æ–¹æ³•ï¼Œåœ¨ <a href="https://www.npcglib.org/~stathis/blog/precompiled-openssl/">precompiled-openssl</a> ä¸‹è½½çš„ OpenSSL Libraryï¼Œä¸‹è½½å®Œæˆåï¼Œè§£å‹ã€‚</p><p><img src="/upload/images/2019/11/23/14.png"></p><h2 id="è®¾ç½®VS2017"><a href="#è®¾ç½®VS2017" class="headerlink" title="è®¾ç½®VS2017"></a>è®¾ç½®VS2017</h2><blockquote><p>ä¸‹é¢åˆ†å‡ ä¸ªæ­¥éª¤å®Œæˆè®¾ç½®ã€‚</p></blockquote><h3 id="1ã€æ‹·è´æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­"><a href="#1ã€æ‹·è´æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­" class="headerlink" title="1ã€æ‹·è´æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­"></a>1ã€æ‹·è´æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­</h3><p>åœ¨å·¥ç¨‹ç›®å½•ä¸‹é¢æ–°å»º <code>vendor-openssl</code> ç›®å½•ï¼Œç”¨æ¥å­˜æ”¾ OpenSSL çš„å¤´æ–‡ä»¶å’Œåº“æ–‡ä»¶ï¼Œä¾¿äºç®¡ç†ï¼Œä½ ä¹Ÿå¯ä»¥å–ä¸ªå…¶ä»–çš„åç§°ã€‚</p><p>è¿›å…¥è§£å‹åçš„ <code>openssl-1.1.0f-vs2017</code> ç›®å½•ï¼Œå¤åˆ¶ <code>lib64</code> å’Œ <code>include64</code> åˆ° <code>vendor-openssl</code> ç›®å½•ä¸‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2019/11/23/15.png"></p><h3 id="2ã€æ·»åŠ OpenSSLå¤´æ–‡ä»¶"><a href="#2ã€æ·»åŠ OpenSSLå¤´æ–‡ä»¶" class="headerlink" title="2ã€æ·»åŠ OpenSSLå¤´æ–‡ä»¶"></a>2ã€æ·»åŠ OpenSSLå¤´æ–‡ä»¶</h3><p>æ‰“å¼€å·¥ç¨‹çš„å±æ€§è®¾ç½®ï¼Œæ‰“å¼€æ–¹æ³•å¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/11/23/16.png"></p><p><img src="/upload/images/2019/11/23/17.png"></p><p>æŒ‰ç…§ä¸Šè¿°æˆªå›¾çš„1ã€2ã€3ã€4ç‚¹å‡» Editï¼Œå‡ºç°ä¸‹é¢çš„ç¼–è¾‘æ¡†ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="/upload/images/2019/11/23/18.png"></p><p>é€‰æ‹© <code>include64</code>ç›®å½•ï¼Œå¦‚ä¸‹æˆªå›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2019/11/23/19.png"></p><p>ç‚¹å‡»OKå³å¯å®Œæˆå¤´æ–‡ä»¶çš„æ·»åŠ ã€‚</p><h3 id="3ã€æ·»åŠ OpenSSLåº“è·¯å¾„"><a href="#3ã€æ·»åŠ OpenSSLåº“è·¯å¾„" class="headerlink" title="3ã€æ·»åŠ OpenSSLåº“è·¯å¾„"></a>3ã€æ·»åŠ OpenSSLåº“è·¯å¾„</h3><p>åŒç†ï¼Œæ‰“å¼€å±æ€§è®¾ç½®ï¼Œç„¶åé€‰æ‹© <code>Linker/General</code>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2019/11/23/20.png"></p><p>ç‚¹å‡»Editï¼Œé€‰æ‹© OpenSSL çš„åº“è·¯å¾„ï¼Œå¦‚å›¾ï¼š</p><p><img src="/upload/images/2019/11/23/21.png"></p><h3 id="4ã€æ·»åŠ åº“åç§°"><a href="#4ã€æ·»åŠ åº“åç§°" class="headerlink" title="4ã€æ·»åŠ åº“åç§°"></a>4ã€æ·»åŠ åº“åç§°</h3><p>åŒç†ï¼Œæ‰“å¼€å±æ€§è®¾ç½®ï¼Œåœ¨ <code>Linker/Input</code> ä¸­è®¾ç½®ï¼Œå¦‚å›¾ï¼š</p><p><img src="/upload/images/2019/11/23/22.png"></p><p>ç‚¹å‡»Editï¼Œè¾“å…¥ä¸‹é¢åº“çš„åç§°ï¼ˆç¼–è¯‘åçš„OpenSSLåº“æ–‡ä»¶ï¼‰ï¼š</p><p><img src="/upload/images/2019/11/23/23.png"></p><p>ä¹¦å†™å®Œæ¯ä¸€ä¸ªéƒ½è¦æ¢è¡Œç»§ç»­å†™ä¸‹ä¸€ä¸ªåº“åç§°ï¼Œç›´åˆ°å†™å®Œä¸ºæ­¢ï¼Œå¦‚å›¾ï¼š</p><p><img src="/upload/images/2019/11/23/24.png"></p><p>ç‚¹å‡»å¼¹æ¡†çš„OKæŒ‰é’®ï¼Œå…³é—­æ‰€æœ‰å¼¹æ¡†ã€‚</p><h2 id="base64ç¼–è§£ç "><a href="#base64ç¼–è§£ç " class="headerlink" title="base64ç¼–è§£ç "></a>base64ç¼–è§£ç </h2><p>åœ¨èµ„æºç®¡ç†å™¨è§†å›¾ä¸­ï¼Œæ–°å»ºæºæ–‡ä»¶ï¼Œåˆ†åˆ«æ·»åŠ  <code>mzc_base64.h</code>ã€<code>mzc_base64.c</code> å’Œ <code>main.c</code> ä¸‰ä¸ªæ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="/upload/images/2019/11/23/25.png"></p><p>è¿™é‡Œæˆ‘åªç»™å‡ºæµ‹è¯•çš„ä»£ç (main.cæºç )ï¼Œå…·ä½“çš„ç¼–è§£ç ä»£ç ï¼Œå¤§å®¶å¯ä»¥å» <a href="https://github.com/veryitman/c-openssl/tree/base64-feature">GitHub</a> æŸ¥çœ‹ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mzc_base64.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//Encode To Base64</span></span><br><span class="line"><span class="type">char</span> *base64EncodeOutput;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Take the web&#x27;s url of my blog as example:http://veryitman.com</span></span><br><span class="line"><span class="type">char</span> *text = <span class="string">&quot;http:\/\/veryitman.com&quot;</span>;</span><br><span class="line"></span><br><span class="line">mzc_base64_encode(text, <span class="built_in">strlen</span>(text), &amp;base64EncodeOutput);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Base64 encode output: %s\n&quot;</span>, base64EncodeOutput);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Decode From Base64</span></span><br><span class="line"><span class="type">char</span>* base64DecodeOutput;</span><br><span class="line"><span class="type">size_t</span> test;</span><br><span class="line"><span class="type">const</span> <span class="type">char</span> *base64Encode_str = <span class="string">&quot;aHR0cDovL3ZlcnlpdG1hbi5jb20=&quot;</span>;</span><br><span class="line">mzc_base64_decode(base64Encode_str, &amp;base64DecodeOutput, &amp;test);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Base64 decode output: %s %d\n&quot;</span>, base64DecodeOutput, test);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ Visual Studio 2017 ä¸­ä½¿ç”¨å¿«æ·é”® <code>Ctrl+F5</code> è¿è¡Œå·¥ç¨‹æŠ¥é”™ï¼ŒæŠ¥é”™å¦‚å›¾ï¼š</p><p><img src="/upload/images/2019/11/23/26.png"></p><p>éœ€è¦æ‹·è´ <code>openssl-1.1.0f-vs2017</code> ç›®å½•ä¸­çš„bin64é‡Œé¢çš„å†…å®¹ï¼š</p><p><img src="/upload/images/2019/11/23/27.png"></p><p>æŠŠè¿™äº›æ–‡ä»¶æ”¾åˆ°å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•ä¸­ï¼Œå¦‚å›¾ï¼š</p><p><img src="/upload/images/2019/11/23/28.png"></p><p>å†æ¬¡ <code>Ctrl+F5</code> å°±å¯ä»¥æ­£å¸¸æ‰§è¡Œäº†ã€‚</p><p><strong>æ³¨æ„ï¼š</strong>ç‚¹å‡» <a href="https://github.com/veryitman/c-openssl/tree/base64-feature">æºç æ–‡ä»¶</a> å¯ä»¥è·å–æœ¬æ–‡çš„ä»£ç ã€‚</p><hr><p><strong>æ´»ç€ä¸æ˜¯é æ³ªæ°´æå–åŒæƒ…ï¼Œè€Œæ˜¯é æ±—æ°´è·å¾—æŒå£°~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OpenSSL VS2017 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenSSL: ç”¨VS2017åˆ›å»ºCå·¥ç¨‹</title>
      <link href="/2019/11/23/OpenSSL-%E7%94%A8VS2017%E5%88%9B%E5%BB%BAC%E5%B7%A5%E7%A8%8B/"/>
      <url>/2019/11/23/OpenSSL-%E7%94%A8VS2017%E5%88%9B%E5%BB%BAC%E5%B7%A5%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>è¯¥ç³»åˆ—æ–‡ç« ç»™å¤§å®¶ï¼ˆä¸»è¦æ˜¯åˆšæ¥è§¦Visual Studioå·¥å…·çš„Cå¼€å‘è€…ï¼‰å¸¦æ¥ä½¿ç”¨å¼€å‘å·¥å…·Visual Studio 2017è¿›è¡ŒOpenSSLç¼–ç¨‹ï¼ŒåŒ…æ‹¬base64ï¼ŒAESã€DESå’ŒRSAåŠ è§£å¯†ç­‰å†…å®¹ã€‚</p><p>å¯¹äºC&#x2F;C++çš„ç¼–ç¨‹ï¼Œæˆ‘å·¥ä½œä¹‹ååŸºæœ¬éƒ½æ˜¯åœ¨Linuxä¸Šé¢å†™ï¼Œå¾ˆå°‘åœ¨Windowsä¸Šé¢è€•è€˜ã€‚æœ€è¿‘æ”¶åˆ°å‡ ä¸ªå°ä¼™ä¼´çš„é‚®ä»¶ï¼Œæœ‰è¯·æ•™å¦‚ä½•åœ¨Windowsä¸Šé¢è¿›è¡ŒCç¼–ç¨‹çš„ï¼Œä¹Ÿæœ‰é—®å…³äºOpenSSLçš„åŸºç¡€çŸ¥è¯†çš„ã€‚è¯´å®è¯æˆ‘ä¹Ÿä¸æ˜¯å¾ˆç†Ÿæ‚‰Windowsä¸Šé¢çš„Cç¼–ç¨‹ï¼Œä½†å‡­å€Ÿç€ä¸€è‚¡è‡ªä¿¡è¿˜æ˜¯ç¡¬ç€å¤´çš®å®è·µäº†ä¸€æŠŠï¼Œç®—æ˜¯ç»™å¤§å®¶ä¸€ä¸ªäº¤å¾…ã€‚</p><p>åœ¨è¿™é‡Œéå¸¸æ„Ÿè°¢ç½‘åä¸ºâ€œä¸ºCå¥‹æ–—â€çš„å»ºè®®ï¼Œä¹Ÿæ„Ÿè°¢ç½‘ä¸Šå¼€æºä»£ç çš„ä½œè€…ä»¬ï¼Œå¦‚æœæ²¡æœ‰ä»–ä»¬çš„è´¡çŒ®ï¼Œæˆ‘å¯èƒ½æ ¹æœ¬åšæŒä¸ä¸‹æ¥æŠŠè¿™äº›çŸ¥è¯†åšä»¥æ€»ç»“å’Œåˆ†äº«ã€‚</p><p>å†™æ–‡ä¸æ˜“ï¼ŒæŒ‘ç¯å¤œæˆ˜ï¼Œå¦‚æœæ–‡ä¸­æœ‰ä»»ä½•é”™è¯¯ä¹‹å¤„è¿˜æœ›å¤§å®¶ä¸åèµæ•™ã€‚</p><p>è¯¥ç³»åˆ—æ–‡ç« ä¸­ç›¸å…³ä»£ç æˆ‘éƒ½æ‰˜ç®¡åœ¨Githubä¸Šé¢äº†ï¼Œç‚¹å‡» <a href="https://github.com/veryitman/c-openssl">c-openssl</a> å¯ä»¥è·å–ã€‚</p><h2 id="åˆ›å»ºCå·¥ç¨‹"><a href="#åˆ›å»ºCå·¥ç¨‹" class="headerlink" title="åˆ›å»ºCå·¥ç¨‹"></a>åˆ›å»ºCå·¥ç¨‹</h2><blockquote><p>è¿™éƒ¨åˆ†ä»‹ç»å¦‚ä½•åœ¨Visual Studio 2017ä¸­åˆ›å»ºCå·¥ç¨‹ã€‚</p></blockquote><p>æ‰“å¼€Visual Studio 2017ï¼Œé€‰æ‹©<code>File/New/Project...</code>ï¼Œç´§æ¥ç€å®Œæˆä¸‹é¢æˆªå›¾ä¸­çš„æ­¥éª¤å³å¯å®Œæˆå·¥ç¨‹åˆ›å»ºã€‚</p><p><img src="/upload/images/2019/11/23/1.png"></p><p><img src="/upload/images/2019/11/23/2.png"></p><p>ç‚¹å‡»OKç¨ç­‰å‡ ç§’å°±å¯ä»¥å®Œæˆå·¥ç¨‹çš„åˆ›å»ºï¼Œåˆ›å»ºæˆåŠŸä¹‹åï¼Œè¯¥å·¥ç¨‹æ˜¯ä¸€ä¸ªç©ºå·¥ç¨‹æ²¡æœ‰ä»»ä½•æºæ–‡ä»¶ï¼Œå¦‚å›¾ï¼š</p><p><img src="/upload/images/2019/11/23/3.png"></p><h2 id="åˆ›å»ºCæ–‡ä»¶"><a href="#åˆ›å»ºCæ–‡ä»¶" class="headerlink" title="åˆ›å»ºCæ–‡ä»¶"></a>åˆ›å»ºCæ–‡ä»¶</h2><blockquote><p>è¯¥éƒ¨åˆ†ä»‹ç»å¦‚ä½•åœ¨å·¥ç¨‹ä¸­æ‰‹åŠ¨åˆ›å»ºCæ–‡ä»¶ã€‚</p></blockquote><p>éœ€è¦æ‰‹åŠ¨åˆ›å»ºCæºç æ–‡ä»¶ï¼Œå³é”®ç‚¹å‡» <code>Source Files</code></p><p><img src="/upload/images/2019/11/23/4.png"></p><p><img src="/upload/images/2019/11/23/5.png"></p><p><strong>æ³¨æ„ï¼šæºç åç¼€æ˜¯<code>.c</code>ï¼Œä¸æ˜¯<code>.cpp</code>.</strong></p><p>åˆ›å»ºå®Œæˆåï¼Œæ‰“å¼€ <code>mzc_base64.c</code> å†™ä¸Šä¸€æ®µç®€å•çš„ä»£ç ï¼Œæµ‹è¯•ä¸€ä¸‹æ˜¯å¦æ­£å¸¸ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Hello OpenSSL, I&#x27;m coming.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥ä½¿ç”¨å¿«æ·é”® <code>Ctrl+F5</code> è¿è¡Œç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°å¼¹å‡ºäº†ç³»ç»Ÿçš„å‘½ä»¤è¡Œå¹¶æ˜¾ç¤ºè¿è¡Œç»“æœï¼Œæˆªå›¾å¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/11/23/6.png"></p><p>è‡³æ­¤åœ¨Visual Studio 2017ä¸­æˆåŠŸåˆ›å»ºäº†Cå·¥ç¨‹ &#x3D;:ï¼‰</p><h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>æœ‰ä¸å°‘å°ä¼™ä¼´è·Ÿæˆ‘è¯´ï¼Œä»–ä»¬åœ¨åˆ›å»ºçš„è¿‡ç¨‹ä¸­é‡åˆ°äº†è¿™æ ·æˆ–è€…é‚£æ ·çš„é—®é¢˜ï¼Œæˆ‘æ€»ç»“äº†ä¸€ä¸‹åˆ†äº«ç»™æœ‰éœ€è¦çš„äººã€‚</p><h3 id="1ã€æ²¡æœ‰æ‰¾åˆ°Windows-Desktopé€‰é¡¹"><a href="#1ã€æ²¡æœ‰æ‰¾åˆ°Windows-Desktopé€‰é¡¹" class="headerlink" title="1ã€æ²¡æœ‰æ‰¾åˆ°Windows Desktopé€‰é¡¹"></a>1ã€æ²¡æœ‰æ‰¾åˆ°<code>Windows Desktop</code>é€‰é¡¹</h3><p>è¿™ç§æƒ…å†µåº”è¯¥æ˜¯æ²¡æœ‰åœ¨ Visual Studio 2017 ä¸­å®‰è£…æ¡Œé¢å¼€å‘ç»„ä»¶ï¼Œå¦‚å›¾æ“ä½œï¼š</p><p><img src="/upload/images/2019/11/23/7.png"></p><p>æ‰“å¼€ <code>Visual Studio Inistaller</code> å®‰è£…é€šç”¨Windowså¹³å°å¼€å‘ç»„ä»¶ï¼Œå¦‚å›¾ï¼š</p><p><img src="/upload/images/2019/11/23/8.png"></p><p>å®‰è£…å®Œæˆåï¼Œå†é‡æ–°åˆ›å»ºå·¥ç¨‹å°±æœ‰äº†è¯¥é€‰é¡¹ã€‚</p><h3 id="2ã€ç¼–è¯‘é”™è¯¯ï¼Œæ‰¾ä¸åˆ°printfå‡½æ•°"><a href="#2ã€ç¼–è¯‘é”™è¯¯ï¼Œæ‰¾ä¸åˆ°printfå‡½æ•°" class="headerlink" title="2ã€ç¼–è¯‘é”™è¯¯ï¼Œæ‰¾ä¸åˆ°printfå‡½æ•°"></a>2ã€ç¼–è¯‘é”™è¯¯ï¼Œæ‰¾ä¸åˆ°<code>printf</code>å‡½æ•°</h3><p>å‡ºç°è¿™ç§é”™è¯¯ï¼Œå¤§éƒ¨åˆ†åŸå› æ˜¯æ²¡æœ‰å®‰è£… <code>Windows10 SDK</code>ã€‚æ‰“å¼€ <code>C:\Program Files (x86)\</code>  ç›®å½•ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰ <code>Windows Kits</code> ç›®å½•ã€‚</p><p>å¦‚æœæ²¡æœ‰ï¼Œå°±ç‚¹å‡» <a href="https://developer.microsoft.com/en-US/windows/downloads/windows-10-sdk">Windows10 SDK</a> ä¸‹è½½ï¼Œå®‰è£…å®Œæˆåï¼Œé‡æ–°åˆ›å»ºå·¥ç¨‹å°±å¯ä»¥äº†ã€‚</p><p>å¦‚æœæœ‰è¯¥ç›®å½•ï¼Œåœ¨å·¥ç¨‹å±æ€§ä¸­è®¾ç½®ä¸€ä¸‹ï¼Œå¦‚å›¾ï¼š</p><p><img src="/upload/images/2019/11/23/9.png"></p><p>æ‰“å¼€å±æ€§è§†å›¾ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/11/23/10.png"></p><p>é…ç½®ä½ æ­£ç¡®çš„ <code>Windows10 SDK</code> ç›®å½•å³å¯ï¼Œæˆ‘å®‰è£…çš„æ˜¯ä¸‹é¢çš„ç‰ˆæœ¬ï¼š</p><p><img src="/upload/images/2019/11/23/11.png"></p><h3 id="3ã€æ— æ³•è®¿é—®å¤´æ–‡ä»¶"><a href="#3ã€æ— æ³•è®¿é—®å¤´æ–‡ä»¶" class="headerlink" title="3ã€æ— æ³•è®¿é—®å¤´æ–‡ä»¶"></a>3ã€æ— æ³•è®¿é—®å¤´æ–‡ä»¶</h3><p>ç‚¹å‡»ç³»ç»Ÿåº“çš„å¤´æ–‡ä»¶ï¼Œæ˜¾ç¤ºå¦‚ä¸‹æç¤ºï¼š</p><p><img src="/upload/images/2019/11/23/12.png"></p><p>åœ¨å¤´æ–‡ä»¶ä¸Šé¢å³é”®ï¼Œå¯ä»¥çœ‹åˆ°è·³è½¬çš„å‡ ä¸ªé€‰é¡¹éƒ½æ˜¯ä¸å¯ç”¨çš„çŠ¶æ€ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="/upload/images/2019/11/23/13.png"></p><p>å‡ºç°è¿™æ ·çš„æƒ…å†µä¸è¦æ€•ï¼Œè¿™æ˜¯VSçš„ç—…ï¼Œåªèƒ½ç­‰Microsoftå»æ ¹æ²»äº†ã€‚æˆ‘ä»¬ä½¿ç”¨ <code>Open Document</code> ä»£æ›¿ï¼Œå¿«æ·é”®æ˜¯<code>Ctrl+Shift+G</code>ï¼Œä¸€æ ·å¯ä»¥æ‰“å¼€å¯¹åº”çš„å¤´æ–‡ä»¶ã€‚</p><hr><p><strong>ç”Ÿå‘½ä¸æ˜¯è¦è¶…è¶Šåˆ«äººï¼Œè€Œæ˜¯è¦è¶…è¶Šè‡ªå·±~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OpenSSL VS2017 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL8.0.15åœ¨Win10ä¸Šçš„æŠ˜è…¾è®°</title>
      <link href="/2019/11/10/MySQL8-0-15%E5%9C%A8Win10%E4%B8%8A%E7%9A%84%E6%8A%98%E8%85%BE%E8%AE%B0/"/>
      <url>/2019/11/10/MySQL8-0-15%E5%9C%A8Win10%E4%B8%8A%E7%9A%84%E6%8A%98%E8%85%BE%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="å®‰è£…å’Œé…ç½®-MySQL"><a href="#å®‰è£…å’Œé…ç½®-MySQL" class="headerlink" title="å®‰è£…å’Œé…ç½® MySQL"></a>å®‰è£…å’Œé…ç½® MySQL</h2><p>æˆ‘åœ¨ <code>Windows 10</code> ä¸Šé¢ä½¿ç”¨ <code>MySQL Instller</code> å®‰è£…çš„ MySQL-8.0.15ï¼Œå®‰è£…å®Œæˆåï¼Œå¯åŠ¨å’Œä½¿ç”¨ MySQL é‡åˆ°äº†ä¸å°‘é—®é¢˜ï¼Œç‰¹æ­¤è®°å½•è¸©å‘è®°ã€‚</p><p>åªè¦ä½ çš„ç½‘ç»œç¨³å®šï¼ŒæŒ‰ç…§é»˜è®¤å®‰è£…ï¼Œæ•´ä¸ªå®‰è£…è¿‡ç¨‹è¿˜ç®—é¡ºåˆ©ã€‚</p><p>å®‰è£…è¿‡ç¨‹ä¸­éœ€è¦è®¾ç½®å¯†ç ï¼Œæˆ‘è®¾ç½®çš„è´¦å·å’Œå¯†ç éƒ½æ˜¯ <code>root</code>ï¼Œæ‰€ä»¥ä¸‹é¢çš„æ“ä½œéƒ½æ˜¯åŸºäºè¿™ä¸ªè´¦å·å’Œå¯†ç è¿›è¡Œçš„ã€‚</p><p>å®‰è£…å®Œæˆåï¼Œå°† <code>mysql server</code> çš„ <code>bin ç›®å½•</code>åŠ å…¥åˆ°ç³»ç»Ÿçš„ <code>path</code> å˜é‡ä¸­å»ï¼Œå¦‚å›¾ï¼š</p><p><img src="/upload/images/2019/11/10/1.png" alt="1568529858131"></p><p>ç³»ç»Ÿç¯å¢ƒå˜é‡ <code>path</code> ä¸­åŠ å…¥ <code>%MySQL_Home%\bin</code> å³å¯ã€‚</p><p>åŠ å…¥æˆåŠŸä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>mysql</code> å‘½ä»¤äº†ã€‚</p><p><strong>é¢˜å¤–è¯</strong>ï¼Œæˆ‘ä»¬åœ¨å‘½ä»¤è¡Œä½¿ç”¨çš„ <code>mysql</code> å‘½ä»¤å…¶å®æ˜¯å¯¹åº” <code>MySQL Server 8.0\bin\mysql.exe</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>where</code> å‘½ä»¤çœ‹ä¸€ä¸‹å…¶å¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$ </span><span class="language-bash"><span class="built_in">where</span> mysql</span></span><br><span class="line">C:\Program Files\MySQL\MySQL Server 8.0\bin\mysql.exe</span><br></pre></td></tr></table></figure><p>åŒç†ï¼Œ <code>mysqld</code> å‘½ä»¤å¯¹åº”çš„æ˜¯ <code>mysqld.exe</code>å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p><p>æŸ¥çœ‹å®‰è£…çš„ <code>mysql-server</code> ç‰ˆæœ¬ï¼Œå¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql --version</span><br></pre></td></tr></table></figure><p>å¯ä»¥å¾—åˆ°ä¸‹é¢çš„è¾“å‡ºï¼Œå¯ä»¥çœ‹å‡ºå½“å‰ç‰ˆæœ¬æ˜¯ <code>8.0.15</code>:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files\MySQL\MySQL Server 8.0\bin\mysql.exe  Ver 8.0.15 for Win64 on x86_64 (MySQL Community Server - GPL)</span><br></pre></td></tr></table></figure><p>æˆ‘ç”¨çš„å‘½ä»¤è¡Œç»ˆç«¯å·¥å…·æ˜¯ <code>Git bash</code>ï¼ˆå®‰è£…Gitå®¢æˆ·ç«¯å°±è‡ªå¸¦è¯¥å·¥å…·ï¼Œä¸ªäººè§‰å¾—æŒºå¥½ç”¨çš„ï¼Œ[å˜¿å“ˆ]ï¼‰ã€‚</p><p>ç”¨ç®¡ç†å‘˜èº«ä»½è¿è¡Œ <code>Git bash</code>ï¼Œç„¶ååœ¨è¯¥ç»ˆç«¯å·¥å…·ä¸­æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqld --install</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸ç”¨ç®¡ç†å‘˜èº«ä»½è¿è¡Œç»ˆç«¯çš„è¯ï¼Œä¼šæŠ¥ç±»ä¼¼ä¸‹é¢çš„é”™è¯¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Install/Remove of the Service Denied!</span><br></pre></td></tr></table></figure><p>è¿è¡ŒæˆåŠŸçš„è¯ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹æç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Service successfully installed.</span><br></pre></td></tr></table></figure><p>å†æ¬¡å¯åŠ¨ MySQL80ï¼Œ<strong>ä¸€å®šè¦ç”¨ç®¡ç†å‘˜èº«ä»½å¯åŠ¨ç»ˆç«¯ï¼Œå¦åˆ™ä¼šæŠ¥ <code>å‘ç”Ÿç³»ç»Ÿé”™è¯¯</code> è¿™æ ·çš„é”™è¯¯</strong>ï¼ˆå¦‚æœä½ æ˜¯ä½¿ç”¨ç®¡ç†å‘˜èº«ä»½å¯åŠ¨ç»ˆç«¯çš„è¿˜æ˜¯æŠ¥è¿™ä¸ªé”™è¯¯ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯è¯¥æœåŠ¡å·²ç»å¯åŠ¨äº†ï¼‰ï¼Œæ‰§è¡Œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net start MySQL80</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šè¿™é‡Œä½¿ç”¨çš„æ˜¯ <code>MySQL80</code>ï¼Œè¿™ä¸ªæ˜¯æœåŠ¡çš„åç§° ï¼ˆå®‰è£…æ—¶å€™æˆ‘è®¾ç½®çš„æœåŠ¡åç§°ï¼‰ ï¼Œä¸æ˜¯ <code>mysql</code>ï¼Œä¸‹é¢ä¼šè®²è§£ä¸ºä»€ä¹ˆè¿™æ ·åšï¼Œå¦‚æœä½ æ²¡æœ‰è¿™ä¸ª <code>MySQL80</code> æœåŠ¡åªéœ€è¦å¯åŠ¨åç§°ä¸º <code>mysql</code> çš„æœåŠ¡å³å¯ã€‚</p><p>å¦‚æœå‡ºç°ç±»ä¼¼ â€œMYSQL æœåŠ¡æ— æ³•å¯åŠ¨â€ çš„æç¤ºï¼Œå¯ä»¥åœ¨ Windows çš„ä»»åŠ¡ç®¡ç†å™¨ä¸­æ‰¾æ‰¾æ˜¯å¦å·²ç»å¯åŠ¨äº† <code>mysqld</code> æœåŠ¡ï¼Œå¯ä»¥æ‰‹åŠ¨å…³é—­åå†æ¥å¯åŠ¨ã€‚</p><p>å¦‚æœå§‹ç»ˆå¯åŠ¨å¤±è´¥ï¼Œå¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqld --initialize</span><br></pre></td></tr></table></figure><p>å¯åŠ¨æˆåŠŸåï¼Œæ˜¾ç¤ºå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MySQL80 æœåŠ¡æ­£åœ¨å¯åŠ¨ .</span><br><span class="line">MySQL80 æœåŠ¡å·²ç»å¯åŠ¨æˆåŠŸã€‚</span><br></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤æŸ¥çœ‹æ˜¯å¦æˆåŠŸå¯åŠ¨ <code>MySQL80</code> æœåŠ¡ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -aon|findstr &quot;3306&quot;</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°å¦‚ä¸‹æç¤ºè¡¨ç¤ºå¯åŠ¨æˆåŠŸï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TCP    0.0.0.0:3306           0.0.0.0:0              LISTENING       10344</span><br><span class="line">TCP    0.0.0.0:33060          0.0.0.0:0              LISTENING       10344</span><br><span class="line">TCP    [::]:3306              [::]:0                 LISTENING       10344</span><br><span class="line">TCP    [::]:33060             [::]:0                 LISTENING       10344</span><br><span class="line">TCP    [::1]:3306             [::1]:56962            TIME_WAIT       0</span><br></pre></td></tr></table></figure><p>ç™»å½• <code>MySQL80</code> æœåŠ¡ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$ </span><span class="language-bash">mysql -uroot -proot</span></span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">ERROR 1045 (28000): Access denied for user &#x27;root&#x27;@&#x27;localhost&#x27; (using password: YES)</span><br></pre></td></tr></table></figure><p>å¾ˆä¸å¹¸çš„æ˜¯ï¼Œç™»å½•å¤±è´¥ï¼ˆERROR 1045ï¼‰ã€‚</p><p>é‚£æˆ‘ä»¬å°±æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¿™ä¸ªç‰ˆæœ¬çš„ MySQL å’Œä¹‹å‰çš„ 8.0.x ç‰ˆæœ¬è§£å†³æ–¹æ¡ˆä¸åŒï¼Œç½‘ä¸Šæ‰¾è¿‡å¾ˆå¤šè§£å†³æ–¹æ¡ˆæœ‰ä¿®æ”¹é…ç½®æ–‡ä»¶çš„ï¼Œå¿™äº†åŠå¤©è¿˜æ˜¯æ²¡æœ‰æå®šï¼Œæœ€ååœ¨ StackOverflow ä¸Šé¢æ‰¾åˆ°æ–¹æ¡ˆï¼Œç»“åˆä¸ªäººå®è·µæ€»ç»“äº†ä¸€ä¸‹ï¼Œè¿˜çƒ¦è¯·å¤§å®¶åŠ¡å¿…å¾€ä¸‹çœ‹ã€‚</p><h2 id="è§£å†³ç™»å½•-MySQL-å—é™"><a href="#è§£å†³ç™»å½•-MySQL-å—é™" class="headerlink" title="è§£å†³ç™»å½• MySQL å—é™"></a>è§£å†³ç™»å½• MySQL å—é™</h2><p>åœ¨çœ‹ä¸‹é¢å†…å®¹ä¹‹å‰ï¼ŒåŠ¡å¿…å®Œæˆæ–‡ä¸­å‰é¢è¯´çš„æ­¥éª¤ï¼Œå¦åˆ™ä¸‹é¢çš„å†…å®¹å¯¹ä½ æ¥è¯´æ²¡æœ‰å¤ªå¤§ä»·å€¼ã€‚</p><p>æ–°ç‰ˆæœ¬çš„ MySQL åŠ å¼ºäº†å®‰å…¨æ–¹ä¾¿çš„å› ç´ ï¼Œæ‰€ä»¥ä½¿ç”¨æ–°ç‰ˆæœ¬æ¯”è¾ƒè´¹åŠ²ï¼Œå¦‚æœä½ ä¸æƒ³æŠ˜è…¾ï¼Œå¯ä»¥å®‰è£… MySQL çš„ 5.x ç‰ˆæœ¬ã€‚</p><p><strong>Step-1</strong>ï¼šåœæ­¢ MySQL80 æœåŠ¡</p><p>ä½¿ç”¨å¿«æ·é”® <code>win+R</code> è¾“å…¥ <code>services.msc</code>ï¼Œæ‰“å¼€å¦‚ä¸‹è§†å›¾å¹¶æ‰¾åˆ° MySQL80 æœåŠ¡ï¼š</p><p><img src="/upload/images/2019/11/10/2.png" alt="1568529858131"></p><p>åœæ­¢ MySQL80 æœåŠ¡ï¼Œæˆ–è€…åœ¨å‘½ä»¤è¡Œæ‰§è¡Œ <code>net stop MySQL80</code> å‘½ä»¤ã€‚</p><p><strong>Step-2</strong>ï¼šå¦ä¸€ç§æ–¹å¼å¯åŠ¨ MySQL80 æœåŠ¡</p><p>ä½¿ç”¨ç®¡ç†å‘˜èº«ä»½è¿è¡Œç»ˆç«¯1ï¼Œå¹¶æ‰§è¡Œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqld --console --skip-grant-tables --shared-memory</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å¯ä»¥æˆåŠŸå¯åŠ¨ <code>MySQL80</code> æœåŠ¡ï¼Œä½†æ˜¯åœ¨ Windows çš„æœåŠ¡ä¸­æ˜¯çœ‹ä¸åˆ°çš„ï¼Œä¸ç”¨ç†ä¼šã€‚ç»§ç»­ã€‚</p><p><strong>Step-3</strong>ï¼šå¯åŠ¨å¦ä¸€ä¸ªç»ˆç«¯2</p><p>ä¸Šè¿°æ­¥éª¤å¯åŠ¨å®Œæˆåï¼Œå†ç”¨ç®¡ç†å‘˜èº«ä»½è¿è¡Œå¦ä¸€ä¸ª Windows çš„ç»ˆç«¯2(CMD)ï¼Œç”¨ç³»ç»Ÿè‡ªå¸¦çš„æˆ–è€… Git Bash éƒ½å¯ä»¥ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨ Git Bash çš„è¯ï¼Œå¿…é¡»åœ¨ç™»å½•mysql çš„æ—¶å€™ä½¿ç”¨ <strong>winpty</strong>ï¼ˆGit Bashè‡ªå¸¦çš„å·¥å…·ï¼‰å‘½ä»¤ï¼Œå¦åˆ™ç™»å½•ä¼šå¡ä½ä¸åŠ¨ã€‚å‘½ä»¤ä½¿ç”¨å¦‚ä¸‹ï¼š</p> <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">winpty mysql <span class="operator">-</span>uroot <span class="operator">-</span>proot</span><br></pre></td></tr></table></figure><p><strong>Step-4</strong>ï¼šç»ˆç«¯ç™»å½• mysql</p><p>æ‰§è¡Œä¸‹é¢å‘½ä»¤ç™»å½•æœåŠ¡ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p root</span><br></pre></td></tr></table></figure><p>å¦‚ä¸‹å›¾å¯ä»¥ç™»å½•æˆåŠŸï¼Œå¦‚ä¸‹æˆªå›¾ï¼š</p><p><img src="/upload/images/2019/11/10/3.png" alt="1568529858131"></p><p><strong>Step-5</strong>ï¼šç½®ç©ºå¯†ç </p><p>åœ¨ä¸Šè¿°å‘½ä»¤è¡ŒçŠ¶æ€ä¸‹ï¼Œæ‰§è¡Œï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use mysql</span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> <span class="keyword">user</span> <span class="keyword">set</span> authentication_string<span class="operator">=</span><span class="string">&#x27;&#x27;</span> <span class="keyword">where</span> <span class="keyword">user</span><span class="operator">=</span><span class="string">&#x27;root&#x27;</span>;</span><br></pre></td></tr></table></figure><p><strong>Step-6</strong>ï¼šé€€å‡º mysql æœåŠ¡</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">quit</span><br></pre></td></tr></table></figure><p><strong>Step-7</strong>ï¼šå…³é—­ mysqld å¯åŠ¨çš„ MySQL80 æœåŠ¡</p><p>éœ€è¦å…³é—­ä»¥ <code>-console --skip-grant-tables --shared-memory</code> å¯åŠ¨çš„ MySQL80 æœåŠ¡ï¼Œç›´æ¥åœ¨ç»ˆç«¯1ä¸­ <code>ctrl+c</code> å³å¯ã€‚</p><p><strong>Step-8</strong>ï¼šå¯åŠ¨ MySQL80 æœåŠ¡</p><p>ä½¿ç”¨<strong>Step-1</strong>æ­¥éª¤ä¸­çš„æ–¹å¼æ‰“å¼€ Windows çš„æœåŠ¡å¯åŠ¨æˆ–è€…åœ¨ç»ˆç«¯1ä¸­æ‰§è¡Œ  <code> net start MySQL80</code> å¯åŠ¨ MySQL80 æœåŠ¡ã€‚</p><p><strong>Step-9</strong>ï¼š æ— å¯†ç ç™»å½• mysql</p><p>åœ¨æ­¥éª¤ <strong>Step-5</strong> ä¸­å·²å°†å¯†ç ç½®ç©ºï¼Œç°åœ¨å¯ä»¥æ— å¯†ç çŠ¶æ€ç™»å½• mysql æœåŠ¡ï¼Œè¾“å…¥ç™»å½•å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p </span><br></pre></td></tr></table></figure><p>ç™»å½•æˆåŠŸåï¼Œä¿®æ”¹å¯†ç ï¼ˆæ°¸è¿œä¸è¿‡æœŸçš„å¯†ç ï¼‰æ‰§è¡Œï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;newpwd123&#x27;</span> PASSWORD EXPIRE NEVER;</span><br></pre></td></tr></table></figure><p>æˆ‘æŠŠåŸæ¥çš„å¯†ç ä¿®æ”¹ä¸º <code>newpwd123</code>ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„çˆ±å¥½è®¾ç½®ä¸ºå…¶ä»–çš„å¯†ç ã€‚</p><p>å¦‚æœåœ¨æ­¤æ­¥éª¤å‡ºç°ç±»ä¼¼ä¸‹é¢çš„é”™è¯¯:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR 1290 (HY000): The MySQL server is running with the --skip-grant-tables option so it cannot execute this statement</span><br></pre></td></tr></table></figure><p>è¯·æ‰§è¡Œä¸‹é¢çš„SQLè¯­å¥ï¼Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><p><strong>Step-10</strong>ï¼šé€€å‡º mysqlï¼Œé‡æ–°ç™»å½•</p><p>é€€å‡º mysqlï¼Œç„¶åé‡æ–°ä½¿ç”¨ä¿®æ”¹è¿‡çš„å¯†ç ç™»å½• mysqlï¼Œå®Œäº‹ã€‚</p><h2 id="MySQLé…ç½®æ–‡ä»¶ï¼Ÿ"><a href="#MySQLé…ç½®æ–‡ä»¶ï¼Ÿ" class="headerlink" title="MySQLé…ç½®æ–‡ä»¶ï¼Ÿ"></a>MySQLé…ç½®æ–‡ä»¶ï¼Ÿ</h2><p>è¿™ä¹Ÿæ˜¯ä¸ªç¥å¥‡çš„é—®é¢˜ï¼Œæœ€ååœ¨ MySQL çš„å®˜æ–¹æ‰‹å†Œé‡Œæ‰¾åˆ°äº† Answerã€‚</p><p>åœ¨ Windows ç³»ç»Ÿä¸­ C ç›˜æœ‰ä¸ªéšè—çš„æ–‡ä»¶å¤¹ï¼Œæˆ‘ä»¬æ¥æ­å¼€å®ƒçš„ç¥ç§˜é¢çº±ã€‚</p><p>æ‰“å¼€ C ç›˜æ–‡ä»¶ï¼ŒæŒ‰ç…§ä¸‹é¢1ã€2ã€3é¡ºåºå°±å¯ä»¥çœ‹åˆ° <code>ProgramData </code>æ–‡ä»¶å¤¹ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/11/10/4.png" alt="1568529858131"></p><p>è¿›å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œå°±å¯ä»¥çœ‹åˆ° MySQL çš„é…ç½®æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/11/10/5.png" alt="1568529858131"></p><p>ä¸Šé¢æˆ‘ä»¬å·²ç»è¯´è¿‡ï¼Œå¯åŠ¨ MySQL80 æœåŠ¡å°±é»˜è®¤ä½¿ç”¨çš„æ˜¯è¯¥é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åœ¨ Windows æœåŠ¡ä¸­ç‚¹å‡» MySQL80 æŸ¥çœ‹å…¶å±æ€§ï¼Œå¯ä»¥çœ‹åˆ°ä¸‹é¢çš„æè¿°ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ï¼š</span><br><span class="line">C:\Program Files\MySQL\MySQL Server 8.0\bin\mysqld.exe&quot; --defaults-file=&quot;C:\ProgramData\MySQL\MySQL Server 8.0\my.ini&quot; MySQL80</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ<code>--defaults-file=&quot;C:\ProgramData\MySQL\MySQL Server 8.0\my.ini&quot;</code> å°±æ˜¯æŒ‡å®šé…ç½®æ–‡ä»¶è·¯å¾„çš„ã€‚</p><p>è€Œåœ¨ Windows æœåŠ¡ä¸­ç‚¹å‡» MySQLï¼Œçœ‹åˆ°çš„å±æ€§æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ï¼š</span><br><span class="line">&quot;C:\Program Files\MySQL\MySQL Server 8.0\bin\mysqld.exe&quot; MySQL</span><br></pre></td></tr></table></figure><p>å¹¶æ²¡æœ‰æŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè®©å¤§å®¶å¯åŠ¨çš„æ—¶å€™æ‰§è¡Œ <code>net start MySQL80</code> çš„åŸå› ã€‚</p><p>é¡ºä¾¿ä¿®æ”¹ä¸€ä¸‹é…ç½®æ–‡ä»¶ï¼ŒæŠŠé»˜è®¤ç¼–ç æ”¹ä¸º <code>utf-8</code>ï¼Œå¦‚ä¸‹é…ç½®ï¼ˆè®°å¾—æ˜¯åœ¨[client]å’Œ[mysql]æ ‡ç­¾ä¸‹ï¼‰ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line"><span class="meta"># </span><span class="language-bash">pipe=</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">socket=MYSQL</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">è®¾ç½®mysqlå®¢æˆ·ç«¯è¿æ¥æœåŠ¡ç«¯æ—¶é»˜è®¤ä½¿ç”¨çš„ç«¯å£</span></span><br><span class="line">port=3306</span><br><span class="line">default-character-set=utf8</span><br><span class="line"></span><br><span class="line">[mysql]</span><br><span class="line">no-beep</span><br><span class="line"><span class="meta"># </span><span class="language-bash">è®¾ç½®é»˜è®¤ç¼–ç </span></span><br><span class="line">default-character-set=utf8</span><br></pre></td></tr></table></figure><h2 id="è¿˜æœ‰å¥‡è‘©çš„é”™è¯¯"><a href="#è¿˜æœ‰å¥‡è‘©çš„é”™è¯¯" class="headerlink" title="è¿˜æœ‰å¥‡è‘©çš„é”™è¯¯"></a>è¿˜æœ‰å¥‡è‘©çš„é”™è¯¯</h2><blockquote><p>ä¼šæŒç»­è®°å½•å„ç§å¥‡è‘©é”™è¯¯ã€‚</p></blockquote><p>1ã€<strong>ERROR 2003 (HY000): Canâ€™t connect to MySQL server on â€˜localhostâ€™ (10061)</strong></p><p>ç™»å½• mysql æœåŠ¡ï¼ŒæŠ¥ä¸Šé¢çš„é”™è¯¯ï¼Œè¯´æ˜æ²¡æœ‰å¯åŠ¨æˆåŠŸ MySQL80 æœåŠ¡ï¼Œæœ€å¤§çš„å¯èƒ½æ˜¯ä½ ä¿®æ”¹äº†é…ç½®æ–‡ä»¶è¦ä¹ˆæ˜¯æ ¼å¼é”™äº†è¦ä¹ˆæ˜¯é…ç½®çš„ä¸œè¥¿ mysql ä¸è®¤ã€‚</p><p>åªèƒ½æŠŠé…ç½®æ–‡ä»¶ä¿®æ”¹æ­£ç¡®æ‰èƒ½å¯åŠ¨æœåŠ¡ã€‚</p><hr><p><strong>æˆ‘ä»¬è¦å­¦ä¼šåšè‡ªå·±ç²¾ç¥é¢†åŸŸå†…çš„å›ç‹ï¼Œä¸è¦æˆä¸ºåˆ«äººæƒ…ç»ªä¸–ç•Œé‡Œé¢çš„å¥´éš¶ã€‚</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
          <category> DB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL Win10 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡: éƒ¨ç½²æœåŠ¡</title>
      <link href="/2019/10/31/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E9%83%A8%E7%BD%B2%E6%9C%8D%E5%8A%A1/"/>
      <url>/2019/10/31/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E9%83%A8%E7%BD%B2%E6%9C%8D%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åœ¨ <a href="http://www.veryitman.com/2019/05/28/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%A1%B9%E7%9B%AE%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/">å¾®æœåŠ¡ç³»åˆ—</a> æ–‡ç« ä¸­ï¼Œè·Ÿå¤§å®¶ä»ç¯å¢ƒæ­å»ºã€Webå·¥ç¨‹åˆ›å»ºã€æä¾›Restfulæ¥å£ã€çƒ­éƒ¨ç½²ã€Gitä½¿ç”¨ä»¥åŠSwaggerç”Ÿæˆæ–‡æ¡£åˆ†äº«äº†SpringBootçš„å…¥é—¨çŸ¥è¯†ã€‚ä»Šå¤©ç»§ç»­åˆ†äº«å¦‚ä½•ä½¿ç”¨IDEAå’Œmavenå¯¹å·¥ç¨‹è¿›è¡Œæ‰“åŒ…æ“ä½œï¼Œç„¶åå‘å¸ƒä»£ç åˆ°æœåŠ¡å™¨è¿›è¡Œéƒ¨ç½²çš„è¿‡ç¨‹ã€‚</p><p>å¤§å®¶æœ‰ä»»ä½•é—®é¢˜ï¼Œæˆ–è€…æ–‡ä¸­æœ‰ä¸æ­£ç¡®çš„åœ°æ–¹æ¬¢è¿ç•™è¨€è¯„è®ºï¼Œå…±åŒè¿›æ­¥ï¼Œå†æ¬¡æ„Ÿè°¢å¤§å®¶çš„é˜…è¯»ã€‚</p><h2 id="IDEA-æ‰“åŒ…"><a href="#IDEA-æ‰“åŒ…" class="headerlink" title="IDEA æ‰“åŒ…"></a>IDEA æ‰“åŒ…</h2><p>åœ¨ <code>File/Project Structure</code> æ‰“å¼€è§†å›¾ï¼Œæˆ–è€…ä½¿ç”¨å¿«æ·é”® <code>Ctrl+Alt+Shift+S</code> æ‰“å¼€è§†å›¾ã€‚</p><p><img src="/upload/images/2019/10/31/1.png" alt="1568529858131"></p><p>æ‰“å¼€çš„è§†å›¾å¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/10/31/2.png" alt="1568529858131"></p><p>æŒ‰ç…§ 1ã€2ã€3  æ­¥éª¤æ‰“å¼€ä¸‹é¢è§†å›¾ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/10/31/3.png" alt="1568529858131"></p><p>é…ç½®è¯¥è§†å›¾çš„å†…å®¹ï¼Œåˆ†åˆ«è®¾ç½® <code>Main Class</code> å’Œ é€‰æ‹© <code>JAR files</code>ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/10/31/4.png" alt="1568529858131"></p><p>è¿™é‡Œç‰¹åˆ«è¦æ³¨æ„ï¼Œé€‰æ‹©ç”Ÿæˆ <code>MANIFEST.MF</code> æ–‡ä»¶ç›®å½•æ”¾åˆ° <code>resources</code> ä¸‹é¢ï¼Œé»˜è®¤ä¼šæ”¾åœ¨ <code>main\java</code> ç›®å½•ä¸‹ã€‚</p><p>å¦‚æœä¸ä¿®æ”¹è¿™ä¸ªç›®å½•ï¼Œæœ€ç»ˆè¿è¡Œç”Ÿæˆçš„ jar æ–‡ä»¶ï¼Œä¼šæŠ¥ä¸‹é¢çš„é”™è¯¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invalid or corrupt jarfile &#123;project_name&#125;.jar</span><br></pre></td></tr></table></figure><p>é…ç½®å®Œæˆåï¼Œç‚¹å‡» OK å…³é—­å¯¹è¯æ¡†å³å¯ã€‚</p><p>æ¥ä¸‹æ¥éœ€è¦ç¼–è¯‘ï¼Œç‚¹å‡» IDEA çš„ Build èœå•ï¼Œé€‰æ‹© <code>Build Artifacts...</code>ï¼Œå¦‚ä¸‹æˆªå›¾ï¼š</p><p><img src="/upload/images/2019/10/31/5.png" alt="1568529858131"></p><p>ç‚¹å‡»  <code>Build Artifacts...</code> åå‡ºç°è§†å›¾</p><p><img src="/upload/images/2019/10/31/6.png" alt="1568529858131"></p><p>ç¬¬ä¸€æ¬¡ç›´æ¥é€‰æ‹© Build é€‰é¡¹ï¼Œåç»­å¯ä»¥é€‰æ‹© Rebuild æˆ–è€… Clean é€‰é¡¹ï¼Œæ ¹æ®ä½ çš„éœ€è¦è¿›è¡Œé€‰æ‹©å³å¯ã€‚</p><p>ç­‰å¾… IDEA æ‰“åŒ…å®Œæˆåï¼Œåœ¨å·¥ç¨‹æ–‡ä»¶ä¸­ä¼šç”Ÿæˆ <code>out</code> ç›®å½•å’Œ resources ç›®å½•ä¸‹é¢ç”Ÿæˆ <code>META-INF</code> ç›®å½•å’Œå¯¹åº”çš„æ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2019/10/31/7.png" alt="1568529858131"></p><p>åœ¨ <code>springboot_jar</code> ç›®å½•ä¸‹é¢æœ‰æ‰“åŒ…æˆåŠŸçš„ jar æ–‡ä»¶ï¼Œå³ <code>springboot.jar</code> æ–‡ä»¶ï¼Œå¦å¤–ä¹Ÿå°† tomcat ç­‰ä¸€äº›å…¶ä»–ä¾èµ–åŒ…éƒ½æ‰“åŒ…åˆ°ä¸€èµ·äº†ã€‚</p><p>æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œ <code>java -jar springboot.jar</code> å°±å¯ä»¥è¿è¡Œè¯¥é¡¹ç›®äº†ã€‚</p><p><img src="/upload/images/2019/10/31/8.png" alt="1568529858131"></p><p>å¦‚æœå‘ç°ç”±äºç«¯å£è¢«å ç”¨è€Œæ— æ³•å¯åŠ¨çš„æƒ…å†µï¼Œå¯ä»¥æŸ¥çœ‹ç«¯å£å ç”¨æƒ…å†µï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -ano | findstr 8080</span><br></pre></td></tr></table></figure><p>æŸ¥åˆ°ç±»ä¼¼å¦‚ä¸‹ç»“æœï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TCP    0.0.0.0:8080           0.0.0.0:0              LISTENING       18948</span><br><span class="line">TCP    [::]:8080              [::]:0                 LISTENING       18948</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ¼”ç¤ºçš„è¿›ç¨‹IDæ˜¯ 18948ï¼Œå¼ºåˆ¶å…³é—­ç«¯å£è¿›ç¨‹å³å¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">taskkill -F -PID 18948</span><br></pre></td></tr></table></figure><h2 id="éƒ¨ç½²åˆ°æœåŠ¡å™¨"><a href="#éƒ¨ç½²åˆ°æœåŠ¡å™¨" class="headerlink" title="éƒ¨ç½²åˆ°æœåŠ¡å™¨"></a>éƒ¨ç½²åˆ°æœåŠ¡å™¨</h2><p>æˆ‘ä½¿ç”¨è™šæ‹Ÿæœºï¼ˆUbuntuï¼‰æ¥ç®€å•ä»‹ç»ä¸€ä¸‹éƒ¨ç½²è¿‡ç¨‹ã€‚è™šæ‹Ÿæœºæ˜¯ VMWare å…¶ç‰ˆæœ¬æ˜¯ <code>15.0.2</code>ï¼ŒUbuntu ç³»ç»Ÿç‰ˆæœ¬æ˜¯ <code>19.04</code>ã€‚å¦‚ä½•å®‰è£…è™šæ‹Ÿæœºã€å¦‚ä½•åœ¨è™šæ‹Ÿæœºä¸­å®‰è£… Ubuntu ç³»ç»Ÿä»¥åŠå¦‚ä½•åœ¨ Ubuntu ä¸­å®‰è£… Java ç¯å¢ƒè¯·å¤§å®¶è‡ªè¡ŒæŸ¥æ‰¾èµ„æ–™å®Œæˆï¼Œè¿™é‡Œä¸èµ˜è¿°ã€‚</p><p>å¯ä»¥é€šè¿‡ä¸Šé¢çš„æ–¹å¼ï¼ˆIDEAæ‰“åŒ…ï¼‰å®Œæˆåï¼Œå°†ç”Ÿæˆçš„ <code>springboot_jar</code> ç›®å½•æ‹·è´åˆ°è™šæ‹Ÿæœºçš„ç”¨æˆ·ç›®å½•ä¸‹ï¼Œç„¶åé€šè¿‡ <code>java -jar springboot_jar/springboot.jar</code> æ¥å¯åŠ¨æœåŠ¡ã€‚</p><p>æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ IDEA çš„ maven å·¥å…·è¿›è¡Œæ‰“åŒ…ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><p>1ã€æ‰“å¼€å·¥ç¨‹çš„mavenè§†å›¾</p><p><img src="/upload/images/2019/10/31/9.png" alt="1568529858131"></p><p>2ã€æŒ‰ç…§æ ‡çº¢çš„1ã€2ã€3ã€4æ“ä½œå³å¯</p><p>æˆåŠŸååœ¨ target ç›®å½•ä¼šç”Ÿæˆå¯¹åº”çš„å¯æ‰§è¡Œçš„ jar æ–‡ä»¶ï¼Œè¯¥ jar åŒ…åŒ…æ‹¬äº†æ‰€æœ‰çš„ SpringBoot ç›¸å…³çš„åŒ…å¦‚ä¸‹å›¾ï¼š</p><p><img src="/upload/images/2019/10/31/10.png" alt="1568529858131"></p><p>åŒç†ï¼Œå¤åˆ¶ <code>springboot-0.0.1-SNAPSHOT.jar</code> åˆ°è™šæ‹Ÿæœºçš„ç”¨æˆ·ç›®å½•ï¼Œé€šè¿‡ <code>java -jar springboot-0.0.1-SNAPSHOT.jar</code> è¿è¡ŒæœåŠ¡å³å¯ã€‚</p><p>æŸ¥çœ‹ Ubuntu çš„ä¸»æœºIPåœ°å€ï¼Œå¯ä»¥é€šè¿‡ <code>ifconfig</code> æ¥è·å–ï¼Œä¹Ÿå¯ä»¥åœ¨è®¾ç½®é‡Œé¢æŸ¥æ‰¾å…¶IPåœ°å€ã€‚ <code>ifconfig</code> éœ€è¦æŒ‰ç…§ <code>net-tools</code>ï¼Œå®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install net-tools</span><br></pre></td></tr></table></figure><p>æˆ‘çš„è™šæ‹Ÿæœºçš„IPåœ°å€æ˜¯ <code>192.168.142.128</code>ï¼Œå³ <code>http://192.168.142.128:8080</code> æ˜¯ Ubuntu çš„ IP åœ°å€å’Œ Tomcat çš„è¿è¡Œç«¯å£ï¼Œå›åˆ° Windows ä¸»æœºä¸Šé¢è®¿é—®è™šæ‹Ÿæœºçš„æœåŠ¡ï¼Œé€šè¿‡ä¸‹é¢å›¾å¯ä»¥çœ‹å‡ºæ˜¯æˆåŠŸçš„ã€‚</p><p><img src="/upload/images/2019/10/31/11.png" alt="1568529858131"></p><p>è¿™é‡Œåªæ˜¯ç®€å•çš„ä»‹ç»äº†ä¸€ä¸‹å¦‚ä½•å°†è‡ªå·±å†™çš„ SpringBoot æœåŠ¡éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šé¢ï¼Œåœ¨ä½ çš„å®é™…é¡¹ç›®ä¸­éƒ¨ç½²æ²¡è¿™ä¹ˆç®€å•ï¼Œæˆ‘ç®—æ˜¯æŠ›ç –å¼•ç‰å§ï¼Œåç»­éšç€å­¦ä¹ çš„æ·±å…¥æˆ‘å†è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹åœ¨å®é™…å¤§é¡¹ç›®ä¸­éƒ¨ç½²é‡åˆ°çš„ä¸€äº›é—®é¢˜ã€‚</p><hr><p><strong>ç”Ÿæ´»å¹¶æ²¡æœ‰é‚£ä¹ˆå¤æ‚ï¼Œè¦æ˜¯ä½ å–œæ¬¢ï¼Œå¤§å¯ä»¥è¯´æˆ‘æ˜¯åœ¨æ¢ç´¢ç”Ÿå‘½ã€‚</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot mvn package </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çœ‹ã€Šé“¶æ²³è¡¥ä¹ ç­ã€‹æœ‰æ„Ÿ</title>
      <link href="/2019/10/26/%E7%9C%8B%E3%80%8A%E9%93%B6%E6%B2%B3%E8%A1%A5%E4%B9%A0%E7%8F%AD%E3%80%8B%E6%9C%89%E6%84%9F/"/>
      <url>/2019/10/26/%E7%9C%8B%E3%80%8A%E9%93%B6%E6%B2%B3%E8%A1%A5%E4%B9%A0%E7%8F%AD%E3%80%8B%E6%9C%89%E6%84%9F/</url>
      
        <content type="html"><![CDATA[<p><img src="/upload/images/2019/10/26/1.png"></p><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>å†™è¿™ä¸ªè¯é¢˜ï¼Œæƒ…ä¸è‡ªç¦çš„æƒ³èµ·ä¸Šå­¦è€ƒè¯•çš„ä½œæ–‡é¢˜ç›®ï¼Œæ—¢æœ‰å­—æ•°é™åˆ¶åˆè¦èƒ½è¡¨è¾¾ä¸­å¿ƒæ€æƒ³ï¼Œå¥½ä¸å®¹æ˜“å­å“§å­å“§åœ°å†™å®Œäº†ï¼Œç»“æœä½œæ–‡åˆ†æ•°ä¹Ÿä¸ä¸€å®šç†æƒ³ï¼Œæ¯•ç«Ÿè€å¸ˆçš„å¿ƒæƒ…æŒ‡æ•°å˜å¹»è«æµ‹ã€‚</p><p>çœ‹å®Œç”µå½±ã€Šé“¶æ²³è¡¥ä¹ ç­ã€‹å¿ƒä¸­äº”å‘³æ‚é™ˆï¼Œæƒ³æƒ³è‡ªå·±é™ªå­©å­çš„æ—¶é—´å±ˆæŒ‡å¯æ•°ï¼Œä»ä»–å‡ºç”Ÿåˆ°ç°åœ¨å·²ç»7ä¸ªå¤šå¹´å¤´äº†ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½æ˜¯ä»–å¦ˆå¦ˆé™ªç€ï¼Œæˆ‘è¿™ä¸ªåšçˆ¶äº²çš„è·Ÿé©¬çš“æ–‡æ¯”èµ·æ¥ä¸æ­¢å·®ä¸€ä¸ªé“¶æ²³ç³»ã€‚</p><p>ç”µå½±ä¸­æç¬‘ç‰‡æ®µä¸ç®—å¤šä½†æ°åˆ°å¥½å¤„ï¼Œé©¬é£æ¯äº²çš„æ‰®æ¼”è€…ä»»ç´ æ±ï¼ˆçœ‹è¿‡ä»–ä¸»æ¼”çš„ç”µå½±ã€Šé©´å¾—æ°´ã€‹ï¼Œå†·å¹½é»˜é£æ ¼çš„ä¸€éƒ¨ç”µå½±ï¼‰å’Œé©¬é£åçˆ¹çš„æ‰®æ¼”è€…æ¢è¶…æˆä»½ä¸å¤šä½†å‡ ä¹æ‹…å½“äº†ç”µå½±ä¸­æç¬‘çš„å…¨éƒ¨å†…å®¹ã€‚ç‰¹åˆ«æ˜¯æ¢è¶…é‚£å¥ â€œå„¿å­ï¼Œä½ åˆ«çš„ä¸å¤šï¼Œå°±æ˜¯çˆ¸çˆ¸å¤šâ€ï¼Œè®©äººå³æ„ŸåŠ¨åˆå¥½ç¬‘ã€‚æˆ‘ç›¸ä¿¡æ¯ä¸ªäººçš„ä¸Šå­¦ç”Ÿæ¶¯ä¸­éƒ½ä¼šé‡åˆ°ç±»ä¼¼â€œé—«ä¸»ä»»â€è¿™æ ·è§’è‰²çš„è€å¸ˆï¼Œä¸¥å‰çš„åƒä¸ªè‡ªç§é¬¼ï¼Œåœ¨ç‰‡ä¸­ç®€ç›´å°±åƒä¸€ä¸ªåå‰¯å…¶å®çš„å¤§åæ´¾ï¼Œé‚£å¥â€œè«åå…¶å¦™ã€è’è°¬ç»ä¼¦â€æ­é…é—«ä¸»ä»»çš„çŸ­è£¤ç®€ç›´ç»äº†ã€‚</p><p>ç”µå½±çš„å‰§æƒ…æœ‰ç‚¹ç†æƒ³åŒ–ï¼Œä½†é‡Œé¢çš„å¾ˆå¤šé“ç†å€¼å¾—æˆ‘ä»¬å»å­¦ä¹ å’Œåæ€ï¼Œè¿™æ˜¯ä¸€éƒ¨é€ç»™å„¿å­å’Œçˆ¶äº²çš„ç”µå½±ã€‚</p><h2 id="é‡è¦çš„æ˜¯è®©å­©å­çœ‹ä½ åšä»€ä¹ˆ"><a href="#é‡è¦çš„æ˜¯è®©å­©å­çœ‹ä½ åšä»€ä¹ˆ" class="headerlink" title="é‡è¦çš„æ˜¯è®©å­©å­çœ‹ä½ åšä»€ä¹ˆ"></a>é‡è¦çš„æ˜¯è®©å­©å­çœ‹ä½ åšä»€ä¹ˆ</h2><p>å¾ˆå¤šæœ‹å‹è§‰å¾—æˆ‘çš„å­—å†™çš„è¿˜ç®—ä¸é”™ï¼Œé«˜ä¸­æ—¶å€™æˆ‘çš„ç¡®ç»å¸¸å‚åŠ ä¹¦æ³•æ¯”èµ›ä¹Ÿæ‹¿è¿‡å¾ˆå¤šåæ¬¡ï¼Œä½†æ˜¯æˆ‘æ€»æ˜¯æ„Ÿè§‰è‡ªå·±çš„å­—å†™çš„å¾ˆä¸€èˆ¬è¿˜éœ€è¦æ›´åŠ åŠªåŠ›ã€‚æ‰€ä»¥ä¸Šå­¦çš„æ—¶å€™åªè¦æœ‰å†™å­—çš„æœºä¼šæˆ‘å°±ä¼šåˆ©ç”¨ä¸Šï¼Œæ¯”å¦‚å‡ºé»‘æ¿æŠ¥ï¼Œå¸®è€å¸ˆåœ¨é»‘æ¿ä¸Šé¢æŠ„é¢˜ï¼Œè¿™äº›æ´»æˆ‘éƒ½å¾ˆä¹æ„å¹²ã€‚åé¢å‚åŠ å·¥ä½œäº†ï¼Œè‡ªå·±ä¹Ÿä¿æŒç€å†™æ—¥è®°çš„ä¹ æƒ¯ï¼Œç”¨ç¬”åœ¨ç¬”è®°æœ¬ä¸Šé¢å†™å‡ºæ¥çš„å­—æ„Ÿè§‰ç‰¹åˆ«äº²åˆ‡ï¼Œé‚£äº›å­—å°±å¥½æ¯”æœ‰æ¸©åº¦çš„çµé­‚ã€‚</p><p><img src="/upload/images/2019/10/26/2.png"></p><p>åœ¨å†™å­—æ–¹é¢ç‰¹åˆ«è¦æ„Ÿè°¢æˆ‘çš„çˆ¶äº²ï¼Œè®°å¾—åˆšä¸Šåˆä¸­é‚£ä¼šï¼Œçˆ¶äº²ä»å¤–åœ°æ‰“å·¥å›æ¥ç‰¹åœ°ç»™æˆ‘ä¹°äº†ä¸€æœ¬å­—å¸–ï¼Œæœ€è®©æˆ‘æ„ŸåŠ¨çš„æ˜¯ä»–åˆšä¸‹è½¦å°±äº²è‡ªé€åˆ°å­¦æ ¡æ¥äº†ï¼Œä¸€ç›´å€”å¼ºä¸”ä¸å–„äºè¡¨è¾¾çˆ±çš„ä»–é€’ç»™æˆ‘å­—å¸–çš„é‚£ä¸€åˆ»ï¼Œæˆ‘æ‰æ˜ç™½çœŸæ­£çš„çˆ±ä¸æ˜¯ç»å¸¸æŒ‚åœ¨å˜´è¾¹çš„è€Œæ˜¯åœ¨å¿ƒé‡Œåœ¨è¡ŒåŠ¨ä¸Šï¼Œè¯·ç›¸ä¿¡ä¸ç®¡ä¸€ä¸ªå¤šå¹³å‡¡çš„çˆ¸çˆ¸ï¼Œéƒ½ä¼šä»¥è‡ªå·±çš„æ–¹å¼çˆ±ä½ ã€‚çˆ¶äº²çš„å­—å†™çš„æ¯”æˆ‘å¥½ï¼Œé‚£æ—¶å€™æˆ‘å°±æ ‘ç«‹äº†ä¸€ä¸ªç›®æ ‡ï¼šâ€œå°†æ¥ä¸€å®šè¦åƒçˆ¶äº²ä¸€æ ·ï¼ŒæŠŠå­—å†™å¥½ï¼Œä¸èƒ½ç»™ä»–ä¸¢äººâ€œï¼Œç°åœ¨æƒ³æƒ³è‡ªå·±æŒºå¹¼ç¨šçš„ã€‚</p><p>ç”µå½±é‡Œé¢æœ‰ä¸ªç‰‡æ®µï¼Œæ·±å¤œé‡Œé©¬é£çªç„¶ç¡é†’äº†ï¼Œçœ‹åˆ°è¿˜åœ¨å·¥ä½œçš„é©¬çš“æ–‡è¯´ï¼šâ€œçˆ¸çˆ¸ï¼Œæˆ‘å¯ä»¥ä¸ç¡è§‰å—ï¼Ÿâ€ï¼Œé©¬çš“æ–‡è¯´ï¼šâ€œé‚£æ˜¯ä½ è‡ªå·±çš„äº‹ï¼Œä»¥åè¿™ç§äº‹ä¸ç”¨é—®æˆ‘â€ã€‚</p><p>æ¯ä¸ªäººéƒ½ä¼šç»å†åˆä¸ºäººçˆ¶äººæ¯ï¼Œéš¾å…è‡ªå·±ä¹Ÿä¼šçŠ¯ä¸‹ä¸€äº›é”™è¯¯ï¼Œå°±åƒç”µå½±é‡Œé¢é©¬çš“æ–‡å¯¹è‡ªå·±çš„å„¿å­é©¬é£è¯´ï¼šâ€œå¯¹ä¸èµ·ï¼çˆ¸çˆ¸ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡åšçˆ¸çˆ¸â€ï¼Œçœ‹åˆ°è¿™é‡Œæˆ‘ä¸ç¦æ½¸ç„¶æ³ªä¸‹ï¼Œæ„Ÿè§‰ç‰¹åˆ«çœŸè¯šã€‚æˆ‘å’Œè€å©†çº¦å®šä¸€å®šä¸è¦åœ¨å­©å­é¢å‰åµæ¶ï¼Œä¸è¦åœ¨å­©å­é¢å‰éšä¾¿å‘è„¾æ°”ï¼Œå¦‚æœé‚£æ ·åšäº†ä¼šç»™ä»–ä»¬å¿ƒçµä¸Šé¢é€ æˆä¸€å®šçš„ä¼¤å®³ï¼Œå­©å­ä»¬çš„å­¦ä¹ æ¨¡ä»¿èƒ½åŠ›éƒ½æ¯”è¾ƒå¼ºï¼Œå¤§äººçš„åè„¾æ°”ä¼šå½±å“åˆ°å­©å­ã€‚å‘¨æœ«æœ‰æ—¶é—´ï¼Œæˆ‘éƒ½ä¼šæ•…æ„åœ¨å­©å­é¢å‰çœ‹ä¹¦ï¼Œä»–çœ‹æˆ‘çœ‹çš„é‚£ä¹ˆè®¤çœŸä¹Ÿå¿ä¸ä½è¿‡æ¥å‡‘çƒ­é—¹ï¼Œæ—¶é—´ä¹…äº†ä»–ä¹Ÿçˆ±ä¸Šäº†çœ‹ä¹¦ï¼Œä»–çš„ç¬¬ä¸€ä¸ªä¹¦æ¶å°±æ˜¯è¿™ä¹ˆæ¥çš„ï¼Œä¹¦æ¶ä¸Šé¢çš„ä¹¦æœ‰äº›æ˜¯å›¾ä¹¦é¦†å€Ÿæ¥çš„ï¼Œæœ‰äº›æ˜¯æˆ‘å’Œè€å©†ä¹°ç»™ä»–çš„ï¼Œæœ‰äº›æ˜¯ä»–å’Œå…¶ä»–å°æœ‹å‹æ¢æ¥çš„ã€‚</p><h2 id="ä¸€å®šè¦åšè‡ªå·±åšå–œæ¬¢çš„äº‹æƒ…"><a href="#ä¸€å®šè¦åšè‡ªå·±åšå–œæ¬¢çš„äº‹æƒ…" class="headerlink" title="ä¸€å®šè¦åšè‡ªå·±åšå–œæ¬¢çš„äº‹æƒ…"></a>ä¸€å®šè¦åšè‡ªå·±åšå–œæ¬¢çš„äº‹æƒ…</h2><p><img src="/upload/images/2019/10/26/4.png"></p><p>ä»Šå¹´å›½åº†èŠ‚æ”¾å‡å½“å¤©ï¼Œæˆ‘å…­ç‚¹åŠèµ·åºŠå‡†å¤‡åšæ—©é¤ï¼Œå‘ç°å„¿å­ä¸€ä¸ªäººååœ¨å®¢å…å†™ä½œä¸šï¼Œæˆ‘å½“æ—¶æƒŠå‘†äº†ï¼Œè¿™å°å­æ€ä¹ˆè¿™ä¹ˆæ—©å°±èµ·åºŠäº†å±…ç„¶è¿˜åœ¨å†™ä½œä¸šï¼Œå¦‚æœæŒ‰ç…§æˆ‘ä»¥å‰çš„è„¾æ°”ä¸€å®šä¼šæ‰¹è¯„ä»–ã€‚å°±æ‚„æ‚„èµ°è¿‡å»ï¼Œè½»è½»çš„æ‹æ‹ä»–çš„è‚©è†€è¯´ï¼šâ€œä½ æ€ä¹ˆè¿™ä¹ˆå‹¤å¥‹å‘€ï¼Ÿâ€ï¼Œä»–å¤´ä¹Ÿä¸å›çš„è¯´ï¼šâ€œä»Šå¤©ä½ ä¸æ˜¯è¦å¸¦æˆ‘å»ç©å—ï¼Œæˆ‘æƒ³å…ˆæŠŠä½œä¸šå†™å®Œâ€ï¼Œæˆ‘å¿½ç„¶ä¸€æ„£ï¼ŒåŸæ¥æˆ‘æœ‰è¿‡è¿™ä¸ªæ‰¿è¯ºï¼Œæˆ‘è¯´ï¼šâ€œè¡Œï¼Œä½ å†™å®Œä¹‹åç»™æˆ‘æ£€æŸ¥ä¸€ä¸‹ï¼Œå¦‚æœé—®é¢˜ä¸å¤§æˆ‘ä»¬ä»Šå¤©å°±æ—©æ—©å‡ºå‘â€ï¼Œä»–è‡ªä¿¡çš„è¯´ï¼šâ€æ²¡é—®é¢˜â€œã€‚</p><p>å°çš„æ—¶å€™å®¶é‡Œæ¯”è¾ƒè´«å¯’ï¼Œæˆ‘åˆæ¯”è¾ƒå–œæ¬¢è¯»ä¹¦ï¼Œç™½å¤©é™¤äº†ä¸Šå­¦å¤–å…¶ä»–æ—¶é—´å‡ ä¹éƒ½éœ€è¦å¸®åŠ©çˆ¶æ¯å¹²å†œæ´»ï¼Œä¹Ÿåªæœ‰æ™šä¸Šæœ‰æ—¶é—´æ¥è¯»ä¹¦å’Œå†™ä½œä¸šã€‚åŒ—æ–¹çš„å†¬å¤©å¾ˆå†·ï¼Œæœ‰æ—¶å€™è¿ç”µæˆ‘éƒ½èˆä¸å¾—ç”¨ï¼Œå·å·çš„ç‚¹ä¸Šèœ¡çƒ›ï¼Œæ¯äº²ç»å¸¸åŠå¤œèµ·æ¥çœ‹æˆ‘ï¼Œå¥¹ä¹Ÿæ²¡æœ‰è¯´æˆ‘ä»€ä¹ˆï¼Œåªæ˜¯å‘Šè¯‰æˆ‘ä¸è¦å¤ªæ™šäº†ï¼Œåæ¥å¥¹è¿˜ç»™æˆ‘å‡†å¤‡äº†ä¸€ä¸ªå°ç«ç‚‰ã€‚æ¯æ¬¡è€ƒè¯•ç»“æœä¸ç®¡æ˜¯å¥½è¿˜æ˜¯å·®ï¼Œå¥¹æ€»æ˜¯å‘Šè¯‰æˆ‘è¦ç»§ç»­åŠªåŠ›ã€‚å¦‚æœä½ å·²ç»æ˜¯ä¸€åå­¦ç”Ÿçš„å®¶é•¿äº†ï¼Œçœ‹åˆ°å­©å­åœ¨åŠªåŠ›ä¸è¦è½»æ˜“æ‰“æ–­ä»–ï¼Œä½ åªéœ€è¦é¼“åŠ±å’Œæ”¯æŒTaå°±å¥½äº†ã€‚å–œæ¬¢ç”µå½±ä¸­çš„ä¸€å¥å°è¯ï¼šâ€œå­©å­éƒ½æœ‰ä¸€ä¸ªç¥å¥‡çš„æ„Ÿå—å™¨ï¼Œèƒ½çŸ¥é“ä½ æ˜¯ä¸æ˜¯çœŸçš„çˆ±TAâ€ã€‚</p><p>ç°åœ¨ç¤¾ä¼šç«äº‰å‹åŠ›ç¡®å®å¾ˆå¤§ï¼Œçˆ¶æ¯ä¸ºäº†å­©å­ä¹Ÿæ˜¯æ“ç¢äº†å¿ƒï¼Œæ‹…å¿ƒå­©å­å°†æ¥æ€ä¹ˆåŠï¼Œäºæ˜¯å„ç§å­¦ä¹ èµ„æ–™ï¼Œè¡¥ä¹ ç­æŠŠå­©å­å‹å¾—æ°”å–˜ååã€‚ä½œä¸ºçˆ¶æ¯ä¸ç£ä¿ƒå­©å­å­¦ä¹ å’Œè¿›æ­¥ï¼Œæ˜¯æˆ‘ä»¬çš„å¤±èŒï¼Œä½†æ˜¯è¿‡åº¦çš„å‹è¿«å­©å­å°±æ˜¯åœ¨çŠ¯ç½ªï¼Œæ¯ä¸ªå­©å­éƒ½æœ‰è‡ªå·±çš„çˆ±å¥½å’Œæ¢¦æƒ³ï¼Œæˆ‘ä»¬åº”è¯¥æ•™å¯¼ä»–è¦åŠªåŠ›å»å®ç°è‡ªå·±çš„ç›®æ ‡ï¼Œè€Œä¸æ˜¯å‘Šè¯‰ä»–ä½ åªæœ‰è€ƒä¸Šæ¸…ååŒ—å¤§æ‰èƒ½ç»§ç»­è‡ªå·±çš„äººç”Ÿï¼Œå°±åƒç”µå½±é‡Œé¢è¯´çš„ï¼š</p><blockquote><p>â€œä½ æœ‰æ²¡æœ‰æƒ³è¿‡é•¿å¤§è¦å¹²ä»€ä¹ˆâ€ï¼Ÿ</p><p>â€œæ¸…ååŒ—å¤§å•Šï¼Œå¦ˆå¦ˆè¯´çš„â€ã€‚</p><p>â€œæ¸…ååŒ—å¤§åªæ˜¯è¿‡ç¨‹ï¼Œä¸æ˜¯ç›®çš„â€ã€‚</p><p>â€œç­‰ä½ é•¿å¤§äº†ä¸€å®šè¦åšè‡ªå·±å–œæ¬¢çš„äº‹æƒ…â€ã€‚</p></blockquote><p>åªæœ‰åšè‡ªå·±å–œæ¬¢çš„äº‹æ‰æœ‰å¯èƒ½åˆ›é€ å¥‡è¿¹ï¼</p><h2 id="éœ€è¦ç‹¬ç«‹æ€è€ƒçš„èƒ½åŠ›"><a href="#éœ€è¦ç‹¬ç«‹æ€è€ƒçš„èƒ½åŠ›" class="headerlink" title="éœ€è¦ç‹¬ç«‹æ€è€ƒçš„èƒ½åŠ›"></a>éœ€è¦ç‹¬ç«‹æ€è€ƒçš„èƒ½åŠ›</h2><p>æˆ‘å®¶é‚£ä¸ªå°å­å¾ˆå–œæ¬¢æ‹¼å›¾ï¼Œå–œæ¬¢ä¸€ä¸ªäººé»˜é»˜æ— é—»çš„åœ¨æˆ¿é—´æ‹¯æ•‘å„ç§å¡ç‰‡ï¼Œä»¿ä½›åªæœ‰ä»–æ‰èƒ½è®©æ•£è£…çš„å¥¥ç‰¹æ›¼å¤æ´»ã€‚æ¯æ¬¡æ‹¼è£…å®Œæˆä»–éƒ½è¦è¿‡æ¥ç‚«è€€ä¸€ç•ªï¼Œå½“ç„¶æˆ‘ä¹Ÿä¼šç»™ä»–ä¸€ä¸ªå¤§å¤§çš„èµã€‚</p><p>æˆ‘ä»¬åœ¨ç½‘ä¸Šä¹°ä¸€äº›ä¸œè¥¿ï¼Œåªè¦ä»–åœ¨å®¶ä»–éƒ½ä¼šè¦æ±‚å»æ‹†è£…ã€‚è®°å¾—ä¸Šæ¬¡ä¹°äº†ä¸€ä¸ªå¸å°˜å™¨ï¼Œæˆ‘æ‰“ç”µè¯ç»™æˆ‘è€å©†è¯´ç­‰æˆ‘å›æ¥ç»„è£…ã€‚æ²¡è¿‡ä¸€ä¼šï¼Œæˆ‘è€å©†å‘Šè¯‰æˆ‘è¯´ï¼Œä½ å„¿å­å·²ç»ç»„è£…å¥½äº†ã€‚æˆ‘å›æ¥ä¸€çœ‹ç»„è£…è™½ç„¶æ²¡æœ‰é‚£ä¹ˆå®Œç¾ï¼Œä½†æ˜¯å¯¹äºä¸€ä¸ªä¸åˆ°6å²çš„å­©å­æ¥è¯´å·²ç»å¾ˆä¸é”™äº†ã€‚ä¹‹å‰æ€»æ˜¯æ‹…å¿ƒå­©å­åšä»»ä½•äº‹ä¸€å®šåšä¸å¥½ï¼Œæ‰€ä»¥å¤„å¿ƒç§¯è™‘çš„é¿å¼€ä»–ï¼Œç”Ÿæ€•ä»–è¦è‡ªå·±å»åšï¼Œè‡ªä»è‡ªå·±çœ‹è¿‡å‡ æœŸå…³äºå­©å­å¦‚ä½•ç‹¬ç«‹çš„è¯¾ç¨‹åå¤§å¤§çš„æ”¹å˜äº†æˆ‘çš„æƒ³æ³•ã€‚</p><p>è®°å¾—è‡ªå·±å°æ—¶å€™ï¼Œçˆ¶æ¯éƒ½å¾ˆå¿™ã€‚çœ‹åˆ°ä»–ä»¬å¤ªç´¯äº†å°±æƒ³ç€è‡ªå·±ä¸€å®šè¦å­¦ä¼šåšé¥­ï¼Œäºæ˜¯è‡ªå·±å°±ä»ä¸‹é¢æ¡å¼€å§‹ï¼Œæ…¢æ…¢çš„ä»æ´—ç¢—æ´—é”…å˜æˆäº†ä¸€ä¸ªå°å¨å¸ˆï¼Œå¦ˆå¦ˆä¸ºäº†è¿™ä¸ªäº‹éª„å‚²äº†å¾ˆä¹…ã€‚çˆ¶æ¯ä¸èƒ½æ€»æ˜¯é˜»æ­¢å­©å­å»åšä»–æ„Ÿå…´è¶£çš„äº‹æƒ…ï¼Œæˆ‘ä»¬åªéœ€è¦åšå¥½å¼•å¯¼å³å¯ï¼Œæ”¾å¿ƒï¼Œä»–ä»¬å¾ˆé è°±ï¼å°±æ‹¿å­©å­è·Œå€’è¿™ä»¶äº‹æ¥è¯´ï¼Œå¾ˆå¤šçˆ·çˆ·å¥¶å¥¶çœ‹åˆ°å­©å­ä¸å°å¿ƒæ‘”å€’å°±è¿«ä¸åŠå¾…çš„å»æŠ±èµ·æ¥ï¼Œå…¶å®è¿™æ˜¯ä¸å¯¹çš„ï¼Œæˆ‘ä»¬åº”è¯¥å¼•å¯¼å­©å­å¦‚ä½•è‡ªå·±ç«™èµ·æ¥ï¼ŒTaä¸‹æ¬¡å°±çŸ¥é“å³ä½¿è·Œå€’ä¹Ÿè¦è‡ªå·±çˆ¬èµ·æ¥ã€‚</p><p>å­©å­åœ¨ç”Ÿæ´»ä¸­ä¹Ÿä¼šé‡åˆ°ä¸€äº›é—®é¢˜ï¼Œå­©å­ä»¬æœ‰è‡ªå·±çš„å°ä¸–ç•Œï¼Œåˆ«ä»¥ä¸ºä»–ä»¬å°±æ²¡æœ‰çƒ¦æ¼å’Œå›°éš¾ã€‚åœ¨é‡åˆ°é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸è¦ç›´æ¥è‡ªä»¥ä¸ºæ˜¯çš„ç»™å‡ºç­”æ¡ˆï¼Œé—®é—®Taèƒ½ä¸èƒ½å†åŠ¨åŠ¨è„‘ç­‹æƒ³æƒ³å…¶ä»–åŠæ³•ï¼Ÿ</p><blockquote><p>æˆ‘ä»¬çš„å­©å­åˆ°åº•éœ€è¦æ€ä¹ˆæ ·çš„æ•™è‚²ï¼Ÿç­”æ¡ˆæ˜¯ï¼šå­©å­éœ€è¦åŸ¹å…»ç‹¬ç«‹æ€è€ƒï¼Œå‹‡æ•¢é¢å¯¹è¿™ä¸ªä¸–ç•Œã€åšè‡ªå·±å–œæ¬¢äº‹æƒ…çš„æ•™è‚²ã€‚</p></blockquote><p><img src="/upload/images/2019/10/26/3.png"></p><p>åœ¨é©¬é£é‡åˆ°æš´é›¨è€Œè¢«å›°ä½çš„æƒ…å†µä¸‹ï¼Œé©¬çš“æ–‡æ­‡æ–¯åº•é‡Œçš„è¯´ï¼šâ€œæˆ‘æ˜¯çˆ¸çˆ¸ï¼ŒåŠ¨åŠ¨ä½ çš„è„‘å­ï¼Œçœ‹çœ‹ä½ å‘¨å›´æœ‰ä»€ä¹ˆï¼Œä½ ä¸€å®šèƒ½å‡ºæ¥çš„â€ï¼Œç»“æœå¥‡è¿¹å‡ºç°äº†ï¼Œé©¬é£è‡ªæ•‘äº†ã€‚è™½ç„¶æœ‰ç‚¹å¤¸å¼ ï¼Œä½†æ˜¯å®ƒå‘Šè¯‰æˆ‘ä»¬å¦‚æœä¸æ˜¯çˆ¶äº²çš„å¼•å¯¼ä¸æ˜¯å„¿å­çš„è‡ªä¿¡å’Œæ€è€ƒè¿™å°†æ˜¯ä¸€åœºæ‚²å‰§ï¼Œè‡³å°‘æˆ‘çœ‹å“­äº†ã€‚</p><p>é“¶æ²³è¡¥ä¹ ç­ï¼Œåˆ°åº•ç»™æˆ‘ä»¬è¡¥äº†ä»€ä¹ˆï¼Ÿ</p><p>æ¯ä¸ªäººå¿ƒä¸­éƒ½æœ‰è‡ªå·±çš„ç­”æ¡ˆï¼Œå¯¹æˆ‘æ¥è¯´è‡³å°‘è®©æˆ‘è®¤è¯†åˆ°äº†é™ªä¼´å’Œé¼“åŠ±å¾ˆé‡è¦ï¼</p><p>è®°å¾—è®©å­©å­åšè‡ªå·±å–œæ¬¢çš„äº‹æƒ…ï¼Œä½ åªéœ€è¦é¼“åŠ±å’Œç›¸ä¿¡ä»–ï¼</p><hr><p><strong>çœŸæ­£çš„äººç”Ÿéš¾é¢˜ï¼Œä¸ä¼šåƒè€ƒå·é‚£æ ·ï¼Œä¼šè‡ªåŠ¨è·³å‡ºABCDå››ä¸ªé€‰é¡¹ï¼Œæœ‰ä¸”åªæœ‰ä¸€ç§æ ‡å‡†ç­”æ¡ˆã€‚è€Œæ˜¯ä¼šæœ‰EFGHIJKçš„å²”è·¯ï¼Œç”šè‡³èƒ½å¼€å‡ºXYZçš„è„‘æ´ã€‚~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç”µå½± </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡: Swaggerç”ŸæˆMarkdownæ–‡æ¡£</title>
      <link href="/2019/10/13/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Swagger%E7%94%9F%E6%88%90Markdown%E6%96%87%E6%A1%A3/"/>
      <url>/2019/10/13/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Swagger%E7%94%9F%E6%88%90Markdown%E6%96%87%E6%A1%A3/</url>
      
        <content type="html"><![CDATA[<p>å›½åº†æ”¾å‡æœŸé—´ï¼Œçœ‹äº†ä¸€éƒ¨ 2018å¹´ä¸Šæ˜ çš„ç”µå½± ã€Šæœ¬æ°æ˜.å·´é¡¿å¥‡äº‹ã€‹ï¼Œè±†ç“£è¯„åˆ† 8.9ã€‚å½±ç‰‡è®²è¿°äº†ä¸€å‡ºç”Ÿä¾¿æ‹¥æœ‰80å²è€äººå½¢è±¡çš„æœ¬æ°æ˜Â·å·´é¡¿ï¼Œéšç€å²æœˆçš„æ¨ç§»é€æ¸å˜å¾—å¹´è½»ï¼Œæœ€ç»ˆå›åˆ°å©´å„¿å½¢æ€ï¼Œå¹¶åœ¨è‹è€çš„æ‹äººé»›èŒœæ€€ä¸­ç¦»ä¸–çš„å¥‡å¼‚æ•…äº‹ã€‚ å¦‚æœæ²¡æœ‰çœ‹è¿‡è¿™éƒ¨å½±ç‰‡çš„å°ä¼™ä¼´æŠ½æ—¶é—´å¯ä»¥å»çœ‹çœ‹ï¼Œé‡Œé¢æœ‰å¾ˆå¤šå…³äºäººç”Ÿçš„å“²ç†ã€‚</p><p>æœ¬æ¬¡æ–‡ç« å°é¢å›¾æ¥è‡ªè¯¥ç”µå½±ã€‚</p><p><img src="/upload/images/2019/10/13/1.jpg" alt="1568529858131"></p><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æ–‡ç«  <a href="http://www.veryitman.com/2019/09/22/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Swagger%E8%AE%A9%E4%BD%A0%E5%8F%AF%E4%BB%A5%E5%A4%9A%E6%8A%BD%E4%B8%80%E6%94%AF%E7%83%9F/">å¾®æœåŠ¡: Swaggerè®©ä½ å¯ä»¥å¤šæŠ½ä¸€æ”¯çƒŸ</a> ç»™å¤§å®¶åˆ†äº«äº†å¦‚ä½•åœ¨è‡ªå·±çš„ SpringBoot å·¥ç¨‹ä¸­é›†æˆ Swagger ä»¥åŠå¦‚ä½•ä½¿ç”¨ Swagger ç”Ÿæˆåœ¨çº¿æ–‡æ¡£ã€‚ä»Šå¤©è·Ÿå¤§å®¶åˆ†äº«ä»¥ä¸‹å¦‚ä½•ä½¿ç”¨ Swagger ç”Ÿæˆç¦»çº¿çš„ Markdown æ ¼å¼çš„æ–‡æ¡£ï¼Œåœ¨é˜…è¯»ä¸‹é¢å†…å®¹ä¹‹å‰ï¼Œè¿˜æ˜¯å¸Œæœ›å¤§å®¶èƒ½çœ‹ä¸€ä¸‹ <a href="http://www.veryitman.com/2019/09/22/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Swagger%E8%AE%A9%E4%BD%A0%E5%8F%AF%E4%BB%A5%E5%A4%9A%E6%8A%BD%E4%B8%80%E6%94%AF%E7%83%9F/">å¾®æœåŠ¡: Swaggerè®©ä½ å¯ä»¥å¤šæŠ½ä¸€æ”¯çƒŸ</a> è¿™ç¯‡æ–‡ç« ã€‚</p><p>æœ¬äººæ˜¯ä¸€ä¸ªçƒ­çˆ± Markdown çš„ç‹‚çƒ­åˆ†å­ï¼Œæ— è®ºæ˜¯å†™æ—¥è®°è¿˜æ˜¯å·¥ä½œç¬”è®°æˆ‘éƒ½ä¼šä½¿ç”¨ Markdownå·¥å…·æ¥åšï¼Œé‚£ç§æ‰€è§å³æ‰€å¾—çš„æ„Ÿè§‰æœ‰ç‚¹æš—çˆ½ã€‚è‡ªå·±åœ¨ç½‘ä¸Šä¹Ÿæ‰¾äº†å¾ˆå¤šå…³äºå¦‚ä½•ä½¿ç”¨ Swagger ç”Ÿæˆ Markdown æ ¼å¼çš„æ–‡æ¡£ï¼Œå¤§å¤šæ•°æ–‡ç« éƒ½æ¯”è¾ƒé™ˆæ—§ï¼Œå¥½ä¸å®¹æ˜“æ‰¾åˆ°ä¸€ç¯‡è‡ªè®¤ä¸ºè¿˜å¯ä»¥çš„æ–‡ç« å»å®è·µå‘ç°è¿˜æ˜¯å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œäºæ˜¯ç»è¿‡æ‘¸ç´¢è¯ç”Ÿäº†æ­¤æ–‡ã€‚</p><h2 id="é›†æˆ-swagger2markup"><a href="#é›†æˆ-swagger2markup" class="headerlink" title="é›†æˆ swagger2markup"></a>é›†æˆ swagger2markup</h2><p>æ’ä»¶ <code>Swagger2Markup</code> å¯ä»¥å¸®åŠ©æˆ‘ä»¬å°† Swagger æ–‡æ¡£è½¬æ¢ä¸ºç¦»çº¿çš„ Markdown æ ¼å¼çš„æ–‡æ¡£ï¼Œ<code>Swagger2Markup</code> ä»‹ç»å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Swagger2Markup converts a Swagger JSON or YAML file into several AsciiDoc or GitHub Flavored Markdown documents which can be combined with hand-written documentation. </span><br></pre></td></tr></table></figure><p>å¯ä»¥åœ¨ <a href="https://mvnrepository.com/search?q=swagger2markup">mvnrepository</a> ä»“åº“ä¸­æœç´¢ <code>swagger2markup</code>ï¼Œå¦‚å›¾ï¼š</p><p><img src="/upload/images/2019/10/13/2.png" alt="1568529858131"></p><p>æˆ‘ä½¿ç”¨çš„æ˜¯ç¬¬ä¸€ä¸ªï¼Œå½“å‰ç‰ˆæœ¬æ˜¯ <code>1.3.3</code>ï¼Œåœ¨å·¥ç¨‹çš„ pom æ–‡ä»¶ä¸­ï¼Œéœ€è¦é›†æˆ <code>swagger</code> å’Œ <code>swagger2markup</code>ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--swagger--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--swagger2markup--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.swagger2markup<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger2markup<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¦‚æœä½ è®¤ä¸ºè¿™æ ·å°±å¯ä»¥äº†ï¼Œé‚£ä½ æ¥ä¸‹æ¥æ— æ³•å®Œæˆç¼–è¯‘å·¥ä½œï¼Œå› ä¸ºæ ¹æœ¬ä¸‹è½½ä¸äº† <code>swagger2markup</code>ï¼Œè¿˜éœ€è¦åœ¨ pom æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--ä¸åŠ è¿™ä¸ªï¼Œswagger2markup æ‰¾ä¸åˆ°--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>jcenter-releases<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>jcenter<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://jcenter.bintray.com<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="ç¼–å†™æµ‹è¯•ä»£ç "><a href="#ç¼–å†™æµ‹è¯•ä»£ç " class="headerlink" title="ç¼–å†™æµ‹è¯•ä»£ç "></a>ç¼–å†™æµ‹è¯•ä»£ç </h2><p>æ’ä»¶é›†æˆæˆåŠŸä¹‹åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å»å®ç°ç”Ÿæˆ Markdown æ–‡æ¡£çš„æ¢¦æƒ³äº†ï¼Œæœ‰ç‚¹å°é¸¡å†»â€¦</p><p>å•å…ƒæµ‹è¯•ä»£ç ç¤ºä¾‹ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.github.swagger2markup.Swagger2MarkupConfig;</span><br><span class="line"><span class="keyword">import</span> io.github.swagger2markup.Swagger2MarkupConverter;</span><br><span class="line"><span class="keyword">import</span> io.github.swagger2markup.builder.Swagger2MarkupConfigBuilder;</span><br><span class="line"><span class="keyword">import</span> io.github.swagger2markup.markup.builder.MarkupLanguage;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.MediaType;</span><br><span class="line"><span class="keyword">import</span> org.springframework.mock.web.MockHttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.web.servlet.MockMvc;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.web.servlet.MvcResult;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.web.servlet.request.MockMvcRequestBuilders;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="meta">@AutoConfigureMockMvc</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringbootApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">generateMarkdownFile</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Swagger2MarkupConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Swagger2MarkupConfigBuilder</span>()</span><br><span class="line">        .withMarkupLanguage(MarkupLanguage.MARKDOWN)</span><br><span class="line">        .build();</span><br><span class="line"></span><br><span class="line">        <span class="type">URL</span> <span class="variable">apiUrl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;http://localhost:8080/v2/api-docs&quot;</span>);</span><br><span class="line">        <span class="comment">// æŒ‡å®šæ–‡ä»¶åç§°</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">markdownFileName</span> <span class="operator">=</span> <span class="string">&quot;src/docs/markdown/generated/MSBlog_Server_API&quot;</span>;</span><br><span class="line">        Swagger2MarkupConverter.from(apiUrl)</span><br><span class="line">        .withConfig(config)</span><br><span class="line">        .build()</span><br><span class="line">        <span class="comment">//æŒ‡å®šç”Ÿæˆç›®å½•ä¸‹ç”ŸæˆæŒ‡å®šæ–‡ä»¶</span></span><br><span class="line">        .toFile(Paths.get(markdownFileName));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–å†™å®Œæˆåï¼Œå¯ä»¥è¿è¡Œ <code>generateMarkdownFile</code> è¿™ä¸ªæ–¹æ³•ï¼Œå³é”®è¯¥æ–¹æ³•ï¼Œå‡ºç°å¼¹æ¡†å¦‚ä¸‹å›¾ï¼š</p><p><img src="/upload/images/2019/10/13/3.png" alt="1568529858131"></p><p>ç›´æ¥é€‰æ‹© <code>Run generateMarkdownFile</code> å³å¯å¼€å§‹ã€‚</p><p>ä¸å‡ºæ„å¤–çš„è¯ï¼Œä¼šå¤±è´¥å¹¶ä¸”æŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Failed to read the Swagger source</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¦ä» <code>http://localhost:8080/v2/api-docs</code> è¯»å–å†…å®¹ï¼Œ<strong>æ‰€ä»¥é¦–å…ˆéœ€è¦å°†ä¸»å·¥ç¨‹è¿è¡Œèµ·æ¥å³è¿è¡Œé¡¹ç›®</strong>ã€‚è¿è¡ŒæˆåŠŸä¹‹åï¼Œå†æ¥æ‰§è¡Œæµ‹è¯•ä»£ç å°±å¯ä»¥æˆåŠŸäº†ã€‚</p><p>ç”Ÿæˆçš„æ–‡ä»¶å¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/10/13/4.png" alt="1568529858131"></p><p>æ­¤æ—¶çš„æˆ‘æƒ…ä¸è‡ªç¦çš„å“¼èµ·äº†ï¼šâ€œåªè¦äººäººéƒ½çŒ®å‡ºä¸€ç‚¹çˆ±ï¼Œä¸–ç•Œå°†å˜æˆç¾ä¸½çš„äººé—´â€ çš„æ­Œè¯ï¼Œå§æ§½+nâ€¦æ€»ç®—å¯ä»¥äº†ã€‚</p><p>åŒç†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ç”Ÿæˆ <code>adoc</code> æ ¼å¼ï¼ˆè¿™ç§æ ¼å¼çš„æ–‡æ¡£éœ€è¦ä½¿ç”¨å…¶ä»–å·¥å…·ç”Ÿæˆ PDF æˆ–è€… HTML æ–‡ä»¶ï¼‰çš„æ–‡æ¡£ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">generateDocsFile</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">Swagger2MarkupConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Swagger2MarkupConfigBuilder</span>()</span><br><span class="line">        .withMarkupLanguage(MarkupLanguage.ASCIIDOC)</span><br><span class="line">        .build();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¯¥åœ°å€ä¸è¦å†™é”™</span></span><br><span class="line">    <span class="type">URL</span> <span class="variable">apiUrl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;http://localhost:8080/v2/api-docs&quot;</span>);</span><br><span class="line">    <span class="comment">// æŒ‡å®šç›®å½•</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">dirName</span> <span class="operator">=</span> <span class="string">&quot;src/docs/markdown/generated&quot;</span>;</span><br><span class="line">    Swagger2MarkupConverter.from(apiUrl)</span><br><span class="line">        .withConfig(config)</span><br><span class="line">        .build()</span><br><span class="line">        <span class="comment">//æŒ‡å®šç”Ÿæˆç›®å½•</span></span><br><span class="line">        .toFolder(Paths.get(dirName));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ åœ¨ä½¿ç”¨ <code>generateDocsFile()</code> è¿™ä¸ªæ–¹æ³•å‘ç”Ÿå¦‚ä¸‹çš„é”™è¯¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.lang.NoClassDefFoundError: nl/jworks/markdown_to_asciidoc/Converter</span><br></pre></td></tr></table></figure><p>éœ€è¦åœ¨ä½ çš„ <code>settings.xml</code> æ–‡ä»¶ï¼ˆä¸€èˆ¬åœ¨ <code>C:\Users\username\.m2</code> ç›®å½•ä¸‹é¢ï¼Œå¦‚æœæ²¡æœ‰å°±æ–°å»ºä¸€ä¸ªå§ï¼‰ä¸­å¢åŠ é˜¿é‡Œçš„é•œåƒï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">settings</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/SETTINGS/1.0.0&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">mirrors</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus-aliyun<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>Nexus aliyun<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://maven.aliyun.com/repository/jcenter<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mirrors</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¿å­˜ï¼Œç„¶åå» IDEA ä¸­é‡æ–°è¿è¡Œæµ‹è¯•æ–¹æ³•å³å¯ã€‚</p><p>å¦‚æœä½ ä¹‹å‰ä¿®æ”¹è¿‡ <code>settings.xml</code> æ–‡ä»¶çš„ä½ç½®ï¼Œå¯ä»¥å‚è€ƒ <a href="https://blog.csdn.net/fengqing5578/article/details/82854495">ideaè®¾ç½®mavené…ç½®æ–‡ä»¶setting.xmlçš„ä½ç½®</a> è¿™ç¯‡æ–‡ç« å»æ‰¾åˆ°è¯¥æ–‡ä»¶å†ä¿®æ”¹ã€‚</p><p>æ‰“çƒŠï¼Œæ‰‹å·¥ï¼</p><hr><p><strong>ä¸€ä»¶äº‹æ— è®ºå¤ªæ™šæˆ–è€…å¤ªæ—©ï¼Œéƒ½ä¸ä¼šé˜»æ‹¦ä½ æˆä¸ºä½ æƒ³æˆä¸ºçš„é‚£ä¸ªäººï¼Œè¿™ä¸ªè¿‡ç¨‹æ²¡æœ‰æ—¶é—´çš„æœŸé™ï¼Œåªè¦ä½ æƒ³ï¼Œéšæ—¶éƒ½å¯ä»¥å¼€å§‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot Swagger Markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡: Swaggerè®©ä½ å¯ä»¥å¤šæŠ½ä¸€æ”¯çƒŸ</title>
      <link href="/2019/09/22/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Swagger%E8%AE%A9%E4%BD%A0%E5%8F%AF%E4%BB%A5%E5%A4%9A%E6%8A%BD%E4%B8%80%E6%94%AF%E7%83%9F/"/>
      <url>/2019/09/22/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Swagger%E8%AE%A9%E4%BD%A0%E5%8F%AF%E4%BB%A5%E5%A4%9A%E6%8A%BD%E4%B8%80%E6%94%AF%E7%83%9F/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><a href="https://swagger.io/">Swagger</a>ï¼Œå¯ç”¨äºç”Ÿæˆã€æè¿°ã€è°ƒç”¨å’Œå¯è§†åŒ– RESTful é£æ ¼æ¥å£çš„APIï¼Œæ˜¯ä¸€å¥—è§„èŒƒå’Œå®Œæ•´çš„å¼€å‘æ¡†æ¶ï¼Œå¹¶ä¸”èƒ½å¯¹æ¥å£è¿›è¡Œå•ç‹¬æµ‹è¯•ã€‚</p><p>å¦å¤–ï¼Œ <a href="https://github.com/swagger-api">Swagger</a> åœ¨ Github ä¸Šé¢æ˜¯å¼€æºçš„ã€‚</p><p>æ— è®ºå¯¹äºåç«¯å¼€å‘ï¼Œè¿˜æ˜¯å‰ç«¯å¼€å‘ä»¥åŠæµ‹è¯•åŒäº‹ï¼ŒSwagger éƒ½å¯ä»¥åŸºæœ¬æ»¡è¶³ä½¿ç”¨éœ€æ±‚ã€‚</p><p>åœ¨ SpringBoot ä¸­é›†æˆ Swaggerï¼Œåç«¯åŒäº‹å†™å®Œæ¥å£å°±å¯ä»¥è‡ªåŠ¨ç”ŸæˆAPIæ–‡æ¡£ï¼Œå¯ä»¥ç»™åˆ°å‰ç«¯åŒäº‹çœ‹ï¼Œæµ‹è¯•åŒäº‹å¯ä»¥ç›´æ¥æµ‹è¯•è¯¥æ¥å£ã€‚</p><p>åœ¨æœ¬ç¯‡ä¸­ï¼Œè·Ÿå¤§å®¶åˆ†äº«å¦‚ä¸‹å†…å®¹ï¼š</p><p>1ã€åœ¨ SpringBoot ä¸­é¡¹ç›®å¦‚ä½•é›†æˆ Swaggerï¼Ÿ</p><p>2ã€å¦‚ä½•ä½¿ç”¨ Swaggerï¼Œå¦‚ä½•åœ¨ä¸åŒçš„ç¯å¢ƒä¸­å¼€å¯å’Œå…³é—­ Swaggerï¼Ÿ</p><p>3ã€å¦‚ä½•å°†åŒç±»çš„æ¥å£ä½¿ç”¨ Swagger æ³¨è§£è¿›è¡Œèšåˆï¼Ÿ</p><p>æ›´å¤šå…³äº SpringBoot çš„æ–‡ç« ï¼Œå¯ä»¥ç‚¹å‡» <a href="http://www.veryitman.com/2019/05/28/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%A1%B9%E7%9B%AE%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/">å¾®æœåŠ¡é¡¹ç›®ç³»åˆ—æ–‡ç« </a> äº†è§£ï¼Œå®Œæ•´ä»£ç ç¤ºä¾‹è¯·å‰å¾€ <a href="https://github.com/veryitman/MSTutorial">Github</a> æŸ¥çœ‹ã€‚</p><h2 id="é›†æˆ-Swagger"><a href="#é›†æˆ-Swagger" class="headerlink" title="é›†æˆ Swagger"></a>é›†æˆ Swagger</h2><p>åœ¨ <a href="https://mvnrepository.com/">MavenEwpository</a> æœç´¢ <code>Springfox</code>ï¼Œå¯ä»¥æ‰¾åˆ° <code>Swagger2</code> å’Œ <code>Swagger UI</code>ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src="/upload/images/2019/09/22/1.png" alt="1568529858131"></p><p>æˆªæ­¢åˆ°ç›®å‰ï¼Œ <code>Swagger2</code> å’Œ <code>Swagger UI</code> æœ€æ–°ç‰ˆæœ¬æ˜¯ <code>2.9.2</code> ç‰ˆæœ¬ã€‚</p><p>ä¿®æ”¹å·¥ç¨‹çš„pomæ–‡ä»¶ï¼Œå¢åŠ  <code>Swagger2</code> å’Œ <code>Swagger UI</code> çš„ä¾èµ–ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--swagger--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å› ä¸ºæˆ‘çš„é¡¹ç›®å·²ç»é›†æˆäº† <code>starter-web</code>ï¼Œå¦‚ä¸‹ pom æ–‡ä»¶ä¸­çš„ dependencyï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·é»˜è®¤ä¼šé›†æˆ <code>com.fasterxml.jackson.core:</code> ç›¸å…³çš„åº“ï¼Œä¸éœ€è¦é¢å¤–å†å»é›†æˆ <code>jackson-databind</code> äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2019/09/22/2.png" alt="1568529858131"></p><p>å¦åˆ™ä½ éœ€è¦å•ç‹¬å¢åŠ  <code>jackson-databind</code> çš„ä¾èµ–ï¼ŒåŒæ ·çš„é“ç†ä½ å¯ä»¥åœ¨  <a href="https://mvnrepository.com/">MavenEwpository</a> æœç´¢ <code>jackson-databind</code> é€‰æ‹©åˆé€‚çš„ç‰ˆæœ¬å³å¯ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å·¥ç¨‹å·²ç»é›†æˆäº† <code>Swagger</code>ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ã€‚</p><h2 id="ä½¿ç”¨-Swagger"><a href="#ä½¿ç”¨-Swagger" class="headerlink" title="ä½¿ç”¨ Swagger"></a>ä½¿ç”¨ Swagger</h2><h4 id="1ã€åˆ›å»ºSwaggeré…ç½®"><a href="#1ã€åˆ›å»ºSwaggeré…ç½®" class="headerlink" title="1ã€åˆ›å»ºSwaggeré…ç½®"></a>1ã€åˆ›å»ºSwaggeré…ç½®</h4><p>æ–°å»ºä¸€ä¸ªé…ç½®ç±» <code>MSSwaggerConfig</code>ï¼Œè¯¥æ–‡ä»¶åç§°å’Œä½ç½®ä½ å¯ä»¥æ”¾åˆ°ä½ çš„å·¥ç¨‹çš„ä»»æ„ç›®å½•ï¼Œæ ¹æ®è‡ªå·±çš„é¡¹ç›®ç›®å½•æ¥æ”¾ç½®å³å¯ã€‚</p><p><code>MSSwaggerConfig</code> ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSSwaggerConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Docket <span class="title function_">msblogDocket</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Docket</span> <span class="variable">docket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Docket</span>(DocumentationType.SWAGGER_2);</span><br><span class="line"><span class="type">String</span> <span class="variable">pkgName</span> <span class="operator">=</span> <span class="string">&quot;com.veryitman.springboot.controller&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> docket.apiInfo(msblogAPIInfo()).select()</span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(pkgName))</span><br><span class="line">                .paths(PathSelectors.any())</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ApiInfo <span class="title function_">msblogAPIInfo</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ApiInfoBuilder</span> <span class="variable">apiInfoBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ApiInfoBuilder</span>();</span><br><span class="line">        <span class="type">String</span> <span class="variable">apiTitle</span> <span class="operator">=</span> <span class="string">&quot;MSBlog Server API&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">apiDes</span> <span class="operator">=</span> <span class="string">&quot;API for MSBlog&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">apiVersion</span> <span class="operator">=</span> <span class="string">&quot;1.0.0&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">homePage</span> <span class="operator">=</span> <span class="string">&quot;http://veryitman.com&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">emailUrl</span> <span class="operator">=</span> <span class="string">&quot;veryitman@126.com&quot;</span>;</span><br><span class="line">        <span class="type">Contact</span> <span class="variable">contact</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Contact</span>(<span class="string">&quot;itman&quot;</span>, homePage, emailUrl);</span><br><span class="line">        <span class="keyword">return</span> apiInfoBuilder.title(apiTitle).description(apiDes)</span><br><span class="line">                .version(apiVersion)</span><br><span class="line">                .contact(contact)</span><br><span class="line">                .license(<span class="string">&quot;Apache 2.0&quot;</span>)</span><br><span class="line">                .licenseUrl(<span class="string">&quot;http://www.apache.org/licenses/LICENSE-2.0.html&quot;</span>)</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®°å¾—æ·»åŠ  <code>@Configuration</code>ã€ <code>@EnableSwagger2</code> è¿™ä¸¤ä¸ªæ³¨è§£ã€‚</p><p>å¯¹äº <code>apis(RequestHandlerSelectors.basePackage(pkgName))</code> ç›®çš„æ˜¯åªæ‰«ææŒ‡å®šåŒ…åä¸‹é¢ Controller çš„ Swagger æ³¨è§£ï¼Œè¿™æ ·å°±ä¸ä¼šå»æ‰«æå…¶ä»–åŒ…ä¸‹é¢çš„ç±»äº†ã€‚</p><p>å¯¹äºè¿™ä¸ªé…ç½®ç±»ï¼Œä¸»è¦æ˜¯ç”¨æ¥ç”Ÿæˆä¸€äº›æ‘˜è¦ä¿¡æ¯ï¼Œå¦‚å›¾ï¼š</p><p><img src="/upload/images/2019/09/22/3.png" alt="1568529858131"></p><h4 id="2ã€æ³¨è§£-Controller"><a href="#2ã€æ³¨è§£-Controller" class="headerlink" title="2ã€æ³¨è§£ Controller"></a>2ã€æ³¨è§£ Controller</h4><p>åœ¨ <a href="http://www.veryitman.com/2019/09/15/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E7%AE%80%E5%8D%95%E7%9A%84%E7%94%A8%E6%88%B7%E5%90%8D%E6%B3%A8%E5%86%8C%E5%92%8C%E7%99%BB%E5%BD%95/">å¾®æœåŠ¡-ç®€å•çš„ç”¨æˆ·åæ³¨å†Œå’Œç™»å½•</a> ç»™å¤§å®¶åˆ†äº«äº†å¦‚ä½•å†™æ³¨å†Œå’Œç™»å½•çš„APIï¼Œä»Šå¤©è¿˜æ˜¯æ‹¿æ³¨å†Œçš„ä¾‹å­æ¥è¿›è¡Œ Swagger çš„æ¼”ç¤ºã€‚</p><p>ä¸‹é¢ä»£ç æ˜¯ç”¨æˆ·æ³¨å†Œçš„ç¤ºä¾‹ä»£ç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;signup&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSSignupController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@CrossOrigin(origins = &#123;&quot;*&quot;&#125;)</span></span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;/name&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;ç”¨æˆ·æ³¨å†Œ&quot;, httpMethod = &quot;POST&quot;, notes = &quot;ç”¨æˆ·åå’Œå¯†ç æ³¨å†Œ&quot;)</span></span><br><span class="line">    <span class="meta">@ApiImplicitParams(&#123;</span></span><br><span class="line"><span class="meta">        @ApiImplicitParam(name = &quot;username&quot;, value = &quot;æ³¨å†Œçš„ç”¨æˆ·å&quot;, required = true),</span></span><br><span class="line"><span class="meta">        @ApiImplicitParam(name = &quot;userpwd&quot;, value = &quot;æ³¨å†Œçš„å¯†ç &quot;, required = true)</span></span><br><span class="line"><span class="meta">    &#125;)</span></span><br><span class="line">    <span class="keyword">public</span> MSResponse <span class="title function_">signup</span><span class="params">(<span class="meta">@RequestParam(value = &quot;username&quot;)</span> String userName, <span class="meta">@RequestParam(value = &quot;userpwd&quot;)</span> String userPwd)</span> &#123;</span><br><span class="line">       <span class="comment">// çœç•¥</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„æ³¨è§£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;ç”¨æˆ·æ³¨å†Œ&quot;, httpMethod = &quot;POST&quot;, notes = &quot;ç”¨æˆ·åå’Œå¯†ç æ³¨å†Œ&quot;)</span></span><br><span class="line"><span class="meta">@ApiImplicitParams(&#123;</span></span><br><span class="line"><span class="meta">    @ApiImplicitParam(name = &quot;username&quot;, value = &quot;æ³¨å†Œçš„ç”¨æˆ·å&quot;, required = true),</span></span><br><span class="line"><span class="meta">    @ApiImplicitParam(name = &quot;userpwd&quot;, value = &quot;æ³¨å†Œçš„å¯†ç &quot;, required = true)</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br></pre></td></tr></table></figure><p>è¿™äº›æ³¨è§£å°±æ˜¯ Swagger çš„æ³¨è§£ï¼Œ<code>@ApiOperation</code> è¯´æ˜äº†è¯¥æ¥å£çš„ç”¨é€”ï¼Œ<code>@ApiImplicitParams</code> ä¸­æœ‰ä¸¤ä¸ª <code>@ApiImplicitParam</code> ç”¨æ¥å¯¹æ¥å£çš„å‚æ•°è¿›è¡Œè¯´æ˜ã€‚</p><p>å¦‚æœæ¥å£åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ <code>@ApiImplicitParam</code> æ³¨è§£å³å¯ã€‚</p><h4 id="3ã€åœ¨çº¿æ–‡æ¡£"><a href="#3ã€åœ¨çº¿æ–‡æ¡£" class="headerlink" title="3ã€åœ¨çº¿æ–‡æ¡£"></a>3ã€åœ¨çº¿æ–‡æ¡£</h4><p>é…ç½®å®Œæˆä¹‹åï¼Œå¯ä»¥å¯åŠ¨ SpringBoot é¡¹ç›®ï¼Œåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ä¸‹é¢åœ°å€ï¼Œå°±å¯ä»¥çœ‹åˆ°ç”Ÿæˆçš„åœ¨çº¿æ–‡æ¡£äº†ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/swagger-ui.html#/</span><br></pre></td></tr></table></figure><p><img src="/upload/images/2019/09/22/4.png" alt="1568529858131"></p><p>ç‚¹å‡»å¯¹åº”çš„ Controller å°±å¯ä»¥çœ‹åˆ°å¯¹åº”æ¥å£çš„è¯¦ç»†è¯´æ˜äº†ï¼Œå¹¶ä¸”è¿˜å¯ä»¥å¯¹æ¥å£è¿›è¡Œæµ‹è¯•ã€‚</p><h2 id="åˆ†ç¯å¢ƒå¼€å¯-Swagger"><a href="#åˆ†ç¯å¢ƒå¼€å¯-Swagger" class="headerlink" title="åˆ†ç¯å¢ƒå¼€å¯ Swagger"></a>åˆ†ç¯å¢ƒå¼€å¯ Swagger</h2><p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬åªä¼šåœ¨å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒä½¿èƒ½ Swaggerï¼Œåœ¨æ²™ç›’å’Œç”Ÿæˆç¯å¢ƒä¼šå…³é—­ Swaggerï¼Œé‚£å¦‚ä½•æ§åˆ¶å‘¢ï¼Ÿ</p><p>åœ¨å·¥ç¨‹çš„ <code>Resources</code> ç›®å½•ä¸‹é¢ï¼Œæ–°å»ºå‡ ä¸ªè·Ÿç¯å¢ƒç›¸å…³çš„ properties æ–‡ä»¶ã€‚</p><p>è¿™äº›æ–‡ä»¶çš„å‘½ä»¤è¦æ»¡è¶³ <code>application-&#123;profile&#125;.properties</code> çš„æ ¼å¼ï¼Œå…¶ä¸­ <code>&#123;profile&#125;</code> ä½ å¯ä»¥è‡ªå®šä¹‰åå­—ï¼Œå¦‚ä¸‹æˆ‘è‡ªå®šä¹‰äº†4ä¸ªç¯å¢ƒï¼Œåˆ†åˆ«æ˜¯å¼€å‘ã€ç”Ÿäº§ã€æ²™ç›’å’Œæµ‹è¯•ç¯å¢ƒã€‚</p><p><img src="/upload/images/2019/09/22/5.png" alt="1568529858131"></p><p>æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ <code>application-&#123;profile&#125;.properties</code> ä¸­é…ç½®çš„é€‰é¡¹ä¸åœ¨  <code>application.properties</code> ä¸­é…ç½®çš„é€‰é¡¹å¦‚æœåç§°ç›¸åŒï¼Œä¼˜å…ˆä¼šä½¿ç”¨  <code>application-&#123;profile&#125;.properties</code> ä¸­é…ç½®ã€‚</p><p>åœ¨  <code>application.properties</code> ä¸­é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># é…ç½®ä½¿ç”¨å“ªä¸ªç¯å¢ƒ</span><br><span class="line">spring.profiles.active=dev</span><br><span class="line"># é»˜è®¤ä¸å¯ç”¨ swagger</span><br><span class="line">swagger.enable=<span class="literal">false</span></span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„åœ¨ <code>application-dev.properties</code> å’Œ <code>application-test.properties</code> ä¸­å¼€å¯ swaggerï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># å¯ç”¨ swagger</span><br><span class="line">swagger.enable=<span class="literal">true</span></span><br></pre></td></tr></table></figure><p>é€‰é¡¹é…ç½®å®Œæˆåï¼Œæˆ‘ä»¬åœ¨ä»£ç ä¸­ä½¿ç”¨è¯¥é€‰é¡¹ï¼Œä¿®æ”¹ <code>MSSwaggerConfig</code> å¦‚ä¸‹(åªåˆ—å‡ºäº†ä¿®æ”¹éƒ¨åˆ†çš„å…³é”®ä»£ç )ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSSwaggerConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;swagger.enable&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> enableSwagger;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Docket <span class="title function_">msblogDocket</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Docket</span> <span class="variable">docket</span> <span class="operator">=</span> </span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Docket</span>(DocumentationType.SWAGGER_2).enable(enableSwagger);</span><br><span class="line"><span class="type">String</span> <span class="variable">pkgName</span> <span class="operator">=</span> <span class="string">&quot;com.veryitman.springboot.controller&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> docket.apiInfo(msblogAPIInfo())</span><br><span class="line">                .select()</span><br><span class="line">                <span class="comment">// åªæ‰«ææŒ‡å®šåŒ…åä¸‹é¢çš„Controllerä¸­çš„Swaggeræ³¨è§£</span></span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(pkgName))</span><br><span class="line">                .paths(PathSelectors.any())</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸‹é¢çš„ä»£ç ä¸­è¯»å–é…ç½®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Value(&quot;$&#123;swagger.enable&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> enableSwagger;</span><br></pre></td></tr></table></figure><p>ç„¶åè°ƒç”¨ Docket çš„ <code>enable(enableSwagger)</code> æ–¹æ³•æ¥å†³å®šæ˜¯å¦å¼€å¯ Swaggerï¼Œå¦‚æœé…ç½®ä¸å¼€å¯ï¼Œæ•ˆæœå›¾å¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/09/22/6.png" alt="1568529858131"></p><p>è¿˜æœ‰å…¶ä»–æ–¹å¼æ¥æ§åˆ¶åœ¨ä¸åŒç¯å¢ƒä¸‹é…ç½® Swagger æ˜¯å¦å¼€å¯ï¼Œæ¯”å¦‚å¯ä»¥ç»“åˆæ³¨è§£ <code>@Profile</code> é€šè¿‡ä¸åŒçš„ profile ç»™ Swagger çš„ä¾èµ–è®¾ç½®ä¸åŒçš„ scopeï¼Œè¿˜å¯ä»¥ä½¿ç”¨æ³¨è§£ <code>@ConditionalOnProperty(name = &quot;swagger.enable&quot;, havingValue = &quot;true&quot;)</code>ï¼Œå¤§å®¶è‡ªè¡Œé€‰æ‹©é€‚åˆè‡ªå·±é¡¹ç›®çš„æ–¹æ¡ˆå³å¯ï¼Œç›®çš„éƒ½æ˜¯ä¸€æ ·ã€‚</p><h2 id="èšåˆæ¥å£"><a href="#èšåˆæ¥å£" class="headerlink" title="èšåˆæ¥å£"></a>èšåˆæ¥å£</h2><p>åœ¨ä¸Šé¢å®ä¾‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç™»å½•å’Œæ³¨å†Œéƒ½å±äºç”¨æˆ·æ¨¡å—ï¼Œä½¿ç”¨æ³¨è§£ <code>@API</code> å¯ä»¥èšåˆæ˜¾ç¤ºè¿™äº›æ¥å£ã€‚</p><p>åœ¨ç™»å½•å’Œæ³¨å†Œçš„ Controller ä¸­å¯ä»¥æ·»åŠ ä¸‹é¢æ³¨è§£ï¼Œä»è€Œæ¥èšåˆæ˜¾ç¤ºæ¥å£ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Api(value=&quot;xxx&quot;, tags=&quot;ç”¨æˆ·æ¨¡å—&quot;)</span></span><br></pre></td></tr></table></figure><p>æ³¨å†Œ Controller æ·»åŠ æ³¨è§£ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Api(value=&quot;signup&quot;, tags=&quot;ç”¨æˆ·æ¨¡å—&quot;)</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;signup&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSSignupController</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç™»å½• Controller æ·»åŠ æ³¨è§£ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Api(value=&quot;signin&quot;, tags=&quot;ç”¨æˆ·æ¨¡å—&quot;)</span><br><span class="line">@RestController</span><br><span class="line">@RequestMapping(value = &quot;signin&quot;)</span><br><span class="line">public class MSSigninController &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/09/22/7.png" alt="1568529858131"></p><hr><p><strong>ä½ çœ¼ç›çœ‹åˆ°çš„ä¸ä¸€å®šæ˜¯äº‹å®çš„å…¨éƒ¨~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot Swagger doc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡: ç®€å•çš„ç”¨æˆ·åæ³¨å†Œå’Œç™»å½•</title>
      <link href="/2019/09/15/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E7%AE%80%E5%8D%95%E7%9A%84%E7%94%A8%E6%88%B7%E5%90%8D%E6%B3%A8%E5%86%8C%E5%92%8C%E7%99%BB%E5%BD%95/"/>
      <url>/2019/09/15/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E7%AE%80%E5%8D%95%E7%9A%84%E7%94%A8%E6%88%B7%E5%90%8D%E6%B3%A8%E5%86%8C%E5%92%8C%E7%99%BB%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h2 id="å†…å®¹æ¦‚è¦"><a href="#å†…å®¹æ¦‚è¦" class="headerlink" title="å†…å®¹æ¦‚è¦"></a>å†…å®¹æ¦‚è¦</h2><p>åœ¨æœ¬ç¯‡ä¸­æˆ‘ä»¬è¦å®Œæˆä¸€ä¸ªç›®æ ‡ï¼š<strong>æä¾›æ³¨å†Œã€ç™»å½•çš„æ¥å£ç»™å‰ç«¯æˆ–è€…å®¢æˆ·ç«¯æ¥ä½¿ç”¨</strong>ã€‚</p><p>æ¶‰åŠåˆ°çš„å†…å®¹ä¸»è¦æœ‰ä¸‹é¢å‡ ä¸ªï¼š</p><p><strong>1ã€</strong>SpringBoot ä¸­å¸¸ç”¨çš„æ³¨è§£å¦‚ä½•ä½¿ç”¨ï¼Ÿ</p><p><strong>2ã€</strong> å¦‚ä½•å¯¹æ¥å£è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Ÿ</p><p>å…¶ä»–ç›¸å…³çš„å¾®æœåŠ¡æ–‡ç« ï¼Œå¯ä»¥ç‚¹å‡» <a href="http://www.veryitman.com/2019/05/28/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%A1%B9%E7%9B%AE%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/">å¾®æœåŠ¡é¡¹ç›®ç³»åˆ—æ–‡ç« </a> äº†è§£ã€‚</p><h2 id="å¸¸ç”¨æ³¨è§£"><a href="#å¸¸ç”¨æ³¨è§£" class="headerlink" title="å¸¸ç”¨æ³¨è§£"></a>å¸¸ç”¨æ³¨è§£</h2><p>æ§åˆ¶å™¨ <code>Controller</code> æ˜¯ Spring ä¸­æœ€åŸºæœ¬çš„ç»„ä»¶ï¼Œä¸»è¦æ˜¯å¤„ç†è·Ÿç”¨æˆ·äº¤äº’çš„ï¼Œä¸€èˆ¬æ¯ä¸ªä¸šåŠ¡é€»è¾‘éƒ½ä¼šæœ‰ä¸€ä¸ª <code>Controller</code>ï¼Œæä¾› HTTP è¯·æ±‚æ¥å£ï¼Œç”¨æˆ·è¯·æ±‚æ¥å£è¿›è¡Œæ•°æ®è®¿é—®ã€‚</p><p>è·Ÿ Controller ç›¸å…³çš„å‡ ä¸ªæ³¨è§£ä¸»è¦æœ‰ <code>@Controller</code>ï¼Œ<code>@RestController</code>ï¼Œ<code>@RequestMapping</code>ï¼Œ<code>@PathVariable</code>ï¼Œ<code>@RequestParam</code>ï¼Œ<code>@GetMapping</code> ç­‰ã€‚</p><ul><li><code>@Controller</code>ï¼šæ ‡æ³¨ <code>Controller</code> ç±»ï¼Œå¤„ç†  HTTP è¯·æ±‚ã€‚</li><li><code>@RestController</code>ï¼šæ ‡æ³¨ <code>Controller</code> ç±»ï¼ŒSpring 4 æ–°åŠ æ³¨è§£ï¼Œç›¸å½“äº <code>@Controller</code> + <code>@ResponseBody</code> ï¼Œä¸»è¦æ˜¯ä¸ºäº†ä½¿  HTTP è¯·æ±‚è¿”å›æ•°æ®æ ¼å¼ä¸º <code>json</code> æ ¼å¼ï¼Œæ­£å¸¸æƒ…å†µä¸‹éƒ½æ˜¯ä½¿ç”¨è¿™ä¸ªæ³¨è§£ã€‚</li><li><code>@RequestMapping</code>ï¼šé…ç½® URL æ˜ å°„ï¼Œå³è¯·æ±‚çš„åœ°å€ã€‚</li><li><code>@PathVariable</code>ï¼Œ<code>@RequestParam</code> ï¼Œ<code>@QueryParam</code> ï¼Œ<code>@PathParam</code> æ³¨è§£ï¼Œå¯ä»¥å‚è€ƒ <a href="http://www.veryitman.com/2019/08/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E5%AD%A6%E4%B9%A0%E5%87%A0%E4%B8%AA%E5%AE%B9%E6%98%93%E6%B7%B7%E6%B7%86%E7%9A%84URL%E6%B3%A8%E8%A7%A3/">å¾®æœåŠ¡: å­¦ä¹ å‡ ä¸ªå®¹æ˜“æ··æ·†çš„URLæ³¨è§£</a> è¿™ç¯‡æ–‡ç« ã€‚</li><li><code>@GetMapping</code>ï¼Œ<code>@PostMapping</code>ï¼Œ<code>@PutMapping</code> ç§°ä¹‹ä¸ºç»„åˆæ³¨è§£ï¼Œå®ƒä»¬ç­‰ä»·äº <code>@RequestMapping</code> å•ç‹¬æŒ‡å®šæ˜ å°„å†æŒ‡å®šè¯·æ±‚æ–¹æ³•ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚ä¸‹:</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/signup/name&quot;, method = RequestMethod.POST)</span></span><br></pre></td></tr></table></figure><p>ç­‰ä»·äºä¸‹é¢çš„æ³¨è§£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(value = &quot;/signup/name&quot;)</span></span><br></pre></td></tr></table></figure><h2 id="ç¼–å†™å®ä½“"><a href="#ç¼–å†™å®ä½“" class="headerlink" title="ç¼–å†™å®ä½“"></a>ç¼–å†™å®ä½“</h2><p>ä¸ç®¡æ˜¯ç™»å½•è¿˜æ˜¯æ³¨å†Œï¼Œéƒ½æ˜¯æ¯ä¸ªç”¨æˆ·è¿›è¡Œçš„æ“ä½œï¼Œæˆ‘ä»¬å…ˆå®šä¹‰ç”¨æˆ·å®ä½“ç±» <code>MSUser</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSUser</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String userID;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è´¦å·åç§°ï¼Œç”¨äºç™»å½•ï¼Œä¸å¯ä»¥ä¿®æ”¹</span></span><br><span class="line">    <span class="keyword">private</span> String accountName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è´¦å·å¯†ç </span></span><br><span class="line">    <span class="keyword">private</span> String accountPwd;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ˜µç§°é»˜è®¤å’ŒaccountNameä¸€è‡´ï¼Œå¯ä»¥ä¿®æ”¹</span></span><br><span class="line">    <span class="keyword">private</span> String nickName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer gender;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åº§å³é“­ï¼›æ ¼è¨€ï¼›ç®´è¨€</span></span><br><span class="line">    <span class="keyword">private</span> String motto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å®ä½“ç±»  <code>MSUser</code> ä¸­ï¼Œæˆ‘ä»¬ç”¨åˆ°äº†æ³¨è§£ <code>@Data</code> ï¼Œè¯¥æ³¨è§£æ¥æºäº <code>lombok</code>ï¼Œéœ€è¦è‡ªå·±åœ¨IDEAä¸­å®‰è£…è¯¥æ’ä»¶ï¼Œå®‰è£…æ–¹æ³•è¯·å¤§å®¶è‡ªè¡Œæœç´¢è§£å†³ã€‚</p><p>æ³¨è§£ <code>@Data</code> ç›¸å½“äºç»™æˆ‘ä»¬è‡ªåŠ¨å®ç°äº† <code>Get</code> ã€<code>Setter</code>ã€<code>toString</code>ã€ <code>equals</code> å’Œ <code>hashCode</code> æ–¹æ³•ä»¥åŠæ„é€ æ–¹æ³•ï¼Œä¸éœ€è¦æˆ‘ä»¬è‡ªå·±å†å»å†™è¿™äº›ä»£ç ã€‚</p><p>HTTP çš„è¯·æ±‚å“åº”ç»“æœï¼Œä¹Ÿå¯ä»¥è¢«å°è£…ä¸ºå®ä½“ç±»ï¼Œå¦‚ä¸‹ <code>MSResponse</code> å°±æ˜¯ç”¨æ¥æ‰¿è½½HTTPè¿”å›çš„å“åº”ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSResponse</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> code;</span><br><span class="line">    <span class="keyword">private</span> String msg;</span><br><span class="line">    <span class="keyword">private</span> T results;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¼–å†™æ¥å£"><a href="#ç¼–å†™æ¥å£" class="headerlink" title="ç¼–å†™æ¥å£"></a>ç¼–å†™æ¥å£</h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œç”¨æˆ·æ³¨å†Œéœ€è¦å°†ç”¨æˆ·çš„ä¿¡æ¯å­˜ä¸‹æ¥ï¼Œå­˜åˆ°æ•°æ®åº“ä¸­æ–¹ä¾¿åç»­ä½¿ç”¨è¿™ä»½æ•°æ®ï¼Œè¿™ä¸ªè¡Œä¸ºç§°ä¹‹ä¸º <code>æ•°æ®æŒä¹…åŒ–</code> ï¼Œç°åœ¨æˆ‘ä»¬ä¸åšè¿™ä¸ªæ“ä½œï¼Œåªæ˜¯çº¯ç²¹çš„æä¾›æ¥å£è®©ç”¨æˆ·å¯ä»¥æ³¨å†Œã€ç™»å½•æˆ‘ä»¬çš„ç³»ç»Ÿï¼Œåç»­å†æ¥è€ƒè™‘å’Œå®ç°æ•°æ®æŒä¹…åŒ–ã€‚</p><p>è¿™ä¸ªé˜¶æ®µæ³¨å†ŒåŠŸèƒ½åªæä¾› <code>ç”¨æˆ·å+å¯†ç </code> çš„æ–¹å¼ï¼Œè¯¥è¯·æ±‚æ˜¯ä¸ª <code>POST</code> è¯·æ±‚ï¼Œä¸»è¦æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;signup&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSSignupController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@CrossOrigin(origins = &#123;&quot;*&quot;&#125;)</span></span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;/name&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> MSResponse <span class="title function_">signup</span><span class="params">(<span class="meta">@RequestParam(value = &quot;username&quot;)</span> String userName, <span class="meta">@RequestParam(value = &quot;userpwd&quot;)</span> String userPwd)</span> &#123;</span><br><span class="line">        <span class="type">MSResponse</span> <span class="variable">response</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MSResponse</span>();</span><br><span class="line">        <span class="type">MSUser</span> <span class="variable">user</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == userName || <span class="literal">null</span> == userPwd || userName.length() &lt;= <span class="number">0</span> || userPwd.length() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">MSResponseEnum</span> <span class="variable">signupError</span> <span class="operator">=</span> MSResponseEnum.SignupInvalidInfo;</span><br><span class="line">            response.setMsg(signupError.getMsg());</span><br><span class="line">            response.setCode(signupError.getCode());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            response.setCode(MSResponseEnum.SUCCESS.getCode());</span><br><span class="line">            response.setMsg(MSResponseEnum.SUCCESS.getMsg());</span><br><span class="line">            user = MSUserUtil.createUser(userName, userPwd);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        response.setResults(user);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> response;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒç†ï¼Œç™»å½•åŠŸèƒ½ä¹Ÿåªæä¾› <code>ç”¨æˆ·å+å¯†ç </code> çš„æ–¹å¼ï¼Œè¯¥è¯·æ±‚æ˜¯ä¸ª <code>GET</code> è¯·æ±‚ï¼Œä¸»è¦æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;signin&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSSigninController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@CrossOrigin(origins = &#123;&quot;*&quot;, &quot;http://localhost:8082&quot;&#125;)</span></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/name&quot;, method = RequestMethod.GET)</span></span><br><span class="line">    <span class="keyword">public</span> MSResponse <span class="title function_">sigin</span><span class="params">(<span class="meta">@RequestParam(value = &quot;username&quot;)</span> String userName, <span class="meta">@RequestParam(value = &quot;userpwd&quot;)</span> String userPwd)</span> &#123;</span><br><span class="line">        <span class="type">MSResponse</span> <span class="variable">response</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MSResponse</span>();</span><br><span class="line">        <span class="type">MSUser</span> <span class="variable">user</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == userName || <span class="literal">null</span> == userPwd || userName.length() &lt;= <span class="number">0</span> || userPwd.length() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">MSResponseEnum</span> <span class="variable">responseEnum</span> <span class="operator">=</span> MSResponseEnum.Login4SiginInvalidInfo;</span><br><span class="line">            response.setCode(responseEnum.getCode());</span><br><span class="line">            response.setMsg(responseEnum.getMsg());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            user = MSUserUtil.createUser(userName, userPwd);</span><br><span class="line">            <span class="type">MSResponseEnum</span> <span class="variable">rspEnum</span> <span class="operator">=</span> MSResponseEnum.SUCCESS;</span><br><span class="line">            response.setCode(rspEnum.getCode());</span><br><span class="line">            response.setMsg(rspEnum.getMsg());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        response.setResults(user);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> response;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h2><p>åœ¨ IDEA ä¸­æ–°å»º SpringBoot å·¥ç¨‹åï¼Œé»˜è®¤å°±ä¼šåˆ›å»ºä¸€ä¸ªæµ‹è¯•ç›®å½•ã€‚</p><p>å³ <code>test</code> ç›®å½•ä¸‹ä¼šæœ‰ <code>SpringbootApplicationTests</code> ç±»æ–‡ä»¶ï¼Œå…¶ä¸­ pom æ–‡ä»¶ä¸­å·²ç»æ·»åŠ å¥½äº† <code>spring-boot-starter-test</code> å¯åŠ¨å™¨ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>springbootï¼test</code> åŒ…ä¸­å·²ç»åŒ…æ‹¬äº† <code>junit</code> å’Œ <code>mockito</code> ç±»åº“ï¼Œä¸éœ€è¦æˆ‘ä»¬é¢å¤–å†å»æ·»åŠ è¿™äº›åº“ã€‚</p><p>å€ŸåŠ©äº <code>MockMvc</code> æˆ‘ä»¬å¯ä»¥å¯¹æ¥å£è¿›è¡Œç®€å•çš„å•å…ƒæµ‹è¯•äº†ã€‚ä¸»è¦çš„æµ‹è¯•æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="meta">@AutoConfigureMockMvc</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringbootApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MockMvc mvc;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* ç™»å½•çš„æ¥å£æµ‹è¯•ï¼ŒGET è¯·æ±‚ */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">signinTest</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//ç›´æ¥å†™æ¥å£çš„æ˜ å°„åœ°å€å°±å¯ä»¥äº†ï¼Œä¸éœ€è¦å†™hostå’Œport</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;/signin/name?username=itman&amp;userpwd=123&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">MvcResult</span> <span class="variable">mvcResult</span> <span class="operator">=</span> mvc.perform(MockMvcRequestBuilders.get(url)</span><br><span class="line">                .accept(MediaType.APPLICATION_JSON)) <span class="comment">//æ–­è¨€è¿”å›ç»“æœæ˜¯json</span></span><br><span class="line">                .andReturn();</span><br><span class="line"></span><br><span class="line">        <span class="type">MockHttpServletResponse</span> <span class="variable">response</span> <span class="operator">=</span> mvcResult.getResponse();</span><br><span class="line">        <span class="comment">//HTTPå“åº”çš„è¿”å›ç </span></span><br><span class="line">        <span class="type">int</span> <span class="variable">status</span> <span class="operator">=</span> response.getStatus();</span><br><span class="line">        <span class="comment">//HTTPå“åº”çš„å†…å®¹</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">contentAsString</span> <span class="operator">=</span> response.getContentAsString();</span><br><span class="line"></span><br><span class="line">        System.err.println(status);</span><br><span class="line">        System.err.println(contentAsString);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æ³¨å†Œçš„æ¥å£æµ‹è¯•ï¼ŒPOST è¯·æ±‚ */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">signupTest</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;/signup/name&quot;</span>;</span><br><span class="line">        <span class="type">MvcResult</span> <span class="variable">mvcResult</span> <span class="operator">=</span> mvc.perform(MockMvcRequestBuilders.post(url)</span><br><span class="line">                .accept(MediaType.APPLICATION_JSON)</span><br><span class="line">                .param(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;itman&quot;</span>)</span><br><span class="line">                .param(<span class="string">&quot;userpwd&quot;</span>, <span class="string">&quot;123567&quot;</span>))</span><br><span class="line">                .andReturn();</span><br><span class="line">        <span class="type">MockHttpServletResponse</span> <span class="variable">response</span> <span class="operator">=</span> mvcResult.getResponse();</span><br><span class="line">        <span class="type">int</span> <span class="variable">status</span> <span class="operator">=</span> response.getStatus();</span><br><span class="line">        <span class="type">String</span> <span class="variable">contentAsString</span> <span class="operator">=</span> response.getContentAsString();</span><br><span class="line">        System.err.println(status);</span><br><span class="line">        System.err.println(contentAsString);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢ç¼–å†™çš„æµ‹è¯•ä»£ç ä¸­ï¼Œè§£é‡Šä¸€ä¸‹å‡ ä¸ªç”¨åˆ°çš„æ³¨è§£å’Œç±»ã€‚</p><p><strong>1ã€@RunWith(SpringRunner.class)</strong> ï¼Œ<code>SpringRunner</code> æ˜¯ <code>SpringJUnit4ClassRunner</code> çš„ç®€å†™ï¼Œç”¨äºæä¾›æµ‹è¯•æ—¶çš„ Spring åº”ç”¨ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p><p><strong>2ã€MockMvc</strong> ï¼Œ<code>MockMvc</code> æ˜¯æµ‹è¯• Spring MVC åº”ç”¨ç¨‹åºçš„ä¸»è¦å…¥å£ï¼Œä¸ºæˆ‘ä»¬çš„æµ‹è¯•æä¾›äº†ä¸€ä¸ªæ¨¡æ‹Ÿçš„åº”ç”¨ä¸Šä¸‹æ–‡çš„ç¯å¢ƒã€‚</p><p><strong>3ã€@Autowired</strong>ï¼Œå¯ä»¥å¯¹ç±»æˆå‘˜å˜é‡ã€æ–¹æ³•åŠæ„é€ å‡½æ•°è¿›è¡Œæ ‡æ³¨ï¼Œå®Œæˆè‡ªåŠ¨è£…é…ã€‚ä¸éœ€è¦æ‰‹åŠ¨åˆ›å»ºè¯¥å¯¹è±¡ï¼Œè¿™ä¸ªè·Ÿ Spring çš„ IOC æœºåˆ¶æœ‰å…³ã€‚</p><p>ä»£ç å†™å¥½ä¹‹åï¼Œå°±å¯ä»¥è¿›è¡Œå•å…ƒæµ‹è¯•äº†ï¼Œç›´æ¥åœ¨ <code>signinTest</code> æˆ–è€… <code>signupTest</code> å³é”®è¿è¡Œå³å¯ï¼Œä¸éœ€è¦å¯åŠ¨æ•´ä¸ªå·¥ç¨‹ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2019/09/15/1.png" alt="1568529858131"></p><p>è¿è¡Œä¹‹åï¼Œå¯ä»¥åœ¨è¾“å‡ºçš„æ§åˆ¶å°ä¸­çœ‹åˆ°ä¿¡æ¯ï¼š</p><p><img src="/upload/images/2019/09/15/2.png" alt="1568529940948"></p><h2 id="å‰ç«¯è¯·æ±‚"><a href="#å‰ç«¯è¯·æ±‚" class="headerlink" title="å‰ç«¯è¯·æ±‚"></a>å‰ç«¯è¯·æ±‚</h2><p>åœ¨ <a href="http://www.veryitman.com/2019/08/31/%E8%B7%A8%E5%9F%9F%E5%92%8COPTIONS%E8%BF%99%E5%AF%B9%E6%AC%A2%E5%96%9C%E5%86%A4%E5%AE%B6/">è·¨åŸŸå’ŒOPTIONSè¿™å¯¹æ¬¢å–œå†¤å®¶</a> å’Œ <a href="http://www.veryitman.com/2019/09/08/%E5%87%8F%E5%B0%91%E8%B7%A8%E5%9F%9F%E4%B8%AD%E7%9A%84OPTIONS%E8%AF%B7%E6%B1%82/">å‡å°‘è·¨åŸŸä¸­çš„OPTIONSè¯·æ±‚</a> è¿™ä¸¤ç¯‡æ–‡ç« ä¸­ï¼Œå·²ç»è·Ÿå¤§å®¶åˆ†äº«è¿‡å¦‚ä½•åœ¨å‰ç«¯é¡µé¢ä¸­è¿›è¡Œæ¥å£è®¿é—®äº†ï¼Œå…¶ä¸­ä¹Ÿé‡ç‚¹è®²è§£äº†å¦‚ä½•åœ¨ SpringBoot ä¸­è§£å†³è·¨åŸŸé—®é¢˜ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥å»çœ‹çœ‹è¿™ä¸¤ç¯‡æ–‡ç« ã€‚</p><p>æ–‡ä¸­çš„å®Œæ•´ç¤ºä¾‹ä»£ç éƒ½åœ¨ <a href="https://github.com/veryitman/MSTutorial">Github</a> ä¸Šé¢ï¼Œéœ€è¦çš„å¯ä»¥è‡ªè¡Œcloneï¼Œæ„Ÿè°¢æ‚¨çš„é˜…è¯»ã€‚</p><hr><p><strong>ä¸´æ¸Šç¾¡é±¼ä¸å¦‚æŒ‰é€€è€Œç»“ç½‘~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot å¾®æœåŠ¡ é¡¹ç›® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‡å°‘è·¨åŸŸä¸­çš„OPTIONSè¯·æ±‚</title>
      <link href="/2019/09/08/%E5%87%8F%E5%B0%91%E8%B7%A8%E5%9F%9F%E4%B8%AD%E7%9A%84OPTIONS%E8%AF%B7%E6%B1%82/"/>
      <url>/2019/09/08/%E5%87%8F%E5%B0%91%E8%B7%A8%E5%9F%9F%E4%B8%AD%E7%9A%84OPTIONS%E8%AF%B7%E6%B1%82/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>è¿™ç¯‡æ˜¯ç»§ <a href="http://www.veryitman.com/2019/08/31/%E8%B7%A8%E5%9F%9F%E5%92%8COPTIONS%E8%BF%99%E5%AF%B9%E6%AC%A2%E5%96%9C%E5%86%A4%E5%AE%B6/">è·¨åŸŸå’ŒOPTIONSè¿™å¯¹æ¬¢å–œå†¤å®¶</a> åçš„ä¸€ç¯‡æ–‡ç« ï¼Œåœ¨æœ¬ç¯‡ä¸­æˆ‘ä»¬ç»§ç»­æ¢ç´¢è·¨åŸŸä¸­çš„ OPTIONS è¯·æ±‚ï¼Œä¸»è¦åˆ†äº«ä¸€ä¸‹ï¼š</p><ul><li><p>SpringBoot ä¸­é™¤äº† <code>CrossOrigin</code> æ³¨è§£å¤–è¿˜æœ‰å“ªäº›æ–¹å¼å¯ä»¥è§£å†³è·¨åŸŸé—®é¢˜ï¼Ÿ</p></li><li><p>å¦‚ä½•ä½¿ç”¨ SpringBoot ç»“åˆ CORS å‡å°‘ OPTIONS è¯·æ±‚ï¼Ÿ</p></li></ul><p>é˜…è¯»ä¸‹é¢å†…å®¹ä¹‹å‰ï¼Œå¼ºçƒˆå»ºè®®å…ˆé˜…è¯»ä¹‹å‰çš„ <a href="http://www.veryitman.com/2019/08/31/%E8%B7%A8%E5%9F%9F%E5%92%8COPTIONS%E8%BF%99%E5%AF%B9%E6%AC%A2%E5%96%9C%E5%86%A4%E5%AE%B6/">è·¨åŸŸå’ŒOPTIONSè¿™å¯¹æ¬¢å–œå†¤å®¶</a> è¿™ç¯‡æ–‡ç« ã€‚</p><p>æ–‡ä¸­ä½¿ç”¨çš„ä»£ç éƒ½å¯ä»¥åœ¨ <a href="https://github.com/veryitman/MSTutorial">Github</a> æ‰¾åˆ°ï¼Œå¤§å®¶æ ¹æ®éœ€è¦è‡ªè¡Œé‡‡çº³ã€‚</p><h2 id="ç”¨ä¸Š-Nginx"><a href="#ç”¨ä¸Š-Nginx" class="headerlink" title="ç”¨ä¸Š Nginx"></a>ç”¨ä¸Š Nginx</h2><p>è¿™æ¬¡ä½¿ç”¨ Nginx ä½œä¸º Web å®¹å™¨ï¼Œåœ¨æœ¬åœ°å°†HTMLè·‘èµ·æ¥ï¼Œä¸Šæ¬¡æ˜¯åœ¨ Chrome ä¸­ç›´æ¥æ‰“å¼€ HTML æ–‡ä»¶çš„æ–¹å¼æ¥éªŒè¯è·¨åŸŸé—®é¢˜çš„ã€‚æˆ‘ä»¬çŸ¥é“åªè¦ç«¯å£ä¸åŒä¹Ÿä¼šé€ æˆè·¨åŸŸé—®é¢˜ï¼Œé‚£ä¹ˆåªéœ€è¦åœ¨ Nginx ä¸­é…ç½®ä¸€ä¸ªç«¯å£ä¸åŒäºæœåŠ¡ç«¯å£çš„è™šæ‹Ÿä¸»æœºå°±å¯ä»¥è¾¾åˆ°ç›®çš„äº†ã€‚</p><p>ç”±äºæˆ‘æ˜¯åœ¨ Win10 ä¸Šé¢åšçš„ä¾‹å­ï¼ŒåŒ…æ‹¬ Nginx ä¹Ÿæ˜¯ Windows ç‰ˆæœ¬çš„ï¼Œå¦‚æœæ²¡æœ‰å®‰è£…çš„å°ä¼™ä¼´è¯·å» <a href="http://nginx.org/">ä¸‹è½½Nginx</a> ç›´æ¥è§£å‹å³å¯ã€‚</p><p>æˆ‘æŠŠ Nginx è§£å‹æ”¾åˆ°ï¼š<code>D:\portable\nginx-1.15.12</code> è¿™ä¸ªç›®å½•ï¼Œä½ å¯ä»¥è§£å‹åˆ°ä½ è®¤ä¸ºæ¯”è¾ƒåˆé€‚çš„åœ°æ–¹ã€‚</p><p>æ‰“å¼€ Nginx çš„é…ç½®æ–‡ä»¶ <code>nginx.conf</code> å³åœ¨ <code>å®‰è£…ç›®å½•\conf</code> ä¸‹é¢ï¼Œå¢åŠ ä¸€ä¸ªè™šæ‹Ÿä¸»æœºé…ç½®é¡¹ï¼Œä¿®æ”¹å®Œæˆåä¿å­˜é…ç½®æ–‡ä»¶å³å¯ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è‡ªå®šä¹‰è™šæ‹Ÿä¸»æœºï¼Œå¯ä»¥åŒæ—¶é…ç½®å¤šä¸ªè™šæ‹Ÿä¸»æœº</span></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span>       <span class="number">8082</span>; <span class="comment"># ä¸åŒäºæœåŠ¡ç«¯å£</span></span><br><span class="line">    <span class="attribute">server_name</span>  localhost;</span><br><span class="line">        <span class="section">location</span> / &#123;</span><br><span class="line">            <span class="comment"># æ–‡ä»¶è·¯å¾„ï¼Œæ³¨æ„è·¯å¾„åˆ†éš”ç¬¦æ˜¯ `/` ä¸æ˜¯ `\`</span></span><br><span class="line">            <span class="attribute">root</span>   E:/examples/cors-options;</span><br><span class="line">            <span class="comment"># é»˜è®¤é¡µé¢</span></span><br><span class="line">            <span class="attribute">index</span>  index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong><code>E:/examples/cors-options;</code> æ˜¯æˆ‘çš„ HTML æ–‡ä»¶(<code>options.html</code> )è·¯å¾„ï¼Œä½ è¦æ ¹æ®è‡ªå·±å®é™…HTMLè·¯å¾„æ¥é…ç½®è¿™ä¸ªé€‰é¡¹ï¼Œå¦åˆ™åé¢æ— æ³•æ‰“å¼€è¯¥æ–‡ä»¶ã€‚</p><p>è¿™é‡Œæˆ‘æŠŠè¿™ä¸ªæ–‡ä»¶å‘½åä¸º <code>options.html</code>ï¼ŒHTMLæ–‡ä»¶å†…å®¹å¤§è‡´å¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>options-demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./jquery-3.4.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./jquery.json.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">getReq</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> url = <span class="string">&quot;http://localhost:8080/signin/name?username=jack&amp;userpwd=123&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">            $.<span class="title function_">ajax</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">url</span>: url,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">type</span>: <span class="string">&#x27;GET&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">dataType</span>: <span class="string">&#x27;json&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">contentType</span>: <span class="string">&#x27;application/json&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">headers</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">token</span>: <span class="string">&quot;yu7rX98xxxx_iii^ddd&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">userId</span>: <span class="number">123</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">openid</span>: <span class="number">231232</span></span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;).<span class="title function_">done</span>(<span class="keyword">function</span> (<span class="params">result</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;success&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span></span><br><span class="line"><span class="language-javascript">            &#125;).<span class="title function_">fail</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;error&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;)</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;getReq()&quot;</span>&gt;</span>ç”¨æˆ·åç™»å½•-GET<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨å¯åŠ¨ Nginxï¼Œå¯åŠ¨ Nginx å¾ˆç®€å•ï¼Œæ‰“å¼€ Windows ç»ˆç«¯æˆ–è€… Git çš„ç»ˆç«¯(å¦‚æœä½ å®‰è£…äº† Git çš„è¯ï¼Œå³ä½¿æ²¡æœ‰å®‰è£…æˆ‘ä¹Ÿå¼ºçƒˆå»ºè®®ä½ å®‰è£…ï¼Œå› ä¸ºå¤ªå¥½ç”¨äº†)ï¼Œç„¶å cdåˆ° Nginx çš„å®‰è£…ç›®å½•ã€‚</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">start</span> nginx.exe</span><br></pre></td></tr></table></figure><p>æ‰“å¼€ Chrome æµè§ˆå™¨ï¼Œè¾“å…¥ä¸‹é¢çš„ç½‘å€è¿›è¡Œè®¿é—®ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8082/options.html</span><br></pre></td></tr></table></figure><p>ä¸å‡ºæ„å¤–çš„è¯ï¼Œå¯ä»¥çœ‹åˆ°æ˜¾ç¤ºä¸€ä¸ªæŒ‰é’®çš„è§†å›¾ï¼Œé¡ºä¾¿æŠŠ Chrome çš„å®¡æŸ¥è§†å›¾(Ctrl+Shift+i)æ‰“å¼€ï¼Œå¤§æ¦‚æ˜¯ä¸‹é¢æˆªå›¾çš„æ ·å­ã€‚</p><p><img src="/upload/images/2019/09/08/1.png"></p><h2 id="æŒ‡å®šåŸŸååˆ—è¡¨"><a href="#æŒ‡å®šåŸŸååˆ—è¡¨" class="headerlink" title="æŒ‡å®šåŸŸååˆ—è¡¨"></a>æŒ‡å®šåŸŸååˆ—è¡¨</h2><p>Nginx é…ç½®å®Œæˆï¼Œæ–‡ä»¶ä¹Ÿå¯ä»¥æ­£å¸¸çš„æ‰“å¼€ï¼Œé‚£æˆ‘ä»¬å°±æ¥è¯•è¯•æ˜¯å¦è·Ÿé¢„æƒ³çš„ä¸€è‡´ï¼Ÿ</p><p>SpringBoot å…³é”®ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;signin&quot;)</span> <span class="comment">// æ³¨æ„è¿™é‡Œä¸è¦åœ¨signinå‰ååŠ &quot;/&quot;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSSigninController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/name&quot;, method = RequestMethod.GET)</span></span><br><span class="line">    <span class="keyword">public</span> MSResponse <span class="title function_">sigin</span><span class="params">(<span class="meta">@RequestParam(value = &quot;username&quot;)</span> String userName, <span class="meta">@RequestParam(value = &quot;userpwd&quot;)</span> String userPwd)</span> &#123;</span><br><span class="line">        <span class="comment">// çœç•¥</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯åŠ¨ SpringBoot æœåŠ¡ï¼ˆé»˜è®¤è¿è¡Œåœ¨8080ç«¯å£ä¸åŒäºç½‘é¡µè¿è¡Œç«¯å£8082ï¼‰å®Œæˆåï¼Œç‚¹å‡» Chrome è§†å›¾ä¸­çš„æŒ‰é’®è¿›è¡Œè¯·æ±‚ï¼Œæˆªå›¾å¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/09/08/2.png"></p><p>å¯ä»¥çœ‹åˆ°è·Ÿæˆ‘ä»¬é¢„æœŸä¸€è‡´ï¼Œçš„ç¡®é€ æˆäº†è·¨åŸŸè¯·æ±‚ï¼Œå¹¶ä¸”è¿›è¡Œäº† OPTIONS è¯·æ±‚ã€‚</p><p>åœ¨ SpringBoot çš„æŸä¸ªæ–¹æ³•ä¸Šé¢æ·»åŠ  <code>CrossOrigin</code> æ³¨è§£å¯ä»¥è§£å†³è·¨åŸŸé—®é¢˜ï¼Œå¹¶ä¸”å¯ä»¥æŒ‡å®šåŸŸååˆ—è¡¨ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSSigninController</span> &#123;</span><br><span class="line"><span class="comment">// æŒ‡å®šåŸŸååˆ—è¡¨</span></span><br><span class="line"><span class="meta">@CrossOrigin(origins = &#123;&quot;http://localhost:8082&quot;&#125;)</span></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/name&quot;, method = RequestMethod.GET)</span></span><br><span class="line">    <span class="keyword">public</span> MSResponse <span class="title function_">sigin</span><span class="params">(<span class="meta">@RequestParam(value = &quot;username&quot;)</span> String userName, <span class="meta">@RequestParam(value = &quot;userpwd&quot;)</span> String userPwd)</span> &#123;</span><br><span class="line">        <span class="comment">// çœç•¥</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡å¯æœåŠ¡åï¼Œå†å»éªŒè¯ä¸€ä¸‹å‘ç°è¯·æ±‚å°±å¯ä»¥é€šè¿‡äº†ã€‚</p><p><img src="/upload/images/2019/09/08/3.png"></p><p>å¦‚æœä½ æ„Ÿå…´è¶£ï¼Œå¯ä»¥ä¿®æ”¹ä¸€ä¸‹ <code>CrossOrigin</code> æ³¨è§£ä¸­çš„åŸŸååˆ—è¡¨ç«¯å£å·ï¼Œå†å»è¯·æ±‚å°±ä¼šå¤±è´¥ã€‚</p><p>ä½¿ç”¨  <code>CrossOrigin</code> æ³¨è§£æŒ‡å®šåŸŸååˆ—è¡¨ï¼Œå¯ä»¥ä»æ›´å°çš„ç²’åº¦ä¸Šé¢æ§åˆ¶è·¨åŸŸè¯·æ±‚ã€‚</p><p>é‚£ä¹ˆé™¤äº†ä½¿ç”¨  <code>CrossOrigin</code> æ³¨è§£æ„å¤–ï¼Œåœ¨ SpringBoot ä¸­è¿˜å¯ä»¥æ€æ ·è§£å†³è·¨åŸŸé—®é¢˜å‘¢ï¼Ÿ</p><h2 id="è§£å†³è·¨åŸŸçš„å…¶ä»–è®¡ç­–"><a href="#è§£å†³è·¨åŸŸçš„å…¶ä»–è®¡ç­–" class="headerlink" title="è§£å†³è·¨åŸŸçš„å…¶ä»–è®¡ç­–"></a>è§£å†³è·¨åŸŸçš„å…¶ä»–è®¡ç­–</h2><p>ç›®å‰é™¤äº†ä½¿ç”¨  <code>CrossOrigin</code> æ³¨è§£ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä¸‹é¢å‡ ç§æ–¹æ³•æ¥è§£å†³è·¨åŸŸé—®é¢˜ã€‚</p><h3 id="1ã€è‡ªå®šä¹‰Filter"><a href="#1ã€è‡ªå®šä¹‰Filter" class="headerlink" title="1ã€è‡ªå®šä¹‰Filter"></a>1ã€è‡ªå®šä¹‰Filter</h3><p>è‡ªå®šä¹‰ <code>Filter</code> å¯ä»¥è§£å†³è·¨åŸŸé—®é¢˜ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSCorsFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest req, ServletResponse res, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> (HttpServletRequest) req;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;OPTIONS&quot;</span>.equals(request.getMethod())) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;HTTP&#x27;s OPTIONS Coming&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">HttpServletResponse</span> <span class="variable">response</span> <span class="operator">=</span> (HttpServletResponse) res;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®¾ç½®æ‰€æœ‰çš„è¯·æ±‚åŸŸåéƒ½å¯ä»¥</span></span><br><span class="line">        response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®¾ç½®å…è®¸çš„è¯·æ±‚æ–¹æ³•</span></span><br><span class="line">        response.setHeader(<span class="string">&quot;Access-Control-Allow-Methods&quot;</span>, <span class="string">&quot;POST, GET, OPTIONS, DELETE&quot;</span>);</span><br><span class="line">        <span class="comment">// è®¾ç½®ç¼“å­˜æ—¶é—´å•ä½ä¸ºç§’ï¼Œåœ¨æ”¹æ—¶é—´å†…ä¸éœ€è¦å†å‘é€é¢„æ£€éªŒè¯·æ±‚ï¼Œå³ç¼“å­˜è¯¥ç»“æœ</span></span><br><span class="line">        <span class="comment">// è®¾ç½®ä¸º0å°±ç›¸å½“äºä¸è®¾ç½®ç¼“å­˜ï¼Œå³æ¯æ¬¡éƒ½ä¼šæœ‰OPTIONSè¯·æ±‚</span></span><br><span class="line">        response.setHeader(<span class="string">&quot;Access-Control-Max-Age&quot;</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®¾ç½®å…è®¸è·¨åŸŸè¯·æ±‚åŒ…å«content-typeå¤´</span></span><br><span class="line">        response.setHeader(<span class="string">&quot;Access-Control-Allow-Headers&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Filter has been used.&quot;</span>);</span><br><span class="line"></span><br><span class="line">        chain.doFilter(req, res);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬æ˜¯é€šè¿‡è®¾ç½® <code>Access-Control-Allow-Origin</code> å…è®¸æ‰€æœ‰çš„åŸŸå(é€šé…ç¬¦*)éƒ½å¯ä»¥è®¿é—®ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥è®¾ç½®æŒ‡å®šåŸŸåæ‰å¯ä»¥ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;http://localhost:8082&quot;</span>);</span><br></pre></td></tr></table></figure><p>é‚£æˆ‘ä»¬éœ€è¦æ€è€ƒä¸€ä¸‹äº†ï¼Œ<code>setHeader</code> æ–¹æ³•åªèƒ½è®¾ç½®ä¸€ä¸ªæŒ‡å®šçš„åŸŸåï¼Œå¦‚æœæˆ‘æƒ³è®¾ç½®å¤šä¸ªåŸŸåæ€ä¹ˆåŠï¼Ÿ</p><p>é¦–å…ˆå‘Šè¯‰ä½ é€šè¿‡ä¸‹é¢çš„æ–¹å¼è‚¯å®šä¸è¡Œï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">response.addHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;http://localhost:8082&quot;</span>);</span><br><span class="line">response.addHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;http://localhost:8083&quot;</span>);</span><br></pre></td></tr></table></figure><p>å…·ä½“åŸå› å¤§å®¶å¯ä»¥çœ‹ä¸€ä¸‹æºç å°±ç§’æ‡‚äº†ã€‚</p><p>æœ‰ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼ŒæŠŠå¯ä»¥é€šè¿‡è·¨åŸŸè®¿é—®çš„åŸŸååšæˆæ•°ç»„ä¹Ÿæ˜¯å¤§å®¶åœ¨ä¸šåŠ¡ä¸Šé¢ç»å¸¸è¯´çš„ç™½åå•ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¾ç½®å¤šä¸ªåŸŸåæ”¯æŒï¼Œç±»ä¼¼ç™½åå•</span></span><br><span class="line">String[] allowDomain = &#123;<span class="string">&quot;http://localhost:8082&quot;</span>, <span class="string">&quot;http://localhost:8083&quot;</span>, <span class="string">&quot;http://localhost:8085&quot;</span>, <span class="string">&quot;http://localhost:8087&quot;</span>&#125;;</span><br><span class="line"><span class="type">Set</span> <span class="variable">allowedOrigins</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashSet</span>(Arrays.asList(allowDomain));</span><br><span class="line"><span class="type">String</span> <span class="variable">originHeader</span> <span class="operator">=</span> ((HttpServletRequest) req).getHeader(<span class="string">&quot;Origin&quot;</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;originHeader: &quot;</span> + originHeader);</span><br><span class="line"><span class="keyword">if</span> (allowedOrigins.contains(originHeader)) &#123;</span><br><span class="line">response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, originHeader);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†æ¥æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼Œä¸Šé¢é‚£ç§æ–¹å¼è‡ªå®šä¹‰Filterä¼šå¯¹æ‰€æœ‰URLå³å…¨å±€çš„è¯·æ±‚éƒ½èµ·ä½œç”¨äº†ï¼Œèƒ½å¦å¯¹æŒ‡å®šURLè¿›è¡Œè¿‡æ»¤å‘¢ï¼Ÿ</p><p>åšè¿‡Springçš„åŒå­¦è‚¯å®šçŸ¥é“ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½® <code>WebFilter</code>ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebFilter(urlPatterns = &#123; &quot;/signin/name&quot; &#125;)</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¿®æ”¹åï¼Œéœ€è¦ä¿®æ”¹ä¸€ä¸‹SpringBootç›¸å…³çš„ä»£ç ï¼Œé¦–å…ˆå»æ‰ <code>Component</code> æ³¨è§£ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@Component</span></span><br><span class="line"><span class="meta">@WebFilter(urlPatterns = &#123; &quot;/signin/name&quot; &#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSCorsFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åéœ€è¦åœ¨ Application ä¸­æ·»åŠ  <code>ServletComponentScan</code> æ³¨è§£ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@ServletComponentScan</span><br><span class="line">@SpringBootApplication</span><br><span class="line">public class SpringbootApplication &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> ç»“åˆ Filter æˆ‘ä»¬å¯ä»¥åšå‡ºæ›´ç»†ç²’åº¦æ›´å¤šåŠŸèƒ½æ¥è§£å†³å’Œæ§åˆ¶è·¨åŸŸé—®é¢˜ã€‚Filter è¿™ç§æ–¹å¼å¯¹è·¨åŸŸçš„ GET å’Œ POST è¯·æ±‚éƒ½æ˜¯æ”¯æŒçš„ã€‚</p><h3 id="2ã€WebMvcConfigurationSupport"><a href="#2ã€WebMvcConfigurationSupport" class="headerlink" title="2ã€WebMvcConfigurationSupport"></a>2ã€WebMvcConfigurationSupport</h3><p>åœ¨ SpringBoot ä¸­è¿˜å¯ä»¥è‡ªå®šä¹‰é…ç½®æ¥è§£å†³è·¨åŸŸé—®é¢˜ï¼Œé€šè¿‡ç»§æ‰¿ <code>WebMvcConfigurationSupport</code> é…ç½® CROSï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSCorsConfig</span> <span class="keyword">extends</span> <span class="title class_">WebMvcConfigurationSupport</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.addCorsMappings(registry);</span><br><span class="line">        registry.addMapping(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">                .allowedOrigins(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">                .allowCredentials(<span class="literal">true</span>)</span><br><span class="line">                .allowedMethods(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;DELETE&quot;</span>, <span class="string">&quot;PUT&quot;</span>)</span><br><span class="line">                .maxAge(<span class="number">3600</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥æŒ‡å®š URL å’ŒåŸŸåï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSCorsConfig</span> <span class="keyword">extends</span> <span class="title class_">WebMvcConfigurationSupport</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.addCorsMappings(registry);</span><br><span class="line">        registry.addMapping(<span class="string">&quot;/signin/name&quot;</span>)</span><br><span class="line">                .allowedOrigins(<span class="string">&quot;http://localhost:8082&quot;</span>, <span class="string">&quot;http://localhost:8083&quot;</span>)</span><br><span class="line">                .allowCredentials(<span class="literal">true</span>)</span><br><span class="line">                .allowedMethods(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;DELETE&quot;</span>, <span class="string">&quot;PUT&quot;</span>)</span><br><span class="line">                .maxAge(<span class="number">3600</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·é…ç½®åï¼Œåªå…è®¸è¯·æ±‚åŸŸåæ˜¯ <code>http://localhost:8082</code> å’Œ <code>http://localhost:8082</code> å¹¶ä¸”è¯·æ±‚æœåŠ¡ç«¯URLæ˜¯ <code>/signin/name</code> çš„è¯·æ±‚æ‰å¯ä»¥ä½¿ç”¨ CORS æœºåˆ¶ã€‚</p><h3 id="3ã€CorsFilter"><a href="#3ã€CorsFilter" class="headerlink" title="3ã€CorsFilter"></a>3ã€CorsFilter</h3><p>è¿™ç§æ–¹æ³•æ—©åœ¨ <code>SpringBoot1.x</code> ç‰ˆæœ¬ä¸­ä½¿ç”¨ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.cors.CorsConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.cors.UrlBasedCorsConfigurationSource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.filter.CorsFilter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSCorsFilterConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> CorsConfiguration <span class="title function_">getConfig</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">CorsConfiguration</span> <span class="variable">corsConfiguration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CorsConfiguration</span>();</span><br><span class="line">        <span class="comment">// å…è®¸ä»»ä½•åŸŸåä½¿ç”¨</span></span><br><span class="line">        corsConfiguration.addAllowedOrigin(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">        <span class="comment">// å…è®¸ä»»ä½•å¤´</span></span><br><span class="line">        corsConfiguration.addAllowedHeader(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">        <span class="comment">// å…è®¸ä»»ä½•HTTPæ–¹æ³•</span></span><br><span class="line">        corsConfiguration.addAllowedMethod(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">        corsConfiguration.setAllowCredentials(<span class="literal">true</span>);</span><br><span class="line">        corsConfiguration.setMaxAge(<span class="number">60L</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> corsConfiguration;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> CorsFilter <span class="title function_">corsFilter</span><span class="params">()</span> &#123;</span><br><span class="line">        UrlBasedCorsConfigurationSource source;</span><br><span class="line">        source = <span class="keyword">new</span> <span class="title class_">UrlBasedCorsConfigurationSource</span>();</span><br><span class="line">        source.registerCorsConfiguration(<span class="string">&quot;/**&quot;</span>, getConfig());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">CorsFilter</span>(source);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹å¼è·Ÿä¸Šé¢çš„è§£å†³æ–¹æ³•åŸºæœ¬éƒ½æ˜¯å¤§åŒå°å¼‚ï¼Œå¤§å®¶æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©ä½¿ç”¨ï¼Œå¯¹æä¾›çš„æ–¹æ³•ä¸¾ä¸€åä¸‰å³å¯ã€‚</p><h2 id="å‡å°‘OPTIONSè¯·æ±‚"><a href="#å‡å°‘OPTIONSè¯·æ±‚" class="headerlink" title="å‡å°‘OPTIONSè¯·æ±‚"></a>å‡å°‘OPTIONSè¯·æ±‚</h2><p>è™½ç„¶æˆ‘ä»¬æ”¯æŒç½‘é¡µå¯¹æœåŠ¡ç«¯è¿›è¡Œ OPTIONS è¯·æ±‚ï¼Œä½†æ˜¯è¯·æ±‚å¦‚æœå¤šäº†åŠ¿å¿…ä¼šå½±å“æœåŠ¡å™¨æ€§èƒ½ã€‚</p><p>å¦‚æœåœ¨æ²¡æœ‰å¿…è¦çš„æƒ…å†µä¸‹å°½é‡å‡å°‘ç”±äºè·¨åŸŸè¯·æ±‚å¸¦æ¥çš„ OPTIONS è¯·æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®ç¼“å­˜æ—¶é—´æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>æ¯”å¦‚ä½¿ç”¨è‡ªå®šä¹‰ Filter çš„æ–¹å¼è®¾ç½®600ç§’çš„ç¼“å­˜æ—¶é—´ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.setHeader(<span class="string">&quot;Access-Control-Max-Age&quot;</span>, <span class="string">&quot;600&quot;</span>);</span><br></pre></td></tr></table></figure><p>åœ¨å¤§å®¶è¿›è¡Œæµ‹è¯•çš„æ—¶å€™ï¼Œè®°å¾—ä¸è¦å‹¾é€‰ Chrome å®¡æŸ¥è§†å›¾ä¸­ Network é€‰é¡¹ä¸­ <code>Disable cache</code> è¿™ä¸€é¡¹ï¼Œå¦åˆ™æ¯æ¬¡éƒ½ä¼šè¿›è¡Œ OPTIONS è¯·æ±‚ï¼Œç»™ä½ é€ æˆè®¾ç½®æœåŠ¡ç«¯ç¼“å­˜æ—¶é—´æ²¡æœ‰æ•ˆæœçš„å‡è±¡ã€‚</p><h2 id="å¸¸ç”¨Nginxå‘½ä»¤"><a href="#å¸¸ç”¨Nginxå‘½ä»¤" class="headerlink" title="å¸¸ç”¨Nginxå‘½ä»¤"></a>å¸¸ç”¨Nginxå‘½ä»¤</h2><p>ä¸‹é¢ç»™å‡ºWindowsç‰ˆæœ¬çš„Nginxå¸¸ç”¨å‘½ä»¤ã€‚</p><p>1ã€å¯åŠ¨ Nginx</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">start</span> nginx.exe</span><br></pre></td></tr></table></figure><p>2ã€éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx.<span class="attribute">exe</span> -t</span><br></pre></td></tr></table></figure><p>3ã€ä¿®æ”¹é…ç½®æ–‡ä»¶åï¼Œé‡æ–°åŠ è½½</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx.<span class="attribute">exe</span> -s reload</span><br></pre></td></tr></table></figure><p>4ã€å¿«é€Ÿå…³é—­</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx.<span class="attribute">exe</span> -s stop</span><br></pre></td></tr></table></figure><p>5ã€æ­£å¸¸å…³é—­é€€å‡º</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx.<span class="attribute">exe</span> -quit</span><br></pre></td></tr></table></figure><p>6ã€æŸ¥çœ‹Nginxç‰ˆæœ¬</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx.<span class="attribute">exe</span> -V</span><br></pre></td></tr></table></figure><hr><p><strong>åšæŒåšå¥½ä¸€ä»¶äº‹ï¼Œéœ€è¦ä»˜å‡ºæ¯”å¸¸äººæ›´å¤šçš„åŠªåŠ›~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
          <category> ç½‘ç»œåè®® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP OPTIONS CORS SpringBoot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è·¨åŸŸå’ŒOPTIONSè¿™å¯¹æ¬¢å–œå†¤å®¶</title>
      <link href="/2019/08/31/%E8%B7%A8%E5%9F%9F%E5%92%8COPTIONS%E8%BF%99%E5%AF%B9%E6%AC%A2%E5%96%9C%E5%86%A4%E5%AE%B6/"/>
      <url>/2019/08/31/%E8%B7%A8%E5%9F%9F%E5%92%8COPTIONS%E8%BF%99%E5%AF%B9%E6%AC%A2%E5%96%9C%E5%86%A4%E5%AE%B6/</url>
      
        <content type="html"><![CDATA[<hr><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a><strong>ç®€ä»‹</strong></h2><p>ç›¸ä¿¡åšè¿‡å‰ç«¯å¼€å‘çš„åŒäº‹ï¼ŒåŒ…æ‹¬åšå°ç¨‹åºæˆ–è€…å°æ¸¸æˆçš„ç å‹ä»¬åº”è¯¥éƒ½çœ‹è¿‡ç±»ä¼¼ä¸‹é¢çš„é”™è¯¯ï¼Œè¿™ä¸ªé”™è¯¯æ˜¯ç”±äº JavaScript ä»£ç å‘æœåŠ¡å™¨å‘é€äº† HTTP è¯·æ±‚å¼•èµ·çš„ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Access to XMLHttpRequest at &#x27;http://www.xxx.com/yyy&#x27; from origin &#x27;null&#x27; has been blocked by CORS policy:</span><br><span class="line">Response to preflight request doesn&#x27;t pass access control check: </span><br><span class="line">No &#x27;Access-Control-Allow-Origin&#x27; header is present on the requested resource.</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°ï¼Œä½ è‚¯å®šä¼šè§‰å¾—å¾ˆå¥½å¥‡ï¼Œå¿ä¸ä½ä¼šå»ä¸€æ¢ç©¶ç«Ÿ~</p><p>è¿˜æœ‰äº›åŒäº‹ä¼šé‡åˆ°å¦ä¸€ä¸ªç¥å¥‡çš„é”™è¯¯ï¼Œå³å‘é€GETæˆ–è€…POSTè¯·æ±‚ä¹‹å‰ï¼Œå±…ç„¶å…ˆç»™æœåŠ¡å™¨å‘é€äº†ä¸€ä¸ª OPTIONS è¯·æ±‚ï¼Œè®©äººä¸å¯æ€è®®çš„æ˜¯è¿™ä¸ª OPTIONS è¯·æ±‚æ˜¯è‡ªåŠ¨å‘çš„ï¼ŒæœåŠ¡å™¨åœ¨æ²¡æœ‰ä»»ä½•è®¾ç½®çš„æ¡ä»¶ä¸‹ç›´æ¥å°†è¿™ä¸ªè¯·æ±‚å¤­æŠ˜æ‰ï¼Œå¦‚ä¸‹è¿”å› <code>403</code> é”™è¯¯ï¼Œä¹Ÿå¯èƒ½æ˜¯å…¶ä»–é”™è¯¯ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OPTIONS http://www.xxx.com/yyy 403</span><br></pre></td></tr></table></figure><p>å¼•èµ·è¿™äº›é—®é¢˜çš„ç½ªé­ç¥¸é¦–å°±æ˜¯ <code>è·¨åŸŸ</code> ï¼Œä»Šå¤©æˆ‘è·Ÿå¤§å®¶ä¸€èµ·ä»¥å®é™…çš„ä¾‹å­æ¥çœ‹çœ‹è¿™ä¸ªç¥å¥‡çš„ <code>è·¨åŸŸ</code> é—®é¢˜ã€‚</p><p>æ–‡ä¸­ä½¿ç”¨çš„ä»£ç éƒ½å¯ä»¥åœ¨ <a href="https://github.com/veryitman/MSTutorial">Github</a> æ‰¾åˆ°ï¼Œå¤§å®¶æ ¹æ®éœ€è¦è‡ªè¡Œé‡‡çº³ã€‚</p><h2 id="åŒæºç­–ç•¥"><a href="#åŒæºç­–ç•¥" class="headerlink" title="åŒæºç­–ç•¥"></a><strong>åŒæºç­–ç•¥</strong></h2><p><strong>åŸŸ</strong>ï¼Œæ˜¯æŒ‡ç”± <code>åè®®</code> + <code>åŸŸå</code> + <code>ç«¯å£å·</code> ç»„æˆçš„ä¸€ä¸ªè™šæ‹Ÿæ¦‚å¿µã€‚</p><p>å¦‚æœä¸¤ä¸ªåŸŸçš„ <code>åè®®</code>ã€<code>åŸŸå</code>ã€<code>ç«¯å£å·</code> éƒ½ä¸€æ ·ï¼Œå°±ç§°ä»–ä»¬ä¸ºåŒåŸŸï¼Œä½†æ˜¯åªè¦ä¸‰è€…ä¹‹ä¸­æœ‰ä¸€ä¸ªä¸ä¸€æ ·ï¼Œå°±ä¸æ˜¯åŒåŸŸã€‚</p><p>é‚£ä¹ˆ <code>è·¨åŸŸè¯·æ±‚</code> ç®€å•æ¥è¯´ï¼Œå°±æ˜¯åœ¨ä¸€ä¸ªåŸŸå†…è¯·æ±‚äº†å¦ä¸€ä¸ªåŸŸçš„èµ„æºï¼Œç”±äºåŸŸä¸ä¸€è‡´ä¼šæœ‰å®‰å…¨éšæ‚£å¦‚ <code>CSRF</code> ï¼ˆCross-site request forgeryï¼‰æ”»å‡»ã€‚</p><p>åœ¨ç™¾åº¦ç™¾ç§‘é‡Œé¢æ˜¯è¿™æ ·å®šä¹‰ <code>åŒæºç­–ç•¥</code> çš„ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åŒæºç­–ç•¥ï¼ˆSOPï¼ŒSame origin policyï¼‰æ˜¯ä¸€ç§çº¦å®šï¼Œå®ƒæ˜¯æµè§ˆå™¨æœ€æ ¸å¿ƒä¹Ÿæœ€åŸºæœ¬çš„å®‰å…¨åŠŸèƒ½ï¼Œå¦‚æœç¼ºå°‘äº†åŒæºç­–ç•¥ï¼Œåˆ™æµè§ˆå™¨çš„æ­£å¸¸åŠŸèƒ½å¯èƒ½éƒ½ä¼šå—åˆ°å½±å“ã€‚</span><br><span class="line"></span><br><span class="line">å¯ä»¥è¯´ Web æ˜¯æ„å»ºåœ¨åŒæºç­–ç•¥åŸºç¡€ä¹‹ä¸Šçš„ï¼Œæµè§ˆå™¨åªæ˜¯é’ˆå¯¹åŒæºç­–ç•¥çš„ä¸€ç§å®ç°ã€‚</span><br></pre></td></tr></table></figure><p>å¬èµ·æ¥ï¼Œè¿™ç©æ„æŒºé«˜å¤§ä¸Šçš„ï¼Œç®€å•ç†è§£ <code>åŒæºç­–ç•¥</code> å°±æ˜¯ä¸€ç§å®‰å…¨ç­–ç•¥ï¼Œä¸ºäº†å®‰å…¨è€Œç”Ÿçš„ä¸€ç§é™åˆ¶æªæ–½ã€‚å®ƒæ˜¯ç”± <a href="https://baike.baidu.com/item/Netscape/2778944">Netscape</a> æå‡ºçš„ä¸€ä¸ªè‘—åçš„å®‰å…¨ç­–ç•¥ï¼Œç°åœ¨æ‰€æœ‰æ”¯æŒ JavaScript çš„æµè§ˆå™¨éƒ½ä¼šä½¿ç”¨è¿™ä¸ªç­–ç•¥ï¼Œä¹Ÿæ˜¯å¿…é¡»éµå®ˆçš„ä¸€ä¸ªç­–ç•¥ã€‚</p><p>é‚£ä¹ˆ <code>åŒæºç­–ç•¥</code> ä¸­çš„ <code>åŒæº</code> æ˜¯æŒ‡ <code>åŸŸå</code>ï¼Œ<code>åè®®</code>ï¼Œ<code>ç«¯å£</code> ä¸‰è€…å¿…é¡»ç›¸åŒï¼Œå¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªä¸åŒå°±ä¼šå¼•èµ·è·¨åŸŸã€‚</p><p>ä¸‹è¡¨ç»™å‡ºäº†ç›¸å¯¹ <code>http://a.xx.com/yy/zz.html</code> åŒæºæ£€æµ‹çš„ç¤ºä¾‹:</p><table><thead><tr><th align="left">URL</th><th align="left">ç»“æœ</th><th align="left">åŸå› </th></tr></thead><tbody><tr><td align="left"><code>http://a.xxx.com/ff/other.html</code></td><td align="left">æˆåŠŸ</td><td align="left">åŸŸåã€åè®®ã€ç«¯å£(é»˜è®¤80)ä¸€è‡´</td></tr><tr><td align="left"><code>http://a.xxx.com/gg/hh/another.html</code></td><td align="left">æˆåŠŸ</td><td align="left">åŸŸåã€åè®®ã€ç«¯å£(é»˜è®¤80)ä¸€è‡´</td></tr><tr><td align="left"><code>https://a.xxx.com/secure.html</code></td><td align="left">å¤±è´¥</td><td align="left">ä¸åŒåè®® ( HTTPSå’ŒHTTP )</td></tr><tr><td align="left"><code>http://a.xxx.com:81/dir/etc.html</code></td><td align="left">å¤±è´¥</td><td align="left">ä¸åŒç«¯å£ ( 81å’Œ80)</td></tr><tr><td align="left"><code>http://a.wpq.com/yy/other.html</code></td><td align="left">å¤±è´¥</td><td align="left">ä¸åŒåŸŸå ( xxxå’Œwpq)</td></tr><tr><td align="left"><code>http://123.21.122.12/dir</code></td><td align="left">å¤±è´¥</td><td align="left">åŸŸåIPä¸ç­‰åŒäºåŸŸå</td></tr><tr><td align="left"><code>http://xx.xxx.com/dir2/</code></td><td align="left">å¤±è´¥</td><td align="left">ä¸»åŸŸç›¸åŒï¼Œå­åŸŸä¸åŒ</td></tr></tbody></table><p>ç®€å•æ¥è¯´ï¼ŒHTML ä»£ç è¿è¡Œåœ¨ä¸€ä¸ªwebä¸»æœºä¸Šé¢ï¼ˆå‡è®¾åŸŸåæ˜¯ <code>http://a.xx.com/yy/zz.html</code>ï¼‰ï¼Œè€ŒHTMLä»£ç ä¸­æœ‰éœ€è¦è¯·æ±‚æœåŠ¡å™¨æŸ API æ¥å£ï¼ˆ<code>http://api.user.com/name</code>ï¼‰çš„ï¼Œé‚£ä¹ˆå°±ä¼šé€ æˆè·¨åŸŸé—®é¢˜ã€‚</p><p>åŒæºç­–ç•¥ä¼šå½±å“ï¼š</p><p>ï¼ˆ1ï¼‰ Cookieã€LocalStorage å’Œ IndexDB æ— æ³•è¯»å–ï¼›</p><p>ï¼ˆ2ï¼‰ DOM æ— æ³•è·å¾—ï¼›</p><p>ï¼ˆ3ï¼‰ AJAX è¯·æ±‚ä¸èƒ½æ­£å¸¸å‘é€ï¼Œæœ‰å¯èƒ½è¿˜ä¼šå¼•èµ· OPTIONS è¯·æ±‚ï¼›</p><h2 id="OPTIONSè¯·æ±‚"><a href="#OPTIONSè¯·æ±‚" class="headerlink" title="OPTIONSè¯·æ±‚"></a><strong>OPTIONSè¯·æ±‚</strong></h2><p>å¤§å®¶æ‰€ç†ŸçŸ¥çš„HTTPè¯·æ±‚æœ€å¤šçš„åº”è¯¥å°±æ˜¯ GET å’Œ POST è¯·æ±‚ï¼Œè¿™ä¸¤ç§è¯·æ±‚ä¹Ÿæ˜¯è½¯ä»¶å¼€å‘ä¸­ç”¨çš„æœ€å¤šçš„ã€‚</p><blockquote><p>GETï¼šå‘ç‰¹å®šçš„èµ„æºå‘å‡ºè¯·æ±‚ï¼Œä¸€èˆ¬å¯¹æœåŠ¡å™¨æ¥è¯´æ˜¯ä¸€ä¸ªåªè¯»çš„è¯·æ±‚ï¼Œä¸ä¼šå¯¹èµ„æºè¿›è¡Œå†™æ“ä½œã€‚</p><p>POSTï¼šå‘æŒ‡å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œå¤„ç†è¯·æ±‚ï¼Œä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼Œæ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“ï¼ˆbodyï¼‰ä¸­ï¼Œè¯¥è¯·æ±‚å¯èƒ½ä¼šå¯¹æœåŠ¡å™¨èµ„æºè¿›è¡Œè¯»å†™æ“ä½œã€‚</p></blockquote><p>é™¤äº†è¿™ä¸¤ç§è¯·æ±‚å¤–ï¼ŒHTTPè¿˜æœ‰å…¶ä»–ç§ç±»çš„è¯·æ±‚ï¼Œå¦‚ä¸‹ï¼š</p><blockquote><p>PUTï¼šå‘æŒ‡å®šèµ„æºä½ç½®ä¸Šä¼ å…¶æœ€æ–°å†…å®¹ï¼Œä¸€èˆ¬ç”¨äºèµ„æºçš„æ•´ä½“æ›´æ–°ï¼Œè€Œä¸‹é¢çš„ PATCH ç”¨äºèµ„æºçš„éƒ¨åˆ†æ›´æ–°ã€‚</p><p>DELETEï¼šè¯·æ±‚æœåŠ¡å™¨åˆ é™¤æ‰€æ ‡è¯†çš„èµ„æºã€‚</p><p>HEADï¼šå‘æœåŠ¡å™¨ç´¢è¦ä¸ GET è¯·æ±‚ç›¸ä¸€è‡´çš„å“åº”ï¼Œåªä¸è¿‡å“åº”ä½“å°†ä¸ä¼šè¢«è¿”å›ï¼Œå¯ä»¥åœ¨ä¸å¿…ä¼ è¾“æ•´ä¸ªå“åº”å†…å®¹çš„æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥è·å–åŒ…å«åœ¨å“åº”æ¶ˆæ¯å¤´ä¸­çš„å…ƒä¿¡æ¯ã€‚</p><p>TRACEï¼šå›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­ã€‚</p><p>OPTIONSï¼šè¿”å›æœåŠ¡å™¨é’ˆå¯¹ç‰¹å®šèµ„æºæ‰€æ”¯æŒçš„ HTTP è¯·æ±‚æ–¹æ³•ã€‚ä¹Ÿå¯ä»¥åˆ©ç”¨å‘WebæœåŠ¡å™¨å‘é€ â€˜*â€™ çš„è¯·æ±‚æ¥æµ‹è¯•æœåŠ¡å™¨çš„åŠŸèƒ½æ€§ã€‚è¯¥è¯·æ±‚ä¸ä¼šä¿®æ”¹æœåŠ¡å™¨èµ„æºï¼Œç›¸å¯¹æ¯”è¾ƒå®‰å…¨ã€‚</p><p>CONNECTï¼šæ˜¯ <code>HTTP/1.1</code> åè®®é¢„ç•™çš„ï¼Œèƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ã€‚é€šå¸¸ç”¨äº SSL åŠ å¯†æœåŠ¡å™¨çš„é“¾æ¥ä¸éåŠ å¯†çš„ HTTP ä»£ç†æœåŠ¡å™¨çš„é€šä¿¡ã€‚</p><p>PATCHï¼šæ˜¯å¯¹ PUT æ–¹æ³•çš„è¡¥å……ï¼Œç”¨æ¥å¯¹å·²çŸ¥èµ„æºè¿›è¡Œå±€éƒ¨æ›´æ–°ã€‚å½“èµ„æºä¸å­˜åœ¨æ—¶ï¼ŒPATCH ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„èµ„æºï¼Œè€Œ PUT åªä¼šå¯¹å·²å­˜åœ¨çš„èµ„æºè¿›è¡Œæ›´æ–°ã€‚</p></blockquote><p>å…¶ä¸­ GET, POST å’Œ HEAD æ–¹æ³•æ˜¯ HTTP1.0 å®šä¹‰çš„ä¸‰ç§è¯·æ±‚æ–¹æ³•ï¼Œåœ¨ HTTP1.1 åˆæ–°å¢äº†å…­ç§è¯·æ±‚æ–¹æ³•ï¼Œå³ OPTIONSã€PUTã€PATCHã€DELETEã€TRACE å’Œ CONNECT æ–¹æ³•ã€‚å¦‚æœæƒ³äº†è§£æ›´å¤š HTTP å†å²çš„æœ‹å‹ï¼Œå¯ä»¥é˜…è¯»æˆ‘ä¹‹å‰çš„å†™çš„ä¸€ç¯‡æ–‡ç«  <a href="http://www.veryitman.com/2018/09/16/HTTP-%E6%BC%94%E8%BF%9B%E5%8F%B2/">HTTP æ¼”è¿›å²</a>ï¼Œå˜¿å“ˆğŸ™‹â€ã€‚</p><p>å†è¯´ä¸€ä¸‹ <code>OPTIONS</code> è¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¸ <code>HEAD</code> è¯·æ±‚æœ‰ç‚¹ç±»ä¼¼ï¼Œä¸€èˆ¬ä¹Ÿæ˜¯ç”¨äºå®¢æˆ·ç«¯æŸ¥çœ‹æœåŠ¡å™¨çš„æ€§èƒ½ã€‚</p><p><code>OPTIONS</code> æ–¹æ³•ä¼šè¯·æ±‚æœåŠ¡å™¨è¿”å›è¯¥èµ„æºæ‰€æ”¯æŒçš„æ‰€æœ‰HTTPè¯·æ±‚æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šç”¨æ¥ä»£æ›¿èµ„æºåç§°ï¼Œå‘æœåŠ¡å™¨å‘é€ <code>OPTIONS</code> è¯·æ±‚ï¼Œå¯ä»¥æµ‹è¯•æœåŠ¡å™¨åŠŸèƒ½æ˜¯å¦æ­£å¸¸ã€‚JavaScript çš„ <a href="http://itbilu.com/javascript/js/VkiXuUcC.html">XMLHttpRequest</a> å¯¹è±¡è¿›è¡Œ<code>CORS</code>è·¨åŸŸèµ„æºå…±äº«æ—¶ï¼Œå°±æ˜¯ä½¿ç”¨ <code>OPTIONS</code> æ–¹æ³•å‘é€å—…æ¢è¯·æ±‚ï¼Œä»¥åˆ¤æ–­æ˜¯å¦æœ‰å¯¹æŒ‡å®šèµ„æºçš„è®¿é—®æƒé™ã€‚</p><p>é‚£ä¹ˆéœ€è¦æ»¡è¶³å“ªäº›æ¡ä»¶æ‰ä¼šè§¦å‘ <code>OPTINS</code> è¯·æ±‚å‘¢ï¼Ÿ</p><h2 id="å®ä¾‹éªŒè¯"><a href="#å®ä¾‹éªŒè¯" class="headerlink" title="å®ä¾‹éªŒè¯"></a><strong>å®ä¾‹éªŒè¯</strong></h2><p>åœ¨æ²¡æœ‰å›ç­”ä¸Šé¢çš„é—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜æ˜¯æ¥åšä¸ªå®éªŒå§~</p><p>ä½ éœ€è¦å°† Chrome æµè§ˆå™¨çš„å®¡æŸ¥è§†å›¾æ‰“å¼€ï¼Œæœ€å¥½æŠŠ <code>Disable Cache</code> ä¹Ÿå‹¾é€‰ä¸Šç¦æ­¢ Chrome ä½¿ç”¨ç½‘ç»œç¼“å­˜ï¼Œè¿™æ ·æ‰ä¸ä¼šå½±å“ä¸‹é¢çš„å®éªŒã€‚</p><p><img src="/upload/images/2019/08/31/4.png" alt="img"></p><p>ä¸‹é¢æ˜¯ <code>Springboot</code> å…³äºç™»å½•çš„ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;signin&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSSigninController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/name&quot;, method = RequestMethod.GET)</span></span><br><span class="line">    <span class="keyword">public</span> MSResponse <span class="title function_">sigin</span><span class="params">(<span class="meta">@RequestParam(value = &quot;username&quot;)</span> String userName, <span class="meta">@RequestParam(value = &quot;userpwd&quot;)</span> String userPwd)</span> &#123;</span><br><span class="line">        <span class="type">MSResponse</span> <span class="variable">response</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MSResponse</span>();</span><br><span class="line">        <span class="type">MSUser</span> <span class="variable">user</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == userName || <span class="literal">null</span> == userPwd || userName.length() &lt;= <span class="number">0</span> || userPwd.length() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">MSResponseEnum</span> <span class="variable">responseEnum</span> <span class="operator">=</span> MSResponseEnum.Login4SiginInvalidInfo;</span><br><span class="line">            response.setCode(responseEnum.getCode());</span><br><span class="line">            response.setMsg(responseEnum.getMsg());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            user = MSUserUtil.createDefaultUser(userName, userPwd);</span><br><span class="line">            <span class="type">MSResponseEnum</span> <span class="variable">rspEnum</span> <span class="operator">=</span> MSResponseEnum.SUCCESS;</span><br><span class="line">            response.setCode(rspEnum.getCode());</span><br><span class="line">            response.setMsg(rspEnum.getMsg());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        response.setResults(user);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> response;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½ å¤§å¯ä¸å¿…å»äº†è§£è¿™ä¸ªä»£ç çš„å…·ä½“é€»è¾‘ï¼Œç°åœ¨ä½ åªéœ€è¦çŸ¥é“ä»–æ˜¯ç”¨æ¥ç»™ JavaScript è°ƒç”¨çš„ä¸€ä¸ªç™»å½•APIå³å¯ã€‚</p><p>å†æ¥ä¸€ä¸ª HTML æ–‡ä»¶ï¼Œæ¨¡æ‹Ÿè¯·æ±‚ç™»å½•çš„APIï¼Œè¯·æ±‚ HTTP ä½¿ç”¨ Ajaxï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getReq</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="keyword">var</span> url = <span class="string">&quot;http://localhost:8080/signin/name?username=jack&amp;userpwd=123&quot;</span>;</span><br><span class="line"></span><br><span class="line">    $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: url,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">        <span class="attr">dataType</span>: <span class="string">&#x27;json&#x27;</span>,</span><br><span class="line">      &#125;).<span class="title function_">done</span>(<span class="keyword">function</span> (<span class="params">result</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">        &#125;).<span class="title function_">fail</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">         <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Chrome æµè§ˆå™¨ç›´æ¥æ‰“å¼€è¿™ä¸ªHTMLæ–‡ä»¶å³å¯ï¼Œç„¶åå¯åŠ¨ Java æœåŠ¡ï¼Œåœ¨æµè§ˆå™¨ä¸­ç‚¹å‡»æŒ‰é’®è¿›è¡Œ GET è¯·æ±‚ã€‚</p><p>æ­¤æ—¶è¯·æ±‚ä¼šæŠ¥ä¸‹é¢çš„é”™è¯¯ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Access to XMLHttpRequest at &#x27;http://localhost:8080/signin/name?username=jack&amp;userpwd=123&#x27; from origin &#x27;null&#x27; has been blocked by CORS policy: No &#x27;Access-Control-Allow-Origin&#x27; header is present on the requested resource.</span><br></pre></td></tr></table></figure><p>ç¡®å®æ˜¯é€ æˆäº†è·¨åŸŸè¯·æ±‚ï¼Œå¯¼è‡´è¯·æ±‚å¤±è´¥ã€‚</p><p>ä½†æ˜¯ä»¤äººé—æ†¾çš„æ˜¯å¹¶æ²¡æœ‰çœ‹åˆ°å‘å‡º OPTIONS è¯·æ±‚ï¼Œä½¿ç”¨ Fiddler æŠ“åŒ…ï¼Œå¯ä»¥çœ‹åˆ°åªæœ‰ GET è¯·æ±‚ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2019/08/31/1.png" alt="img"></p><p>éš¾é“æ˜¯è‡ªå·±å†™ä»£ç çš„å§¿åŠ¿ä¸å¯¹å—ï¼Ÿï¼</p><p>å…¶å®ï¼Œåœ¨ HTML ä¸­ä½¿ç”¨ HTTP è¯·æ±‚ï¼Œå‘ç”Ÿ OPTIONS è¯·æ±‚æ˜¯éœ€è¦å‡ ä¸ªæ¡ä»¶çš„ï¼š</p><ul><li>1ã€å¿…é¡»æ˜¯è·¨åŸŸè¯·æ±‚</li><li>2ã€è‡ªå®šä¹‰äº†è¯·æ±‚å¤´</li><li>3ã€è¯·æ±‚å¤´ä¸­çš„ <code>content-type</code> æ˜¯ <code>application/x-www-form-urlencoded</code>ï¼Œ<code>multipart/form-data</code>ï¼Œ<code>text/plain</code> ä¹‹å¤–çš„æ ¼å¼</li></ul><p><strong>æ»¡è¶³1å’Œ2æˆ–è€…æ»¡è¶³1å’Œ3å°±ä¼šå‘ç”Ÿ OPTIONS è¯·æ±‚</strong>ï¼Œé¦–å…ˆæˆ‘ä»¬ç¡®å®šäº†ä¸Šé¢çš„ç¤ºä¾‹æ˜¯è·¨åŸŸè¯·æ±‚ï¼Œä½†æ˜¯ä¸æ»¡è¶³åé¢çš„ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€ã€‚</p><p>æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹HTMLä»£ç å¢åŠ ä¸€ä¸ª <code>content-type</code>ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getReq</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="keyword">var</span> url = <span class="string">&quot;http://localhost:8080/signin/name?username=jack&amp;userpwd=123&quot;</span>;</span><br><span class="line"></span><br><span class="line">    $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: url,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">        <span class="attr">dataType</span>: <span class="string">&#x27;json&#x27;</span>,</span><br><span class="line">        <span class="attr">contentType</span>: <span class="string">&#x27;application/json&#x27;</span>,</span><br><span class="line">      &#125;).<span class="title function_">done</span>(<span class="keyword">function</span> (<span class="params">result</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">        &#125;).<span class="title function_">fail</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">         <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶åœ¨æµè§ˆå™¨ä¸­ï¼ˆéœ€è¦ä½¿ç”¨ Chrome çš„å®¡æŸ¥è§†å›¾ï¼‰å¯ä»¥çœ‹åˆ°æŠ¥é”™ä¿¡æ¯ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">OPTIONS http://localhost:8080/signin/name?username=jack&amp;userpwd=123 403</span><br><span class="line"></span><br><span class="line">Access to XMLHttpRequest at &#x27;http://localhost:8080/signin/name?username=jack&amp;userpwd=123&#x27; from origin &#x27;null&#x27; has been blocked by CORS policy: Response to preflight request doesn&#x27;t pass access control check: No &#x27;Access-Control-Allow-Origin&#x27; header is present on the requested resource.</span><br></pre></td></tr></table></figure><p>æŠ“åŒ…å·¥å…·ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°å‘ç”Ÿäº† OPTIONS è¯·æ±‚ï¼Œå¦‚ä¸‹å›¾ï¼š </p><p><img src="/upload/images/2019/08/31/2.png" alt="img"></p><p>ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ Header å¤´æ¥è¿›è¡ŒéªŒè¯ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getReq</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="keyword">var</span> url = <span class="string">&quot;http://localhost:8080/signin/name?username=jack&amp;userpwd=123&quot;</span>;</span><br><span class="line"></span><br><span class="line">    $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: url,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">        <span class="attr">dataType</span>: <span class="string">&#x27;json&#x27;</span>,</span><br><span class="line">        <span class="attr">headers</span>: &#123;</span><br><span class="line">            <span class="attr">token</span>: <span class="string">&quot;yu7rX98xxxx_iii^ddd&quot;</span>,</span><br><span class="line">            <span class="attr">userId</span>: <span class="number">123</span>,</span><br><span class="line">            <span class="attr">openid</span>: <span class="number">231232</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;).<span class="title function_">done</span>(<span class="keyword">function</span> (<span class="params">result</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">        &#125;).<span class="title function_">fail</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">         <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>éªŒè¯ç»“æœå’Œä¸Šé¢ä¸€è‡´ï¼Œä¹Ÿä¼šå‘ç”Ÿ OPTIONS è¯·æ±‚ã€‚</p><h2 id="å†èŠOPTIONS"><a href="#å†èŠOPTIONS" class="headerlink" title="å†èŠOPTIONS"></a><strong>å†èŠOPTIONS</strong></h2><p>åœ¨ <a href="https://www.ietf.org/rfc/rfc2616.txt">RFC2616-HTTP&#x2F;1.1</a> ä¸­å…³äº OPTIONS æœ‰è¯¦ç»†çš„æè¿°ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥çœ‹ä¸€ä¸‹ <code>9.2 OPTIONS</code> å°èŠ‚ã€‚</p><p>OPTIONS è¯·æ±‚æ–¹æ³•çš„ä¸»è¦ç”¨é€”æœ‰ä¸¤ä¸ªï¼š</p><p>1ã€è·å–æœåŠ¡å™¨æ”¯æŒçš„ HTTP è¯·æ±‚æ–¹æ³•ï¼›</p><p>2ã€ç”¨æ¥æ£€æŸ¥æœåŠ¡å™¨çš„æ€§èƒ½ï¼Œå¦‚ä¸Šé¢ä¾‹å­ä¸­çš„AJAXè¿›è¡Œè·¨åŸŸè¯·æ±‚æ—¶çš„é¢„æ£€ï¼Œéœ€è¦å‘å¦å¤–ä¸€ä¸ªåŸŸåçš„èµ„æºå‘é€ä¸€ä¸ª HTTP OPTIONS è¯·æ±‚å¤´ï¼Œç”¨ä»¥åˆ¤æ–­å®é™…å‘é€çš„è¯·æ±‚æ˜¯å¦å®‰å…¨ï¼›</p><p>HTT Pçš„ OPTIONS è¯·æ±‚ï¼Œæœ‰å¾ˆå¤šåœ°æ–¹ä¹Ÿè¢«ç§°ä¹‹ä¸ºé¢„è¯·æ±‚æˆ–è€…é¢„æ£€è¯·æ±‚ï¼Œæ¢å¥è¯è¯´å°±æ˜¯è¯•æ¢æ€§çš„è¯·æ±‚ä¸ç®—æ˜¯æ­£å¼è¯·æ±‚ã€‚</p><p>ä¸ºäº†é¿å…å¯¹æœåŠ¡å™¨äº§ç”Ÿä¸€äº›å‰¯ä½œç”¨ï¼Œç±»ä¼¼ä¸Šé¢ä¾‹å­ä¸­çš„ç½‘é¡µä¸­çš„è¯·æ±‚å°±ä¼šäº§ç”Ÿ OPTIONS è¯·æ±‚ï¼Œä¹Ÿç®—æ˜¯ä¸€ç§å¯¹æœåŠ¡å™¨çš„ä¿æŠ¤ã€‚åªæœ‰å½“æœåŠ¡å™¨å…è®¸åï¼Œæµè§ˆå™¨æ‰ä¼šå‘å‡ºæ­£å¼çš„è¯·æ±‚ï¼Œå¦åˆ™ä¸å‘é€æ­£å¼è¯·æ±‚ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>curl</code> æ¨¡æ‹Ÿ OPTIONS è¯·æ±‚ï¼Œä¾‹å¦‚ä¸‹é¢è¯·æ±‚è°·æ­Œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -v -X OPTIONS https://www.google.com</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¯·æ±‚çš„å“åº”æƒ…å†µï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt; HTTP/2 405</span><br><span class="line">&lt; allow: GET, HEAD</span><br><span class="line">&lt; date: Sat, 31 Aug 2019 02:17:03 GMT</span><br><span class="line">&lt; content-type: text/html; charset=UTF-8</span><br><span class="line">&lt; server: gws</span><br><span class="line">&lt; content-length: 1592</span><br><span class="line">&lt; x-xss-protection: 0</span><br><span class="line">&lt; x-frame-options: SAMEORIGIN</span><br><span class="line">&lt; alt-svc: quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43,39&quot;</span><br><span class="line">&lt;</span><br><span class="line">&#123; [5 bytes data]</span><br><span class="line">100  1592  100  1592   0   0  13606   0 --:--:-- --:-- 13606HTTP/2 405</span><br><span class="line"><span class="attribute">allow</span><span class="punctuation">: </span>GET, HEAD</span><br><span class="line"><span class="attribute">date</span><span class="punctuation">: </span>Sat, 31 Aug 2019 02:17:03 GMT</span><br><span class="line"><span class="attribute">content-type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">server</span><span class="punctuation">: </span>gws</span><br><span class="line"><span class="attribute">content-length</span><span class="punctuation">: </span>1592</span><br><span class="line"><span class="attribute">x-xss-protection</span><span class="punctuation">: </span>0</span><br><span class="line"><span class="attribute">x-frame-options</span><span class="punctuation">: </span>SAMEORIGIN</span><br><span class="line"><span class="attribute">alt-svc</span><span class="punctuation">: </span>quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43,39&quot;</span><br></pre></td></tr></table></figure><h2 id="SpringBoot-è§£å†³è·¨åŸŸ"><a href="#SpringBoot-è§£å†³è·¨åŸŸ" class="headerlink" title="SpringBoot è§£å†³è·¨åŸŸ"></a><strong>SpringBoot è§£å†³è·¨åŸŸ</strong></h2><p>è¯è¯´ï¼ŒåŒæºç­–ç•¥å¼•èµ·äº†è·¨åŸŸé—®é¢˜ï¼Œæœ¬èº«æ˜¯ä¸ºäº†å®‰å…¨èµ·è§ä¸ºä½•æˆ‘ä»¬è¿˜è¦å»è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿè¿™æ˜¯å› ä¸º Web å‰ç«¯æ˜¯æˆ‘ä»¬è‡ªå·±å¼€å‘çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æ˜¯çŸ¥é“è‡ªå·±çš„ Web è¯·æ±‚æ˜¯å®‰å…¨çš„ï¼ˆç±»ä¼¼äºç™½åå•å®¢æˆ·ï¼‰ï¼Œå°±éœ€è¦è®©å®ƒé¡ºåˆ©è®¿é—®åç«¯æœåŠ¡ï¼Œæ‰€ä»¥è§£å†³è¿™ä¸ªè·¨åŸŸé—®é¢˜åŠ¿åœ¨å¿…è¡Œã€‚</p><p>è§£å†³è·¨è¶Šçš„é—®é¢˜ï¼Œåœ¨ç½‘ä¸Šæœ‰å¾ˆå¤šçš„è·¯å­ï¼Œç›®å‰å¤§æ¦‚æœ‰ä¸‹é¢å‡ ç§è§£å†³æ–¹æ¡ˆï¼Œå¦‚ä¸‹ï¼š</p><ul><li>JSONP<ul><li>ç®€å•å…¼å®¹æ€§å¥½ï¼Œå¯ç”¨äºè§£å†³ä¸»æµæµè§ˆå™¨çš„è·¨åŸŸæ•°æ®è®¿é—®çš„é—®é¢˜ã€‚ä½†å®ƒä»…æ”¯æŒGETæ–¹æ³•ä¸æ”¯æŒPOSTç­‰å…¶ä»–è¯·æ±‚æ–¹æ³•ï¼Œè€Œä¸”å¯èƒ½ä¼šé­å—XSSæ”»å‡»ã€‚</li></ul></li><li>CORS</li><li>postMessage</li><li>websocket</li><li>Node ä¸­é—´ä»¶ä»£ç†</li><li>Nginx åå‘ä»£ç†</li><li>window.name+iframe</li><li>location.hash+iframe</li><li>document.domain+iframe</li></ul><p>ä»Šå¤©æˆ‘ä»¬ä½¿ç”¨ SpringBoot è‡ªå¸¦çš„æ³¨è§£æ¥è§£å†³è¿™ä¸ªé—®é¢˜ğŸ˜ƒã€‚</p><p>åœ¨è¯´è§£å†³æ–¹æ¡ˆä¹‹å‰ï¼Œè¿˜æ˜¯å…ˆäº†è§£ä¸€ä¸‹ CORSï¼ˆCross-origin resource sharingï¼‰ï¼Œå…¶å…¨ç§°æ˜¯â€è·¨åŸŸèµ„æºå…±äº«â€ï¼Œæ˜¯ W3C çš„ä¸€ä¸ªæ ‡å‡†ã€‚</p><p>CORS å…è®¸æµè§ˆå™¨å‘è·¨æºæœåŠ¡å™¨å‘å‡º XMLHttpRequest è¯·æ±‚ï¼Œä»è€Œå…‹æœäº†AJAXåªèƒ½åŒæºä½¿ç”¨çš„é™åˆ¶ã€‚</p><p>CORS éœ€è¦æµè§ˆå™¨å’ŒæœåŠ¡å™¨åŒæ—¶æ”¯æŒã€‚å¹¸è¿çš„æ˜¯ç›®å‰å‡ ä¹æ‰€æœ‰çš„æµè§ˆå™¨éƒ½æ”¯æŒè¯¥åŠŸèƒ½ï¼Œå”¯ä¸€ç¾ä¸­ä¸è¶³çš„æ˜¯IEæµè§ˆå™¨çš„ç‰ˆæœ¬ä¸èƒ½ä½äºIE10ã€‚</p><p>å®ç° CORS é€šä¿¡çš„å…³é”®æ˜¯æœåŠ¡å™¨ã€‚åªè¦æœåŠ¡å™¨å®ç°äº† CORS æ¥å£ï¼Œå°±å¯ä»¥è·¨æºé€šä¿¡ã€‚SpringBoot è‡ªå¸¦æ³¨è§£ <code>CrossOrigin</code> å¯ä»¥ç”¨æ¥è§£å†³è·¨åŸŸé—®é¢˜ã€‚</p><p>ä¿®æ”¹ä¸€ä¸‹ Controller çš„ä»£ç ï¼Œå¢åŠ  <code>CrossOrigin</code> æ³¨è§£ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/name&quot;, method = RequestMethod.GET)</span></span><br><span class="line"><span class="keyword">public</span> MSResponse <span class="title function_">sigin</span><span class="params">(<span class="meta">@RequestParam(value = &quot;username&quot;)</span> String userName, <span class="meta">@RequestParam(value = &quot;userpwd&quot;)</span> String userPwd)</span> &#123;</span><br><span class="line">    <span class="comment">// çœç•¥</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡æ–°å¯åŠ¨æœåŠ¡ï¼ŒæŠ“åŒ…å·¥å…·å¯ä»¥çœ‹åˆ° OPTIONS å’Œ GET è¯·æ±‚éƒ½æ­£å¸¸æ‰§è¡Œï¼Œè¿”å›ç éƒ½æ˜¯200ã€‚ </p><p><img src="/upload/images/2019/08/31/3.png" alt="img"></p><p>å¯ä»¥é’ˆå¯¹æŸä¸ªæ–¹æ³•æ·»åŠ  <code>CrossOrigin</code> æ³¨è§£ï¼Œä¹Ÿå¯ä»¥å¯¹æ•´ä¸ª Controller æ·»åŠ è¯¥æ³¨è§£ã€‚</p><p>å…³äº <code>CrossOrigin</code> æ³¨è§£ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œå®è·µï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</p><hr><p><strong>ä¸€ç›´åšæŒåœ¨å­¦ä¹ çš„è·¯ä¸ŠåŠªåŠ›~</strong></p><p><img src="/upload/me/qrcode_wx.jpg" alt="img"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
          <category> ç½‘ç»œåè®® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP OPTIONS CORS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è·³ç»³çš„æ•…äº‹</title>
      <link href="/2019/08/24/%E8%B7%B3%E7%BB%B3%E7%9A%84%E6%95%85%E4%BA%8B/"/>
      <url>/2019/08/24/%E8%B7%B3%E7%BB%B3%E7%9A%84%E6%95%85%E4%BA%8B/</url>
      
        <content type="html"><![CDATA[<p>å¤å¤©çš„å¤ªé˜³æ°¸è¿œéƒ½æ˜¯é‚£ä¹ˆå¼ºåŠ²æœ‰åŠ›ï¼Œå—æ–¹å°¤ä¸ºçªå‡ºã€‚æ•´ä¸ªåœ°é¢éƒ½å†’ç€çƒ­æ°”ï¼Œåƒä¸€åŒæ— å½¢çš„åŒæ‰‹ç´§ç´§åœ°æŠ±ç€ä½ ï¼Œé©¬è·¯ä¸Šåå°„çš„å…‰çºµç„¶ä½ ç«çœ¼é‡‘é‡‘ä¹Ÿä¼šå¿ƒç”Ÿæ•¬ç•ã€‚ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰å‘ç°ï¼Œå³ä½¿è¿™ä¹ˆçƒ­çš„å¤©ï¼Œç¯®çƒåœºä¸Šè¿˜æœ‰å¾ˆå¤šâ€œæˆ˜å£«â€å¥‹ä¸é¡¾èº«çš„æ‹¼ä¸ªä½ æ­»æˆ‘æ´»ã€‚å€’ä¸æ˜¯ä»–ä»¬ä¸æ€•çƒ­ä¸æ€•ç´¯ï¼Œè€Œæ˜¯å› ä¸ºä»–ä»¬å–œæ¬¢è¿™é¡¹è¿åŠ¨æ›´æ„¿æ„ä¸ºäº†è¿™é¡¹è¿åŠ¨è€Œä»˜å‡ºã€‚</p><p><img src="/upload/images/2019/08/24/1.png" alt="1"></p><p>è®²ä¸€ä¸ªå¬æ¥çš„æ•…äº‹~</p><p>å…¬å¸å°†è¦è¿›è¡Œè·³ç»³æ¯”èµ›ï¼Œå„ä¸ªå°ç»„ç§¯æå¤‡æˆ˜ï¼Œéœ€è¦å¤§å®¶ä¸€èµ·åŠªåŠ›é…åˆæ‰èƒ½æŠŠç»³è·³å¥½ã€‚</p><p>ç»„é•¿å‘ç°åˆšå¼€å§‹å¤§å®¶éƒ½å¾ˆéš¾ä¿æŒåŠ¨ä½œçš„ä¸€è‡´æ€§ï¼Œç»è¿‡ä¸€ç•ªç»ƒä¹ ä¹‹åï¼Œå¤§éƒ¨åˆ†äººèƒ½åŠ¨ä½œä¸€è‡´äº†ï¼Œè¿˜æœ‰ä¸€å°éƒ¨åˆ†äººåšèµ·æ¥æœ‰ç‚¹å›°éš¾ã€‚</p><p>ç»„é•¿è¯•ç€è®©æœ‰ç»éªŒçš„äººå¸¦ç€é‚£äº›è·³ä¸å¥½èŠ‚å¥çš„äººï¼Œè¿™æ ·åˆç»ƒä¹ äº†ä¸€æ®µæ—¶é—´ï¼Œç»å¤§éƒ¨åˆ†äººå·²ç»èƒ½å¾ˆå¥½çš„é…åˆäº†ï¼Œå…¶ä½™è·Ÿä¸å°‘èŠ‚å¥æˆ–è€…æ€ä¹ˆéƒ½è°ƒæ•™ä¸å¥½çš„äººåªèƒ½å»å•¦å•¦é˜Ÿé‚£é‡Œå‘å–ŠåŠ©å¨äº†ã€‚</p><hr><p>åœ¨æˆ‘ä»¬å›¢é˜Ÿä¸­ä¹Ÿä¸€æ ·ï¼Œæœ‰äººèƒ½å¸¦ç€å¤§å®¶å¾€å‰èµ°ï¼Œè‡ªç„¶å°±ä¼šæœ‰äººæ‹–ä½å¤§å®¶çš„åè…¿ï¼Œæˆ‘æ›¾ä»ŠæŠŠè¿™ç§ç°è±¡å«åšâ€œç›¸å¯¹è®ºâ€ã€‚åœ¨å›¢é˜Ÿä¸­ï¼Œå‘ç°æœ‰äººæ‰é˜Ÿäº†æˆ–è€…å¾ˆåƒåŠ›çš„åœ¨å‰è¿›ï¼Œè¯•ç€å»è°ƒæ•´ä¸€ä¸‹ä»–çš„å·¥ä½œæˆ–è€…æ‰¾äººå¸®å¸®ä»–ï¼Œç»è¿‡ä¸€æ®µæ—¶é—´çš„è°ƒæ•´å¦‚æœè¿˜æ˜¯æ²¡æœ‰å¥½è½¬ï¼Œåªèƒ½è®©ä»–å¦è°‹é«˜å°±äº†ï¼Œå¯¹å¤§å®¶éƒ½å¥½ã€‚</p><p>è™½ç„¶å¾ˆæ®‹å¿ï¼Œä½†äº‹å®ç¡®å®å¦‚æ­¤ï¼</p><p>æˆ‘ä»¬èƒ½åšçš„å°±æ˜¯æ‰¾å¥½è‡ªå·±çš„ä½ç½®ï¼Œå¹¶ä¸”åœ¨è¿™ä¸ªä½ç½®ä¸Šå‘æŒ¥è‡ªå·±æœ€å¤§çš„ä»·å€¼ã€‚</p><hr><p><strong>æ—¶é—´å¯ä»¥æ”¹å˜ä¸€åˆ‡ï¼Œä½†ä½ å¾—åšç‚¹ä»€ä¹ˆï¼</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å›¢é˜Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿˜æœ‰ä½ ä¸çŸ¥é“çš„Javaæšä¸¾ç‰¹æ€§(ä¸‹ç¯‡)</title>
      <link href="/2019/08/11/%E8%BF%98%E6%9C%89%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84Java%E6%9E%9A%E4%B8%BE%E7%89%B9%E6%80%A7-%E4%B8%8B%E7%AF%87/"/>
      <url>/2019/08/11/%E8%BF%98%E6%9C%89%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84Java%E6%9E%9A%E4%B8%BE%E7%89%B9%E6%80%A7-%E4%B8%8B%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>è¿™ç¯‡æ˜¯åšæ–‡ <a href="http://www.veryitman.com/2019/08/09/%E8%BF%98%E6%9C%89%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84Java%E6%9E%9A%E4%B8%BE%E7%89%B9%E6%80%A7%28%E4%B8%8A%E7%AF%87%29/">è¿˜æœ‰ä½ ä¸çŸ¥é“çš„Javaæšä¸¾ç‰¹æ€§(ä¸Šç¯‡)</a> çš„ä¸‹ç¯‡ï¼Œå¯ä»¥ç‚¹å‡»ä¸‹é¢çš„é“¾æ¥å‰å¾€ã€‚</p><p>æœ¬ç¯‡ä¸»è¦å†…å®¹ï¼š</p><ul><li>Java æšä¸¾æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç±»ï¼ŒèŠèŠå…¶æ–¹æ³•çš„é‡å†™</li><li>å¦‚ä½•ä½¿ç”¨æ¥å£æ¥ç»„ç»‡ Java æšä¸¾ï¼Ÿ</li><li>å¦‚ä½•ä½¿ç”¨æšä¸¾å®ç° Java çš„å•ä¾‹æ¨¡å¼</li><li>JDK æ•°æ®ç»“æ„ä¸­å…³äºæšä¸¾çš„é›†åˆ <code>EnumSet</code> å’Œå­—å…¸ <code>EnumMap</code></li></ul><h2 id="é‡å†™æšä¸¾çš„æ–¹æ³•"><a href="#é‡å†™æšä¸¾çš„æ–¹æ³•" class="headerlink" title="é‡å†™æšä¸¾çš„æ–¹æ³•"></a>é‡å†™æšä¸¾çš„æ–¹æ³•</h2><p>æ‰€æœ‰çš„æšä¸¾ç±»éƒ½ç»§æ‰¿è‡ª <code>Enum</code>ï¼Œåœ¨è¿™ä¸ªçˆ¶ç±»å½“ä¸­ <code>toString</code>ã€<code>equals</code> å’Œ<code>hashCode</code> çš„ä¸‰ä¸ªæ–¹æ³•ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ï¼Œæºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object other)</span> &#123; </span><br><span class="line"><span class="type">return</span> <span class="variable">this</span> <span class="operator">=</span>= other;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">super</span>.hashCode();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºåœ¨è¿™ä¸‰ä¸ªæ–¹æ³•å½“ä¸­ï¼Œæˆ‘ä»¬åªèƒ½é‡å†™ <code>toString</code> æ–¹æ³•ï¼Œå¦å¤–ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯ <code>final</code> ä¿®é¥°çš„æ–¹æ³•ï¼Œä¸å¯ä»¥è¢«å­ç±»é‡å†™ã€‚</p><p>æˆ‘ä»¬åœ¨è‡ªå®šä¹‰çš„æšä¸¾ä¸­ï¼Œå¯ä»¥é‡å†™  <code>toString</code> æ–¹æ³•çš„ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Color</span> &#123;</span><br><span class="line">    RED(<span class="string">&quot;red color&quot;</span>),</span><br><span class="line">    GREEN(<span class="string">&quot;green color&quot;</span>),</span><br><span class="line">    BLUE(<span class="string">&quot;blue color&quot;</span>),</span><br><span class="line">    YELLOW(<span class="string">&quot;yellow color&quot;</span>);</span><br><span class="line"></span><br><span class="line">    Color(String name) &#123;</span><br><span class="line">        _name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String _name;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;this.name: &quot;</span> + _name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³äº <code>Enum</code> çš„æºç ï¼Œå¯ä»¥åœ¨åšæ–‡ <a href="http://www.veryitman.com/2019/03/16/Java-%E6%9E%9A%E4%B8%BE%E7%9A%84%E6%9C%AC%E8%B4%A8/">Java æšä¸¾çš„æœ¬è´¨</a> ä¸­çš„æ–‡æœ«ç¿»é˜…ã€‚</p><p>å¯¹äº Java ä¸­æ‰€æœ‰æšä¸¾éƒ½æ˜¯ç»§æ‰¿è‡ª <code>Enum</code>ï¼Œå¤§å®¶å¯ä»¥å»ä½¿ç”¨ <code>javap</code> å‘½ä»¤åç¼–è¯‘çœ‹çœ‹ï¼Œå¦‚ä¸‹ä»£ç æ˜¯ <code>javap</code> åçš„ç®€å•ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">com</span>.veryitman.Color <span class="keyword">extends</span> <span class="title class_">java</span>.lang.Enum&lt;com.veryitman.Color&gt; &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> com.veryitman.Color RED;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> com.veryitman.Color GREEN;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> com.veryitman.Color BLUE;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> com.veryitman.Color YELLOW;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> com.veryitman.Color[] values();</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> com.veryitman.Color <span class="title function_">valueOf</span><span class="params">(java.lang.String)</span>;</span><br><span class="line">  <span class="keyword">static</span> &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° <code>Color</code> æ˜¯ç»§æ‰¿è‡ª <code>java.lang.Enum</code> çš„ï¼Œ<code>Enum</code> æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»å¹¶å®ç°äº† <code>Comparable</code> å’Œ <code>Serializable</code> è¿™ä¸¤ä¸ªæ¥å£ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Enum</span>&lt;E <span class="keyword">extends</span> <span class="title class_">Enum</span>&lt;E&gt;&gt; <span class="keyword">implements</span> <span class="title class_">Comparable</span>&lt;E&gt;, Serializable </span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨æ¥å£ç»„ç»‡æšä¸¾"><a href="#ä½¿ç”¨æ¥å£ç»„ç»‡æšä¸¾" class="headerlink" title="ä½¿ç”¨æ¥å£ç»„ç»‡æšä¸¾"></a>ä½¿ç”¨æ¥å£ç»„ç»‡æšä¸¾</h2><p>å½“æˆ‘ä»¬å®šä¹‰çš„æšä¸¾è¿‡å¤šä¸”åˆæœ‰å¾ˆå¤šåµŒå¥—ï¼Œå¯ä»¥ä½¿ç”¨æ¥å£æ¥ç»„ç»‡è¿™äº›æšä¸¾ï¼Œå°†å…¶å½’ç±»ï¼Œè¿™æ ·ä¸€æ¥ä¸ä»…ä»£ç çœ‹èµ·æ¥å¾ˆè§„èŒƒï¼Œå¹¶ä¸”ä¹Ÿå¾ˆå¥½ç®¡ç†ä»£ç ã€‚</p><p>å¦‚ä¸‹ç¤ºä¾‹ï¼Œä½¿ç”¨æ¥å£ <code>MobileTool</code> æ¥ç»„ç»‡ä¸¤ä¸ªæšä¸¾ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MobileTool</span> &#123;</span><br><span class="line">        <span class="keyword">enum</span> <span class="title class_">Phone</span> <span class="keyword">implements</span> <span class="title class_">MobileTool</span> &#123;</span><br><span class="line">            HUAWEI, iPhone, OPPO, XIAOMI</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">enum</span> <span class="title class_">Pad</span> <span class="keyword">implements</span> <span class="title class_">MobileTool</span> &#123;</span><br><span class="line">            iPad, WEPad, sPad</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ç®€å•çš„å¯ä»¥è¿™æ ·ä½¿ç”¨ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">MobileTool</span> <span class="variable">mphone</span> <span class="operator">=</span> MobileTool.Phone.HUAWEI;</span><br><span class="line">mphone = MobileTool.Phone.iPhone;</span><br><span class="line"></span><br><span class="line"><span class="type">MobileTool</span> <span class="variable">mpad</span> <span class="operator">=</span> MobileTool.Pad.iPad;</span><br><span class="line">mpad = MobileTool.Pad.sPad;</span><br></pre></td></tr></table></figure><h2 id="æšä¸¾å®ç°å•ä¾‹æ¨¡å¼"><a href="#æšä¸¾å®ç°å•ä¾‹æ¨¡å¼" class="headerlink" title="æšä¸¾å®ç°å•ä¾‹æ¨¡å¼"></a>æšä¸¾å®ç°å•ä¾‹æ¨¡å¼</h2><p>åœ¨ <code>Effective Java</code> è¿™æœ¬ä¹¦ç±ä¸­ï¼Œä½œè€…æœ‰ä¸ªè¿™æ ·ä¸‹é¢çš„æè¿°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;This approach is functionally equivalent to the public field approach, except that it is more concise, provides the serialization machinery for free, and provides an ironclad guarantee against multiple instantiation, even in the face of sophisticated serialization or reflection attacks. While this approach has yet to be widely adopted, a single-element enum type is the best way to implement a singleton.&quot;</span></span><br></pre></td></tr></table></figure><p>æ ¸å¿ƒçš„æ„æ€æ˜¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨æšä¸¾å®ç°å•ä¾‹çš„æ–¹æ³•è™½ç„¶è¿˜æ²¡æœ‰å¹¿æ³›é‡‡ç”¨ï¼Œä½†å•å…ƒç´ çš„æšä¸¾ç±»å‹å·²ç»æˆä¸ºå®ç° Java å•ä¾‹æ¨¡å¼çš„æœ€ä½³æ–¹æ³•ã€‚</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç”¨æšä¸¾å®ç°ä¸€ä¸‹å•ä¾‹æ¨¡å¼ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Foo</span> &#123;</span><br><span class="line">INSTANCE;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">printFoo</span><span class="params">()</span> &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;Foo here.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›¸æ¯” Java ä¸­å…¶ä»–çš„å•ä¾‹å®ç°æ–¹å¼ï¼Œæ­¤æ—¶æ­¤åˆ»ä½ ä¼šå‘ç°ï¼Œæšä¸¾å®ç°å•ä¾‹çš„ä»£ç ä¼šç²¾ç®€å¾ˆå¤šã€‚</p><p>é‚£ä¹ˆï¼Œæšä¸¾å®ç°å•ä¾‹æ¨¡å¼åˆ°åº•æœ‰å“ªäº›ä¼˜åŠ¿å‘¢ï¼Ÿæˆ–è€…æ¢å¥è¯è¯´ï¼Œå°±è¿™æ ·å®ç°å•ä¾‹é è°±å—ï¼Ÿ</p><p>ç»è¿‡å¤§é‡ä¾‹å­å’Œ Java ç¼–ç¨‹ä¸“å®¶çš„è®²è§£ï¼Œæšä¸¾å®ç°å•ä¾‹æ¨¡å¼ç›¸å½“é è°±ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹ä¸€äº›ç‰¹ç‚¹ï¼š</p><p>1ã€æšä¸¾å®ç°çš„å•ä¾‹æ¨¡å¼æ˜¯çº¿ç¨‹å®‰å…¨çš„</p><p>æœ¬è´¨ä¸Šé¢æ¥è®²ï¼Œæšä¸¾å®ç°çš„å•ä¾‹ä¹‹æ‰€ä»¥æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè¿™ä¸ªè·Ÿ Java çš„ç±»åŠ è½½æœºåˆ¶æœ‰å…³ã€‚ä»ä¸Šé¢åç¼–è¯‘çš„ä»£ç æ¥çœ‹ï¼Œæšä¸¾æ˜¯ <code>final class</code> å¹¶ä¸”æ¯ä¸ªæšä¸¾å€¼éƒ½æ˜¯ <code>static</code> çš„ï¼Œè¿™é‡Œç‰µæ‰¯åˆ° <code>ClassLoader</code> çš„ç›¸å…³çŸ¥è¯†ï¼Œå¦‚æœæœ‰å…´è¶£å»ºè®®å¤§å®¶å»ç ”ç©¶ä¸€ä¸‹ã€‚</p><p>æ€»ä¹‹ï¼Œå¯¹äºæˆ‘ä»¬ä»»ä½•ä¸€ä¸ªæšä¸¾åœ¨ç¬¬ä¸€æ¬¡è¢«çœŸæ­£ç”¨åˆ°ä¹‹æ—¶ï¼Œä¼šè¢« Java è™šæ‹ŸæœºåŠ è½½å¹¶ä¸”å®Œæˆåˆå§‹åŒ–ï¼Œè€Œè¿™ä¸ªåˆå§‹åŒ–è¿‡ç¨‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ‰€ä»¥ä½ éœ€è¦è®°ä½æšä¸¾å®ç°çš„å•ä¾‹æ¨¡å¼æ˜¯å¤šçº¿ç¨‹å®‰å…¨çš„å°±å¯ä»¥äº†ã€‚</p><p>2ã€æšä¸¾å¯è§£å†³åå°„&#x2F;ååºåˆ—åŒ–é—®é¢˜</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œä¸€èˆ¬çš„å•ä¾‹æ¨¡å¼éƒ½å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªæ˜¯å¯ä»¥é€šè¿‡åå°„è°ƒç”¨ï¼Œå¦ä¸€ä¸ªå°±æ˜¯å¯ä»¥é€šè¿‡åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ¥ç ´åå•ä¾‹ã€‚</p><p>ä¸€èˆ¬è§£å†³åå°„è°ƒç”¨å¯ä»¥é€šè¿‡ç§æœ‰æ„é€ æ–¹æ³•ä¸­åšå¤„ç†ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="title function_">Foo</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">synchronized</span> (<span class="built_in">this</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="literal">false</span> == flag) &#123;</span><br><span class="line">flag = <span class="literal">true</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;ä¸èƒ½åå¤åˆ›å»º&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>äº†è§£åºåˆ—åŒ–åŸç†çš„åŒå­¦ï¼Œå¯ä»¥é€šè¿‡åœ¨å•ä¾‹ç±»ä¸­å®ç° <code>readResolve</code> æ–¹æ³•å°±å¯ä»¥é¿å…ååºåˆ—åŒ–æ”»å‡»è¿™ä¸ªé—®é¢˜äº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Object <span class="title function_">readResolve</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> INSTANCE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Java çš„æšä¸¾çš„ååºåˆ—åŒ–å®ç°å¹¶ä¸æ˜¯é€šè¿‡åå°„å®ç°çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æšä¸¾çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ˜¯æœ‰ç»è¿‡ç‰¹æ®Šå®šåˆ¶å’Œå¤„ç†çš„ï¼Œè¿™å°±å¯ä»¥é¿å…ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ç”±äºåå°„è€Œå¯¼è‡´çš„å•ä¾‹è¢«ç ´åé—®é¢˜ã€‚</p><p>æ€»ä¹‹ï¼Œæšä¸¾å®ç°çš„å•ä¾‹æ¨¡å¼ä¸ä»…å¯ä»¥é˜²æ­¢åå°„ç ´åï¼Œè¿˜å¯ä»¥é˜²æ­¢åºåˆ—åŒ–ç ´åå•ä¾‹ã€‚</p><p>é™¤æšä¸¾å®ç°å•è¿™ç§æ–¹å¼ä»¥å¤–ï¼Œæˆ‘ä¸€èˆ¬ä½¿ç”¨ä¸‹é¢ä¸¤ç§æ–¹å¼æ¥å®ç°å•ä¾‹æ¨¡å¼ã€‚</p><p><strong>é¥¿æ±‰å¼çš„å•ä¾‹æ¨¡å¼å†™æ³•</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Foo</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Foo</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Foo</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Foo</span> <span class="params">()</span> &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Foo <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é™æ€å†…éƒ¨ç±»å®ç°å•ä¾‹æ¨¡å¼</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Foo</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">FooHolder</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Foo</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Foo</span>();  </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Foo</span> <span class="params">()</span> &#123;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Foo <span class="title function_">getInstance</span><span class="params">()</span> &#123;  </span><br><span class="line">    <span class="keyword">return</span> FooHolder.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><h2 id="æšä¸¾é›†åˆ"><a href="#æšä¸¾é›†åˆ" class="headerlink" title="æšä¸¾é›†åˆ"></a>æšä¸¾é›†åˆ</h2><p><code>EnumSet</code> æ˜¯ä¸€ä¸ªä¸“ä¸ºæšä¸¾è®¾è®¡çš„é›†åˆç±»ï¼Œ<code>EnumSet</code> ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½å¿…é¡»æ˜¯æŒ‡å®šæšä¸¾ç±»å‹çš„æšä¸¾å€¼ã€‚</p><p><code>EnumSet</code> ç±»ç»“æ„å›¾å¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/08/11/1.png" alt="1"></p><p><code>EnumSet</code> æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ— æ³•è¢«å®ä¾‹åŒ–ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡é™æ€æ–¹æ³•è·å–è¯¥ç±»çš„å®ä¾‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">EnumSet</span>&lt;E <span class="keyword">extends</span> <span class="title class_">Enum</span>&lt;E&gt;&gt; <span class="keyword">extends</span> <span class="title class_">AbstractSet</span>&lt;E&gt;</span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">Cloneable</span>, java.io.Serializable</span><br></pre></td></tr></table></figure><p><code>EnumMap</code> ç±»ç»“æ„å›¾å¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/08/11/2.png" alt="1"></p><p><code>EnumMap</code> å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EnumMap</span>&lt;K <span class="keyword">extends</span> <span class="title class_">Enum</span>&lt;K&gt;, V&gt; <span class="keyword">extends</span> <span class="title class_">AbstractMap</span>&lt;K, V&gt;</span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">java</span>.io.Serializable, Cloneable</span><br></pre></td></tr></table></figure><p><code>EnumSet</code> ä¿è¯é›†åˆä¸­çš„å…ƒç´ ä¸é‡å¤ï¼›<code>EnumMap</code> ä¸­çš„  key æ˜¯ enum ç±»å‹ï¼Œè€Œ value åˆ™å¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚</p><p>å…³äºè¿™ä¸¤ä¸ªæ•°æ®ç»“æ„çš„ä½¿ç”¨æ–¹æ³•ï¼Œå¤§å®¶å¯ä»¥å‚è€ƒ JDK æ‰‹å†Œã€‚</p><hr><p><strong>èµ äººç«ç‘°ï¼Œæ‰‹ç•™ä½™é¦™~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java enum </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿˜æœ‰ä½ ä¸çŸ¥é“çš„Javaæšä¸¾ç‰¹æ€§(ä¸Šç¯‡)</title>
      <link href="/2019/08/09/%E8%BF%98%E6%9C%89%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84Java%E6%9E%9A%E4%B8%BE%E7%89%B9%E6%80%A7(%E4%B8%8A%E7%AF%87)/"/>
      <url>/2019/08/09/%E8%BF%98%E6%9C%89%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84Java%E6%9E%9A%E4%B8%BE%E7%89%B9%E6%80%A7(%E4%B8%8A%E7%AF%87)/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åšæ–‡ <a href="http://www.veryitman.com/2019/03/16/Java-%E6%9E%9A%E4%B8%BE%E7%9A%84%E6%9C%AC%E8%B4%A8/">Java æšä¸¾çš„æœ¬è´¨</a> è·Ÿå¤§å®¶ä¸€èµ·å­¦ä¹ äº† Java è¯­è¨€ä¸­æšä¸¾åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œæ¢ç´¢å…¶æœ¬è´¨å’ŒåŸç†ã€‚ç”¨ä¸€å¥è¯æ¥æ¦‚æ‹¬å…¶æœ¬è´¨å°±æ˜¯ï¼šâ€œJava ä¸­çš„æšä¸¾æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ Java ç±»â€ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥ç‚¹å‡»äº†è§£ä¸Šé¢é‚£ç¯‡æ–‡ç« ã€‚</p><p>ä»Šå¤©è·Ÿå¤§å®¶ä¸€èµ·å­¦ä¹ å’Œæ€»ç»“ä¸€ä¸‹ Java ä¸­çš„æšä¸¾çš„å…¶ä»–ç‰¹æ€§å’Œç”¨é€”ï¼Œç”±äºå†…å®¹è¾ƒå¤šï¼Œè¿™æ¬¡çš„åˆ†äº«åˆ†ä¸ºä¸¤ç¯‡æ–‡ç« æ¥å†™ï¼Œæ¬¢è¿å¤§å®¶æ‹ç –ã€æŒ‡æ­£å’Œäº¤æµï¼</p><p>æœ¬ç¯‡ä¸»è¦å†…å®¹ï¼š</p><ul><li>Java switch è¯­å¥æ”¯æŒæšä¸¾ç±»å‹ä»¥åŠæ³¨æ„äº‹é¡¹</li><li>Java æšä¸¾çš„å¸¸é‡ä½¿ç”¨</li><li>å¦‚ä½•åœ¨è‡ªå®šä¹‰æšä¸¾ä¸­è‡ªå®šä¹‰æˆå‘˜å˜é‡å’Œæˆå‘˜æ–¹æ³•ã€é™æ€æ–¹æ³•</li><li>Java æšä¸¾å®ç°æ¥å£</li></ul><p>ä¸‹ç¯‡ä¸»è¦å†…å®¹ï¼š</p><ul><li>Java æšä¸¾æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç±»ï¼ŒèŠèŠå…¶æ–¹æ³•çš„é‡å†™</li><li>å¦‚ä½•ä½¿ç”¨æ¥å£æ¥ç»„ç»‡ Java æšä¸¾ï¼Ÿ</li><li>JDK æ•°æ®ç»“æ„ä¸­å…³äºæšä¸¾çš„é›†åˆ <code>EnumSet</code> å’Œå­—å…¸ <code>EnumMap</code></li></ul><h2 id="switch-è¯­å¥æ”¯æŒæšä¸¾"><a href="#switch-è¯­å¥æ”¯æŒæšä¸¾" class="headerlink" title="switch è¯­å¥æ”¯æŒæšä¸¾"></a>switch è¯­å¥æ”¯æŒæšä¸¾</h2><p>JDK1.5 æ‰å¼€å§‹æœ‰æšä¸¾ç±»å‹ï¼ŒåŒæ—¶å¯çˆ±çš„ Java ç»„ç»‡ä¸°å¯Œäº† <code>switch</code> è¯­å¥ï¼Œå³æ”¯æŒæšä¸¾ã€‚</p><p>æˆ‘ä»¬è¿˜æ˜¯åŠ¨æ‰‹å†™ä¸ªä¾‹å­~</p><p>å®šä¹‰ä¸€ä¸ªæšä¸¾ <code>Color</code>ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Color</span> &#123;</span><br><span class="line">RED(<span class="string">&quot;red color&quot;</span>, <span class="number">0</span>), </span><br><span class="line">GREEN(<span class="string">&quot;green color&quot;</span>, <span class="number">1</span>),</span><br><span class="line">BLUE(<span class="string">&quot;blue color&quot;</span>, <span class="number">2</span>), </span><br><span class="line">YELLOW(<span class="string">&quot;yellow color&quot;</span>, <span class="number">3</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// æ„é€ æ–¹æ³•</span></span><br><span class="line">Color(String name, <span class="type">int</span> id) &#123;</span><br><span class="line">_name = name;</span><br><span class="line">_id = id;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">private</span> String _name;</span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> _id;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> _name;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> _id;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Color <span class="title function_">getColor</span><span class="params">(<span class="type">int</span> max)</span> &#123;</span><br><span class="line"><span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>(System.currentTimeMillis());</span><br><span class="line"><span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> random.nextInt(max);</span><br><span class="line"><span class="keyword">switch</span> (num) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span> Color.RED;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line"><span class="keyword">return</span> Color.GREEN;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line"><span class="keyword">return</span> Color.BLUE;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line"><span class="keyword">return</span> Color.YELLOW;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"><span class="keyword">return</span> Color.BLUE;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºæšä¸¾ <code>Color</code> æä¾›äº†ä¸€ä¸ªé™æ€æ–¹æ³• <code>getColor</code>ï¼Œå¯ä»¥è·å–éšæœºçš„é¢œè‰²å€¼ã€‚</p><p>é‚£ä¹ˆï¼Œå¯ä»¥ç»“åˆ <code>switch</code> è¯­å¥è¿™æ ·ä½¿ç”¨ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> Color.values().length;</span><br><span class="line"><span class="type">Color</span> <span class="variable">color</span> <span class="operator">=</span> Color.getColor(len);</span><br><span class="line"><span class="keyword">switch</span> (color) &#123;</span><br><span class="line"><span class="keyword">case</span> RED:</span><br><span class="line">System.out.println(<span class="string">&quot;select &quot;</span> + <span class="string">&quot;RED&quot;</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> GREEN:</span><br><span class="line">System.out.println(<span class="string">&quot;select &quot;</span> + <span class="string">&quot;GREEN&quot;</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> BLUE:</span><br><span class="line">System.out.println(<span class="string">&quot;select &quot;</span> + <span class="string">&quot;BLUE&quot;</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> YELLOW:</span><br><span class="line">System.out.println(<span class="string">&quot;select &quot;</span> + <span class="string">&quot;YELLOW&quot;</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">System.out.println(<span class="string">&quot;select &quot;</span> + <span class="string">&quot;unknow!!&quot;</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œ<code>switch</code> è¯­å¥ä¸­æ¡ä»¶å€¼æ˜¯ <code>Color</code> å¯¹è±¡ã€‚</p><p>è¿™é‡Œæé†’å¤§å®¶è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœ <code>case</code> çš„æ¡ä»¶å¸¦ä¸Šç±»çš„åå­—ï¼Œä»£ç æ˜¯æ— æ³•é€šè¿‡ç¼–è¯‘çš„ã€‚å¦‚ä¸‹é¢çš„ä»£ç ï¼ˆé”™è¯¯ç¤ºä¾‹ï¼‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Error</span></span><br><span class="line"><span class="keyword">case</span> Color.RED:</span><br><span class="line">System.out.println(<span class="string">&quot;select &quot;</span> + <span class="string">&quot;RED&quot;</span>);</span><br><span class="line">    <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘çš„é”™è¯¯ä¿¡æ¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error: An <span class="keyword">enum</span> <span class="title class_">switch</span> <span class="keyword">case</span> label must be the unqualified name of an enumeration constant</span><br></pre></td></tr></table></figure><p>å³ <code>switch</code> <code>case</code> è¯­å¥ç»“åˆæšä¸¾ä½¿ç”¨æ—¶ï¼Œåªèƒ½å†™æšä¸¾ç±»å®šä¹‰çš„å˜é‡åç§°ï¼Œä¸èƒ½åŠ ç±»åã€‚</p><h2 id="å½“å¸¸é‡ä½¿ç”¨"><a href="#å½“å¸¸é‡ä½¿ç”¨" class="headerlink" title="å½“å¸¸é‡ä½¿ç”¨"></a>å½“å¸¸é‡ä½¿ç”¨</h2><p>ä¸€èˆ¬åœ¨ Java ä¸­æˆ‘ä»¬å®šä¹‰å¸¸é‡æœ€å¸¸ç”¨çš„æ–¹å¼å°±æ˜¯ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">MAX_NAME_LENGTH</span> <span class="operator">=</span> <span class="number">0x1112</span>;</span><br></pre></td></tr></table></figure><p>æœ‰äº†æšä¸¾ä¹‹åï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æšä¸¾æ¥å®šä¹‰å¸¸é‡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Color</span> &#123;</span><br><span class="line">    YELLOW, BLANK, RED, GREEN</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥æŠŠä¸€äº›ç›¸å…³çš„å¸¸é‡æ”¾åˆ°å®šä¹‰çš„æšä¸¾å½“ä¸­äº†ã€‚</p><h2 id="è‡ªå®šä¹‰æ–¹æ³•ã€æˆå‘˜å˜é‡"><a href="#è‡ªå®šä¹‰æ–¹æ³•ã€æˆå‘˜å˜é‡" class="headerlink" title="è‡ªå®šä¹‰æ–¹æ³•ã€æˆå‘˜å˜é‡"></a>è‡ªå®šä¹‰æ–¹æ³•ã€æˆå‘˜å˜é‡</h2><p>ä¸Šé¢çš„ä¾‹å­ä¸­è‡ªå®šä¹‰çš„ä¸€ä¸ªæšä¸¾ <code>Color</code>ï¼Œå¤§å®¶å¯ä»¥çœ‹åˆ°å¯ä»¥ç»™å®ƒæ·»åŠ æˆå‘˜å˜é‡ <code>_id</code>ã€<code>_name</code>ï¼Œæ„é€ æ–¹æ³•å’Œå…¶ä»–æ–¹æ³• <code>getColor</code>ï¼ˆé™æ€æ–¹æ³•ï¼‰ã€‚</p><p>å¦‚æœè¿™éƒ¨åˆ†å¾ˆéš¾ç†è§£ï¼Œå»ºè®®å»é˜…è¯» <a href="http://www.veryitman.com/2019/03/16/Java-%E6%9E%9A%E4%B8%BE%E7%9A%84%E6%9C%AC%E8%B4%A8/">Java æšä¸¾çš„æœ¬è´¨</a> è¿™ç¯‡æ–‡ç« ã€‚</p><h2 id="å®ç°æ¥å£"><a href="#å®ç°æ¥å£" class="headerlink" title="å®ç°æ¥å£"></a>å®ç°æ¥å£</h2><p>æ‰€æœ‰çš„æšä¸¾ç±»éƒ½ç»§æ‰¿è‡ª <code>Enum</code>ï¼Œå› ä¸º Java ä¸æ”¯æŒå¤šç»§æ‰¿ï¼Œæ‰€ä»¥æšä¸¾æ— æ³•ç»§æ‰¿å…¶å®ƒç±»ã€‚</p><p>æšä¸¾æ—¢ç„¶æ˜¯å’Œ Java çš„æ™®é€šç±»åŸºæœ¬ä¸€æ ·ï¼Œé‚£ä¹ˆï¼Œæšä¸¾å½“ç„¶ä¹Ÿå¯ä»¥å®ç°æ¥å£ã€‚</p><p>ä¸‹é¢æ˜¯æšä¸¾ <code>Color</code> å®ç°æ¥å£ <code>Paint</code> çš„ä¾‹å­ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Paint</span> &#123;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">setColor</span><span class="params">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Color</span> <span class="keyword">implements</span> <span class="title class_">Paint</span> &#123;</span><br><span class="line">    RED(<span class="string">&quot;red color&quot;</span>),</span><br><span class="line">    GREEN(<span class="string">&quot;green color&quot;</span>),</span><br><span class="line">    BLUE(<span class="string">&quot;blue color&quot;</span>),</span><br><span class="line">    YELLOW(<span class="string">&quot;yellow color&quot;</span>);</span><br><span class="line"></span><br><span class="line">    Color(String name) &#123;</span><br><span class="line">        _name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String _name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setColor</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Current paint color: &quot;</span> + _name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥é‡‡ç”¨åŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼ï¼Œè®©æ¯ä¸ªæšä¸¾å€¼å®ç°æ¥å£ <code>Paint</code> çš„æ–¹æ³•ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Color</span> <span class="keyword">implements</span> <span class="title class_">Paint</span> &#123;</span><br><span class="line">        RED(<span class="string">&quot;red color&quot;</span>) &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setColor</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Current paint color: &quot;</span> + RED._name);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        GREEN(<span class="string">&quot;green color&quot;</span>) &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setColor</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Current paint color: &quot;</span> + GREEN._name);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        BLUE(<span class="string">&quot;blue color&quot;</span>) &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setColor</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Current paint color: &quot;</span> + BLUE._name);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        YELLOW(<span class="string">&quot;yellow color&quot;</span>) &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setColor</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Current paint color: &quot;</span> + YELLOW._name);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        Color(String name) &#123;</span><br><span class="line">            _name = name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> String _name;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setColor</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Current paint color: &quot;</span> + _name);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å†™ä¸ªæ–¹æ³•æµ‹è¯•ä¸€ä¸‹ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (Color color : Color.values()) &#123;</span><br><span class="line">        color.setColor();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Current paint color: red color</span><br><span class="line">Current paint color: green color</span><br><span class="line">Current paint color: blue color</span><br><span class="line">Current paint color: yellow color</span><br></pre></td></tr></table></figure><hr><p><strong>äººç”Ÿæ²¡æœ‰æ°¸è¿œçš„èµ¢å®¶ï¼Œåˆ‡å‹¿å¤§å–œå¤§æ‚²ï¼Œè¦ä»¥å¹³å¸¸å¿ƒå¯¹å¾…ä¸€åˆ‡~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java enum switch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡: å­¦ä¹ å‡ ä¸ªå®¹æ˜“æ··æ·†çš„URLæ³¨è§£</title>
      <link href="/2019/08/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E5%AD%A6%E4%B9%A0%E5%87%A0%E4%B8%AA%E5%AE%B9%E6%98%93%E6%B7%B7%E6%B7%86%E7%9A%84URL%E6%B3%A8%E8%A7%A3/"/>
      <url>/2019/08/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E5%AD%A6%E4%B9%A0%E5%87%A0%E4%B8%AA%E5%AE%B9%E6%98%93%E6%B7%B7%E6%B7%86%E7%9A%84URL%E6%B3%A8%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="äº†è§£-URL"><a href="#äº†è§£-URL" class="headerlink" title="äº†è§£ URL"></a>äº†è§£ URL</h2><p>é¦–å…ˆï¼Œå¤§å®¶éœ€è¦çŸ¥é“ä¸‹é¢è¿™ä¸‰ä¸ªä¸œè¥¿çš„å®šä¹‰ï¼š</p><blockquote><p>URIï¼ŒUniversal Resource Identifierï¼Œç»Ÿä¸€èµ„æºæ ‡å¿—ç¬¦</p><p>URLï¼ŒUniversal Resource Locatorï¼Œç»Ÿä¸€èµ„æºå®šä½ç¬¦</p><p>URNï¼ŒUniversal Resource Nameï¼Œç»Ÿä¸€èµ„æºåç§°</p></blockquote><p>åœ¨ WWW ä¸Šï¼Œæ¯ä¸€ä¿¡æ¯èµ„æºéƒ½æœ‰ç»Ÿä¸€çš„ä¸”åœ¨ç½‘ä¸Šå”¯ä¸€çš„åœ°å€ï¼Œè¯¥åœ°å€å°±å« URLï¼Œå®ƒæ˜¯ WWW çš„ç»Ÿä¸€èµ„æºå®šä½æ ‡å¿—ï¼Œå°±æ˜¯æŒ‡ç½‘ç»œåœ°å€ã€‚</p><p>URL æ˜¯ URI çš„å­é›†ï¼Œæ‰€æœ‰çš„ URL éƒ½æ˜¯ URIï¼Œä½†ä¸æ˜¯æ¯ä¸ª URI éƒ½æ˜¯ URLï¼Œè¿˜æœ‰å¯èƒ½æ˜¯ URNï¼Œä»–ä»¬çš„å…³ç³»å¯ä»¥ç”¨ä¸‹é¢çš„å›¾æ¥è¡¨ç¤ºï¼š</p><p><img src="/upload/images/2019/08/04/1.png"></p><p>æ¢å¥è¯è¯´ï¼ŒURI åˆ†ä¸ºä¸‰ç§ï¼ŒURL æˆ–è€… URN æˆ–è€…æ˜¯ URL å’Œ URI çš„ç»„åˆã€‚</p><p>ä¸ç®¡æ€ä¹ˆè¯´ï¼Œå¤§å®¶å¹³æ—¶ä½¿ç”¨HTTPè¯·æ±‚çš„åœ°å€åŸºæœ¬éƒ½æ˜¯ç§°ä¹‹ä¸º URLï¼Œæ‰€ä»¥æš‚æ—¶ä¸å¿…è¦çº ç»“äºä¸‰è€…çš„åŒºåˆ«ä¹‹ä¸­è€Œæ— æ³•è‡ªæ‹”ï¼Œææ‡‚ URL çš„ç»„æˆéƒ¨åˆ†å’Œè§„èŒƒæ‰æ˜¯é‡ç‚¹ã€‚</p><p>URL ç”±ä¸‰éƒ¨åˆ†ç»„æˆå³èµ„æºç±»å‹ã€å­˜æ”¾èµ„æºçš„ä¸»æœºåŸŸåå’Œèµ„æºæ–‡ä»¶åã€‚</p><p>URL çš„ä¸€èˆ¬è¯­æ³•æ ¼å¼ä¸ºï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scheme:[//[user[:password]@]host[:port]][/path][?query][#fragment]</span><br></pre></td></tr></table></figure><p>å…·ä½“å‚æ•°é‡Šä¹‰å¦‚ä¸‹ï¼š</p><ul><li><p>schemeï¼šä¼ é€åè®®æœ‰äº›åœ°æ–¹ä¹Ÿå†™ä½œprotocolï¼Œå¦‚httpã€httpsã€ftpç­‰</p></li><li><p>user:passwordï¼šè®¿é—®èµ„æºéœ€è¦çš„å‡­è¯ä¿¡æ¯ï¼Œå¯çœç•¥</p></li><li><p>hostï¼šæœåŠ¡å™¨åœ°å€ï¼Œé€šå¸¸ä¸ºåŸŸåï¼Œæœ‰æ—¶ä¸ºIPåœ°å€</p></li><li><p>portï¼šç«¯å£å·ï¼Œä»¥æ•°å­—æ–¹å¼è¡¨ç¤ºï¼Œä¸€èˆ¬ä½¿ç”¨ç«¯å£é»˜è®¤å€¼80ï¼Œå¯çœç•¥</p></li><li><p>pathï¼šè·¯å¾„ï¼Œä»¥â€œ&#x2F;â€å­—ç¬¦åŒºåˆ«è·¯å¾„ä¸­çš„æ¯ä¸€ä¸ªç›®å½•åç§°</p></li><li><p>queryï¼šæŸ¥è¯¢ï¼ŒGETæ¨¡å¼çš„çª—ä½“å‚æ•°ï¼Œä»¥â€œ?â€å­—ç¬¦ä¸ºèµ·ç‚¹ï¼Œæ¯ä¸ªå‚æ•°ä»¥â€œ&amp;â€éš”å¼€ï¼Œå†ä»¥â€œ&#x3D;â€åˆ†å¼€å‚æ•°åç§°ä¸æ•°æ®ï¼Œé€šå¸¸ä»¥UTF8çš„URLç¼–ç ï¼Œé¿å¼€å­—ç¬¦å†²çªçš„é—®é¢˜</p></li><li><p>fragmentï¼šç‰‡æ®µï¼Œä»¥â€œ#â€å­—ç¬¦ä¸ºèµ·ç‚¹</p></li></ul><p>å¸¸ç”¨çš„ URL å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://www.veryitman.com/article/name=itman&amp;pwd=123</span><br><span class="line"></span><br><span class="line">http://www.veryitman.com/article/1/2</span><br></pre></td></tr></table></figure><p>å¤§éƒ¨åˆ†çš„ç¼–ç¨‹è¯­è¨€éƒ½ä¼šæœ‰é’ˆå¯¹ URL å¤„ç†çš„ç³»ç»Ÿå‡½æ•°åº“ï¼Œæœ€å¸¸ç”¨çš„å¦‚ <code>URLEncode</code>ã€<code>URLDecode</code> é’ˆå¯¹ URL ç¼–è§£ç çš„ç±»ã€‚</p><p>ä¸‹é¢è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹åœ¨ SpringBoot ä¸­ç»å¸¸ä½¿ç”¨çš„ <code>RequestParam</code>ã€<code>QueryParam</code>ã€<code>PathVariable</code> å’Œ <code>PathParam</code> è¿™ä¸‰ä¸ªæ³¨è§£ã€‚</p><h2 id="RequestParam"><a href="#RequestParam" class="headerlink" title="@RequestParam"></a>@RequestParam</h2><p>æ³¨è§£ @RequestParam å¯ä»¥ä»æ¯ä¸ª HTTP Request ä¸­è·å–å‚æ•°ï¼Œè¯¥æ³¨è§£æ”¯æŒä¸‹é¢å››ç§å‚æ•°ï¼š</p><ul><li>defaultValue å¦‚æœæœ¬æ¬¡è¯·æ±‚æ²¡æœ‰æºå¸¦è¿™ä¸ªå‚æ•°ï¼Œæˆ–è€…å‚æ•°ä¸ºç©ºï¼Œé‚£ä¹ˆå°±ä¼šå¯ç”¨é»˜è®¤å€¼</li><li>name ç»‘å®šæœ¬æ¬¡å‚æ•°çš„åç§°ï¼Œè¦è·Ÿ URL ä¸Šé¢çš„ä¸€æ ·ï¼Œå¦åˆ™ä¼šè¯·æ±‚å¤±è´¥</li><li>required ç”¨æ¥æ ‡ç¤ºå¯¹åº”çš„å‚æ•°æ˜¯ä¸æ˜¯å¿…é¡»çš„ï¼Œé»˜è®¤æ˜¯ trueï¼Œå¦‚æœå¯¹æŸä¸ªå‚æ•°åšå¯é€‰å€¼å¯ä»¥è®¾ç½®è¯¥å€¼ä¸º false</li><li>value æ˜¯ name å±æ€§çš„ä¸€ä¸ªåˆ«åï¼Œvalue å’Œ name åªèƒ½å‡ºç°ä¸€ä¸ªå¦åˆ™ä¼šè¯·æ±‚æŠ¥é”™</li></ul><p>ä¸‹é¢æ˜¯æ³¨è§£ @RequestParam çš„æºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.springframework.web.bind.annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Documented;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.annotation.AliasFor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.PARAMETER&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> RequestParam &#123;</span><br><span class="line">    <span class="meta">@AliasFor(&quot;name&quot;)</span></span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AliasFor(&quot;value&quot;)</span></span><br><span class="line">    String <span class="title function_">name</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">required</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">defaultValue</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;\n\t\t\n\t\t\n\ue000\ue001\ue002\n\t\t\t\t\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé‡ç‚¹è¯´ä¸€ä¸‹ value è¿™ä¸ªå€¼ï¼Œä¸¾ä¸ªä¾‹å­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/friends&quot;, method = RequestMethod.GET)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getFrieds</span><span class="params">(<span class="meta">@RequestParam(value = &quot;page&quot;)</span> String page, <span class="meta">@RequestParam(value = &quot;pageSize&quot;)</span> String pageSize)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;Get friend list. &quot;</span> + <span class="string">&quot;page: &quot;</span> + page + <span class="string">&quot; - pagesize: &quot;</span> + pageSize;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ <code>page</code> å’Œ <code>pageSize</code>ï¼Œæ³¨æ„è¿™é‡Œçš„å‚æ•° <code>pageSize</code> æ˜¯å¤§å†™çš„ï¼Œåœ¨æ³¨è§£ @RequestParam ä¸­å¯¹åº”çš„ value å€¼ä¹Ÿæ˜¯å¤§å†™çš„ <code>pageSize</code>ï¼Œç°åœ¨å¯åŠ¨å·¥ç¨‹åï¼Œè¯·æ±‚ä¸€ä¸‹ä¸‹é¢çš„åœ°å€ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/friends?page=1&amp;pageSize=2</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ—¶å€™å¯ä»¥æ­£å¸¸è®¿é—®ä¸”èƒ½è¿”å›æ­£ç¡®çš„ç»“æœï¼Œå‡å¦‚æˆ‘ä»¬å°† @RequestParam ä¸­å¯¹åº”çš„ value å€¼æ”¹ä¸ºå°å†™çš„ <code>pagesize</code> å†æ¥ä½¿ç”¨ä¸Šé¢çš„åœ°å€è®¿é—®å‘¢ï¼Ÿ</p><p>å°±ä¼šæŠ¥ä¸‹é¢çš„é”™è¯¯ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2019/08/04/2.png"></p><p>æ‰€ä»¥éœ€è¦ä¿®æ”¹è®¿é—®åœ°å€ï¼Œå³å°† <code>pageSize</code> æ”¹ä¸º <code>pagesize</code>ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/friends?page=1&amp;pagesize=2</span><br></pre></td></tr></table></figure><p>é‚£æˆ‘ä»¬å†æ€è€ƒå¦å¤–ä¸€ä¸ªé—®é¢˜ï¼Œæ˜¯å¦å¯ä»¥ä¿®æ”¹æ³¨è§£ <code>@RequestParam</code> ä¸­å¯¹åº”çš„valueå€¼çš„ page å’Œ pageSize ä¸ºå…¶ä»–çš„æ¯”å¦‚ xxã€yyï¼Ÿ</p><p>åŠ¨æ‰‹è¯•è¯•å°±çŸ¥é“äº†ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/friends&quot;, method = RequestMethod.GET)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getFrieds</span><span class="params">(<span class="meta">@RequestParam(value = &quot;xx&quot;)</span> String page, <span class="meta">@RequestParam(value = &quot;yy&quot;)</span> String pageSize)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Get friend list. &quot;</span> + <span class="string">&quot;page: &quot;</span> + page + <span class="string">&quot; - pagesize: &quot;</span> + pageSize;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡½æ•°æœ¬èº«çš„å‚æ•°åç§° page å’Œ pageSize æ²¡æœ‰åšä»»ä½•ä¿®æ”¹ï¼Œåªæ˜¯å°†æ³¨è§£ä¸­çš„ä¿®æ”¹ä¸º <code>xx</code> å’Œ <code>yy</code> äº†ï¼Œå†æ¬¡è®¿é—®ä¸‹é¢çš„URLï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/friends?xx=1&amp;yy=2</span><br></pre></td></tr></table></figure><p>ä¸€å¦‚æ—¢å¾€çš„æ­£å¸¸~ æ‰€ä»¥ï¼Œå¯¹äºæ³¨è§£ <code>@RequestParam</code> çš„å‚æ•°ï¼ŒURLä¸­å¯¹åº”çš„å‚æ•°ä¸€å®šè¦å’Œvalueå¯¹åº”ã€‚</p><h2 id="QueryParam"><a href="#QueryParam" class="headerlink" title="@QueryParam"></a>@QueryParam</h2><p>è¿™ä¸ªè·Ÿ @RequestParam åŸºæœ¬ä¸€è‡´ï¼Œéƒ½æ˜¯ä»¥é”®å€¼å¯¹çš„æ–¹å¼æ¥æˆ–è€…å‚æ•°ã€‚</p><p>åªä¸è¿‡ï¼Œè¯¥æ³¨è§£éœ€è¦åœ¨ pom æ–‡ä»¶ä¸­å¯¼å…¥ä¾èµ–ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;javax.ws.rs&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;jsr311-api&lt;/artifactId&gt;</span><br><span class="line">&lt;version&gt;1.1.1&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨å·¥ç¨‹ç±»ä¸­éœ€è¦å¯¼å…¥åŒ…ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.ws.rs.QueryParam;</span><br></pre></td></tr></table></figure><p>æ³¨è§£ @QueryParam æºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.PARAMETER, ElementType.METHOD, ElementType.FIELD&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> QueryParam &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Defines the name of the HTTP query parameter whose value will be used</span></span><br><span class="line"><span class="comment">     * to initialize the value of the annotated method argument, class field or</span></span><br><span class="line"><span class="comment">     * bean property. The name is specified in decoded form, any percent encoded</span></span><br><span class="line"><span class="comment">     * literals within the value will not be decoded and will instead be </span></span><br><span class="line"><span class="comment">     * treated as literal text. E.g. if the parameter name is &quot;a b&quot; then the </span></span><br><span class="line"><span class="comment">     * value of the annotation is &quot;a b&quot;, &lt;i&gt;not&lt;/i&gt; &quot;a+b&quot; or &quot;a%20b&quot;.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° @QueryParam åªæœ‰ value ä¸€ä¸ªå±æ€§ï¼Œvalue å¯¹åº”çš„å€¼è¦å’Œå‡½æ•°å‚æ•°ä¿æŒä¸€è‡´ï¼Œå¦åˆ™å¯èƒ½è¯·æ±‚ä¼šå¾—ä¸åˆ°é¢„æœŸçš„å“åº”ç»“æœï¼Œè¿™ä¸ªè·Ÿæ³¨è§£ @RequestParam æ˜¯ä¸ä¸€æ ·çš„ã€‚ä¸‹é¢ç»™ä¸ªç¤ºä¾‹ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/friends&quot;, method = RequestMethod.GET)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getFrieds</span><span class="params">(<span class="meta">@QueryParam(value = &quot;page&quot;)</span> String page, <span class="meta">@QueryParam(value = &quot;pageSize&quot;)</span> String pageSize)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;Get friend list. &quot;</span> + <span class="string">&quot;page: &quot;</span> + page + <span class="string">&quot; - pageSize: &quot;</span> + pageSize;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨è¯·æ±‚ä¸‹é¢çš„åœ°å€å³å¯ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/friends?page=1&amp;pageSize=2</span><br></pre></td></tr></table></figure><h2 id="PathVariable"><a href="#PathVariable" class="headerlink" title="@PathVariable"></a>@PathVariable</h2><p>æ³¨è§£ @PathVariable ä¸ä¸Šé¢çš„åˆšè¯´çš„æ³¨è§£ @RequestParam æ˜¯ä¸åŒçš„ï¼Œ@PathVariable éœ€è¦ä» URI ä¸­è·å–å‚æ•°ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/friends/&#123;page&#125;/&#123;pagesize&#125;&quot;, method = RequestMethod.GET)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getFrieds</span><span class="params">(<span class="meta">@PathVariable(value = &quot;page&quot;)</span> String page, <span class="meta">@PathVariable(value = &quot;pagesize&quot;)</span> String pageSize)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Get friend list. &quot;</span> + <span class="string">&quot;page: &quot;</span> + page + <span class="string">&quot; - pagesize: &quot;</span> + pageSize;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ @RequestMapping ä¸­å†™äº† <code>&#123;page&#125;/&#123;pagesize&#125;</code>ï¼ŒäºŒè€…å¸¦ä¸Šäº† <code>&#123;&#125;</code> è¿™æ · @PathVariable æ‰èƒ½è¯†åˆ«ã€‚</p><p>è¯·æ±‚ä¸‹é¢çš„åœ°å€ï¼Œå¯ä»¥æ­£å¸¸è®¿é—®ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/friends/1/2</span><br></pre></td></tr></table></figure><p>ç›¸å½“äº page&#x3D;1ï¼Œpagesize&#x3D;2ï¼Œæ‰€ä»¥æ³¨è§£ @PathVariable æ˜¯ä»URI ä¸­åŒ¹é…å‚æ•°çš„ï¼Œä»–ä¸æ˜¯ä»¥é”®å€¼å¯¹æ–¹å¼è·å–å¯¹åº”çš„å€¼ã€‚</p><p>@PathVariable æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.springframework.web.bind.annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Documented;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.annotation.AliasFor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.PARAMETER&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> PathVariable &#123;</span><br><span class="line">    <span class="meta">@AliasFor(&quot;name&quot;)</span></span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AliasFor(&quot;value&quot;)</span></span><br><span class="line">    String <span class="title function_">name</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">required</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ‰ä¸‰ä¸ªå±æ€§ valueã€name å’Œ requiredï¼Œå…¶ä¸­ value ä¹Ÿæ˜¯ name çš„åˆ«åã€‚</p><h2 id="PathParam"><a href="#PathParam" class="headerlink" title="@PathParam"></a>@PathParam</h2><p>æ³¨è§£  @PathParam æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> javax.websocket.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.PARAMETER&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> PathParam &#123;</span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œ@PathVariable å’Œ @RequestParam æ˜¯ <code>org.springframework.x</code> åŒ…ä¸‹é¢çš„å³å±äºspringæ¡†æ¶ï¼Œè€Œ @PathParam å±äº <code>javax.websocket.x</code> åŒ…ä¸‹é¢çš„ã€‚</p><p>æ³¨è§£ @PathParam åªæœ‰ä¸€ä¸ªå±æ€§ valueï¼Œæ²¡æœ‰å…¶ä»–å±æ€§äº†ã€‚@PathParam é‡Œé¢çš„valueå¯¹åº”çš„å€¼ä¸€å®šè¦å’Œå‡½æ•°å‚æ•°åç§°ä¸€è‡´ï¼ˆåŒ…æ‹¬å¤§å°å†™ï¼‰ï¼Œç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/friends&quot;, method = RequestMethod.GET)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getFrieds</span><span class="params">(<span class="meta">@PathParam(value = &quot;page&quot;)</span> String page, <span class="meta">@PathParam(value = &quot;pageSize&quot;)</span> String pageSize)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Get friend list. &quot;</span> + <span class="string">&quot;page: &quot;</span> + page + <span class="string">&quot; - pageSize: &quot;</span> + pageSize;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨ä¸­è¯·æ±‚ä¸‹é¢çš„åœ°å€ï¼Œè¯·æ±‚å’Œå“åº”éƒ½æ˜¯æ­£å¸¸çš„ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/friends?page=1&amp;pageSize=2</span><br></pre></td></tr></table></figure><p>å¦‚æœ @PathParam ä¸­ value å¯¹åº”çš„å€¼å’Œå‡½æ•°å‚æ•°ä¸ä¸€è‡´ï¼Œè¯·æ±‚å¾—ä¸åˆ°é¢„æœŸçš„å“åº”ã€‚ç°åœ¨ä¿®æ”¹ value çš„ <code>pageSize</code> ä¸º <code>pagesize</code>ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/friends&quot;, method = RequestMethod.GET)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getFrieds</span><span class="params">(<span class="meta">@PathParam(value = &quot;page&quot;)</span> String page, <span class="meta">@PathParam(value = &quot;pagesize&quot;)</span> String pageSize)</span> &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;Get friend list. &quot;</span> + <span class="string">&quot;page: &quot;</span> + page + <span class="string">&quot; - pageSize: &quot;</span> + pageSize;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨ä¸­è¯·æ±‚ä¸‹é¢çš„åœ°å€ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/friends?page=1&amp;pagesize=2</span><br></pre></td></tr></table></figure><p>å°±ä¼šå¾—åˆ°ä¸‹é¢çš„ç»“æœï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2019/08/04/3.png"></p><p>ä½†æ˜¯ä½ ä½¿ç”¨ <code>http://localhost:8080/friends?page=1&amp;pageSize=2</code> å¯¹äºä¸Šé¢çš„ä»£ç è¯·æ±‚å’Œå“åº”ä¹Ÿæ˜¯æ­£å¸¸çš„ï¼Œè¿™å°±è¯´æ˜æ³¨è§£ @PathParam ä¸­è¯·æ±‚çš„ URL å‚æ•°æ˜¯ä»¥å‡½æ•°å‚æ•°ä¸ºä¸»çš„ï¼Œä»–å’Œæ³¨è§£ @QueryParam ã€@RequestParam éƒ½æ˜¯ä»¥é”®å€¼å¯¹æ–¹å¼è·å–å¯¹åº”çš„å€¼ã€‚</p><p>æ‰€ä»¥ï¼Œæ³¨è§£ @PathParam ä¸­ value å¯¹åº”çš„å€¼å’Œå‡½æ•°å‚æ•°å°½é‡ä¿æŒä¸€è‡´ã€‚</p><hr><p><strong>å­¦æµ·æ— æ¶¯è‹¦ä½œèˆŸ~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot å¾®æœåŠ¡ æ³¨è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡: ç«‹å¿—åšä¸ªä¼Ÿå¤§çš„é¡¹ç›®</title>
      <link href="/2019/07/03/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E7%AB%8B%E5%BF%97%E5%81%9A%E4%B8%AA%E4%BC%9F%E5%A4%A7%E7%9A%84%E9%A1%B9%E7%9B%AE/"/>
      <url>/2019/07/03/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E7%AB%8B%E5%BF%97%E5%81%9A%E4%B8%AA%E4%BC%9F%E5%A4%A7%E7%9A%84%E9%A1%B9%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åœ¨å¼€ç¯‡ <a href="http://www.veryitman.com/2019/05/28/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E6%AD%A5%E6%AD%A5%E4%B8%BA%E8%90%A5">å¾®æœåŠ¡: æ­¥æ­¥ä¸ºè¥</a> é‡Œé¢æˆ‘ä»¬å·²ç»å®šä¸‹ä¸€ä¸ªå°ç›®æ ‡ï¼ˆä»¥ç»ˆä¸ºå§‹çš„ç­–ç•¥ï¼‰ï¼Œå³ä½¿ç”¨ <code>Spring Boot</code> å†™ API æä¾›ç»™ iOSã€Android å®¢æˆ·ç«¯æˆ–è€…ç½‘é¡µç«¯æ¥è°ƒç”¨ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹å®Œæˆæˆ‘ä»¬è¿™ä¸ªè¶…çº§æ¢¦æƒ³å§ï¼åœ¨å¯èˆªä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç»™è¿™ä¸ª App èµ·ä¸ªåå­—å§ï¼Œè¯¥ App å°±æ˜¯ç»™ç”¨æˆ·å±•ç¤º Blog çš„ï¼Œæ‰€ä»¥æš‚ä¸”ç§°ä¹‹ä¸º <code>MSBlog</code> å§ï¼</p><hr><p>æœ‹å‹åšäº†ä¸€ä¸ªå…³äº <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½çš„æ•™ç¨‹</a>ï¼Œæ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼ç‚¹ <strong><a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a></strong> å¯ä»¥è·³è½¬åˆ°æ•™ç¨‹ï¼Œå¯¹äººå·¥æ™ºèƒ½æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥äº†è§£ä¸€ä¸‹ã€‚</p><h2 id="åŸå‹å›¾"><a href="#åŸå‹å›¾" class="headerlink" title="åŸå‹å›¾"></a>åŸå‹å›¾</h2><p>é¡¹ç›® <code>MSBlog</code> çš„åŸå‹å›¾æ˜¯ç”¨ <a href="https://balsamiq.com/wireframes/desktop/">Balsamiq Mockups 3</a> ç”»çš„ï¼Œè¿™ä¸ªç”»å›¾å·¥å…·ä½¿ç”¨èµ·æ¥éå¸¸ç®€å•ï¼Œç”»å‡ºæ¥çš„æ•ˆæœä¹Ÿç›¸å½“å‡‘åˆï¼</p><p><strong>1ã€ç™»å½•ã€æ³¨å†Œé¡µé¢</strong></p><p>ç™»å½•å’Œæ³¨å†Œé¡µé¢ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œç¬¬ä¸€ä¸ªç‰ˆæœ¬æˆ‘ä»¬åªæ”¯æŒç”¨æˆ·åç™»å½•ï¼Œåé¢å†æ”¯æŒå…¶ä»–ç™»å½•æ–¹å¼ã€‚</p><p>ä¸‹å›¾å·¦è¾¹æ˜¯ç™»å½•é¡µé¢ï¼Œå³è¾¹æ˜¯æ³¨å†Œé¡µé¢ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2019/07/03/1.png"></p><p><strong>2ã€å››ä¸ªTabé¡µé¢</strong></p><p>è¿™å››ä¸ªä¸»é¡µé¢ï¼Œåˆ†åˆ«æ˜¯é¦–é¡µã€æ–‡ç« åˆ†ç±»ã€å¥½å‹ã€ä¸ªäººé¡µé¢ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2019/07/03/2.png"></p><p>ä¸Šé¢çš„åŸå‹å›¾åªåšäº†ç™»å½•ã€æ³¨å†Œå’Œ Tab ä¸»é¡µé¢ï¼Œä»è¿™å‡ ä¸ªé¡µé¢å·²ç»å¯ä»¥çœ‹å‡ºè¿™ä¸ª App çš„æ„é€ äº†ã€‚</p><p><strong>1</strong>ã€é¦–é¡µï¼ˆHomeï¼‰ï¼šä¸»è¦å±•ç¤ºæ¨èçš„æ–‡ç« ï¼Œä»¥åŠå¹¿å‘Šå±•ç¤ºé¡µï¼ˆBannerï¼‰ã€‚</p><p><strong>2</strong>ã€åˆ†ç±»ï¼ˆCategoryï¼‰ï¼šæ–‡ç« åˆ†ç±»ï¼ŒæŒ‰ç…§è¯„è®ºæ•°ã€å‘å¸ƒæ—¶é—´ã€çƒ­åº¦å¯¹æ‰€æœ‰æ–‡ç« è¿›è¡Œåˆ†ç±»ã€‚</p><p><strong>3</strong>ã€å¥½å‹ï¼ˆFriendsï¼‰ï¼šApp ä¸­æ‰€æœ‰çš„å¥½å‹ï¼Œéœ€è¦æ”¯æŒæœ¬åœ°æœç´¢ã€‚</p><p><strong>4</strong>ã€ä¸ªäººï¼ˆProfileï¼‰ï¼šä¸ªäººä¸­å¿ƒï¼ŒåŸºæœ¬æ˜¯ä»»ä½•ä¸€ä¸ª App çš„æ ‡é…ã€‚</p><h2 id="é¡¹ç›®è®¡åˆ’"><a href="#é¡¹ç›®è®¡åˆ’" class="headerlink" title="é¡¹ç›®è®¡åˆ’"></a>é¡¹ç›®è®¡åˆ’</h2><p>ä»ä¸Šé¢çš„åŸå‹å›¾ä¸­ï¼Œæˆ‘ä»¬åŸºæœ¬äº†è§£æ¥ä¸‹æ¥è¦åšä»€ä¹ˆäº†ã€‚</p><p>é¦–å…ˆï¼ŒæŠŠç™»å½•ã€æ³¨å†Œé¡µé¢æå®šï¼Œæ¥ç€å†æŠŠå››ä¸ª Tab é¡µé¢æèµ·æ¥ï¼Œå¯¹äº App åˆå­¦è€…æ¥è¯´ï¼Œè¿™ä¸ªå‹åŠ›ç€å®ä¸å°äº†ï¼Œæ²¡å…³ç³»æ…¢æ…¢æ¥ï¼Œä¸€æ­¥ä¸€ä¸ªè„šå°çš„èµ°ä¸‹å»ã€‚</p><p>æ— è®ºæ˜¯å“ªä¸ªé¡µé¢ï¼Œéƒ½éœ€è¦æœåŠ¡ç«¯æä¾›ç›¸å…³çš„æ¥å£ï¼ˆAPIï¼‰å’Œæ•°æ®ï¼Œç®€å•æè¿°ä¸€ä¸‹å§ï¼Œå¦‚ä¸‹ï¼š</p><p><strong>1</strong>ã€ç™»å½•ï¼ˆSigninï¼‰ï¼šéœ€è¦æœåŠ¡ç«¯æä¾›ç™»å½•æ¥å£ï¼Œå³æ”¯æŒç”¨æˆ·åå’Œå¯†ç ç™»å½•çš„APIèƒ½åŠ›ã€‚</p><p><strong>2</strong>ã€æ³¨å†Œï¼ˆSignupï¼‰ï¼šéœ€è¦æœåŠ¡ç«¯æä¾›æ³¨å†Œçš„æ¥å£ï¼Œå³æ”¯æŒç”¨æˆ·åå’Œå¯†ç æ³¨å†Œçš„APIèƒ½åŠ›ã€‚</p><p><strong>3</strong>ã€é¦–é¡µï¼ˆHomeï¼‰ï¼šéœ€è¦æä¾›æŸ¥è¯¢æ¨èæ–‡ç« çš„APIï¼ŒåæœŸéœ€è¦è€ƒè™‘æ™ºèƒ½æ¨èã€‚</p><p><strong>4</strong>ã€åˆ†ç±»ï¼ˆCategoryï¼‰ï¼šéœ€è¦æä¾›æŸ¥è¯¢æ‰€æœ‰æ–‡ç« åˆ†ç±»çš„APIã€‚</p><p><strong>5</strong>ã€å¥½å‹ï¼ˆFriendsï¼‰ï¼šéœ€è¦æä¾›æŸ¥è¯¢æ¯ä¸ªäººæ‰€æœ‰å¥½å‹çš„APIã€‚</p><p><strong>6</strong>ã€ä¸ªäººï¼ˆProfileï¼‰ï¼šéœ€è¦æä¾›å½“å‰ç™»å½•ç”¨æˆ·çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·åã€å¤´åƒã€æ˜µç§°ç­‰ä¿¡æ¯ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼Œå…ˆæŠŠè¿™ç™»å½•æ³¨å†Œåšå¥½ï¼ŒæœåŠ¡ç«¯æŠŠç™»å½•ã€æ³¨å†Œçš„ API å‡†å¤‡å¥½ï¼›</p><p>ç¬¬äºŒæ­¥ï¼Œç„¶åå†åš Tab é¡µé¢ï¼ŒæœåŠ¡ç«¯æŠŠå…¶ä»– API å‡†å¤‡å¥½ï¼›</p><p>ç¬¬ä¸‰æ­¥ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è”è°ƒæ•°æ®ï¼Œç¡®ä¿æˆ‘ä»¬èƒ½æ­£å¸¸ä½¿ç”¨å®¢æˆ·ç«¯ã€‚</p><p>å®¢æˆ·ç«¯å…ˆä» iOS å¼€å§‹ï¼ŒAndroid ç‰ˆæœ¬çš„ <code>MSBlog</code> åç»­å†è¡¥ä¸Šï¼ŒiOS å®¢æˆ·ç«¯çš„é¡¹ç›®é‡‡ç”¨ MVC çš„æ¶æ„ï¼Œå¼€å‘è¯­è¨€é‡‡ç”¨ <code>Swift</code>ï¼ˆSwiftç‰ˆæœ¬ä¸º5.0ï¼‰ï¼ŒIDE é‡‡ç”¨é«˜å¤§ä¸Šçš„ <code>Xcode</code>ï¼Œé¡¹ç›®ä»£ç ä½¿ç”¨ <code>Git</code> æ¥ç®¡ç†ï¼Œç”¨ <code>Github</code> ä½œä¸ºä»£ç ä»“åº“ã€‚</p><p>åˆ°è¿™é‡Œï¼Œæ˜¯ä¸æ˜¯è§‰å¾—è‡ªå·±è¿˜æœ‰å¾ˆå¤šä¸œè¥¿éœ€è¦å­¦ä¹ æ¯”å¦‚ <code>Swift</code> ç¼–ç¨‹è¯­è¨€ã€‚å½“ç„¶äº†ï¼Œå¦‚æœä½ ä¼š <code>Flutter</code> æˆ–è€… <code>Javascript</code> ä¹Ÿå¯ä»¥å†™å®¢æˆ·ç«¯ä»£ç ã€‚åˆ«æ‹…å¿ƒï¼Œæˆ‘ä»å®¹çš„å‘Šè¯‰ä½ ï¼Œç¼–ç¨‹è¯­è¨€è¿™ä¸ªä¸œè¥¿æ²¡æœ‰ä½ æƒ³è±¡ä¸­çš„é‚£ä¹ˆéš¾ï¼Œå¤šåŠ¨æ‰‹å†™å°±å¯ä»¥äº†ï¼Œé‡åˆ°ä¸ä¼šå°±å»æŸ¥æ‰‹å†Œã€‚ä¸–ä¸Šæœ¬æ²¡æœ‰è·¯ï¼Œèµ°çš„å¤šäº†å°±æœ‰äº†ï¼Œå¯¹äºç¼–ç¨‹ä¹Ÿä¸€æ ·ï¼Œå†™çš„å¤šäº†å°±èƒ½èä¼šè´¯é€šï¼Œä¸¾ä¸€åä¸‰ã€‚çœŸæ­£éš¾çš„æ˜¯ä½ ä¸åŠ¨æ‰‹æ€»æ˜¯åœ¨é‚£é‡ŒåŸ‹æ€¨ï¼</p><p>åæœŸæœ‰å¯èƒ½ä¼šä½¿ç”¨ <code>Flutter</code> æ¥å†™è¿™ä¸ª Appï¼Œå¾…å®šã€‚</p><hr><p>ç¥å¥½ï¼ŒåŠ æ²¹ï¼æ˜¯æ—¶å€™åŠ¨æ‰‹å†™èµ·æ¥äº†ï¼</p><hr><p><strong>æ”¹å˜ï¼Œä»ä½ æˆ‘ç›¸è¯†å¼€å§‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot å¾®æœåŠ¡ é¡¹ç›® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡ï¼šæœ¬åœ°çƒ­éƒ¨ç½²</title>
      <link href="/2019/06/30/%E5%BE%AE%E6%9C%8D%E5%8A%A1%EF%BC%9A%E6%9C%AC%E5%9C%B0%E7%83%AD%E9%83%A8%E7%BD%B2/"/>
      <url>/2019/06/30/%E5%BE%AE%E6%9C%8D%E5%8A%A1%EF%BC%9A%E6%9C%AC%E5%9C%B0%E7%83%AD%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œéš¾å…ä¼šç»å¸¸ä¿®æ”¹ä»£ç æ¥éªŒè¯ä¸€äº›é—®é¢˜ï¼Œå¦‚æœæ¯æ¬¡ä¿®æ”¹éƒ½éœ€è¦è¿›è¡Œé‡æ–°å…³é—­ã€å¯åŠ¨è¿™æ ·çš„æ“ä½œä¼šè®©äººæœ‰ç‚¹ä¸çˆ½ï¼Œå¦‚æœèƒ½å®ç°ä»£ç çš„çƒ­éƒ¨ç½²å°±å¥½äº†ã€‚</p><p>æ‰€è°“çƒ­éƒ¨ç½²ï¼Œå°±æ˜¯åœ¨åº”ç”¨æ­£åœ¨è¿è¡Œçš„æ—¶å€™å‡çº§è½¯ä»¶ï¼Œå´ä¸éœ€è¦é‡æ–°å¯åŠ¨åº”ç”¨ã€‚é€šä¿—æ¥è®²ï¼Œçƒ­éƒ¨ç½²å°±æ˜¯åœ¨ä¿®æ”¹ä»£ç åï¼Œä¸éœ€è¦é‡æ–°å¯åŠ¨æœåŠ¡å™¨ï¼Œå°±å¯ä»¥åŠ è½½ä¿®æ”¹åçš„ä»£ç ï¼Œçœ‹åˆ°ä¿®æ”¹åçš„æ•ˆæœã€‚å¯¹äº IDEA æ¥è¯´ï¼Œçƒ­éƒ¨ç½²å°±æ˜¯ä¸éœ€è¦åå¤çš„é€šè¿‡å¼€å§‹ã€åœæ­¢æ¥è¿›è¡Œé¡¹ç›®çš„å¯åŠ¨ï¼Œè€Œæ˜¯ä¿®æ”¹ä»£ç ä¿å­˜åè‡ªåŠ¨åŠ è½½ä¿®æ”¹åçš„ä»£ç ã€‚</p><p>Spring Boot æä¾›äº†çƒ­éƒ¨ç½²èƒ½åŠ›ã€‚å¯ä»¥ä½¿ç”¨ <code>Spring Boot Loader</code> çš„æ–¹å¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>Spring Boot Devtools </code>çš„æ–¹å¼æ¥è¿›è¡Œï¼ŒäºŒè€…å®ç°æ–¹å¼æ˜¯ä¸åŒçš„ï¼Œå¤§è‡´æ€»ç»“å¦‚ä¸‹ï¼š</p><p><strong>Spring Boot Loaderï¼šçœŸæ­£çš„çƒ­éƒ¨ç½²ã€‚</strong></p><p><strong>Spring Boot Devtoolsï¼šé‡æ–°éƒ¨ç½²æ¥å®ç°çƒ­éƒ¨ç½²ã€‚</strong></p><p>è¿™ä¸¤ç§çƒ­éƒ¨ç½²ä¹Ÿæ˜¯æœ¬åœ°çƒ­éƒ¨ç½²ï¼ŒçœŸæ­£çš„è¿œç¨‹æœåŠ¡å™¨çƒ­éƒ¨ç½²æ–¹æ¡ˆå¦æœ‰æ–¹æ¡ˆï¼Œè¿™ä¸ªä¸æ˜¯ä»Šå¤©åˆ†äº«çš„ç‚¹åç»­ç‰µæ¶‰åˆ°éƒ¨ç½²æ–¹æ¡ˆå†è¯´ï¼ä»Šå¤©åªåˆ†äº«å¦‚ä½•ä½¿ç”¨ devtools å®ç° Spring Boot é¡¹ç›®çš„çƒ­éƒ¨ç½²ã€‚</p><hr><p>æœ‹å‹åšäº†ä¸€ä¸ªå…³äº <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½çš„æ•™ç¨‹</a>ï¼Œæ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼ç‚¹ <strong><a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a></strong> å¯ä»¥è·³è½¬åˆ°æ•™ç¨‹ï¼Œå¯¹äººå·¥æ™ºèƒ½æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥äº†è§£ä¸€ä¸‹ã€‚</p><h2 id="spring-boot-devtools"><a href="#spring-boot-devtools" class="headerlink" title="spring-boot-devtools"></a>spring-boot-devtools</h2><p>åœ¨ IDEA ä¸­ä½¿ç”¨ devtools éœ€è¦ä¿®æ”¹ IDEA çš„è®¾ç½®å’Œå·¥ç¨‹çš„ pom æ–‡ä»¶ï¼Œå…·ä½“æ“ä½œæ­¥éª¤å¦‚ä¸‹ã€‚</p><p><strong>1ã€ä¿®æ”¹pom.xmlæ–‡ä»¶ï¼Œå¢åŠ devtools</strong></p><p>åœ¨ <code>pom.xml</code> æ–‡ä»¶ä¸­çš„ <code>dependency</code> ä¸‹å¢åŠ  devtoolsï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Devtools--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>true<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨ build æ ‡ç­¾ä¸‹å¢åŠ  <code>configuration/fork</code> é…ç½®ï¼Œå¦‚æœæ²¡æœ‰è¯¥é¡¹é…ç½®ï¼Œdevtools ä¸ä¼šèµ·ä½œç”¨ï¼Œå³åº”ç”¨ä¸ä¼šé‡å¯ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">fork</span>&gt;</span>true<span class="tag">&lt;/<span class="name">fork</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>2ã€ä¿®æ”¹IDEAç¼–è¯‘é€‰é¡¹</strong></p><p>åœ¨IDEAä¸­æ‰“å¼€ <code>File/Settings</code>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2019/06/30/1.png" alt="1555860471904"></p><p><strong>3ã€ä¿®æ”¹IDEAä¸­çš„Registry</strong></p><p>åœ¨ IDEA ä¸­ <code>Help/Find Action...</code>ï¼Œæ‰“å¼€ä¸‹é¢çš„å¯¹è¯æ¡†ï¼Œè¾“å…¥registry è¿›è¡Œæœç´¢ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="/upload/images/2019/06/30/2.png" alt="1555860471904"></p><p>åŒå‡» Registryï¼Œå‡ºç°ä¸‹é¢å¼¹æ¡†ï¼Œå¦‚å›¾æ“ä½œï¼Œé€‰ä¸­ <code>Compiler autoMake allow when app running</code> å³å¯ã€‚</p><p><img src="/upload/images/2019/06/30/3.png" alt="1555860471904"></p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨å¿«æ·é”® <code>ctrl + shift + alt + /</code> æ‰“å¼€ Registryï¼Œå¦‚å›¾ï¼š</p><p><img src="/upload/images/2019/06/30/4.png" alt="1555860471904"></p><p><strong>4ã€é‡æ–°å¯åŠ¨é¡¹ç›®</strong></p><p>é‡æ–°è¿è¡Œé¡¹ç›®è¿›è¡ŒéªŒè¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">user</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Greate user!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµè§ˆå™¨æ‰“å¼€ï¼š<a href="http://localhost:8080/user">http://localhost:8080/user</a> å¯ä»¥çœ‹åˆ°æ•ˆæœã€‚</p><p>ä¿®æ”¹åŸæ¥çš„ <code>user</code> æ–¹æ³•å’Œå¢åŠ ä¸€ä¸ª <code>user2</code> æ–¹æ³•ï¼Œå†æ¥éªŒè¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">user</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;Greate user, welcome!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/user2&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">user2</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;Greate user!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ†åˆ«åœ¨æµè§ˆå™¨æ‰“å¼€ï¼š<a href="http://localhost:8080/user">http://localhost:8080/user</a> å’Œ  <a href="http://localhost:8080/user2">http://localhost:8080/user2</a></p><p><img src="/upload/images/2019/06/30/6.png" alt="1555860471904"></p><p><img src="/upload/images/2019/06/30/7.png" alt="1555860471904"></p><p>ç°åœ¨ä¸éœ€è¦åœ¨ IDEA ä¸­é‡æ–°å¯åŠ¨ã€å…³é—­è¿™ç§éº»çƒ¦æ“ä½œäº†ã€‚</p><p>å¦‚æœä½ è¶³å¤Ÿç»†å¿ƒå°±ä¼šå‘ç°ï¼Œä½¿ç”¨ devtools åï¼Œæ¯æ¬¡ä¿®æ”¹æ§åˆ¶å°è‡ªåŠ¨çš„é‡æ–°å¯åŠ¨äº† Spring Boot é¡¹ç›®ï¼Œæ‰€ä»¥ devtools æ˜¯ä½¿ç”¨äº†é‡æ–°éƒ¨ç½²çš„æ–¹å¼ä»è€Œå®ç°äº†çƒ­éƒ¨ç½²çš„åŠŸèƒ½ã€‚</p><h2 id="æ³¨æ„å‡ ä¸ªé—®é¢˜"><a href="#æ³¨æ„å‡ ä¸ªé—®é¢˜" class="headerlink" title="æ³¨æ„å‡ ä¸ªé—®é¢˜"></a>æ³¨æ„å‡ ä¸ªé—®é¢˜</h2><h4 id="1ã€ä»£ç ä¿®æ”¹ä¸ä¼šç«‹å³ç”Ÿæ•ˆ"><a href="#1ã€ä»£ç ä¿®æ”¹ä¸ä¼šç«‹å³ç”Ÿæ•ˆ" class="headerlink" title="1ã€ä»£ç ä¿®æ”¹ä¸ä¼šç«‹å³ç”Ÿæ•ˆ"></a>1ã€ä»£ç ä¿®æ”¹ä¸ä¼šç«‹å³ç”Ÿæ•ˆ</h4><p>éšç€å·¥ç¨‹è¶Šæ¥è¶Šå¤§ï¼Œä¿®æ”¹ä»£ç æˆ–è€…é…ç½®åéœ€è¦ç¨ç­‰å‡ ç§’é’Ÿï¼ˆä¸€èˆ¬3sä»¥å†…ï¼‰å°±ä¼šè‡ªåŠ¨é‡æ–°å¯åŠ¨å·¥ç¨‹ï¼Œæ§åˆ¶å°å°±ä¼šçœ‹åˆ°æ—¥å¿—çš„è¾“å‡ºã€‚</p><h4 id="2ã€ä»£ç ä¿®æ”¹åæ§åˆ¶å°æ²¡æœ‰è‡ªåŠ¨çš„é‡æ–°å¯åŠ¨å·¥ç¨‹"><a href="#2ã€ä»£ç ä¿®æ”¹åæ§åˆ¶å°æ²¡æœ‰è‡ªåŠ¨çš„é‡æ–°å¯åŠ¨å·¥ç¨‹" class="headerlink" title="2ã€ä»£ç ä¿®æ”¹åæ§åˆ¶å°æ²¡æœ‰è‡ªåŠ¨çš„é‡æ–°å¯åŠ¨å·¥ç¨‹"></a>2ã€ä»£ç ä¿®æ”¹åæ§åˆ¶å°æ²¡æœ‰è‡ªåŠ¨çš„é‡æ–°å¯åŠ¨å·¥ç¨‹</h4><p>è¿™ä¸ªå°±éœ€è¦æŒ‰ç…§è¿™ç¯‡æ–‡ç« è¯´çš„ï¼Œé‡æ–°æ£€æŸ¥ä¸€ä¸‹å¦‚ä¸‹è®¾ç½®ï¼š</p><ul><li>pom æ–‡ä»¶ï¼Œæ£€æŸ¥ä¸€ä¸‹æ˜¯å¦æŠŠå¿…è¦çš„é…ç½®è¢«ä¿®æ”¹äº†ã€‚</li><li>IDE çš„è®¾ç½®æ˜¯å¦å’Œæœ¬æ–‡ä¸€è‡´ã€‚</li></ul><hr><p><strong>æ”¹å˜ï¼Œä»ä½ æˆ‘ç›¸è¯†å¼€å§‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot å¾®æœåŠ¡ çƒ­éƒ¨ç½² </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¤çŸ¥</title>
      <link href="/2019/06/23/%E8%AE%A4%E7%9F%A5/"/>
      <url>/2019/06/23/%E8%AE%A4%E7%9F%A5/</url>
      
        <content type="html"><![CDATA[<p>ä»»ä½•æ—¶å€™éƒ½ä¸è¦è½»æ˜“çš„å¼€å£è¯´ï¼šâ€œè¿™ä¸å¯èƒ½â€ï¼Œå°±è·Ÿåœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¸è¦è½»æ˜“è¯´æ”¾å¼ƒä¸€æ ·é‡è¦ã€‚</p><p>åœ¨å¾ˆå¤šåœºåˆä¸‹ï¼Œä½ è¿™ä¹ˆä¸€è¯´ä¸ä»…æš´éœ²äº†ä½ çš„å­¦è¯†ï¼Œè€Œä¸”è¿˜ä¼šæš´éœ²ä½ çš„å¿ƒæ€ã€‚ç‰¹åˆ«æ˜¯ç¨‹åºå‘˜ï¼Œåœ¨äº§å“è¯´è¦å®ç°xxxåŠŸèƒ½æˆ–è€…UEè¯´è¦å®ç°yyyæ•ˆæœçš„æ—¶å€™ï¼Œå¾ˆå®¹æ˜“ç”¨â€œè¿™ä¸ªæ— æ³•å®ç°â€è¿™æ ·çš„è¯­å¥æ¥â€œæŠ—æ‹’â€éœ€æ±‚ã€‚</p><p>æˆ‘è®°å¾—æœ‰è¿™æ ·ä¸€ä»¶å°äº‹ã€‚</p><p>ç¨‹åºå‘˜Aè¯´ï¼šâ€œè¿™ä¸ªæ¡†æ¶å·²ç»é™åˆ¶äº†ï¼Œæ— æ³•å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œåˆ«ç™½è´¹åŠ›æ°”äº†!â€ã€‚</p><p>ç¨‹åºå‘˜Bè¯´ï¼šâ€œæˆ‘ä»¬å¯ä»¥å†è¯•è¯•ï¼Œæˆ–è®¸è¿˜æœ‰å…¶ä»–åŠæ³•å‘¢ï¼Ÿâ€ã€‚</p><p>Aæ˜¾å¾—å¾ˆä¸è€çƒ¦ï¼Œè¯´åˆ°ï¼šâ€œä½ è¦æ˜¯ä¸ç›¸ä¿¡æˆ‘ï¼Œä½ å°±è‡ªå·±æå§ï¼Œæˆ‘ä¸ç®¡äº†!â€ã€‚</p><p>Bæ²¡æœ‰å’ŒAç»§ç»­äº‰è®ºè€Œæ˜¯é»˜é»˜åœ°è½¬å»æƒ³åŠæ³•è§£å†³é—®é¢˜ã€‚åŠŸå¤«ä¸è´Ÿæœ‰å¿ƒäººï¼Œä¸‹åˆBå°±æ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆï¼Œè¿™ä¸ªæ–¹æ¡ˆä¸ä»…ç®€å•è€Œä¸”é«˜æ•ˆï¼Œåªéœ€è¦åœ¨æ¡†æ¶çš„åŸºç¡€ä¸Šç®€å•å°è£…ä¸€ä¸‹å°±å¥½ã€‚</p><p>è¿™æ ·çš„åœºæ™¯ï¼Œæˆ‘ç›¸ä¿¡å‚åŠ è¿‡å·¥ä½œçš„å¼€å‘å¤§å¤§ä»¬ç»å¸¸é‡åˆ°ã€‚ä¹‹æ‰€ä»¥æˆ‘ä»¬è¯´å‡ºä¸€äº›ç±»ä¼¼â€œä¸å¯èƒ½â€çš„åè¯­ï¼Œè¦ä¹ˆæ˜¯å¿ƒæ€ä¸å¯¹ï¼Œè¦ä¹ˆæ˜¯è®¤çŸ¥ä¸å¤Ÿã€‚å¾ˆå¤šäººåœ¨å·¥ä½œå½“ä¸­é¢å¯¹å¤æ‚äº‹æƒ…çš„æ—¶å€™ä¼šè¯´â€œè¿™ä¸å¯èƒ½â€æˆ–è€…â€œè¿™ç»ä¸å¯èƒ½â€çš„è¯ï¼Œå¯èƒ½ä½ éƒ½æ²¡æœ‰æ€è€ƒè¿‡å°±éšå£è¯´å‡ºæ¥äº†ï¼Œä¸€æ–¹é¢æ˜¾å¾—è‡ªå·±çŸ¥è¯†ä¸è¶³ï¼Œå¦ä¸€æ–¹é¢ä¼šæ‹’åˆ«äººäºåƒé‡Œä¹‹å¤–ã€‚</p><p>åˆšå…¥èŒåœºçš„ç¨‹åºå‘˜å’Œå·¥ä½œå·²ä¹…ä¸”çˆ±æ€è€ƒçš„ç¨‹åºå‘˜æœ‰ç€å¾ˆä¸ä¸€æ ·çš„è®¤çŸ¥ã€‚åˆšå…¥èŒåœºçš„ç¨‹åºå‘˜æˆ–è€…å·¥ç¨‹å¸ˆï¼Œé¢å¯¹äº§å“ç»ç†æå‡ºçš„éœ€æ±‚åŸºæœ¬éƒ½æ˜¯ä¸€ä¸€é¡ºä»ï¼Œæ— è®ºéœ€æ±‚æ˜¯å¦åˆç†ï¼Œä»–ä»¬éƒ½ä¼šè€è€å®å®çš„æŠŠéœ€æ±‚è½¬åŒ–ä¸ºä¸€è¡Œè¡Œçš„ä»£ç ï¼Œç¨å¾®æœ‰ç‚¹æƒ³æ³•çš„ä¼°è®¡å› ä¸ºâ€œèƒ†å°â€è€Œä¸æ•¢å‘å£°ã€‚éšç€èŒåœºçš„ç£¨ç»ƒï¼Œä¸šåŠ¡èƒ½åŠ›çš„å¢å¼ºä»–ä»¬å¼€å§‹æœ‰äº†è‡ªå·±çš„æƒ³æ³•å’Œæ€è€ƒï¼Œæ•¢äºäº§å“ç»ç†â€œæŠ—è¡¡â€äº†ï¼Œå¯¹äºä¸åˆç†çš„éœ€æ±‚ä¼šä¸äº§å“å¤§å¤§ä»¬é’ˆé”‹ç›¸å¯¹ï¼Œæœ‰æ—¶å€™ä½ ä¼šå‘ç°äº§å“éœ€æ±‚ä¼šè®®ä¿¨ç„¶ä¸€åœºåˆ†å´©ç¦»æçš„å†…æˆ˜ã€‚é¡¹ç›®åšçš„å¤šäº†ï¼Œç¼–ç¨‹èƒ½åŠ›ã€ä¸šåŠ¡èƒ½åŠ›å’Œæ²Ÿé€šèƒ½åŠ›åˆä¸Šäº†ä¸€å±‚æ¥¼ï¼Œä¼˜ç§€çš„ç¨‹åºå‘˜ä»¬ä¸ä»…èƒ½æŒ‘å‡ºä¸åˆç†çš„éœ€æ±‚ï¼ˆä¼ªéœ€æ±‚ï¼‰è€Œä¸”è¿˜èƒ½æå‡ºæ›´åˆç†çš„éœ€æ±‚å¸®åŠ©äº§å“æ›´ä¸Šä¸€å±‚æ¥¼ï¼Œæå‡äº§å“çš„é€¼æ ¼å’Œå®ç”¨æ€§ï¼Œä¸ä»…å‡å°‘äº†å¼€å‘æˆæœ¬è€Œä¸”è¿˜æå‡äº†å›¢é˜Ÿä½œæˆ˜çš„å£«æ°”ï¼Œæ›´é‡è¦çš„æ˜¯äº§å“ç»ç†ä»¥åä¸æ•¢å°ç§ä½ äº†ï¼Œä½ è‡ªå·±ä¹Ÿä¼šè·å¾—æ— è¡Œçš„æˆå°±æ„Ÿã€‚ç»å†äº‹æƒ…ï¼ˆå¦‚é¡¹ç›®ç»å†ï¼‰ï¼Œæ€è€ƒå’Œæ€»ç»“äº‹æƒ…çš„å‘å±•ã€ç»è¿‡ã€ç»“å±€ï¼Œä»è€Œä¸æ–­çš„æé«˜è‡ªå·±çš„ä¸šåŠ¡æ°´å¹³æ˜¯æå‡è‡ªæˆ‘è®¤çŸ¥çš„ä¸€ä¸ªæœ‰æ•ˆé€”å¾„ã€‚</p><p>å¹´è½»æ—¶å€™çš„å¬´æ”¿æ•¢çˆ±æ•¢æ¨ï¼Œä¸ªæ€§å¾ˆå¼ºï¼Œä¸‹é¢æ˜¯å•ä¸éŸ¦å’Œå¬´æ”¿çš„ä¸€æ®µå¯¹è¯ã€‚</p><blockquote><p>å•ä¸éŸ¦ï¼šæˆ‘ä¸ºäº†ç‹ä¸Šçš„åƒç§‹å¤§ä¸šï¼Œæœ‰äº›äº‹æƒ…ï¼Œç‹ä¸Šä¸€æ—¶ä¸å¯ç†è§£ã€‚<br>å¬´æ”¿ï¼šä¸å¯ç†è§£ï¼Ÿæœ‰äº›äº‹æƒ…ï¼Œè¿˜è¦ä½¿åŠ²æ‰èƒ½ç†è§£å‘€ï¼Ÿ<br>å•ä¸éŸ¦ï¼šæˆ‘åªèƒ½å‘Šè¯‰ä½ ï¼Œå½“ä¸€ä¸ªäººè¿˜ä¸å¤Ÿæˆç†Ÿçš„æ—¶å€™ï¼Œä»–æ‰€çœ‹åˆ°çš„äº‹æƒ…ï¼Œæœªå¿…æ˜¯çœŸå®çš„ã€‚<br>å¬´æ”¿ï¼šæœªå¿…çœŸå®ï¼Ÿé‚£æˆ‘çœ‹åˆ°çš„æ˜¯ä»€ä¹ˆï¼Ÿ<br>å•ä¸éŸ¦ï¼šä½ çœ‹åˆ°çš„ï¼Œåªæ˜¯çœŸå®çš„å½±å­ã€‚<br>å¬´æ”¿ï¼šé‚£å°±è¯·ä»²çˆ¶å‘Šè¯‰æˆ‘ï¼Œå¦‚ä½•æ‰èƒ½ç†è§£ä½ çš„çœŸå®ï¼Ÿ<br>å•ä¸éŸ¦ï¼šç‹ä¸Šç°åœ¨è¿˜æ²¡è¿™ä¸ªèƒ½åŠ›ï¼</p></blockquote><p>ç»Ÿä¸€å…­å›½ä¹‹åï¼Œå¬´æ”¿é¢å¯¹ææ–¯æ„Ÿæ…¨ï¼šâ€œå¦‚ä»Šå¤©ä¸‹å·²ç»ä¸€ç»Ÿï¼Œé‚£ä¹ˆå¤§ç§¦ç°å¦‚ä»Šçš„ä»²çˆ¶åˆæ˜¯è°å‘¢ï¼Ÿâ€å¯è§å•ä¸éŸ¦åœ¨å¬´æ”¿å¿ƒä¸­çš„åœ°ä½ä¸¾è¶³è½»é‡ï¼ŒéåŒä¸€èˆ¬ã€‚</p><p>æˆ‘ä» â€œæ·±å…¥ç†è§£Linuxå†…æ ¸â€ è¿™æœ¬ä¹¦ä¸­ï¼Œçœ‹åˆ°äº†è¿™æ ·ä¸€æ®µè¯:</p><blockquote><p>Linux æ˜¯éæŠ¢å å¼ï¼ˆnonpreemptiveï¼‰å†…æ ¸ã€‚</p></blockquote><p>è‡ªä»æ¥è§¦Linuxä»¥æ¥ï¼Œåœ¨ä¸ªäººçš„è®¤çŸ¥ä¸­Linuxéƒ½æ˜¯æŠ¢å å¼çš„ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆè¿™é‡Œå´è¯´å®ƒæ˜¯éæŠ¢å å¼çš„å‘¢ï¼Ÿ</p><p>è¿™æœ¬ä¹¦åˆå¾ˆæƒå¨ï¼Œéš¾é“æ˜¯è‡ªå·±é”™äº†ï¼Ÿæˆ‘å°±ç¡¬ç€å¤´çš®åˆå»æ‰¾ç›¸å…³çš„èµ„æ–™ï¼Œç»“æœç®—æ˜¯ææ¸…æ¥šäº†æ¥é¾™å»è„‰ã€‚</p><p>Linuxåˆ†ä¸ºå†…æ ¸æŠ¢å å’Œç”¨æˆ·æŠ¢å ï¼ŒLinuxå†…æ ¸ç‰ˆæœ¬2.4æ”¯æŒå†…æ ¸æŠ¢å ä½†ä¸æ”¯æŒç”¨æˆ·æŠ¢å ï¼Œä¸€ç›´åˆ°Linuxå†…æ ¸ç‰ˆæœ¬2.6æ‰éƒ½æ”¯æŒå†…æ ¸æŠ¢å å’Œç”¨æˆ·æŠ¢å ï¼Œâ€æ·±å…¥ç†è§£Linuxå†…æ ¸â€ è¿™æœ¬ä¹¦æ˜¯åŸºäºLinuxå†…æ ¸ç‰ˆæœ¬2.4ä¹‹å‰è®²è§£çš„ï¼Œæ‰€ä»¥è¯´æ³•å¹¶æ²¡æœ‰é”™è¯¯ã€‚</p><p>æ´»åˆ°è€å­¦åˆ°è€ï¼Œè®²çš„æ˜¯äººæ— è®ºåœ¨é‚£ä¸ªé˜¶æ®µéƒ½ä¸åº”è¯¥æ”¾å¼ƒå­¦ä¹ ï¼Œå› ä¸ºåªæœ‰ä¸æ–­çš„å­¦ä¹ æ‰èƒ½æé«˜è‡ªå·±çš„è®¤çŸ¥ã€‚å¯¹äºæ–°é²œäº‹ç‰©ï¼Œæˆ‘ä»¬ä¸€å®šè¦ä¿æŒæ•¬ç•ä¹‹å¿ƒï¼Œå› ä¸ºä½ æ²¡æœ‰è¿™æ–¹é¢çš„ç»éªŒï¼Œè™šå¿ƒè¯·æ•™å’Œå€Ÿé‰´æ‰èƒ½é¿å…ä¸€å®šçš„æŸå¤±ã€‚æˆ‘è®°å¾—æœ‰ä¸€æ¬¡å‚åŠ ä¸€ä¸ªæŠ€æœ¯åŸ¹è®­ï¼Œè€å¸ˆæé—®ï¼šâ€œè°èƒ½ç®€å•è§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯ <a href="https://baike.baidu.com/item/%E5%A2%A8%E8%8F%B2%E5%AE%9A%E5%BE%8B/746284?fr=aladdin">å¢¨è²å®šå¾‹</a> ï¼Ÿâ€ï¼Œæˆ‘çœ‹äº†ä¸€ä¸‹å…¨åœºï¼ŒåŠåˆ†é’Ÿæ²¡æœ‰äººå›ç­”ï¼Œäºæ˜¯è‡ªå·±å°±æ–—èƒ†ç«™èµ·æ¥è¯´äº†ï¼šâ€œä½ æ€»æ˜¯æ‹…å¿ƒçš„äº‹æƒ…ï¼Œå®ƒæ€»ä¼šå‘ç”Ÿçš„ã€‚â€ï¼Œè€å¸ˆæ»¡æ„çš„ç‚¹äº†ç‚¹å¤´ï¼Œæˆ‘ç›¸ä¿¡å½“æ—¶ä¼šåœºä¸­æœ‰èƒ½æ¯”æˆ‘è§£é‡Šæ›´å¥½çš„äººï¼Œå¯èƒ½æ˜¯ä»–ä¸æ•¢ä¹Ÿæœ‰å¯èƒ½æ˜¯ä»–ä¸å±‘äºå›ç­”ã€‚è¯´è¿™ä¸ªäº‹æƒ…å¹¶ä¸æ˜¯è¦å½°æ˜¾æˆ‘è‡ªå·±æœ‰å¤šä¹ˆå‰å®³ï¼Œè€Œæ˜¯è¦å‘Šè¯‰å¤§å®¶å¤šè¯»ä¹¦æ˜¯æé«˜è‡ªæˆ‘è®¤çŸ¥èƒ½åŠ›çš„ä¸€ç§æ–¹å¼ã€‚</p><blockquote><p>å¢¨è²å®šå¾‹ä¸»è¦å†…å®¹æœ‰å››ä¸ªæ–¹é¢ï¼š</p><p>ä¸€ã€ä»»ä½•äº‹éƒ½æ²¡æœ‰è¡¨é¢çœ‹èµ·æ¥é‚£ä¹ˆç®€å•ï¼›</p><p>äºŒã€æ‰€æœ‰çš„äº‹éƒ½ä¼šæ¯”ä½ é¢„è®¡çš„æ—¶é—´é•¿ï¼›</p><p>ä¸‰ã€ä¼šå‡ºé”™çš„äº‹æ€»ä¼šå‡ºé”™ï¼›</p><p>å››ã€å¦‚æœä½ æ‹…å¿ƒæŸç§æƒ…å†µå‘ç”Ÿï¼Œé‚£ä¹ˆå®ƒå°±æ›´æœ‰å¯èƒ½å‘ç”Ÿã€‚</p><p>â€œå¢¨è²å®šå¾‹â€çš„æ ¹æœ¬å†…å®¹æ˜¯â€œå‡¡æ˜¯å¯èƒ½å‡ºé”™çš„äº‹æœ‰å¾ˆå¤§å‡ ç‡ä¼šå‡ºé”™â€ï¼ŒæŒ‡çš„æ˜¯ä»»ä½•ä¸€ä¸ªäº‹ä»¶ï¼Œåªè¦å…·æœ‰å¤§äºé›¶çš„æœºç‡ï¼Œå°±ä¸èƒ½å¤Ÿå‡è®¾å®ƒä¸ä¼šå‘ç”Ÿã€‚</p></blockquote><p>å¯¹äºäººçš„è®¤çŸ¥å¤§æ¦‚å¯ä»¥åˆ†ä¸ºå››ä¸ªé˜¶æ®µï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2019/06/23/1.png" alt="1559469918269"></p><p>ä»¥åå·¥ä½œä¸­æˆ–è€…ç”Ÿæ´»ä¸­é‡åˆ°ä¸€äº›è‡ªå·±ä¸çŸ¥é“çš„äº‹æƒ…ï¼Œé¦–å…ˆè¦æ‘†æ­£å¿ƒæ€ï¼Œç„¶åå»æ‰¾æ¯”ä½ æ›´å¼ºçš„äººæ¥è¯·æ•™ã€‚è¿™æ ·åšçš„è¯ï¼Œä½ å³ç»“äº¤äº†æœ‹å‹åˆå­¦åˆ°äº†çŸ¥è¯†ï¼Œä¸¤å…¨å…¶ç¾ï¼Œä½•ä¹è€Œä¸ä¸ºå‘¢ï¼Ÿ</p><hr><p><strong>çŸ¥ä¹‹ä¸ºçŸ¥ä¹‹ï¼Œä¸çŸ¥ä¸ºä¸çŸ¥~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¤çŸ¥ è‡ªæˆ‘æˆé•¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡: Gitå…¥é—¨</title>
      <link href="/2019/06/09/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Git%E5%85%A5%E9%97%A8/"/>
      <url>/2019/06/09/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Git%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»£ç ç®¡ç†"><a href="#ä»£ç ç®¡ç†" class="headerlink" title="ä»£ç ç®¡ç†"></a>ä»£ç ç®¡ç†</h2><p>å¦‚æœä½ è¿˜æ²¡æœ‰Githubè´¦å·ï¼Œèµ¶ç´§ç‚¹å‡» <a href="https://github.com/">è¿™é‡Œ</a> å»åˆ›å»ºä¸€ä¸ªï¼Œå¾ˆç®€å•ï¼Œç„¶åä¸‹è½½  <a href="https://git-scm.com/download/gui/windows">Git GUI</a> å®‰è£…å³å¯ï¼Œå¦‚æœä½ è¿˜ä¸ä¼šè¿™äº›æ“ä½œï¼Œè¯·è¡ŒåŠ¨èµ·æ¥å»æœç´¢å¯¹åº”çš„æ–¹æ³•ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</p><p>åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼Œé™¤äº†å†™ä»£ç ä¹‹å¤–ï¼Œè¿˜éœ€è¦å¯¹ä»£ç è¿›è¡Œç®¡ç†ã€‚åœ¨è¯´å¦‚ä½•ç®¡ç†ä»£ç ä¹‹å‰ï¼Œå…ˆè·Ÿå¤§å®¶åˆ†äº«å‡ ä¸ªå®é™…å¼€å‘ä¸­å…³äºä»£ç ç®¡ç†çš„åœºæ™¯ã€‚</p><p><strong>æ¡ˆä¾‹1ï¼šå…¥é—¨çš„å°æ—º</strong></p><p>å°æ—ºæ˜¯åå…¥é—¨ä¸ä¹…å¼€å‘ä¹‹è·¯çš„ç¼–ç¨‹ç‹‚é­”ï¼Œå¯¹ä»£ç æœ‰é¢—æ‰§ç€çš„å¿ƒã€‚å¹³æ—¶ç¼–å†™çš„ä»£ç å…¨éƒ¨æ”¾åœ¨è‡ªå·±çš„é‚£å°Macbook Proä¸Šé¢ï¼Œæœ‰ä¸€å¤©å°æ—ºä¸å°å¿ƒæŠŠè‡ªå·±ç¼–å†™çš„é‡è¦ä»£ç ç»™åˆ é™¤äº†ï¼Œä¸‡æ¶çš„ <code>rm -fr code</code> å‘€ï¼å¿ƒä¸­ä¸€ä¸‡å¤´è‰æ³¥é©¬å¥”é©°è€Œè¿‡ã€‚è¿™è®©å°æ—ºä¼¤é€äº†è„‘ç­‹ï¼Œåªèƒ½ç†¬å¤œç¡¬ç€å¤´çš®å†æŠŠå®ƒç»™ç èµ·æ¥ï¼Œè‡ªå·±çŠ¯çš„é”™åªèƒ½é»˜é»˜åœ°æ‰¿å—ç€ã€‚</p><p><strong>æ¡ˆä¾‹2ï¼šæ–°æ‰‹å°æå’Œå°åˆš</strong></p><p>å°æå’Œå°åˆšæ˜¯ä¸€å¯¹ç¼–ç¨‹æ­æ¡£ï¼ˆå…¬å¸åªæœ‰ä»–ä»¬ä¸¤ä¸ªAndroidå¼€å‘ï¼Œç›¸ä¾ä¸ºå‘½å§ï¼‰ï¼Œä¸¤ä½éƒ½æ˜¯å¼€å‘çš„æ–°æ‰‹ã€‚æ¯æ¬¡å°æå’Œå°åˆšåˆ†åˆ«æäº¤ä»£ç åˆ°ä»“åº“ï¼Œéƒ½è¦ç»å†ä¸€åœºæƒ¨ç›®å¿ç¹çš„åšå¼ˆã€‚æ‰€è°“çš„åšå¼ˆæŒ‡çš„æ˜¯ä¸¤ä½è¦èŠ±å¾ˆé•¿æ—¶é—´æ¥è§£å†³ä»£ç å†²çªçš„é—®é¢˜ï¼Œå“ï¼Œé™¤äº†å†™ä»£ç è¿˜è¦è§£å†³è¿™äº›æ— èŠçš„é—®é¢˜ï¼Œçƒ¦ï¼</p><p>å¦‚æœå°æ—ºçŸ¥é“ä½¿ç”¨Gitç®¡ç†ä»£ç ï¼Œä¹Ÿå¯ä»¥é¿å…è¯¯åˆ çš„é£é™©ã€‚</p><p>å°æå’Œå°åˆšè¦æ¯”å°æ—ºæœºæ™ºï¼Œè‡³å°‘çŸ¥é“ä»£ç è¦æäº¤åˆ°ä»“åº“ï¼Œå½“ç„¶å°æå’Œå°åˆšå·¥ä½œç»éªŒä¸°å¯Œï¼Œå…¬å¸ä¹Ÿè¦æ±‚ä»£ç å¿…é¡»æäº¤ã€‚ä½†æ˜¯äºŒä½å´æ²¡æœ‰ç”¨å¥½ä»£ç ç®¡ç†å·¥å…·ï¼Œä»è€Œå¸¦æ¥äº†ä¸€äº›çƒ¦æ¼ã€‚</p><p>æ˜¯çš„ï¼Œç®¡ç†ä»£ç å¾ˆé‡è¦ï¼Œæ— è®ºä½¿ç”¨SVNè¿˜æ˜¯Gitï¼Œè‡³å°‘ä½ è¦ç†Ÿç»ƒæŒæ¡å…¶ä¸­ä¸€ä¸ªï¼Œæˆ‘å»ºè®®è¿˜æ˜¯ç›´æ¥å­¦ä¹ Gitå§ï¼Œæ¯•ç«Ÿç°åœ¨å¤§å¤šæ•°å…¬å¸éƒ½åœ¨ç”¨å®ƒã€‚</p><p>åœ¨ <code>Spring Boot</code> ç³»åˆ—çš„æ–‡ç« ä¸­ï¼Œä½¿ç”¨ <code>Github</code> ä½œä¸ºæˆ‘ä»¬çš„ä»£ç ç®¡ç†ä»“åº“ï¼Œä½¿ç”¨Gitå·¥å…·è¿›è¡Œä»£ç çš„æäº¤ã€ä¿®æ”¹ã€åˆå¹¶å’Œåˆ é™¤ä»¥åŠå¯¹åˆ†æ”¯çš„ç®¡ç†å’Œä½¿ç”¨ã€‚</p><h2 id="Git-æäº¤"><a href="#Git-æäº¤" class="headerlink" title="Git æäº¤"></a>Git æäº¤</h2><p>æŠŠåœ¨ <a href="http://www.veryitman.com/2019/06/02/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E6%83%B3%E5%8A%9E%E6%B3%95%E8%AE%A9%E9%A1%B9%E7%9B%AE%E8%BF%90%E8%A1%8C%E8%B5%B7%E6%9D%A5/">å¾®æœåŠ¡: æƒ³åŠæ³•è®©é¡¹ç›®è¿è¡Œèµ·æ¥</a> å†™å¥½çš„ä»£ç æäº¤åˆ°ä»£ç ä»“åº“ä¸­ï¼Œè¿™æ ·å³ä½¿æœ¬åœ°ä»£ç è¢«è¯¯åˆ ä¹Ÿå¯ä»¥ä»è¿œç¨‹æ‰¾å›æ¥ï¼Œå®‰å…¨ã€‚å‡å¦‚ä½ æ›´æ¢ä¸€å°ç”µè„‘è¿›è¡Œç¼–ç¨‹ä¹Ÿå¯ä»¥ä»è¿œç¨‹ä»“åº“æ‹‰ä¸‹ä»£ç è¿›è¡Œç¼–ç¨‹ï¼Œéšæ—¶éšåœ°æ’¸ä»£ç ã€‚</p><p>æäº¤ä»£ç ï¼Œå¾ˆç®€å•ï¼Œwindowsä¸Šé¢å®‰è£…gitå·¥å…·å³å¯ã€‚æˆ‘ä½¿ç”¨çš„æ˜¯ <a href="https://git-scm.com/download/gui/windows">Git GUI</a>ï¼Œå®ƒè‡ªå¸¦ <code>Git Bash</code>ï¼Œæœ‰ç§Unixç»ˆç«¯çš„é£èŒƒï¼Œè´¼äº²åˆ‡ï¼</p><p>æˆ‘æ¯”è¾ƒå–œæ¬¢ä½¿ç”¨å‘½ä»¤è¡Œæ¥è¿›è¡Œæ“ä½œï¼Œæ‰“å¼€å·¥ç¨‹ç›®å½•ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/06/09/1.png" alt="1555860042560"></p><p>ç„¶ååœ¨ç©ºç™½åœ°æ–¹å³é”®ï¼Œä¼šæ˜¾ç¤º <code>Git Bash</code>ï¼Œé€‰ä»–å°±ä¼šæ‰“å¼€å‘½ä»¤ç»ˆç«¯å·¥å…·ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2019/06/09/2.png" alt="1555860285254"></p><p>åœ¨ç»ˆç«¯æ“ä½œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">æ·»åŠ æ‰€æœ‰æ–‡ä»¶</span></span><br><span class="line">git add -A *</span><br><span class="line"><span class="meta"># </span><span class="language-bash">æäº¤åˆ°æœ¬åœ°ä»“åº“å¹¶åŠ ä¸Šæ³¨é‡Š</span></span><br><span class="line">git commit -m &quot;Create a greate project&quot;</span><br><span class="line"><span class="meta"># </span><span class="language-bash">æ¨é€åˆ°è¿œç¨‹masteråˆ†æ”¯</span></span><br><span class="line">git push origin master</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ ä¹‹å‰æ²¡æœ‰è¿›è¡Œä»»ä½•gitæäº¤çš„è¯ï¼Œé¦–æ¬¡æäº¤ä¼šæç¤ºä½ è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œæ­¤æ—¶ä½ è¾“å…¥è‡ªå·±çš„githubè´¦å·å’Œå¯†ç å³å¯ã€‚</p><p>ä¸‰æ­¥æ“ä½œå®Œæˆåï¼Œå·¥ç¨‹ä¹Ÿå°±æäº¤æˆåŠŸäº†ã€‚ä¸ºäº†éªŒè¯æäº¤æ˜¯å¦æˆåŠŸï¼Œä½ ä¹Ÿå¯ä»¥åˆ°è¿œç¨‹ä»“åº“(ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€ä½ çš„ä»“åº“åœ°å€)åˆ·æ–°çœ‹çœ‹æœ‰æ²¡æœ‰åˆšæ‰æäº¤çš„å†…å®¹ï¼Œå¦‚æœç½‘ç»œä¸å¥½å°±ç­‰ä¼šåœ¨ç…ç…ã€‚</p><h2 id="åˆ›å»ºåˆ†æ”¯"><a href="#åˆ›å»ºåˆ†æ”¯" class="headerlink" title="åˆ›å»ºåˆ†æ”¯"></a>åˆ›å»ºåˆ†æ”¯</h2><p>ä¸ºäº†ä¸å½±å“ä¸»å¹²(master)ä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªä¸ªäººåˆ†æ”¯æ¥è¿›è¡Œå¼€å‘ï¼Œä¾‹å¦‚æˆ‘çš„ä¸ªäººåˆ†æ”¯ <code>veryitman-feature</code> åˆ†æ”¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git chekcout -b veryitman-feature</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„gitå‘½ä»¤æ„æ€æ˜¯åœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªåä¸º <code>veryitman-feature</code> çš„åˆ†æ”¯ã€‚</p><p><strong>æ³¨æ„ï¼š<code>git chekcout -b xxx</code> ç›¸å½“äºè¿›è¡Œä¸‹é¢ä¸¤æ­¥æ“ä½œ</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git branch xxx</span><br><span class="line"></span><br><span class="line">git checkout xxx</span><br></pre></td></tr></table></figure><p>ä¸»å¹² <code>master</code> æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªåˆ†æ”¯ï¼Œåªæ˜¯å¼€å‘è€…ä¸ºäº†ååŠ©å’Œä»£ç ç®¡ç†æ–¹ä¾¿åˆ›å»ºäº†å„è‡ªçš„åˆ†æ”¯ï¼Œç­‰ä»£ç æµ‹è¯•æˆ–è€…éªŒæ”¶é€šè¿‡å†ä»è‡ªå·±çš„åˆ†æ”¯åˆå¹¶ä»£ç åˆ°ä¸»å¹² <code>master</code> ä¸Šé¢ï¼Œæ‰€ä»¥ä¸€èˆ¬  <code>master</code> åˆ†æ”¯ä¸Šé¢çš„ä»£ç éƒ½ä¼šè®¤ä¸ºæ˜¯ç›¸å¯¹ç†æ€§ã€å®‰å…¨çš„ä»£ç ã€‚</p><p>åˆ†æ”¯çš„å­˜åœ¨æ˜¯ä¸ºäº†æ–¹ä¾¿ä»£ç çš„ç®¡ç†ï¼Œç±»ä¼¼äºSVNçš„trunkã€tagã€branchæ–‡ä»¶å¤¹ç®¡ç†ä»£ç ä¸€æ ·ã€‚</p><p>åˆ›å»ºå®Œæˆåï¼Œæäº¤åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“å³å¯ï¼Œç»ˆç«¯æ“ä½œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin veryitman-feature</span><br></pre></td></tr></table></figure><p>å»è¿œç¨‹ä»£ç ä»“åº“ä¸­ï¼Œåˆ·æ–°é¡µé¢åï¼Œåœ¨Branchå¯ä»¥çœ‹åˆ°åˆšæ‰åˆ›å»ºçš„  <code>veryitman-feature</code> åˆ†æ”¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2019/06/09/3.png" alt="1555860471904"></p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼è¿›è¡Œåˆ›å»ºå’Œæ¨é€åˆ†æ”¯ä»£ç ï¼Œæ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">åœ¨æœ¬åœ°åˆ›å»ºæ–°çš„veryitman-featureåˆ†æ”¯</span> </span><br><span class="line">git branch veryitman-feature</span><br><span class="line"><span class="meta"># </span><span class="language-bash">åˆ‡æ¢åˆ°æ–°çš„veryitman-featureåˆ†æ”¯</span>    </span><br><span class="line">git checkout veryitman-feature</span><br><span class="line"><span class="meta"># </span><span class="language-bash">å°†æ–°çš„åˆ†æ”¯æ¨é€åˆ°ä»“åº“</span></span><br><span class="line">git push origin veryitman-feature</span><br></pre></td></tr></table></figure><h2 id="åˆ‡æ¢åˆ†æ”¯"><a href="#åˆ‡æ¢åˆ†æ”¯" class="headerlink" title="åˆ‡æ¢åˆ†æ”¯"></a>åˆ‡æ¢åˆ†æ”¯</h2><p>åœ¨ä¸Šé¢çš„æ“ä½œä¸­ï¼Œå¤§å®¶å·²ç»çœ‹åˆ°æˆ‘ä»¬åˆ›å»ºäº† <code>veryitman-feature</code> åˆ†æ”¯ï¼ŒåŠ ä¸ŠåŸæ¥é»˜è®¤çš„ <code>master</code> åˆ†æ”¯ï¼Œä¸€å…±æ˜¯ä¸¤ä¸ªåˆ†æ”¯äº†ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œ<code>master</code> åˆ†æ”¯ä¸Šé¢çš„ä»£ç åº”è¯¥æ˜¯ç»è¿‡æµ‹è¯•å¹¶ä¸”ç¨³å®šçš„ç‰ˆæœ¬ï¼Œä¿è¯å…¶ç¨³å®šä¸ä¼šå‡ºé”™ã€‚è€Œå…¶ä»–åˆ†æ”¯å¦‚ä¸Šé¢çš„  <code>veryitman-feature</code> æ˜¯æˆ‘ä»¬éœ€è¦è¿›è¡Œå¼€å‘çš„ä¸ªäººåˆ†æ”¯ï¼Œä¸ä¿è¯å…¶ç¨³å®šæ€§ï¼ˆå› ä¸ºåœ¨å¼€å‘å˜›ï¼‰ã€‚ç­‰  <code>veryitman-feature</code>  å¼€å‘å®Œæˆå†åˆå¹¶åˆ° <code>master</code> åˆ†æ”¯ä¸Šé¢ï¼Œå…³äºåˆ†æ”¯çš„åˆå¹¶æ“ä½œï¼Œåç»­å†è¯´å§ï¼</p><p><code>Git</code> æ”¯æŒåœ¨åˆ†æ”¯ä¹‹é—´è‡ªç”±åˆ‡æ¢ï¼Œæ¯”å¦‚ä½ åœ¨  <code>veryitman-feature</code>  åˆ†æ”¯ï¼Œæäº¤å®Œæˆä»£ç åï¼Œå¯ä»¥åˆ‡æ¢åˆ° <code>master</code> åˆ†æ”¯ã€‚åˆ‡æ¢åˆ†æ”¯çš„å‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout master</span><br></pre></td></tr></table></figure><p>å¦‚æœå†æƒ³ä» <code>master</code> åˆ†æ”¯åˆ‡æ¢åˆ°  <code>veryitman-feature</code>  ä¹Ÿå¯ä»¥ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git chekcout veryitman-feature</span><br></pre></td></tr></table></figure><p>åˆ‡æ¢åˆ†æ”¯ä¸€èˆ¬ç”¨åœ¨ä¸‹é¢å‡ ä¸ªåœºæ™¯ä¸­ï¼š</p><ul><li>åˆå¹¶ä»£ç </li><li>å¤šåˆ†æ”¯å¼€å‘</li><li>ä¿®å¤é—®é¢˜</li></ul><h2 id="åˆ é™¤åˆ†æ”¯"><a href="#åˆ é™¤åˆ†æ”¯" class="headerlink" title="åˆ é™¤åˆ†æ”¯"></a>åˆ é™¤åˆ†æ”¯</h2><p><code>Git</code> æä¾›äº†å¯ä»¥åˆ é™¤åˆ†æ”¯çš„æ–¹æ³•å’Œå‘½ä»¤ã€‚</p><p>åˆ é™¤åˆ†æ”¯åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ä¸ªæ˜¯ä»…ä»…åˆ é™¤æœ¬åœ°åˆ†æ”¯ï¼Œå¦ä¸€ä¸ªæ˜¯åˆ é™¤è¿œç¨‹åˆ†æ”¯ã€‚</p><p>åˆ é™¤æœ¬åœ°åˆ†æ”¯æ„æ€æ˜¯åˆ é™¤å·²ç»å­˜å‚¨åœ¨ä½ æœ¬åœ°è®¡ç®—æœºä¸Šé¢çš„æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">åœ¨æœ¬åœ°åˆ é™¤veryitman-featureåˆ†æ”¯</span></span><br><span class="line">git branch -d veryitman-feature</span><br></pre></td></tr></table></figure><p>åˆ é™¤è¿œç¨‹åˆ†æ”¯æ„æ€æ˜¯åˆ é™¤å­˜åœ¨ <code>GitHub</code> ä¸Šé¢çš„ä»£ç æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">åœ¨githubè¿œç¨‹ç«¯åˆ é™¤veryitman-featureåˆ†æ”¯</span></span><br><span class="line">git push origin --delete veryitman-feature</span><br></pre></td></tr></table></figure><hr><p>å…³äºGitçš„ä½¿ç”¨è¿˜æœ‰å¾ˆå¤šï¼Œä»Šå¤©å…ˆè¯´è¿™ä¹ˆå¤šï¼Œç”¨åˆ°çš„æ—¶å€™å†è¡¥å……ã€‚ç°åœ¨æœ€é‡è¦çš„æ˜¯éœ€è¦ä½ å»æ³¨å†Œä¸€ä¸ª <code>Github</code> è´¦å·æŠ˜è…¾èµ·æ¥ï¼Œç†Ÿèƒ½ç”Ÿå·§ï¼ŒåŠ¨æ‰‹å®è·µæ‰æ˜¯ç‹é“ï¼</p><hr><p><strong>æ”¹å˜ï¼Œä»ä½ æˆ‘ç›¸è¯†å¼€å§‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot SpringCloud å¾®æœåŠ¡ Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è°ƒä¾ƒCä¸­çš„define</title>
      <link href="/2019/06/08/%E8%B0%83%E4%BE%83C%E4%B8%AD%E7%9A%84define/"/>
      <url>/2019/06/08/%E8%B0%83%E4%BE%83C%E4%B8%AD%E7%9A%84define/</url>
      
        <content type="html"><![CDATA[<h2 id="äºŒç‹—å­"><a href="#äºŒç‹—å­" class="headerlink" title="äºŒç‹—å­"></a>äºŒç‹—å­</h2><p>äºŒç‹—å­è¿™ä¸ªåå­—ï¼Œåœ¨å¤§è¡—å°å··ï¼Œåœ¨ç”µè§†å‰§ä¸­å‡ ä¹éƒ½èƒ½å¬åˆ°ã€‚æˆ‘ä¹Ÿä¸çŸ¥é“è€ä¸€è¾ˆçš„çˆ¶æ¯ä¸ºä»€ä¹ˆè¿™ä¹ˆå–œæ¬¢ç»™è‡ªå·±çš„å­©å­å–è¿™æ ·çš„åå­—ï¼Œå”¯ä¸€èƒ½è®©æˆ‘ä¿¡æœçš„ç†ç”±æ˜¯ï¼šé¡ºå£ï¼å¤§å”å¤§ä¼¯ä»¬ä¹‹æ‰€ä»¥å«è¿™ä¸ªåå­—è¿˜æœ‰ä¸€ä¸ªç†ç”±ï¼Œä¹‹å‰å­©å­å¤šï¼Œå¸Œæœ›å­©å­åƒå°ç‹—å„¿ä¸€æ ·å¥½å–‚å…»ã€‚</p><p>æ­£å¥½æˆ‘ä»¬æ‘æœ‰ä¸ªå­©å­ä¹Ÿå«äºŒç‹—å­ï¼Œå¤§åå«å¼ åŠ›ä¸‡ï¼Œæ— è®ºæ˜¯å«äºŒç‹—å­è¿˜æ˜¯å«å¼ åŠ›ä¸‡ï¼Œéƒ½æŒ‡çš„æ˜¯åŒä¸€ä¸ªäººã€‚æˆ‘ä»¬å¤§å¤šæ•°æƒ…å†µä¸‹è¿˜æ˜¯å«ä»–äºŒç‹—å­ï¼Œä»–ä¹Ÿä¹ æƒ¯äº†å€’ä¹Ÿè§‰å¾—äº²åˆ‡ï¼Œå«å¼ åŠ›ä¸‡ä¸€èˆ¬éƒ½æ˜¯åœ¨æ­£å¼åœºåˆã€‚</p><p>æœ‰äº›ä¼ä¸šæ–‡åŒ–ä¸­è§„å®šï¼šâ€œä¸å…è®¸åœ¨å…¬å¸ç›´æ¥å–ŠåŒäº‹çš„åå­—ï¼Œæ¯ä¸ªäººå¿…é¡»æœ‰ä¸ªè‹±æ–‡åâ€ã€‚æ¯”å¦‚äºŒç‹—å­å…¥èŒåˆ°è¿™æ ·çš„ä¼ä¸šï¼Œå¤§å®¶ä¸å…è®¸å–Šä»–äºŒç‹—å­æˆ–è€…å¼ åŠ›ä¸‡ï¼Œäºæ˜¯äºŒç‹—å­åˆæœ‰äº†ä¸€ä¸ªè‹±æ–‡åï¼šâ€œJackâ€ï¼Œä½ çœ‹ â€œJackâ€ è¿™ä¸ªåå­—æ—¢ç¬¦åˆä¼ä¸šæ–‡åŒ–åˆå¬èµ·æ¥é«˜å¤§å°šã€‚</p><p>æ— è®ºæ˜¯ â€œäºŒç‹—å­â€œ è¿˜æ˜¯ â€œJackâ€œ éƒ½æ˜¯å¼ åŠ›ä¸‡çš„åˆ«åã€‚</p><p>åœ¨ C è¯­è¨€ä¸­ï¼Œå…³é”®å­— <code>define</code> å’Œ <code>typedef</code> å°±å¯ä»¥ç”¨æ¥å–åˆ«åï¼Œä½†æ˜¯äºŒè€…åˆæœ‰ä¸åŒç‚¹ï¼Œä»Šå¤©ä¸»è¦åˆ†äº«ä¸€ä¸‹ <code>define</code> çš„ç”¨æ³•ã€‚</p><p>ä¸‹é¢æ˜¯ä½¿ç”¨ <code>define</code> æ¥æ¨¡æ‹Ÿåˆ«åï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> Zhangliwan1 <span class="string">&quot;äºŒç‹—å­&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Zhangliwan2 <span class="string">&quot;Jack&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Zhangliwan <span class="string">&quot;å¼ åŠ›ä¸‡&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;æˆ‘ä»¬æ‘çš„%så¯ä»¥å«ä»–%sä¹Ÿå¯ä»¥å«ä»–%s\n&quot;</span>, Zhangliwan, Zhangliwan1, Zhangliwan2);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘ä»¬æ‘çš„å¼ åŠ›ä¸‡å¯ä»¥å«ä»–äºŒç‹—å­ä¹Ÿå¯ä»¥å«ä»–Jack</span><br></pre></td></tr></table></figure><h2 id="è™šæ„ä¸€ä¸‹"><a href="#è™šæ„ä¸€ä¸‹" class="headerlink" title="è™šæ„ä¸€ä¸‹"></a>è™šæ„ä¸€ä¸‹</h2><p><a href="https://baike.baidu.com/item/%E4%B8%B9%E5%B0%BC%E6%96%AF%C2%B7%E9%87%8C%E5%A5%87/7267171">ä¸¹å°¼æ–¯Â·é‡Œå¥‡</a> ä¸€ä¸ªä¼Ÿå¤§è€Œä½è°ƒçš„ç‰›äººï¼Œæ˜¯Unixä¹‹çˆ¶ã€Cè¯­è¨€ä¹‹çˆ¶ã€‚</p><p><img src="/upload/images/2019/06/08/1.png"></p><p>ä¸¹å°¼æ–¯Â·é‡Œå¥‡è¿˜å°†Unixçš„è®¾è®¡åŸåˆ™å®šä¸º <code>KISS åŸåˆ™</code> å³ Keep it simple stupidï¼Œä¿æŒç®€å•å’Œç›´æ¥ï¼Œæ‰€ä»¥Unixä¸€ç›´éƒ½æ˜¯ç»å…¸ä¸­çš„ç»å…¸ã€‚è¿™ä¹Ÿè¯´æ˜ä¸¹å°¼æ–¯Â·é‡Œå¥‡ä¸ä»…æ˜¯ä¸€ä¸ªä¼˜ç§€çš„å·¥ç¨‹å¸ˆï¼Œè¿˜æ˜¯ä¸€ä¸ªä¼˜ç§€çš„äº§å“ç»ç†ã€‚</p><p>æˆ‘åœ¨æƒ³ï¼Œå½“åˆä¸¹å°¼æ–¯Â·é‡Œå¥‡å’Œè‚¯Â·æ±¤æ™®é€Šåœ¨å®éªŒå®¤é‡Œæ²¡äº‹ä¹Ÿä¼šè®¨è®ºCè¯­è¨€çš„äº‹æƒ…ã€‚</p><p>ä¸¹å°¼æ–¯Â·é‡Œå¥‡ï¼šâ€œè€å…„ï¼Œä½ çœ‹æˆ‘ä»¬ç°åœ¨çš„è¯­è¨€æ˜¯ä¸æ˜¯è¿‡äºå¤æ‚äº†ï¼Ÿâ€</p><p>è‚¯Â·æ±¤æ™®é€Šï¼šâ€œçš„ç¡®æœ‰ç‚¹å¤æ‚ï¼Œæˆ‘æœ‰ä¸ªå¤§èƒ†çš„æƒ³æ³•ï¼Œä¸çŸ¥å½“è®²ä¸å½“è®²ï¼Ÿâ€</p><p>ä¸¹å°¼æ–¯Â·é‡Œå¥‡ï¼šâ€œä½ è¿˜è·Ÿæˆ‘å¢¨è¿¹å•¥ï¼Œæœ‰è¯ç›´æ¥è¯´å‘—ï¼Œå‘µå‘µï¼â€</p><p>è‚¯Â·æ±¤æ™®é€Šï¼šâ€œå—¯ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å‘ä¸€é—¨æ–°çš„è¯­è¨€ï¼Œä»–è¦è¶³å¤Ÿçš„ç®€å•ã€é«˜æ•ˆã€‚â€</p><p>ä¸¹å°¼æ–¯Â·é‡Œå¥‡ï¼šâ€œæƒ³æ³•æ˜¯æŒºå¥½çš„ï¼Œé‚£å°±å¼€å¹²å§ï¼â€</p><p>äºæ˜¯Cè¯­è¨€è¯ç”Ÿäº†ã€‚</p><p>è‚¯Â·æ±¤æ™®é€Šï¼šâ€œä½ æœ‰æ²¡æœ‰è§‰å¾—æˆ‘ä»¬åœ¨å®šä¹‰å¸¸é‡çš„æ—¶å€™ä¸å¤ªæ–¹ä¾¿ï¼Ÿâ€</p><p>ä¸¹å°¼æ–¯Â·é‡Œå¥‡ï¼šâ€œæ˜¯å‘€ï¼Œè¿™æ ·ä½ çœ‹è¡Œä¸è¡Œï¼Œå¼„ä¸ªé¢„å¤„ç†å™¨å¯ä»¥è®©æˆ‘ä»¬ä»»æ„å®šä¹‰å¸¸é‡ï¼Œæš‚æ—¶ç§°ä»–ä¸º â€˜å®â€™ å§ï¼â€</p><p>è‚¯Â·æ±¤æ™®é€Šï¼šâ€œæˆ‘è§‰å¾—å®Œå…¨æ²¡æœ‰é—®é¢˜ï¼Œæ¥ï¼Œå¾’æ‰‹å†™ä¸€ä¸ªã€‚â€</p><p>ä¸¹å°¼æ–¯Â·é‡Œå¥‡ï¼šâ€œå“ˆå“ˆï¼Œç»™åŠ›ï¼â€</p><p>äºæ˜¯ <code>define</code> å°±æœ‰äº†ã€‚</p><p>ä»¥ä¸Šçº¯å±ä¸ªäººçŒœæƒ³ï¼Œå¹¶ä¸æ˜¯å†’çŠ¯ä¸¤ä½å¤§å¸ˆï¼Œæœ¬æ•…äº‹çº¯å±è™šæ„ï¼Œå¦‚æœ‰é›·åŒï¼Œçº¯å±å·§åˆã€‚Unixå’ŒCè¯­è¨€çš„å¤§é“è‡³ç®€ï¼Œå¯¹åä»£ç§‘å­¦çš„å‘å±•å¥ å®šäº†ä¸å¯ç£¨ç­çš„è´¡çŒ®å’Œå½±å“ã€‚</p><h2 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h2><p>å…³é”®å­— <code>define</code> æ˜¯ C è¯­è¨€ä¸­çš„é¢„å¤„ç†å‘½ä»¤ï¼Œå®ƒç”¨äºå®å®šä¹‰ï¼Œåœ¨å¤§å¤šæ•°å®šä¹‰ä¸‹å¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ï¼Œä¸ºç¼–ç¨‹æä¾›æ–¹ä¾¿ã€‚</p><p>åœ¨ C è¯­è¨€ä¸­é¢„å¤„ç†å‘½ä»¤ä»¥ â€œ#â€ å·å¼€å¤´ï¼Œå¦‚ <code>#include</code>ã€<code>#ifdef</code>ã€<code>#endif</code> å’Œå®å®šä¹‰å‘½ä»¤ <code>#define</code> ç­‰ã€‚</p><p>å…³é”®å­— <code>define</code> çš„ç”¨æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> æ–°ç±»å‹å åŸç±»å‹å</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> INTEGER int</span></span><br><span class="line">INTEGER a = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PI 3.1415927</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> UserName <span class="string">&quot;user_name&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX(x, y) (x)&gt;(y)?(x):(y);</span></span><br></pre></td></tr></table></figure><p>åœ¨ C è¯­è¨€ä¸­ï¼Œå…³é”®å­— <code>define</code> çš„å®šä¹‰çš„å¸¸é‡éƒ½ä¼šåœ¨é¢„å¤„ç†é˜¶æ®µå°†ç”¨åˆ°çš„åˆ«åç›´æ¥è¢«åŸæ ·æ›¿æ¢æ‰ã€‚ä¾‹å¦‚åœ¨ç¼–å†™æºç¨‹åºæ—¶ï¼Œæ‰€æœ‰ç”¨åˆ° 3.1415927 çš„åœ°æ–¹éƒ½å¯ç”¨ PI ä»£æ›¿ï¼Œè€Œç¼–è¯‘æ—¶ï¼Œå°†å…ˆç”±é¢„å¤„ç†ç¨‹åºè¿›è¡Œå®ä»£æ¢å³ç”¨ 3.1415927 å»ç½®æ¢æ‰€æœ‰çš„å®å PIï¼Œç„¶åå†è¿›è¡Œç¼–è¯‘ã€‚</p><p>å…³é”®å­— <code>define</code> è¿˜å¯ä»¥ç»“åˆ â€œ#â€ã€â€œ##â€ã€â€œ#@â€ ä½¿ç”¨ã€‚</p><ul><li><p>ç¬¦å· â€œ#â€ï¼Œè¡¨ç¤ºå°†å…¶å­—ç¬¦ä¸²åŒ–ã€‚</p></li><li><p>ç¬¦å· â€œ##â€ï¼Œè¡¨ç¤ºè¿æ¥å˜é‡ã€‚</p></li><li><p>ç¬¦å· â€œ#@â€ï¼Œè¡¨ç¤ºå°†å…¶å­—ç¬¦åŒ–ã€‚</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> M(x) x##x</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> L(x) #x</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// M(1): 11, L(1): &quot;1&quot;</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;M(1): %i, L(1): %s\n&quot;</span>, M(<span class="number">1</span>), L(<span class="number">1</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä½¿ç”¨ â€œ#@â€ å®šä¹‰ï¼Œæ— è®ºæ˜¯GCCç¼–è¯‘å™¨è¿˜æ˜¯Clangç¼–è¯‘å™¨éƒ½æ— æ³•é€šè¿‡ç¼–è¯‘ï¼Œé”™è¯¯ä¿¡æ¯ï¼šâ€œ â€˜#â€™ is not followed by a macro parameter â€ï¼Œä½†æ˜¯åœ¨ Visual Studio ä¸­ç¼–è¯‘å°±æ²¡æœ‰é—®é¢˜ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> K(x) #@x</span></span><br></pre></td></tr></table></figure><p>å…³é”®å­— <code>define</code> ç»™æˆ‘ä»¬å†™ä»£ç å¸¦æ¥äº†ä¸€å®šçš„ä¾¿åˆ©ï¼Œä½†æ˜¯å¦‚æœè¿‡å¤šçš„ä¹±ç”¨å®ƒä¹Ÿä¼šä»£ç ä¸å°çš„éº»çƒ¦ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> square(x) x*x</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line">i = <span class="number">64</span>/square(<span class="number">4</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;i = %d\n&quot;</span>, i);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰å® <code>square(x)</code> æœ¬æ¥æ˜¯æ±‚æŸä¸ªæ•°çš„å¹³æ–¹ï¼ŒæŒ‰ç†è¯´ 64&#x2F;16 ç»“æœåº”è¯¥æ˜¯ 4ï¼Œä½†æ˜¯è¿è¡Œç¨‹åºä½ ä¼šå‘ç°ç»“æœæ˜¯ 64.</p><p>æˆ‘ä»¬æŠŠä¸Šé¢çš„ä¾‹å­å±•å¼€ï¼Œå› ä¸º <code>define</code> æ˜¯ç›´æ¥åŸæ ·æ›¿æ¢ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">i = <span class="number">64</span>/<span class="number">4</span>*<span class="number">4</span>;</span><br><span class="line">i = <span class="number">16</span>*<span class="number">4</span>;</span><br><span class="line">i = <span class="number">64</span>;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸€ä¸‹ç¨‹åºä¸­ <code>define</code> çš„å®šä¹‰ï¼Œç»“æœå°±å¯¹äº†ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> square(x) (x*x)</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line">i = <span class="number">64</span>/square(<span class="number">4</span>);</span><br><span class="line"><span class="comment">// 4</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;i = %d\n&quot;</span>, i);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®æœ€å®‰å…¨çš„åšæ³•æ˜¯è¿™æ ·å®šä¹‰ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> square(x) (&#123;    \</span></span><br><span class="line"><span class="meta">typeof(x) y = (x);  \</span></span><br><span class="line"><span class="meta">y*y;                \</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br></pre></td></tr></table></figure><h2 id="ä½œç”¨åŸŸ"><a href="#ä½œç”¨åŸŸ" class="headerlink" title="ä½œç”¨åŸŸ"></a>ä½œç”¨åŸŸ</h2><p>å¯ä»¥åœ¨Cæ–‡ä»¶çš„å¼€å¤´ï¼Œä¹Ÿå¯ä»¥åœ¨æ–¹æ³•ä½“é‡Œé¢ï¼Œè¿˜å¯ä»¥åœ¨æ–¹æ³•çš„å£°æ˜å‰éƒ½å¯ä»¥ä½¿ç”¨ <code>define</code> å…³é”®å­—ã€‚</p><p>å®šä¹‰åœ¨æ–‡ä»¶å¼€å¤´ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> NAME <span class="string">&quot;name&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Define NAME: %s\n&quot;</span>, NAME);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰åœ¨æ–¹æ³•ä¸­ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">play</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> NAME <span class="string">&quot;name&quot;</span></span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Define NAME: %s\n&quot;</span>, NAME);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¦æ³¨æ„ï¼Œå®šä¹‰åœ¨æ–¹æ³•ä¸­ï¼Œå¹¶ä¸æ˜¯æŒ‡è¯¥å®å®šä¹‰ <code>NAME</code> åªèƒ½ç”¨åœ¨è¯¥æ–¹æ³•é‡Œé¢ï¼Œå…¶ä»–åœ°æ–¹ç…§æ ·å¯ä»¥ä½¿ç”¨ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">play</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> NAME <span class="string">&quot;name&quot;</span></span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Define NAME: %s\n&quot;</span>, NAME);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* æ³¨æ„ï¼šè¯¥æ–¹æ³•ä¸€å®šæ˜¯åœ¨defineå®šä¹‰ä¹‹åæ‰èƒ½ä½¿ç”¨NAME */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">eat</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Define NAME: %s\n&quot;</span>, NAME);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ¡ä»¶ç¼–è¯‘"><a href="#æ¡ä»¶ç¼–è¯‘" class="headerlink" title="æ¡ä»¶ç¼–è¯‘"></a>æ¡ä»¶ç¼–è¯‘</h2><p>åœ¨Cè¯­è¨€ä¸­æˆ–è€…åœ¨ç±»Cè¯­è¨€ä¸­å¦‚Objective-Cå’ŒC++ä¸­ï¼Œæˆ‘ä»¬ä¼šç»å¸¸ç”¨åˆ°æ¡ä»¶ç¼–è¯‘è¯­å¥ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifdef</span> NAME</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>å¤§å®¶åœ¨åšä¸€äº›è·¨å¹³å°å¼€å‘å·¥ä½œçš„æ—¶å€™ï¼Œä¹Ÿä¼šç”¨åˆ°æ¡ä»¶ç¼–è¯‘è¯­å¥ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ANDROID</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLAYFORM 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLAYFORM 2</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>è¿˜æœ‰å°±æ˜¯ç±»ä¼¼é˜²æ­¢é‡å¤åŒ…å«ï¼ˆé‡å¤å®šä¹‰ï¼‰å¤´æ–‡ä»¶ï¼Œä¹Ÿä¼šç”¨åˆ°æ¡ä»¶ç¼–è¯‘ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __Header_Person_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __Header_Person_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯æ¥è‡ªLinux Kernelé‡Œé¢çš„ä»£ç ç‰‡æ®µï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">if</span> defined(CONFIG_ALPHA_GENERIC)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GAMMA_BIASalpha_mv.sys.t2.gamma_bias</span></span><br><span class="line"><span class="meta">#<span class="keyword">elif</span> defined(CONFIG_ALPHA_GAMMA)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GAMMA_BIAS_GAMMA_BIAS</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GAMMA_BIAS0</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>æ—¢ç„¶æˆ‘ä»¬å¯ä»¥å®šä¹‰å®ï¼Œé‚£ä¹ˆæ˜¯å¦å¯ä»¥å–æ¶ˆå®å®šä¹‰å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å½“ç„¶å¯ä»¥ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">play</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> NAME <span class="string">&quot;name&quot;</span></span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Define NAME: %s\n&quot;</span>, NAME);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> NAME</span></span><br><span class="line"><span class="comment">// å–æ¶ˆå®å®šä¹‰</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> NAME</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">eat</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Compile errror: Use of undeclared identifier &#x27;NAME&#x27;</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Define NAME: %s\n&quot;</span>, NAME);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä»½ <a href="https://gcc.gnu.org/onlinedocs/cpp/Macors.html#Macros">GNU Macors</a> åœ¨çº¿æ–‡æ¡£ä»‹ç»äº†å¾ˆå¤šå…³äºå®å®šä¹‰çš„çŸ¥è¯†ï¼Œå¯ä»¥ç‚¹å‡»å‰å¾€å­¦ä¹ ã€‚</p><hr><p><strong>æ—¶é—´å¯ä»¥æ”¹å˜ä¸€åˆ‡ï¼Œä½†ä½ å¾—åšç‚¹ä»€ä¹ˆï¼</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> define typedef </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›å¿†é«˜è€ƒ</title>
      <link href="/2019/06/07/%E5%9B%9E%E5%BF%86%E9%AB%98%E8%80%83/"/>
      <url>/2019/06/07/%E5%9B%9E%E5%BF%86%E9%AB%98%E8%80%83/</url>
      
        <content type="html"><![CDATA[<p><img src="/upload/images/2019/06/07/1.jpeg" alt="1"></p><h2 id="æ¥”å­"><a href="#æ¥”å­" class="headerlink" title="æ¥”å­"></a>æ¥”å­</h2><p>è½¬çœ¼é—´ï¼Œæˆ‘äººç”Ÿä¸­çš„é«˜è€ƒè·ä»Šå·²åå‡ å¹´æœ‰ä½™äº†ï¼Œé‚£æ—¶å€™æ„æ°”é£å‘ï¼Œè¸Œèº‡æ»¡å¿—ï¼Œéšæ—¶è¿æ¥é«˜è€ƒçš„çµé­‚æ‹·é—®ã€‚å¹¸è¿çš„æ˜¯è‡ªå·±è·Œè·Œæ’æ’çš„è€ƒä¸Šäº†å¤§å­¦ï¼Œé˜´å·®é˜³é”™çš„å˜æˆäº†ä¸€åç¨‹åºçŒ¿ã€‚</p><p>ä»Šå¤©æ˜¯2019å¹´é«˜è€ƒçš„ç¬¬ä¸€å¤©ï¼Œä½œä¸ºä¸€å â€œèµ„æ·±â€ çš„ç¨‹åºçŒ¿æˆ‘è¿˜æ˜¯æƒ³ç”¨ç¼–ç¨‹çš„æ–¹å¼æ¥è®°å½•è¿™ä¸€å¤©ï¼Œç®—æ˜¯å¯¹å­¦å­ä»¬çš„ç¥ç¦å’Œå¯¹è‡ªå·±çš„é«˜ä¸­ç”Ÿæ´»çš„ä¸€ç‚¹å›å¿†å§ã€‚</p><p>ç¥æ‰€æœ‰é«˜è€ƒä¸­çš„å­¦è€…ä»¬éƒ½èƒ½å¦‚æ„¿ä»¥å¿çš„è€ƒä¸Šè‡ªå·±å¿ƒä¸­çš„é‚£æ‰€å¤§å­¦ï¼Œä½ ä»¬çš„äººç”Ÿå³å°†è¾‰ç…Œï¼ŒåŠ æ²¹ï¼</p><h2 id="ä¸æœŸè€Œé‡"><a href="#ä¸æœŸè€Œé‡" class="headerlink" title="ä¸æœŸè€Œé‡"></a>ä¸æœŸè€Œé‡</h2><p>åœ¨æˆ‘ä»¬é‚£ä¸ªå¹´ä»£ç‰¹åˆ«æ˜¯åœ¨æˆ‘ä»¬è€å®¶äººå¤šä¸”ç©·ï¼Œè°èƒ½ä¸Šå¤§å­¦ç®€ç›´å°±æ˜¯ â€œå…‰å®—è€€ç¥–â€ çš„äº‹æƒ…ï¼Œç„¶è€Œå¾ˆå¤šäººå¯¹å­¦ä¹ çš„æ¬²æœ›å¹¶ä¸å¼ºï¼Œä»–ä»¬å¤§éƒ¨åˆ†éƒ½å‘å¾€ç€å¤–é¢çš„ä¸–ç•Œã€‚å…¶å®ï¼Œæˆ‘ä¹Ÿå¾ˆæ¸´æœ›å¤–é¢çš„ä¸–ç•Œï¼Œæœ‰è¿‡é€ƒç¦»é‚£ç§å‹æŠ‘çš„é«˜ä¸­ç”Ÿæ´»çš„æƒ³æ³•ã€‚ä½†æ˜¯å›è¿‡å¤´ä»”ç»†æƒ³æƒ³å‡ºå»åç¯å¢ƒéš¾é“å°±æ²¡æœ‰éšœç¢å—ï¼Ÿç”Ÿæ´»å°±èƒ½å¦‚æ—¥ä¸­å¤©å—ï¼Ÿä¸å¯èƒ½çš„ï¼Œå°¤å…¶æ˜¯å¯¹å†œæ‘å‡ºæ¥çš„å­©å­æ¥è¯´æ²¡æœ‰å­¦å†æƒ³åœ¨å¤§åŸå¸‚ä¸­å¥½å¥½çš„æ´»ä¸‹å»çŠ¹å¦‚å¤©æ–¹å¤œè°­ã€‚å‡ºæ¥å·¥ä½œè¿™ä¹ˆå¤šå¹´ï¼Œç”Ÿæ´»çš„è‰°è¾›å°è¯äº†æˆ‘å½“åˆçš„æƒ³æ³•ã€‚</p><p>å‡¡äº‹ä¸å¿˜åˆå¿ƒï¼Œæ¯å½“ä½ æƒ³æ”¾å¼ƒçš„æ—¶å€™å°±å¥½å¥½æƒ³æƒ³å½“åˆè‡ªå·±ä¸ºä»€ä¹ˆè¿™ä¹ˆåšã€‚</p><p>æˆ‘è®°å¾—é«˜è€ƒç»“æŸçš„é‚£å¤©ä¸‹åˆï¼Œçˆ¶æ¯ä¸€èµ·æ¥å­¦æ ¡å‡†å¤‡æ¥æˆ‘å›å®¶ï¼Œè¿™æ˜¯ä¸Šé«˜ä¸­ä¸‰å¹´ä»¥æ¥ç¬¬ä¸€æ¬¡çˆ¶æ¯ä¸€èµ·æ¥å­¦æ ¡ã€‚æˆ‘çŸ¥é“çˆ¶æ¯æ˜¯æ‹…å¿ƒæˆ‘ï¼Œä»–ä»¬æ²¡æœ‰é—®æˆ‘è€ƒçš„æ€ä¹ˆæ ·ï¼Œè®©æˆ‘æŠŠè¢«å­æ”¶æ‹¾ä¸€ä¸‹è·Ÿä»–ä»¬å›å®¶ã€‚æˆ‘æ€•ä»–ä»¬æ‹…å¿ƒå°±å‘Šè¯‰ä»–ä»¬ï¼šâ€œåˆ«æ‹…å¿ƒï¼Œæˆ‘æ„Ÿè§‰è‡ªå·±è€ƒçš„è¿˜å¯ä»¥â€ï¼Œæˆ‘æ°¸è¿œå¿˜ä¸äº†çˆ¶æ¯é‚£ä¸€åˆ»å±•éœ²å‡ºçš„æ¬£æ…°çš„ç¬‘å®¹ã€‚</p><p>é«˜è€ƒç»“æŸçš„é‚£ä¸€å¤œæˆ‘æ²¡æœ‰å’Œçˆ¶æ¯ä¸€èµ·å›å®¶ï¼Œè€Œæ˜¯è·ŸåŒå­¦ä»¬åœ¨ç½‘å§å®ˆäº†ä¸€å¤œç­‰ç€é«˜è€ƒè¯•é¢˜çš„ç­”æ¡ˆå‡ºæ¥ï¼Œæƒ³ç»™è‡ªå·±å’Œçˆ¶æ¯ä¸€ä¸ªäº¤ä»£ï¼Œé‚£ä¸ªæ™šä¸Šé™ªå—ç…ç†¬ã€‚</p><p>è¿™æ˜¯æˆ‘äººç”Ÿä¸­ç¬¬ä¸€æ¬¡çœŸæ­£çš„æ¥è§¦ç”µè„‘ï¼Œä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡æ„Ÿè§‰åˆ°è¦ä¸Šå¤§å­¦çš„å–œæ‚¦ã€‚</p><h2 id="åŸºç¡€å¾ˆé‡è¦"><a href="#åŸºç¡€å¾ˆé‡è¦" class="headerlink" title="åŸºç¡€å¾ˆé‡è¦"></a>åŸºç¡€å¾ˆé‡è¦</h2><p>å¤§å®¶åº”è¯¥å¬è¯´è¿‡è¿™æ ·çš„è¯é¢˜ï¼šâ€œå…„å¼Ÿï¼ŒæŠŠæ•°å­¦å­¦é‚£ä¹ˆå¥½å¹²ä»€ä¹ˆï¼Œä½ ä¸Šè¡—ä¹°èœä¼šç”¨å¯¹æ•°(log)è·Ÿå¤§å¦ˆç®—è´¦å—ï¼Œä¹°é¸¡è›‹éœ€è¦å¼€æ ¹å·å—ï¼Ÿâ€ã€‚</p><p>å¬ä¸Šå»å¥½åƒå¾ˆæœ‰é“ç†çš„æ ·å­ï¼Œä½†æ˜¯è¿™é‡Œä¸å®Œå…¨åˆç†ã€‚</p><p>é¦–å…ˆï¼Œè¯´è¯è€…æ˜¯æŠ±ç€ä¸€ç§å«‰å¦’çš„å¿ƒæ€è€Œä¸æ˜¯å­¦ä¹ çš„å¿ƒæ€ï¼Œå¾ˆæ¶ˆæçš„ä¸€ç§è¯´æ³•ã€‚</p><p>å…¶æ¬¡ï¼Œè¯´è¯è€…æŠŠæ•°å­¦çŸ¥è¯†çš„ä½¿ç”¨çš„èŒƒç•´å»ºç«‹åœ¨ä¹°èœä¹°é¸¡è›‹çš„åŸºç¡€ä¸Šäº†ï¼Œå‡å¦‚ä½ è¦æç®—æ³•æ‰å®çš„æ•°å­¦åŸºç¡€å’Œæ€ç»´å¿…é¡»è¦å…·å¤‡ï¼Œå¦åˆ™å¯¸æ­¥éš¾è¡Œï¼Œéšç€æœºå™¨å­¦ä¹ ã€AI å’Œå¤§æ•°æ®åˆ†æçš„å‘å±•ï¼Œæ•°å­¦çŸ¥è¯†æˆä¸ºäº†ä¸€ä¸ªå¿…å¤‡å­¦ç§‘ã€‚</p><p>å†è€…ï¼Œéšç€æ—¶ä»£å’Œç§‘æŠ€çš„å‘å±•ï¼Œè¯´ä¸å®šå–èœçš„å¤§çˆ·å¤§å¦ˆä»¬ç”¨çš„æ•°å­¦çŸ¥è¯†è®©ä½ åº”æ¥ä¸æš‡ã€‚</p><p>æ‰€ä»¥ï¼Œå¥½å¥½å­¦ä¹ å¹¶æ²¡æœ‰é”™ã€‚åŸºæœ¬å­¦ç§‘èƒ½è®©ä½ æ‰å®è‡ªå·±çš„åŸºç¡€ï¼Œæ‹“å±•è‡ªå·±çš„æ€ç»´ã€‚</p><h2 id="å­¦ç‚¹ç¼–ç¨‹"><a href="#å­¦ç‚¹ç¼–ç¨‹" class="headerlink" title="å­¦ç‚¹ç¼–ç¨‹"></a>å­¦ç‚¹ç¼–ç¨‹</h2><p>å‡ å¹´å‰å›½å¤–ã€å›½å†…çš„å¾ˆå¤šäººéƒ½åœ¨è¯´ï¼šâ€œä»¥åç¼–ç¨‹æ˜¯äººäººéƒ½åº”è¯¥å…·å¤‡çš„åŸºæœ¬æŠ€èƒ½ï¼Œå°±åƒä¼šéª‘è½¦å­ä¸€æ ·é‚£ä¹ˆç®€å•ï¼â€ã€‚</p><p>å¯¹äºè¿™ä¸ª â€œä»¥åâ€ è°ä¹Ÿæ²¡æœ‰ç»™å‡ºå…·ä½“æœŸé™ï¼Œå°±å¥½æ¯”æˆ‘å°æ—¶å€™ç¾¡æ…•åˆ«äººå®¶æœ‰å½©è‰²ç”µè§†ä¸€æ ·ï¼Œæ²¡æƒ³åˆ°è¿‡äº†å‡ å¹´è¿™ä¸ªä¸œè¥¿å±…ç„¶ä¹Ÿå‡ºç°åœ¨äº†è‡ªå·±çš„å®¶ä¸­ï¼Œå¦‚è·è‡³å®ï¼Œæ¬£å–œè‹¥ç‹‚ã€‚</p><p>ç°åœ¨å¾ˆå¤šæ•™è‚²æœºæ„å·²ç»æä¾›äº†é’ˆå¯¹å„¿ç«¥ç¼–ç¨‹çš„è¯¾ç¨‹ï¼Œå¤§å¤šæ˜¯å¯è§†åŒ–ç¼–ç¨‹ã€‚æœ‰å­©å­çš„å®¶é•¿ä»¬ä¹Ÿè®¸éƒ½å‘ç°äº†ç°åœ¨çš„å­©å­æ¥å—é¢å’Œæ¥å—èƒ½åŠ›éƒ½è¿œè¶…æˆ‘ä»¬é‚£ä»£äººï¼Œè¿™è·Ÿç¤¾ä¼šç¯å¢ƒã€å®¶åº­ç¯å¢ƒå’Œè¥å…»é¥®é£Ÿéƒ½æœ‰ä¸€å®šçš„å…³ç³»ï¼Œå†åŠ ä¸Šå…´è¶£ç­çš„å‚¬åŒ–è®©ç°åœ¨å¤§å¤šæ•°å­©å­å˜å¾—æœ‰ç‚¹ â€œé¬¼æœºçµâ€ã€‚æ¯”å¦‚ä½ çš„ç”µè„‘è«åå…¶å¦™çš„è¢«æ‰“å¼€å¹¶ä¸”è¿˜èƒ½è‡ªåŠ¨è¢«æ’­æ”¾åŠ¨ç”»ç‰‡ï¼Œè¿˜æœ‰ä½ æ˜æ˜è®¾ç½®çš„ iPad å¯†ç å¾ˆå¤æ‚ç«Ÿç„¶ä¹Ÿèƒ½è®©ä»–ä»¬ç»™ â€œç ´è§£â€ï¼Œæœ€æ°”æ„¤çš„æ˜¯ä»–å±…ç„¶å¯ä»¥è¶ä½ ä¸æ³¨æ„ç”¨ä½ çš„é›¶é’±ç»™å¯¹æ–¹å‘äº†çº¢åŒ…~</p><p>å¦‚æœæœ‰æ¡ä»¶çš„è¯ï¼Œå®¶é•¿ä»¬å¯ä»¥å­©å­æ¥è§¦ç¼–ç¨‹çŸ¥è¯†ï¼ŒåŸ¹å…»ä»–ä»¬æ€è€ƒé—®é¢˜çš„ä¹ æƒ¯ã€‚åŸ¹å…»å­¦ä¹ ç¼–ç¨‹çŸ¥è¯†ï¼Œä¸ä¸€å®šéè¦ä¹°ä¸ªé«˜ç«¯çš„ PC æˆ–è€…æ˜‚è´µçš„ iPadï¼Œå¯ä»¥ä»æ­ç§¯æœ¨å’Œä¸€äº›ç®€å•çš„æ•°å­¦çŸ¥è¯†å¼€å§‹ï¼Œä¹Ÿå¯ä»¥è®©ä»–å‚åŠ ä¸€äº›ä¾‹å¦‚æœºå™¨äººè¯¾çš„å…´è¶£ç­ï¼Œå‚è§‚å‚è§‚ç§‘æŠ€åšç‰©é¦†ä¹‹ç±»çš„ã€‚</p><p>é«˜è€ƒçš„å­¦å­ä»¬ï¼Œæ— è®ºé«˜è€ƒç»“æœå¦‚ä½•ï¼Œä¸è¦åˆ»æ„çš„å»å¼ºè¿«è‡ªå·±ï¼Œå› ä¸ºäººç”Ÿçš„è·¯è¿˜æœ‰å¾ˆé•¿ï¼ŒåŠæ—¶çš„è°ƒæ•´å¿ƒæ€åé¢æ¯”é«˜è€ƒæ›´éš¾çš„ â€è€ƒè¯•è¯•é¢˜â€œ è¿˜ç­‰ç€ä½ ä»¬å‘¢ï¼</p><p>é«˜è€ƒç»“æŸäº†ï¼Œå¦‚æœä½ æ˜¯ç†ç§‘çš„å­¦ç”Ÿå»ºè®®å¤§å®¶å¯ä»¥å»çœ‹çœ‹ç¼–ç¨‹æ–¹é¢çš„çŸ¥è¯†ï¼Œæ‡‚ç‚¹ç¼–ç¨‹çš„çŸ¥è¯†å¯¹ä½ ä»¥åçš„å·¥ä½œè¿˜æ˜¯å¾ˆæœ‰å¥½å¤„çš„ã€‚æŠŠç¼–ç¨‹å½“åšä¸€ç§ä¹è¶£è€Œä¸æ˜¯å·¥ä½œï¼Œè¿™æ ·æ‰æœ‰å¯èƒ½åˆ›é€ æ— é™çš„å¯èƒ½ã€‚</p><p>ç¥å¤§å®¶é‡‘æ¦œé¢˜åï¼Œç«¯åˆå®‰åº·ï¼</p><hr><p><strong>æ—¶é—´å¯ä»¥æ”¹å˜ä¸€åˆ‡ï¼Œä½†ä½ å¾—åšç‚¹ä»€ä¹ˆï¼</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é«˜è€ƒ ç«¯åˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡: æƒ³åŠæ³•è®©é¡¹ç›®è¿è¡Œèµ·æ¥</title>
      <link href="/2019/06/02/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E6%83%B3%E5%8A%9E%E6%B3%95%E8%AE%A9%E9%A1%B9%E7%9B%AE%E8%BF%90%E8%A1%8C%E8%B5%B7%E6%9D%A5/"/>
      <url>/2019/06/02/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E6%83%B3%E5%8A%9E%E6%B3%95%E8%AE%A9%E9%A1%B9%E7%9B%AE%E8%BF%90%E8%A1%8C%E8%B5%B7%E6%9D%A5/</url>
      
        <content type="html"><![CDATA[<h2 id="å¿…å¤‡å·¥å…·"><a href="#å¿…å¤‡å·¥å…·" class="headerlink" title="å¿…å¤‡å·¥å…·"></a>å¿…å¤‡å·¥å…·</h2><p>æœ€æ–°çš„ <code>Spring Boot</code> å‘å¸ƒç‰ˆæœ¬æ˜¯ <code>2.1.4</code>ï¼Œéœ€è¦JDKç‰ˆæœ¬æœ€å°ä¸º8å³ <code>JDK8</code>ï¼Œæ„å»ºå·¥ç¨‹çš„å·¥å…· <code>Maven</code> æœ€å°ç‰ˆæœ¬ä¸º3.3ï¼Œ<code>Gradle</code> æœ€å°ç‰ˆæœ¬ä¸º4.4ï¼Œå½“ç„¶äº† <code>Maven</code> å’Œ <code>Gradle</code> ä»»é€‰ä¸€ä¸ªå³å¯ï¼Œæ¥ä¸‹æ¥åˆ†äº«çš„æ–‡ç« ä¸­åŸºæœ¬éƒ½ä½¿ç”¨ <code>Maven</code> æ¥æ„å»ºå·¥ç¨‹ã€‚</p><p>1ã€Spring Boot 2.1.4</p><p>2ã€JDK8</p><p>3ã€IntelliJ IDEA2019 æ”¶è´¹ç‰ˆ</p><p>æœ‰ç¨³å®šå¯ç”¨çš„ç½‘ç»œï¼Œä¿è¯å·¥ç¨‹æ„å»ºå’Œä¸€äº›ä¾èµ–çš„ä¸‹è½½ã€‚</p><p>å…·ä½“ <code>Spring Boot</code> å¯¹å…¶ä»–å·¥å…·çš„ç‰ˆæœ¬è¦æ±‚ï¼Œå¯ä»¥å‚è€ƒè¿™é‡Œçš„ <a href="https://docs.spring.io/spring-boot/docs/2.1.4.RELEASE/reference/htmlsingle/#getting-started-system-requirements">getting-started-system-requirements</a> æ–‡ç« å†…å®¹ã€‚</p><p>å»ºè®®å¤§å®¶ä½¿ç”¨Chromeä½œä¸ºé»˜è®¤æµè§ˆå™¨ï¼Œæµ‹è¯•ã€è°ƒè¯•APIæ•°æ®å’Œå®‰è£…å¯¹åº”çš„æ’ä»¶å¾ˆæ–¹ä¾¿ã€‚</p><h2 id="è®¤è¯†-Github"><a href="#è®¤è¯†-Github" class="headerlink" title="è®¤è¯† Github"></a>è®¤è¯† Github</h2><p>å¦‚æœä½ è¿˜æ²¡æœ‰ <code>Github</code> è´¦å·ï¼Œå°±å»æ³¨å†Œä¸€ä¸ªï¼Œæ‰“å¼€ <a href="https://github.com/">è¿™ä¸ªåœ°å€</a> å³å¯ã€‚</p><p>æ³¨å†Œå®Œæˆåï¼Œå¯ä»¥æ–°å»ºä¸€ä¸ª <code>Repo</code>(å¯ä»¥å­˜æ”¾ä»£ç çš„ä»“åº“)ï¼Œæœ¬æ–‡æ¶‰åŠçš„æ‰€æœ‰ä»£ç éƒ½æ”¾åœ¨ <a href="https://github.com/veryitman/MSTutorial/tree/master">Github</a> ä¸Šé¢ã€‚</p><p>Spring Boot ç³»åˆ—æ–‡ç« ä¹Ÿä¼šè·Ÿå¤§å®¶ä¸€èµ·å­¦ä¹  <code>Git</code> çš„ä½¿ç”¨ã€‚</p><h2 id="åˆ›å»ºå·¥ç¨‹"><a href="#åˆ›å»ºå·¥ç¨‹" class="headerlink" title="åˆ›å»ºå·¥ç¨‹"></a>åˆ›å»ºå·¥ç¨‹</h2><p>æ–°å»ºå·¥ç¨‹ï¼Œæ‰“å¼€IDEAï¼ŒFile&#x2F;New&#x2F;Projectï¼Œä¸‹ä¸€æ­¥å³å¯</p><p><img src="/upload/images/2019/06/02/1.png"></p><p>å¡«å†™å·¥ç¨‹ä¿¡æ¯ï¼Œç„¶åä¸‹ä¸€æ­¥</p><p><img src="/upload/images/2019/06/02/2.png"></p><p><strong>è¿™é‡Œæ³¨æ„ï¼šArtifact è¦æ±‚æ˜¯å…¨æ˜¯å°å†™å­—æ¯ï¼Œå¦åˆ™æ— æ³•åˆ›å»ºå·¥ç¨‹ã€‚</strong></p><p>é€‰æ‹©ä¾èµ–ï¼Œ<code>Core</code> ä¸­é€‰æ‹© <code>Lombok</code>ï¼Œè¿™ä¸ªä½¿ç”¨èµ·æ¥æ¯”è¾ƒæ–¹ä¾¿ï¼Œå»ºè®®å¤§å®¶é€‰æ‹©ï¼Œä¸é€‰ä¹Ÿå¯ä»¥çš„ã€‚</p><p><img src="/upload/images/2019/06/02/3.png"></p><p>ç´§æ¥ç€åœ¨ <code>Web</code> ä¸­é€‰æ‹© <code>Web</code> å³å¯ï¼Œä¸‹ä¸€æ­¥ </p><p><img src="/upload/images/2019/06/02/4.png"></p><p>ä¿å­˜å·¥ç¨‹ï¼Œå¯åŠ¨ååœ¨å³å°è§’æç¤ºä¸‹é¢å†…å®¹ï¼Œç›´æ¥ <code>Enable Auto-Import</code> å’Œ <code>Enable plgins</code> å³å¯ï¼Œå¦‚æœä½ ä¹‹å‰å®‰è£…è¿‡ <code>Lombok</code> æ’ä»¶ï¼Œè¿™é‡Œä¹Ÿä¸ä¼šæç¤º  <code>Enable plgins</code> äº†ã€‚</p><p> <img src="/upload/images/2019/06/02/5.png"></p><p>ç„¶åå®‰è£…  <code>Lombok</code> æ’ä»¶ï¼Œç‚¹å‡» <code>ok</code> å³å¯ã€‚</p><p><img src="/upload/images/2019/06/02/6.png"></p><p>ç­‰å¾…IDEAæ„å»ºå®Œæˆï¼Œå·¥ç¨‹æ˜¾ç¤ºå¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/06/02/7.png"></p><p>å¦‚æœä½ çš„å·¥ç¨‹åŠ è½½å…¶ä»–åº“åŠ è½½å¤±è´¥ï¼Œå¯ä»¥é‡æ–°å¯¼å…¥ï¼Œæ“ä½œå¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/06/02/8.png"></p><h2 id="Runèµ·æ¥"><a href="#Runèµ·æ¥" class="headerlink" title="Runèµ·æ¥"></a>Runèµ·æ¥</h2><p>ç›´æ¥è¿è¡Œå·²ç»æ„å»ºæˆåŠŸçš„å·¥ç¨‹ã€‚</p><p><img src="/upload/images/2019/06/02/9.png"></p><p>æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥ <a href="http://localhost:8080/">http://localhost:8080/</a> èƒ½çœ‹åˆ°ä¸‹é¢çš„å†…å®¹ï¼š</p><p><img src="/upload/images/2019/06/02/10.png"></p><p>è¯´æ˜å·¥ç¨‹å·²ç»æˆåŠŸè¿è¡Œèµ·æ¥äº†ï¼Œä½ è·ç¦»ä¼Ÿå¤§çš„ç›®æ ‡è¶Šæ¥è¶Šè¿‘äº†ã€‚</p><p>ä¸ºäº†è®©æµè§ˆå™¨æ˜¾ç¤ºä¸€ä¸ªæ­£å¸¸çš„è¯­å¥ï¼Œæˆ‘ä»¬éœ€è¦å¢åŠ ç‚¹ä¸œè¥¿ã€‚</p><p>æ–°å»ºä¸€ä¸ª <code>MSUserController</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.veryitman.springboot.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MSUserController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/user&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">user</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Greate user&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥ <a href="http://localhost:8080/user">http://localhost:8080/user</a> èƒ½çœ‹åˆ°ä¸‹é¢çš„å†…å®¹ï¼š</p><p><img src="/upload/images/2019/06/02/11.png"></p><h2 id="è¯´ç‚¹ç¥å¥‡çš„"><a href="#è¯´ç‚¹ç¥å¥‡çš„" class="headerlink" title="è¯´ç‚¹ç¥å¥‡çš„"></a>è¯´ç‚¹ç¥å¥‡çš„</h2><p><strong>1ã€åˆ›å»ºå·¥ç¨‹è¿˜æœ‰å…¶ä»–æ–¹å¼å—ï¼Ÿ</strong></p><p>é™¤äº†ä½¿ç”¨IDEAæä¾›çš„æ–¹æ³•æ¥åˆ›å»º <code>Spring Boot</code> å·¥ç¨‹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å®˜æ–¹æä¾›çš„ <a href="https://start.spring.io/">Spring Initializr</a> æ¥åˆ›å»ºå·¥ç¨‹ã€‚</p><p>æœ¬è´¨ä¸Šï¼ŒIDEAæ˜¯é›†æˆäº† <a href="https://start.spring.io/">Spring Initializr</a> è¿™ä¸ªå·¥å…·ï¼Œæ‰€ä»¥äºŒè€…åŒå®—åŒæºã€‚</p><p><strong>2ã€ä¸ºä»€ä¹ˆç‚¹ä¸ªæŒ‰é’®å°±Runèµ·æ¥äº†ï¼Ÿ</strong></p><p> <code>Spring Boot</code>  å·²ç»å†…ç½®äº† <code>Tomcat</code> æœåŠ¡å™¨ä½œä¸º Web Serverï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è·‘èµ·æ¥ã€‚</p><p><img src="/upload/images/2019/06/02/12.png"></p><p> <code>Spring Boot</code> å°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œçº¦å®šå¤§äºé…ç½®çš„æ€æƒ³è´¯å½»å…¶å§‹ç»ˆã€‚</p><hr><p><strong>æ”¹å˜ï¼Œä»ä½ æˆ‘ç›¸è¯†å¼€å§‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot SpringCloud å¾®æœåŠ¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡: æ­¥æ­¥ä¸ºè¥</title>
      <link href="/2019/05/28/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E6%AD%A5%E6%AD%A5%E4%B8%BA%E8%90%A5/"/>
      <url>/2019/05/28/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E6%AD%A5%E6%AD%A5%E4%B8%BA%E8%90%A5/</url>
      
        <content type="html"><![CDATA[<p><img src="/upload/images/2019/05/28/1.png"></p><p>ä¸Šå›¾æ˜¯æˆ‘ä» <a href="https://spring.io/">spring.io</a> é¦–é¡µä»‹ç»æˆªå›¾è¿‡æ¥çš„ï¼Œç®€æ´è€Œä¸å¤±éœ¸æ°”ï¼</p><p>æœ€è¿‘ä¸¤å¹´ï¼Œ<code>Spring Boot</code> ä¼´éšç€å¾®æœåŠ¡çš„å‘å±•è€Œè¶Šå‘ç«çƒ­ï¼Œå¾ˆå¤šå…¬å¸ä¹Ÿçº·çº·å¼€å§‹ä½¿ç”¨ <code>Spring Boot</code> å’Œ <code>Spring Cloud</code> æ¥å¼€å‘è‡ªå·±çš„æœåŠ¡ï¼ŒJavaå¼€å‘çš„æµªæ½®æ„ˆå‘æ±¹æ¶Œã€‚è¿™å¹´å¤´ä¸çŸ¥é“å¾®æœåŠ¡ä¸çŸ¥é“ <code>Spring Boot</code> å°±æ„Ÿè§‰ç”Ÿæ´»ç¼ºç‚¹ä»€ä¹ˆä¼¼çš„ã€‚æˆ‘ä»¬è¿˜æ˜¯æŠ±ç€å­¦ä¹ çš„å¿ƒæ€æ¥å­¦ä¹ ä¸€ä¸‹è¿™ä¸ªæ—¶ä»£å® å„¿å§ï¼Œä¸è¦ç›²ç›®å¹æ§å°±å¯ä»¥äº†ã€‚</p><p>ç”± <a href="https://pivotal.io/cn/open-source">Pivotal</a> æä¾›çš„ <code>Spring Boot</code> æ˜¯ä¸€å¥—åŸºäºJavaè¯­è¨€çš„å¼€å‘æ¡†æ¶ï¼Œä¹‹å‰çš„ <code>Spring</code> æ¡†æ¶é…ç½®æ¯”è¾ƒå¤æ‚ï¼Œè®¾è®¡ <code>Spring Boot</code> ç›®çš„æ˜¯ç”¨æ¥ç®€åŒ– <code>Spring</code> çš„å¼€å‘è¿‡ç¨‹ï¼Œä¸€å®šç¨‹åº¦çš„å»å°½åŠ›è§£æ”¾ç¨‹åºå‘˜ï¼Œæ¢å¥è¯è¯´  <code>Spring Boot</code> æ˜¯å»ºç«‹åœ¨ <code>Spring</code> åŸºç¡€ä¹‹ä¸Šçš„ã€‚<code>Spring Boot</code> æ›´åƒæ˜¯ä¸€ä¸ªæ¡†æ¶ä»“åº“ï¼Œå®ƒæ‹¥æœ‰ä½ åŸºæœ¬æƒ³è¦çš„ä¸œè¥¿ï¼Œç®€å•åˆ°åªéœ€è¦ä½ æ·»åŠ é…ç½®å°±å¯ä»¥ï¼Œå¹¶ä¸” <code>Spring Boot</code> å¯ä»¥å¸®ä½ å¤„ç†å„ä¸ªåº“ä¹‹é—´çš„ä¾èµ–å…¼å®¹é—®é¢˜ï¼Œä¸ç”¨æˆ‘ä»¬å»å…³å¿ƒè¿™äº›é—®é¢˜ã€‚â€œ<strong>çº¦å®šä¼˜äºé…ç½®</strong>â€ çš„æ€æƒ³è´¯ç©¿ <code>Spring Boot</code> çš„å§‹ç»ˆï¼Œçº¦å®šä¼˜äºé…ç½®ï¼ˆConvention Over Configurationï¼‰ï¼Œä¹Ÿè¢«ç§°ä¹‹ä¸ºæŒ‰çº¦å®šç¼–ç¨‹ï¼Œå®ƒæ˜¯ä¸€ç§è½¯ä»¶è®¾è®¡èŒƒå¼ã€æ€æƒ³ï¼Œçº¦å®šä¼˜äºé…ç½®æ—¨åœ¨å‡å°‘å¼€å‘äººå‘˜éœ€åšå†³å®šçš„æ•°é‡ã€è·å¾—ç®€å•çš„å¥½å¤„ï¼Œè€Œåˆä¸å¤±çµæ´»æ€§ï¼Œå¯¹äºæˆ‘ä»¬æ¥è¯´æ˜¯ä¸€ç§ç¼–ç¨‹çš„æ–°ä½“éªŒã€‚</p><p>ä¸ºäº†è‡ªå·±å­¦ä¹ ï¼Œä¹Ÿä¸ºäº†æ–¹ä¾¿æƒ³å­¦ä¹   <code>Spring Boot</code> çš„å°ä¼™ä¼´ï¼Œå‡†å¤‡æä¸€å¥— <code>Spring Boot</code> ç³»åˆ—æ–‡ç« æ¥æ»‹æ¶¦ä¸€ä¸‹æ— èŠçš„ç”Ÿæ´»ã€‚</p><p><code>Spring Boot</code> ç³»åˆ—æ–‡ç« æˆ‘å‡†å¤‡é‡‡ç”¨ä»¥ç»ˆä¸ºå§‹çš„æ–¹å¼æ¥åˆ†äº«ï¼Œæ‰€è°“çš„ä»¥ç»ˆä¸ºå§‹å°±æ˜¯æˆ‘ä»¬å…ˆç»™è‡ªå·±é¡¶ä¸ªç›®æ ‡ï¼Œç„¶åå†æƒ³æ–¹æ¡ˆæ¥å®Œæˆç›®æ ‡ï¼Œç»†åŒ–æ¯ä¸ªå®æ–½æ­¥éª¤ã€‚ </p><p>è‡³äºä»€ä¹ˆæ˜¯ <a href="https://www.martinfowler.com/articles/microservices.html">å¾®æœåŠ¡</a>ï¼Œä»€ä¹ˆæ˜¯  <code>Spring Boot</code> å¤§å®¶å¯ä»¥å»ç½‘ä¸Šæœç´¢äº†è§£ï¼Œåç»­åˆ†äº«çš„æ–‡ç« ä¸­æˆ‘ä¹Ÿä¼šæ¸—é€å¼çš„åˆ†äº«ä¸€ä¸‹ç›¸å…³çš„çŸ¥è¯†ã€‚è¿™é‡Œå¼ºè°ƒä¸€ç‚¹ï¼Œå¾®æœåŠ¡ä¸ç­‰äº  <code>Spring Boot</code> æˆ–è€…  <code>Spring Cloud</code>ï¼Œä»–ä»¬åªæ˜¯å®ç°å¾®æœåŠ¡çš„ä¸€ç§æ‰‹æ®µè€Œå·²ã€‚</p><p><strong>å­¦ä¹ è¦æ±‚</strong></p><p>1ã€ä½ å¾—ä¼šJavaåŸºç¡€çŸ¥è¯†ï¼Œè‡³å°‘ä¼šç”¨JDKçš„åŸºæœ¬ç±»ã€‚å¦‚æœä¸ä¼šï¼Œèµ¶ç´§å»è¡¥è¡¥ï¼Œå­¦ä¹ æ²¡é‚£ä¹ˆéš¾ï¼Œåªè¦ä½ åˆ«å¤ªæ‡’ï¼</p><p>2ã€ä½ è¦ä½¿ç”¨è¿‡IDEAè¿™ä¸ªæ— ä¸ä¼¦æ¯”çš„é›†æˆå¼€å‘å·¥å…·ï¼Œæ”¾å¼ƒ Eclipse å§ï¼ä¸æ˜¯å®ƒä¸å¥½ï¼Œåªæ˜¯IDEAå¤ªä¼˜ç§€ã€‚</p><p>3ã€è‹±è¯­è¦å‡‘åˆï¼Œæœ‰æ²¡æœ‰å››çº§è¯ä¹¦çœŸçš„æ— æ‰€è°“ï¼Œå®˜æ–¹æ–‡æ¡£å¤§å¤šéƒ½æ˜¯è‹±æ–‡çš„å´éƒ½æ˜¯ç²¾åã€‚</p><p>4ã€åšå¼ºçš„æ¯…åŠ›ï¼Œä¹è§‚çš„å¿ƒæ€ï¼Œå¾ˆå¤šå›°éš¾éƒ½æ˜¯çº¸è€è™ï¼Œå½“ä½ æå®šå®ƒäº†ä¹‹åä½ å°±çŸ¥é“è‡ªå·±æœ‰å¤šå‰å®³äº†ã€‚</p><p>5ã€å¤šè¿åŠ¨å¤šæ€è€ƒï¼Œèº«ä½“æ˜¯é©å‘½çš„æœ¬é’±ï¼Œå…¶ä»–çš„éƒ½æ˜¯æ‰¯æ·¡ï¼</p><p><strong>ä»¥ç»ˆä¸ºå§‹</strong></p><p>å¤§ç›®æ ‡ï¼šåŸºäº <code>Spring Cloud</code> æ„å»ºå¾®æœåŠ¡å¼€å‘ä¸€ä¸ªAPPã€‚</p><p>å®æ–½è®¡åˆ’ï¼š</p><p><strong>1</strong>ã€äº†è§£å’Œå­¦ä¹  <code>Spring Boot</code></p><p>ç›®æ ‡ï¼šä½¿ç”¨ <code>Spring Boot</code> æ„å»ºä¸€ä¸ªç®€å•çš„æœåŠ¡ï¼Œå®¢æˆ·ç«¯æˆ–è€…WEBç«¯å¯è®¿é—®è¯¥æœåŠ¡ã€‚</p><p>å¦‚æœä½ ä¸ä¼šç§»åŠ¨å¼€å‘ï¼Œå¯ä»¥ä½¿ç”¨C&#x2F;C++ã€C#æˆ–è€…JSæ¥å¼€å‘ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œå“ªæ€•ç»ˆç«¯ç¨‹åºä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p><p>åˆšå¼€å§‹å­¦ä¹ çš„æ—¶å€™ï¼Œå¦‚æœé‡åˆ°ä¸ç†è§£çš„çŸ¥è¯†ç‚¹å…ˆè®°ä¸‹æ¥ï¼Œä¸è¦å› ä¸ºè¿™äº›ä¸œè¥¿é˜»æŒ¡ä½ çš„å­¦ä¹ ï¼Œç­‰å­¦åˆ°ä¸€å®šçš„æ—¶å€™å†å›è¿‡å¤´æ¥ç ”ç©¶ï¼Œè¿™å°±å¥½æ¯”ä½ åˆšä¸Šçƒåœºå­¦ä¹ æ‰“ç¯®çƒä¸€æ ·ï¼Œèƒ½å…ˆç¨³ç¨³çš„æ‹¿ä½çƒå†ä¼ ç»™é˜Ÿå‹å°±å¾ˆäº†ä¸èµ·äº†ï¼Œå¾—ä¸å¾—åˆ†é‚£æ˜¯åé¢çš„äº‹æƒ…ã€‚</p><p>åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬åšå¥½ç™»å½•å’Œæ³¨å†Œå³å¯ã€‚</p><p><strong>2</strong>ã€æ·±å…¥å­¦ä¹  <code>Spring Boot</code></p><p>ç»§ç»­å­¦ä¹  <code>Spring Boot</code> çš„çŸ¥è¯†ï¼Œç”¨æˆ·å®Œæˆäº†æ³¨å†Œï¼Œç„¶åç™»å½•è¿›å…¥æˆ‘ä»¬çš„APPéœ€è¦ç»™ä»–ä»¬å±•ç¤ºæ›´åŠ ä¸°å¯Œçš„åœºæ™¯ã€‚è¿™ä¸ªæ—¶å€™éœ€è¦é…åˆåå°æœåŠ¡è¿›è¡Œå¼€å‘å·¥ä½œï¼Œå€ŸåŠ©è¿™æ¬¡æœºä¼šå¯ä»¥æ›´åŠ æ·±å…¥çš„å­¦ä¹ å’Œè®¤è¯† <code>Spring Boot</code>äº†ã€‚</p><p><strong>3</strong>ã€ äº†è§£å’Œå­¦ä¹   <code>Spring Cloud</code> </p><p>åœ¨è¿™ä¸ªé˜¶æ®µï¼Œéœ€è¦ä½¿ç”¨  <code>Spring Cloud</code> æ”¹é€ æˆ‘ä»¬å·²ç»å¼€å‘çš„å•ä½“åº”ç”¨æœåŠ¡äº†ã€‚</p><p>å¾®æœåŠ¡çš„å…³é”®ä¸æ˜¯å¦‚ä½•å°†ä½ çš„æœåŠ¡æ‹†çš„å¦‚ä½• â€œå¾®â€ï¼Œè€Œæ˜¯å¦‚ä½•åšå¥½æœåŠ¡æ²»ç†ã€‚äºæ˜¯åœ¨ <code>Spring Boot</code> åŸºç¡€ä¹‹ä¸Šä¾¿æœ‰äº† <code>Spring Cloud</code>ï¼Œå®ƒæ˜¯å®Œå…¨åŸºäº <code>Spring Boot</code> å¼€å‘çš„ï¼Œå¯¹å¤–æä¾›äº†åœ¨å¾®æœåŠ¡æ¶æ„ä¸­å¦‚ä½•åšå¥½æœåŠ¡æ²»ç†çš„ä¸€å¥—è§£å†³æ–¹æ¡ˆã€‚</p><p>å­¦ä¹ å®Œ  <code>Spring Boot</code> ä¹‹åéœ€è¦äº†è§£ä¸€äº›å…³äº  <code>Spring Cloud</code>  çš„çŸ¥è¯†ï¼Œè¿›å…¥ <code>Spring Cloud</code>  çš„ä¸–ç•Œä¸€çª¥ç©¶ç«Ÿï¼Œè¿™éƒ¨åˆ†æˆ‘ä»¬ä¸€èµ·å­¦ä¹ å¦‚ä½•åšæœåŠ¡æ²»ç†ï¼ŒæœåŠ¡éƒ¨ç½²ç­‰çŸ¥è¯†ã€‚</p><p><strong>4</strong>ã€åšä¸€æ¬¡æ¶æ„å¸ˆ </p><p>ç»¼åˆ  <code>Spring Boot </code> å’Œ  <code>Spring Cloud</code> ç›¸å…³çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬é‡æ–°æ¢³ç†ä¸€ä¸‹ä¹‹å‰åšçš„ä¸œè¥¿ã€‚æŠŠæ•´ä¸ªç³»ç»Ÿä¸²èµ·æ¥ï¼Œç”»å‡ºæµç¨‹å›¾å’Œæ¶æ„å›¾ã€‚</p><p>è®¾è®¡åŒ…æ‹¬æœåŠ¡æœ¬èº«çš„è®¾è®¡ã€æ•°æ®åº“å’Œç¼“å­˜ç­‰è®¾è®¡ã€‚</p><p><strong>5</strong>ã€å®Œå–„å’Œä¼˜åŒ–æœåŠ¡</p><p>å€Ÿé‰´ä¸šç•Œå¥½çš„æ¡ˆä¾‹å¯¹æˆ‘ä»¬çš„æœåŠ¡è¿›è¡Œä¼˜åŒ–ï¼ŒåŒ…æ‹¬æ•°æ®åº“ã€ç¼“å­˜ã€APIå’Œå…¶ä»–è®¾è®¡åšä¸€æ¬¡é‡æ„ï¼Œå¹¶å¯¹æˆ‘ä»¬è¿™ä¸ªå¾®é¡¹ç›®è¿›è¡Œä¸€æ¬¡å¤ç›˜ã€‚</p><p>æœ€é‡è¦çš„æ˜¯è¦å¥–åŠ±ä¸€ä¸‹è‡ªå·±ã€‚</p><hr><p><code>Spring Boot</code> ç³»åˆ—æ–‡ç« æˆ‘ä¼šåŠªåŠ›åšæŒå†™ä¸‹å»ï¼Œå¸Œæœ›èƒ½å¸®åˆ°å¤§å®¶ã€‚</p><p>å¹²å°±å®Œäº†ï¼</p><p><strong>æ”¹å˜ï¼Œä»ä½ æˆ‘ç›¸è¯†å¼€å§‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot SpringCloud å¾®æœåŠ¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡é¡¹ç›®ç³»åˆ—æ–‡ç« </title>
      <link href="/2019/05/28/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%A1%B9%E7%9B%AE%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/"/>
      <url>/2019/05/28/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%A1%B9%E7%9B%AE%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/</url>
      
        <content type="html"><![CDATA[<p>ç‹‚é£æš´é›¨çš„é‚£ä¸ªå‘¨æœ«ï¼Œçªå‘å¥‡æƒ³ï¼Œæƒ³æŠŠå¾®æœåŠ¡ç›¸å…³çš„å†…å®¹åˆ†äº«ç»™å¤§å®¶ï¼Œæ€å‰æƒ³åè¿˜æ˜¯å†³å®šç”¨é¡¹ç›®çš„å½¢å¼æ¥æ¨è¿›å¦åˆ™å¾ˆéš¾è¿›è¡Œä¸‹å»ï¼Œäºæ˜¯å°±æœ‰äº†é¡¹ç›®çš„è¿™äº›æ–‡ç« ï¼ˆæŒç»­æ›´æ–°ä¸­â€¦ï¼‰ã€‚</p><p>ä»–ä»¬éƒ½æ˜¯æœ‰ç”Ÿå‘½çš„ï¼Œå¯¹æˆ‘æ¥è¯´ã€‚</p><hr><h2 id="é¡¹ç›®å¼€ç¯‡"><a href="#é¡¹ç›®å¼€ç¯‡" class="headerlink" title="é¡¹ç›®å¼€ç¯‡"></a>é¡¹ç›®å¼€ç¯‡</h2><ul><li><p><a href="http://www.veryitman.com/2019/05/28/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E6%AD%A5%E6%AD%A5%E4%B8%BA%E8%90%A5/">å¾®æœåŠ¡: æ­¥æ­¥ä¸ºè¥</a></p><blockquote><p>å­¦ä¹ å¾®æœåŠ¡çš„è®¡åˆ’ã€‚</p></blockquote></li></ul><h2 id="Spring-Boot"><a href="#Spring-Boot" class="headerlink" title="Spring Boot"></a>Spring Boot</h2><p><a href="http://www.veryitman.com/2019/06/02/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E6%83%B3%E5%8A%9E%E6%B3%95%E8%AE%A9%E9%A1%B9%E7%9B%AE%E8%BF%90%E8%A1%8C%E8%B5%B7%E6%9D%A5/">å¾®æœåŠ¡: æƒ³åŠæ³•è®©é¡¹ç›®è¿è¡Œèµ·æ¥</a></p><blockquote><p>ä½¿ç”¨IDEAæ­å»ºç¬¬ä¸€ä¸ªSpringBooté¡¹ç›®ã€‚</p></blockquote><p><a href="http://www.veryitman.com/2019/06/09/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Git%E5%85%A5%E9%97%A8/">å¾®æœåŠ¡: Gitå…¥é—¨</a></p><blockquote><p>å†™è¿‡çš„ä»£ç å°±æ˜¯è‡ªå·±çš„è´¢å¯Œï¼Œéœ€è¦æŠŠä»–ç®¡ç†èµ·æ¥ï¼Œä»£ç ç®¡ç†æˆ‘ç”¨Gitç®¡ç†å·¥å…·ã€‚</p></blockquote><p><a href="http://www.veryitman.com/2019/06/30/%E5%BE%AE%E6%9C%8D%E5%8A%A1%EF%BC%9A%E6%9C%AC%E5%9C%B0%E7%83%AD%E9%83%A8%E7%BD%B2/">å¾®æœåŠ¡: æœ¬åœ°çƒ­éƒ¨ç½²</a></p><blockquote><p>å¦‚ä½•çƒ­éƒ¨ç½²é¡¹ç›®ï¼Œä¸éœ€è¦æ¯æ¬¡éƒ½æ‰‹åŠ¨é‡å¯ã€‚</p></blockquote><p><a href="http://www.veryitman.com/2019/07/03/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E7%AB%8B%E5%BF%97%E5%81%9A%E4%B8%AA%E4%BC%9F%E5%A4%A7%E7%9A%84%E9%A1%B9%E7%9B%AE/">å¾®æœåŠ¡: ç«‹å¿—åšä¸ªä¼Ÿå¤§çš„é¡¹ç›®</a></p><blockquote><p>ç¡®å®šå­¦ä¹ å¾®æœåŠ¡çš„é¡¹ç›®ã€‚</p></blockquote><p><a href="http://www.veryitman.com/2019/08/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E5%AD%A6%E4%B9%A0%E5%87%A0%E4%B8%AA%E5%AE%B9%E6%98%93%E6%B7%B7%E6%B7%86%E7%9A%84URL%E6%B3%A8%E8%A7%A3/">å¾®æœåŠ¡: å­¦ä¹ å‡ ä¸ªå®¹æ˜“æ··æ·†çš„URLæ³¨è§£</a></p><blockquote><p>å­¦ä¹ è·ŸURLç›¸å…³çš„å‡ ä¸ªæ³¨è§£ï¼Œå¦‚ @RequestParamã€@QueryParamã€@PathVariableã€@PathParamã€‚</p></blockquote><p><a href="http://www.veryitman.com/2019/09/15/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E7%AE%80%E5%8D%95%E7%9A%84%E7%94%A8%E6%88%B7%E5%90%8D%E6%B3%A8%E5%86%8C%E5%92%8C%E7%99%BB%E5%BD%95/">å¾®æœåŠ¡: ç®€å•çš„ç”¨æˆ·åæ³¨å†Œå’Œç™»å½•</a></p><blockquote><p>å†™æ³¨å†Œå’Œç™»å½•çš„æ¥å£ï¼Œå¹¶å®Œæˆæ¥å£çš„å•å…ƒæµ‹è¯•ã€‚</p></blockquote><p><a href="http://www.veryitman.com/2019/09/22/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Swagger%E8%AE%A9%E4%BD%A0%E5%8F%AF%E4%BB%A5%E5%A4%9A%E6%8A%BD%E4%B8%80%E6%94%AF%E7%83%9F/">å¾®æœåŠ¡-Swaggerè®©ä½ å¯ä»¥å¤šæŠ½ä¸€æ”¯çƒŸ</a></p><blockquote><p>æ¥å£ç¼–ç å®Œæˆä¹‹åï¼Œç»“åˆ Swagger å¯ä»¥åŒæ—¶å®Œæˆæ–‡æ¡£çš„ç¼–å†™ã€‚</p></blockquote><p><a href="http://www.veryitman.com/2019/10/13/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Swagger%E7%94%9F%E6%88%90Markdown%E6%96%87%E6%A1%A3/">å¾®æœåŠ¡-Swaggerç”ŸæˆMarkdownæ–‡æ¡£</a></p><blockquote><p>å¦‚ä½•ç”Ÿæˆç¦»çº¿æ–‡æ¡£ã€‚</p></blockquote><p><a href="http://www.veryitman.com/2019/10/31/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E9%83%A8%E7%BD%B2%E6%9C%8D%E5%8A%A1/">å¾®æœåŠ¡: éƒ¨ç½²æœåŠ¡</a></p><blockquote><p>å¦‚ä½•éƒ¨ç½²å·²ç»å†™å¥½çš„æœåŠ¡ã€‚</p></blockquote><p><a href="http://www.veryitman.com/2019/11/10/MySQL8-0-15%E5%9C%A8Win10%E4%B8%8A%E7%9A%84%E6%8A%98%E8%85%BE%E8%AE%B0/">MySQL8-0-15åœ¨Win10ä¸Šçš„æŠ˜è…¾è®°</a></p><blockquote><p>å®‰è£…MySQLã€‚</p></blockquote><p><a href="http://www.veryitman.com/2019/12/07/%E5%BE%AE%E6%9C%8D%E5%8A%A1-MySQL%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/">å¾®æœåŠ¡: MySQLåŸºæœ¬æ“ä½œ</a></p><blockquote><p>ä½¿ç”¨MySQLæ•°æ®åº“ã€‚</p></blockquote><p><a href="http://www.veryitman.com/2020/04/11/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E7%BB%93%E5%90%88MySQL%E5%AE%9E%E7%8E%B0%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C/">å¾®æœåŠ¡: ç»“åˆMySQLå®ç°ç™»å½•æ³¨å†Œ</a></p><blockquote><p>å‰ç«¯ç™»å½•æ³¨å†Œç•Œé¢è®¿é—® APIï¼Œè¯»å†™æ•°æ®åº“å®ç°æ•°æ®çš„å­˜å‚¨å’Œè¯»å–å®æˆ˜ã€‚</p></blockquote><p><a href="http://www.veryitman.com/2020/05/01/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Actuator%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%B5%8B/">å¾®æœåŠ¡: Actuatorå®ç°æœåŠ¡ç›‘æµ‹</a></p><blockquote><p>å¦‚ä½•å®‰å…¨çš„ä½¿ç”¨ Actuatorã€‚</p></blockquote><p><a href="http://www.veryitman.com/2020/05/03/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Admin%E4%B8%8E%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%B5%8B%E5%92%8C%E7%AE%A1%E7%90%86/">å¾®æœåŠ¡: Adminä¸æœåŠ¡ç›‘æµ‹å’Œç®¡ç†</a></p><blockquote><p>å¦‚ä½•ä½¿ç”¨ spring-adminï¼ˆclient&amp;serverï¼‰å®ç°æœåŠ¡ç®¡ç†å’Œç›‘æµ‹ã€‚</p></blockquote><p><a href="http://www.veryitman.com/2020/05/23/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E9%85%8D%E7%BD%AENginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/">å¾®æœåŠ¡-é…ç½®Nginxåå‘ä»£ç†</a></p><blockquote><p>Nginx ä½œä¸ºåå‘ä»£ç†çš„å®è·µçŸ¥è¯†ã€‚</p></blockquote><p><a href="http://www.veryitman.com/2020/07/16/ngrok%E8%AE%A9%E6%9C%8D%E5%8A%A1%E8%BF%91%E5%9C%A8%E5%92%AB%E5%B0%BA/">ngrokè®©æœåŠ¡è¿‘åœ¨å’«å°º</a></p><blockquote><p>ngrok å®ç°å†…ç½‘ç©¿é€ã€‚</p></blockquote><p><a href="http://www.veryitman.com/2020/08/02/%E5%BE%AE%E6%9C%8D%E5%8A%A1-ConfigurationProperties%E9%85%8D%E7%BD%AE/">å¾®æœåŠ¡-ConfigurationPropertiesé…ç½®</a></p><blockquote><p>properties åˆ° Bean çš„è½¬æ¢ã€‚</p></blockquote><p><a href="http://www.veryitman.com/2020/08/29/%E5%BE%AE%E6%9C%8D%E5%8A%A1-%E5%A4%9A-Module-%E7%AE%A1%E7%90%86%E5%B7%A5%E7%A8%8B/">å¾®æœåŠ¡-å¤š-Module-ç®¡ç†å·¥ç¨‹</a></p><blockquote><p>ç®¡ç†å·¥ç¨‹ï¼Œè§„èŒƒå·¥ç¨‹ã€‚</p></blockquote><p><a href="http://www.veryitman.com/2020/11/15/Win10-%E5%AE%89%E8%A3%85-Redis/">Win10-å®‰è£…-Redis</a></p><p><a href="http://www.veryitman.com/2020/12/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-SpringBoot-%E9%9B%86%E6%88%90-Redis/">å¾®æœåŠ¡-SpringBoot-é›†æˆ-Redis</a></p><blockquote><p>Redis çš„ç®€å•ä½¿ç”¨ã€‚</p></blockquote><h2 id="Spring-Boot-ç•ªå¤–ç¯‡"><a href="#Spring-Boot-ç•ªå¤–ç¯‡" class="headerlink" title="Spring Boot ç•ªå¤–ç¯‡"></a>Spring Boot ç•ªå¤–ç¯‡</h2><ul><li><p><a href="http://www.veryitman.com/2019/08/31/%E8%B7%A8%E5%9F%9F%E5%92%8COPTIONS%E8%BF%99%E5%AF%B9%E6%AC%A2%E5%96%9C%E5%86%A4%E5%AE%B6/">è·¨åŸŸå’ŒOPTIONSè¿™å¯¹æ¬¢å–œå†¤å®¶</a></p><blockquote><p>è§£å†³è·¨åŸŸé—®é¢˜ã€‚</p></blockquote></li><li><p><a href="http://www.veryitman.com/2019/09/08/%E5%87%8F%E5%B0%91%E8%B7%A8%E5%9F%9F%E4%B8%AD%E7%9A%84OPTIONS%E8%AF%B7%E6%B1%82/">å‡å°‘è·¨åŸŸä¸­çš„OPTIONSè¯·</a></p><blockquote><p>å¦‚ä½•å‡å°‘è·¨åŸŸè¯·æ±‚ï¼Œä½¿ç”¨ SpringBoot å®Œæˆå®ä¾‹ã€‚</p></blockquote></li><li><p><a href="http://www.veryitman.com/2019/11/24/%E7%9F%AD%E5%9C%B0%E5%9D%80%E5%8E%9F%E7%90%86/">çŸ­åœ°å€åŸç†</a></p><blockquote><p>å®ä¾‹ï¼ˆSpringBootï¼‰è®²è§£çŸ­åœ°å€å®ç°åŸç†ã€‚</p></blockquote></li></ul><h2 id="Spring-Cloud"><a href="#Spring-Cloud" class="headerlink" title="Spring Cloud"></a>Spring Cloud</h2><p>å¾…æ›´æ–°ğŸ˜œ</p><h2 id="å®¢æˆ·ç«¯"><a href="#å®¢æˆ·ç«¯" class="headerlink" title="å®¢æˆ·ç«¯"></a>å®¢æˆ·ç«¯</h2><h3 id="Android-ç›¸å…³"><a href="#Android-ç›¸å…³" class="headerlink" title="Android ç›¸å…³"></a>Android ç›¸å…³</h3><ul><li><p><a href="http://www.veryitman.com/2020/06/20/%E5%BE%AE%E6%9C%8D%E5%8A%A1-Android%E5%AE%A2%E6%88%B7%E7%AB%AF-%E5%AE%9E%E7%8E%B0%E6%B3%A8%E5%86%8C%E5%92%8C%E7%99%BB%E5%BD%95/">å¾®æœåŠ¡-Androidå®¢æˆ·ç«¯-å®ç°æ³¨å†Œå’Œç™»å½•</a> </p><blockquote><p>ä½¿ç”¨Androidå®ç°MSBlogé¡¹ç›®ï¼Œæœ¬ç¯‡å®ç°äº†å·¥ç¨‹æ¡†æ¶çš„æ­å»ºã€æ³¨å†Œå’Œç™»å½•åŠŸèƒ½ã€‚</p></blockquote></li></ul><h3 id="iOS-ç›¸å…³"><a href="#iOS-ç›¸å…³" class="headerlink" title="iOS ç›¸å…³"></a>iOS ç›¸å…³</h3><p>å¾…æ›´æ–°ğŸ˜œ</p><p><strong>ä¸ç»å†é£é›¨æ€ä¹ˆè§å½©è™¹ï¼Œæ²¡æœ‰äººèƒ½å¤Ÿéšéšä¾¿ä¾¿æˆåŠŸ~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot SpringCloud å¾®æœåŠ¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¨‹åºå‘˜è¿™ä¸ªèŒä¸š</title>
      <link href="/2019/05/25/%E7%A8%8B%E5%BA%8F%E5%91%98%E8%BF%99%E4%B8%AA%E8%81%8C%E4%B8%9A/"/>
      <url>/2019/05/25/%E7%A8%8B%E5%BA%8F%E5%91%98%E8%BF%99%E4%B8%AA%E8%81%8C%E4%B8%9A/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©æƒ³è·Ÿå¤§å®¶èŠèŠå…³äºç¨‹åºå‘˜èŒä¸šçš„è¯é¢˜~</p><p><img src="/upload/images/2019/05/25/1.jpg"></p><hr><h2 id="è°£è¨€å¯ç•"><a href="#è°£è¨€å¯ç•" class="headerlink" title="è°£è¨€å¯ç•"></a>è°£è¨€å¯ç•</h2><p>å¦‚æœä½ æ˜¯åšç¼–ç¨‹è¿™ä¸ªè¡Œä¸šçš„ï¼Œä¸€å®šä¼šå¬åˆ°å¾ˆå¤šäººæŠ±æ€¨è¿™ä¸ªè¡Œä¸šå¤ªè¾›è‹¦äº†ï¼Œç½‘ä¸Šä¹Ÿæµè¡Œç€è¿™ä¹ˆä¸€å¥è¯ï¼šâ€œç¨‹åºå‘˜æŒ£å¾—å¤šï¼Œæ­»å¾—æ—©â€ï¼Œç®€ç›´æ‰å¿ƒï¼</p><p>å…³äº â€œç¨‹åºå‘˜æŒ£å¾—å¤šï¼Œæ­»å¾—æ—©â€ è¿™å¥è¯å…¶å®æ˜¯ä¸å®Œå…¨åˆç†çš„ã€‚</p><p>æˆ‘è®°å¾—å‡ å¹´å‰ï¼Œä¸€ä¸ªåŠ ç­çš„å‘¨æœ«æˆ‘ä¸€ä¸ªäººåç”µæ¢¯ä¸Šå»æ­£å¥½ç¢°åˆ°ä¸€ä½é€æ°´çš„å¤§çˆ·ã€‚å¤§çˆ·ç„äº†æˆ‘ä¸€çœ¼è¯´ï¼šâ€å°ä¼™å­è¿™ä¸ªç‚¹å†è¿™é‡Œè¿˜ä¸Šç­çš„ä¸€å®šæ˜¯æç¼–ç¨‹çš„å§ï¼Ÿâ€œã€‚æˆ‘ç‚¹äº†ç‚¹å¤´ï¼šâ€å¤§çˆ·ï¼Œè¡Œå®¶å‘€ï¼Œæ²¡æƒ³åˆ°è¢«ä½ ä¸€çœ¼è¯†ç ´â€œã€‚å¤§çˆ·æ¥ç€è¯´é“ï¼šâ€è¿™ä¸ªè¡Œä¸šå¥½å‘€ï¼ŒæŒ£å¾—å¤šï¼Œä½ ä»¬ä¸€ä¸ªæœˆæœ€å°‘ä¹Ÿæœ‰å¥½å‡ ä¸‡å§ï¼Ÿâ€œï¼Œæˆ‘å½“æ—¶è¢«å¤§çˆ·è¯´å‡ºæ¥çš„æ•°å­—å“äº†ä¸€è·³ï¼Œé‚£å¯æ˜¯æˆ‘ä¸åƒä¸å–ä¸€å¹´çš„å·¥èµ„å‘€ï¼æˆ‘å°´å°¬çš„ç¬‘ç€è¯´ï¼šâ€å¤§çˆ·ï¼Œä½ çœŸé€—ï¼â€œï¼Œç„¶åç®€å•èŠäº†å‡ å¥å°±ä¸‹äº†ç”µæ¢¯ï¼Œå¤§çˆ·çš„è¯ä¹…ä¹…ä¸èƒ½è®©æˆ‘é‡Šæ€€ï¼Œæ„Ÿè§‰è‡ªå·±åšäº†ä¸€ä»½å‡å·¥ä½œã€‚</p><p>â€œæŒ£å¾—å¤šâ€ å®Œå…¨æ˜¯è°£è¨€ï¼Œâ€œæ­»å¾—æ—©â€ å€’æ˜¯æœ‰å¯èƒ½ï¼Œæƒ³æƒ³éƒ½ç–¼ã€‚å…³äºç¨‹åºå‘˜ï¼ŒåŠ ç­åˆ°æ˜¯å®¶å¸¸ä¾¿é¥­ï¼Œåœ¨ä½ èŒä¸šç”Ÿæ¶¯çš„æ—©æœŸåŠ ç­æ˜¯å› ä¸ºè‡ªå·±èƒ½åŠ›ä¸è¶³ï¼Œéšç€ä½  â€œé”®â€æ­¥å¦‚é£èƒ½åŠ›çš„æå‡ï¼Œè‡ªä»¥ä¸ºä¸ç”¨å†è¿™ä¹ˆæ‹¼å‘½äº†ï¼Œè°æ›¾æƒ³â€¦æ–°çš„ç¼–ç¨‹è¯­è¨€æ¨ªç©¿å‡ºä¸–ï¼Œæ–°çš„æŠ€æœ¯å±‚å‡ºä¸ç©·ï¼Œå¦‚æœä¸å­¦ä¹ ä¸åŠªåŠ›åªèƒ½è¢«è¿™ä¸ªè¡Œä¸šç»™æ·˜æ±°æ‰ã€‚</p><p>å¦‚æœä½ æœ‰è¶³å¤Ÿå¥½çš„è¿æ°”èƒ½é‡åˆ°å¥½çš„é¡¹ç›®ï¼Œé‡åˆ°å¥½çš„å›¢é˜Ÿï¼Œè‚¯å®šèƒ½ä»ä¸­è·ç›Šï¼Œæ¯”å¦‚ä½ åœ¨æ”¯ä»˜å®ã€æˆ–è€…åœ¨ç‹è€…è£è€€å›¢é˜Ÿï¼Œæˆ–è€…ä½ åœ¨å¾®ä¿¡ï¼Œåˆæˆ–è€…ä½ åœ¨ä»Šæ—¥å¤´æ¡ã€‚</p><p>å¥½çš„è¿æ°”å¹¶ä¸æ˜¯æ¯ä¸ªäººéƒ½æœ‰ï¼Œå› ä¸ºå¥½çš„è¿æ°”æ›´éœ€è¦å¥½çš„è‡ªå·±ï¼Œä½ è¦åšå¥½å……åˆ†çš„å‡†å¤‡å»è¿æ¥ â€å¥½è¿æ°”â€œ çš„åˆ°æ¥ã€‚</p><h2 id="å»ºç«‹äººè„‰"><a href="#å»ºç«‹äººè„‰" class="headerlink" title="å»ºç«‹äººè„‰"></a>å»ºç«‹äººè„‰</h2><p>å’Œä½ ç›¸å¤„çš„åŒäº‹å½“ä¸­ï¼Œè‚¯å®šä¼šæœ‰è¯™è°å¹½é»˜çš„å‹çš„ï¼Œç†æ™ºç†æ€§å‹çš„ï¼Œè¿˜æœ‰æ„Ÿæƒ…ç”¨äº‹è¯´è¯å¾ˆç›´æ¥çš„ç±»å‹çš„äººï¼Œä¹Ÿè®¸è¿˜æœ‰å°è‚šé¸¡è‚ å‘é„™å°äººå‹çš„ã€‚ç›´åˆ°æˆ‘è¯»åˆ°æ˜æœå†å²ï¼Œæˆ‘æ‰çŸ¥é“çš‡å¸è¿˜å¯ä»¥å‡ åå¹´ä¸ä¸Šæœçš„ï¼Œç§°å…¶ä¸º â€æ— ä¸ºè€Œæ²»â€œã€‚æ‰€ä»¥ï¼Œä¸–ç•Œé‚£ä¹ˆå¤§ï¼Œé‡åˆ°å½¢å½¢è‰²è‰²çš„äººæ˜¯ä¸€ä»¶å†æ­£å¸¸ä¸è¿‡çš„äº‹æƒ…ï¼Œæ²¡ä»€ä¹ˆå¤§æƒŠå°æ€ªçš„ã€‚</p><p>ä¸è¿‡æˆ‘æ¥è§¦çš„ç¨‹åºå‘˜çš„åŒäº‹ä¸­ï¼Œå¹½é»˜è¯™è°çš„äººä¸å¤šï¼Œå’Œè¿™ç±»äººä¸€èµ·å·¥ä½œä½ ä¼šè§‰å¾—å¾ˆå¼€å¿ƒã€‚è¿™ç±»äººæ›´å®¹æ˜“ç¼“è§£å›¢é˜Ÿç´§å¼ è€Œåˆæ²‰é—·çš„æ°›å›´ï¼Œæ›´å®¹æ˜“è¢«äººé€‰ä¸ºç»„é•¿ã€‚æˆ‘å»ºè®®å¤§å®¶è¯¥æ”¾æ¾çš„æ—¶å€™å°±æ”¾æ¾ï¼Œåˆ«æ•´å¤©æ‘†ç€è„¸ç»™äººä¸€ç§ â€æ¬ ä½ é’±â€œ çš„é”™è§‰ã€‚</p><p>å’ŒåŒäº‹æå¥½å…³ç³»ï¼Œå¯ä»¥ç»™ä½ æ—¥åçš„å·¥ä½œå¸¦æ¥å¾ˆå¤§çš„å¸®åŠ©ã€‚æ¯”å¦‚ï¼Œä½ åœ¨å·¥ä½œä¸­é‡åˆ°é˜»ç¢æˆ–è€…å›°éš¾ï¼ŒåŒäº‹ä»¬éƒ½ä¼šå¸®ä½ å‡ºè°‹åˆ’ç­–ï¼Œå“ªæ€•ä¸€ä¸ªå°å°çš„æç¤ºå¯èƒ½å°±èƒ½è®©ä½ çµå…‰ä¸€é—ªï¼Œè½»æ¾è§£å†³é—®é¢˜ã€‚ä½ åœ¨å…¬å¸çš„æ—¶é—´ä¹…äº†ï¼Œé™¤äº†å’ŒåŒéƒ¨é—¨çš„åŒäº‹å¤„ç†å¥½å…³ç³»ï¼Œè¿˜æœ‰è·Ÿå…¶ä»–éƒ¨é—¨çš„åŒäº‹å¤šæ¥è§¦ã€‚å¼€å‘å’Œè´¨é‡ç®¡ç†éƒ¨ã€è¿ç»´ä¸­å¿ƒã€è®¾è®¡éƒ¨ä»¥åŠä¸šåŠ¡éƒ¨é—¨å¤šå°‘éƒ½ä¼šæœ‰ä¸€äº›å·¥ä½œä¸Šçš„æ¥è§¦ï¼Œä¸å¦¨è·Ÿä»–ä»¬å¤šå’¨è¯¢ä¸€äº›éä½ æœ¬ä¸“ä¸šçš„çŸ¥è¯†ï¼Œè¿™æ ·æ—¢å¯ä»¥å­¦åˆ°çŸ¥è¯†åˆå¯ä»¥ç»“äº¤æœ‹å‹ï¼ŒèŒåœºçš„äº¤é™…èƒ½åŠ›æ˜¯é—¨å¤§å­¦é—®ã€‚</p><p>ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰å‘ç°ï¼Œå…¬å¸å¾ˆå¤šçš„ä¸šåŠ¡ä¸»ç®¡éƒ½æ˜¯å…¬å¸æœ‰äº¤é™…èƒ½åŠ›çš„è€å‘˜å·¥æ¥æ‹…å½“ï¼Ÿä¸ºä»€ä¹ˆå‘¢ï¼Œå› ä¸ºè¿™äº›äººåœ¨å…¬å¸å¾…çš„æ—¶é—´ä¹…ï¼Œæ²Ÿé€šèƒ½åŠ›æœ‰å¼ºï¼Œæ‰€ä»¥å¾ˆå¤šè·¨éƒ¨é—¨çš„åè°ƒå·¥ä½œä»–éƒ½èƒ½è½»è€Œæ˜“ä¸¾çš„æå®šã€‚</p><p>é™¤äº†è‡ªå·±è¦åŠ å¼ºäº¤é™…èƒ½åŠ›ï¼Œè¿˜æœ‰åŠ å¼ºè‡ªå·±çš„æŠ€æœ¯èƒ½åŠ›ä»¥åŠæŠ€æœ¯å½±å“åŠ›ï¼Œæ¯”å¦‚ä½ å¸¦å¤´åœ¨çŸ­æ—¶é—´å†…è§£å†³äº†ä¸€ä¸ªé—ç•™å¾ˆä¹…çš„é—®é¢˜ï¼Œè¿™ä¸ªä¼šå¾ˆå¿«è®©ä½ æˆä¸ºå¤§å®¶å¿ƒç›®ä¸­çš„æŠ€æœ¯ä½¼ä½¼è€…ã€‚</p><p>å¦å¤–ï¼Œè‡ªå·±è¦å¤šå»å¸®åŠ©åˆ«äººï¼Œå½“ä½ æœ‰å›°éš¾çš„æ—¶å€™æœ‰äººå¸®åŠ©ä½ ï¼Œé‚£ä¹ˆå½“åˆ«äººæœ‰å›°éš¾çš„æ—¶å€™ä½ ä¹Ÿè¦èƒ½åŠæ—¶çš„å¸®åŠ©åˆ«äººï¼Œè¿™æ ·å¤§å®¶å½¼æ­¤æ‰èƒ½å»ºç«‹ä¿¡ä»»æ„Ÿï¼Œé€äººç«ç‘°æ‰‹ç•™ä½™é¦™ï¼Œå¾ˆç®€å•çš„é“ç†ã€‚</p><h2 id="è‡ªæˆ‘å®šä½"><a href="#è‡ªæˆ‘å®šä½" class="headerlink" title="è‡ªæˆ‘å®šä½"></a>è‡ªæˆ‘å®šä½</h2><p>ä¹Ÿè®¸æœ‰ä¸€å¤©ï¼Œä½ è¢«å…¬å¸é«˜å±‚ç›¯ä¸Šäº†ã€‚é«˜å±‚è§‰å¾—ä½ å¾ˆä¸é”™ï¼Œå„æ–¹é¢éƒ½æ¯”è¾ƒä¼˜ç§€ï¼Œå†³å®šé€‰ä½ ä¸ºéƒ¨é—¨è´Ÿè´£äººã€‚</p><p>ä½œä¸ºéƒ¨é—¨è´Ÿè´£äººï¼Œä½ æ–°å®˜ä¸Šä»»å¯åƒä¸‡åˆ«ä¹±æ”¾ç«ï¼Œä½ è¦çŸ¥é“æ°´èƒ½è½½èˆŸäº¦èƒ½è¦†èˆŸï¼å¾ˆå¤šäººå½“ä¸Šéƒ¨é—¨é¢†å¯¼åï¼Œå–œæ¬¢åŠ¨ç”¨äººäº‹éƒ¨é—¨å¼€å§‹è¿›è¡Œè£å‘˜è¡ŒåŠ¨ï¼Œæœ‰äº›å¾ˆä¼˜ç§€çš„å‘˜å·¥éƒ½è¢«ä»–ç»™èµ¶èµ°äº†ã€‚å¤§å“¥ï¼Œè¿™ä¸æ˜¯å°å»ºç¤¾ä¼šäº†ï¼Œä½ ä»¥ä¸ºè‡ªå·±æ˜¯ç§¦å§‹çš‡å—ï¼Ÿï¼åˆ‡ï¼</p><p>å°±è·Ÿå¤§å®¶ä¸Šå­¦é€‰ç­é•¿ä¸€æ ·ï¼Œå¤§å®¶ä¸ºä»€ä¹ˆé€‰ä½ åšç­é•¿ï¼Ÿä¸€èˆ¬æ˜¯å› ä¸ºä½ å­¦ä¹ åŠªåŠ›æˆç»©ä¼˜ç§€å¹¶ä¸”èƒ½å¸¦åŠ¨å¤§å®¶ä¸€èµ·å­¦ä¹ å’Œè¿›æ­¥ï¼Œåœ¨å·¥ä½œå½“ä¸­ä¹Ÿä¸€æ ·ï¼Œé€‰ä½ åšè´Ÿè´£äººï¼Œæ˜¯è®©ä½ èƒ½å¸¦é¢†å›¢é˜Ÿä¸€èµ·ä½œæˆ˜æ‹¿ä¸‹å…¬å¸å®šä¸‹çš„ç›®æ ‡ï¼Œè®©ä½ å¸®åŠ©å¤§å®¶è§£å†³é—®é¢˜è€Œä¸æ˜¯è®©ä½ ä»—åŠ¿æ¬ºäººï¼Œæ‘†å‡ºä¸€å‰¯é«˜é«˜åœ¨ä¸Šçš„å§¿æ€è®©äººéš¾ä»¥ â€æœ›å…¶é¡¹èƒŒâ€œã€‚</p><p>ç‰¹åˆ«æ˜¯æŠ€æœ¯å‡ºèº«çš„éƒ¨é—¨é¢†å¯¼ï¼Œä¸€å®šè¦åšå¥½è‡ªæˆ‘å®šä½ã€‚é™¤äº†å¸®å¤§å®¶å¸®å›¢é˜Ÿè§£å†³é—®é¢˜ï¼Œä½ è‡ªå·±çš„æŠ€æœ¯èƒ½åŠ›ä¸èƒ½è½ä¸‹ä¹Ÿå°±æ˜¯è¯´ä¸èƒ½ä¸§å¤±ç¼–ç¨‹çš„èƒ½åŠ›ï¼Œå¦åˆ™ä½ è¿æœ€åä¿ä½é¥­ç¢—çš„èƒ½åŠ›éƒ½æ²¡æœ‰äº†ã€‚</p><p>ä¸‡ä¸€ï¼Œé‚£å¤©ä½ åšäº†ç®¡ç†è€…ï¼Œè¦æƒ³æ¸…æ¥šä½ èƒ½åšä»€ä¹ˆä»¥åŠä½ ä¸èƒ½åšä»€ä¹ˆï¼Œæœ€é‡è¦çš„æ˜¯æ‰¾å¥½è‡ªæˆ‘å®šä½ï¼Œåˆ«å¿˜äº†ä½ ä»¥å‰ä¹Ÿæ˜¯ä¸€ä¸ªç¨‹åºå‘˜ã€‚</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼ŒæœŸå¾…ä¸ä½ çš„äº¤æµ~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¨‹åºå‘˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaIOä¸­ç¥å¥‡çš„flush</title>
      <link href="/2019/05/19/JavaIO%E4%B8%AD%E7%A5%9E%E5%A5%87%E7%9A%84flush/"/>
      <url>/2019/05/19/JavaIO%E4%B8%AD%E7%A5%9E%E5%A5%87%E7%9A%84flush/</url>
      
        <content type="html"><![CDATA[<p>è¿™ç¯‡æ–‡ç« åœ¨ä¹‹å‰å·²ç»å†™è¿‡ï¼Œåªæ˜¯æ²¡æœ‰åœ¨å…¬ä¼—å·å‘å¸ƒè¿‡ã€‚è¯¥æ–‡é˜…è¯»é‡å·²ç»è¾¾åˆ°äº† <strong>36553</strong> æ¬¡äº†ï¼Œæœ‰å¿…è¦åˆ†äº«ç»™å¤§å®¶ã€‚</p><p><img src="/upload/images/2019/05/19/1.png" alt="1"></p><p>åç»­æˆ‘ä¼šé™†ç»­çš„æŠŠä¸€äº›å¤§å®¶è¯„è®ºæ¯”è¾ƒå¤šå¹¶ä¸”å¾ˆå¥½çš„çŸ¥è¯†ç‚¹åœ¨å…¬ä¼—å·åˆ†äº«ç»™å¤§å®¶ï¼Œå¸Œæœ›å’Œå¤§å®¶åœ¨ç¼–ç¨‹çš„é“è·¯ä¸Šä¸€èµ·è¿›æ­¥ï¼ŒæŠŠè‹¦æ¶©çš„æ—¥å­å˜å¾—æœ‰è¶£ä¸€ç‚¹ã€‚</p><p>æ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„äººå·¥æ™ºèƒ½æ•™ç¨‹ï¼Œå¿ä¸ä½åˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥è·³è½¬åˆ°æ•™ç¨‹ã€‚</p><h2 id="å†…å®¹æ¦‚è¦"><a href="#å†…å®¹æ¦‚è¦" class="headerlink" title="å†…å®¹æ¦‚è¦"></a>å†…å®¹æ¦‚è¦</h2><p>Java IO æµçš„è®¾è®¡ä¸å¾—ä¸è®©äººæ‹æ¡ˆå«ç»ï¼Œä½©æœè®¾è®¡è€…é¬¼æ–§å¤©å·¥çš„æ‰‹æ³•ã€‚</p><p>å¦‚æœä½ æ˜¯ Java åˆå­¦è€…ï¼Œæˆ‘æ•¢ä¿è¯ç¬¬ä¸€æ¬¡æ¥è§¦ Java çš„ IO ç±»ï¼Œä¸€å®šä¼š â€ç‹‚æ™•ï¼â€ï¼Œå€’ä¸æ˜¯å› ä¸ºå®ƒæœ‰å¤šä¹ˆéš¾å­¦è€Œæ˜¯å¤ªå¤šè®©äººéš¾ä»¥ç¢ç£¨ï¼Œè®©äººæœ‰ç§ â€œä¸è¯†åºå±±çœŸé¢ç›®â€ çš„æ„Ÿè§‰ï¼Œå½“ä½ ç”¨å¿ƒå­¦å®Œä¹‹åä¹Ÿä¼šæ”¶è· â€œåªç¼˜èº«åœ¨æ­¤å±±ä¸­â€ çš„é¡¿æ‚Ÿã€‚</p><p>åœ¨ Java ç¼–ç¨‹çš„æ—¥å­ä¸­å°¤å…¶æ˜¯åœ¨ç½‘ç»œç¼–ç¨‹ä¸­ï¼Œå‡ ä¹ç¦»ä¸å¼€ Java çš„ IO æµï¼Œæ‰€ä»¥å­¦å¥½å’Œç”¨å¥½å®ƒæ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚</p><p>å…³äº Java çš„ IO æµçš„åˆ†ç±»ï¼Œå¯ä»¥å»æ‰¾æ‰¾ç›¸å…³çš„èµ„æ–™ï¼Œä»Šå¤©è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹å…¶ä¸­æ¯”è¾ƒç¥å¥‡çš„ <code>flush</code> æ–¹æ³•ã€‚</p><h2 id="flush-ä¸-OutputStream"><a href="#flush-ä¸-OutputStream" class="headerlink" title="flush ä¸ OutputStream"></a>flush ä¸ OutputStream</h2><p>è¯¥ç±»å®ç°äº† Flushable æ¥å£ï¼Œæ‰€ä»¥é‡å†™äº† flush æ–¹æ³•ï¼Œçœ‹çœ‹ flush() æºç ï¼Œä¼šæ›´åŠ çš„è®©ä½ æ˜ç™½ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">flush</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123; &#125; </span><br></pre></td></tr></table></figure><p>Sorryï¼Œè¯¥å®ç°ä¸ºç©ºã€‚è¿™é‡Œçš„ <code>flush()</code> å±…ç„¶æ˜¯ä¸€ä¸ªç©ºæ–¹æ³•ï¼Œä»€ä¹ˆä¹Ÿæ²¡åšã€‚çœ‹æ¸…æ¥šå•Šï¼Œè¯¥æ–¹æ³•ä¸æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œæ˜¯ä¸€ä¸ªå®å®åœ¨åœ¨çš„æ–¹æ³•ã€‚é™¤äº†æ–¹æ³•ä½“ä¸­ä¸€æ— æ‰€æœ‰ï¼Œå…¶å®ƒè¿˜å¥½ï¼çœ‹JDKçš„APIå¦‚ä½•è§£é‡Šå§ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">flush </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">flush</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span><br><span class="line">åˆ·æ–°æ­¤è¾“å‡ºæµå¹¶å¼ºåˆ¶å†™å‡ºæ‰€æœ‰ç¼“å†²çš„è¾“å‡ºå­—èŠ‚ã€‚</span><br><span class="line">flush çš„å¸¸è§„åå®šæ˜¯ï¼šå¦‚æœæ­¤è¾“å‡ºæµçš„å®ç°å·²ç»ç¼“å†²äº†ä»¥å‰å†™å…¥çš„ä»»ä½•å­—èŠ‚ï¼Œåˆ™è°ƒç”¨æ­¤æ–¹æ³•æŒ‡ç¤ºåº”å°†è¿™äº›å­—èŠ‚ç«‹å³å†™å…¥å®ƒä»¬é¢„æœŸçš„ç›®æ ‡ã€‚ </span><br><span class="line">å¦‚æœæ­¤æµçš„é¢„æœŸç›®æ ‡æ˜¯ç”±åŸºç¡€æ“ä½œç³»ç»Ÿæä¾›çš„ä¸€ä¸ªæŠ½è±¡ï¼ˆå¦‚ä¸€ä¸ªæ–‡ä»¶ï¼‰ï¼Œåˆ™åˆ·æ–°æ­¤æµåªèƒ½ä¿è¯å°†ä»¥å‰å†™å…¥åˆ°æµçš„å­—èŠ‚ä¼ é€’ç»™æ“ä½œç³»ç»Ÿè¿›è¡Œå†™å…¥ï¼Œä½†ä¸ä¿è¯èƒ½å°†è¿™äº›å­—èŠ‚å®é™…å†™å…¥åˆ°ç‰©ç†è®¾å¤‡ï¼ˆå¦‚ç£ç›˜é©±åŠ¨å™¨ï¼‰ã€‚</span><br><span class="line">OutputStream çš„ flush æ–¹æ³•ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚</span><br><span class="line">æŒ‡å®šè€…ï¼š æ¥å£ Flushable ä¸­çš„ flush </span><br><span class="line">æŠ›å‡ºï¼š IOException - å¦‚æœå‘ç”Ÿ I/O é”™è¯¯ã€‚  </span><br></pre></td></tr></table></figure><p>å¼€å§‹ï¼Œæˆ‘å®‰æ…°è‡ªå·±ï¼Œè¯¥ç±»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒçš„å­ç±»è‚¯å®šé‡å†™äº†è¯¥æ–¹æ³•ã€‚</p><p>å¥½å§ï¼Œ<code>OutputStream</code> çš„ç›´æ¥å­ç±»æœ‰ï¼š<code>ByteArrayOutputStream</code> ã€<code>FileOutputStream</code>ã€<code>FilterOutputStream</code>ã€<code>ObjectOutputStream</code> ã€<code>OutputStream</code>ã€<code>PipedOutputStream</code> ç­‰å‡ ä¸ªç±»ã€‚</p><p><strong>æ³¨æ„ï¼šè¿™é‡Œçš„å­ç±» <code>OutputStream</code> æ˜¯åŒ… <code>org.omg.CORBA.portable</code> çš„ã€‚</strong></p><p>å¯¹äº <code>FileOutputStream</code>ã€<code>ByteArrayOutputStream</code>ã€<code>org.omg.CORBA.portable.OutputStream</code> ç±»å®ƒä»¬çš„ <code>flush()</code> æ–¹æ³•å‡æ˜¯ä»çˆ¶ç±»ç»§æ‰¿çš„ <code>flush</code> æ–¹æ³•ã€‚</p><p><code>FilterOutputStream</code> ç±»é‡å†™äº† <code>flush()</code> æ–¹æ³•ï¼Œä½†æ˜¯å®è´¨è¿˜æ˜¯è°ƒç”¨çˆ¶ç±»çš„ <code>flush()</code> æ–¹æ³•ã€‚<code>ObjectOutputStream</code>ã€<code>PipedOutputStream</code> ç±»é‡å†™äº† <code>flush()</code> æ–¹æ³•ã€‚</p><p>JDK ä¸­ï¼Œæœ‰ä¸¤å¤§ç±»IOæµå³å­—èŠ‚æµå’Œå­—ç¬¦æµï¼ˆåŒ…æ‹¬è¾“å…¥å’Œè¾“å‡ºï¼‰ï¼Œè¿™äº›æµç±»ä¸­æœ‰äº›æ˜¯å¸¦æœ‰ç¼“å†²åŒºåŠŸèƒ½çš„æœ‰äº›æ˜¯æ²¡æœ‰çš„ã€‚<code>BufferedInputStream</code> å’Œ <code>BufferedOutputStream</code> æ˜¯å­—èŠ‚ç¼“å†²åŒºç±»ï¼›<code>BufferedReader</code> å’Œ <code>BufferedWriter</code> æ˜¯å­—ç¬¦ç¼“å†²åŒºç±»<strong>ã€‚</strong></p><p>æ¥ä¸¾ä¸¤ä¸ªå°ä¾‹å­ï¼Œç¬¬ä¸€ä¸ªä¾‹å­ä¸»è¦æ˜¯ä½¿ç”¨éç¼“å†²åŒºçš„ IO æµå‘æ–‡æœ¬ä¸­å†™å…¥æŒ‡å®šçš„å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªä¾‹å­æ˜¯ä½¿ç”¨å¸¦æœ‰ç¼“å†²åŒºçš„ IO æµå‘æ–‡æœ¬ä¸­å†™å…¥ä¸€å®šçš„å­—èŠ‚æ•°æ®ã€‚</p><p><strong>1ã€ä¾‹å­1ï¼šå‘æ–‡æœ¬ä¸­å†™å…¥å­—ç¬¦ä¸²</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedOutputStream; </span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream; </span><br><span class="line"><span class="keyword">import</span> java.io.File; </span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123; </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123; </span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;text.txt&quot;</span>); </span><br><span class="line">        <span class="keyword">if</span> (!file.exists()) &#123;</span><br><span class="line">            file.createNewFile(); </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(file);</span><br><span class="line">        <span class="type">BufferedOutputStream</span> <span class="variable">bos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedOutputStream</span>(fos);</span><br><span class="line">        <span class="type">DataOutputStream</span> <span class="variable">dos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataOutputStream</span>(fos);</span><br><span class="line">        dos.writeBytes(<span class="string">&quot;java io&quot;</span>);</span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£æ‰§è¡Œåï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹äº§ç”Ÿ 1KB çš„æ–‡ä»¶ï¼ˆå†…å®¹ä¸º <code>java io</code>ï¼‰ã€‚</p><p>ç‰¹åˆ«æ³¨æ„ï¼Œè¿™é‡Œæ²¡æœ‰è°ƒç”¨ <code>flush</code> æ–¹æ³•ï¼Œåªæ˜¯è°ƒç”¨äº† <code>writeBytes</code> æ–¹æ³•ã€‚è°ƒç”¨æµç¨‹å›¾å¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/05/19/2.png" alt="1"></p><p><strong>2ã€ä¾‹å­2ï¼šå‘æ–‡æœ¬ä¸­å†™å…¥ä¸€å®šå­—èŠ‚çš„æ•°æ®</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedOutputStream; </span><br><span class="line"><span class="keyword">import</span> java.io.File; </span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream; </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123; </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123; </span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;text.txt&quot;</span>); </span><br><span class="line">        <span class="keyword">if</span> (!file.exists()) &#123; </span><br><span class="line">            file.createNewFile(); </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(file); </span><br><span class="line">        <span class="type">BufferedOutputStream</span> <span class="variable">bos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedOutputStream</span>(fos); </span><br><span class="line">        <span class="type">byte</span>[] b = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>*<span class="number">8</span>]; </span><br><span class="line">        bos.write(b); </span><br><span class="line">        bos.flush(); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£æ‰§è¡Œåï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹äº§ç”Ÿ 8KB å­—èŠ‚çš„æ–‡ä»¶ã€‚è°ƒç”¨å…³ç³»å¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/05/19/3.png" alt="1"></p><p>ç°åœ¨æˆ‘ä»¬ä¿®æ”¹ç¬¬äºŒä¸ªä¾‹å­çš„ä»£ç ï¼Œä¸»è¦ä¿®æ”¹ä¸¤ä¸ªåœ°æ–¹</p><p>ï¼ˆ1ï¼‰ã€æ³¨é‡Šæ‰è°ƒç”¨ <code>flush()</code> æ–¹æ³•ï¼›</p><p>ï¼ˆ2ï¼‰ã€å°† byte å¤§å°æ”¹ä¸º 1024 å¤§å°ã€‚</p><p>ä¿®æ”¹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;text.txt&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!file.exists()) &#123;</span><br><span class="line">            file.createNewFile();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(file);</span><br><span class="line">        <span class="type">BufferedOutputStream</span> <span class="variable">bos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedOutputStream</span>(fos);</span><br><span class="line">        <span class="type">byte</span>[] b = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        bos.write(b);</span><br><span class="line">        <span class="comment">//bos.flush();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><p>OKï¼Œå†æ¬¡è¿è¡Œä»£ç ï¼Œé¢çš„ç¥å•Šï¼Ÿï¼Ÿï¼Ÿæ–‡ä»¶å¤§å°å±…ç„¶æ˜¯0å­—èŠ‚ã€‚</p><p>whyï¼Ÿ</p><p>ä»”ç»†çš„ä½ ä¼šå‘ç°ï¼Œç¬¬ä¸€ä¸ªä¾‹å­ä¸­çš„ä»£ç ä¸­å¹¶æ²¡æœ‰è°ƒç”¨ <code>flush()</code> æ–¹æ³•ï¼Œå±…ç„¶å¯ä»¥æ­£å¸¸çš„å†™å…¥ã€‚ä¸ºä»€ä¹ˆç¬¬äºŒä¸ªå°±ä¸å¯ä»¥å‘¢ï¼Ÿè¿˜æ˜¯ä»æºç å…¥æ‰‹æ‰¾ç­”æ¡ˆå§ï¼</p><p><code>DataOutputStream</code> ç»§æ‰¿ <code>FilterOutputStream</code> ï¼Œå®ç°äº† <code>DataOutput</code> æ¥å£ã€‚æˆ‘ä»¬çŸ¥é“ <code>FilterOutputStream</code> ç±»é‡å†™äº† <code>flush()</code> æ–¹æ³•ï¼Œä½†æ˜¯å®è´¨è¿˜æ˜¯è°ƒç”¨çˆ¶ç±»çš„ <code>flush()</code> æ–¹æ³•ã€‚<code>DataOutputStream</code> ç±»çš„ <code>flush()</code> æ–¹æ³•æ•ˆä»¿å…¶çˆ¶ç±» <code>FilterOutputStream</code> çš„åšæ³•ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">flush</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123; </span><br><span class="line">    out.flush(); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆï¼Œå³ä½¿ä½ åœ¨ç¬¬ä¸€ä¸ªä¾‹å­çš„ä»£ç åé¢åŠ ä¸Š <code>dos.flush()</code> ç»“æœä¹Ÿæ˜¯æ­£å¸¸çš„ï¼Œä¸ä¸åŠ æ˜¯ä¸€æ ·çš„æ•ˆæœï¼Œå› ä¸ºå®ƒä»¬çš„çˆ¶ç±» <code>flush()</code> æ–¹æ³•å‡ä¸ºç©ºï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆç¬¬ä¸€ä¸ªä»£ç çš„ç¥å¥‡æ‰€åœ¨ã€‚</p><p>å†çœ‹çœ‹ç¬¬äºŒä¸ªä»£ç çš„ â€œç—…å› â€ åœ¨å“ªé‡Œï¼Ÿå…ˆçœ‹çœ‹ <code>BufferedOutputStream</code> ç±»çš„ç»“æ„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BufferedOutputStream</span> <span class="keyword">extends</span> <span class="title class_">FilterOutputStream</span></span><br></pre></td></tr></table></figure><p>å†çœ‹çœ‹ï¼Œå®ƒçš„ <code>flush()</code> æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">flush</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;         </span><br><span class="line">    flushBuffer(); </span><br><span class="line">    out.flush();</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">/** Flush the internal buffer */</span>    </span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">flushBuffer</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;   </span><br><span class="line">    <span class="keyword">if</span> (count &gt; <span class="number">0</span>) &#123;     </span><br><span class="line">        out.write(buf, <span class="number">0</span>, count);     </span><br><span class="line">        count = <span class="number">0</span>;        </span><br><span class="line">    &#125;    </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ä¸é”™ï¼Œè¯¥ç±»é‡å†™äº† <code>flush()</code> æ–¹æ³•ï¼Œä¸åƒå‰é¢å‡ ä¸ªç±»é‚£æ ·ä¸æ˜¯ç»§æ‰¿å°±æ˜¯å±±å¯¨çˆ¶ç±»çš„ <code>flush()</code> æ–¹æ³•ã€‚<code>BufferedOutputStream</code>  ç±»æ˜¯ä¸€ä¸ªä½¿ç”¨äº†ç¼“å†²æŠ€æœ¯çš„ç±»ï¼Œè¿™ç§ç±»ä¸€æŠŠéƒ½ä¼šè‡ªå·±å®ç° <code>flush()</code> æ–¹æ³•ã€‚</p><p>é‚£ä¹ˆï¼Œæœ‰äººä¼šé—®ä½¿ç”¨è¿™ç§ç±»çš„æ—¶å€™ï¼Œéš¾é“å¿…é¡»ä½¿ç”¨ <code>flush()</code> æ–¹æ³•å—ï¼Œå½“ç„¶ä¸æ˜¯å–½ï¼Ÿï¼Ÿï¼ï¼ä¸è¿‡æœ‰ä¸ªå‰æï¼Œä½ çš„å­—èŠ‚æ•°æ®å¿…é¡»ä¸èƒ½å°äº 8KBã€‚å®ä¾‹ä»£ç ï¼Œ<strong>æ³¨æ„æ²¡æœ‰ <code>flush()</code>æ–¹æ³•ã€‚</strong></p><p><strong>ï¼ˆ1ï¼‰ã€å†™å…¥çš„æ•°æ®ä¸å°äº8KB</strong></p><p>å¦‚ä¸‹ç¤ºä¾‹ä»£ç ï¼Œbyte å¤§å°æ”¹ä¸º 8KBï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedOutputStream; </span><br><span class="line"><span class="keyword">import</span> java.io.File; </span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream; </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123; </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123; </span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;text.txt&quot;</span>); </span><br><span class="line">        <span class="keyword">if</span> (!file.exists()) &#123; </span><br><span class="line">            file.createNewFile(); </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(file); </span><br><span class="line">        <span class="type">BufferedOutputStream</span> <span class="variable">bos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedOutputStream</span>(fos); </span><br><span class="line">        <span class="type">byte</span>[] b = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>*<span class="number">8</span>]; </span><br><span class="line">        bos.write(b); </span><br><span class="line">        <span class="comment">//bos.flush(); </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä»£ç ï¼Œä¼šäº§ç”Ÿå¤§å°ä¸º 8KB çš„æ–‡æœ¬æ–‡ä»¶ã€‚</p><p><strong>ï¼ˆ2ï¼‰ã€ä¿®æ”¹é»˜è®¤ç¼“å†²åŒºå¤§å°</strong></p><p>å¦‚ä¸‹ç¤ºä¾‹ä»£ç ï¼Œä¿®æ”¹ä¸€ä¸‹æ„é€  <code>BufferedOutputStream</code> çš„æ–¹æ³•ï¼Œè®¾ç½®é»˜è®¤ç¼“å†²åŒºå¤§å°ä¸º 1024ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;text4.txt&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (!file.exists()) &#123;</span><br><span class="line">    file.createNewFile();</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(file);</span><br><span class="line"><span class="type">BufferedOutputStream</span> <span class="variable">bos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedOutputStream</span>(fos, <span class="number">1024</span>);</span><br><span class="line"><span class="type">byte</span>[] b = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">bos.write(b);</span><br><span class="line"><span class="comment">//bos.flush();</span></span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä»£ç ï¼Œä¼šäº§ç”Ÿ 1KB å¤§å°çš„æ–‡æœ¬æ–‡ä»¶ã€‚</p><p>è¿™é‡Œæé†’ä¸€ä¸‹ï¼Œå¦‚æœä½ çš„æ–‡ä»¶è¯»å†™æ²¡æœ‰è¾¾åˆ°é¢„æœŸç›®çš„ï¼Œåä¹‹å…«ä¹æ˜¯å› ä¸ºä½ æ²¡æœ‰è°ƒç”¨ <code>flush()</code> æˆ–è€… <code>close()</code> æ–¹æ³•ã€‚</p><p>å¦å¤–ï¼Œå­—ç¬¦æµç±»å¤§å¤šæ•°éƒ½å®ç°äº† <code>flush()</code> æˆ–è€… <code>close()</code> æ–¹æ³•ï¼Œåªä¸è¿‡ï¼Œå®ƒä»¬è°ƒç”¨çš„æ˜¯ <code>StreamEncoder</code> ç±»çš„è¯¥æ–¹æ³•ã€‚è¯¥ç±»ä½äº <code>sun.nio.cs</code> åŒ…ä¸‹é¢ï¼Œå…¶æºç åœ¨æˆ‘ä»¬JDKä¸­æ˜¯æ²¡æœ‰çš„ã€‚</p><p>å¯ä»¥ç‚¹å‡» <a href="http://www.docjar.com/html/api/sun/nio/cs/StreamEncoder.java.html">StreamEncoder.java</a> æŸ¥çœ‹æºç ã€‚</p><h2 id="flush-ä¸-Writer"><a href="#flush-ä¸-Writer" class="headerlink" title="flush ä¸ Writer"></a>flush ä¸ Writer</h2><p>è¯¥ç±» <code>Writer</code> æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå£°æ˜å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Writer</span> <span class="keyword">implements</span> <span class="title class_">Appendable</span>, Closeable, Flushable</span><br></pre></td></tr></table></figure><p><code>Writer</code> ç±»çš„ <code>flush()</code> æ–¹æ³•æ˜¯ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå…¶å­ç±»ä¸€èˆ¬éƒ½å®ç°äº†è¯¥æ–¹æ³•ã€‚</p><p>æ‰€ä»¥ï¼Œä¸€èˆ¬ä½¿ç”¨å­—ç¬¦æµä¹‹åéœ€è¦è°ƒç”¨ä¸€ä¸‹ <code>flush()</code> æˆ–è€… <code>close()</code> æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">flush</span><span class="params">()</span> <span class="keyword">throws</span> IOException;</span><br></pre></td></tr></table></figure><p>ç»†èŠ‚è¯·çœ‹JDKçš„APIï¼Œæˆ–è€…Javaçš„æºç ä»¥åŠä¸Šé¢çš„ <code>StreamEncoder</code> ç±»æºç ã€‚</p><p>ä»Šå¤©å°±è¯´åˆ°è¿™é‡Œå§ï¼Œæœ¬æ–‡ä¸»è¦å€ŸåŠ©Java IOä¸­å­—èŠ‚æµä¸å­—ç¬¦æµçš„ <code>flush()</code> æ–¹æ³•ï¼Œæ¥è¯´æ˜å­¦ç¼–ç¨‹è¯­è¨€çœ‹æºç å’Œæ€è€ƒæ˜¯å¾ˆé‡è¦çš„ã€‚</p><p>æ€»ä¹‹ï¼Œä¸ç®¡ä½ ä½¿ç”¨å“ªç§æµï¼ˆå­—ç¬¦ã€å­—èŠ‚ã€å…·æœ‰ç¼“å†²çš„æµï¼‰æŠ€æœ¯ï¼Œä¸å¦¨è°ƒç”¨ä¸€ä¸‹ <code>flush()</code> æˆ–è€… <code>close()</code> æ–¹æ³•ï¼Œé˜²æ­¢æ•°æ®æ— æ³•å†™åˆ°è¾“å‡ºæµä¸­ã€‚</p><hr><p><strong>å­¦ä¹ æ²¡æœ‰ä¸€è¹´è€Œå°±çš„æ–¹æ³•ï¼ŒåšæŒæ€è€ƒã€ç»ƒä¹ æ‰æ˜¯ç‹é“~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> flush OutputStream JavaSE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>macOS ç”Ÿæˆ RSA å…¬é’¥å’Œç§é’¥</title>
      <link href="/2019/05/11/macOS-%E7%94%9F%E6%88%90-RSA-%E5%85%AC%E9%92%A5%E5%92%8C%E7%A7%81%E9%92%A5/"/>
      <url>/2019/05/11/macOS-%E7%94%9F%E6%88%90-RSA-%E5%85%AC%E9%92%A5%E5%92%8C%E7%A7%81%E9%92%A5/</url>
      
        <content type="html"><![CDATA[<p>å¦‚æœä½ æ²¡æœ‰å®‰è£… <code>openssl</code>ï¼Œè¯·å…ˆä½¿ç”¨ brew å®‰è£…å®ƒã€‚</p><h2 id="ç”Ÿæˆ-RSA-ç§é’¥"><a href="#ç”Ÿæˆ-RSA-ç§é’¥" class="headerlink" title="ç”Ÿæˆ RSA ç§é’¥"></a>ç”Ÿæˆ RSA ç§é’¥</h2><p>åœ¨ macOS ç»ˆç«¯è¾“å…¥ä¸‹é¢å‘½ä»¤ï¼Œä¼šç”Ÿæˆ1024ä½çš„ç§é’¥ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl genrsa -out rsa_private.pem 1024</span><br></pre></td></tr></table></figure><p>æ‰§è¡ŒæˆåŠŸåï¼Œåœ¨å½“å‰ç›®å½•ä¼šç”Ÿæˆ <code>rsa_private.pem</code> æ–‡ä»¶äº†ã€‚</p><p><strong>æ³¨æ„ï¼šè¿™é‡Œç”Ÿæˆçš„æ˜¯ <code>PKCS1</code> æ ¼å¼çš„æ–‡ä»¶ï¼Œä¹Ÿç§°ä¹‹ä¸ºä¼ ç»Ÿçš„ç§é’¥æ ¼å¼ã€‚</strong></p><h2 id="ç”Ÿæˆ-RSA-å…¬é’¥"><a href="#ç”Ÿæˆ-RSA-å…¬é’¥" class="headerlink" title="ç”Ÿæˆ RSA å…¬é’¥"></a>ç”Ÿæˆ RSA å…¬é’¥</h2><p>å¾—åˆ°ç§é’¥åï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å¯ä»¥å¾—åˆ°å…¬é’¥ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl rsa -in rsa_private.pem -out rsa_public.pem -pubout </span><br></pre></td></tr></table></figure><p>æ‰§è¡ŒæˆåŠŸåï¼Œåœ¨å½“å‰ç›®å½•ä¼šç”Ÿæˆ <code>rsa_public.pem</code> çš„æ–‡ä»¶ï¼Œè¿™ä¸ªå°±æ˜¯å…¬é’¥ã€‚</p><h2 id="æ ¼å¼è½¬æ¢"><a href="#æ ¼å¼è½¬æ¢" class="headerlink" title="æ ¼å¼è½¬æ¢"></a>æ ¼å¼è½¬æ¢</h2><blockquote><p>æœ‰äº›åç«¯æœåŠ¡éœ€è¦ <code>PKCS8</code> æ ¼å¼çš„å¯†é’¥ï¼Œå¯ä»¥ä½¿ç”¨ openssl å·¥å…·æŠŠ <code>PKCS1</code> å’Œ <code>PKCS8</code> è¿›è¡Œäº’è½¬ã€‚</p></blockquote><p><code>PKCS</code> å…¨ç§°æ˜¯ <code>Public-Key Cryptography Standards</code>ï¼Œæ˜¯ç”± RSA å®éªŒå®¤ä¸å…¶å®ƒå®‰å…¨ç³»ç»Ÿå¼€å‘å•†ä¸ºä¿ƒè¿›å…¬é’¥å¯†ç çš„å‘å±•è€Œåˆ¶è®¢çš„ä¸€ç³»åˆ—æ ‡å‡†ã€‚</p><p>æŠŠ RSA ç§é’¥è½¬ <code>PKCS1</code> è½¬æ¢ä¸º <code>PKCS8</code> æ ¼å¼ï¼Œæ‰§è¡Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl pkcs8 -topk8 -inform PEM -in rsa_private.pem -outform PEM -nocrypt -out rsa_private_pkcs8.pem</span><br></pre></td></tr></table></figure><p>æŠŠ RSA ç§é’¥ <code>PKCS8</code> æ ¼å¼è½¬æ¢ä¸º <code>PKCS1</code> æ ¼å¼ï¼Œæ‰§è¡Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl rsa -in rsa_private_pkcs8.pem -out pkcs1.pem</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šç”Ÿæˆçš„ RSA(pem) æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ vimã€vscode ç­‰æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€æŸ¥çœ‹ã€‚</p><p>æ— è®ºæ˜¯ <code>PKCS1</code> è¿˜æ˜¯ <code>PKCS8</code>ï¼Œå®ƒä»¬éƒ½æ˜¯ PEM ç¼–ç å­˜å‚¨çš„æ ¼å¼ã€‚</p><h2 id="PEM-æ ¼å¼"><a href="#PEM-æ ¼å¼" class="headerlink" title="PEM æ ¼å¼"></a>PEM æ ¼å¼</h2><p>PEM æ ¼å¼æ—¢æ˜¯å¯¹ <a href="http://fileformats.archiveteam.org/wiki/DER">DER</a> ç¼–ç è½¬ç ä¸º <code>Base64</code> å­—ç¬¦æ ¼å¼ï¼Œé€šè¿‡è§£ç ï¼Œå°†ä¼šè¿˜åŸä¸º DER æ ¼å¼ã€‚å³ PEM æ˜¯å»ºç«‹åœ¨ DER ç¼–ç ä¹‹ä¸Šçš„ä¸€ç§æ ¼å¼ã€‚</p><p>æ€»ä¹‹ï¼ŒPEM æ˜¯æ˜æ–‡æ ¼å¼ï¼Œå¯ä»¥åŒ…å«è¯ä¹¦æˆ–è€…æ˜¯å¯†é’¥ï¼Œå…¶å†…å®¹é€šå¸¸æ˜¯ä»¥ç±»ä¼¼ <code>â€”â€“BEGIN â€¦â€”â€“</code> å¼€å¤´ï¼Œä»¥ <code>â€”â€“END â€¦â€”â€“</code> ä¸ºç»“å°¾çš„è¿™æ ·çš„æ ¼å¼ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIICXQIBAAKBgQDX+VXh+9zZBC3jRLcLyGGygb/vuiQj13x9ElH9pQmUg29UJ0q1</span><br><span class="line">hcSFuoKmt4id8jyj82fI2PMISzoGucqQFm9HXIV65UcgeUx7REDhgZOBmSCWZ2lW</span><br><span class="line">e2Fnf/htyiy9YVEN4jL7H+b67cIcEDHgYZLtPvSZgyr0UyOMC+E40kTcnQIDAQAB</span><br><span class="line">AoGBAKKsYD7l6VPgrPuY31LVrJi62ComB2Cjx1WhffZR3+RoF2vImNtkB0E+2Xff</span><br><span class="line">l9x3/6ry1IMove3KTzadrHBZJZi1Y6lmHE95uv0O4p16ETnqvKzO8MkcH3qVQe1Z</span><br><span class="line">EyNd/wXr4A8DW3ZlNP/QIPOgzK949yTiP53wapiRwExEf7nhAkEA7CbbdoslRzhQ</span><br><span class="line">9YY1Sdbmc7NHpZdKhkgZwOVJZBoRwfHtSnFcpQUlOzLGCOxP+tGn5mpzhmpDFeUR</span><br><span class="line">bv7mgaQvtQJBAOogUtiJbffk0p3uu7r5nCBmC6BqbG8yVqBVk+r/gS5iHBeBQVyp</span><br><span class="line">FGYYLPQ9daHWluNku07MhqarPcXytEk7ekkCQDBjofK/fmsCkixNTNwNiflJUiVO</span><br><span class="line">W/n6CjTphslZQhIGNb5cTkSOMlvYApZPffACR+pCA9wWKBrzbkgVOTx1XUUCQQDE</span><br><span class="line">KJLg47wkLy6brhLss6ewqW7iV3hEfhuAOFM3WB1mvEKnGt+lf/AcXfMEK54sGzvO</span><br><span class="line">h2475jaG3ABkoiWVGeUpAkAgckc/Pf7KVRF/mDVruMJBbJLYL4H4s78nssFQ4d9V</span><br><span class="line">yXKsIM/AHUxZ5ZKiC7vtEtaGrTLAiuIuQZzBgGpSHX/e</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure><p>ä»¥ä¸‹æ˜¯è¯ä¹¦æ–‡ä»¶åç§°ï¼Œæ¥è‡ªç»´åŸºç™¾ç§‘ <a href="https://zh.wikipedia.org/wiki/X.509">X.509</a> çš„æˆªå›¾ã€‚<br><img src="/upload/images/2019/05/11/1.jpg"></p><hr><p><strong>è¦å§‹ç»ˆä¿æŒå­¦ä¹ çš„æ¿€æƒ…~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> MacOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RSA OpenSSL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cå‡½æ•°ä¸­è¿”å›å­—ç¬¦æ•°ç»„</title>
      <link href="/2019/05/10/C%E5%87%BD%E6%95%B0%E4%B8%AD%E8%BF%94%E5%9B%9E%E5%AD%97%E7%AC%A6%E6%95%B0%E7%BB%84/"/>
      <url>/2019/05/10/C%E5%87%BD%E6%95%B0%E4%B8%AD%E8%BF%94%E5%9B%9E%E5%AD%97%E7%AC%A6%E6%95%B0%E7%BB%84/</url>
      
        <content type="html"><![CDATA[<h2 id="å†…å®¹ç®€ä»‹"><a href="#å†…å®¹ç®€ä»‹" class="headerlink" title="å†…å®¹ç®€ä»‹"></a>å†…å®¹ç®€ä»‹</h2><p>åœ¨é˜…è¯»æœ¬ç¯‡æ–‡ç« ä¹‹å‰ï¼Œå»ºè®®å¤§å®¶çœ‹ä¸€ä¸‹ä¸‹é¢2ç¯‡æ–‡ç« ï¼š</p><ul><li><a href="http://www.veryitman.com/2019/03/07/%E4%B8%8D%E8%A7%81%E5%BE%97%E4%BD%A0%E4%BC%9A%E8%AE%A1%E7%AE%97C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%95%BF%E5%BA%A6/">ä¸è§å¾—ä½ ä¼šè®¡ç®—Cå­—ç¬¦ä¸²é•¿åº¦</a></li><li><a href="http://www.veryitman.com/2019/05/02/%E5%8F%8C%E5%AE%BF%E5%8F%8C%E9%A3%9E%E7%9A%84-malloc-%E5%92%8C-free/">åŒå®¿åŒé£çš„ malloc å’Œ free</a></li></ul><p>è¿™ç¯‡æ–‡ç« ä¸»è¦åˆ†äº«ä¸‰ä¸ªç‚¹ï¼š</p><p>1ã€ä¸ºä»€ä¹ˆä½œä¸ºå±€éƒ¨å˜é‡çš„å­—ç¬¦æ•°ç»„ä¸èƒ½ç›´æ¥è¿”å›ï¼Œè€Œå­—ç¬¦æŒ‡é’ˆå´å¯ä»¥?</p><p>2ã€å½“å­—ç¬¦æ•°ç»„æ˜¯å±€éƒ¨å˜é‡çš„æ—¶å€™ï¼Œå‡½æ•°å¦‚ä½•è¿”å›å®ƒï¼Ÿ</p><p>3ã€å­—ç¬¦æ•°ç»„(char [])å’Œå­—ç¬¦æŒ‡é’ˆ(char *)å¦‚ä½•äº’è½¬ï¼Ÿ</p><h2 id="å±€éƒ¨å˜é‡çš„å­—ç¬¦æ•°ç»„"><a href="#å±€éƒ¨å˜é‡çš„å­—ç¬¦æ•°ç»„" class="headerlink" title="å±€éƒ¨å˜é‡çš„å­—ç¬¦æ•°ç»„"></a>å±€éƒ¨å˜é‡çš„å­—ç¬¦æ•°ç»„</h2><p>åœ¨Cä¸­å¦‚æœæˆ‘ä»¬ç›´æ¥è¿”å›å­—ç¬¦æ•°ç»„ï¼Œç¼–è¯‘ä¼šç›´æ¥æŠ¥è­¦å‘Šã€‚å¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> * <span class="title function_">fork_user_name</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> name[] = <span class="string">&quot;veryitman&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨Xcodeä¸­ç¼–è¯‘è­¦å‘Šä¿¡æ¯æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Address of stack memory associated with local variable &#x27;name&#x27; returned</span><br></pre></td></tr></table></figure><p>åœ¨Linuxä¸Šé¢GCCç¼–è¯‘æ˜¾ç¤ºè­¦å‘Šæ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">warning: function returns address of local variable [-Wreturn-local-addr]</span><br></pre></td></tr></table></figure><p>æ— è®ºå“ªç§è­¦å‘Šä¿¡æ¯ï¼ŒåŸºæœ¬æ„æ€éƒ½æ˜¯å‘Šè¯‰æˆ‘ä»¬ä¸åº”è¯¥è¿”å›ä¸€ä¸ªå±€éƒ¨å˜é‡ <code>name</code> çš„åœ°å€ï¼ˆå‡½æ•°å†…éƒ¨çš„å˜é‡åœ¨æ ˆå†…å­˜ä¸Šï¼‰ã€‚</p><p>å¦‚æœæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹ä»£ç ï¼Œå°† <code>char</code> æ”¹ä¸ºæŒ‡é’ˆå˜é‡ <code>char *</code> ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> * <span class="title function_">fork_user_name2</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *name = <span class="string">&quot;veryitman&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ— è®ºæ˜¯Linuxçš„GCCè¿˜æ˜¯Xcodeçš„Clangç¼–è¯‘å™¨éƒ½ä¸ä¼šæŠ¥å‡ºè­¦å‘Šã€‚</p><p>é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“ï¼Œå¸¸é‡æ˜¯æ”¾åœ¨æ•°æ®æ®µé‡Œé¢çš„ã€‚</p><p>è¿™é‡Œæ¯”è¾ƒç‰¹æ®Šï¼Œå±€éƒ¨å˜é‡ <code>name</code> ä¿å­˜åœ¨æ ˆä¸­ï¼Œä½†æ˜¯å­—ç¬¦ä¸² <code>veryitman</code> çš„å€¼æ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œä¿å­˜åœ¨å¸¸é‡åŒºã€‚å³ä¾¿å‡½æ•°è¿”å›äº†ï¼Œæ•°æ®æ®µé‡Œé¢çš„å¸¸é‡æ•°æ®ä¹Ÿè¿˜ä¸ä¼šæ¶ˆäº¡ï¼Œå®ƒä¼šç›´åˆ°ç¨‹åºç»“æŸæ‰ä¼šæ¶ˆå¤±ï¼Œå…¶å†…å­˜ç©ºé—´ç›´åˆ°ç¨‹åºè¿è¡Œç»“æŸæ‰ä¼šè¢«é‡Šæ”¾ã€‚ æ‰€ä»¥ï¼Œè¿”å›çš„åœ°å€æ˜¯ä¸€ä¸ªå®é™…å­˜åœ¨çš„æœ‰æ•ˆåœ°å€ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> * <span class="title function_">fork_user_name</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> name[] = <span class="string">&quot;veryitman&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> * <span class="title function_">fork_user_name2</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *name = <span class="string">&quot;veryitman&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;fork_user_name: %s\n&quot;</span>, fork_user_name());</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;fork_user_name2: %s\n&quot;</span>, fork_user_name2());</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨GCCç¼–è¯‘ã€è¿è¡Œåçš„æ‰“å°ç»“æœï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fork_user_name: (null)</span><br><span class="line">fork_user_name2: veryitman</span><br></pre></td></tr></table></figure><p>æ€»ä¹‹ï¼Œåœ¨å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡åªè¦æ˜¯è¿”å›ç±»ä¼¼ <code>int[]</code>ã€<code>char[]</code>ã€<code>long[]</code> åœ°å€çš„ï¼Œéƒ½æ˜¯ä¸æ­£ç¡®çš„åšæ³•ã€‚</p><h2 id="ä¸€åˆ‡çš†æœ‰å¯èƒ½"><a href="#ä¸€åˆ‡çš†æœ‰å¯èƒ½" class="headerlink" title="ä¸€åˆ‡çš†æœ‰å¯èƒ½"></a>ä¸€åˆ‡çš†æœ‰å¯èƒ½</h2><p>ä¸‹é¢ä¾‹å­æ˜¯ä¸æ­£ç¡®çš„ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> * <span class="title function_">v_string</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> rest[<span class="number">10</span>] = &#123;<span class="string">&#x27;\0&#x27;</span>&#125;;</span><br><span class="line">    <span class="keyword">return</span> rest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>1ã€ä½¿ç”¨ static</strong></p><p>åœ¨Cè¯­è¨€ä¸­ï¼Œç”¨ <code>static</code> é™å®šå¤–éƒ¨å˜é‡ä¸å‡½æ•°ï¼Œè¯¥å¤–éƒ¨å˜é‡æˆ–è€…å‡½æ•°é™¤äº†å¯¹è¯¥æ‰€åœ¨çš„æ–‡ä»¶å¯è§å¤–ï¼Œå…¶ä»–æ–‡ä»¶éƒ½æ— æ³•è®¿é—®ã€‚ è€Œç”¨ <code>static</code> å£°æ˜å†…éƒ¨å˜é‡ï¼Œåˆ™è¯¥å˜é‡æ˜¯æŸä¸ªç‰¹å®šå‡½æ•°çš„å±€éƒ¨å˜é‡ï¼Œåªèƒ½åœ¨è¯¥å‡½æ•°ä¸­ä½¿ç”¨ã€‚ä½†å®ƒä¸è‡ªåŠ¨å˜é‡ä¸åŒçš„æ˜¯ï¼Œä¸ç®¡å…¶æ‰€åœ¨å‡½æ•°æ˜¯å¦è¢«è°ƒç”¨ï¼Œå®ƒä¸€ç›´å­˜åœ¨ï¼Œè€Œä¸åƒè‡ªåŠ¨å˜é‡é‚£æ ·ï¼Œéšç€æ‰€åœ¨å‡½æ•°çš„è¢«è°ƒç”¨å’Œé€€å‡ºè€Œå­˜åœ¨å’Œæ¶ˆå¤±ã€‚æ¢å¥è¯è¯´ï¼Œ<code>static</code> ç±»å‹çš„å†…éƒ¨å˜é‡æ˜¯ä¸€ç§åªèƒ½åœ¨æŸä¸ªç‰¹å®šå‡½æ•°ä¸­ä½¿ç”¨ä½†ä¸€ç›´å æ®å­˜å‚¨ç©ºé—´çš„å˜é‡ã€‚</p><p>æ‰€ä»¥ä½¿ç”¨staticä¿®é¥°ä¸€ä¸‹ï¼Œå°±æ²¡æœ‰é—®é¢˜äº†ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> * <span class="title function_">v_string</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">char</span> rest[<span class="number">10</span>] = &#123;<span class="string">&#x27;\0&#x27;</span>&#125;;</span><br><span class="line">    <span class="keyword">return</span> rest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2ã€ä½¿ç”¨ malloc</strong></p><p>è¿™ç§æ–¹å¼å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ˜¯å› ä¸ºä½¿ç”¨ <code>malloc</code> åˆ†é…çš„å†…å­˜æ˜¯åœ¨å †ä¸Šè€Œä¸æ˜¯åœ¨æ ˆå†…å­˜ä¸Šé¢ã€‚ä½†æ˜¯è¦è®°å¾—å°†å…¶åœ¨è°ƒç”¨æ–¹ä½¿ç”¨ <code>free</code> é‡Šæ”¾ç”³è¯·çš„å†…å­˜ç©ºé—´ï¼Œå¦åˆ™å®¹æ˜“é€ æˆå†…å­˜æ³„æ¼é—®é¢˜ã€‚</p><p>å…·ä½“å¯ä»¥çœ‹çœ‹ <a href="%5Bhttp://www.veryitman.com/2019/05/02/%E5%8F%8C%E5%AE%BF%E5%8F%8C%E9%A3%9E%E7%9A%84-malloc-%E5%92%8C-free/%5D(http://www.veryitman.com/2019/05/02/%E5%8F%8C%E5%AE%BF%E5%8F%8C%E9%A3%9E%E7%9A%84-malloc-%E5%92%8C-free/)">åŒå®¿åŒé£çš„ malloc å’Œ free</a> è¿™ç¯‡æ–‡ç« ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> * <span class="title function_">v_string</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *p = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">10</span> * <span class="keyword">sizeof</span>(<span class="type">char</span>));</span><br><span class="line">    p = <span class="string">&quot;\0&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>3ã€å…¨å±€å˜é‡</strong></p><p>è¿™ä¸ªå¾ˆå¥½ç†è§£ã€‚å…¨å±€å˜é‡åœ¨ç¨‹åºçœŸä¸ªç”Ÿå‘½å‘¨æœŸä¸­éƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œæ‰€ä»¥ä½¿ç”¨å…¨å±€å˜é‡ä¹Ÿå¯ä»¥è§£å†³ç±»ä¼¼é—®é¢˜ã€‚</p><p>ä½†æ˜¯è¿™ç§æ–¹æ¡ˆå°±ä¼šè®©è¿™ä¸ªå°è£…çš„æ–¹æ³•ä¸å¤Ÿå†…èšï¼Œå› ä¸ºå®ƒä¾èµ–äº†å…¨å±€å˜é‡ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> g_rest[<span class="number">100</span>];</span><br><span class="line"><span class="type">char</span> * <span class="title function_">v_string</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">strcpy</span>(g_rest, <span class="string">&quot;verytiamn&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> g_rest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>4ã€è¿”å›å½¢å‚æŒ‡é’ˆå˜é‡</strong></p><p>åœ¨Linux Kernel(å†…æ ¸æºç ç‰ˆæœ¬5.0.7)ä¸­ï¼Œå‡½æ•° <code>strcpy</code> çš„å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __HAVE_ARCH_STRCPY</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * strcpy - Copy a %NUL terminated string</span></span><br><span class="line"><span class="comment"> * @dest: Where to copy the string to</span></span><br><span class="line"><span class="comment"> * @src: Where to copy the string from</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> strcpy</span></span><br><span class="line"><span class="type">char</span> *<span class="title function_">strcpy</span><span class="params">(<span class="type">char</span> *dest, <span class="type">const</span> <span class="type">char</span> *src)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">char</span> *tmp = dest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> ((*dest++ = *src++) != <span class="string">&#x27;\0&#x27;</span>)</span><br><span class="line"><span class="comment">/* nothing */</span>;</span><br><span class="line"><span class="keyword">return</span> tmp;</span><br><span class="line">&#125;</span><br><span class="line">EXPORT_SYMBOL(<span class="built_in">strcpy</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>å‚è€ƒå†…æ ¸å®ç°ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹ä¸€ä¸‹è‡ªå·±çš„ä»£ç ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> * <span class="title function_">v_string</span><span class="params">(<span class="type">char</span> *s1, <span class="type">char</span> *s2)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *tmp = s1;</span><br><span class="line">    <span class="comment">// çœç•¥...</span></span><br><span class="line">    <span class="keyword">return</span> tmp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¡¥å……å¦å¤–ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œå‡½æ•° <code>strcpy</code> åœ¨glibcå’ŒLinux Kernelä¸­å®ç°ä¸ä¸€æ ·ã€‚</p><p>åœ¨glibcçš„æ–°ç‰ˆä¸­(2.29ç‰ˆæœ¬)ï¼Œæœ¬è´¨æ˜¯è°ƒç”¨äº†å‡½æ•° <code>memcpy</code>ï¼Œ å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stddef.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> strcpy</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> STRCPY</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> STRCPY strcpy</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Copy SRC to DEST.  */</span></span><br><span class="line"><span class="type">char</span> * <span class="title function_">STRCPY</span> <span class="params">(<span class="type">char</span> *dest, <span class="type">const</span> <span class="type">char</span> *src)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">memcpy</span> (dest, src, <span class="built_in">strlen</span> (src) + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">libc_hidden_builtin_def (<span class="built_in">strcpy</span>)</span><br></pre></td></tr></table></figure><p>åŒ…æ‹¬ <code>strncpy</code> åœ¨glibcå’ŒLinux Kernelä¸­å®ç°ä¹Ÿä¸ä¸€æ ·ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å»çœ‹çœ‹æºç ã€‚</p><h2 id="å­—ç¬¦æ•°ç»„å’Œå­—ç¬¦æŒ‡é’ˆçš„äº’è½¬"><a href="#å­—ç¬¦æ•°ç»„å’Œå­—ç¬¦æŒ‡é’ˆçš„äº’è½¬" class="headerlink" title="å­—ç¬¦æ•°ç»„å’Œå­—ç¬¦æŒ‡é’ˆçš„äº’è½¬"></a>å­—ç¬¦æ•°ç»„å’Œå­—ç¬¦æŒ‡é’ˆçš„äº’è½¬</h2><h3 id="char-è½¬-char"><a href="#char-è½¬-char" class="headerlink" title="char [] è½¬ char *"></a>char [] è½¬ char *</h3><p>è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œèµ‹å€¼ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">char</span> c_str_array[] = <span class="string">&quot;veryitman.com&quot;</span>;</span><br><span class="line">    <span class="type">char</span> *p_str;</span><br><span class="line">    p_str = c_str_array;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;p_str: %s\n&quot;</span>, p_str);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="char-è½¬-char-1"><a href="#char-è½¬-char-1" class="headerlink" title="char * è½¬ char []"></a>char * è½¬ char []</h3><p>æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥ç›´æ¥è¿›è¡Œèµ‹å€¼å‘¢ï¼Ÿæ’¸æ®µä»£ç çœ‹çœ‹ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">char</span> c_str_array[] = <span class="string">&quot;veryitman.com&quot;</span>;</span><br><span class="line">    <span class="type">char</span> *p_str = <span class="string">&quot;veryitman.com&quot;</span>;</span><br><span class="line">    c_str_array = p_str;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;c_str_array: %s\n&quot;</span>, c_str_array);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾ˆé—æ†¾ï¼Œç¼–è¯‘æŠ¥é”™ï¼ŒGCCç¼–è¯‘é”™è¯¯æˆªå›¾å¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/05/10/1.png" alt="1557417012236"></p><p>Clangç¼–è¯‘é”™è¯¯å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Array type &#x27;char [14]&#x27; is not assignable</span><br></pre></td></tr></table></figure><p>å¯ä»¥è€ƒè™‘ä½¿ç”¨ <code>strncpy</code> æ¥å®ç°ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> c_str_array[] = <span class="string">&quot;veryitman.com&quot;</span>;</span><br><span class="line">    <span class="type">char</span> *p_str = <span class="string">&quot;veryitman.com&quot;</span>;</span><br><span class="line">    <span class="built_in">strncpy</span>(c_str_array, p_str, <span class="built_in">strlen</span>(p_str));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;c_str_array: %s\n&quot;</span>, c_str_array);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ—¶é—´å¯ä»¥æ”¹å˜ä¸€åˆ‡ï¼Œä½†ä½ å¾—åšç‚¹ä»€ä¹ˆï¼</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> strcpy char[] </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŒå®¿åŒé£çš„ malloc å’Œ free</title>
      <link href="/2019/05/02/%E5%8F%8C%E5%AE%BF%E5%8F%8C%E9%A3%9E%E7%9A%84-malloc-%E5%92%8C-free/"/>
      <url>/2019/05/02/%E5%8F%8C%E5%AE%BF%E5%8F%8C%E9%A3%9E%E7%9A%84-malloc-%E5%92%8C-free/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><hr><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>å‡½æ•° <code>malloc</code> å’Œ <code>free</code> æ˜¯ä¸€å¯¹å¥½æœ‹å‹ï¼Œå‡ ä¹æ˜¯å½¢å½±ä¸ç¦»ã€‚æœ‰ <code>malloc</code> çš„åœ°æ–¹å°±åº”è¯¥æœ‰ <code>free</code> çš„å­˜åœ¨ã€‚</p><p>ä»Šå¤©è·Ÿå¤§å®¶èŠèŠ <code>malloc</code> å’Œ <code>free</code> è¿™å¯¹å¥½åŸºå‹ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯å¯¹å †å†…å­˜è¿›è¡Œç®¡ç†çš„å‡½æ•°ï¼Œå¦å¤–è¿˜æœ‰ <code>calloc</code>ã€<code>realloc</code>ã€<code>reallocf</code>ã€<code>valloc</code> ç­‰å †å†…å­˜ç®¡ç†å‡½æ•°ã€‚</p><h2 id="void"><a href="#void" class="headerlink" title="void *"></a>void *</h2><p>åœ¨è¿›è¡Œä¸‹é¢è¯é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå›å¿†ä¸€ä¸‹ <code>void *</code> æ˜¯ä»€ä¹ˆï¼Ÿ</p><p><code>void *</code> è¡¨ç¤ºæœªç¡®å®šç±»å‹çš„æŒ‡é’ˆã€‚C&#x2F;C++è§„å®šï¼Œ<code>void *</code> ç±»å‹å¯ä»¥å¼ºåˆ¶è½¬æ¢ä¸ºä»»ä½•å…¶å®ƒç±»å‹çš„æŒ‡é’ˆã€‚</p><p><code>void *</code> ä¹Ÿè¢«ç§°ä¹‹ä¸ºæ— ç±»å‹æŒ‡é’ˆï¼Œ<code>void *</code> å¯ä»¥æŒ‡å‘ä»»æ„ç±»å‹çš„æ•°æ®ï¼Œå°±æ˜¯è¯´å¯ä»¥ç”¨ä»»æ„ç±»å‹çš„æŒ‡é’ˆå¯¹ <code>void *</code> èµ‹å€¼ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> *p1;</span><br><span class="line"><span class="type">int</span> *p2;</span><br><span class="line">p1 = p2;</span><br></pre></td></tr></table></figure><p>ä½†ä¸€èˆ¬ä¸ä¼šåè¿‡æ¥ä½¿ç”¨ï¼Œå¦‚ä¸‹ç¤ºä¾‹åœ¨æœ‰äº›ç¼–è¯‘å™¨ä¸Šé¢å¯ä»¥ç¼–è¯‘é€šè¿‡ï¼Œæœ‰äº›å°±ä¸è¡Œï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> *p1;</span><br><span class="line"><span class="type">int</span> *p2;</span><br><span class="line">p2 = p1;</span><br></pre></td></tr></table></figure><p>å¯ä»¥ä¿®æ”¹ä¸€ä¸‹ä»£ç ï¼Œå°† <code>void *</code> è½¬æ¢ä¸ºå¯¹åº”çš„æŒ‡é’ˆç±»å‹å†è¿›è¡Œèµ‹å€¼ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> *p1;</span><br><span class="line"><span class="type">int</span> *p2;</span><br><span class="line">p2 = (<span class="type">char</span> *)p1;</span><br></pre></td></tr></table></figure><p>ç”±äº GNU å’Œ ANSI å¯¹ <code>void *</code> ç±»å‹æŒ‡é’ˆå‚ä¸è¿ç®—çš„è§„å®šä¸ä¸€æ ·ï¼Œæ‰€ä»¥ä¸ºäº†å…¼å®¹äºŒè€…å¹¶ä¸”è®©ç¨‹åºæœ‰æ›´å¥½çš„å…¼å®¹æ€§ï¼Œæœ€å¥½è¿˜æ˜¯å°† <code>void *</code> è½¬æ¢ä¸ºæœ‰æ˜ç¡®ç±»å‹çš„æŒ‡é’ˆå†å‚ä¸è¿ç®—ï¼Œå¦‚ä¸‹ç¤ºä¾‹ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> *pd;</span><br><span class="line"><span class="type">char</span> *pc = (<span class="type">char</span> *)pd;</span><br><span class="line">pc ++;</span><br><span class="line">pc += <span class="number">1</span>;</span><br></pre></td></tr></table></figure><h2 id="malloc"><a href="#malloc" class="headerlink" title="malloc"></a>malloc</h2><p>å‡½æ•°åŸå‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> * <span class="title function_">malloc</span><span class="params">(<span class="type">size_t</span> size)</span>;</span><br></pre></td></tr></table></figure><p><code>malloc</code> å‘ç³»ç»Ÿç”³è¯·åˆ†é…æŒ‡å®š <code>size</code> ä¸ªå­—èŠ‚çš„å†…å­˜ç©ºé—´ï¼Œå³ <code>malloc</code> å‡½æ•°ç”¨æ¥ä»å †ç©ºé—´ä¸­ç”³è¯·æŒ‡å®šçš„ <code>size</code> ä¸ªå­—èŠ‚çš„å†…å­˜å¤§å°ï¼Œè¿”å›ç±»å‹æ˜¯ <code>void *</code> ç±»å‹ï¼Œå¦‚æœæˆåŠŸï¼Œå°±ä¼šè¿”å›æŒ‡å‘ç”³è¯·åˆ†é…çš„å†…å­˜ï¼Œå¦åˆ™è¿”å›ç©ºæŒ‡é’ˆï¼Œæ‰€ä»¥ <code>malloc</code> ä¸ä¿è¯ä¸€å®šæˆåŠŸã€‚</p><p>æŸ¥çœ‹å‡½æ•°æ‰‹å†Œæˆ–è€…ç›´æ¥åœ¨Linuxã€macOSç­‰Unixç³»ç»Ÿä¸Šé¢ç›´æ¥ <code>man malloc</code> ä¼šæ˜¾ç¤ºå¯¹åº”çš„å‡½æ•°ä¿¡æ¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">The malloc() function allocates size bytes of memory and returns a pointer to the allocated memory.</span><br><span class="line"></span><br><span class="line">If successful, malloc() function return a pointer to allocated memory.  </span><br><span class="line">If there is an error, they return a NULL pointer and set errno to ENOMEM.</span><br></pre></td></tr></table></figure><p>å¦å¤–éœ€è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼Œä½¿ç”¨ <code>malloc</code> å‡½æ•°åˆ†é…å†…å­˜ç©ºé—´æˆåŠŸåï¼Œ<code>malloc</code> ä¸ä¼šå¯¹æ•°æ®è¿›è¡Œåˆå§‹åŒ–ï¼Œé‡Œè¾¹æ•°æ®æ˜¯éšæœºçš„åƒåœ¾æ•°æ®ï¼Œæ‰€ä»¥ä¸€èˆ¬ç»“åˆ <code>memset</code> å‡½æ•°å’Œ <code>malloc</code> å‡½æ•° ä¸€èµ·ä½¿ç”¨ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> *arr;</span><br><span class="line">arr = (<span class="type">int</span> *)<span class="built_in">malloc</span>(<span class="number">10</span> * <span class="keyword">sizeof</span>(<span class="type">int</span>));</span><br><span class="line"><span class="keyword">if</span> (<span class="literal">NULL</span> != arr) &#123;</span><br><span class="line">    <span class="built_in">memset</span>(arr, <span class="number">0</span>, <span class="number">10</span> * <span class="keyword">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;arr: %p\n&quot;</span>, arr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *arr;</span><br><span class="line">arr = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">10</span> * <span class="keyword">sizeof</span>(<span class="type">char</span>));</span><br><span class="line"><span class="keyword">if</span> (<span class="literal">NULL</span> != arr) &#123;</span><br><span class="line">    <span class="built_in">memset</span>(arr, <span class="string">&#x27;\0&#x27;</span>, <span class="number">10</span> * <span class="keyword">sizeof</span>(<span class="type">char</span>));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;arr string: %s\n&quot;</span>, arr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†å®‰å…¨èµ·è§ï¼Œå»ºè®®å¯ä»¥è€ƒè™‘ä½¿ç”¨ <code>calloc()</code> å‡½æ•°ï¼Œåé¢ä¼šæåˆ°å®ƒã€‚</p><p>å‡½æ•° <code>free</code>ã€<code>malloc</code>ã€<code>calloc()</code> éƒ½è¢«åŒ…å«åœ¨ <code>stdlib.h</code> å¤´æ–‡ä»¶ä¸­ï¼Œå½“ç„¶äº† <code>malloc.h</code> å¤´æ–‡ä»¶ä¹Ÿæœ‰å¯¹åº”çš„å‡½æ•°å£°æ˜ï¼Œå®ç°åœ¨ <code>malloc.c</code> æ–‡ä»¶ä¸­ã€‚</p><p>å…³äº <code>malloc</code> å‡½æ•°ä¸­çš„ <code>size</code> å‚æ•°åŠ¡å¿…è¦å¤§äºæŒ‡é’ˆæœ¬èº«çš„æ•°å€¼ï¼Œåœ¨32ä½æ“ä½œç³»ç»Ÿä¸Šï¼ŒæŒ‡é’ˆå ç”¨4å­—èŠ‚çš„å¤§å°ï¼›åœ¨64ä½æ“ä½œç³»ç»Ÿä¸Šï¼ŒæŒ‡é’ˆå ç”¨8å­—èŠ‚çš„å¤§å°ã€‚</p><h2 id="free"><a href="#free" class="headerlink" title="free"></a>free</h2><p>å‡½æ•°åŸå‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">free</span><span class="params">(<span class="type">void</span> *ptr)</span>;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çŸ¥é“åœ¨ C è¯­è¨€ä¸­ï¼Œ å †ä¸Šçš„å†…å­˜ç©ºé—´ä¸ä¼šè‡ªåŠ¨é‡Šæ”¾ï¼ˆJava æœ‰è‡ªåŠ¨å›æ”¶æœºåˆ¶ï¼Œè€Œ C è¯­è¨€æ²¡æœ‰ï¼‰ï¼Œç›´åˆ°è°ƒç”¨ <code>free</code> å‡½æ•°ï¼Œæ‰ä¼šé‡Šæ”¾å †ä¸Šçš„å­˜å‚¨ç©ºé—´ï¼Œå³ <code>free</code> å‡½æ•°ä¼šé‡Šæ”¾æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜åˆ†é…ç©ºé—´ã€‚</p><p>ä¸‹é¢æ˜¯å‡½æ•°æ‰‹å†ŒæŸ¥åˆ°å…³äº <code>free</code> å‡½æ•°çš„èµ„æ–™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">The free() function deallocates the memory allocation pointed to by ptr.</span><br><span class="line">If ptr is a NULL pointer, no operation is performed.</span><br></pre></td></tr></table></figure><p>å¯¹äº <code>free</code> å‡½æ•°æˆ‘ä»¬è¦èµ°å‡ºä¸€ä¸ªè¯¯åŒºï¼Œä¸è¦ä»¥ä¸ºè°ƒç”¨äº† <code>free</code> å‡½æ•°ï¼Œå˜é‡å°±å˜ä¸º <code>NULL</code> å€¼äº†ã€‚æœ¬è´¨æ˜¯ <code>free</code> å‡½æ•°åªæ˜¯å‰²æ–­äº†æŒ‡é’ˆæ‰€æŒ‡çš„ç”³è¯·çš„é‚£å—å†…å­˜ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶æ²¡æœ‰æ”¹å˜æ‰€æŒ‡çš„åœ°å€ï¼ˆæœ¬èº«ä¿å­˜çš„åœ°å€å¹¶æ²¡æœ‰æ”¹å˜ï¼‰ã€‚å¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *pchar = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">10</span> * <span class="keyword">sizeof</span>(<span class="type">char</span>));</span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span> (<span class="literal">NULL</span> != pchar) &#123;</span><br><span class="line">    <span class="built_in">strcpy</span>(pchar, <span class="string">&quot;blog&quot;</span>);</span><br><span class="line">    <span class="comment">/* pcharæ‰€æŒ‡çš„å†…å­˜è¢«é‡Šæ”¾ï¼Œä½†æ˜¯pcharæ‰€æŒ‡çš„åœ°å€ä»ç„¶ä¸å˜ */</span></span><br><span class="line">    <span class="built_in">free</span>(pchar);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* è¯¥åˆ¤æ–­æ²¡æœ‰èµ·åˆ°é˜²é”™ä½œç”¨ï¼Œæ­¤æ—¶ pchar å¹¶ä¸ä¸º NULL */</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">NULL</span> != pchar) &#123;</span><br><span class="line">        <span class="built_in">strcpy</span>(pchar, <span class="string">&quot;it&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;pchar: %s&quot;</span>, pchar);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­£ç¡®ä¸”å®‰å…¨çš„åšæ³•æ˜¯å¯¹æŒ‡é’ˆå˜é‡å…ˆè¿›è¡Œ <code>free</code> ç„¶åå†å°†å…¶å€¼ç½®ä¸º <code>NULL</code>ï¼Œå¦‚ä¸‹ä¸‹é¢ç¤ºä¾‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *pchar = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">10</span> * <span class="keyword">sizeof</span>(<span class="type">char</span>));</span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span> (<span class="literal">NULL</span> != pchar) &#123;</span><br><span class="line">    <span class="built_in">strcpy</span>(pchar, <span class="string">&quot;blog&quot;</span>);</span><br><span class="line">    <span class="comment">/* pcharæ‰€æŒ‡çš„å†…å­˜è¢«é‡Šæ”¾ï¼Œä½†æ˜¯pcharæ‰€æŒ‡çš„åœ°å€ä»ç„¶ä¸å˜ */</span></span><br><span class="line">    <span class="built_in">free</span>(pchar);</span><br><span class="line">    <span class="comment">/* å°†å…¶ç½®ä¸º NULL å€¼ */</span></span><br><span class="line">    pchar = <span class="literal">NULL</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* è¯¥åˆ¤æ–­æ²¡æœ‰èµ·åˆ°é˜²é”™ä½œç”¨ï¼Œæ­¤æ—¶ pchar å¹¶ä¸ä¸º NULL */</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">NULL</span> != pchar) &#123;</span><br><span class="line">        <span class="built_in">strcpy</span>(pchar, <span class="string">&quot;it&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;pchar: %s&quot;</span>, pchar);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡½æ•° <code>free</code> åªèƒ½é‡Šæ”¾allocçš„å†…å­˜ç©ºé—´ï¼Œå¯¹äºå…¶ä»–éallocçš„æŒ‡é’ˆå˜é‡ä½¿ç”¨freeä¼šå‡ºç°é”™è¯¯ï¼Œå¦‚ä¸‹é¢çš„ä¾‹å­ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a = <span class="number">0x2010</span>;</span><br><span class="line"><span class="type">int</span> *p;</span><br><span class="line">p = &amp;a;</span><br><span class="line"><span class="built_in">free</span>(p);</span><br></pre></td></tr></table></figure><p>è¿è¡Œåç›´æ¥è·ªäº†ï¼ŒæŠ¥ç±»ä¼¼ä¸‹é¢çš„é”™è¯¯ä¿¡æ¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pointer being freed was not allocated.</span><br></pre></td></tr></table></figure><p>å¦å¤–ï¼Œå‘Šè¯‰å¤§å®¶ä¸€ä¸ªç§˜å¯†ï¼Œ<code>free</code> ä¸€ä¸ªç©ºæŒ‡é’ˆæ²¡é—®é¢˜ã€‚å¦‚ä¸‹ä¾‹å­ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> *p;</span><br><span class="line">p = <span class="literal">NULL</span>;</span><br><span class="line"><span class="built_in">free</span>(p);</span><br></pre></td></tr></table></figure><p>ä»£ç å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œåœ¨ <code>free</code> å‡½æ•°æºç ä¸ºè¯ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* free(0) has no effect */</span></span><br><span class="line"><span class="keyword">if</span> (mem == <span class="number">0</span>)&#123;</span><br><span class="line"><span class="keyword">return</span>;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œ <code>NULL</code> åœ¨æºç ï¼ˆåœ¨ <code>morecore.c</code> æ–‡ä»¶ä¸­ï¼‰ä¸­å®šä¹‰å°±æ˜¯0ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> NULL</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> NULL 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><h2 id="mallocã€free-å°ç»“"><a href="#mallocã€free-å°ç»“" class="headerlink" title="mallocã€free å°ç»“"></a>mallocã€free å°ç»“</h2><p><strong>1ã€è¿ç»­å†…å­˜å—</strong></p><p><code>malloc</code> å‡½æ•°ç”³è¯·çš„æ˜¯è¿ç»­çš„ä¸€å—å†…å­˜ï¼Œå¦‚æœæ‰€ç”³è¯·çš„å†…å­˜å—å¤§äºç›®å‰å †ä¸Šå‰©ä½™å†…å­˜å—ï¼Œåˆ™å†…å­˜åˆ†é…ä¼šå¤±è´¥ï¼Œå‡½æ•°è¿”å› <code>NULL</code> å€¼ã€‚</p><p><strong>æ³¨æ„ï¼šä¸Šé¢è¯´çš„ <code>å †ä¸Šå‰©ä½™å†…å­˜å—</code> ä¸æ˜¯æ‰€æœ‰å‰©ä½™å†…å­˜å—ä¹‹å’Œï¼Œè€Œæ˜¯è¿ç»­çš„å†…å­˜ã€‚</strong></p><p><strong>2ã€åŒå®¿åŒé£æ‰å¥½</strong></p><p>è°ƒç”¨ <code>malloc</code> å‡½æ•°å¤šä½™ <code>free</code> å‡½æ•°ä¼šå‘ç”Ÿå†…å­˜æ³„æ¼ï¼Œè¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œå› ä¸ºç”³è¯·è¿‡çš„å†…å­˜æ²¡æœ‰è¢«é‡Šæ”¾å®Œã€‚è°ƒç”¨ <code>malloc</code> å‡½æ•°å°‘äº<code>free</code> å‡½æ•°ï¼Œè‚¯å®šä¼šå‡ºé”™ã€‚æ¢å¥è¯è¯´ï¼Œåœ¨ç¨‹åºä¸­ <code>malloc</code> çš„ä½¿ç”¨æ¬¡æ•°åŠ¡å¿…è¦å’Œ <code>free</code> ç›¸ç­‰ï¼Œå¦åˆ™å¿…æœ‰éšæ‚£æˆ–è€…å‘ç”Ÿé”™è¯¯ã€‚</p><p>å¦‚ä¸‹é¢çš„ä¾‹å­ <code>free</code> ä¸¤æ¬¡æŒ‡é’ˆå˜é‡å°±ä¼šåœ¨è¿è¡Œæ—¶æŠ¥é”™ï¼š <code>malloc: *** error for object 0x10071be90: pointer being freed was not allocated</code>ï¼Œä¹Ÿç§°ä¹‹ä¸º <code>double free</code>ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *pchar = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">10</span> * <span class="keyword">sizeof</span>(<span class="type">char</span>));</span><br><span class="line"><span class="built_in">free</span>(pchar);</span><br><span class="line"><span class="built_in">free</span>(pchar);</span><br></pre></td></tr></table></figure><p>å¯¹æŒ‡é’ˆå˜é‡è¿›è¡Œ <code>free</code> ä¹‹åï¼Œä¸€å®šè¦è®°å¾—å¯¹å…¶èµ‹å€¼ä¸º <code>NULL</code>ï¼Œå¦åˆ™è¯¥æŒ‡é’ˆå°±æ˜¯ä¸€ä¸ªé‡æŒ‡é’ˆï¼Œè¿™ä¸ªåœ¨ä¸Šé¢å·²ç»è¯´æ˜ã€‚</p><p><strong>3ã€0å­—èŠ‚çš„å†…å­˜æœ‰æ¯’</strong></p><p>ä½¿ç”¨ <code>malloc</code> å‡½æ•°ä¹Ÿå¯ä»¥ç”³è¯·0å­—èŠ‚çš„å†…å­˜ï¼Œè¯¥å‡½æ•°çš„è¿”å›å€¼å¹¶ä¸æ˜¯ <code>NULL</code>ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ­£å¸¸çš„å†…å­˜åœ°å€ï¼Œæ‰€ä»¥å¦‚æœä½¿ç”¨è¿™ç§æ–¹å¼ç”³è¯·çš„å†…å­˜å¾ˆå±é™©ï¼Œå¦‚ä¸‹é¢çš„ä¾‹å­ï¼ŒæŒ‡é’ˆ <code>pchar</code> æ˜¯ä¸€ä¸ªä½¿ç”¨ <code>malloc</code> å‡½æ•°åˆ›å»ºçš„å ç”¨0å­—èŠ‚çš„å†…å­˜ç©ºé—´çš„ä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼Œ<code>if (NULL == pchar)</code> å¹¶æ²¡æœ‰ç”Ÿæ•ˆï¼Œè€Œæ˜¯æ‰§è¡Œäº† <code>else</code> è¯­å¥ä¸­çš„ä»£ç ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *pchar = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="literal">NULL</span> == pchar) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;malloc 0 byte memory failed.\n&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;malloc 0 byte successfully and pchar: %s.\n&quot;</span>, pchar);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;pchar: %s.\n&quot;</span>, pchar);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸­æ–¹å¼çš„æŒ‡é’ˆç±»ä¼¼äºä¸€ä¸ªé‡æŒ‡é’ˆï¼Œå¯ä»¥ä½¿ç”¨ä½†æœ‰é£é™©ï¼Œä¸çŸ¥é“è¿™ä¸ªæŒ‡é’ˆåé¢çš„å†…å­˜ç©ºé—´è¢«è°ä½¿ç”¨ç€ï¼Œè¦æ˜¯è¢«æ ¸å¿ƒè¿›ç¨‹ä½¿ç”¨ï¼Œä¼šé€ æˆç›¸åº”ç¨‹åºçš„å´©æºƒã€‚</p><p><strong>4ã€è°ƒçš®çš„free</strong></p><p>ä½¿ç”¨éallocæ–¹å¼åˆ›å»ºçš„å†…å­˜ï¼Œä½¿ç”¨ <code>free</code> å‡½æ•°ä¼šæŠ¥é”™ï¼Œè¿™ä¸ªè¦æ³¨æ„ã€‚å¦å¤–ï¼Œ<code>free</code> ç©ºæŒ‡é’ˆæ²¡æœ‰å½±å“ã€‚</p><h2 id="callocã€reallocã€reallocfã€valloc"><a href="#callocã€reallocã€reallocfã€valloc" class="headerlink" title="callocã€reallocã€reallocfã€valloc"></a>callocã€reallocã€reallocfã€valloc</h2><p><strong>1ã€calloc å‡½æ•°</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> * <span class="title function_">calloc</span><span class="params">(<span class="type">size_t</span> count, <span class="type">size_t</span> size)</span>;</span><br></pre></td></tr></table></figure><p>åœ¨å †ä¸Šï¼Œåˆ†é… <code>n*size</code> ä¸ªå­—èŠ‚ï¼Œå¹¶åˆå§‹åŒ–ä¸º0ï¼Œè¿”å› <code>void *</code>ç±»å‹ï¼Œè¿”å›å€¼æƒ…å†µè·Ÿ <code>malloc</code> ä¸€è‡´ã€‚</p><p>å‡½æ•° <code>malloc()</code> å’Œå‡½æ•° <code>calloc()</code> çš„ä¸»è¦åŒºåˆ«æ˜¯å‰è€…ä¸èƒ½åˆå§‹åŒ–æ‰€åˆ†é…çš„å†…å­˜ç©ºé—´ï¼Œè€Œåè€…èƒ½ã€‚å¦‚æœç”± <code>malloc()</code> å‡½æ•°åˆ†é…çš„å†…å­˜ç©ºé—´åŸæ¥æ²¡æœ‰è¢«ä½¿ç”¨è¿‡ï¼Œåˆ™å…¶ä¸­çš„æ¯ä¸€ä½å¯èƒ½éƒ½æ˜¯0ï¼›åä¹‹ï¼Œå¦‚æœè¿™éƒ¨åˆ†å†…å­˜æ›¾ç»è¢«åˆ†é…è¿‡ï¼Œåˆ™å…¶ä¸­å¯èƒ½é—ç•™æœ‰å„ç§å„æ ·çš„æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨ <code>malloc()</code> å‡½æ•°çš„ç¨‹åºå¼€å§‹æ—¶(å†…å­˜ç©ºé—´è¿˜æ²¡æœ‰è¢«é‡æ–°åˆ†é…)èƒ½æ­£å¸¸è¿›è¡Œï¼Œä½†ç»è¿‡ä¸€æ®µæ—¶é—´(å†…å­˜ç©ºé—´è¿˜å·²ç»è¢«é‡æ–°åˆ†é…)å¯èƒ½ä¼šå‡ºç°é—®é¢˜ã€‚ </p><p>å‡½æ•° <code>calloc()</code> ä¼šå°†æ‰€åˆ†é…çš„å†…å­˜ç©ºé—´ä¸­çš„æ¯ä¸€ä½éƒ½åˆå§‹åŒ–ä¸ºé›¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ æ˜¯ä¸ºå­—ç¬¦ç±»å‹æˆ–æ•´æ•°ç±»å‹çš„å…ƒç´ åˆ†é…å†…å­˜ï¼Œé‚£ä¹ˆè¿™äº›å…ƒç´ å°†ä¿è¯ä¼šè¢«åˆå§‹åŒ–ä¸º0ï¼›å¦‚æœä½ æ˜¯ä¸ºæŒ‡é’ˆç±»å‹çš„å…ƒç´ åˆ†é…å†…å­˜ï¼Œé‚£ä¹ˆè¿™äº›å…ƒç´ é€šå¸¸ä¼šè¢«åˆå§‹åŒ–ä¸ºç©ºæŒ‡é’ˆï¼›å¦‚æœä½ ä¸ºå®å‹æ•°æ®åˆ†é…å†…å­˜ï¼Œåˆ™è¿™äº›å…ƒç´ ä¼šè¢«åˆå§‹åŒ–ä¸ºæµ®ç‚¹å‹çš„é›¶ã€‚ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">The calloc() function contiguously allocates enough space for count objects that are size bytes of memory each and returns a pointer to the allocated memory.</span><br><span class="line"></span><br><span class="line">The allocated memory is filled with bytes of value zero.</span><br></pre></td></tr></table></figure><p><strong>2ã€realloc() å‡½æ•°</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> * <span class="title function_">realloc</span><span class="params">(<span class="type">void</span> *ptr, <span class="type">size_t</span> size)</span>;</span><br></pre></td></tr></table></figure><p><code>realloc()</code> ä¼šå°† <code>ptr</code> æ‰€æŒ‡å‘çš„å†…å­˜å—çš„å¤§å°ä¿®æ”¹ä¸º <code>size</code>ï¼Œå¹¶å°†æ–°çš„å†…å­˜æŒ‡é’ˆè¿”å›ã€‚å‡è®¾ä¹‹å‰å†…å­˜å—çš„å¤§å°ä¸º nï¼Œå¦‚æœ size &lt;&#x3D; nï¼Œé‚£ä¹ˆæˆªå–çš„å†…å®¹ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå¦‚æœ size &gt; nï¼Œé‚£ä¹ˆæ–°åˆ†é…çš„å†…å­˜ä¸ä¼šè¢«åˆå§‹åŒ–ã€‚</p><p>å¯¹äºä¸Šé¢è¯´çš„æ–°çš„å†…å­˜æŒ‡é’ˆåœ°å€å¯èƒ½å˜ä¹Ÿå¯èƒ½ä¸å˜ï¼Œå‡å¦‚åŸæ¥allocçš„å†…å­˜åé¢è¿˜æœ‰è¶³å¤Ÿå¤šå‰©ä½™å†…å­˜çš„è¯ï¼Œreallocåçš„å†…å­˜&#x3D;åŸæ¥çš„å†…å­˜+å‰©ä½™å†…å­˜ï¼Œreallocè¿˜æ˜¯è¿”å›åŸæ¥å†…å­˜çš„åœ°å€å³ä¸ä¼šåˆ›å»ºæ–°çš„å†…å­˜ã€‚å‡å¦‚åŸæ¥allocçš„å†…å­˜åé¢æ²¡æœ‰è¶³å¤Ÿå¤šå‰©ä½™å†…å­˜çš„è¯ï¼Œreallocå°†ç”³è¯·æ–°çš„å†…å­˜ï¼Œç„¶åæŠŠåŸæ¥çš„å†…å­˜æ•°æ®æ‹·è´åˆ°æ–°å†…å­˜é‡Œï¼ŒåŸæ¥çš„å†…å­˜å°†è¢«freeæ‰ï¼Œreallocè¿”å›æ–°å†…å­˜çš„åœ°å€ã€‚</p><p>å¦å¤–è¦æ³¨æ„ï¼Œå¦‚æœ ptr &#x3D; NULLï¼Œé‚£ä¹ˆç›¸å½“äºè°ƒç”¨ malloc(size)ï¼›å¦‚æœ ptr !&#x3D; NULLä¸”size &#x3D; 0ï¼Œé‚£ä¹ˆç›¸å½“äºè°ƒç”¨ free(ptr)ã€‚</p><p>å½“è°ƒç”¨ <code>realloc</code> å¤±è´¥çš„æ—¶å€™ï¼Œè¿”å›NULLï¼Œå¹¶ä¸”åŸæ¥çš„å†…å­˜ä¸æ”¹å˜ï¼Œä¸ä¼šé‡Šæ”¾ä¹Ÿä¸ä¼šç§»åŠ¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">The realloc() function tries to change the size of the allocation pointed to by ptr to size, and returns ptr. </span><br><span class="line"></span><br><span class="line">If there is not enough room to enlarge the memory allocation pointed to by ptr, realloc() creates a new allocation, copies as much of the old data pointed to by ptr as will fit to the new allocation, frees the old allocation, and returns a pointer to the allocated memory.  </span><br><span class="line"></span><br><span class="line">If ptr is NULL, realloc() is identical to a call to malloc() for size bytes.  </span><br><span class="line"></span><br><span class="line">If size is zero and ptr is not NULL, a new, minimum sized object is allocated and the original object is freed.  </span><br><span class="line"></span><br><span class="line">When extending a region allocated with calloc(3), realloc(3) does not guarantee that the additional memory is also zero-filled.</span><br></pre></td></tr></table></figure><p>çœ‹ä¸€ä¸‹æºç çš„å…³é”®éƒ¨åˆ†ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> * __libc_realloc (<span class="type">void</span> *oldmem, <span class="type">size_t</span> bytes)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// çœç•¥... </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> REALLOC_ZERO_BYTES_FREES</span></span><br><span class="line">  <span class="keyword">if</span> (bytes == <span class="number">0</span> &amp;&amp; oldmem != <span class="literal">NULL</span>) &#123;</span><br><span class="line">    __libc_free (oldmem); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// çœç•¥...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œå¦‚æœ <code>oldmem</code> ä¸ä¸ºNULLä¸” <code>bytes</code> ä¸º0çš„æƒ…å†µä¸‹ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œ <code>free</code> æ“ä½œã€‚å¦‚ä¸‹é¢çš„ä¾‹å­è¿è¡Œåä¼šæŠ¥é”™ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *pre_ptr = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">20</span>);</span><br><span class="line">    <span class="type">int</span> bytes = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">NULL</span> != pre_ptr) &#123;</span><br><span class="line">        <span class="type">void</span> *ptr = <span class="built_in">realloc</span>(pre_ptr, bytes);</span><br><span class="line">        <span class="comment">// å¯¹pre_ptrè¿›è¡Œäº†double freeï¼Œè¿™ç§æ¡ä»¶ä¸‹æºç ä¸­ä¼šè¿›è¡Œä¸€æ¬¡free</span></span><br><span class="line">        <span class="built_in">free</span>(pre_ptr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ä¸ºäº†ä¿é™©èµ·è§ï¼Œè¦å¯¹ <code>bytes</code> è¿›è¡Œåˆ¤æ–­å†åšå¤„ç†ã€‚</p><p>ä¼ é€’ç»™ <code>realloc</code> çš„æŒ‡é’ˆå˜é‡å¿…é¡»æ˜¯å…ˆå‰é€šè¿‡ <code>malloc()</code>ã€ <code>calloc()</code> æˆ– <code>realloc()</code> ç­‰allocåˆ†é…çš„ï¼Œå¦åˆ™ä¼šæŠ¥ <code>pointer being realloc&#39;d was not allocated.</code> é”™è¯¯ã€‚å¦‚ä¸‹ä¾‹å­ï¼ˆè¿è¡Œç›´æ¥æŠ¥é”™ï¼‰ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *p = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="type">void</span> *newP = <span class="built_in">realloc</span>(p, <span class="number">10</span>);</span><br></pre></td></tr></table></figure><p><strong>3ã€reallocf() å‡½æ•°</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> * <span class="title function_">reallocf</span><span class="params">(<span class="type">void</span> *ptr, <span class="type">size_t</span> size)</span>;</span><br></pre></td></tr></table></figure><p><code>reallocf()</code> å‡½æ•°æ˜¯ç”± FreeBSD å®ç°çš„ï¼Œå®ƒä¼šåœ¨ä»»ä½•æƒ…å†µä¸‹é‡Šæ”¾è¾“å…¥çš„æŒ‡é’ˆï¼ˆå³ä½¿æ˜¯å†åˆ†é…å¤±è´¥ä¹‹åï¼‰ã€‚<code>reallocf()</code> ä¸€æ ·ä¼šè°ƒç”¨ <code>realloc</code> å‡½æ•°ï¼Œä½†æ˜¯åªæœ‰æˆ‘ä»¬åœ¨è·å¾—ç©ºçš„æŒ‡é’ˆä¹‹åæ‰ä¼šè°ƒç”¨ <code>free</code> å‡½æ•°ã€‚</p><p>ä¸‹é¢æ˜¯ <code>reallocf</code> å‡½æ•°å…·ä½“çš„å®ç°éƒ¨åˆ†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> * <span class="title function_">reallocf</span><span class="params">(<span class="type">void</span> *p, <span class="type">size_t</span> size)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">void</span> *ptr = <span class="built_in">realloc</span>(p, size);</span><br><span class="line">    <span class="keyword">if</span> (!p) &#123;</span><br><span class="line">        <span class="built_in">free</span>(p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ptr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">The reallocf() function is identical to the realloc() function, except that it will free the passed pointer when the requested memory cannot be allocated.</span><br><span class="line"></span><br><span class="line">This is a FreeBSD specific API designed to ease the problems with traditional coding styles for realloc causing memory leaks in libraries.</span><br></pre></td></tr></table></figure><p><strong>4ã€valloc() å‡½æ•°</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> * <span class="title function_">valloc</span><span class="params">(<span class="type">size_t</span> size)</span>;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°æ˜¯æœ€å°‘è§ä¹Ÿæ˜¯æœ€å°‘ç”¨çš„ä¸€ä¸ªå‡½æ•°ã€‚</p><p><code>malloc</code> æˆ– <code>realloc</code> è¿”å›çš„æ˜¯ä»¥8å­—èŠ‚å¯¹é½çš„å†…å­˜åœ°å€ï¼Œåœ¨64bitsä¸Šæ˜¯16å­—èŠ‚å¯¹é½ã€‚ç„¶è€Œ <code>memalign</code> æˆ– <code>valloc</code> å¯ä»¥æ›´å¤§çš„ç²’åº¦è¿›è¡Œå­—èŠ‚å¯¹é½ã€‚</p><p><code>valloc</code> æ˜¯ä¸€ä¸ªåºŸå¼ƒçš„å‡½æ•°ï¼Œåˆ†é… <code>size</code> å¤§å°çš„å­—èŠ‚ï¼Œè¿”å›å·²åˆ†é…çš„å†…å­˜åœ°å€æŒ‡é’ˆï¼Œå…¶å†…å­˜åœ°å€å°†æ˜¯é¡µå¤§å°(page size)çš„å€æ•°ï¼Œå¦‚æœåˆ†é…å¤±è´¥è¿”å› <code>NULL</code>ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">The valloc() function allocates size bytes of memory and returns a pointer to the allocated memory. </span><br><span class="line"></span><br><span class="line">The allocated memory is aligned on a page boundary.</span><br></pre></td></tr></table></figure><p>è¯´äº†è¿™ä¹ˆå¤šï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¾‹å­ï¼Œå¦‚ä¸‹ä»£ç ç¤ºä¾‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¹å…¶åˆ†é…å†…å­˜ï¼Œè¿™ä¸ªæ—¶å€™pcharå€¼æ˜¯éšæœºçš„åƒåœ¾å€¼</span></span><br><span class="line"><span class="type">char</span> *pchar = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">16</span>);</span><br><span class="line"><span class="comment">// æ‰‹åŠ¨åˆå§‹åŒ–pcharçš„å€¼ï¼Œä¸‹é¢çš„æ–¹æ³•åˆ™ä¸éœ€è¦</span></span><br><span class="line"><span class="built_in">memset</span>(pchar, <span class="number">0</span>, <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// callocåˆ†é…å†…å­˜ï¼Œä¼šè‡ªåŠ¨è®¾ç½®ä¸º0ï¼Œä¸éœ€è¦memset</span></span><br><span class="line"><span class="type">char</span> *pchar_orig = (<span class="type">char</span> *)<span class="built_in">calloc</span>(<span class="number">12</span>, <span class="keyword">sizeof</span>(<span class="type">char</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨åŸå†…å­˜åŸºç¡€ä¸Šï¼Œåœ¨å †å†…å­˜ç©ºé—´ä¸­è¿ç»­å¢åŠ å†…å­˜</span></span><br><span class="line"><span class="comment">// å¦‚æœåŸå†…å­˜æ²¡æœ‰è¿ç»­ç©ºé—´å¯æ‹“å±•ï¼Œreallocä¼šæ–°åˆ†é…ä¸€ä¸ªç©ºé—´ï¼Œå°†åŸæœ‰å†…å­˜copyåˆ°æ–°ç©ºé—´ï¼Œç„¶åé‡Šæ”¾åŸå†…å­˜  </span></span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šreallocå’Œmallocï¼Œåªåˆ†é…å†…å­˜ä¸è¿›è¡Œèµ‹å€¼æ“ä½œ</span></span><br><span class="line"><span class="type">char</span> *pchar_dest = (<span class="type">char</span> *)<span class="built_in">realloc</span>(pchar_orig, <span class="number">10</span>);</span><br><span class="line">  </span><br><span class="line"><span class="comment">// ç›¸å½“äº malloc(60)</span></span><br><span class="line"><span class="type">char</span> *pchar_ini = (<span class="type">char</span> *)<span class="built_in">realloc</span>(<span class="literal">NULL</span>, <span class="number">60</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">free</span>(pchar);</span><br><span class="line">pchar = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">free</span>(pchar_orig);</span><br><span class="line">pchar_orig = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">free</span>(pchar_dest);</span><br><span class="line">pchar_dest = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">free</span>(pchar_ini);</span><br><span class="line">pchar_ini = <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure><h2 id="glibc-ä¸-libc"><a href="#glibc-ä¸-libc" class="headerlink" title="glibc ä¸ libc"></a>glibc ä¸ libc</h2><p>ä¸Šé¢è¯´è¿‡è¿™äº›å†…å­˜ç®¡ç†å‡½æ•°éƒ½åœ¨å¤´æ–‡ä»¶ <code>stdlib.h</code> ä¸­ï¼Œå‡½æ•°å®ç°éƒ½åœ¨ <code>malloc.c</code> æ–‡ä»¶ä¸­ï¼Œè¿™äº›éƒ½å¯ä»¥åœ¨ <code>glibc</code> ä¸­æ‰¾åˆ°å¯¹åº”çš„ä»£ç ï¼Œæˆ‘ä¸‹è½½çš„ <code>glibc</code> æ˜¯ <code>2.29</code> è¿™ä¸ªç‰ˆæœ¬ã€‚</p><p>libc æ˜¯ <code>Stantard C Library</code> çš„ç®€ç§°ï¼Œå®ƒæ˜¯ç¬¦åˆANSI Cæ ‡å‡†çš„ä¸€ä¸ªæ ‡å‡†å‡½æ•°åº“ã€‚libcåº“æä¾›Cè¯­è¨€ä¸­æ‰€ä½¿ç”¨çš„å®ï¼Œç±»å‹çš„å®šä¹‰ï¼Œå­—ç¬¦ä¸²æ“ä½œç¬¦ï¼Œæ•°å­¦è®¡ç®—å‡½æ•°ä»¥åŠè¾“å…¥è¾“å‡ºå‡½æ•°ç­‰ã€‚æ­£å¦‚ANSI Cæ˜¯Cè¯­è¨€çš„æ ‡å‡†ä¸€æ ·ï¼Œlibcåªæ˜¯ä¸€ä¸ªå‡½æ•°åº“æ ‡å‡†ï¼Œæ¯ä¸ªæ“ä½œç³»ç»Ÿéƒ½ä¼šæŒ‰ç…§è¯¥æ ‡å‡†å¯¹æ ‡å‡†åº“è¿›è¡Œå…·ä½“å®ç°ã€‚é€šå¸¸æˆ‘ä»¬æ‰€è¯´çš„libcæ˜¯ç‰¹æŒ‡æŸä¸ªæ“ä½œç³»ç»Ÿçš„æ ‡å‡†åº“ï¼Œæ¯”å¦‚ï¼šåœ¨Linuxæ“ä½œç³»ç»Ÿä¸‹æ‰€è¯´çš„libcå³glibcã€‚glibcæ˜¯ç±»Unixæ“ä½œç³»ç»Ÿä¸­ä½¿ç”¨æœ€å¹¿æ³›çš„libcåº“ï¼Œå®ƒçš„å…¨ç§°æ˜¯GNU C Library.</p><p><code>glibc</code>æ˜¯ Linux ä¸‹çš„ C å‡½æ•°åº“ã€‚<code>libc</code> åº“æ˜¯Linuxä¸‹çš„ANSI Cçš„å‡½æ•°åº“ä¹Ÿæ³›æŒ‡ä¸€åˆ‡ç¬¦åˆCè§„èŒƒçš„åº“ï¼Œ<code>glibc</code> æ˜¯Linuxä¸‹çš„GNU Cå‡½æ•°åº“ï¼Œæ˜¯ä¸€ç§ <code>libc</code> çš„å®ç°ã€‚<code>glibc</code> æœ¬èº«æ˜¯GNUæ——ä¸‹çš„Cæ ‡å‡†åº“ï¼Œåæ¥é€æ¸æˆä¸ºäº†Linuxçš„æ ‡å‡†Cåº“ã€‚Linuxä¸‹é¢çš„æ ‡å‡†Cåº“ä¸ä»…æœ‰è¿™ä¸€ä¸ªï¼Œå¦‚ <a href="https://www.uclibc.org/">uclibc</a>ã€klibcï¼Œä½†æ˜¯ <code>glibc</code> æ— ç–‘æ˜¯ç”¨å¾—æœ€å¤šçš„ï¼Œç”¨ <code>glibc</code> ä½œä¸ºç³»ç»Ÿçš„Cå‡½å¼åº“ï¼Œæ˜¯GNU&#x2F;Linuxæ¼”è¿›çš„ä¸€ä¸ªé‡è¦é‡Œç¨‹ç¢‘ï¼Œå¯ä»¥æŸ¥çœ‹ <a href="https://en.wikipedia.org/wiki/GNU_C_Library">ç»´åŸºç™¾ç§‘</a> å¯¹ <code>glibc</code> çš„ä»‹ç»ã€‚</p><p>è¿˜æœ‰æ¯”å¦‚Androidçš„Bionicåº“ä¹Ÿæ˜¯ä¸€ç§libcçš„å®ç°ï¼Œåªæ˜¯åœ¨Androidä¸Šé¢ä½¿ç”¨ç½¢äº†ã€‚Bionicæ˜¯Googleä¸ºAndroidæ“ä½œç³»ç»Ÿæä¾›çš„BSDæ ‡å‡†Cåº“çš„è¡ç”Ÿåº“ï¼Œä¸“é—¨ä¸ºç§»åŠ¨è®¡ç®—è€Œç²¾å¿ƒè®¾è®¡çš„ï¼Œé’ˆå¯¹ç§»åŠ¨è®¾å¤‡ä¸Šæœ‰é™çš„CPUå‘¨æœŸå’Œå¯ç”¨å†…å­˜è¿›è¡Œäº†è£å‰ªä»¥æé«˜å·¥ä½œæ•ˆç‡ã€‚</p><p>è¿™é‡Œä¹Ÿè¯´ä¸€ä¸‹åŸºæœ¬çš„Cè¯­è¨€å‡½æ•°åº“ï¼Œè¿™ä¸ªåº“å¯ä»¥æ ¹æ®å¤´æ–‡ä»¶åˆ’åˆ†ä¸º 15 ä¸ªéƒ¨åˆ†ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š</p><ul><li><p>æ–‡ä»¶ <a href="https://www.runoob.com/cprogramming/c-standard-library-assert-h.html">assert.h</a>ï¼šåŒ…å«å®å’Œä¿¡æ¯ï¼Œç”¨äºè¿›è¡Œè¯Šæ–­ï¼Œå¸®åŠ©ç¨‹åºè°ƒè¯•ï¼›</p></li><li><p>æ–‡ä»¶ <a href="https://www.runoob.com/cprogramming/c-standard-library-ctype-h.html">ctype.h</a>ï¼šåŒ…å«ç”¨æ¥æµ‹è¯•æŸä¸ªç‰¹å¾å­—ç¬¦çš„å‡½æ•°çš„å‡½æ•°åŸå‹ï¼Œä»¥åŠç”¨æ¥è½¬æ¢å¤§å°å†™å­—æ¯çš„å‡½æ•°åŸå‹ï¼›</p></li><li><p>æ–‡ä»¶ <a href="https://www.runoob.com/cprogramming/c-standard-library-errno-h.html">errno.h</a>ï¼šå®šä¹‰ç”¨æ¥æŠ¥å‘Šé”™è¯¯æ¡ä»¶çš„å®ï¼›</p></li><li><p>æ–‡ä»¶ <a href="https://www.runoob.com/cprogramming/c-standard-library-float-h.html">float.h</a>ï¼šåŒ…å«ç³»ç»Ÿçš„æµ®ç‚¹æ•°å¤§å°é™åˆ¶ï¼›</p></li><li><p>æ–‡ä»¶ <a href="https://www.runoob.com/cprogramming/c-standard-library-math-h.html">math.h</a>ï¼šåŒ…å«æ•°å­¦åº“å‡½æ•°çš„å‡½æ•°åŸå‹ï¼›</p></li><li><p>æ–‡ä»¶ <a href="https://www.runoob.com/cprogramming/c-standard-library-stddef-h.html">stddef.h</a>ï¼šåŒ…å«æ‰§è¡ŒæŸäº›è®¡ç®— C æ‰€ç”¨çš„å¸¸è§çš„å‡½æ•°å®šä¹‰ï¼›</p></li><li><p>æ–‡ä»¶ <a href="https://www.runoob.com/cprogramming/c-standard-library-stdio-h.html">stdio.h</a>ï¼šåŒ…å«æ ‡å‡†è¾“å…¥è¾“å‡ºåº“å‡½æ•°çš„å‡½æ•°åŸå‹ï¼Œä»¥åŠä»–ä»¬æ‰€ç”¨çš„ä¿¡æ¯ï¼›</p></li><li><p>æ–‡ä»¶ <a href="https://www.runoob.com/cprogramming/c-standard-library-stdlib-h.html">stdlib.h</a>ï¼šåŒ…å«æ•°å­—è½¬æ¢åˆ°æ–‡æœ¬ï¼Œä»¥åŠæ–‡æœ¬è½¬æ¢åˆ°æ•°å­—çš„å‡½æ•°åŸå‹ï¼Œè¿˜æœ‰å†…å­˜åˆ†é…ã€éšæœºæ•°å­—ä»¥åŠå…¶ä»–å®ç”¨å‡½æ•°çš„å‡½æ•°åŸå‹ï¼›</p></li><li><p>æ–‡ä»¶ <a href="https://www.runoob.com/cprogramming/c-standard-library-string-h.html">string.h</a>ï¼šåŒ…å«å­—ç¬¦ä¸²å¤„ç†å‡½æ•°çš„å‡½æ•°åŸå‹ï¼›</p></li><li><p>æ–‡ä»¶ <a href="https://www.runoob.com/cprogramming/c-standard-library-time-h.html">time.h</a>ï¼šåŒ…å«æ—¶é—´å’Œæ—¥æœŸæ“ä½œçš„å‡½æ•°åŸå‹å’Œç±»å‹ï¼›</p></li><li><p>æ–‡ä»¶ <a href="https://www.runoob.com/cprogramming/c-standard-library-stdarg-h.html">stdarg.h</a>ï¼šåŒ…å«å‡½æ•°åŸå‹å’Œå®ï¼Œç”¨äºå¤„ç†æœªçŸ¥æ•°å€¼å’Œç±»å‹çš„å‡½æ•°çš„å‚æ•°åˆ—è¡¨ï¼›</p></li><li><p>æ–‡ä»¶ <a href="https://www.runoob.com/cprogramming/c-standard-library-signal-h.html">signal.h</a>ï¼šåŒ…å«å‡½æ•°åŸå‹å’Œå®ï¼Œç”¨äºå¤„ç†ç¨‹åºæ‰§è¡ŒæœŸé—´å¯èƒ½å‡ºç°çš„å„ç§æ¡ä»¶ï¼›</p></li><li><p>æ–‡ä»¶ <a href="https://www.runoob.com/cprogramming/c-standard-library-setjmp-h.html">setjmp.h</a>ï¼šåŒ…å«å¯ä»¥ç»•è¿‡ä¸€èˆ¬å‡½æ•°è°ƒç”¨å¹¶è¿”å›åºåˆ—çš„å‡½æ•°çš„åŸå‹ï¼Œå³éå±€éƒ¨è·³è½¬ï¼›</p></li><li><p>æ–‡ä»¶ <a href="https://www.runoob.com/cprogramming/c-standard-library-locale-h.html">locale.h</a>ï¼šåŒ…å«å‡½æ•°åŸå‹å’Œå…¶ä»–ä¿¡æ¯ï¼Œä½¿ç¨‹åºå¯ä»¥é’ˆå¯¹æ‰€è¿è¡Œçš„åœ°åŒºè¿›è¡Œä¿®æ”¹ã€‚åœ°åŒºçš„è¡¨ç¤ºæ–¹æ³•å¯ä»¥ä½¿è®¡ç®—æœºç³»ç»Ÿå¤„ç†ä¸åŒçš„æ•°æ®è¡¨è¾¾çº¦å®šï¼Œå¦‚å…¨ä¸–ç•Œçš„æ—¥æœŸã€æ—¶é—´ã€ç¾å…ƒæ•°å’Œå¤§æ•°å­—ï¼›</p></li><li><p>æ–‡ä»¶ <a href="https://www.runoob.com/cprogramming/c-standard-library-limits-h.html">limits.h</a>ï¼šå†³å®šäº†å„ç§å˜é‡ç±»å‹çš„å„ç§å±æ€§ã€‚å®šä¹‰åœ¨è¯¥å¤´æ–‡ä»¶ä¸­çš„å®é™åˆ¶äº†å„ç§å˜é‡ç±»å‹ï¼ˆæ¯”å¦‚ charã€int å’Œ longï¼‰çš„å€¼ï¼›</p></li></ul><p>åœ¨ <code>glibc</code> åº“ä¸­å¯ä»¥æ‰¾åˆ° <code>malloc.c</code> æ–‡ä»¶(è·¯å¾„æ˜¯ <code>glibc-2.29/malloc/malloc.c</code> )ï¼Œä»ä¸­å¯ä»¥çœ‹åˆ°å¦‚ä¸‹åˆ«åçš„å®šä¹‰ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">strong_alias (__libc_calloc, __calloc) weak_alias (__libc_calloc, <span class="built_in">calloc</span>)</span><br><span class="line">strong_alias (__libc_free, __free) strong_alias (__libc_free, <span class="built_in">free</span>)</span><br><span class="line">strong_alias (__libc_malloc, __malloc) strong_alias (__libc_malloc, <span class="built_in">malloc</span>)</span><br><span class="line">strong_alias (__libc_memalign, __memalign)</span><br><span class="line">weak_alias (__libc_memalign, memalign)</span><br><span class="line">strong_alias (__libc_realloc, __realloc) strong_alias (__libc_realloc, <span class="built_in">realloc</span>)</span><br><span class="line">strong_alias (__libc_valloc, __valloc) weak_alias (__libc_valloc, valloc)</span><br><span class="line">strong_alias (__libc_pvalloc, __pvalloc) weak_alias (__libc_pvalloc, pvalloc)</span><br><span class="line">strong_alias (__libc_mallinfo, __mallinfo)</span><br><span class="line">weak_alias (__libc_mallinfo, mallinfo)</span><br><span class="line">strong_alias (__libc_mallopt, __mallopt) weak_alias (__libc_mallopt, mallopt)</span><br></pre></td></tr></table></figure><p> <code>__malloc</code> æ˜¯  <code>__libc_malloc</code> çš„åˆ«åï¼Œ<code>malloc</code> ä¹Ÿæ˜¯  <code>__libc_malloc</code> çš„åˆ«åã€‚å…¶ä»–ä»¥æ­¤ç±»æ¨ã€‚</p><p>æ‰€ä»¥çœ‹ <code>malloc</code> å‡½æ•°çš„æºç ï¼Œç›´æ¥çœ‹ <code>__libc_realloc</code> å‡½æ•°å®ç°å³å¯ï¼Œçœ‹ <code>free</code> çš„æºç å¯ä»¥çœ‹ <code>__libc_free</code> çš„å®ç°ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> *</span><br><span class="line">__libc_realloc (<span class="type">void</span> *oldmem, <span class="type">size_t</span> bytes)</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥åœ¨çº¿æŸ¥çœ‹ <code>glibc</code> çš„æºç ï¼Œç‚¹å‡» <a href="https://code.woboq.org/userspace/glibc/">è¿™é‡Œ</a> å‰å¾€æ¬£èµï¼</p><p>ä»¥åè¦æ˜¯æœ‰äººé—®ä½ åœ¨å“ªé‡Œå¯ä»¥ä¸‹è½½libcçš„æºç ï¼Œä½ å°±å¯ä»¥å‘Šè¯‰ä»–libcåªæ˜¯ä¸€ä¸ªæ ‡å‡†ï¼Œä¸åŒçš„å¹³å°ä¸Šé¢æœ‰ä¸åŒçš„libcå®ç°ï¼Œæ¯”å¦‚glibcï¼Œbionicç­‰ã€‚</p><hr><p><strong>é”„ç¦¾æ—¥å½“åˆï¼Œæ±—æ»´ç¦¾ä¸‹åœŸï¼Œäº”ä¸€èŠ‚å¿«ä¹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> malloc free </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç”¨Objective-Cå®ç°æŠ½è±¡ç±»</title>
      <link href="/2019/04/21/%E7%94%A8Objective-C%E5%AE%9E%E7%8E%B0%E6%8A%BD%E8%B1%A1%E7%B1%BB/"/>
      <url>/2019/04/21/%E7%94%A8Objective-C%E5%AE%9E%E7%8E%B0%E6%8A%BD%E8%B1%A1%E7%B1%BB/</url>
      
        <content type="html"><![CDATA[<p><img src="/upload/images/2019/04/21/1.jpg"></p><p>æ’å›¾çš„èŠ±æ˜¯æˆ‘ä¸Šä¸ªæœˆå‘å·¥èµ„å½“å¤©æ™šä¸ŠåŠ ç­å›å®¶çš„è·¯ä¸Šä»ä¸€ä¸ªè€äººå®¶é‚£é‡Œä¹°çš„ï¼Œä¸€æç‹¬ç§€ï¼</p><p>ä¸Šå‘¨åœ¨å¾®ä¿¡å…¬ä¼—å·å‘å¸ƒçš„ä¸€ç¯‡åä¸º <a href="%5Bhttp://www.veryitman.com/2019/04/14/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/%5D(http://www.veryitman.com/2019/04/14/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/)">åå‘ä»£ç†</a> çš„æ–‡ç« ï¼Œå±…ç„¶çœŸè¢«å¾®ä¿¡ç»™å°æ‰äº†ï¼Œå½“æ—¶åœ¨å†™çš„æ—¶å€™æˆ‘è¿˜åœ¨æƒ³æ˜¯ä¸æ˜¯ä¼šè¢«å¾®ä¿¡ç»™å°æ€æ‰ï¼ŒçœŸæ˜¯æ€•ä»€ä¹ˆæ¥ä»€ä¹ˆï¼Œå®Œå…¨ç¬¦åˆå¢¨è²å®šå¾‹ï¼é‚£ç¯‡æ–‡ç« æˆ‘å°±æ˜¯æƒ³ç»™å¤§å®¶åˆ†äº«ä¸€ä¸‹å¦‚ä½•è®¾ç½® <code>Nginx</code> çš„åå‘ä»£ç†ï¼Œå…¶ä¸­çš„ä¸€äº›æ¦‚å¿µå¯èƒ½æ˜¯å› ä¸ºç‰µæ¶‰åˆ°äº†æ•æ„Ÿè¯æ±‡ï¼Œæœ¬æ— æ¶æ„ï¼</p><p>ä¸è¯´è¿™ä»¶äº‹æƒ…äº†ï¼Œè¿˜æ˜¯å›åˆ°ä»Šå¤©åˆ†äº«çš„ä¸»é¢˜ä¸Šé¢æ¥å§~</p><p>åœ¨è½¯ä»¶è®¾è®¡æˆ–è€…æ¶æ„è®¾è®¡é¢†åŸŸï¼Œæ¶æ„å¸ˆéƒ½ä¼šè·Ÿå¤§å®¶å¼ºè°ƒå¯¹ä¸šåŠ¡ä¸€å®šè¦æŠ½è±¡ï¼ŒæŠŠå…·ä½“çš„ä¸šåŠ¡åœºæ™¯æŠ½è±¡ä¸ºç¨‹åºå®ç°å¾ˆè€ƒéªŒä¸€ä¸ªäººçš„ç¼–ç¨‹å’Œæ€ç»´èƒ½åŠ›ã€‚æ‰€ä»¥åœ¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹ä¸­ï¼ŒæŠ½è±¡æ˜¯ä¸€ç§å¿…å¤‡çš„èƒ½åŠ›ã€‚</p><p>è®¾è®¡æ¡†æ¶çš„æ—¶å€™ï¼Œä¸€èˆ¬æˆ‘ä»¬éƒ½ä¼šçº¦å®šä¸€äº›åè®®ï¼Œå„ä¸ªæ¨¡å—åœ¨äº¤äº’é€šä¿¡ä¸­èƒ½å¤Ÿéµå®ˆå’Œå®ç°è¿™äº›åè®®ï¼Œå°±å¯ä»¥ä¿è¯é€šä¿¡çš„ç•…é€šæ€§ï¼Œå°±å¥½æ¯”å¤§å®¶éµå®ˆæ’é˜Ÿè§„åˆ™ä¸€æ ·ï¼Œä¸€ä¸ªä¸€ä¸ªæ¥å°±ä¸ä¼šä¹±ã€‚</p><p>åè®®å¯ä»¥ä½¿ç”¨æ¥å£çš„å½¢å¼æˆ–è€…æŠ½è±¡ç±»çš„å½¢å¼éƒ½å¯ä»¥å®šä¹‰ï¼Œä¸åŒçš„ç¼–ç¨‹è¯­è¨€æœ‰ä¸åŒçš„å½¢å¼ã€‚ä¾‹å¦‚ï¼Œåœ¨Javaä¸­æä¾›ç»™å¼€å‘è€…çš„æœ‰æ¥å£ <code>Interface</code>  è¿˜æœ‰æŠ½è±¡ç±» <code>Abstract</code>ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** æ¥å£ */</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ISeverListener</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">covertService</span><span class="params">(String name)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** æŠ½è±¡ç±» */</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">AbstractServer</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">abstract</span> String <span class="title function_">destroyService</span><span class="params">(String serverID)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ <code>C++</code> ä¸­ä¹Ÿæœ‰æŠ½è±¡ç±»ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Point</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="type">int</span> x, y;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="comment">//çº¯è™šå‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">disp</span><span class="params">()</span></span>=<span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åœ¨ <code>Objective-C</code> ä¸­æä¾›äº†åè®® <code>protocol</code>ï¼Œæ²¡æœ‰æä¾›æŠ½è±¡ç±»çš„ä¸œè¥¿ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å€ŸåŠ© <code>protocol</code> æ¨¡æ‹Ÿå®ç°æŠ½è±¡ç±»ã€‚</p><p><strong>DownloaderProtocol.h åè®®</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">DownloaderProtocol</span> &lt;<span class="title">NSObject</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@required</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)checkDownloader;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)startDownload:(<span class="keyword">id</span>)url;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)stopDownload;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)deleteAllDownloadFile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p><strong>AbstractDownloader.h</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="string">&quot;DownloaderProtocol.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">AbstractDownloader</span> : <span class="title">NSObject</span> &lt;<span class="title">DownloaderProtocol</span>&gt;</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setDownloadUrl:(<span class="built_in">NSString</span> *)url;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p><strong>AbstractDownloader.m</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="string">&quot;AbstractDownloader.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> AbstractMethodNotImplemented() \</span></span><br><span class="line"><span class="meta">@throw [NSException exceptionWithName:NSInternalInconsistencyException \</span></span><br><span class="line"><span class="meta">reason:[NSString stringWithFormat:@<span class="string">&quot;You must override %@ in a subclass.&quot;</span>, NSStringFromSelector(_cmd)] \</span></span><br><span class="line"><span class="meta">userInfo:nil]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">AbstractDownloader</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)init</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSAssert</span>(![<span class="keyword">self</span> isMemberOfClass:[AbstractDownloader <span class="keyword">class</span>]], <span class="string">@&quot;AbstractDownloader is an abstract class, you should not instantiate it directly.&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">super</span> init];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)checkDownloader</span><br><span class="line">&#123;</span><br><span class="line">    AbstractMethodNotImplemented();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)startDownload:(<span class="keyword">id</span>)url</span><br><span class="line">&#123;</span><br><span class="line">    AbstractMethodNotImplemented();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)stopDownload</span><br><span class="line">&#123;</span><br><span class="line">    AbstractMethodNotImplemented();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)deleteAllDownloadFile</span><br><span class="line">&#123;</span><br><span class="line">    AbstractMethodNotImplemented();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setDownloadUrl:(<span class="built_in">NSString</span> *)url</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;AbstractDownloader&#x27;s url = %@&quot;</span>, url);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p><code>ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡º </code>AbstractMethodNotImplemented()<code>æ˜¯æ¨¡æ‹ŸæŠ½è±¡ç±»çš„å…³é”®ï¼Œæœ‰äº†è¿™ä¸ªå®åŠ¨è®®ä¹‹åï¼Œå‡¡æ˜¯éœ€è¦ç»§æ‰¿</code>AbstractDownloader<code> å¿…é¡»è¦å®ç°å¯¹åº”çš„æ–¹æ³•ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</code>ImageDownloader<code> ç»§æ‰¿ AbstractDownloader</code> å¹¶ä¸”å®ç°å¯¹åº”çš„æ–¹æ³•ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><p><strong>ImageDownloader.h</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="string">&quot;AbstractDownloader.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ImageDownloader</span> : <span class="title">AbstractDownloader</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p><strong>ImageDownloader.m</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="string">&quot;ImageDownloader.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ImageDownloader</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)checkDownloader</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;ImageDownloader checkDownloader...&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)startDownload:(<span class="keyword">id</span>)url</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;ImageDownloader startDownload...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)stopDownload</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;ImageDownloader stopDownload...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)deleteAllDownloadFile</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;ImageDownloader deleteAllDownloadFile...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·åšçš„è¯ï¼Œå›¢é˜Ÿç›¸å…³çš„å¼€å‘äººå‘˜å°±çŸ¥é“è‡ªå·±ç»§æ‰¿è‡ª <code>AbstractDownloader</code> åº”è¯¥åšä»€ä¹ˆäº†ã€‚</p><p>è¿™é‡Œåªæ˜¯ç»™å¤§å®¶æä¾›ä¸€ç§è®¾è®¡æ€è·¯ï¼Œæœ‰æ›´å¥½çš„æ€è·¯æ¬¢è¿äº¤æµï¼Œæ„Ÿè°¢æ¯ä¸€ä½å…³æ³¨è€…ã€é˜…è¯»è€…ã€‚</p><p><strong>ä¸€ç›´è‡´åŠ›äºè®©å¼€å‘å˜å¾—æ›´ç¾å¥½çš„å…¬ä¼—å·~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS æŠ½è±¡ç±» Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ubuntu19å®‰è£…Swift5</title>
      <link href="/2019/04/20/Ubuntu19%E5%AE%89%E8%A3%85Swift5/"/>
      <url>/2019/04/20/Ubuntu19%E5%AE%89%E8%A3%85Swift5/</url>
      
        <content type="html"><![CDATA[<h2 id="å†…å®¹æ¦‚è¦"><a href="#å†…å®¹æ¦‚è¦" class="headerlink" title="å†…å®¹æ¦‚è¦"></a>å†…å®¹æ¦‚è¦</h2><p>é€šè¿‡å®è·µï¼Œåˆ†äº«å¦‚ä½•åœ¨ <code>Ubuntu19</code> ä¸‹é¢å¦‚ä½•å®‰è£… <code>Swift5</code>.</p><h2 id="å®‰è£…å¿…å¤‡åº“"><a href="#å®‰è£…å¿…å¤‡åº“" class="headerlink" title="å®‰è£…å¿…å¤‡åº“"></a>å®‰è£…å¿…å¤‡åº“</h2><p>åœ¨ä½¿ç”¨ <code>apt-get</code> ä¹‹å‰ï¼Œæœ‰å¿…è¦åšä¸€æ¬¡æ›´æ–°ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure><p>æ›´æ–°å®Œæˆåï¼Œå®‰è£…å¯¹åº”çš„åº“æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install git cmake ninja-build clang python uuid-dev libicu-dev icu-devtools libbsd-dev libedit-dev libxml2-dev libsqlite3-dev swig libpython-dev libncurses5-dev pkg-config libblocksruntime-dev libcurl4-openssl-dev systemtap-sdt-dev tzdata rsync</span><br></pre></td></tr></table></figure><p>ç„¶åå†å®‰è£…ä¸‹é¢çš„åº“ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install clang libicu-dev libpython2.7</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œä¸€å®šè¦å®‰è£…ä¸‹é¢çš„åº“ï¼Œæ‰§è¡Œå®‰è£…å³å¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install libtinfo5</span><br><span class="line">sudo apt install python-dev</span><br></pre></td></tr></table></figure><p>å¦åˆ™ä¼šæŠ¥é”™ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/bin/lldb: error while loading shared libraries: libncurses.so.5: cannot open shared object file: No such file or directory</span><br><span class="line"></span><br><span class="line">/bin/lldb: error while loading shared libraries: libpython2.7.so.1.0: cannot open shared object file: No such file or directory</span><br></pre></td></tr></table></figure><h2 id="ä¸‹è½½-Swift"><a href="#ä¸‹è½½-Swift" class="headerlink" title="ä¸‹è½½ Swift"></a>ä¸‹è½½ Swift</h2><p>ä¸‹è½½ <code>Swift</code> æºç ï¼Œä½¿ç”¨ <code>wget</code> ä¸‹è½½å³å¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://swift.org/builds/swift-5.0-release/ubuntu1804/swift-5.0-RELEASE/swift-5.0-RELEASE-ubuntu18.04.tar.gz</span><br></pre></td></tr></table></figure><p>ä¸‹è½½æˆåŠŸåï¼Œè§£å‹æºæ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar zxvf swift-5.0-RELEASE-ubuntu18.04.tar.gz</span><br></pre></td></tr></table></figure><p>ä¸ºäº†ä½¿ç”¨æ–¹ä¾¿ï¼Œå¯ä»¥å¯¹è§£å‹åçš„æ–‡ä»¶é‡æ–°å‘½åï¼Œè¿™é‡Œæˆ‘æ”¹ä¸ºäº† <code>swift5.0</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv swift-5.0-RELEASE-ubuntu18.04 swift5.0</span><br></pre></td></tr></table></figure><h2 id="é…ç½®ç¯å¢ƒå˜é‡"><a href="#é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="é…ç½®ç¯å¢ƒå˜é‡"></a>é…ç½®ç¯å¢ƒå˜é‡</h2><p>å°† swift å¯¹åº”çš„åŠ å…¥åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œç¼–è¾‘ <code>~/.bashrc</code> æ–‡ä»¶å³å¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.bashrc</span><br></pre></td></tr></table></figure><p>æ·»åŠ ä¸‹é¢å†…å®¹åœ¨æ–‡ä»¶æœ€åï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=/home/username/developer/swift_linux/swift5.0/usr/bin:$&#123;PATH&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼š<code>/home/username/developer/swift_linux/swift5.0/usr/bin</code> æ˜¯ä½ è‡ªå·±è§£å‹åçš„ç›®å½•ã€‚</p><p>ä¸ºäº†éªŒè¯ <code>Swift</code> æ˜¯å¦å®‰è£…æˆåŠŸï¼Œå¯ä»¥è®© <code>~/.bashrc</code> æ–‡ä»¶ ç«‹å³ç”Ÿæ•ˆï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure><p>åœ¨ç»ˆç«¯æ‰§è¡Œä»¥ä¸‹ä¸‹é¢å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">swift -version</span><br></pre></td></tr></table></figure><p>æˆåŠŸä¼šæ˜¾ç¤ºå¦‚ä¸‹ä¿¡æ¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Swift version 5.0 (swift-5.0-RELEASE)</span><br><span class="line">Target: x86_64-unknown-linux-gnu</span><br></pre></td></tr></table></figure><p>Done.</p><p><strong>äººç”Ÿæ€»æ˜¯åœ¨ä¸æ–­çš„ä¸Šæ¼”ç€é‡é€¢å’Œç¦»åˆ«~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> swift linux Ubuntu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åå‘ä»£ç†</title>
      <link href="/2019/04/14/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/"/>
      <url>/2019/04/14/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="æœ¬ç¯‡å†…å®¹æ¦‚è¦"><a href="#æœ¬ç¯‡å†…å®¹æ¦‚è¦" class="headerlink" title="æœ¬ç¯‡å†…å®¹æ¦‚è¦"></a>æœ¬ç¯‡å†…å®¹æ¦‚è¦</h2><p>ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰é—®è¿‡åˆ«äººï¼Œæˆ–è€…æ˜¯è‡ªå·±å·å·åœ¨ç½‘ä¸Šæœè¿‡ç±»ä¼¼ â€œä»€ä¹ˆæ˜¯æ­£å‘å’Œåå‘ä»£ç†â€œ ç±»ä¼¼çš„é—®é¢˜ï¼Œå³ä½¿é—®è¿‡ã€æœè¿‡æ˜¯ä¸æ˜¯ä¹Ÿå¾ˆæ‡µï¼Ÿ</p><p><strong>æ€»ç»“ä¸€å¥ç²—è¯ï¼šæ­£å‘ä»£ç†å°±æ˜¯ä»£ç†å®¢æˆ·ç«¯çš„ä»£ç†æœåŠ¡ï¼Œåå‘ä»£ç†å°±æ˜¯ä»£ç†æœåŠ¡ç«¯çš„ä»£ç†æœåŠ¡ã€‚</strong></p><p>é‚£æˆ‘ä»¬ä»Šå¤©å°±æ¥æ°æ‰¯æ°æ‰¯è¿™ä¸ªé—®é¢˜ã€‚</p><h2 id="VPN-å’Œæ­£å‘ä»£ç†"><a href="#VPN-å’Œæ­£å‘ä»£ç†" class="headerlink" title="VPN å’Œæ­£å‘ä»£ç†"></a>VPN å’Œæ­£å‘ä»£ç†</h2><p>å°æ˜ï¼šâ€œä½ æ˜¨å¤©çœ‹äº†æˆ‘ç»™ä½ å‘çš„è§†é¢‘é“¾æ¥äº†å—ï¼Ÿè¶…çº§å¥½çœ‹å“Ÿï¼â€ã€‚<br>å°ä¸½ï¼šâ€œå“¦ï¼Œé‚£ä¸ªé“¾æ¥æ ¹æœ¬æ‰“ä¸å¼€å‘€ï¼Œçœ‹ä¸ªpiï¼â€ï¼Œå°æ˜å¤±æœ›çš„çœ‹äº†çœ‹å°ä¸½ã€‚<br>å°æ˜ï¼šâ€œå¥½å§ï¼Œè‚¯å®šæ˜¯ä½ æ²¡æœ‰ä½¿ç”¨ VPN è½¯ä»¶ï¼Œæ‰€ä»¥ä½ çœ‹ä¸äº†â€¦â€ã€‚</p><p>ç›¸ä¿¡ä½ ä¹Ÿæœ‰ç»å†è¿‡ç±»ä¼¼çš„åœºæ™¯ï¼Œæœ‹å‹ç»™äº†ä¸€ä¸ªéœ€è¦ä½ æ‹¥æœ‰ VPN æ‰èƒ½æ‰“å¼€çš„é“¾æ¥ï¼Œæ— è®ºä½ æ˜¯ä¸‡å…†å…‰çº¤ä¹Ÿå¥½è¿˜æ˜¯äº¿å…†å…‰çº¤ä¹Ÿç½¢ï¼Œæ­»æ´»éƒ½æ— æ³•æ‰“å¼€ã€‚</p><p>è¿™é‡Œæ‰€è¯´çš„ VPN å°±æ˜¯äººä»¬é€šå¸¸æ‰€è¯´çš„æ­£å‘ä»£ç†æœåŠ¡å™¨ï¼ŒVPN(è™šæ‹Ÿç§äººç½‘ç»œ <code>Virtual Private Network</code>)ï¼Œæ˜¯ä¸€ç§åŠ å¯†é€šè®¯æŠ€æœ¯ã€‚VPN æœ‰å¾ˆå¤šçš„å…·ä½“å®ç°ï¼Œæ¯”å¦‚ <code>PPTP</code>ã€<code>L2TP</code>ã€<code>IPSec</code> å’Œ <code>openvpn</code>ã€‚VPN ä¸æ˜¯ä¸ºäº†ç¿»å¢™è€Œç”Ÿçš„ï¼Œä»–åªæ˜¯ä¸€ä¸­æŠ€æœ¯ï¼Œå°±å¥½æ¯”èœåˆ€æœ¬æ¥æ˜¯ç”¨æ¥åˆ‡èœçš„é“ç†ä¸€æ ·ã€‚ä½¿ç”¨ VPN æ¥çˆ¬æ¥¼æ¢¯åŸºæœ¬å·²ç»ä½œåºŸäº†ï¼Œä½†å½“å¤§å®¶è°ˆåŠ fanqiang çš„æ—¶å€™è¯´å¾—æœ€å¤šçš„è¿˜æ˜¯ â€œä½ æœ‰å¥½ç”¨çš„ VPN å—ï¼Ÿâ€ï¼Œæ‰€ä»¥æŠŠ VPN å½“æˆ fanqiang å·¥å…·çš„ä»£åè¯ä¹Ÿæƒ…æœ‰å¯åŸã€‚</p><p>å¦‚æœä½ æœ‰äº† fanqiang è½¯ä»¶å°±å¯ä»¥è½»æ¾è®¿é—®å…¨ä¸–ç•Œçš„ç½‘ç«™äº†ï¼Œç‰¹åˆ«æ˜¯ç¨‹åºå‘˜ï¼Œå¯ä»¥åœ¨çŸ¥è¯†çš„æµ·æ´‹é‡Œé¨æ¸¸ã€‚ç®€å•æ¥è¯´æ­£å‘ä»£ç†æœåŠ¡å™¨ç±»ä¼¼äºä¸‹é¢å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2019/04/14/1.jpg"></p><h2 id="åå‘ä»£ç†å’Œ-Nginx"><a href="#åå‘ä»£ç†å’Œ-Nginx" class="headerlink" title="åå‘ä»£ç†å’Œ Nginx"></a>åå‘ä»£ç†å’Œ Nginx</h2><p>è¿™é‡Œå¯ä»¥ç»™å¤§å®¶ä¸¾ä¸ªä¾‹å­ï¼Œå‡å¦‚ä½ æƒ³è®©ç”µä¿¡å…¬å¸ç»™ä½ å®‰è£…å®½å¸¦æˆ–è€…ç½‘ç»œç”µè§†ï¼Œè¿™ä¸ªæ—¶å€™ä½ å¯èƒ½éœ€è¦æ‰“ç”µè¯å’¨è¯¢ä¸€ä¸‹ç›¸å…³çš„å†…å®¹ï¼Œäºæ˜¯ä½ æ‹¿èµ·äº†æ‰‹æœºç»™ç”µä¿¡å…¬å¸æ‰“ç”µè¯ï¼Œç»è¿‡ä¸€ç•ªå¤æ‚æ“ä½œåç»ˆäºå¯ä»¥ç­‰å¾…äººå·¥æœåŠ¡äº†ã€‚ç”µä¿¡çš„äººå·¥å®¢æœäººå‘˜æœ‰å¾ˆå¤šï¼Œç³»ç»Ÿä¼šæ ¹æ®ä¸€å®šçš„è§„åˆ™ç»™ä½ åˆ†é…ä¸€ä¸ªäººï¼Œæ¥ä¸‹æ¥å¯èƒ½æ˜¯ç¾çœ‰ä¹Ÿå¯èƒ½æ˜¯æ±‰å­ä¸ºä½ æœåŠ¡ï¼Œç©¶ç«Ÿæ˜¯è°ç»™ä½ æä¾›è¯­éŸ³æœåŠ¡å–å†³ä¸ç³»ç»Ÿçš„åˆ†é…ï¼Œè€Œä¸æ˜¯ä½ å¯ä»¥å†³å®šçš„ã€‚</p><p>ç³»ç»Ÿåˆ†é…å’Œè°ƒåº¦çš„åŠŸèƒ½å°±ç±»ä¼¼äºåå‘ä»£ç†æœåŠ¡å™¨ï¼Œå¯¹ç”¨æˆ·æ¥è¯´æ²¡æœ‰æ„ŸçŸ¥ã€‚ç±»ä¼¼äºä¸‹é¢å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2019/04/14/2.jpg"></p><p>åœ¨è½¯ä»¶è®¾è®¡ä¸­ï¼ŒæœåŠ¡ç«¯å¼€å‘ç»å¸¸ä¼šç”¨åˆ°åå‘ä»£ç†æœåŠ¡å™¨ï¼Œæ¯”å¦‚ <code>Nginx</code>ã€<code>Apache</code> ç­‰ï¼Œå®ƒä»¬ç»å¸¸ä¹Ÿè¢«ç”¨ä½œä¸º WEB æœåŠ¡å™¨ï¼Œ<code>Nginx</code> è¢«å½“åšä»£ç†æœåŠ¡å™¨æ¯”è¾ƒå¤šï¼Œæ‰€è°“çš„ä»£ç†æœåŠ¡å™¨æ˜¯æ¶è®¾åœ¨ WEB æœåŠ¡å™¨å’Œç½‘ç»œä¸­æ–­(æ¯”å¦‚æ‰‹æœºå®¢æˆ·ç«¯)ä¹‹é—´çš„æœåŠ¡å™¨ï¼Œæ¢å¥è¯è¯´ï¼Œ<code>Nginx</code> æä¾›äº†åå‘ä»£ç†æœåŠ¡çš„èƒ½åŠ›ã€‚</p><p>ç”±äº <code>Nginx</code> å’Œ <code>Apache</code> å„è‡ªçš„ä¼˜åŠ¿ï¼Œç°åœ¨å¾ˆå¤šå¼€å‘è€…é€‰æ‹©è®©ä¸¤è€…åœ¨æœåŠ¡å™¨ä¸­å…±å­˜ã€‚åœ¨æœåŠ¡å™¨ç«¯è®© <code>Nginx</code> åœ¨å‰ <code>Apache</code> åœ¨åï¼Œç”± <code>Nginx</code> åšè´Ÿè½½å‡è¡¡å’Œåå‘ä»£ç†ï¼Œå¹¶ä¸”å¤„ç†é™æ€æ–‡ä»¶ï¼Œå°†åŠ¨æ€è¯·æ±‚äº¤ç»™ <code>Apache</code> å»å¤„ç†ã€‚</p><p>ä¸‹å›¾æ˜¯ä¸€ä¸ªå…¸å‹çš„ <code>Nginx</code> ä½œä¸ºåå‘ä»£ç†æœåŠ¡å™¨éƒ¨ç½² <code>ELK</code> çš„æ¶æ„å›¾ï¼Œå¦‚ä¸‹ï¼š<br><img src="/upload/images/2019/04/14/3.jpg"></p><p>ç”¨ <code>Nginx</code> çš„åå‘ä»£ç†ï¼Œç”¨æˆ·å¯ä»¥ä»å¤–éƒ¨è®¿é—®åˆ° <code>Kibana</code>ï¼Œå¹¶ä¸”å®ƒæœ¬èº«å…·æœ‰è´Ÿè½½å‡è¡¡çš„ä½œç”¨ï¼Œä¹Ÿèƒ½å¤Ÿæé«˜äº†å…¶æ€§èƒ½ã€‚</p><p>å†çœ‹ä¸€ä¸ªå¾®æœåŠ¡æ¶æ„ä¸­çš„æ¶æ„å›¾ï¼ˆåœ¨ç½‘å…³å‰é¢ä¹Ÿéƒ¨ç½²äº† Nginxï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2019/04/14/4.jpg"></p><p>å…³äº <code>Nginx</code> ä½œä¸ºè´Ÿè½½å‡è¡¡å™¨çš„é…ç½®å’Œå®ä¾‹ï¼Œä¸‹ä¸€æ¬¡è·Ÿå¤§å®¶åˆ†äº«ã€‚ä½ ç°åœ¨åªéœ€è¦èšç„¦åœ¨ <code>Nginx</code> ä½œä¸ºåå‘ä»£ç†æœåŠ¡å™¨ä¸Šé¢çš„åŠŸèƒ½å³å¯ã€‚</p><h2 id="Nginx-é…ç½®åå‘ä»£ç†"><a href="#Nginx-é…ç½®åå‘ä»£ç†" class="headerlink" title="Nginx é…ç½®åå‘ä»£ç†"></a>Nginx é…ç½®åå‘ä»£ç†</h2><p><code>Nginx</code> æœ¬èº«å·²ç»æä¾›äº†åå‘ä»£ç†æœåŠ¡çš„èƒ½åŠ›ï¼Œä¸‹é¢æˆ‘ä»¬ç»“åˆå®ä¾‹ç»™å¤§å®¶åˆ†äº«ä¸€ä¸‹ï¼Œå‡è®¾ä½ æœ¬æœºå·²ç»å®‰è£…äº† <code>Nginx</code> å¹¶ä¸”ä¼šåŸºæœ¬çš„æ“ä½œå‘½ä»¤ã€‚</p><p><strong>1ã€å¯åŠ¨ Nginx</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nginx</span><br></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨æ‰“å¼€ <code>http://localhost:80</code>ï¼Œç¡®ä¿ <code>Nginx</code> å¯åŠ¨æˆåŠŸã€‚</p><p><strong>2ã€é…ç½® host</strong></p><p>æˆ‘ä»¬é…ç½®ä¸€ä¸‹æœ¬æœºçš„ hostï¼Œvim ç¼–è¾‘å³å¯ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/hosts</span><br></pre></td></tr></table></figure><p>å¢åŠ ä¸‹é¢ä¸€è¡Œï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 www.ithome.com</span><br></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨æ‰“å¼€ <code>http://www.ithome.com:80</code>ï¼Œè·Ÿåˆšæ‰æ˜¾ç¤ºä¸€æ ·çš„WEB ç•Œé¢ã€‚</p><p><strong>3ã€é…ç½® Nginx</strong></p><p>ç¼–è¾‘ <code>Nginx</code> é…ç½®ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /usr/local/etc/nginx/nginx.conf</span><br></pre></td></tr></table></figure><p>åœ¨ <code>http &#123;</code> èŠ‚ç‚¹ä¸‹å¢åŠ ä¸‹é¢å†…å®¹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  <span class="comment"># ç›‘å¬80ç«¯å£å·</span></span><br><span class="line">  listen 80;</span><br><span class="line"></span><br><span class="line">  <span class="comment"># ç›‘å¬è®¿é—®çš„åŸŸå</span></span><br><span class="line">  server_name www.ithome.com;</span><br><span class="line"></span><br><span class="line">  <span class="comment"># æ ¹æ®è®¿é—®è·¯å¾„é…ç½®</span></span><br><span class="line">  location / &#123;</span><br><span class="line">      <span class="comment"># è®¾ç½® http ç‰ˆæœ¬</span></span><br><span class="line">      proxy_http_version 1.1;</span><br><span class="line">      proxy_set_header Connection <span class="string">&quot;&quot;</span>;</span><br><span class="line">      <span class="comment"># æŠŠè¯·æ±‚è½¬å‘åˆ° https://www.baidu.com</span></span><br><span class="line">      proxy_pass https://www.baidu.com;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡æ–°å¯åŠ¨ <code>Nginx</code>ï¼Œé‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ï¼Œæ“ä½œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nginx -s reload</span><br></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨æ‰“å¼€ <code>http://www.ithome.com:80</code>ï¼Œæ­¤æ—¶æ‰“å¼€çš„æ˜¯ç™¾åº¦é¦–é¡µã€‚è‡³æ­¤ï¼Œç®€å•çš„é…ç½® <code>Nginx</code> ä½œä¸ºåå‘ä»£ç†æœåŠ¡å™¨çš„åŠŸèƒ½å·²ç»å®Œæˆï¼Œå½“ç„¶æƒ³é…ç½®å¥½ <code>Nginx</code> è¿˜éœ€è¦å¤§å®¶å¤šå»å®è·µå’Œçœ‹å®˜æ–¹æŠ€æœ¯æ‰‹å†Œã€‚</p><p><code>proxy_pass</code> é»˜è®¤ä½¿ç”¨çš„æ˜¯ <code>http 1.0</code>ï¼Œå¯ä»¥é€šè¿‡ <code>proxy_http_version </code>æŒ‡ä»¤è®©å®ƒä½¿ç”¨ <code>http 1.1</code>ï¼Œä»¥ä¾¿å¼€å¯ <code>keepalive</code> ä¹‹ç±»çš„åŠŸèƒ½ã€‚<a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_http_version">å®˜æ–¹è¯´æ˜</a> å¦‚ä¸‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Sets the HTTP protocol version <span class="keyword">for</span> proxying. By default, version 1.0 is used. </span><br><span class="line"></span><br><span class="line">Version 1.1 is recommended <span class="keyword">for</span> use with keepalive connections and NTLM authentication.</span><br></pre></td></tr></table></figure><p>å¦å¤–ï¼Œnginx è¿˜å¯ä»¥è®¾ç½®é€æ˜ä»£ç†ï¼Œå¯ä»¥å‚è€ƒ <a href="https://www.nginx.com/blog/ip-transparency-direct-server-return-nginx-plus-transparent-proxy/">IP Transparency and Direct Server Return with NGINX and NGINX Plus as Transparent Proxy</a> è¿™ç¯‡æ–‡ç« ã€‚</p><h2 id="é™„å½•ï¼šNginx-å‘½ä»¤"><a href="#é™„å½•ï¼šNginx-å‘½ä»¤" class="headerlink" title="é™„å½•ï¼šNginx å‘½ä»¤"></a>é™„å½•ï¼šNginx å‘½ä»¤</h2><p><strong>1ã€æŸ¥çœ‹ nginx çš„é…ç½®ä¿¡æ¯</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -V</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šæ˜¯å¤§å†™å­—æ¯ <code>V</code>ã€‚</p><p><strong>2ã€æŸ¥çœ‹ nginx ç‰ˆæœ¬ä¿¡æ¯</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -v</span><br></pre></td></tr></table></figure><p><strong>3ã€å¯åŠ¨ nginx</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nginx</span><br></pre></td></tr></table></figure><p><strong>4ã€æŸ¥çœ‹ nginx è¿›ç¨‹</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef|grep nginx</span><br></pre></td></tr></table></figure><p><strong>5ã€é‡å¯ nginx</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -s reload</span><br></pre></td></tr></table></figure><p><strong>6ã€å®Œç¾åœæ­¢ nginx</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -QUIT `<span class="built_in">cat</span> /var/run/nginx.pid`</span><br></pre></td></tr></table></figure><p><strong>7ã€å¿«é€Ÿåœæ­¢ nginx</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -TERM `<span class="built_in">cat</span> /var/run/nginx.pid`</span><br></pre></td></tr></table></figure><p>æˆ–è€…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -INT `cat /var/run/nginx.pid`</span><br></pre></td></tr></table></figure><p><strong>8ã€å®Œç¾åœæ­¢å·¥ä½œè¿›ç¨‹ï¼Œä¸»è¦ç”¨äºå¹³æ»‘å‡çº§</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -WINCH `<span class="built_in">cat</span> /var/run/nginx.pid`</span><br></pre></td></tr></table></figure><p><strong>9ã€å¼ºåˆ¶åœæ­¢ nginx</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkill -9 nginx</span><br></pre></td></tr></table></figure><p><strong>10ã€æ£€æŸ¥ nginx.conf ä¿®æ”¹æ˜¯å¦æ­£ç¡®</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -t</span><br></pre></td></tr></table></figure><p><strong>11ã€åœæ­¢ nginx çš„å‘½ä»¤</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -s stop</span><br></pre></td></tr></table></figure><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://laravelacademy.org/post/9336">å›¾è§£æ­£å‘ä»£ç†ã€åå‘ä»£ç†ã€é€æ˜ä»£ç†ï¼šå¯èƒ½æ˜¯ä½ è§è¿‡çš„è®²è§£æœ€é€å½»çš„ä»£ç†æŠ€æœ¯æ•™ç¨‹</a></li><li><a href="https://www.nginx.cn/doc/standard/httpproxy.html">HttpProxyæ¨¡å—</a></li></ul><hr><p><strong>ä¸ç»å†é£é›¨æ€ä¹ˆè§å½©è™¹ï¼Œæ²¡æœ‰äººèƒ½å¤Ÿéšéšä¾¿ä¾¿æˆåŠŸ~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx VPN ä»£ç†æœåŠ¡å™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±å¼•èµ·çš„è€—æ—¶</title>
      <link href="/2019/04/07/Java-%E8%87%AA%E5%8A%A8%E8%A3%85%E7%AE%B1%E3%80%81%E6%8B%86%E7%AE%B1%E5%BC%95%E8%B5%B7%E7%9A%84%E8%80%97%E6%97%B6/"/>
      <url>/2019/04/07/Java-%E8%87%AA%E5%8A%A8%E8%A3%85%E7%AE%B1%E3%80%81%E6%8B%86%E7%AE%B1%E5%BC%95%E8%B5%B7%E7%9A%84%E8%80%97%E6%97%B6/</url>
      
        <content type="html"><![CDATA[<p><img src="/upload/images/2019/04/07/1.jpeg" alt="1"></p><h2 id="è€—æ—¶é—®é¢˜"><a href="#è€—æ—¶é—®é¢˜" class="headerlink" title="è€—æ—¶é—®é¢˜"></a>è€—æ—¶é—®é¢˜</h2><p>åœ¨è¯´ Java çš„è‡ªåŠ¨è£…ç®±å’Œè‡ªåŠ¨æ‹†ç®±ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªä¾‹å­ã€‚</p><p>è¿™ä¸ªé”™è¯¯æˆ‘åœ¨é¡¹ç›®ä¸­çŠ¯è¿‡(å°´å°¬)ï¼Œæ‹¿å‡ºæ¥å…±å‹‰ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">long</span> <span class="title function_">getCounterResult</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">Long</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0L</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> Integer.MAX_VALUE;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">        sum += i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">long</span> <span class="variable">startCountTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">    <span class="type">long</span> <span class="variable">result</span> <span class="operator">=</span> getCounterResult();</span><br><span class="line">    <span class="type">long</span> <span class="variable">endCountTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">    System.out.println(<span class="string">&quot;result = &quot;</span> + result + <span class="string">&quot;, and take up time : &quot;</span> + (endCountTime - startCountTime) / <span class="number">1000</span> + <span class="string">&quot;s&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æˆ‘çš„ç”µè„‘(macOS 64ä½ç³»ç»Ÿï¼Œé…ç½®è¾ƒé«˜)ï¼Œæ‰“å°ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result = 2305843005992468481, and take up time : 12s</span><br></pre></td></tr></table></figure><p>å±…ç„¶ä½¿ç”¨äº† <code>12s</code>ï¼Œæ˜¯å¯å¿<code>å”</code>ä¸å¯å¿ï¼Œå†æ­£å¸¸ä¸è¿‡çš„ä»£ç æ€ä¹ˆä¼šè€—æ—¶è¿™ä¹ˆä¹…å‘¢ï¼Ÿå¦‚æœåœ¨é…ç½®å·®ä¸€ç‚¹çš„ç”µè„‘ä¸Šè¿è¡Œè€—æ—¶ä¼šæ›´ä¹…(æƒŠå‘†äº†.jpg)ã€‚</p><p>æˆ‘ä»¬ä¸å¦¨å…ˆé˜…è¯»ä¸‹é¢çš„å†…å®¹ï¼Œå†æ¥åˆ†æã€è§£å†³ä¸Šè¿°è€—æ—¶çš„é—®é¢˜ã€‚</p><h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><blockquote><p>è‡ªä» jdk1.5 ä¹‹åå°±æœ‰äº†è‡ªåŠ¨è£…ç®±(Autoboxing)å’Œè‡ªåŠ¨æ‹†ç®±(AutoUnboxing)ã€‚</p></blockquote><p><strong>è‡ªåŠ¨è£…ç®±</strong>ï¼Œå°±æ˜¯ Java è‡ªåŠ¨å°†åŸå§‹(åŸºæœ¬)ç±»å‹è½¬æ¢æˆå¯¹åº”çš„å°è£…å™¨(å¯¹è±¡)ç±»å‹çš„è¿‡ç¨‹ï¼Œæ¯”å¦‚å°† <code>int</code> çš„å˜é‡è½¬æ¢æˆ <code>Integer</code> å¯¹è±¡ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšè£…ç®±ã€‚</p><p><strong>è‡ªåŠ¨æ‹†ç®±</strong>ï¼Œå°±æ˜¯ Java è‡ªåŠ¨å°†å°è£…å™¨(å¯¹è±¡)ç±»å‹è½¬æ¢æˆåŸºæœ¬ç±»å‹çš„è¿‡ç¨‹ï¼Œå¦‚å°† <code>Integer</code> å¯¹è±¡è½¬æ¢æˆ <code>int</code> ç±»å‹å€¼ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšæ‹†ç®±ã€‚</p><p>ä¹‹æ‰€ä»¥ç§°ä¹‹ä¸ºè‡ªåŠ¨è£…ç®±å’Œæ‹†ç®±ï¼Œæ˜¯å› ä¸ºè¿™äº›æ“ä½œå¹¶éäººå·¥(ç¨‹åºçŒ¿)æ“ä½œçš„ï¼Œè€Œæ˜¯ Java è‡ªå¸¦çš„ä¸€ä¸ªç‰¹æ€§ã€‚</p><p>ä¸‹è¡¨æ˜¯ Java ä¸­çš„åŸºæœ¬ç±»å‹å’Œå¯¹åº”çš„å°è£…ç±»å‹çš„å¯¹åº”è¡¨ï¼š</p><p>åŸºæœ¬ç±»å‹|å°è£…å™¨ç±»<br>â€”|â€”|â€”<br>int|Integer<br>byte|Byte<br>long|Long<br>float|float<br>double|Double<br>char|Character<br>boolean|Boolean</p><p><strong>è‡ªåŠ¨è£…ç®±ç¤ºä¾‹ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line"><span class="type">Integer</span> <span class="variable">b</span> <span class="operator">=</span> a;</span><br></pre></td></tr></table></figure><p><strong>è‡ªåŠ¨æ‹†ç®±ç¤ºä¾‹ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Integer</span> <span class="variable">b</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Integer</span>(<span class="number">7</span>);</span><br><span class="line"><span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> b;</span><br></pre></td></tr></table></figure><h2 id="Integer-x2F-int-è‡ªåŠ¨æ‹†ç®±å’Œè£…ç®±"><a href="#Integer-x2F-int-è‡ªåŠ¨æ‹†ç®±å’Œè£…ç®±" class="headerlink" title="Integer&#x2F;int è‡ªåŠ¨æ‹†ç®±å’Œè£…ç®±"></a>Integer&#x2F;int è‡ªåŠ¨æ‹†ç®±å’Œè£…ç®±</h2><p>ä¸‹é¢è¿™æ®µä»£ç æ˜¯ <code>Integer</code> çš„æºç ä¸­ <code>valueOf</code> æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns an &#123;<span class="doctag">@code</span> Integer&#125; instance representing the specified</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@code</span> int&#125; value.  If a new &#123;<span class="doctag">@code</span> Integer&#125; instance is not</span></span><br><span class="line"><span class="comment"> * required, this method should generally be used in preference to</span></span><br><span class="line"><span class="comment"> * the constructor &#123;<span class="doctag">@link</span> #Integer(int)&#125;, as this method is likely</span></span><br><span class="line"><span class="comment"> * to yield significantly better space and time performance by</span></span><br><span class="line"><span class="comment"> * caching frequently requested values.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This method will always cache values in the range -128 to 127,</span></span><br><span class="line"><span class="comment"> * inclusive, and may cache other values outside of this range.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  i an &#123;<span class="doctag">@code</span> int&#125; value.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> an &#123;<span class="doctag">@code</span> Integer&#125; instance representing &#123;<span class="doctag">@code</span> i&#125;.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span>  1.5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Integer <span class="title function_">valueOf</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">  <span class="comment">// å¦‚æœiçš„å€¼å¤§äº-128å°äº127åˆ™è¿”å›ä¸€ä¸ªç¼“å†²åŒºä¸­çš„ä¸€ä¸ªIntegerå¯¹è±¡</span></span><br><span class="line">    <span class="keyword">if</span> (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high)</span><br><span class="line">        <span class="keyword">return</span> IntegerCache.cache[i + (-IntegerCache.low)];</span><br><span class="line">        </span><br><span class="line">    <span class="comment">// å¦åˆ™è¿”å› new ä¸€ä¸ªInteger å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Integer</span>(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åœ¨æ‰§è¡Œä¸‹é¢çš„è¿™å¥ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Integer</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">100</span>;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç ç­‰åŒäºä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Integer</span> <span class="variable">i</span> <span class="operator">=</span> Integer.valueOf(<span class="number">100</span>);</span><br></pre></td></tr></table></figure><p>ç»“åˆä¸Šé¢çš„æºç å¯ä»¥çœ‹å‡ºæ¥ï¼Œå¦‚æœæ•°å€¼åœ¨ <code>[-128ï¼Œ127]</code> ä¹‹é—´(åŒé—­åŒºé—´)ï¼Œä¸ä¼šé‡æ–°åˆ›å»º <code>Integer</code> å¯¹è±¡ï¼Œè€Œæ˜¯ä»ç¼“å­˜ä¸­(å¸¸é‡æ± )ç›´æ¥è·å–ï¼Œä»å¸¸é‡æ± ä¸­è·å–è€Œä¸æ˜¯å †æ ˆæ“ä½œï¼Œè¯»å–æ•°æ®è¦å¿«å¾ˆå¤šã€‚</p><p>æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹å¸¸è§çš„åŸºç¡€é¢è¯•é¢˜(è¯·ç»™å‡ºæ‰“å°ç»“æœ)ï¼Œå¦‚ä¸‹:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="comment">// â“µ</span></span><br><span class="line"><span class="type">Integer</span> <span class="variable">a</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Integer</span>(<span class="number">121</span>);</span><br><span class="line"><span class="type">Integer</span> <span class="variable">b</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Integer</span>(<span class="number">121</span>);</span><br><span class="line">System.out.println(a == b);</span><br><span class="line"></span><br><span class="line"><span class="comment">// â“¶</span></span><br><span class="line"><span class="type">Integer</span> <span class="variable">c</span> <span class="operator">=</span> <span class="number">121</span>;</span><br><span class="line"><span class="type">Integer</span> <span class="variable">d</span> <span class="operator">=</span> <span class="number">121</span>;</span><br><span class="line">System.out.println(c == d);</span><br><span class="line"></span><br><span class="line"><span class="comment">// â“·</span></span><br><span class="line"><span class="type">Integer</span> <span class="variable">e</span> <span class="operator">=</span> <span class="number">129</span>;</span><br><span class="line"><span class="type">Integer</span> <span class="variable">f</span> <span class="operator">=</span> <span class="number">129</span>;</span><br><span class="line">System.out.println(e == f);</span><br><span class="line"></span><br><span class="line"><span class="comment">// â“¸</span></span><br><span class="line"><span class="type">int</span> <span class="variable">g</span> <span class="operator">=</span> <span class="number">50</span>;</span><br><span class="line"><span class="type">Integer</span> <span class="variable">h</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Integer</span>(<span class="number">50</span>);</span><br><span class="line">System.out.println(g == h);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>åˆ†æç»“æœï¼š</strong></p><p>â“µ: false, ä¸¤ä¸ªå¯¹è±¡è¿›è¡Œæ¯”è¾ƒåˆ†åˆ«æŒ‡å‘äº†ä¸åŒå †å†…å­˜<br>â“¶: true, è‡ªåŠ¨è£…ç®±ä¸”æ•°å€¼åœ¨ [-128ï¼Œ127] ä¹‹é—´(åŒé—­åŒºé—´)<br>â“·: false, è‡ªåŠ¨è£…ç®±ä¸”æ•°å€¼ä¸åœ¨ [-128ï¼Œ127] ä¹‹é—´(åŒé—­åŒºé—´)<br>â“¸: true, è‡ªåŠ¨æ‹†ç®±ä¸”æ•°å€¼åœ¨ [-128ï¼Œ127] ä¹‹é—´(åŒé—­åŒºé—´)</p><h2 id="è§£æè€—æ—¶é—®é¢˜"><a href="#è§£æè€—æ—¶é—®é¢˜" class="headerlink" title="è§£æè€—æ—¶é—®é¢˜"></a>è§£æè€—æ—¶é—®é¢˜</h2><p>ç±» <code>Long</code> å¯¹åº”çš„ä¹Ÿæœ‰ä¸€ä¸ª <code>valueof</code> æ–¹æ³•ï¼Œæºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Long <span class="title function_">valueOf</span><span class="params">(<span class="type">long</span> l)</span> &#123;</span><br><span class="line"><span class="keyword">final</span> <span class="type">int</span> <span class="variable">offset</span> <span class="operator">=</span> <span class="number">128</span>;</span><br><span class="line"><span class="keyword">if</span> (l &gt;= -<span class="number">128</span> &amp;&amp; l &lt;= <span class="number">127</span>) &#123; <span class="comment">// will cache</span></span><br><span class="line">    <span class="keyword">return</span> LongCache.cache[(<span class="type">int</span>)l + offset];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Long</span>(l);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå’Œ <code>Integer</code> çš„å¾ˆåƒï¼Œé“ç†ä¸Šé¢è¯´è¿‡ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</p><p>åœ¨å¼€ç¯‡çš„ä¾‹å­ä¸­ï¼Œ<code>getCounterResult</code> æ–¹æ³•æœ‰ä¸‹é¢è¿™å¥ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Long</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0L</span>;</span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾æˆ‘ä»¬å£°æ˜äº†ä¸€ä¸ª <code>Long</code> çš„å¯¹è±¡ <code>sum</code>ï¼Œç”±äºè‡ªåŠ¨è£…ç®±ï¼Œè¿™å¥ä»£ç å¹¶æ²¡æœ‰è¯­æ³•ä¸Šé¢çš„é”™è¯¯ï¼Œç¼–è¯‘å™¨å½“ç„¶ä¹Ÿä¸ä¼šæŠ¥é”™ã€‚ä¸Šé¢ä»£ç ç­‰åŒäºå¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Long</span> <span class="variable">sum</span> <span class="operator">=</span> Long.valueof(<span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>åœ¨ <code>for</code> å¾ªç¯ä¸­ï¼Œè¶…è¿‡ <code>[-128ï¼Œ127]</code> å°±ä¼šåˆ›å»ºæ–°çš„å¯¹è±¡ï¼Œè¿™æ ·ä¸æ–­çš„åˆ›å»ºå¯¹è±¡ï¼Œä¸åœçš„ç”³è¯·å †å†…å­˜ï¼Œç¨‹åºæ‰§è¡Œè‡ªç„¶ä¹Ÿå°±æ¯”è¾ƒè€—æ—¶äº†ã€‚</p><p>ä¿®æ”¹ä¸€ä¸‹ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">long</span> <span class="title function_">getCounterResult</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹ä¸ºæ™®é€šçš„åŸºæœ¬ç±»å‹æ•°æ®</span></span><br><span class="line">    <span class="type">long</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0L</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> Integer.MAX_VALUE;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">        sum += i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">long</span> <span class="variable">startCountTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">    <span class="type">long</span> <span class="variable">result</span> <span class="operator">=</span> getCounterResult();</span><br><span class="line">    <span class="type">long</span> <span class="variable">endCountTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">    System.out.println(<span class="string">&quot;result = &quot;</span> + result + <span class="string">&quot;, and take up time : &quot;</span> + (endCountTime - startCountTime) / <span class="number">1000</span> + <span class="string">&quot;s&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œæ—¶é—´å¤§å¤§ç¼©çŸ­ã€‚</p><hr><p><strong>ä¼˜æŸ”å¯¡æ–­ï¼Œæ˜¯äººç”Ÿæœ€å¤§çš„è´Ÿèƒ½é‡ã€‚å¯¹ï¼Œåˆ«çŠ¹è±«äº†èµ¶ç´§æ‰«ç å…³æ³¨~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è‡ªåŠ¨æ‹†ç®± è‡ªåŠ¨è£…ç®± autoboxing unboxing </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dumpdecrypted ç ¸å£³ï¼šå¯¼å‡ºå¤´æ–‡ä»¶</title>
      <link href="/2019/04/07/dumpdecrypted-%E7%A0%B8%E5%A3%B3%EF%BC%9A%E5%AF%BC%E5%87%BA%E5%A4%B4%E6%96%87%E4%BB%B6/"/>
      <url>/2019/04/07/dumpdecrypted-%E7%A0%B8%E5%A3%B3%EF%BC%9A%E5%AF%BC%E5%87%BA%E5%A4%B4%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><h2 id="å¯¼å‡ºå¤´æ–‡ä»¶"><a href="#å¯¼å‡ºå¤´æ–‡ä»¶" class="headerlink" title="å¯¼å‡ºå¤´æ–‡ä»¶"></a>å¯¼å‡ºå¤´æ–‡ä»¶</h2><p>åœ¨ <a href="http://www.veryitman.com/2018/06/07/iOS-%E9%80%86%E5%90%91-dumpdecrypted-%E7%A0%B8%E5%A3%B3%E8%AE%B0/">iOS é€†å‘: dumpdecrypted ç ¸å£³è®°</a>ä¸­å·²ç»ç»™å¤§å®¶åˆ†äº«äº†å¯¹ ipa æ–‡ä»¶å¦‚ä½•ç ¸å£³äº†ï¼Œ æ¥ä¸‹æ¥å°±å¯ä»¥å¯¼å‡ºå…¶å¤´æ–‡ä»¶äº†ã€‚</p><p>è¿™é‡Œéœ€è¦ç”¨åˆ° <code>class-dump</code> å·¥å…·ã€‚å¦‚æœä½ ä½¿ç”¨ class-dump, å‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error: Cannot find offset <span class="keyword">for</span> address 0xxxxxxxxx <span class="keyword">in</span> stringAtAddress</span><br></pre></td></tr></table></figure><p>æŠ¥è¿™ç§é”™è¯¯è¯´æ˜ä½ å³å°† dump çš„æ–‡ä»¶æ˜¯ <code>OC</code> å’Œ <code>Swift</code> æ··ç¼–çš„é¡¹ç›®ï¼Œ<code>class-dump</code> è¿™ä¸ªå·¥å…·å¯¹å®ƒä»¬æ— èƒ½ä¸ºåŠ›ã€‚</p><p>è¿˜å¥½, ä¼Ÿå¤§çš„ç¨‹åºå‘˜ä»¬ç»™æˆ‘ä»¬è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p><p>å»è·å– <a href="https://github.com/BlueCocoa/class-dump">class-dump æ”¹è¿›ç‰ˆ</a> æºç , ç„¶åä½¿ç”¨ <code>Xcode</code> ç¼–è¯‘å³å¯.</p><p>ç¼–è¯‘å®Œæˆåç”Ÿæˆçš„ <code>class-dump</code> å°±å¯ä»¥æ‹¿æ¥ä½¿ç”¨äº†.</p><p>æ”¹å˜å…¶å¯æ‰§è¡Œçš„æƒé™:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x class-dump</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ decrypted æ–‡ä»¶çš„ arm æ¶æ„:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">class-dump --list portkey-prod.decrypted </span><br></pre></td></tr></table></figure><p>æ˜¾ç¤ºä¸ºï¼š<code>arm64</code></p><p>å¼€å§‹ dump:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> portkey-header</span><br><span class="line"></span><br><span class="line">class-dump -H portkey-prod.decrypted -o portkey-header/</span><br></pre></td></tr></table></figure><h2 id="é‡åˆ°é—®é¢˜"><a href="#é‡åˆ°é—®é¢˜" class="headerlink" title="é‡åˆ°é—®é¢˜"></a>é‡åˆ°é—®é¢˜</h2><p>dumpdecrypted ç ¸å£³å‡ºç°äº†é—®é¢˜, é”™è¯¯ä¿¡æ¯å¦‚ä¸‹:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dyld: could not load inserted library <span class="string">&#x27;dumpdecrypted.dylib&#x27;</span> because no suitable image found.  Did find:</span><br><span class="line">dumpdecrypted.dylib: required code signature missing <span class="keyword">for</span> <span class="string">&#x27;dumpdecrypted.dylib&#x27;</span></span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ¡ˆ, é‡æ–°ç­¾å <code>dumpdecrypted</code> åå°†å…¶æ‹·è´åˆ° <code>Documents</code> ç›®å½•.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## åˆ—å‡ºå¯ç­¾åè¯ä¹¦, æ‰¾åˆ° mac ä¸Šé¢å·²ç»å®‰è£…çš„è¯ä¹¦</span></span><br><span class="line">security find-identity -v -p codesigning</span><br><span class="line"></span><br><span class="line"><span class="comment">## ä¸º dumpecrypted.dylib ç­¾å</span></span><br><span class="line">codesign --force --verify --verbose --sign <span class="string">&quot;iPhone Developer: xxx xxxx (xxxxxxxxxx)&quot;</span> dumpdecrypted.dylib</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong><code>iPhone Developer: xxx xxxx (xxxxxxxxxx)</code> ä¸ºä½ è‡ªå·±æœ¬æœºå®‰è£…çš„å¼€å‘è€…è¯ä¹¦åç§°.</p><h2 id="çœ‹åˆ°çš„å·¥å…·"><a href="#çœ‹åˆ°çš„å·¥å…·" class="headerlink" title="çœ‹åˆ°çš„å·¥å…·"></a>çœ‹åˆ°çš„å·¥å…·</h2><ul><li><p><a href="https://github.com/Maximus-/class-dump-swift">class-dump-swift</a> é’ˆå¯¹ Swift çš„å·¥å…·ã€‚è¿™ä¸ªéœ€è¦è‡ªå·±å…ˆç¼–è¯‘ llvmï¼Œç„¶åæ‰èƒ½ä½¿ç”¨.</p></li><li><p><a href="https://github.com/AloneMonkey/dumpdecrypted">dumpdecrypted</a>, æ¯”è¾ƒè‡ªåŠ¨åŒ–çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œä½†æˆ‘ä½¿ç”¨è¿™ä¸ªæ²¡æœ‰ç ¸å£³æˆåŠŸ(ä¼°è®¡æ˜¯éœ€è¦é’ˆå¯¹è¿™ä¸ªæ–‡ä»¶è¿›è¡Œç­¾å)ã€‚</p></li><li><p><a href="https://github.com/KJCracks/Clutch">Clutch</a></p></li></ul><h2 id="è¶Šç‹±ç³»åˆ—æ–‡ç« "><a href="#è¶Šç‹±ç³»åˆ—æ–‡ç« " class="headerlink" title="è¶Šç‹±ç³»åˆ—æ–‡ç« "></a>è¶Šç‹±ç³»åˆ—æ–‡ç« </h2><blockquote><p>åŸºäº iOS10.3.1 è¿›è¡Œçš„å®è·µã€‚</p></blockquote><ul><li><p><a href="http://www.veryitman.com/2018/06/07/iOS-%E9%80%86%E5%90%91-dumpdecrypted-%E7%A0%B8%E5%A3%B3%E8%AE%B0/">iOS é€†å‘: dumpdecrypted ç ¸å£³è®°</a></p></li><li><p><a href="http://www.veryitman.com/2018/05/13/iOS-%E9%80%86%E5%90%91-%E7%A0%B8%E5%A3%B3/">iOS é€†å‘: ç ¸å£³</a></p></li><li><p><a href="http://www.veryitman.com/2018/05/13/iOS-%E9%80%86%E5%90%91-%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E5%92%8C%E7%BB%93%E6%9E%84/">iOS é€†å‘: æŸ¥çœ‹ç³»ç»Ÿæ–‡ä»¶ç›®å½•å’Œç»“æ„</a></p></li><li><p><a href="http://www.veryitman.com/2018/05/12/iOS-%E9%80%86%E5%90%91-%E8%B6%8A%E7%8B%B1%E4%BD%BF%E7%94%A8-SSH/">iOS é€†å‘: è¶Šç‹±ä½¿ç”¨ SSH</a></p></li><li><p><a href="http://www.veryitman.com/2019/04/07/dumpdecrypted-%E7%A0%B8%E5%A3%B3%EF%BC%9A%E5%AF%BC%E5%87%BA%E5%A4%B4%E6%96%87%E4%BB%B6/">dumpdecrypted ç ¸å£³ï¼šå¯¼å‡ºå¤´æ–‡ä»¶</a></p></li></ul><p><strong>ä¸€ä¸ªç¥å¥‡çš„äºŒç»´ç ~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOSå®‰å…¨ è¶Šç‹± jailbreak </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>oh-my-zsh é…ç½®</title>
      <link href="/2019/04/03/oh-my-zsh-%E9%85%8D%E7%BD%AE/"/>
      <url>/2019/04/03/oh-my-zsh-%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<p><img src="/upload/images/2019/04/03/1.jpg"></p><p>å–œæ¬¢ä½¿ç”¨ç»ˆç«¯çš„æœ‹å‹éƒ½çŸ¥é“åœ¨ linuxã€macOS ä¸Šé¢é»˜è®¤ä½¿ç”¨çš„æ˜¯ <code>bash shell</code>ï¼Œè™½ç„¶ bash æ¯”è¾ƒå¼ºå¤§ï¼Œä½†æ˜¯æ¯”èµ· zsh è¿˜æ˜¯ç¨é€Šä¸€ç­¹ã€‚zsh è™½ç„¶å¥½ç”¨ä½†é…ç½®æ¯”è¾ƒå¤æ‚ï¼Œäºæ˜¯ä¹ <code>oh-my-zsh</code> å°±è¯ç”Ÿäº†ï¼Œå®ƒç»Ÿä¸€ç®¡ç† zsh çš„é…ç½®ã€‚</p><p><code>macOS</code> ä¸Šé¢å®‰è£… <a href="https://ohmyz.sh/">oh-my-zsh</a> åï¼Œæ„Ÿè§‰æ•²å‘½ä»¤æ›´çˆ½äº†ï¼Œç‰¹åˆ«æ˜¯åœ¨è¿›è¡Œ <code>git</code> æ“ä½œçš„æ—¶å€™ï¼Œå¾ˆæ–¹ä¾¿ã€‚</p><p>å®‰è£…æ¯”è¾ƒç®€å•ï¼Œå¯ä»¥åœ¨ç»ˆç«¯é€šè¿‡ <code>curl</code> ä¹Ÿå¯ä»¥é€šè¿‡ <code>wget</code> æ–¹å¼ï¼Œå®‰è£…æ–¹æ³•å¦‚ä¸‹ã€‚</p><p><strong>1ã€é€šè¿‡ curl æ–¹å¼</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh -c <span class="string">&quot;<span class="subst">$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)</span>&quot;</span></span><br></pre></td></tr></table></figure><p><strong>2ã€é€šè¿‡ wget æ–¹å¼</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh -c <span class="string">&quot;<span class="subst">$(wget https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O -)</span>&quot;</span></span><br></pre></td></tr></table></figure><p><code>oh-my-zsh</code> æ”¯æŒ linuxã€macOS å’Œ windowsï¼Œä½†æ˜¯åœ¨ linux å’Œ macOS ä¸Šé¢æ”¯æŒæœ€å¥½ã€‚</p><p>å®‰è£…æˆåŠŸåï¼ŒåŸæ¥åœ¨ç³»ç»Ÿ shell é…ç½®çš„ç¯å¢ƒå˜é‡éœ€è¦è®© <code>oh-my-zsh</code> çŸ¥é“ï¼Œé…ç½®ä¸€ä¸‹ <code>~/.zshrc</code> æ–‡ä»¶ï¼Œåœ¨è¯¥æ–‡ä»¶ä¸­çš„ <code>User configuration</code> ä¸‹é¢å¢åŠ ä¸‹é¢ä¸¤è¡Œé…ç½®å°±å¯ä»¥äº†ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.bash_profile</span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure><p>é…ç½®å®Œæˆåä¿å­˜æ–‡ä»¶ï¼Œåœ¨ç»ˆç«¯æ‰§è¡Œï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¹‹å‰é…ç½®çš„ç¯å¢ƒå˜é‡åœ¨ <code>oh-my-zsh</code> ä¸‹å°±ç”Ÿæ•ˆäº†ã€‚</p><p><code>oh-my-zsh</code> æ”¯æŒä¸‰æ–¹æ’ä»¶å’Œä¸»é¢˜é…ç½®ï¼Œé»˜è®¤çš„é…ç½®å·²ç»å¤Ÿç”¨äº†ï¼Œæœ‰å…´è¶£çš„å¯ä»¥è‡ªè¡Œæ¢ç´¢ã€‚</p><hr><p><strong>å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> MacOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> zsh git tool </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Follow your heart</title>
      <link href="/2019/03/24/Follow-your-heart/"/>
      <url>/2019/03/24/Follow-your-heart/</url>
      
        <content type="html"><![CDATA[<p><img src="/upload/images/2019/03/24/1.jpeg"></p><p>ä»Šå¤©ä¸èŠæŠ€æœ¯ï¼ŒèŠèŠäººç”Ÿ~</p><p>æœ€è¿‘å¤©æ°”åƒç–¯äº†ä¸€æ ·ï¼Œæ°”æ¸©åå¤æ— å¸¸ï¼Œæ—¶å†·æ—¶çƒ­ï¼Œè®©äººæœ‰ç‚¹åº”æ¥ä¸æš‡ã€‚</p><p>æ­£å¥½åˆšæ¬å®Œå®¶ï¼Œå®¶é‡Œå¾ˆå¤šä¸œè¥¿éœ€è¦è´­ä¹°ï¼Œé¦–å…ˆè€ƒè™‘çš„æ˜¯ç»™è‡ªå·±ä¹°å¯¹èˆ’æœçš„æ¡Œæ¤…ã€‚å®ä½“åº—é‡Œé¢çš„æ¡Œæ¤…å®åœ¨æ˜¯è´µçš„ç¦»è°±ï¼ŒåŠ¨è¾„å‘Šè¯‰æˆ‘è¯´æ˜¯å®æœ¨å“Ÿï¼Œç°åœ¨ä½ä»·å¤„ç†ä¹‹ç±»çš„ï¼Œè¿˜å¥½æˆ‘ä¸æ˜¯å¾ˆå‚»ã€‚æœ€åç´¢æ€§å°±åœ¨ç½‘ä¸Šè´­ä¹°äº†ï¼Œæ€§ä»·æ¯”ä¹Ÿæ¯”è¾ƒé«˜ï¼Œæˆ‘ä¹Ÿç®—æ˜¯æ¥äº†ä¸€æŠŠæ²‰æµ¸å¼çš„ç–¯ç‹‚è´­ç‰©ä½“éªŒã€‚</p><p>ç°åœ¨ç‰©æµæœåŠ¡å¾ˆæ˜¯è´´å¿ƒï¼Œå…³æ³¨å¯¹åº”çš„å…¬ä¼—å·å°±å¯ä»¥åŠæ—¶å‘Šè¯‰ä½ å½“å‰ç‰©æµçš„è¿›åº¦ã€‚ç›¸æ¯”ä¹‹å‰ï¼Œæ— è®ºæ˜¯é€è´§é€Ÿåº¦è¿˜æ˜¯æœåŠ¡éƒ½æœ‰æ˜¾è‘—æå‡ï¼Œä¸»è¦æ˜¯å®æƒ ã€‚</p><p>ç½‘ä¸Šæ·˜çš„è¿™ä¸ªæ¡Œå­æ¯”è¾ƒé‡ï¼Œè¦æƒ³è‡ªå·±æŠŠè¿™ä¸ªæ¡Œå­å¼„åˆ°å®¶è¿˜æ˜¯ç›¸å½“è´¹åŠ²çš„ã€‚å¿«é€’å‘˜çœ‹å‡ºäº†æˆ‘çš„çª˜å¢ƒï¼Œè¯´ï¼šâ€œæˆ‘è¿™ä¸ªæ¨è½¦åæ­£ç°åœ¨ä¹Ÿé—²ç€ï¼Œä½ å…ˆæ‹¿å»ç”¨å§ï¼â€ï¼Œæˆ‘è¿å¿™é“è°¢ï¼Œæœ‰äº†è¿™ä¸ªæ¨è½¦æ¬èµ·æ¥å°±å®¹æ˜“å¤šäº†ã€‚</p><p>ä¸åˆ°ååˆ†é’Ÿçš„æ—¶é—´ï¼Œæˆ‘å°±æŠŠè´§é€åˆ°å®¶äº†ã€‚å¿ƒç†ä¸€ç›´æƒ³åˆ«äººä¹Ÿè®¸è¿™ä¼šéœ€è¦æ€¥ç€ç”¨è½¦ï¼Œå°±èµ¶ç´§ä¸‹æ¥¼ï¼Œèµ°åˆ°æ¥¼ä¸‹æ‹è§’çš„æ—¶å€™ï¼Œçªç„¶è¢«ä¸€ä¸ªäººå–Šä½ï¼Œæˆ‘å›å¤´ä¸€çœ‹æ˜¯ä¸€ä¸ªé™Œç”Ÿçš„å¿«é€’å‘˜ã€‚</p><p>ä»–è¯­è°ƒæ¯”è¾ƒé«˜ï¼šâ€œå–‚ï¼Œå…ˆç”Ÿï¼Œä½ é‚£ä¸ªè½¦å­æ”¾åˆ°æˆ‘è¿™é‡Œå°±å¯ä»¥äº†ï¼Œæ˜¯æˆ‘ä»¬çš„ï¼â€ã€‚<br>æˆ‘ç„äº†ä»–ä¸€çœ¼ï¼Œè¯´é“ï¼šâ€œä½ æ˜¯å“ªä¸ªå¿«é€’å…¬å¸çš„ï¼Œæˆ‘ä¸æ˜¯ä»ä½ æ‰‹ä¸Šæ‹¿çš„è½¦å‘€ï¼â€ï¼Œè¿™å“¥ä»¬ä¾æ—§å¼ºåŠ¿ï¼šâ€œæˆ‘æ˜¯xxå¿«é€’ï¼Œè¿™è½¦å°±æ˜¯æˆ‘ä»¬çš„ã€‚â€ã€‚</p><p>æˆ‘å¿ƒæƒ³è¿™ä¸¤ä¸ªå¿«é€’å‘˜æ˜¯ä¸æ˜¯è®¤è¯†ï¼Œè¿™ä¸ªè½¦å­åŸæœ¬å°±æ˜¯çœ¼å‰è¿™ä¸ªæ°”åŠ¿æ±¹æ±¹çš„äººçš„ï¼Ÿ</p><p>å¿ƒç†æ­£åœ¨çŠ¯ç€å˜€å’•ï¼Œå†³å®šè¿˜æ˜¯è¦ç‰©å½’åŸä¸»ã€‚</p><p>æˆ‘æ²¡æœ‰å†ç†ä»–ï¼Œç»§ç»­æœç€åŸæ¥æ”¶å¿«é€’çš„åœ°æ–¹èµ°å»ï¼ŒæŠŠè½¦è¿˜ç»™äº†ä¸»äººã€‚æˆ‘é¡ºä¾¿é—®é“ï¼šâ€œåˆšæ‰æœ‰ä¸ªxxå¿«é€’çš„å°å“¥è¯´è½¦å­æ˜¯ä»–çš„ï¼Ÿâ€ï¼Œä»–è¯´ï¼šâ€œå¯èƒ½æ˜¯ä»–çœ‹é”™äº†ï¼Œä½ çœ‹è¿™è½¦å­ä¸Šé¢æœ‰æˆ‘ä»¬å…¬å¸çš„æ ‡è®°å‘¢â€ã€‚æˆ‘ä»”ç»†ä¸€çœ‹æœç„¶æ˜¯ï¼Œåº†å¹¸è‡ªå·±æ²¡æœ‰æŠŠè½¦äº¤ç»™åˆ«äººã€‚</p><p>äººç”Ÿä¸­ï¼Œä»¿ä½›ä¹Ÿæœ‰å¾ˆå¤šç±»ä¼¼ä¸Šé¢çš„åœºæ™¯ï¼Œå‡å¦‚ä½ é‡åˆ°äº†ä¼šæ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ</p><p>å°±æ‹¿å©šå§»æ¥è¯´ï¼Œä½ è®¤å®šçš„è‡ªå·±çš„å¦ä¸€åŠå°±æ˜¯è¿™è¾ˆå­è¦å¨¶æˆ–è€…è¦å«çš„é‚£ä¸ªäººï¼Œä½†æ˜¯ä½ èº«è¾¹çš„æœ‹å‹æˆ–è€…å®¶äººå¹¶ä¸çœ‹å¥½ä½ ä»¬ï¼Œç”šè‡³ä»–ä»¬å‹æ ¹ä¸æ‰¿è®¤ä½ çš„å¦ä¸€åŠï¼Œä½ åˆä¼šæ€ä¹ˆåŠï¼Ÿ</p><p>æˆ‘è§‰å¾—é‡åˆ°è¿™æ ·çš„äº‹æƒ…ï¼Œè¦å¬ä»è‡ªå·±çš„å†…å¿ƒ(Follow your heart)ï¼Œä¸è¦å› ä¸ºåˆ«äººçš„ä¸‰è¨€ä¸¤è¯­ï¼Œä½ å°±è½»æ˜“æ”¾å¼ƒå½“åˆçš„é€‰æ‹©ï¼Œè€Œåº”è¯¥æ›´åŠ ç†æ€§çš„åšå‡ºåˆ¤æ–­ï¼Œç›¸ä¿¡è‡ªå·±çš„åˆ¤æ–­ä¸ä¼šé”™ï¼Œåªæœ‰è¿™æ ·ä½ æ‰ä¸ä¼šåæ‚”ï¼Œè‡³å°‘çˆ±è¿‡ã€‚</p><p>å­¦ä¹ ã€å·¥ä½œå’Œç”Ÿæ´»ä¹Ÿæ˜¯ä¸€æ ·ï¼Œæ—¢å®šäº†ç›®æ ‡å°±åº”è¯¥å‹‡å¾€ç›´å‰ï¼Œåœ¨è·¯ä¸Šé‡åˆ°çš„ä»»ä½•å›°éš¾é‚£æ˜¯å†æ­£å¸¸ä¸è¿‡çš„ï¼Œåˆ«äººçš„å†·å˜²çƒ­è®½ä¹Ÿå¥½ï¼Œæ‰“å‡»åˆºæ¿€ä¹Ÿç½¢ï¼Œä½ è¦åšçš„å°±æ˜¯åšå®ˆä½ è‡ªå·±çš„å†…å¿ƒï¼Œä¸€å¸†é£é¡ºå¾—åˆ°çš„å¹¸ç¦ç»ˆç©¶ä¼šæ˜™èŠ±ä¸€ç°ã€‚</p><p>~ å……æ»¡é…¸ç”œè‹¦è¾£çš„äººç”Ÿæ‰å€¼å¾—å›å‘³ï¼Œä¸æ˜¯å—ï¼Ÿ</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼ŒæœŸå¾…ä¸ä½ çš„äº¤æµ~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éšç¬” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java æšä¸¾çš„æœ¬è´¨</title>
      <link href="/2019/03/16/Java-%E6%9E%9A%E4%B8%BE%E7%9A%84%E6%9C%AC%E8%B4%A8/"/>
      <url>/2019/03/16/Java-%E6%9E%9A%E4%B8%BE%E7%9A%84%E6%9C%AC%E8%B4%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h2><p>æœ¬æ–‡è·Ÿå¤§å®¶ä¸€èµ·æ¢è®¨ä¸€ä¸‹ Java æšä¸¾çš„æœ¬è´¨ï¼Œè¿™ç¯‡æ–‡ç« çš„å†…å®¹æ˜¯æˆ‘åœ¨ <code>2012å¹´09æœˆ05æ—¥</code> å‘å¸ƒåˆ° CSDN ä¸Šé¢çš„ä¸€ç¯‡åšæ–‡ <a href="https://blog.csdn.net/veryitman/article/details/7945020">Java æšä¸¾ï¼šç†è§£æšä¸¾æœ¬è´¨</a>ï¼Œè™½ç„¶å·²ç»ä¸åœ¨ CSDN ä¸Šé¢è€•è€˜äº†ï¼Œä½†å¶å°”ä¹Ÿä¼šå»çœ‹çœ‹æœ‹å‹ä»¬çš„ç•™è¨€ï¼Œæ¯•ç«Ÿæ„Ÿæƒ…åœ¨é‚£é‡Œï¼ä»Šå¤©å¶ç„¶çœ‹åˆ°æœ‰å°ä¼™ä¼´è¯„è®ºè¿™ç¯‡æ–‡ç« ï¼Œä¸€æ—¶å…´èµ·å°±æƒ³å†æ¬¡åˆ†äº«ç»™å¤§å®¶ã€‚</p><p><img src="/upload/images/2019/03/16/1.jpg" alt="1"></p><p>å­¦ä¹ ç¼–ç¨‹è¯­è¨€ï¼Œä¼šç”¨åªæ˜¯æœ€åŸºæœ¬çš„è¦æ±‚ï¼Œäº†è§£å’Œç†Ÿæ‚‰å…¶å®ç°ã€è¿è¡Œæœºåˆ¶æ‰ä½¿å¾—ä½ æœ‰åˆ«äºå¸¸äººï¼</p><h2 id="C-æšä¸¾"><a href="#C-æšä¸¾" class="headerlink" title="C æšä¸¾"></a>C æšä¸¾</h2><p>åœ¨ C è¯­è¨€ä¸­ï¼Œå¯ä»¥è¿™æ ·æ¥å®šä¹‰æšä¸¾ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">color</span> &#123;</span></span><br><span class="line">RED=<span class="number">0</span>, GREEN, BLUE, YELLOW</span><br><span class="line">&#125; col;</span><br></pre></td></tr></table></figure><p>å…³é”®å­— <code>enum</code> å®šä¹‰æšä¸¾ï¼Œåœ¨å®šä¹‰æšä¸¾çš„åŒæ—¶ï¼Œå£°æ˜è¯¥æšä¸¾å˜é‡ col.</p><p><strong>æ³¨æ„ï¼šC è¯­è¨€ä¸­æšä¸¾æˆå‘˜çš„å€¼æ˜¯æ ¹æ®ä¸Šä¸‹æ–‡è‡ªåŠ¨åŠ  1 çš„ï¼ˆGREEN &#x3D; 1ï¼ŒBLUE &#x3D; 2 ç­‰ï¼‰ã€‚</strong></p><p>C è¯­è¨€ä¸­ <code>switch</code> è¯­å¥æ”¯æŒæšä¸¾ç±»å‹ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">color</span> &#123;</span></span><br><span class="line">RED=<span class="number">0</span>, GREEN, BLUE, YELLOW</span><br><span class="line">&#125; col;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> cl;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;0=red, 1=green, 2=blue, 3=yellow. seclect:\n&quot;</span>);</span><br><span class="line">    </span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;cl);</span><br><span class="line"></span><br><span class="line">col=(<span class="keyword">enum</span> color) cl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>(col) &#123;</span><br><span class="line"><span class="keyword">case</span> RED:</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;the color is red\n&quot;</span>);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> GREEN:</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;the color is green\n&quot;</span>);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> BLUE:</span><br><span class="line">     <span class="built_in">printf</span>(<span class="string">&quot;the color is blue\n&quot;</span>);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> YELLOW:</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;the color is yellow\n&quot;</span>);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">defalut:</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;no this color\n&quot;</span>);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Java-æšä¸¾"><a href="#Java-æšä¸¾" class="headerlink" title="Java æšä¸¾"></a>Java æšä¸¾</h2><p>é‚£ä¹ˆï¼ŒJava é‡Œé¢çš„æšä¸¾ä¸å…¶ç±»ä¼¼ï¼Œä½†æ˜¯åˆä¸æ˜¯å®Œå…¨ä¸€æ ·ã€‚Java è¯­è¨€ä¸­å®šä¹‰æšä¸¾ä¹Ÿæ˜¯ä½¿ç”¨ <code>enum</code> å…³é”®å­—ï¼Œå¦‚ä¸‹ç¤ºä¾‹æ˜¯ Java è¯­è¨€çš„æšä¸¾ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Color</span> &#123;</span><br><span class="line">RED, GREEN, BLUE, YELLOW;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°å®šä¹‰äº†ä¸€ä¸ªæšä¸¾ç±»å‹ <code>Color</code>ï¼ˆå¯ä»¥è¯´æ˜¯ç±»ï¼Œç¼–è¯‘ä¹‹åæ˜¯ Color.classï¼‰.</p><p>ä¸Šé¢çš„å®šä¹‰ï¼Œè¿˜å¯ä»¥æ”¹æˆä¸‹é¢çš„è¿™ç§å½¢å¼:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Color</span> &#123;</span><br><span class="line">RED(), GREEN(), BLUE(), YELLOW();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œä½ å¯èƒ½ä¼šè§‰å¾—è¿·èŒ«ï¼ˆå¦‚æœä½ æ˜¯åˆå­¦è€…çš„è¯ï¼‰ï¼Œä¸ºä»€ä¹ˆè¿™æ ·å­ä¹Ÿå¯ä»¥ï¼Œwhyï¼Ÿ</p><p>å…¶å®ï¼Œæšä¸¾çš„æˆå‘˜å°±æ˜¯æšä¸¾å¯¹è±¡ï¼Œåªä¸è¿‡å®ƒä»¬æ˜¯é™æ€å¸¸é‡è€Œå·²ã€‚</p><p>ä½¿ç”¨ <code>javap</code> å‘½ä»¤ï¼ˆ<code>javap æ–‡ä»¶å&lt;æ²¡æœ‰åç¼€.class&gt;</code>ï¼‰å¯ä»¥åç¼–è¯‘ <code>class</code> æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š<br>â€‹â€‹â€‹â€‹<img src="/upload/images/2019/03/16/2.png" alt="1"></p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ™®é€šç±»æ¥æ¨¡æ‹Ÿæšä¸¾ï¼Œä¸‹é¢å®šä¹‰ä¸€ä¸ª <code>Color</code> ç±»ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Color</span> &#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Color</span> <span class="variable">RED</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Color</span>();</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Color</span> <span class="variable">GREEN</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Color</span>();</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Color</span> <span class="variable">BLUE</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Color</span>();</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Color</span> <span class="variable">YELLOW</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Color</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“åˆä¸Šå›¾åç¼–è¯‘çš„ç»“æœï¼Œåšä¸€ä¸‹å¯¹æ¯”ï¼Œä½ æ˜¯å¦çœ‹å‡ºäº†ä¸€ç‚¹ç«¯å€ªï¼ˆåç¬‘ï¼‰ï¼Œå¦‚æœæ²¡æœ‰çœ‹å‡ºæ¥ï¼Œé‚£å°±æ¥ç€å¾€ä¸‹çœ‹å§ã€‚</p><p>å¦‚æœæŒ‰ç…§è¿™ä¸ªé€»è¾‘ï¼Œæ˜¯å¦è¿˜å¯ä»¥ä¸ºå…¶æ·»åŠ å¦å¤–çš„æ„é€ æ–¹æ³•ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Color</span> &#123;</span><br><span class="line">RED(<span class="string">&quot;red color&quot;</span>, <span class="number">0</span>), GREEN(<span class="string">&quot;green color&quot;</span>, <span class="number">1</span>), </span><br><span class="line">BLUE(<span class="string">&quot;blue color&quot;</span>, <span class="number">2</span>), YELLOW(<span class="string">&quot;yellow color&quot;</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">Color(String name, <span class="type">int</span> id) &#123;</span><br><span class="line">_name = name;</span><br><span class="line">_id = id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">String _name;</span><br><span class="line"><span class="type">int</span> _id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸º <code>Color</code> å£°æ˜äº†ä¸¤ä¸ªæˆå‘˜å˜é‡ï¼Œå¹¶ä¸ºå…¶æ„é€ å¸¦å‚æ•°çš„æ„é€ å™¨ã€‚</p><p>å¦‚æœä½ è¿™æ ·åˆ›å»ºä¸€ä¸ªæšä¸¾:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Color</span> &#123;</span><br><span class="line">RED(<span class="string">&quot;red color&quot;</span>, <span class="number">0</span>), GREEN(<span class="string">&quot;green color&quot;</span>, <span class="number">1</span>), </span><br><span class="line">BLUE(<span class="string">&quot;blue color&quot;</span>, <span class="number">2</span>), YELLOW(<span class="string">&quot;yellow color&quot;</span>, <span class="number">3</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å™¨å°±ä¼šæŠ¥é”™:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The constructor EnumDemo.Color(String, int) is undefined</span><br></pre></td></tr></table></figure><p>åˆ°æ­¤ï¼Œä½ åº”è¯¥çœ‹æ˜ç™½äº†ï¼Œæšä¸¾å’Œæ™®é€šçš„ Java ç±»å¾ˆåƒã€‚</p><p>å¯¹äºç±»æ¥è®²ï¼Œæœ€å¥½å°†å…¶æˆå‘˜å˜é‡ç§æœ‰åŒ–ï¼Œå¹¶ä¸”ä¸ºæˆå‘˜å˜é‡æä¾› <code>get</code>ã€<code>set</code> æ–¹æ³•ã€‚</p><p>æŒ‰ç…§è¿™ä¸ªåŸåˆ™ï¼Œå¯ä»¥è¿›ä¸€æ­¥å†™å¥½ <code>enum Color</code>ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Color</span> &#123;</span><br><span class="line">RED(<span class="string">&quot;red color&quot;</span>, <span class="number">0</span>), GREEN(<span class="string">&quot;green color&quot;</span>, <span class="number">1</span>),</span><br><span class="line">BLUE(<span class="string">&quot;blue color&quot;</span>, <span class="number">2</span>), YELLOW(<span class="string">&quot;yellow color&quot;</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">Color(String name, <span class="type">int</span> id) &#123;</span><br><span class="line">_name = name;</span><br><span class="line">_id = id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> String _name;</span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> _id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">_name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line">_id = id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> _name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> _id;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ Java è®¾è®¡æšä¸¾çš„ç›®çš„æ˜¯æä¾›ä¸€ç»„å¸¸é‡ï¼Œæ–¹ä¾¿å¼€å‘è€…ä½¿ç”¨ã€‚å¦‚æœæˆ‘ä»¬å†’ç„¶çš„æä¾› <code>set</code> æ–¹æ³•ï¼ˆå¤–ç•Œå¯ä»¥æ”¹å˜å…¶æˆå‘˜å±æ€§ï¼‰ï¼Œå¥½åƒæœ‰ç‚¹è¿èƒŒäº†è®¾è®¡çš„åˆè¡·ã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬åº”è¯¥èˆå¼ƒ <code>set</code> æ–¹æ³•ï¼Œä¿ç•™ <code>get</code> æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Color</span> &#123;</span><br><span class="line">RED(<span class="string">&quot;red color&quot;</span>, <span class="number">0</span>), GREEN(<span class="string">&quot;green color&quot;</span>, <span class="number">1</span>),</span><br><span class="line">BLUE(<span class="string">&quot;blue color&quot;</span>, <span class="number">2</span>), YELLOW(<span class="string">&quot;yellow color&quot;</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">Color(String name, <span class="type">int</span> id) &#123;</span><br><span class="line">_name = name;</span><br><span class="line">_id = id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> String _name;</span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> _id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> _name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> _id;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºæ™®é€šçš„åŸºæœ¬ç±»å¯ä»¥å°†å…¶å®ä¾‹åŒ–ï¼Œé‚£ä¹ˆï¼Œèƒ½å¦å®ä¾‹åŒ–æšä¸¾å‘¢ï¼Ÿ</p><p>åœ¨å›ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œå…ˆæ¥çœ‹çœ‹ <code>Color.class</code> æ–‡ä»¶:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">enum</span> <span class="title class_">Color</span> &#123;</span><br><span class="line">RED(<span class="string">&quot;red color&quot;</span>, <span class="number">0</span>), GREEN(<span class="string">&quot;green color&quot;</span>, <span class="number">1</span>),</span><br><span class="line">BLUE(<span class="string">&quot;blue color&quot;</span>, <span class="number">2</span>), YELLOW(<span class="string">&quot;yellow color&quot;</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> String _name;</span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> _id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="title function_">Color</span><span class="params">(String name, <span class="type">int</span> id)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>._name = name;</span><br><span class="line"><span class="built_in">this</span>._id = id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">this</span>._name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">this</span>._id;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œç¼–è¯‘å™¨æ·˜æ°”çš„ä¸ºå…¶æ„é€ æ–¹æ³•åŠ ä¸Šäº† <code>private</code>ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æ— æ³•å®ä¾‹åŒ–æšä¸¾ã€‚</p><p>æ‰€æœ‰æšä¸¾ç±»éƒ½ç»§æ‰¿äº† <code>Enum</code> ç±»çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ <code>toString</code>ã€<code>equals</code>ã€<code>hashcode</code> ç­‰æ–¹æ³•ã€‚å› ä¸º <code>equals</code>ã€<code>hashcode</code>Â æ–¹æ³•æ˜¯ <code>final</code> çš„ï¼Œæ‰€ä»¥ä¸å¯ä»¥è¢«æšä¸¾é‡å†™ï¼ˆåªå¯ä»¥ç»§æ‰¿ï¼‰ï¼Œä½†å¯ä»¥é‡å†™ <code>toString</code>Â æ–¹æ³•ã€‚</p><p><strong>æ–‡æœ«çš„é™„å½•ä¸­æä¾›äº† <code>Enum</code> çš„æºç ï¼Œæœ‰å…´è¶£å¯ä»¥æŸ¥çœ‹é˜…è¯»ï¼</strong></p><p>é‚£ä¹ˆï¼Œä½¿ç”¨ Java çš„ç±»æ¥æ¨¡æ‹Ÿä¸€ä¸‹æšä¸¾ï¼Œå¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> mark.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Color</span> &#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Color</span> <span class="variable">RED</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Color</span>(<span class="string">&quot;red color&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Color</span> <span class="variable">GREEN</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Color</span>(<span class="string">&quot;green color&quot;</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Color</span> <span class="variable">BLUE</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Color</span>(<span class="string">&quot;blue color&quot;</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Color</span> <span class="variable">YELLOW</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Color</span>(<span class="string">&quot;yellow color&quot;</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> String _name;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> _id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="title function_">Color</span><span class="params">(String name, <span class="type">int</span> id)</span> &#123;</span><br><span class="line">_name = name;</span><br><span class="line">_id = id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> _name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> _id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Color&gt; <span class="title function_">values</span><span class="params">()</span> &#123;</span><br><span class="line">List&lt;Color&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Color&gt;();</span><br><span class="line">list.add(RED);</span><br><span class="line">list.add(GREEN);</span><br><span class="line">list.add(BLUE);</span><br><span class="line">list.add(YELLOW);</span><br><span class="line"><span class="keyword">return</span> list;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;the color _name=&quot;</span> + _name + <span class="string">&quot;, _id=&quot;</span> + _id;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p><strong>Enum.java</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> java.lang;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InvalidObjectException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectStreamException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * This is the common base class of all Java language enumeration types.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>  Josh Bloch</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>  Neal Gafter</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> %I%, %G%</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span>   1.5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Enum</span>&lt;E <span class="keyword">extends</span> <span class="title class_">Enum</span>&lt;E&gt;&gt;</span><br><span class="line">        <span class="keyword">implements</span> <span class="title class_">Comparable</span>&lt;E&gt;, Serializable &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The name of this enum constant, as declared in the enum declaration.</span></span><br><span class="line"><span class="comment">     * Most programmers should use the &#123;<span class="doctag">@link</span> #toString&#125; method rather than</span></span><br><span class="line"><span class="comment">     * accessing this field.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the name of this enum constant, exactly as declared in its</span></span><br><span class="line"><span class="comment">     * enum declaration.</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * &lt;b&gt;Most programmers should use the &#123;<span class="doctag">@link</span> #toString&#125; method in</span></span><br><span class="line"><span class="comment">     * preference to this one, as the toString method may return</span></span><br><span class="line"><span class="comment">     * a more user-friendly name.&lt;/b&gt;  This method is designed primarily for</span></span><br><span class="line"><span class="comment">     * use in specialized situations where correctness depends on getting the</span></span><br><span class="line"><span class="comment">     * exact name, which will not vary from release to release.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the name of this enum constant</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> String <span class="title function_">name</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The ordinal of this enumeration constant (its position</span></span><br><span class="line"><span class="comment">     * in the enum declaration, where the initial constant is assigned</span></span><br><span class="line"><span class="comment">     * an ordinal of zero).</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * Most programmers will have no use for this field.  It is designed</span></span><br><span class="line"><span class="comment">     * for use by sophisticated enum-based data structures, such as</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@link</span> java.util.EnumSet&#125; and &#123;<span class="doctag">@link</span> java.util.EnumMap&#125;.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> ordinal;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the ordinal of this enumeration constant (its position</span></span><br><span class="line"><span class="comment">     * in its enum declaration, where the initial constant is assigned</span></span><br><span class="line"><span class="comment">     * an ordinal of zero).</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * Most programmers will have no use for this method.  It is</span></span><br><span class="line"><span class="comment">     * designed for use by sophisticated enum-based data structures, such</span></span><br><span class="line"><span class="comment">     * as &#123;<span class="doctag">@link</span> java.util.EnumSet&#125; and &#123;<span class="doctag">@link</span> java.util.EnumMap&#125;.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the ordinal of this enumeration constant</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">ordinal</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> ordinal;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sole constructor.  Programmers cannot invoke this constructor.</span></span><br><span class="line"><span class="comment">     * It is for use by code emitted by the compiler in response to</span></span><br><span class="line"><span class="comment">     * enum type declarations.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name - The name of this enum constant, which is the identifier</span></span><br><span class="line"><span class="comment">     *               used to declare it.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ordinal - The ordinal of this enumeration constant (its position</span></span><br><span class="line"><span class="comment">     *         in the enum declaration, where the initial constant is assigned</span></span><br><span class="line"><span class="comment">     *         an ordinal of zero).</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="title function_">Enum</span><span class="params">(String name, <span class="type">int</span> ordinal)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.name = name;</span><br><span class="line"><span class="built_in">this</span>.ordinal = ordinal;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the name of this enum constant, as contained in the</span></span><br><span class="line"><span class="comment">     * declaration.  This method may be overridden, though it typically</span></span><br><span class="line"><span class="comment">     * isn&#x27;t necessary or desirable.  An enum type should override this</span></span><br><span class="line"><span class="comment">     * method when a more &quot;programmer-friendly&quot; string form exists.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the name of this enum constant</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns true if the specified object is equal to this</span></span><br><span class="line"><span class="comment">     * enum constant.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> other the object to be compared for equality with this object.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>  true if the specified object is equal to this</span></span><br><span class="line"><span class="comment">     *          enum constant.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object other)</span> &#123; </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>==other;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns a hash code for this enum constant.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> a hash code for this enum constant.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.hashCode();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Throws CloneNotSupportedException.  This guarantees that enums</span></span><br><span class="line"><span class="comment">     * are never cloned, which is necessary to preserve their &quot;singleton&quot;</span></span><br><span class="line"><span class="comment">     * status.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> (never returns)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">final</span> Object <span class="title function_">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">CloneNotSupportedException</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Compares this enum with the specified object for order.  Returns a</span></span><br><span class="line"><span class="comment">     * negative integer, zero, or a positive integer as this object is less</span></span><br><span class="line"><span class="comment">     * than, equal to, or greater than the specified object.</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * Enum constants are only comparable to other enum constants of the</span></span><br><span class="line"><span class="comment">     * same enum type.  The natural order implemented by this</span></span><br><span class="line"><span class="comment">     * method is the order in which the constants are declared.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(E o)</span> &#123;</span><br><span class="line"><span class="type">Enum</span> <span class="variable">other</span> <span class="operator">=</span> (Enum)o;</span><br><span class="line"><span class="type">Enum</span> <span class="variable">self</span> <span class="operator">=</span> <span class="built_in">this</span>;</span><br><span class="line"><span class="keyword">if</span> (self.getClass() != other.getClass() &amp;&amp; <span class="comment">// optimization</span></span><br><span class="line">      self.getDeclaringClass() != other.getDeclaringClass())</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ClassCastException</span>();</span><br><span class="line"><span class="keyword">return</span> self.ordinal - other.ordinal;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the Class object corresponding to this enum constant&#x27;s</span></span><br><span class="line"><span class="comment">     * enum type.  Two enum constants e1 and  e2 are of the</span></span><br><span class="line"><span class="comment">     * same enum type if and only if</span></span><br><span class="line"><span class="comment">     *   e1.getDeclaringClass() == e2.getDeclaringClass().</span></span><br><span class="line"><span class="comment">     * (The value returned by this method may differ from the one returned</span></span><br><span class="line"><span class="comment">     * by the &#123;<span class="doctag">@link</span> Object#getClass&#125; method for enum constants with</span></span><br><span class="line"><span class="comment">     * constant-specific class bodies.)</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the Class object corresponding to this enum constant&#x27;s</span></span><br><span class="line"><span class="comment">     *     enum type</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> Class&lt;E&gt; <span class="title function_">getDeclaringClass</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> getClass();</span><br><span class="line"><span class="type">Class</span> <span class="variable">zuper</span> <span class="operator">=</span> clazz.getSuperclass();</span><br><span class="line"><span class="keyword">return</span> (zuper == Enum.class) ? clazz : zuper;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the enum constant of the specified enum type with the</span></span><br><span class="line"><span class="comment">     * specified name.  The name must match exactly an identifier used</span></span><br><span class="line"><span class="comment">     * to declare an enum constant in this type.  (Extraneous whitespace</span></span><br><span class="line"><span class="comment">     * characters are not permitted.) </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> enumType the &lt;tt&gt;Class&lt;/tt&gt; object of the enum type from which</span></span><br><span class="line"><span class="comment">     *      to return a constant</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name the name of the constant to return</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the enum constant of the specified enum type with the</span></span><br><span class="line"><span class="comment">     *      specified name</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalArgumentException if the specified enum type has</span></span><br><span class="line"><span class="comment">     *         no constant with the specified name, or the specified</span></span><br><span class="line"><span class="comment">     *         class object does not represent an enum type</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> NullPointerException if &lt;tt&gt;enumType&lt;/tt&gt; or &lt;tt&gt;name&lt;/tt&gt;</span></span><br><span class="line"><span class="comment">     *         is null</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 1.5</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T <span class="keyword">extends</span> <span class="title class_">Enum</span>&lt;T&gt;&gt; T <span class="title function_">valueOf</span><span class="params">(Class&lt;T&gt; enumType,</span></span><br><span class="line"><span class="params">                                                String name)</span> &#123;</span><br><span class="line">        <span class="type">T</span> <span class="variable">result</span> <span class="operator">=</span> enumType.enumConstantDirectory().get(name);</span><br><span class="line">        <span class="keyword">if</span> (result != <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        <span class="keyword">if</span> (name == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>(<span class="string">&quot;Name is null&quot;</span>);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(</span><br><span class="line">            <span class="string">&quot;No enum const &quot;</span> + enumType +<span class="string">&quot;.&quot;</span> + name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">      * prevent default deserialization</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">readObject</span><span class="params">(ObjectInputStream in)</span> <span class="keyword">throws</span> IOException,</span><br><span class="line">        ClassNotFoundException &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">InvalidObjectException</span>(<span class="string">&quot;can&#x27;t deserialize enum&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">readObjectNoData</span><span class="params">()</span> <span class="keyword">throws</span> ObjectStreamException &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">InvalidObjectException</span>(<span class="string">&quot;can&#x27;t deserialize enum&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * enum classes cannot have finalize methods.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">finalize</span><span class="params">()</span> &#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> macOS java enum </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>json-c</title>
      <link href="/2019/03/10/json-c/"/>
      <url>/2019/03/10/json-c/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><a href="https://github.com/json-c/json-c">json-c</a> æ˜¯ C è¯­è¨€å†™çš„ä¸€å¥—æ„å»ºå’Œè§£æ JSON çš„åº“ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">JSON-C implements a reference counting object model that allows you to easily construct JSON objects in C, output them as JSON formatted strings and parse JSON formatted strings back into the C representation of JSON objects. </span><br><span class="line">It aims to conform to RFC 7159.</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ C è¯­è¨€ç¼–å†™çš„ JSON åº“è¿˜æœ‰å¾ˆå¤šï¼Œå¯ä»¥åœ¨ <a href="http://www.json.org/json-zh.html">ä»‹ç» JSON</a> ä¸­æŸ¥æ‰¾åˆ°ï¼Œé™¤äº† Cè¯­è¨€çš„è¿˜æœ‰å…¶ä»–è¯­è¨€ç¼–å†™çš„ JSON å¼€æºåº“ã€‚</p><p>æ‰€æœ‰å‘å¸ƒçš„ <code>json-c</code> åº“ç‰ˆæœ¬åœ¨ <a href="https://github.com/json-c/json-c/releases">è¿™é‡Œ</a> éƒ½å¯ä»¥æ‰¾åˆ°ï¼Œæœ¬ç¯‡ç¼–è¯‘çš„æ˜¯ <a href="https://github.com/json-c/json-c/releases/tag/json-c-0.13.1-20180305">json-c-0.13.1-20180305</a> è¿™ä¸ªç‰ˆæœ¬ã€‚</p><h2 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h2><p><strong>ä¸€ã€ä¸‹è½½ã€è§£å‹</strong></p><p>ç›´æ¥ä¸‹è½½æœ€æ–°ç‰ˆæœ¬ <a href="https://github.com/json-c/json-c/releases/tag/json-c-0.13.1-20180305">json-c-0.13.1-20180305</a>ï¼Œæˆªæ­¢åˆ°æœ¬æ–‡å‘å¸ƒè¯¥ç‰ˆæœ¬ä¸ºæœ€æ–°ç‰ˆæœ¬ã€‚</p><p>è§£å‹åˆšæ‰ä¸‹è½½å¥½çš„æ–‡ä»¶ï¼Œè§£å‹åå°†æ–‡ä»¶å¤¹é‡å‘½åä¸º <code>json-c-src</code>ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä¸é‡åå®ƒã€‚</p><p>æ‰“å¼€ macOS ç»ˆç«¯ï¼Œè¿›å…¥ <code>json-c-src</code> æ–‡ä»¶å¤¹</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> json-c-src</span><br></pre></td></tr></table></figure><p><strong>äºŒã€æºç ç¼–è¯‘</strong></p><p>åœ¨ç¼–è¯‘ä¹‹å‰ï¼Œç¡®ä¿ä½ å·²ç»åœ¨ macOS ä¸­å®‰è£…äº†ä¸‹é¢çš„å·¥å…·ï¼š</p><p><strong>1ã€</strong>gcc, clang, æˆ–è€…å…¶ä»– C ç¼–è¯‘å™¨ï¼›<br><strong>2ã€</strong>libtool å·¥å…·ï¼Œç‰ˆæœ¬ä¸èƒ½ä½äº 2.2.6bï¼›<br><strong>3ã€</strong>autoconf å·¥å…·ï¼Œç‰ˆæœ¬ä¸èƒ½ä½äº 2.64 (autoreconf)ï¼›<br><strong>4ã€</strong>automakeå·¥å…·ï¼Œç‰ˆæœ¬ä¸èƒ½ä½äº 1.13ï¼›</p><p>å¦‚æœæ²¡æœ‰å®‰è£…ä¸Šé¢çš„å·¥å…·ï¼Œå¯ä»¥ä½¿ç”¨ <code>Homebrew</code> è¿›è¡Œå®‰è£…ã€‚</p><p>åœ¨æ¡Œé¢æ–°å»ºä¸ªæ–‡ä»¶å¤¹ <code>json-c</code>ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹ç”¨æ¥æ”¾å¾…ä¼šç¼–è¯‘åçš„æ–‡ä»¶ï¼ˆåº“å’Œå¤´æ–‡ä»¶ï¼‰ã€‚</p><p>æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å¼€å§‹é…ç½®å’Œç¼–è¯‘ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/Users/man/Desktop/json-c</span><br><span class="line"></span><br><span class="line">make</span><br><span class="line"></span><br><span class="line">make install</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼š<code>/Users/man/Desktop/json-c</code> è¦å†™ç»å¯¹è·¯å¾„ï¼Œå¦åˆ™ç¼–è¯‘æŠ¥é”™ã€‚</p><p>å¦‚æœè¦æ”¯æŒå¤šçº¿ç¨‹ï¼Œå¯ä»¥åŠ ä¸Š <code>--enable-threading</code> è¿™ä¸ªé€‰é¡¹ï¼Œå³ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">./configure --enable-threading --prefix=/Users/man/Desktop/json-c</span><br><span class="line"></span><br><span class="line">make</span><br><span class="line"></span><br><span class="line">make install</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘æˆåŠŸåï¼Œåœ¨ <code>json-c</code> ä¼šç”Ÿæˆå¯¹åº”çš„åº“å’Œå¤´æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š<br><img src="/upload/images/2019/03/10/1.jpg"></p><p><img src="/upload/images/2019/03/10/2.jpg"></p><h2 id="ä½¿ç”¨-json-c"><a href="#ä½¿ç”¨-json-c" class="headerlink" title="ä½¿ç”¨ json-c"></a>ä½¿ç”¨ json-c</h2><p>ç¼–è¯‘æˆåŠŸåï¼Œå¯ä»¥è¯•ç”¨ä¸€ä¸‹ <code>json-c</code> è¿™ä¸ªåº“äº†ï¼Œæˆ‘æŠŠ <code>libjson-c.a</code> å’Œå¯¹åº”çš„ <code>include</code> æ–‡ä»¶å¤¹æ”¾è¿› macOS å·¥ç¨‹ï¼Œç¼–è¯‘æ— æ³•é€šè¿‡ï¼ŒæŠ¥é”™ï¼Œç„¶åæ¢ä¸º <code>libjson-c.4.dylib</code> ç¼–è¯‘é€šè¿‡ä½†æ˜¯è¿è¡ŒæŠ¥é”™ï¼Œæ„æ€æ˜¯æ— æ³•åŠ è½½è¯¥åº“ã€‚</p><p>åŒæ ·é“ç†ï¼Œåœ¨ iOS å·¥ç¨‹ä¸Šé¢ç›´æ¥ä½¿ç”¨è¿™ä¸¤ä¸ªåº“ä¹Ÿæ˜¯æ— æ³•ä½¿ç”¨ã€‚</p><p>äºæ˜¯æˆ‘å°±ä½¿ç”¨ <code>lipo</code> æ¥æŸ¥çœ‹ä¸€ä¸‹åº“æ‰€æ”¯æŒçš„æ¶æ„ï¼Œçœ‹ä¸€ä¸‹ä¸‹é¢çš„ç»“æœã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ lipo -info libjson-c.a </span><br><span class="line"></span><br><span class="line">Non-fat file: libjson-c.a is architecture: x86_64</span><br><span class="line"></span><br><span class="line">$ lipo -info libjson-c.4.dylib </span><br><span class="line"></span><br><span class="line">Non-fat file: libjson-c.4.dylib is architecture: x86_64</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºä¸¤ä¸ªåº“å‡å¯ä»¥æ”¯æŒ x86_64ï¼ŒæŒ‰é“ç†æ˜¯å¯ä»¥æ”¯æŒ macOS å’Œ iOS æ¨¡æ‹Ÿå™¨è¿è¡Œçš„ï¼ŒmacOS ä¸Šé¢å¯ä»¥ä½¿ç”¨ <code>set | grep &quot;MACHTYPE&quot;</code> å‘½ä»¤æŸ¥çœ‹å…¶æ“ä½œç³»ç»Ÿæ¶æ„ã€‚</p><p><code>libjson-c.a</code> æ˜¯é™æ€åº“ï¼Œ<code>libjson-c.4.dylib</code> æ˜¯åŠ¨æ€åº“ï¼Œå¯ä»¥ä½¿ç”¨ <code>file</code> å‘½ä»¤æŸ¥çœ‹ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ file libjson-c.a </span><br><span class="line"></span><br><span class="line">libjson-c.a: current ar archive</span><br><span class="line"></span><br><span class="line">$ file libjson-c.4.dylib </span><br><span class="line"></span><br><span class="line">libjson-c.4.dylib: Mach-O 64-bit dynamically linked shared library x86_64</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šæ˜¾ç¤º <code>ar archive</code> è¡¨ç¤ºæ˜¯é™æ€åº“ã€‚</p><p>æœ€åè‡ªå·±æ²¡æœ‰æ‰¾åˆ°å¥½çš„åŠæ³•ï¼Œåªèƒ½é‡‡å–ç¬¬äºŒä¸ªåŠæ³•ï¼Œæºç ç›´æ¥æ”¾è¿› Xcode å·¥ç¨‹é‡Œé¢ç¼–è¯‘ä½¿ç”¨ã€‚</p><p>åœ¨æ”¾è¿› Xcode å·¥ç¨‹ä¹‹å‰ï¼Œéœ€è¦å°†ä¸‹è½½çš„æºç è¿›è¡Œé…ç½®æ“ä½œï¼Œå³ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure</span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¼šäº§ç”Ÿå¯¹åº” <code>config.h</code> ç­‰æ–‡ä»¶ï¼Œç„¶åå°†æºç ä¸­æ‰€æœ‰ <code>.h</code> å’Œ <code>.c</code> çš„æ–‡ä»¶æ‹·è´è‡³å·¥ç¨‹ä¸­å³å¯ç¼–è¯‘ä½¿ç”¨äº†ã€‚</p><p><strong>æ³¨æ„</strong>ï¼šå¦‚æœä¸æ‰§è¡Œ <code>./configure</code> æ“ä½œï¼Œæ‹·è´çš„æºæ–‡ä»¶ä¸å…¨ï¼Œæ— æ³•é€šè¿‡ç¼–è¯‘ã€‚</p><p>ç®€å•ä¾‹å­ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="string">&quot;ViewController.h&quot;</span></span></span><br><span class="line"><span class="meta">#import <span class="string">&quot;json-c/json.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    json_object *jsonObj = <span class="literal">NULL</span>;</span><br><span class="line">    </span><br><span class="line">    jsonObj = json_tokener_parse(<span class="string">&quot;&#123; \&quot;uid\&quot;: 12, \&quot;name\&quot;: \&quot;foobar\&quot;, \&quot;isComer\&quot;: 1, \&quot;age\&quot;: 21, \&quot;extras\&quot;: [ 11, 52, 3, \&quot;unknow\&quot;, 75 ] &#125;&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *jsonString = json_object_to_json_string(jsonObj);</span><br><span class="line">    </span><br><span class="line">    printf(<span class="string">&quot;obj.to_string()=%s\n&quot;</span>, jsonString);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p>å¯¹åº”è¾“å‡ºç»“æœï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj.to_string()=&#123; &quot;uid&quot;: 12, &quot;name&quot;: &quot;foobar&quot;, &quot;isComer&quot;: 1, &quot;age&quot;: 21, &quot;extras&quot;: [ 11, 52, 3, &quot;unknow&quot;, 75 ] &#125;</span><br></pre></td></tr></table></figure><h2 id="ç–‘é—®"><a href="#ç–‘é—®" class="headerlink" title="ç–‘é—®"></a>ç–‘é—®</h2><p>Objective-C å·²ç»æä¾›äº†å…³äº JSON çš„åº“äº†ï¼Œå¹²å˜›è¿˜æŠ˜è…¾ json-c  å‘¢ï¼Ÿ</p><p>çš„ç¡®ï¼Œè‡ªä» iOS 5.0+ï¼ŒmacOS 10.7+ ä¹‹åï¼Œ<code>Foundation</code> æ¡†æ¶å·²ç»æä¾›äº† <code>NSJSONSerialization</code>ï¼Œæˆ‘ä¸»è¦æ˜¯å¥½å¥‡ <code>json-c</code> è¿™ä¸ªåº“ï¼Œçœ‹ä»–çš„è·¨å¹³å°èƒ½åŠ›è€Œå·²ã€‚</p><p>å…³äº <code>NSJSONSerialization</code> å¯ä»¥æŸ¥çœ‹ <a href="https://developer.apple.com/documentation/foundation/nsjsonserialization?language=objc">API æ–‡æ¡£</a>ã€‚</p><hr><p>æœ¬æ¬¡åˆ†äº«ï¼Œå‘Šè¾ï¼</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C json json-c </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸è§å¾—ä½ ä¼šè®¡ç®—Cå­—ç¬¦ä¸²é•¿åº¦</title>
      <link href="/2019/03/07/%E4%B8%8D%E8%A7%81%E5%BE%97%E4%BD%A0%E4%BC%9A%E8%AE%A1%E7%AE%97C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%95%BF%E5%BA%A6/"/>
      <url>/2019/03/07/%E4%B8%8D%E8%A7%81%E5%BE%97%E4%BD%A0%E4%BC%9A%E8%AE%A1%E7%AE%97C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%95%BF%E5%BA%A6/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><h2 id="C-å­—ç¬¦ä¸²"><a href="#C-å­—ç¬¦ä¸²" class="headerlink" title="C å­—ç¬¦ä¸²"></a>C å­—ç¬¦ä¸²</h2><p>åœ¨ C è¯­è¨€ä¸­ï¼Œå­—ç¬¦ä¸²å®é™…ä¸Šæ˜¯ä½¿ç”¨å­—ç¬¦ <code>&#39;\0&#39;</code> ç»ˆæ­¢çš„ä¸€ç»´å­—ç¬¦æ•°ç»„ã€‚</p><p>ä»¥ä¸‹å‡ ç§æ–¹å¼è¡¨ç¤ºçš„éƒ½æ˜¯ C å­—ç¬¦ä¸²çš„æ­£ç¡®è¡¨è¾¾æ–¹å¼ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¦ä»¥ &#x27;\0&#x27; ç»“å°¾</span></span><br><span class="line"><span class="type">char</span> greeting[<span class="number">6</span>] = &#123;<span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;\0&#x27;</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¦ä»¥ &#x27;\0&#x27; ç»“å°¾</span></span><br><span class="line"><span class="type">char</span> greeting[] = &#123;<span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;\0&#x27;</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é»˜è®¤ä¼šåœ¨æœ«å°¾å¢åŠ &#x27;\0&#x27;</span></span><br><span class="line"><span class="type">char</span> greeting[] = &#123;<span class="string">&quot;Hello&quot;</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸Šé¢çš„ç®€å†™å½¢å¼</span></span><br><span class="line"><span class="type">char</span> greeting[] = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é»˜è®¤ä¼šåœ¨æœ«å°¾å¢åŠ &#x27;\0&#x27;</span></span><br><span class="line"><span class="type">char</span> *greeting = <span class="string">&quot;Hello&quot;</span>;</span><br></pre></td></tr></table></figure><p>çœ‹ä¸‹é¢å¦å¤–ä¸€ç§å£°æ˜æ–¹å¼ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> greeting[] = &#123;<span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;o&#x27;</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;greeting: %s\n&quot;</span>, greeting);</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">greeting: hello\<span class="number">376</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç»“æœåœ¨ä¸åŒç¼–è¯‘å™¨ä¸‹é¢å¯èƒ½è¿˜ä¼šä¸ä¸€æ ·ï¼Œæ€»ä¹‹è¾“å‡ºéƒ½ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚è¿™ç§æ–¹å¼åˆ›å»ºçš„å­—ç¬¦ä¸²æ²¡æœ‰ <code>&#39;\0&#39;</code>ï¼Œä¸ç®—æ˜¯çœŸæ­£çš„ C å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å»ºè®®å¤§å®¶åœ¨å£°æ˜ C å­—ç¬¦ä¸²çš„æ—¶å€™ä½¿ç”¨å­—ç¬¦æŒ‡é’ˆï¼ˆchar *ï¼‰çš„æ–¹å¼ã€‚</p><p><code>string.h</code> é‡Œé¢å£°æ˜äº†å¾ˆå¤šå…³äºæ“ä½œ C å­—ç¬¦ä¸²çš„åº“å‡½æ•°ã€‚</p><h2 id="å­—ç¬¦ä¸²é•¿åº¦"><a href="#å­—ç¬¦ä¸²é•¿åº¦" class="headerlink" title="å­—ç¬¦ä¸²é•¿åº¦"></a>å­—ç¬¦ä¸²é•¿åº¦</h2><p>è¿™é‡Œåœ¨è¯´è®¡ç®—å­—ç¬¦ä¸²é•¿åº¦çš„å‰ææ˜¯å­—ç¬¦ç¼–ç éƒ½æ˜¯æŒ‰ç…§UTF-8ï¼ˆä¸­æ–‡å ç”¨3ä¸ªå­—èŠ‚ï¼Œè‹±æ–‡å ç”¨1ä¸ªå­—èŠ‚ï¼‰çš„ç¼–ç å½¢å¼ä¸ºå‰æçš„ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *greeting1 = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"><span class="type">char</span> greeting2[] = &#123;<span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;o&#x27;</span>&#125;;</span><br><span class="line"><span class="type">char</span> greeting3[] = &#123;<span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;\0&#x27;</span>&#125;;</span><br><span class="line"><span class="type">char</span> greeting4[] = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;greeting1 sizeOf: %ld, strlen: %ld\n&quot;</span>, <span class="keyword">sizeof</span>(greeting1), <span class="built_in">strlen</span>(greeting1));</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;greeting2 sizeOf: %ld, strlen: %ld\n&quot;</span>, <span class="keyword">sizeof</span>(greeting2), <span class="built_in">strlen</span>(greeting2));</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;greeting3 sizeOf: %ld, strlen: %ld\n&quot;</span>, <span class="keyword">sizeof</span>(greeting3), <span class="built_in">strlen</span>(greeting3));</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;greeting4 sizeOf: %ld, strlen: %ld\n&quot;</span>, <span class="keyword">sizeof</span>(greeting4), <span class="built_in">strlen</span>(greeting4));</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ èƒ½è¯´å‡ºä¸Šé¢ <code>printf</code> çš„ç»“æœï¼ŒåŸºæœ¬ä¸Šå…³äºè®¡ç®—å­—ç¬¦ä¸²é•¿åº¦çš„é—®é¢˜å°±è¿åˆƒè€Œè§£äº†ã€‚</p><p>æŒ‰ç…§ UTF-8 ç¼–ç ï¼Œä¸Šé¢ä¾‹å­çš„è¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">greeting1 sizeOf: 8, strlen: 5</span><br><span class="line">greeting2 sizeOf: 5, strlen: 7</span><br><span class="line">greeting3 sizeOf: 6, strlen: 5</span><br><span class="line">greeting4 sizeOf: 6, strlen: 5</span><br></pre></td></tr></table></figure><p>å¦‚æœè¾“å‡ºç»“æœä»¤ä½ æ— æ³•ç›¸ä¿¡ï¼Œå¯ä»¥é€‰æ‹©ç»§ç»­å¾€ä¸‹çœ‹æˆ–è€…ä½ è‡ªå·±å†™ä»£ç è¯•è¯•ã€‚</p><h2 id="sizeofã€strlen"><a href="#sizeofã€strlen" class="headerlink" title="sizeofã€strlen"></a>sizeofã€strlen</h2><p>åœ¨ <a href="https://linux.die.net/man/3/strlen">linux.die</a> å¯ä»¥æŸ¥åˆ° strlen çš„è¯´æ˜ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Synopsis:</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">size_t strlen(const char *s);</span><br><span class="line"></span><br><span class="line">Description:</span><br><span class="line">The strlen() function calculates the length of the string s, excluding the terminating null byte (aq\0aq).</span><br><span class="line"></span><br><span class="line">Return Value:</span><br><span class="line">The strlen() function returns the number of bytes in the string s.</span><br></pre></td></tr></table></figure><p>å‡½æ•° <code>strlen</code> è¿”å›å­—ç¬¦ä¸²é‡Œçš„å­—ç¬¦æ•°ï¼Œä¸åŒ…æ‹¬ç»ˆæ­¢å­—ç¬¦ <code>&#39;\0&#39;</code>ï¼Œè¿™é‡Œæ³¨æ„ <code>strlen</code> æ˜¯ä¸€ä¸ª C çš„å‡½æ•°ï¼Œè€Œ <code>sizeof</code> åªæ˜¯ä¸€ä¸ªæ“ä½œç¬¦ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œ<code>sizeof</code> æ“ä½œç¬¦çš„å‚æ•°å¯ä»¥æ˜¯æ•°ç»„ã€æŒ‡é’ˆã€ç±»å‹ã€å¯¹è±¡ã€å‡½æ•°ç­‰ï¼Œå‡½æ•° <code>strlen</code> çš„å‚æ•°åªèƒ½æ˜¯å­—ç¬¦ä¸²ã€‚</p><p>å¯¹äº <code>sizeof</code>ï¼Œ å…¶å‚æ•°ä¸åŒæ—¶ï¼Œå…¶è¿”å›çš„å€¼ä¹Ÿä¸ä¸€æ ·ï¼Œå¦‚ä¸‹ï¼š</p><p>1ã€æ•°ç»„ï¼šç¼–è¯‘æ—¶åˆ†é…çš„æ•°ç»„ç©ºé—´å¤§å°ï¼›<br>2ã€æŒ‡é’ˆï¼šå­˜å‚¨è¯¥æŒ‡é’ˆæ‰€ç”¨çš„ç©ºé—´å¤§å°(32ä½æœºå™¨ä¸Šæ˜¯4ï¼Œ64ä½æœºå™¨ä¸Šæ˜¯8)ï¼›<br>3ã€ç±»å‹ï¼šè¯¥ç±»å‹æ‰€å çš„ç©ºé—´å¤§å°ï¼›<br>4ã€å¯¹è±¡ï¼šå¯¹è±¡çš„å®é™…å ç”¨ç©ºé—´å¤§å°(è¿™ä¸ªæŒ‡çš„æ˜¯åœ¨ C++ ä¸­)ï¼›<br>5ã€å‡½æ•°ï¼šå‡½æ•°çš„è¿”å›ç±»å‹æ‰€å çš„ç©ºé—´å¤§å°ã€‚å‡½æ•°çš„è¿”å›ç±»å‹ä¸èƒ½æ˜¯ void ç±»å‹ï¼›</p><p>é‚£æˆ‘ä»¬å†å›å¤´çœ‹çœ‹ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘æŠŠè¦è¯´æ˜çš„å†™åœ¨æ³¨é‡Šä¸Šé¢äº†ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ³¨æ„è¿™é‡Œæ˜¯æŒ‡é’ˆ</span></span><br><span class="line"><span class="type">char</span> *greeting1 = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ²¡æœ‰ç»“æŸç¬¦ &#x27;\0&#x27;ï¼Œå…¶ strlen ç»“æœä¸ç¡®å®š</span></span><br><span class="line"><span class="type">char</span> greeting2[] = &#123;<span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;o&#x27;</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> greeting3[] = &#123;<span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;\0&#x27;</span>&#125;;</span><br><span class="line"><span class="type">char</span> greeting4[] = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    </span><br><span class="line"><span class="comment">/* ç»“æœæ˜¯ 8ã€5 */</span></span><br><span class="line"><span class="comment">/* greeting1æ˜¯æŒ‡é’ˆï¼ŒsizeOfè®¡ç®—çš„æ˜¯å…¶å­˜å‚¨è¯¥æŒ‡é’ˆæ‰€ç”¨çš„ç©ºé—´å¤§å°ï¼Œå› ä¸ºæˆ‘ä½¿ç”¨çš„æ˜¯64ä½ macOSï¼Œæ‰€ä»¥è¾“å‡ºæ˜¯8 */</span></span><br><span class="line"><span class="comment">/*strlen è®¡ç®—çš„æ˜¯å­—ç¬¦ä¸ªæ•°ä½†æ˜¯ä¸åŒ…æ‹¬ç»“æŸç¬¦ &#x27;\0&#x27;*/</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;greeting1 sizeOf: %ld, strlen: %ld\n&quot;</span>, <span class="keyword">sizeof</span>(greeting1), <span class="built_in">strlen</span>(greeting1));</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ç»“æœæ˜¯ 5ã€7 */</span></span><br><span class="line"><span class="comment">/* sizeof è®¡ç®—çš„æ˜¯ç¼–è¯‘æ—¶åˆ†é…çš„æ•°ç»„ç©ºé—´å¤§å°ï¼Œè¿™é‡Œæ˜¯5 */</span></span><br><span class="line"><span class="comment">/* greeting2æ²¡æœ‰ç»“æŸç¬¦ï¼Œstrlen çš„è®¡ç®—ç»“æœä¸ç¡®å®š */</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;greeting2 sizeOf: %ld, strlen: %ld\n&quot;</span>, <span class="keyword">sizeof</span>(greeting2), <span class="built_in">strlen</span>(greeting2));</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ç»“æœæ˜¯ 6ã€5 */</span></span><br><span class="line"><span class="comment">/* sizeof è®¡ç®—çš„æ˜¯ç¼–è¯‘æ—¶åˆ†é…çš„æ•°ç»„ç©ºé—´å¤§å°ï¼Œè¿™é‡Œæ˜¯6ï¼Œå› ä¸ºå¤šäº†ç»“æŸç¬¦ */</span></span><br><span class="line"><span class="comment">/*strlen è®¡ç®—çš„æ˜¯å­—ç¬¦ä¸ªæ•°ä½†æ˜¯ä¸åŒ…æ‹¬ç»“æŸç¬¦ &#x27;\0&#x27;*/</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;greeting3 sizeOf: %ld, strlen: %ld\n&quot;</span>, <span class="keyword">sizeof</span>(greeting3), <span class="built_in">strlen</span>(greeting3));</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ç»“æœæ˜¯ 6ã€5ï¼Œè¿™é‡Œç±»ä¼¼ä¸Šé¢çš„æƒ…å†µï¼Œä¸å†èµ˜è¿° */</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;greeting4 sizeOf: %ld, strlen: %ld\n&quot;</span>, <span class="keyword">sizeof</span>(greeting4), <span class="built_in">strlen</span>(greeting4));</span><br></pre></td></tr></table></figure><p><strong>å°ç»“</strong>ï¼š</p><p>1ã€<code>sizeof</code> æ˜¯ä¸€ä¸ªæ“ä½œç¬¦ï¼Œè€Œ <code>strlen</code> æ˜¯ C è¯­è¨€çš„åº“å‡½æ•°ã€‚</p><p>2ã€<code>sizeof</code> çš„å‚æ•°å¯ä»¥æ˜¯ä»»æ„æ•°æ®ç±»å‹æˆ–è€…è¡¨è¾¾å¼ï¼Œè€Œ <code>strlen</code> åªèƒ½ä»¥ç»“å°¾ä¸º <code>&#39;\0&#39;</code> çš„å­—ç¬¦ä¸²ä½œå‚æ•°ã€‚</p><p>3ã€<code>sizeof</code> çš„ç»“æœåœ¨ç¼–è¯‘æ—¶å°±è®¡ç®—å‡ºäº†ï¼Œè€Œ <code>strlen</code> å¿…é¡»åœ¨è¿è¡Œæ—¶æ‰èƒ½è®¡ç®—å‡ºæ¥ã€‚</p><p>4ã€<code>sizeof</code> è®¡ç®—æ•°æ®ç±»å‹å å†…å­˜çš„å¤§å°ï¼Œ<code>strlen</code> è®¡ç®—å­—ç¬¦ä¸²å®é™…é•¿åº¦ï¼Œè¦è®°ä½ <code>strlen</code> è®¡ç®—å‡ºæ¥çš„ç»“æœä¸åŒ…æ‹¬ç»“æŸç¬¦ <code>&#39;\0&#39;</code>ã€‚</p><p>5ã€<code>sizeof</code> ååº”çš„å¹¶éçœŸå®å­—ç¬¦ä¸²é•¿åº¦è€Œæ˜¯æ‰€å ç©ºé—´å¤§å°ï¼Œæ‰€ä»¥<code>memset</code> åˆå§‹åŒ–å­—ç¬¦ä¸²çš„æ—¶å€™ç”¨ <code>sizeof</code> è¾ƒå¥½ã€‚</p><p>6ã€ç³»ç»Ÿå‡½æ•°è¿”å›å€¼æ˜¯ <code>char *</code> (å­—ç¬¦æŒ‡é’ˆ)ç±»å‹çš„ä¼šåœ¨æœ«å°¾åŠ ä¸Šç»“æŸç¬¦ <code>&#39;\0&#39;</code>ã€‚</p><p>7ã€æ— è®ºæ˜¯ <code>sizeof</code> è¿˜æ˜¯ <code>strlen</code> è®¡ç®—ç»“æœçš„å•ä½éƒ½æ˜¯å­—èŠ‚ã€‚</p><p>æˆ‘ä»¬è¿˜éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼Œ<code>strlen</code> å‡½æ•°ï¼Œå½“æ•°ç»„åä½œä¸ºå‚æ•°ä¼ å…¥æ—¶ï¼Œå®é™…ä¸Šæ•°ç»„å°±é€€åŒ–æˆæŒ‡é’ˆäº†ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2019/03/07/1.jpg"></p><p>å¯ä»¥çœ‹å‡ºä¼ å…¥è¿›æ¥çš„å‚æ•°ä¼šè¢«é€€åŒ–ä¸ºæŒ‡é’ˆã€‚</p><h2 id="æ¢ç´¢æ— æ­¢å¢ƒ"><a href="#æ¢ç´¢æ— æ­¢å¢ƒ" class="headerlink" title="æ¢ç´¢æ— æ­¢å¢ƒ"></a>æ¢ç´¢æ— æ­¢å¢ƒ</h2><p>åœ¨æ–‡ç« çš„å¼€å§‹ï¼Œæˆ‘ç»™å‡ºäº†å‡ ç§ C å­—ç¬¦ä¸²çš„æ­£ç¡®è¡¨è¾¾æ–¹å¼ï¼Œé‚£æˆ‘ä»¬å†æ¥çœ‹å¦å¤–ä¸€ç§ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> greeting[<span class="number">4</span>] = <span class="string">&quot;blog&quot;</span>;</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹å¼çœ‹èµ·æ¥å¥½åƒå¾ˆå®Œç¾çš„æ ·å­ï¼Œå…¶å®æ˜¯ä¸å¯¹çš„ï¼Œå†™ä¸ªä¾‹å­ç»™å¤§å®¶ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">char</span> greeting[<span class="number">4</span>] = <span class="string">&quot;blog&quot;</span>;</span><br><span class="line"><span class="type">size_t</span> len = <span class="built_in">strlen</span>(greeting);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;greeting len: %ld\n&quot;</span>, len);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;greeting: %s\n&quot;</span>, greeting);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘è¿è¡Œï¼Œç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">greeting len: 10</span><br><span class="line">greeting: blog\330\365\277\357\376</span><br></pre></td></tr></table></figure><p>è‹å¤©å‘€ï¼Œè¿™ç»“æœè®©äººæ— è¯­ã€‚ã€‚ã€‚</p><p>å¯¹äº <code>char greeting[4] = &quot;blog&quot;</code> å…¶å®æ˜¯å®šä¹‰ä¸€ä¸ªé•¿åº¦ä¸º 4 çš„å­—ç¬¦æ•°ç»„ï¼Œä½†æ˜¯å­—ç¬¦ä¸² <code>&quot;blog&quot;</code> å®é™…æ˜¯è¦åŒ…æ‹¬ç»“æŸç¬¦ <code>\0</code> çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸‹é¢çš„ä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> greeting[<span class="number">4</span>] = <span class="string">&quot;blog&quot;</span>;</span><br></pre></td></tr></table></figure><p>æœ¬è´¨å’Œä¸‹é¢ä»£ç æ˜¯ä¸€æ ·çš„ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> greeting[] = &#123;<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;g&#x27;</span>&#125;;</span><br></pre></td></tr></table></figure><p>æ˜¾ç„¶æ˜¯ä¸æ­£ç¡®çš„ï¼Œé‚£æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// æ³¨æ„è¿™é‡Œæ˜¯ 5</span></span><br><span class="line"><span class="type">char</span> greeting[<span class="number">5</span>] = <span class="string">&quot;blog&quot;</span>;</span><br><span class="line"><span class="type">size_t</span> len = <span class="built_in">strlen</span>(greeting);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;greeting len: %ld\n&quot;</span>, len);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;greeting: %s\n&quot;</span>, greeting);</span><br><span class="line">    </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ–è€…è¿™æ ·å†™ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// è¿™é‡Œå¹²è„†ä¸è¦å†™æ•°å­—</span></span><br><span class="line"><span class="type">char</span> greeting[] = <span class="string">&quot;blog&quot;</span>;</span><br><span class="line">  <span class="type">size_t</span> len = <span class="built_in">strlen</span>(greeting);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;greeting len: %ld\n&quot;</span>, len);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;greeting: %s\n&quot;</span>, greeting);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¿®æ”¹åï¼Œå†ç¼–è¯‘è¿è¡Œç»“æœå°±å¯¹äº†ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">greeting len: <span class="number">4</span></span><br><span class="line">greeting: blog</span><br></pre></td></tr></table></figure><hr><p><strong>æˆ‘ä»¬çŸ¥é“çš„ä¸œè¥¿æ˜¯æœ‰é™çš„ï¼Œæˆ‘ä»¬ä¸çŸ¥é“çš„ä¸œè¥¿åˆ™æ˜¯æ— ç©·çš„ã€‚</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C char strlen sizeof </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS ä½¿ç”¨ libcurl</title>
      <link href="/2019/03/03/iOS-%E4%BD%BF%E7%94%A8-libcurl/"/>
      <url>/2019/03/03/iOS-%E4%BD%BF%E7%94%A8-libcurl/</url>
      
        <content type="html"><![CDATA[<h2 id="libcurl-ç®€ä»‹"><a href="#libcurl-ç®€ä»‹" class="headerlink" title="libcurl ç®€ä»‹"></a>libcurl ç®€ä»‹</h2><p><a href="https://curl.haxx.se/libcurl/">libcurl</a> æ˜¯ç”¨Cè¯­è¨€å†™çš„ä¸€å¥— <a href="https://github.com/curl/curl">å¼€æº</a> åº“ï¼Œæ˜¯ä¸ºç½‘ç»œå®¢æˆ·ç«¯æä¾›æ•°æ®ä¼ è¾“åŠŸèƒ½çš„å‡½æ•°åº“ã€‚</p><p><a href="https://curl.haxx.se/libcurl/">libcurl</a> æ”¯æŒ SMTPã€HTTPã€HTTPSã€FTPã€TELNET ç­‰åè®®å’Œå„ç§ SSL å®‰å…¨è®¤è¯ï¼Œæ”¯æŒ Solaris, NetBSD, FreeBSD, OpenBSD, Darwin, HPUX, IRIX, AIX, Tru64, Linux, UnixWare, HURD, Windows, Amiga, OS&#x2F;2, BeOs, Mac OS X, Ultrix, QNX, OpenVMS, RISC OS, Novell NetWare, DOS ç­‰å¹³å°ï¼Œåœ¨ Android å’Œ iOS ä¸Šé¢ä¹Ÿå¯ä»¥ä½¿ç”¨ libcurl è¿™ä¸ªåº“ã€‚</p><p>ä¸‹é¢æ˜¯å®˜ç½‘çš„è‹±æ–‡ç®€ä»‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">libcurl is a free and easy-to-use client-side URL transfer library, supporting DICT, FILE, FTP, FTPS, Gopher, HTTP, HTTPS, IMAP, IMAPS, LDAP, LDAPS, POP3, POP3S, RTMP, RTSP, SCP, SFTP, SMTP, SMTPS, Telnet and TFTP. </span><br><span class="line">libcurl supports SSL certificates, HTTP POST, HTTP PUT, FTP uploading, HTTP form based upload, proxies, cookies, user+password authentication (Basic, Digest, NTLM, Negotiate, Kerberos), file transfer resume, http proxy tunneling and more!</span><br><span class="line"></span><br><span class="line">libcurl is highly portable, it builds and works identically on numerous platforms, including Solaris, NetBSD, FreeBSD, OpenBSD, Darwin, HPUX, IRIX, AIX, Tru64, Linux, UnixWare, HURD, Windows, Amiga, OS/2, BeOs, Mac OS X, Ultrix, QNX, OpenVMS, RISC OS, Novell NetWare, DOS and more...</span><br><span class="line"></span><br><span class="line">libcurl is free, thread-safe, IPv6 compatible, feature rich, well supported, fast, thoroughly documented and is already used by many known, big and successful companies.</span><br></pre></td></tr></table></figure><h2 id="åˆ†äº«å†…å®¹"><a href="#åˆ†äº«å†…å®¹" class="headerlink" title="åˆ†äº«å†…å®¹"></a>åˆ†äº«å†…å®¹</h2><p>ä»Šå¤©è·Ÿå¤§å®¶åˆ†äº« libcurl åœ¨ iOS ä¸Šé¢å¦‚ä½•ä½¿ç”¨ï¼Œä¸»è¦åˆ†äº«å†…å®¹å¦‚ä¸‹ï¼š</p><p>1ã€iOS å·¥ç¨‹é›†æˆ libcurlä»¥åŠé›†æˆæ³¨æ„äº‹é¡¹ã€‚<br>2ã€åˆ©ç”¨ libcurl å‘é€ HTTP GET å’Œ POST è¯·æ±‚ã€‚<br>3ã€ä½¿ç”¨ springboot æ­å»ºæœ¬åœ°æœåŠ¡ï¼Œè¿™ä¸ªåªæ˜¯ä¸ºäº†æ¼”ç¤ºä¸æ˜¯åˆ†äº«çš„é‡ç‚¹ã€‚</p><h2 id="æ­å»ºæœ¬åœ°æœåŠ¡"><a href="#æ­å»ºæœ¬åœ°æœåŠ¡" class="headerlink" title="æ­å»ºæœ¬åœ°æœåŠ¡"></a>æ­å»ºæœ¬åœ°æœåŠ¡</h2><p>æœ¬åœ°æœåŠ¡é‡‡ç”¨ <code>Spring Boot</code> å¼€å‘ï¼Œå¼€å‘è¯­è¨€æ˜¯ <code>Java</code>ï¼ŒJDK ç‰ˆæœ¬1.8ï¼Œ<code>Spring Boot</code> ç‰ˆæœ¬æ˜¯ <code>v2.1.3.RELEASE</code>ï¼Œé›†æˆ <code>Web</code> ç»„ä»¶å³å¯ï¼Œæ¯”è¾ƒç®€å•ã€‚å…³äºå¦‚ä½•æ­å»º <code>Spring Boot</code>çš„å¼€å‘ç¯å¢ƒï¼Œå¤§å®¶è‡ªè¡Œæœç´¢è§£å†³ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨æˆ‘çš„ git å·¥ç¨‹ï¼Œ<a href="https://github.com/veryitman/tutorial_libcurl">çŒ›æˆ³å‰å¾€</a> å³å¯è·å–å®Œæ•´ä»£ç ç¤ºä¾‹ã€‚</p><p>å·¥ç¨‹ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2019/03/03/1.jpg"></p><p>å…³é”®ä»£ç å¦‚ä¸‹ï¼š<br><img src="/upload/images/2019/03/03/2.jpg"></p><p>è¯¥å·¥ç¨‹åªæ˜¯ä¸ºäº†é…åˆ libcurl çš„ä½¿ç”¨è€Œè¯ç”Ÿçš„ï¼Œæ²¡æœ‰ä»€ä¹ˆéš¾åº¦ã€‚</p><h2 id="é›†æˆ-libcurl"><a href="#é›†æˆ-libcurl" class="headerlink" title="é›†æˆ libcurl"></a>é›†æˆ libcurl</h2><p><strong>1ã€æ–°å»º iOS å·¥ç¨‹</strong></p><p>è¿™é‡Œå·¥ç¨‹ä¸º <code>tutorial_libcurl_iOS</code>ã€‚</p><p><strong>2ã€å‡†å¤‡åº“æ–‡ä»¶ã€å¤´æ–‡ä»¶</strong></p><p>libcurl å¯ä»¥è‡ªå·±ç¼–è¯‘ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åˆ«äººç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚æˆ‘ä½¿ç”¨çš„æ˜¯ <a href="https://github.com/gcesarmza/curl-android-ios.git">curl-android-ios </a> è¿™ä¸ªå·¥ç¨‹é‡Œé¢ç¼–è¯‘å¥½çš„æ–‡ä»¶ã€‚</p><p><img src="/upload/images/2019/03/03/3.jpg"></p><p><strong>3ã€ç»™å·¥ç¨‹ <code>tutorial_libcurl_iOS</code> æ·»åŠ åº“å’Œå¤´æ–‡ä»¶</strong></p><p>å°†ä¸Šé¢çš„æ–‡ä»¶æ‹·è´è‡³å·¥ç¨‹ç›®å½•å³å¯ï¼Œç°åœ¨å·¥ç¨‹ç›®å½•å¦‚ä¸‹ï¼š<br><img src="/upload/images/2019/03/03/4.jpg"></p><p><strong>4ã€è®¾ç½®è·¯å¾„</strong></p><p>åœ¨ xcode ä¸­ <code>Building Settings</code> æ‰¾åˆ° <code>User Header Search Paths</code> ä¸ºå¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(SRCROOT)/tutorial_libcurl_iOS/Classes</span><br></pre></td></tr></table></figure><p>è¿™ä¸€æ­¥ä¸æ˜¯å¿…é¡»çš„ï¼Œæˆ‘ä¸ªäººæ¯”è¾ƒå–œæ¬¢è¿™æ ·æ•´ç†å’Œè®¾ç½®ç›®å½•ã€‚</p><p><strong>5ã€æ·»åŠ  libz.tbd</strong></p><p><img src="/upload/images/2019/03/03/5.jpg"></p><p>å¦‚æœä¸æ·»åŠ è¿™ä¸ªåº“ï¼Œç¼–è¯‘æ— æ³•é€šè¿‡ï¼Œä¼šæ˜¾ç¤ºå¦‚ä¸‹é”™è¯¯ï¼š<br><img src="/upload/images/2019/03/03/6.jpg"></p><h2 id="å‘é€-HTTP-è¯·æ±‚"><a href="#å‘é€-HTTP-è¯·æ±‚" class="headerlink" title="å‘é€ HTTP è¯·æ±‚"></a>å‘é€ HTTP è¯·æ±‚</h2><p>ä¸‹é¢è¯´ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨ libcurl æ¥å‘é€ HTTP çš„ GET å’Œ POST è¯·æ±‚ã€‚åªç»™å‡ºæ ¸å¿ƒç¤ºä¾‹ä»£ç ï¼Œå…¶ä½™çš„å¤§å®¶å» <a href="https://github.com/veryitman/tutorial_libcurl">tutorial_libcurl</a> è·å–å®Œæ•´ç¤ºä¾‹ä»£ç ï¼ŒåŒ…æ‹¬ <code>Spring Boot</code> çš„ã€‚</p><p><strong>ViewController.m</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="string">&quot;ViewController.h&quot;</span></span></span><br><span class="line"><span class="meta">#import <span class="string">&quot;curl/curl.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ‘æœ¬æœºçš„ IP å’Œç«¯å£ï¼Œå®é™…ä½ è¦æ¢æˆä½ è‡ªå·±çš„</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> HOST_URL @<span class="string">&quot;http://172.20.10.2:8080/user&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">IBAction</span>)doHTTPGETToFileAction:(<span class="keyword">id</span>)sender</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *reqUrl = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@&quot;%@%@&quot;</span>, HOST_URL, <span class="string">@&quot;?id=1&amp;name=veryitman&quot;</span>];</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *url = [reqUrl cStringUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">    http_get_req(url);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">IBAction</span>)doHTTPPOSTToFileAction:(<span class="keyword">id</span>)sender</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *url = [HOST_URL cStringUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *data = <span class="string">&quot;id=2&amp;name=veryitman&quot;</span>;</span><br><span class="line">    http_post_req(url, data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> mark - C</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> http_get_req(<span class="keyword">const</span> <span class="keyword">char</span> *url)</span><br><span class="line">&#123;</span><br><span class="line">    CURL *curl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *fpath = rspDataPath(<span class="string">@&quot;http_get_rsp_data.log&quot;</span>);</span><br><span class="line"></span><br><span class="line">    FILE *fp;</span><br><span class="line">    fp = fopen(fpath, <span class="string">&quot;wt+&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">struct</span> curl_slist *headers = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="comment">//å¢åŠ HTTP header</span></span><br><span class="line">    headers = curl_slist_append(headers, <span class="string">&quot;Accept:application/json&quot;</span>);</span><br><span class="line">    headers = curl_slist_append(headers, <span class="string">&quot;Content-Type:application/json&quot;</span>);</span><br><span class="line">    headers = curl_slist_append(headers, <span class="string">&quot;charset:utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–</span></span><br><span class="line">    curl = curl_easy_init();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (curl) &#123;</span><br><span class="line">        <span class="comment">//æ”¹åè®®å¤´</span></span><br><span class="line">        curl_easy_setopt(curl, CURLOPT_HTTPHEADER, headers);</span><br><span class="line">        curl_easy_setopt(curl, CURLOPT_URL, url);</span><br><span class="line"></span><br><span class="line">        curl_easy_setopt(curl, CURLOPT_POST, url);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//wt+ï¼šè¯»å†™æ‰“å¼€æˆ–ç€å»ºç«‹ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼›å…è®¸è¯»å†™</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">NULL</span> != fp) &#123;</span><br><span class="line">            <span class="comment">// è¯·æ±‚ç»“æœå†™å…¥åˆ°æ–‡ä»¶å½“ä¸­</span></span><br><span class="line">            curl_easy_setopt(curl, CURLOPT_WRITEDATA, fp);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        CURLcode rsp_code = curl_easy_perform(curl);</span><br><span class="line">        <span class="keyword">if</span> (CURLE_OK == rsp_code) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@&quot;è¯·æ±‚è¿”å›æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@&quot;è¯·æ±‚è¿”å›å¤±è´¥ï¼Œè¿”å›ç æ˜¯ %i&quot;</span>, rsp_code);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        curl_slist_free_all(headers);</span><br><span class="line"></span><br><span class="line">        curl_easy_cleanup(curl);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fclose(fp);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> http_post_req(<span class="keyword">const</span> <span class="keyword">char</span> *url, <span class="keyword">const</span> <span class="keyword">char</span> *req_data)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *fpath = rspDataPath(<span class="string">@&quot;http_post_rsp_data.log&quot;</span>);</span><br><span class="line"></span><br><span class="line">    FILE *fp;</span><br><span class="line">    fp = fopen(fpath, <span class="string">&quot;wt+&quot;</span>);</span><br><span class="line"></span><br><span class="line">    CURL *curl;</span><br><span class="line">    curl = curl_easy_init();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (curl) &#123;</span><br><span class="line">        curl_easy_setopt(curl, CURLOPT_URL, url);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@&quot;length: %ld&quot;</span>, strlen(req_data));</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* size of the POST data */</span></span><br><span class="line">        curl_easy_setopt(curl, CURLOPT_POSTFIELDSIZE, strlen(req_data) + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* pass in a pointer to the data - libcurl will not copy */</span></span><br><span class="line">        curl_easy_setopt(curl, CURLOPT_POSTFIELDS, req_data);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">NULL</span> != fp) &#123;</span><br><span class="line">            <span class="comment">// è¯·æ±‚ç»“æœå†™å…¥åˆ°æ–‡ä»¶å½“ä¸­</span></span><br><span class="line">            curl_easy_setopt(curl, CURLOPT_WRITEDATA, fp);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        CURLcode rsp_code = curl_easy_perform(curl);</span><br><span class="line">        <span class="keyword">if</span> (CURLE_OK == rsp_code) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@&quot;è¯·æ±‚è¿”å›æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@&quot;è¯·æ±‚è¿”å›å¤±è´¥ï¼Œè¿”å›ç æ˜¯ %i&quot;</span>, rsp_code);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        curl_easy_cleanup(curl);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fclose(fp);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p>å¯åŠ¨ Spring Boot é¡¹ç›®ï¼Œå¯åŠ¨æˆåŠŸåï¼Œå†è¿è¡Œ xcode å·¥ç¨‹ï¼Œå¯ä»¥æµ‹è¯•ã€‚</p><p><img src="/upload/images/2019/03/03/7.jpg"></p><p>ç‚¹å‡»å¯¹åº”çš„æŒ‰é’®å°±å¯ä»¥å‘é€ GET å’Œ POST è¯·æ±‚äº†ã€‚</p><p>è¯·æ±‚è¿”å›çš„ç»“æœè¢«å†™å…¥åˆ°äº†æ²™ç›’æ–‡ä»¶ä¸­ï¼Œå¯ä»¥åœ¨ç»ˆç«¯ä½¿ç”¨ <code>cat</code> å‘½ä»¤æŸ¥çœ‹å¯¹åº”çš„å“åº”ç»“æœã€‚</p><p>GET å“åº”ç»“æœï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat ~/Library/Developer/CoreSimulator/Devices/BA882AC3-7977-49C7-8B0D-65EFD1541B68/data/Containers/Data/Application/3A21CFC5-3044-4FC0-9BFA-B311A59187AF/Documents/http_get_rsp_data.log</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user info: id=2 name=veryitman</span><br></pre></td></tr></table></figure><p>POST å“åº”ç»“æœ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat ~/Library/Developer/CoreSimulator/Devices/BA882AC3-7977-49C7-8B0D-65EFD1541B68/data/Containers/Data/Application/86E7D457-97B1-4D8C-80D5-E8179B691F76/Documents/http_post_rsp_data.log</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user info: id=2 name=veryitman</span><br></pre></td></tr></table></figure><p>åç»­ä¸ºå¤§å®¶åˆ†äº«å¦‚ä½•ä½¿ç”¨å›è°ƒæ¥æ¥æ”¶ HTTP å“åº”æ•°æ®ã€å…¶ä»–ç½‘ç»œè¯·æ±‚çš„æƒ…å†µä»¥åŠ Android ä¸Šé¢å¦‚ä½•ä½¿ç”¨ libcurl åº“ã€‚</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼ŒæœŸå¾…ä¸ä½ çš„äº¤æµ~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> curl libcurl springboot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Emscriptenï¼šJS è°ƒç”¨ Cã€C++</title>
      <link href="/2019/03/02/Emscripten-JS-%E8%B0%83%E7%94%A8-C-C++/"/>
      <url>/2019/03/02/Emscripten-JS-%E8%B0%83%E7%94%A8-C-C++/</url>
      
        <content type="html"><![CDATA[<p>åœ¨ <a href="http://www.veryitman.com/2019/02/15/%E4%BA%86%E8%A7%A3-Emscripten/">äº†è§£ Emscripten</a> ä¸­ï¼Œç»™å¤§å®¶ç®€å•åˆ†äº«äº† <code>Emscripten</code> æ˜¯ä»€ä¹ˆä»¥åŠå…¶ä½¿ç”¨åœºæ™¯ã€‚ä»Šå¤©ç»§ç»­åˆ†äº«å¦‚ä½•ä½¿ç”¨ JS è°ƒç”¨ C&#x2F;C++ ä»£ç ã€‚</p><h2 id="ç¥å¥‡çš„-main-å‡½æ•°"><a href="#ç¥å¥‡çš„-main-å‡½æ•°" class="headerlink" title="ç¥å¥‡çš„ main å‡½æ•°"></a>ç¥å¥‡çš„ main å‡½æ•°</h2><p>ä¸‹é¢æ˜¯ <a href="http://www.veryitman.com/2019/02/15/%E4%BA%86%E8%A7%A3-Emscripten/">äº†è§£ Emscripten</a> ä¸­çš„ä¾‹å­ä»£ç ï¼Œåªæœ‰ä¸€ä¸ª <code>main</code> å‡½æ•°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">int main(int argc, char ** argv) </span><br><span class="line">&#123;</span><br><span class="line">    printf(&quot;Emscripten show in browser...\n&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>Emscripten SDK</code> ç¼–è¯‘åç”Ÿæˆäº†å¯¹åº”çš„ htmlã€js å’Œ wasm æ–‡ä»¶ã€‚</p><p>ç¬¬ä¸€æ¬¡ç¼–è¯‘ä¼šè¾ƒæ…¢, ç¼–è¯‘å®Œæˆåä¼šåœ¨ <code>~/.emscripten_cache</code> ç”Ÿæˆç¼“å­˜ç›®å½•å’Œç¼“å­˜æ–‡ä»¶, ä»¥åå†æ¬¡ç¼–è¯‘å°±æ¯”è¾ƒå¿«äº†.</p><p>å¯ä»¥åœ¨ç«ç‹æˆ–è€… <code>Chrome</code> æˆ–è€… <code>Safari</code> ä¸Šé¢è¿è¡Œ <code>h_emcc.html</code> æ–‡ä»¶.</p><p>è¿™é‡Œåœ¨ç«ç‹æµè§ˆå™¨ä¸Šé¢å¯ä»¥ç›´æ¥æ‰“å¼€ <code>mz.html</code> æ–‡ä»¶, å¦‚æœæ˜¯åœ¨ <code>Chrome</code> æˆ–è€… <code>Safari</code> éœ€è¦æ‰§è¡Œä¸‹é¢å‘½ä»¤:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emrun mz.html </span><br></pre></td></tr></table></figure><p>æˆ–è€…æŒ‡å®šæµè§ˆå™¨æ‰“å¼€è¯¥æ–‡ä»¶.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emrun --browser chrome mz.html</span><br></pre></td></tr></table></figure><p>å…³äº <code>emrun</code> çš„å…¶ä»–ç”¨æ³•ï¼Œå¯ä»¥ä½¿ç”¨ <code>emrun --help</code> æ¥æŸ¥çœ‹ã€‚è¿™é‡Œåœ¨æµè§ˆå™¨å¯ä»¥çœ‹åˆ°å¯¹åº” <code>main</code> å‡½æ•°çš„è¾“å‡ºï¼Œè¯´æ˜ <code>Emscripten</code> ç”Ÿæˆçš„ä»£ç é»˜è®¤ä¼šè°ƒç”¨ <code>main</code> å‡½æ•°ã€‚</p><h2 id="EMSCRIPTEN-KEEPALIVE"><a href="#EMSCRIPTEN-KEEPALIVE" class="headerlink" title="EMSCRIPTEN_KEEPALIVE"></a>EMSCRIPTEN_KEEPALIVE</h2><p>æ—¢ç„¶ <code>Emscripten</code> ç”Ÿæˆçš„ä»£ç é»˜è®¤ä¼šè°ƒç”¨ <code>main</code> å‡½æ•°ï¼Œé‚£ä¹ˆå¦‚æœæƒ³ä½¿ç”¨å…¶ä»–å‡½æ•°æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å¯ä»¥åœ¨å‡½æ•°å‰æ·»åŠ  <code>EMSCRIPTEN_KEEPALIVE</code>ï¼Œå®ƒåœ¨<code>emscripten.h</code> æ–‡ä»¶ä¸­æœ‰å£°æ˜ï¼Œè¿™ä¸ªå¯ä»¥é€šè¿‡æºç æŸ¥çœ‹ã€‚</p><p>ä¸‹é¢è¿˜æ˜¯ä¸¾ä¸ªä¾‹å­æ¥è¯´æ˜ã€‚</p><p><strong>my.html</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en-us&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- çœç•¥... --&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">document.querySelector(&#x27;.mybutton&#x27;).addEventListener(&#x27;click&#x27;, function()&#123;</span><br><span class="line">          alert(&#x27;æ£€æŸ¥æ§åˆ¶å°&#x27;);</span><br><span class="line">          var result = Module.ccall(&#x27;sum&#x27;, // name of C function</span><br><span class="line">                                     null, // return type</span><br><span class="line">                                     null, // argument types</span><br><span class="line">                                     null); // arguments</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;hello3.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>é‡Œé¢å¼•ç”¨äº† <code>hello3.js</code> å¹¶ä¸”ä½¿ç”¨ <code>Module.ccall</code> è°ƒç”¨äº† C å‡½æ•° <code>sum</code>ã€‚</p><p><strong>hello.c</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;emscripten/emscripten.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> ** argv)</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello emcc\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> __cplusplus</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> EMSCRIPTEN_KEEPALIVE <span class="title function_">sum</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;sum = %i\n&quot;</span>, <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> __cplusplus</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>ç¼–è¯‘ <code>hello.c</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emcc -o hello.html hello.c -O3 -s &quot;EXTRA_EXPORTED_RUNTIME_METHODS=[&#x27;ccall&#x27;]&quot;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼š<code>EXTRA_EXPORTED_RUNTIME_METHODS</code> è®¾ç½®äº† Module çš„å¯¼å‡ºå‡½æ•°ï¼Œä¸å¯¼å‡º <code>ccall</code> çš„è¯ï¼Œä¼šæŠ¥ä»¥ä¸‹é”™è¯¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;ccall&#x27; was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)</span><br></pre></td></tr></table></figure><p>ç°åœ¨å¯ä»¥è¿è¡Œ <code>my.html</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emrun my.html</span><br></pre></td></tr></table></figure><p><img src="/upload/images/2019/03/02/1.jpg"></p><p>å¯ä»¥ä¿®æ”¹ä¸€ä¸‹ sum å‡½æ•°ï¼Œä½¿å…¶å¸¦å‚æ•°ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;emscripten/emscripten.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> ** argv)</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello World emcc\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> __cplusplus</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> EMSCRIPTEN_KEEPALIVE <span class="title function_">sum</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;sum = %i\n&quot;</span>, (a+b));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> __cplusplus</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>éœ€è¦ä¿®æ”¹ <code>my.html</code> æ–‡ä»¶ï¼Œä¿®æ”¹å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var result = Module.ccall(&#x27;sum&#x27;, // name of C function</span><br><span class="line">                                     null, // return type</span><br><span class="line">                                     [&#x27;number&#x27;], // argument types</span><br><span class="line">                                     [12, 13]); // arguments</span><br></pre></td></tr></table></figure><p>æ³¨æ„ <code>argument types</code> å’Œ <code>arguments</code> çš„å¡«å†™ï¼Œè¿è¡Œå¯ä»¥çœ‹åˆ°é¢„æœŸæ•ˆæœã€‚</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Emscripten wasm JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†·ç¬‘è¯çš„å¯ç¤º</title>
      <link href="/2019/02/24/%E5%86%B7%E7%AC%91%E8%AF%9D%E7%9A%84%E5%90%AF%E7%A4%BA/"/>
      <url>/2019/02/24/%E5%86%B7%E7%AC%91%E8%AF%9D%E7%9A%84%E5%90%AF%E7%A4%BA/</url>
      
        <content type="html"><![CDATA[<p>å‡ ä¹æ‰€æœ‰äººéƒ½æ¯”è¾ƒå–œæ¬¢å¬æˆ–è€…çœ‹ç¬‘è¯æ•…äº‹ï¼Œç¬‘è¯æ•…äº‹å¯ä»¥è®©ä½ å¼€å¿ƒï¼Œä¹Ÿå¯èƒ½è®©ä½ éšæ—¶å“ˆå“ˆå¤§ç¬‘ã€‚ä¸‹é¢å‡ åˆ™ç¬‘è¯æ•…äº‹ï¼Œåœ¨ç¬‘çš„åŒæ—¶å¯ä»¥æƒ³æƒ³å…¶ä¸­è•´è—çš„é“ç†ã€‚</p><hr><p>å¥³æµ´å®¤èµ·ç«ï¼Œé‡Œé¢äººä¹±ä½œä¸€å›¢ï¼Œèµ¤è£¸èº«ä½“å¾€å¤–è·‘ï¼Œåªè§å¤§è¡—ä¸Šç™½èŠ±èŠ±ä¸€å¤§ç¾¤ï¼Œä¸€è€è€…å¤§å–Šâ€œå¿«æ‚ä½â€ï¼Œä¼—è£¸å¥³çªç„¶é†’æ‚Ÿï¼Œä½†èº«ä¸Šè¦ç´§éƒ¨ä½æœ‰ä¸‰å¤„ï¼Œæ‰‹å¿™è„šä¹±æ‚ä¸è¿‡æ¥ï¼Œä¸çŸ¥æ‰€æªã€‚è¿™æ—¶è€è€…åˆå¤§å–Šï¼šâ€œæ‚è„¸å°±è¡Œï¼Œä¸‹é¢éƒ½ä¸€æ ·ï¼â€</p><blockquote><p>ğŸ˜† åœ¨ç‰¹æ®Šæƒ…å†µä¸‹æŠ“å·¥ä½œä¸å¯èƒ½é¢é¢ä¿±åˆ°ï¼Œè¦æŠ“ä½é‡ç‚¹ã€‚</p></blockquote><hr><p>å°‘å¦‡æŠ¥æ¡ˆï¼šâ€œæˆ‘æŠŠé’±æ”¾åœ¨èƒ¸è¡£å†…ï¼Œåœ¨æ‹¥æŒ¤çš„åœ°é“å†…è¢«ä¸€å¸…å“¥å·èµ°äº†â€¦â€è­¦å¯Ÿçº³é—·ï¼šâ€œè¿™ä¹ˆæ•æ„Ÿçš„åœ°æ–¹ä½ å°±æ²¡è§‰å¯Ÿåˆ°ï¼Ÿâ€å°‘å¦‡çº¢ç€è„¸ç­”ï¼šâ€œè°èƒ½æƒ³åˆ°ä»–æ˜¯æ‘¸é’±å‘¢ï¼Ÿâ€</p><blockquote><p>ğŸ˜† è®©å®¢æˆ·çš„é’±åœ¨æ„‰å¿«ä½“éªŒä¸­ä¸çŸ¥ä¸è§‰åœ°è¢«æ‘¸èµ°ï¼Œæ˜¯å•†ä¸šæ¨¡å¼çš„æœ€é«˜å¢ƒç•Œã€‚</p></blockquote><hr><p>æŸå¯Œç¿æƒ³å¨¶è€å©†ï¼Œæœ‰ä¸‰ä¸ªäººé€‰ï¼Œå¯Œç¿ç»™äº†ä¸‰ä¸ªå¥³å­©å„ä¸€åƒå…ƒï¼Œè¯·å¥¹ä»¬æŠŠæˆ¿é—´è£…æ»¡ã€‚ç¬¬ä¸€ä¸ªå¥³å­©ä¹°äº†å¾ˆå¤šæ£‰èŠ±ï¼Œè£…æ»¡æˆ¿é—´çš„1&#x2F;2ã€‚ç¬¬äºŒä¸ªå¥³å­©ä¹°äº†å¾ˆå¤šæ°”çƒï¼Œè£…æ»¡æˆ¿é—´çš„3&#x2F;4ã€‚ç¬¬ä¸‰ä¸ªå¥³å­©ä¹°äº†å¾ˆå¤šèœ¡çƒ›ï¼Œè®©å…‰çº¿å……æ»¡æˆ¿é—´ã€‚ æœ€ç»ˆï¼Œå¯Œç¿é€‰äº†èƒ¸éƒ¨æœ€å¤§çš„é‚£ä¸ªã€‚</p><blockquote><p>ğŸ˜† æŠŠæ¡å®¢æˆ·å†…å¿ƒçŒ¥çä½†çœŸå®çš„éœ€æ±‚è‡³å…³é‡è¦ã€‚</p></blockquote><hr><p>å¾ˆå¤šå¹´å‰è®¤è¯†ä¸€å°ä¸‰ï¼Œå½“ç„¶æ˜¯åˆ«äººçš„å°ä¸‰ï¼Œä½†è¿™å°ä¸‰ç®—æ˜¯æœ‰æœ¬é¢†çš„ï¼Œä¸ä»…äººé•¿çš„æ¼‚äº®ï¼Œé•¿å‘é£˜é£˜ï¼Œä¹Ÿå¾ˆæœ‰è„‘ã€‚çˆ±ä¸ŠæŸé‡‘èç•Œäººå£«ï¼Œä½†äººå®¶å·²æœ‰å¦»å®¤ï¼Œè¿™å°ä¸‰ä¸å±ˆä¸æŒ ï¼ŒæŠ•å…¶æ‰€å¥½ï¼ŒçŸ¥é“ç”·äººçƒ­çˆ±å¤è¯—è¯ï¼Œå°ä¸‰æ¥æ˜¯ç”¨äº†ä¸é•¿çš„æ—¶é—´å°†å”è¯—ä¸‰ç™¾é¦–å€’èƒŒå¦‚æµï¼Œå°ä¸‰ä¾¿è½¬æ­£äº†ã€‚</p><blockquote><p>ğŸ˜† æ²¡æœ‰æ‹†ä¸æ•£çš„å¤«å¦»ï¼Œåªæœ‰ä¸åŠªåŠ›çš„å°ä¸‰ï¼</p></blockquote><hr><p>ä¸€ç”·å­åœ¨ç‹±ä¸­é—²æ¥æ— äº‹è®­ç»ƒèš‚èšï¼Œèš‚èšå¯åœ¨ä»–æŒ‡ä»¤ä¸‹å€’ç«‹ã€ç¿»è·Ÿå¤´ ã€é èº¬â€¦. å‡ºç‹±åï¼Œç”·å­è¿«ä¸åŠå¾…å»é…’å§ç‚«è€€ä»–çš„ç»æ´»ï¼Œä»–ç‚¹äº†ä¸€æ¯å•¤é…’ï¼Œç„¶åï¼Œæå‡ºèš‚èšæ”¾åœ¨æ¡Œä¸Šå¯¹æœåŠ¡å‘˜è¯´ï¼šçœ‹ï¼Œè¿™åªèš‚èšã€‚æœåŠ¡å‘˜è½¬èº«ä¸€æŒæ‹æ­»äº†èš‚èšï¼ŒæŠ±æ­‰åœ°å¯¹ä»–è¯´è¯´ï¼šå¯¹ä¸èµ·å…ˆç”Ÿï¼Œæˆ‘é©¬ä¸Šç»™æ‚¨æ¢ä¸€æ¯!</p><blockquote><p>ğŸ˜† é‡äº‹è¦ä¸‰æ€è€Œåè¡Œã€‚</p></blockquote><p>ä»å‰æœ‰åªç¾Šï¼Œå®ƒä¸€å¤©å¹²10ä¸ªå°æ—¶çš„æ´»ã€‚æœ‰ä¸€å¤©å®ƒçš„ä¸»äººå‘Šè¯‰å®ƒï¼Œä½ å¥½å¥½å¹²ï¼Œå¤šå¹²æ´»æœ‰å¥–åŠ±ï¼Œäºæ˜¯å®ƒç…§åšäº†ã€‚æ¥ä¸‹æ¥æ¯ä¸ªæœˆå®ƒçš„ä¸»äººæŠŠå®ƒèº«ä¸Šçš„ç¾Šæ¯›å‰ªäº†ä¸‰åˆ†ä¹‹ä¸€ ï¼Œå¹´åº•åˆ°äº†ï¼Œç»™å®ƒç»‡äº†ä»¶æ¯›è¡£ï¼Œç„¶åå‘Šè¯‰å®ƒï¼šè¯ºï¼Œè¿™æ˜¯ä½ çš„å¥–åŠ±ï¼Œæ­å–œä½ ï¼Œç»§ç»­åŠªåŠ›å§ï¼</p><blockquote><p>ğŸ˜† è¿™ç¬‘è¯å‘Šè¯‰æˆ‘ä»¬ï¼šç¾Šæ¯›å‡ºåœ¨ç¾Šèº«ä¸Šã€‚</p></blockquote><hr><p>èµµå››å°å§ä»åå…­å²å¼€å§‹è·Ÿå¼ å­¦è‰¯ã€‚è·Ÿä¸€å¹´ï¼Œå±å¥¸æƒ…ï¼›è·Ÿä¸‰å¹´ï¼Œç®—{æ•æ„Ÿè¯}ï¼›è·Ÿå…­åå¹´ï¼Œä¾¿æˆä¸ºåƒå¤çˆ±æƒ…ï¼</p><blockquote><p>ğŸ˜† å¾ˆå¤šäº‹æƒ…ä¸çœ‹åšä¸åšï¼Œè€Œçœ‹ä½ åšå¤šä¹…ã€‚</p></blockquote><hr><p>æ°‘å›½åˆåå¦“å°å‡¤ä»™ï¼Œå¦‚æœè·Ÿäº†æ°‘å·¥ï¼Œå°±å±äºæ‰«é»„å¯¹è±¡ï¼›å¥¹è·Ÿäº†è”¡é”·ï¼Œåˆ™åƒå¤ç•™èŠ³äº†ï¼›å€˜è‹¥å¥¹è·Ÿäº†å­™ä¸­å±±ï¼Œé‚£ä¾¿å¯èƒ½æˆä¸ºå›½æ¯ã€‚</p><blockquote><p>ğŸ˜† ä¸åœ¨äºä½ å¹²ä»€ä¹ˆï¼Œè€Œçœ‹ä½ è·Ÿè°å¹²ã€‚</p></blockquote><hr><p>ç»„ç»‡å‡ ä¸ªäººæ”¶ä¿æŠ¤è´¹ï¼Œé‚£æ˜¯é»‘ç¤¾ä¼šã€‚æœ±å…ƒéšœç»„ç»‡å‡ ç™¾ä¸‡äººæŠ¢ä¸‹ç‹ä½ï¼Œå°±æ˜¯ä¼Ÿå¤§çš„çš‡å¸ã€‚æ­¦åˆ™å¤©ç¡äº†å…¬å…¬ç¡å„¿å­ï¼Œè™½å±ä¹±*ä¼¦ï¼Œä½†ä¹±çš„å¤Ÿå¤§ï¼Œæ•…æˆä¸ºå¥³çš‡ã€‚</p><blockquote><p>ğŸ˜† ä¸åœ¨ä½ å¹²æ²¡å¹²åäº‹ï¼Œè€Œåœ¨äºå¹²å¤šå¤§ï¼</p></blockquote><hr><p>ä¸€å…¬å¸åœ¨å°ä¾¿æ± ä¸Šè´´ä¸Šæ¡ï¼šâ€œå¾€å‰ä¸€å°æ­¥ï¼Œæ–‡æ˜ä¸€å¤§æ­¥â€ï¼Œç»“æœåœ°ä¸Šä»æœ‰è®¸å¤šå°¿æ¸ã€‚åæ¥å…¬å¸è®¤çœŸå¸å–æ•™è®­ï¼Œé‡æ–°è®¾è®¡æˆï¼šâ€œå°¿ä¸åˆ°æ± é‡Œè¯´æ˜ä½ çŸ­ï¼›å°¿åˆ°æ± å¤–è¯´æ˜ä½ è½¯â€ï¼Œç»“æœåœ°ä¸Šæ¯”ä»¥å‰å¹²å‡€è®¸å¤šã€‚</p><blockquote><p>ğŸ˜† ç»™å®¢æˆ·çš„æŠ•èµ„å»ºè®®ä¸€å®šè¦å…·ä½“ï¼Œç¡®åˆ‡ï¼Œä¸­è¦å®³ã€‚</p></blockquote><hr><p>æŸæ—¥ï¼Œå¥³ç§˜ä¹¦ç¥è‰²å‡é‡åœ°è¯´ï¼šç‹æ€»ï¼Œæˆ‘æ€€å­•äº†ã€‚ ç‹ç»§ç»­ä½å¤´çœ‹æ–‡ä»¶ï¼Œç„¶åæ·¡æ·¡ä¸€ç¬‘ï¼šæˆ‘æ—©ç»“æ‰äº†ã€‚ å¥³ç§˜ä¹¦æ¥äº†ä¸€ä¼šåªšç¬‘é“ï¼šæˆ‘å’Œæ‚¨å¼€ç©ç¬‘å‘¢! ç‹æŠ¬èµ·å¤´çœ‹äº†å¥¹ä¸€çœ¼ï¼Œå–äº†å£èŒ¶è¯´ï¼šæˆ‘ä¹Ÿæ˜¯ã€‚</p><blockquote><p>ğŸ˜† åœ¨æ±Ÿæ¹–ä¸Šæ··çš„äººï¼Œé‡äº‹ä¸è¦æ…Œï¼Œå…ˆè®©å­å¼¹é£ä¸€ä¼šã€‚</p></blockquote><hr><p>ç”·å­å»æäº²ï¼Œå¥³æ–¹å®¶é•¿ï¼šè¯·è‡ªæˆ‘ä»‹ç»ã€‚</p><p>Aè¯´ï¼šæˆ‘æœ‰ä¸€åƒä¸‡ï¼›</p><p>Bè¯´ï¼šæˆ‘æœ‰ä¸€æ ‹è±ªå®…ï¼Œä»·å€¼ä¸¤åƒä¸‡ï¼›</p><p>å®¶é•¿å¾ˆæ»¡æ„ã€‚å°±é—®Cï¼Œä½ å®¶æœ‰ä»€ä¹ˆï¼Ÿ</p><p>Cç­”ï¼šæˆ‘ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œåªæœ‰ä¸€ä¸ªå­©å­ï¼Œåœ¨ä½ å¥³å„¿è‚šå­é‡Œã€‚</p><p>ABæ— è¯­ï¼Œèµ°äº†ã€‚</p><blockquote><p>ğŸ˜† æ ¸å¿ƒç«äº‰åŠ›ä¸æ˜¯é’±å’Œæˆ¿å­ï¼Œæ˜¯åœ¨å…³é”®çš„å²—ä½æœ‰è‡ªå·²çš„äººã€‚</p></blockquote><hr><p>ä¸€ç”·å¹²éƒ¨æ€•åƒè‹¦ä¸æ„¿æ´è—ï¼Œè°ç§°çœ¼ç›çªç„¶å¤±æ˜ã€‚é¢†å¯¼é—»å¬ï¼Œå‡ºé¢è®©ä¸€ç¾å¥³è„±å…‰ç«™åœ¨ä»–é¢å‰ï¼Œé—®â€œçœ‹è§äº†å—â€ï¼Ÿç­”ï¼šçœ‹ä¸è§ã€‚é¢†å¯¼é£èµ·ä¸€è„šç»™ä»–è‡€éƒ¨ï¼šç‹—æ—¥çš„ï¼Œè€äºŒéƒ½ç›´äº†è¿˜çœ‹ä¸è§ï¼Ÿæ”¶æ‹¾è¡Œæï¼Œæ˜å¤©è¿›è—ã€‚</p><blockquote><p>ğŸ˜†<br>1.äººæ€§åŒ–æ‰èƒ½çœŸæ­£äº†è§£äººã€‚<br>2.ç»„ç»‡æ¯”ä¸ªäººé«˜æ˜ã€‚<br>3.æœ¬èƒ½ä¼šå‡ºå–ä½ </p></blockquote><hr><p>ä¸€å°æœ‹å‹é—®ä¸€å¯Œç¿è¯´ å”å”ä½ ä¸ºä»€ä¹ˆè¿™ä¹ˆæœ‰é’±ã€‚å¯Œç¿æ‘¸æ‘¸å°æœ‹å‹çš„å¤´è¯´ï¼šå°æ—¶å€™æˆ‘çˆ¸ç»™äº†æˆ‘ä¸€ä¸ªè‹¹æœï¼Œæˆ‘å–æ‰äº†å®ƒæœ‰äº†ä¸¤ä¸ªè‹¹æœï¼Œåæ¥æˆ‘åˆèµšåˆ°äº†å››ä¸ªè‹¹æœã€‚å°æœ‹å‹è‹¥æœ‰æ‰€æ€çš„è¯´ å“¦â€¦å”å”ï¼Œæˆ‘å¥½åƒæ‡‚äº†ã€‚å¯Œç¿è¯´ï¼Œâ€œä½ æ‡‚ä½ å¦¹é˜¿ï¼Œåæ¥æˆ‘çˆ¸æ­»äº†ï¼Œæˆ‘ç»§æ‰¿äº†ä»–çš„è´¢äº§â€¦</p><blockquote><p>ğŸ˜† ä¸è¦ç—´è¿·äºä»é˜…è¯»æˆåŠŸäººå£«çš„ä¼ è®°ï¼Œä»ä¸­å¯»æ‰¾ç»éªŒï¼Œè¿™äº›ä¹¦å¤§éƒ¨åˆ†ç»è¿‡äº†ç²¾è‡´çš„åŒ…è£…ï¼Œå¾ˆå¤šé‡è¦çš„äº‹å®ä¸ä¼šå‘Šè¯‰ä½ ã€‚ä¾‹å¦‚ç›–èŒ¨çš„çš„ä¹¦ä¸ä¼šå‘Šè¯‰ä½ ä»–æ¯äº²æ˜¯IBMè‘£äº‹ï¼Œæ˜¯å¥¹ç»™å„¿å­ä¿ƒæˆäº†ç¬¬ä¸€å•å¤§ç”Ÿæ„ï¼Œå·´è²ç‰¹çš„ä¹¦åªä¼šå‘Šè¯‰ä½ ä»–8å²å°±çŸ¥é“å»å‚è§‚çº½äº¤æ‰€ï¼Œä½†ä¸ä¼šå‘Šè¯‰ä½ ä»–å›½ä¼šè®®å‘˜çš„çˆ¶äº²å¸¦ä»–å»çš„ï¼Œæ˜¯é«˜ç››çš„è‘£äº‹æ¥å¾…çš„ã€‚</p></blockquote><hr><p>å‚è€ƒ <a href="http://home.lupaworld.com/home-space-uid-112536-do-blog-id-239163.html">lupaworld</a></p><hr><p><strong>æ‰«ç å…³æ³¨ï¼ŒæœŸå¾…ä¸ä½ çš„äº¤æµ~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬‘è¯ å†·ç¬‘è¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»™ Homebrew è®¾ç½®ä»£ç†</title>
      <link href="/2019/02/23/%E7%BB%99-Homebrew-%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86/"/>
      <url>/2019/02/23/%E7%BB%99-Homebrew-%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><hr><p>å¯ä»¥ç»™ <code>Homebrew</code> å·¥å…·è®¾ç½®ä»£ç†ï¼Œè®¾ç½®æ–¹æ³•å’Œæ­¥éª¤å¦‚ä¸‹ã€‚</p><p><strong>1ã€æ‰“å¼€ç»ˆç«¯ï¼Œè¿›å…¥ç”¨æˆ·æ ¹ç›®å½•</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd ~/</span><br></pre></td></tr></table></figure><p><strong>2ã€æŸ¥çœ‹å½“å‰ç›®å½•</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -al</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æ˜¯å¦æœ‰ <code>.curl</code> æ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰ï¼Œæ–°å»ºä¸€ä¸ªå§</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch .curl</span><br></pre></td></tr></table></figure><p><strong>3ã€ç¼–è¾‘ .curl æ–‡ä»¶</strong></p><p>å†™å…¥ä¸‹é¢å†…å®¹ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxy=ip:port</span><br></pre></td></tr></table></figure><p>æŠŠ ip å’Œ port æ”¹ä¸ºä½ çš„ä»£ç† ip å’Œç«¯å£å€¼ï¼Œå¦‚:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxy=127.0.0.1:8087</span><br></pre></td></tr></table></figure><p>ä¿å­˜æ–‡ä»¶å³å¯ã€‚</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> MacOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MacOS brew proxy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äº†è§£ Emscripten</title>
      <link href="/2019/02/15/%E4%BA%86%E8%A7%A3-Emscripten/"/>
      <url>/2019/02/15/%E4%BA%86%E8%A7%A3-Emscripten/</url>
      
        <content type="html"><![CDATA[<p>å¹¿å‘Šæ—¶é—´ï¼Œè§è°…å‹¿æ€ªï¼Œçœ‹åˆ°äº†å°±ç‚¹ä¸€ä¸‹é“¾æ¥å§ï¼Œæ„Ÿæ¿€ä¸å°½ğŸ™‡â€ï¼</p><hr><p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚</p><p>ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><hr><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id="Emscripten-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Emscripten-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Emscripten æ˜¯ä»€ä¹ˆï¼Ÿ"></a>Emscripten æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p><code>Emscripten</code> æ˜¯ä¸€ä¸ª <a href="https://github.com/emscripten-core/emscripten/tree/master">å¼€æºçš„ç¼–è¯‘å™¨</a>ï¼Œå¯ä»¥å°† C&#x2F;C++ çš„ä»£ç ç¼–è¯‘åé«˜æ•ˆè¿è¡Œåœ¨ç°ä»£æµè§ˆå™¨ä¸Šé¢ã€‚<code>Emscripten</code> çš„åº•å±‚æ˜¯åŸºäº <code>LLVM</code> ç¼–è¯‘å™¨çš„ï¼Œå¯ä»¥æŸ¥çœ‹å…¶å¼€æºçš„ <a href="https://github.com/emscripten-core/emscripten-fastcomp">emscripten llvm</a> å’Œ <a href="https://github.com/emscripten-core/emscripten-fastcomp-clang">emscripten clang</a>ã€‚</p><p>ä¸‹å›¾æ˜¯å…¶ç¼–è¯‘ C&#x2F;C++ çš„ä»£ç çš„æµç¨‹å›¾ï¼š<br><img src="/upload/images/2019/02/15/1.jpg"></p><p><a href="https://emscripten.org/">å®˜ç½‘</a> å¯¹ <code>Emscripten</code> çš„å®šä¹‰ï¼š</p><blockquote><p>Emscripten is a toolchain for compiling to asm.js and WebAssembly, built using LLVM, that lets you run C and C++ on the web at near-native speed without plugins.</p></blockquote><p>æˆªæ­¢æœ¬æ–‡å‘å¸ƒï¼Œ<code>Emscripten</code> æœ€æ–°ç‰ˆæœ¬æ˜¯ <code>1.38.27</code>.</p><h2 id="å®‰è£…æ¡ä»¶"><a href="#å®‰è£…æ¡ä»¶" class="headerlink" title="å®‰è£…æ¡ä»¶"></a>å®‰è£…æ¡ä»¶</h2><p>ä»¥ä¸‹æ˜¯æˆ‘å®‰è£…å’Œä½¿ç”¨ Emscripten çš„æ¡ä»¶ã€‚</p><ul><li>macOS ç‰ˆæœ¬ 10.14</li><li>Gitï¼Œå¯é€šè¿‡ Homebrew å®‰è£…</li><li>CMakeï¼Œå¯é€šè¿‡ Homebrew å®‰è£…</li><li>Xcode 10.1</li><li>Python 2.7.xï¼ŒMac ç³»ç»Ÿè‡ªå¸¦</li><li>ç¨³å®šå¿«é€Ÿçš„ç½‘ç»œç¯å¢ƒï¼Œæœ€é‡è¦å’Œæœ€å…³é”®çš„çš„æ˜¯è¦æœ‰(neng)æ¢¯(fan)å­(qiang)</li><li>è§£å†³é—®é¢˜çš„æ€åº¦å’Œæ¯…åŠ›</li></ul><h2 id="é€šè¿‡-emsdk-å®‰è£…"><a href="#é€šè¿‡-emsdk-å®‰è£…" class="headerlink" title="é€šè¿‡ emsdk å®‰è£…"></a>é€šè¿‡ emsdk å®‰è£…</h2><p>å®‰è£… <code>Emscripten</code> å¯ä»¥é€šè¿‡å®‰è£… <a href="https://github.com/emscripten-core/emsdk">emscripten SDK</a> æ¥å®Œæˆï¼Œ<code>emscripten SDK</code> å¯ä»¥ç®€å•çš„ç†è§£ä¸ºæ˜¯ <code>Emscripten</code> çš„ä¸€å¥—å·¥å…·é“¾ã€‚</p><p>åœ¨ä½ è‡ªå·±çš„ç”µè„‘ä¸Šé¢ä»»æ„æ–°å»ºä¸€ä¸ªç›®å½•ï¼Œå¦‚æˆ‘çš„ <code>~/dev/emscwork</code>ï¼Œæ‰“å¼€ç»ˆç«¯ï¼Œè¿›å…¥æ­¤ç›®å½•ã€‚</p><p><strong>1ã€</strong>ä¸‹è½½ <code>emsdk</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/juj/emsdk.git</span><br></pre></td></tr></table></figure><p><strong>2ã€</strong>è¿›å…¥ <code>emsdk</code> ç›®å½•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd emsdk</span><br></pre></td></tr></table></figure><p><strong>3ã€</strong>å¼€å§‹å®‰è£…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Fetch the latest version of the emsdk (not needed the first time you clone)</span><br><span class="line">git pull</span><br><span class="line"></span><br><span class="line"># Download and install the latest SDK tools.</span><br><span class="line">./emsdk install latest</span><br><span class="line"></span><br><span class="line"># Make the &quot;latest&quot; SDK &quot;active&quot; for the current user. (writes ~/.emscripten file)</span><br><span class="line">./emsdk activate latest</span><br><span class="line"></span><br><span class="line"># Activate PATH and other environment variables in the current terminal</span><br><span class="line">source ./emsdk_env.sh</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„: æ¯æ¬¡æ›´æ–°å®Œ <code>emsdk</code> åï¼Œä¾æ—§éœ€è¦æ‰§è¡Œä¸Šé¢å‘½ä»¤é‡æ–°å®‰è£…å’Œæ¿€æ´»ã€‚</strong></p><p>å¦å¤–ä¸€ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„æ˜¯ <code>./emsdk update-tags</code> è¿™ä¸ªå‘½ä»¤ï¼Œå¯ä»¥ç›´æ¥æ›´æ–° <code>emsdk</code> çš„æœ€æ–° tags ç‰ˆæœ¬ï¼Œæ›´æ–° tags å®Œæˆåï¼Œé‡æ–°å®‰è£…å’Œæ¿€æ´»æœ€æ–°ç‰ˆçš„ <code>emsdk</code> å¥—ä»¶ã€‚</p><h2 id="é…ç½®-emsdk"><a href="#é…ç½®-emsdk" class="headerlink" title="é…ç½® emsdk"></a>é…ç½® emsdk</h2><p>å¦‚æœä½ æƒ³åœ¨ä»»æ„è·¯å¾„ä¸‹éƒ½å¯ä»¥ä½¿ç”¨ <code>emsdk</code> é‡Œé¢çš„å„ç§å·¥å…·(å°±æ˜¯ä¸€äº›äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶)ï¼Œéœ€è¦ä¸ºå…¶è®¾ç½®ç¯å¢ƒå˜é‡ã€‚</p><p>ç¼–è¾‘ <code>~/.bash_profile</code> æ–‡ä»¶ï¼Œæ–°å¢å¦‚ä¸‹ä»£ç :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export EMSDK=~/emscwork/emsdk</span><br><span class="line">export EMSCRIPTEN=$EMSDK/emscripten/1.38.27</span><br><span class="line">export BINARYEN_ROOT=$EMSDK/binaryen/master_64bit_binaryen</span><br><span class="line">export PATH=$EMSDK:$EMSCRIPTEN:$BINARYEN_ROOT:$PATH</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä¸‹é¢å‘½ä»¤, ä½¿åˆšé…ç½®çš„æ–‡ä»¶ç”Ÿæ•ˆã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bash_profile</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œå®‰è£…å’Œè®¾ç½®ç¯å¢ƒå˜é‡å®Œæˆã€‚</p><p>å¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤æ¥æŸ¥çœ‹ <code>emsdk</code> çš„å®‰è£…æƒ…å†µã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emcc --version</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">emcc (Emscripten gcc/clang-like replacement) 1.38.27 (commit ea5d631a5446632e195765d89a53ead71cd6de45)</span><br><span class="line">Copyright (C) 2014 the Emscripten authors (see AUTHORS.txt)</span><br><span class="line">This is free and open source software under the MIT license.</span><br><span class="line">There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span><br></pre></td></tr></table></figure><p><code>emcc</code> æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œè„šæœ¬ï¼Œè¯¥è„šæœ¬åœ¨ <code>emsdk/emscripten/1.38.27</code> ç›®å½•ä¸‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emcc --help</span><br></pre></td></tr></table></figure><p>ä¸Šé¢å‘½ä»¤å¯ä»¥æŸ¥çœ‹æ›´å¤šå…³äº <code>emcc</code> çš„ä½¿ç”¨æ–¹æ³•.</p><h2 id="ç¼–è¯‘-C-x2F-C-ä»£ç "><a href="#ç¼–è¯‘-C-x2F-C-ä»£ç " class="headerlink" title="ç¼–è¯‘ C&#x2F;C++ ä»£ç "></a>ç¼–è¯‘ C&#x2F;C++ ä»£ç </h2><p>è¿™é‡Œä¸¾ä¸ªå®é™…çš„ä¾‹å­ã€‚</p><p><strong>main.c</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> ** argv)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Emscripten show in browser...\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>emcc</code> ç¼–è¯‘ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emcc main.c -s WASM=<span class="number">1</span> -o mz.html</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¦æ³¨æ„ <code>WASM=1</code> è¿™ä¸ªé€‰é¡¹ï¼Œç°åœ¨æ–°ç‰ˆ SDK é»˜è®¤ <code>WASM=1</code> äº†ï¼Œå¦‚æœä¸æƒ³ç”Ÿæˆ <code>.wasm</code> è¿™ä¸ªæ–‡ä»¶ï¼Œéœ€è¦æŒ‡å®š <code>WASM=0</code> é€‰é¡¹ã€‚</p><p>ç”Ÿæˆå¦å¤–ä¸‰ä¸ªæ–‡ä»¶å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mz.html  mz.js  mz.wasm</span><br></pre></td></tr></table></figure><p>ç®€å•ä»‹ç»ä¸€ä¸‹è¿™ä¸‰ä¸ªæ–‡ä»¶</p><p><strong>1ã€mz.wasm</strong></p><blockquote><p>äºŒè¿›åˆ¶çš„ <code>wasm</code> æ¨¡å—ä»£ç </p></blockquote><p><strong>2ã€mz.js</strong></p><blockquote><p>èƒ¶æ°´ä»£ç ï¼ŒåŒ…å«äº†åŸç”Ÿ C å‡½æ•°å’Œ JavaScript&#x2F;wasm ä¹‹é—´è½¬æ¢çš„ JS æ–‡ä»¶</p></blockquote><p><strong>3ã€mz.html</strong></p><blockquote><p>ç”¨æ¥åŠ è½½ã€ç¼–è¯‘å’Œå®ä¾‹åŒ– <code>wasm</code> ä»£ç å¹¶ä¸”å°†å…¶è¾“å‡ºåœ¨æµè§ˆå™¨æ˜¾ç¤ºä¸Šçš„ <code>HTML</code> æ–‡ä»¶</p></blockquote><p>æœ€åæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå¯ä»¥åœ¨ Safari æµè§ˆå™¨ä¸­æ˜¾ç¤ºæ•ˆæœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emrun mz.html</span><br></pre></td></tr></table></figure><p><img src="/upload/images/2019/02/15/2.jpg"></p><p><strong>main.cpp</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> ** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Emscripten show in browser...&quot;</span> &lt;&lt; endl;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘ C++ æ–‡ä»¶(main.cpp)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emcc main.cpp -s WASM=1 -o mzcpp.html</span><br></pre></td></tr></table></figure><p>åŒæ ·çš„æ–¹å¼ç¼–è¯‘å’Œè¿è¡Œ <code>mzcpp.html</code> å³å¯çœ‹åˆ°åŒæ ·çš„æ•ˆæœã€‚</p><h2 id="Emscripten-åº”ç”¨åœºæ™¯"><a href="#Emscripten-åº”ç”¨åœºæ™¯" class="headerlink" title="Emscripten åº”ç”¨åœºæ™¯"></a>Emscripten åº”ç”¨åœºæ™¯</h2><p><code>Emscripten</code> åªæ˜¯ä¸€ä¸ªç¼–è¯‘å™¨ï¼Œèƒ½å°†æˆ‘ä»¬çš„é«˜çº§è¯­è¨€ç¼–è¯‘ä¸ºæµè§ˆå™¨å¯ä»¥è¯†åˆ«å¹¶è¿è¡Œçš„ç¨‹åºï¼Œè¿™ä¸ªçœ‹èµ·æ¥ç¡®å®å¾ˆè¯±äººã€‚</p><p>å°±ç›®å‰æ¥è¯´ï¼ŒEmscripten åº”ç”¨åœºæ™¯å¯ä»¥ä½¿ç”¨åœ¨å®‰å…¨å’Œæ¸¸æˆä¸Šé¢ã€‚</p><p><strong>1ã€å®‰å…¨</strong></p><p>C&#x2F;C++ ä»£ç ç»è¿‡ç¼–è¯‘ä¹‹åï¼Œä¼šç”Ÿæˆ <a href="https://developer.mozilla.org/zh-CN/docs/WebAssembly"><code>wasm</code> æ ¼å¼</a> çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè¿™ä¸ªå®‰å…¨çº§åˆ«è¾ƒé«˜ï¼Œå³ä½¿åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œç ´è§£è€…ä¹Ÿä¸ä¼šå¾ˆè½»æ¾çš„ç ´è§£ä»£ç ï¼Œè¿™æ ·ä¸€äº›åœ¨ JS ä¸­æ¶‰åŠåˆ°å®‰å…¨çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ C&#x2F;C++ æ¥å†™ç»“åˆä¸€äº›åŠ å¯†æŠ€æœ¯ï¼Œç„¶åç”¨ <code>Emscripten</code> ç¼–è¯‘ã€‚</p><p><strong>2ã€æ¸¸æˆ</strong></p><p>å¦‚æœèƒ½æŠŠç”¨ C&#x2F;C++ è¯­è¨€å†™çš„æ¸¸æˆï¼Œè½¬ä¸ºå¯åœ¨æµè§ˆå™¨ç›´æ¥è¿è¡Œçš„H5æ¸¸æˆï¼Œé‚£å°±å¾ˆç¾å¥½äº†ï¼Œç”¨æˆ·ä¸éœ€è¦ä¸‹è½½æ¸¸æˆï¼Œç›´æ¥ç©ã€‚ç°ä»£æµè§ˆå™¨æŠ€æœ¯çš„æ›´æ–°å’Œå‘å±•å·²ç»è®©è¿™ä¸ªæƒ³æ³•å˜æˆäº†ç°å®ï¼Œè‡³å°‘åœ¨ä¸»æµçš„æµè§ˆå™¨ä¸Šé¢ã€‚</p><p>æ¨èå¤§å®¶çœ‹çœ‹è¿™ç¯‡æ–‡ç«  <a href="https://blog.fundebug.com/2018/12/24/how-does-webassembly-works/">JavaScriptæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼šä¸WebAssemblyæ¯”è¾ƒåŠå…¶ä½¿ç”¨åœºæ™¯</a></p><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p><a href="https://emscripten.org/docs/introducing_emscripten/about_emscripten.html">About Emscripten</a></p><p><a href="https://emscripten.org/docs/getting_started/downloads.html">Download and install</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/WebAssembly/C_to_wasm">ç¼–è¯‘ C&#x2F;C++ ä¸º WebAssembly</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/WebAssembly/Concepts">WebAssembly æ¦‚å¿µ</a></p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Emscripten wasm JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C ç»“æ„ä½“æŒ‡é’ˆåˆå§‹åŒ–</title>
      <link href="/2019/02/08/C-%E7%BB%93%E6%9E%84%E4%BD%93%E6%8C%87%E9%92%88%E5%88%9D%E5%A7%8B%E5%8C%96/"/>
      <url>/2019/02/08/C-%E7%BB%93%E6%9E%84%E4%BD%93%E6%8C%87%E9%92%88%E5%88%9D%E5%A7%8B%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<p>åœ¨ä½¿ç”¨æŒ‡é’ˆä¹‹å‰ï¼ŒåŠ¡å¿…è¦å°†å…¶åˆå§‹åŒ–ã€‚è¿™ä¸ªæ˜¯æˆ‘ä»¬æœ€æ—©å­¦ä¹  C è¯­è¨€çš„æ—¶å€™ï¼Œä¹¦ä¸Šç»å¸¸è¯´çš„ä¸€ä¸ªé—®é¢˜ã€‚åœ¨å·¥ä½œä¸­ï¼Œæˆ‘ä»¬åè€Œä¼šç»å¸¸å¿˜è®°è¿™æ¡é‡‘ç§‘ç‰å¾‹ã€‚</p><p>æœ¬ç¯‡æ–‡ç« çš„æ‰€æœ‰ä»£ç éƒ½ç» <code>gcc-7</code> ç¼–è¯‘å™¨ç¼–è¯‘è¿‡ã€‚å…³äºåœ¨ macOS ä¸­å¦‚ä½•å®‰è£…å’Œä½¿ç”¨ <code>gcc</code>ï¼Œå¯ä»¥å‚è€ƒ <a href="http://www.veryitman.com/2017/10/07/GCC-Homebrew-%E5%AE%89%E8%A3%85-GCC-%E5%92%8C-Binutils/">GCC: Homebrew å®‰è£… GCC å’Œ Binutils</a> è¿™ç¯‡æ–‡ç« ã€‚</p><h2 id="ç»“æ„ä½“æˆå‘˜æŒ‡é’ˆçš„åˆå§‹åŒ–"><a href="#ç»“æ„ä½“æˆå‘˜æŒ‡é’ˆçš„åˆå§‹åŒ–" class="headerlink" title="ç»“æ„ä½“æˆå‘˜æŒ‡é’ˆçš„åˆå§‹åŒ–"></a>ç»“æ„ä½“æˆå‘˜æŒ‡é’ˆçš„åˆå§‹åŒ–</h2><blockquote><p>ç»“æ„ä½“æˆå‘˜æŒ‡é’ˆçš„åˆå§‹åŒ–ï¼ŒæŒ‡çš„æ˜¯åˆå§‹åŒ–ç»“æ„ä½“ä¸­æŒ‡é’ˆå˜é‡çš„æˆå‘˜ã€‚</p></blockquote><p>æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢æ˜¯ <code>Animal</code> çš„ç»“æ„ä½“ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Animal</span> &#123;</span></span><br><span class="line">    <span class="type">char</span> *name; <span class="comment">//æŒ‡é’ˆæˆå‘˜</span></span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">    <span class="type">char</span> info[<span class="number">200</span>]; <span class="comment">//å­—ç¬¦æ•°ç»„</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Animal</span> *<span class="title">nextAnimal</span>;</span> <span class="comment">//æŒ‡é’ˆæˆå‘˜</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç»“æ„ä½“ <code>Animal</code> å«æœ‰4ä¸ªæˆå‘˜å˜é‡ï¼Œå…¶ä¸­ <code>name</code>ã€<code>info</code> å’Œ <code>nextAnimal</code> æ˜¯æŒ‡é’ˆå˜é‡ã€‚</p><p>å†™ä¸€æ®µæµ‹è¯•ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Animal</span> <span class="title">animal</span>;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;animal&#x27;s name: %s, age: %i, info: %s\n&quot;</span>, animal.name, animal.age, animal.info);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœæ­£å¸¸ï¼Œç»ˆç«¯è¾“å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">animal&#x27;s name: (null), age: 0, info: </span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ¥éªŒè¯ä¸€ä¸‹ <code>Animal *nextAnimal</code> åœ¨æ²¡æœ‰åˆå§‹åŒ–çš„æƒ…å†µä¸‹ï¼Œä¼šä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Animal</span> <span class="title">animal</span>;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;animal&#x27;s name: %s, age: %i, info: %s\n&quot;</span>, animal.name, animal.age, animal.info);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;animal.nextAnimal: %p\n&quot;</span>, animal.nextAnimal);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;animal.nextAnimal-&gt;name: %s, age: %i, info: %s\n&quot;</span>, animal.nextAnimal-&gt;name, animal.nextAnimal-&gt;age, animal.nextAnimal-&gt;info);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¨‹åºç¼–è¯‘æ²¡æœ‰é—®é¢˜ï¼Œè¿è¡ŒæŠ¥é”™</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">animal<span class="number">&#x27;</span>s name: (null), age: <span class="number">0</span>, info: </span><br><span class="line">animal.nextAnimal: <span class="number">0x1127fa036</span></span><br><span class="line">Segmentation fault: <span class="number">11</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸€ä¸‹ä»£ç ï¼Œåˆå§‹åŒ–ä¸€ä¸‹ <code>animal.nextAnimal</code> è¿™ä¸ªæŒ‡é’ˆï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Animal</span> <span class="title">animal</span>;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;animal&#x27;s name: %s, age: %i, info: %s\n&quot;</span>, animal.name, animal.age, animal.info);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;animal.nextAnimal: %p\n&quot;</span>, animal.nextAnimal);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–æŒ‡é’ˆå˜é‡</span></span><br><span class="line">    animal.nextAnimal = (<span class="keyword">struct</span> Animal *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> Animal));</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;animal.nextAnimal-&gt;name: %s, age: %i, info: %s\n&quot;</span>, animal.nextAnimal-&gt;name, animal.nextAnimal-&gt;age, animal.nextAnimal-&gt;info);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†æ¬¡ç¼–è¯‘é‡æ–°è¿è¡Œï¼Œè¿˜æ˜¯æŠ¥é”™ã€‚è¿˜éœ€è¦åˆå§‹åŒ– <code>animal.nextAnimal-&gt;name</code> è¿™ä¸ªå˜é‡ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Animal</span> <span class="title">animal</span>;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;animal&#x27;s name: %s, age: %i, info: %s\n&quot;</span>, animal.name, animal.age, animal.info);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;animal.nextAnimal: %p\n&quot;</span>, animal.nextAnimal);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–æŒ‡é’ˆå˜é‡</span></span><br><span class="line">    animal.nextAnimal = (<span class="keyword">struct</span> Animal *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> Animal));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆå§‹åŒ– name å˜é‡</span></span><br><span class="line">    animal.nextAnimal-&gt;name = <span class="string">&quot;cat&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;animal.nextAnimal-&gt;name: %s, age: %i, info: %s\n&quot;</span>, animal.nextAnimal-&gt;name, animal.nextAnimal-&gt;age, animal.nextAnimal-&gt;info);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘è¿è¡Œï¼Œä¸€åˆ‡æ­£å¸¸ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">animal<span class="number">&#x27;</span>s name: (null), age: <span class="number">0</span>, info: </span><br><span class="line">animal.nextAnimal: <span class="number">0x10f0f1036</span></span><br><span class="line">animal.nextAnimal-&gt;name: cat, age: <span class="number">0</span>, info: </span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œç»“æ„ä½“æŒ‡é’ˆå˜é‡æœ‰äº›ä¼šç»™é»˜è®¤å€¼ï¼Œæœ‰äº›åˆä¸ä¼šç»™ï¼Œæ‰€ä»¥éƒ½è¦åˆå§‹åŒ–æŒ‡é’ˆå˜é‡ã€‚ä¿®æ”¹ä¸€ä¸‹ä»£ç ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Animal</span> &#123;</span></span><br><span class="line">    <span class="type">char</span> *name; <span class="comment">//æŒ‡é’ˆæˆå‘˜</span></span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">    <span class="type">char</span> info[<span class="number">200</span>]; <span class="comment">//å­—ç¬¦æ•°ç»„</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Animal</span> *<span class="title">nextAnimal</span>;</span> <span class="comment">//æŒ‡é’ˆæˆå‘˜</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Animal</span> <span class="title">animal</span>;</span></span><br><span class="line">    </span><br><span class="line">    animal.name = <span class="string">&quot;cat&quot;</span>;</span><br><span class="line">    <span class="built_in">strcpy</span>(animal.info, <span class="string">&quot;This is a cat.&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;animal&#x27;s name: %s, age: %i, info: %s\n&quot;</span>, animal.name, animal.age, animal.info);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;animal.nextAnimal: %p\n&quot;</span>, animal.nextAnimal);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–æŒ‡é’ˆå˜é‡</span></span><br><span class="line">    animal.nextAnimal = (<span class="keyword">struct</span> Animal *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> Animal));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–å˜é‡</span></span><br><span class="line">    animal.nextAnimal-&gt;name = <span class="string">&quot;cat&quot;</span>;</span><br><span class="line">    <span class="built_in">strcpy</span>(animal.nextAnimal-&gt;info, <span class="string">&quot;This is a cat.&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;animal.nextAnimal-&gt;name: %s, age: %i, info: %s\n&quot;</span>, animal.nextAnimal-&gt;name, animal.nextAnimal-&gt;age, animal.nextAnimal-&gt;info);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç»“æ„ä½“æŒ‡é’ˆçš„åˆå§‹åŒ–"><a href="#ç»“æ„ä½“æŒ‡é’ˆçš„åˆå§‹åŒ–" class="headerlink" title="ç»“æ„ä½“æŒ‡é’ˆçš„åˆå§‹åŒ–"></a>ç»“æ„ä½“æŒ‡é’ˆçš„åˆå§‹åŒ–</h2><blockquote><p>æŒ‡çš„æ˜¯åˆå§‹åŒ–ç»“æ„ä½“æŒ‡é’ˆå˜é‡ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Animal</span> *<span class="title">ptAnimal</span>;</span></span><br><span class="line">        </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;ptAnimal&#x27;s name: %s, age: %iï¼Œ info: %s\n&quot;</span>, ptAnimal-&gt;name, ptAnimal-&gt;age, ptAnimal-&gt;info);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘è¿è¡ŒæŠ¥é”™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Segmentation fault: 11</span><br></pre></td></tr></table></figure><p>åŒæ ·çš„é“ç†ï¼Œéœ€è¦åˆå§‹åŒ–æŒ‡é’ˆå˜é‡ã€‚å®Œæˆåçš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Animal</span> *<span class="title">ptAnimal</span>;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ç»“æ„ä½“æŒ‡é’ˆ</span></span><br><span class="line">    ptAnimal = (<span class="keyword">struct</span> Animal *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> Animal));</span><br><span class="line">    </span><br><span class="line">    ptAnimal-&gt;name = <span class="string">&quot;dog&quot;</span>;</span><br><span class="line">    <span class="built_in">strcpy</span>(ptAnimal-&gt;info, <span class="string">&quot;This is a big dog&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;ptAnimal&#x27;s name: %s, age: %iï¼Œ info: %s\n&quot;</span>, ptAnimal-&gt;name, ptAnimal-&gt;age, ptAnimal-&gt;info);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ç»“æ„ä½“æŒ‡é’ˆçš„æˆå‘˜æŒ‡é’ˆå˜é‡ nextAnimal</span></span><br><span class="line">    ptAnimal-&gt;nextAnimal = (<span class="keyword">struct</span> Animal *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> Animal));</span><br><span class="line">    ptAnimal-&gt;nextAnimal-&gt;name = <span class="string">&quot;dog&quot;</span>;</span><br><span class="line">    <span class="built_in">strcpy</span>(ptAnimal-&gt;nextAnimal-&gt;info, <span class="string">&quot;This is a big dog&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;ptAnimal-&gt;nextAnimal&#x27;s name: %s, age: %iï¼Œ info: %s\n&quot;</span>,</span><br><span class="line">           ptAnimal-&gt;nextAnimal-&gt;name, ptAnimal-&gt;nextAnimal-&gt;age, ptAnimal-&gt;nextAnimal-&gt;info);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å®Œæ•´ç¤ºä¾‹"><a href="#å®Œæ•´ç¤ºä¾‹" class="headerlink" title="å®Œæ•´ç¤ºä¾‹"></a>å®Œæ•´ç¤ºä¾‹</h2><p><strong>main.c</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Animal</span> &#123;</span></span><br><span class="line">    <span class="type">char</span> *name; <span class="comment">//æŒ‡é’ˆæˆå‘˜</span></span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">    <span class="type">char</span> info[<span class="number">200</span>]; <span class="comment">//å­—ç¬¦æ•°ç»„</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Animal</span> *<span class="title">nextAnimal</span>;</span> <span class="comment">//æŒ‡é’ˆæˆå‘˜</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/// éªŒè¯ç»“æ„ä½“æŒ‡é’ˆæˆå‘˜å˜é‡</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">Animal</span> <span class="title">animal</span>;</span></span><br><span class="line">        </span><br><span class="line">        animal.name = <span class="string">&quot;cat&quot;</span>;</span><br><span class="line">        <span class="built_in">strcpy</span>(animal.info, <span class="string">&quot;This is a cat.&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;animal&#x27;s name: %s, age: %i, info: %s\n&quot;</span>, animal.name, animal.age, animal.info);</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;animal.nextAnimal: %p\n&quot;</span>, animal.nextAnimal);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–æŒ‡é’ˆå˜é‡</span></span><br><span class="line">        animal.nextAnimal = (<span class="keyword">struct</span> Animal *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> Animal));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–å˜é‡</span></span><br><span class="line">        animal.nextAnimal-&gt;name = <span class="string">&quot;cat&quot;</span>;</span><br><span class="line">        <span class="built_in">strcpy</span>(animal.nextAnimal-&gt;info, <span class="string">&quot;This is a cat.&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;animal.nextAnimal-&gt;name: %s, age: %i, info: %s\n&quot;</span>, animal.nextAnimal-&gt;name, animal.nextAnimal-&gt;age, animal.nextAnimal-&gt;info);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/// éªŒè¯ç»“æ„ä½“æŒ‡é’ˆ</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">Animal</span> *<span class="title">ptAnimal</span>;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–ç»“æ„ä½“æŒ‡é’ˆ</span></span><br><span class="line">        ptAnimal = (<span class="keyword">struct</span> Animal *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> Animal));</span><br><span class="line">        </span><br><span class="line">        ptAnimal-&gt;name = <span class="string">&quot;dog&quot;</span>;</span><br><span class="line">        <span class="built_in">strcpy</span>(ptAnimal-&gt;info, <span class="string">&quot;This is a big dog&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;ptAnimal&#x27;s name: %s, age: %iï¼Œ info: %s\n&quot;</span>, ptAnimal-&gt;name, ptAnimal-&gt;age, ptAnimal-&gt;info);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–ç»“æ„ä½“æŒ‡é’ˆçš„æˆå‘˜æŒ‡é’ˆå˜é‡ nextAnimal</span></span><br><span class="line">        ptAnimal-&gt;nextAnimal = (<span class="keyword">struct</span> Animal *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> Animal));</span><br><span class="line">        ptAnimal-&gt;nextAnimal-&gt;name = <span class="string">&quot;dog&quot;</span>;</span><br><span class="line">        <span class="built_in">strcpy</span>(ptAnimal-&gt;nextAnimal-&gt;info, <span class="string">&quot;This is a big dog&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;ptAnimal-&gt;nextAnimal&#x27;s name: %s, age: %iï¼Œ info: %s\n&quot;</span>,</span><br><span class="line">               ptAnimal-&gt;nextAnimal-&gt;name, ptAnimal-&gt;nextAnimal-&gt;age, ptAnimal-&gt;nextAnimal-&gt;info);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¼–è¯‘</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc<span class="number">-7</span> main.c -o main</span><br></pre></td></tr></table></figure><p><strong>è¿è¡Œ</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./main</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">animal<span class="number">&#x27;</span>s name: cat, age: <span class="number">0</span>, info: This is a cat.</span><br><span class="line">animal.nextAnimal: <span class="number">0x0</span></span><br><span class="line">animal.nextAnimal-&gt;name: cat, age: <span class="number">0</span>, info: This is a cat.</span><br><span class="line">ptAnimal<span class="number">&#x27;</span>s name: dog, age: <span class="number">0</span>ï¼Œ info: This is a big dog</span><br><span class="line">ptAnimal-&gt;nextAnimal<span class="number">&#x27;</span>s name: dog, age: <span class="number">0</span>ï¼Œ info: This is a big dog</span><br></pre></td></tr></table></figure><hr><p><strong>å°è·æ‰éœ²å°–å°–è§’ï¼Œæ—©æœ‰èœ»èœ“ç«‹ä¸Šå¤´~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gcc macOS struct </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è‡´ç»“å©š8å‘¨å¹´</title>
      <link href="/2019/01/30/%E8%87%B4%E7%BB%93%E5%A9%9A8%E5%91%A8%E5%B9%B4/"/>
      <url>/2019/01/30/%E8%87%B4%E7%BB%93%E5%A9%9A8%E5%91%A8%E5%B9%B4/</url>
      
        <content type="html"><![CDATA[<p><img src="/upload/images/2019/01/30/1.jpg"></p><p>è‡ªå·±æ˜æ˜æ˜¯ä¸ªç†ç§‘ç”Ÿï¼Œååæœ‰é¢—æ–‡ç§‘ç”Ÿçš„å¿ƒï¼Œå¤šæ„å–„æ„Ÿï¼Œå¿ƒç†æ€»æœ‰é“ä¸å®Œçš„æƒ…ç»“ã€‚</p><p>å¾ˆå¤šäººé—®æˆ‘ï¼šâ€œå†™åšå®¢æ˜¯ä¸æ˜¯å¾ˆè´¹æ—¶é—´ï¼ŒæŠŠå†™åšå®¢çš„æ—¶é—´è…¾å‡ºæ¥åšç‚¹å…¶ä»–çš„ä¸æ˜¯æ›´å¥½å—ï¼Ÿâ€œ</p><p>è¨€ä¸‹ä¹‹æ„åœ¨è¯´ï¼Œåæ­£ä½ ä¹Ÿæˆä¸äº†ä½œå®¶ï¼Œå¹²å˜›æµªè´¹è¿™ä¸ªæ—¶é—´å‘¢ï¼Ÿäººç”Ÿæœ‰å¾ˆå¤šæœ‰ä¹è¶£çš„äº‹æƒ…å¯ä»¥åšï¼Œå…´è¶£æ˜¯æœ€å¥½çš„è€å¸ˆï¼Œä¸æ˜¯å—ï¼Ÿå†™åšå®¢çš„ç¡®æ˜¯è´¹æ—¶é—´ï¼Œä½†è¿™æ˜¯ä¸ªäººçš„ä¸€ä¸ªå°çˆ±å¥½ï¼Œæ‰€ä»¥ï¼Œåœ¨æˆ‘çœ‹æ¥ä¸ç®—æ˜¯æµªè´¹æ—¶é—´ã€‚åšæŒé˜…è¯»å’Œå†™ä½œæ˜¯æˆ‘å”¯ä¸€æ²¡æœ‰æ”¾å¼ƒçš„çˆ±å¥½ä¹‹ä¸€ï¼Œå› ä¸ºå®ƒä»¬èƒ½ç»™æˆ‘å¸¦æ¥å¿«ä¹ï¼Œä¹Ÿæ˜¯æˆ‘å¿™ç¢Œä¹‹ååœæ­‡çš„æ¸¯æ¹¾ï¼Œèƒ½è®©æˆ‘ç‹¬ç«‹æ€è€ƒï¼Œé™ä¸‹å¿ƒæ¥æ†§æ†¬ç¾å¥½çš„æœªæ¥ã€‚</p><p><strong>æ‰€ä»¥ï¼Œçˆ±ä½ æ‰€çˆ±å§ï¼</strong></p><p>2010å¹´å†œå†12æœˆ21æ—¥æˆ‘ä»¬ç»“å©šäº†ï¼Œåœ¨ç»“å©šä¹‹å‰æˆ‘å’Œå¤ªå¤ªè®¤è¯†äº†å¤§æ¦‚5å¹´çš„æ—¶é—´ï¼Œé£é£é›¨é›¨çš„ä¸€è·¯èµ°æ¥ï¼Œåå·è€Œåˆå¹¸ç¦ï¼Œä¸€ä¸ªå¥³äººèƒ½ä¸ºä½ åšå®ˆè¿™ä¹ˆå¤šå¹´ï¼Œå¹¶ä¸”æ€»æ˜¯èƒ½å¸®ä½ ï¼Œå¨¶å¥¹ä¸¤ééƒ½ä¸ä¸ºè¿‡ï¼Œå“ˆå“ˆï¼</p><p>é‚£ä¸ªæ—¶å€™å®¶é‡Œæ¡ä»¶å¾ˆä¸å¥½ï¼Œåœ¨æˆ‘çš„è®°å¿†æ·±å¤„ï¼Œå®¶é‡Œæ€»æ˜¯æœ‰è¿˜ä¸å®Œçš„å€ºï¼Œæ¯ä¸ªå­¦æœŸçš„å­¦æ‚è´¹è®©çˆ¶æ¯ç„¦å¤´çƒ‚é¢ï¼Œä½†æœ€ç»ˆè¿˜æ˜¯è¢«çˆ¶æ¯æå®šäº†ï¼Œæ‰€ä»¥æˆ‘è§‰å¾—ä»–ä»¬å¾ˆäº†ä¸èµ·ã€‚æˆ‘åšæŒç€è‡ªå·±çš„ä¿¡å¿µï¼šâ€œå¿…é¡»è¦è€ƒä¸Šå¤§å­¦ï¼Œèµ°å‡ºè¿™é‡Œï¼â€ï¼Œæ¯äº²æ˜¯å®¶é‡Œæœ€èµæˆæˆ‘ä¸Šå­¦çš„ï¼Œå¯èƒ½æ˜¯è¢«æˆ‘ç‚½çƒ­çš„å­¦ä¹ çƒ­æƒ…ç»™æ„ŸæŸ“åˆ°äº†ï¼Œè¿™è¾ˆå­ä¸èƒ½å¿˜è®°æ¯äº²ä¸ºæˆ‘ä¸Šå­¦å¥”æ³¢çš„æ—¥å­ï¼Œæ¯çˆ±ä¹‹æ‰€ä»¥ä¼Ÿå¤§æ˜¯å› ä¸ºä»–ä¸ºè‡ªå·±çš„å­©å­èƒ½å€¾å‡ºæ‰€æœ‰ï¼Œå¹¶ä¸”ä¸æ±‚å›æŠ¥ï¼</p><p>å¤§å­¦æ—¶æœŸï¼Œå¹³æ—¶è‡ªå·±ä¼šæ‰¾ä¸€äº›å®¶æ•™åšï¼Œç®—æ˜¯è¡¥è´´ä¸€ä¸‹æ—¥å¸¸çš„å¼€é”€ï¼Œå¯’æš‘å‡æ˜¯æˆ‘æœ€ç›¼æœ›çš„æ—¥å­ï¼Œå› ä¸ºå¯ä»¥å’Œå¤ªå¤ªåœ¨ä¸€èµ·æ‰“å·¥æŒ£é’±äº†ï¼Œé‚£æ—¶å€™æŒ£é’±åªæœ‰ä¸€ä¸ªç›®çš„ï¼Œèµšåˆ°å­¦è´¹ï¼ä¸€åˆ°å¼€å­¦å¥¹å°±æŠŠè‡ªå·±ç§¯ç´¯çš„é’±éƒ½ç»™æˆ‘äº†ï¼Œç®€ç›´æ˜¯ä¹‰è–„äº‘å¤©ï¼Œå¥¹è¿˜å£®å¿—è±ªæƒ…çš„è¯´ï¼šâ€œæ‹¿å»èŠ±ï¼â€ï¼Œæˆ‘ä¹Ÿåšé¢œæ— è€»çš„æ¥è¿‡æ¥äº†ã€‚å½“æ—¶æˆ‘åœ¨æƒ³ï¼Œè¿™å§‘å¨˜å°±ä¸æ€•æˆ‘ä»¥åè·‘æ‰å—ï¼Ÿï¼å…³äºè¿™ä¸ªäº‹æƒ…ï¼Œåæ¥æˆ‘é—®è¿‡å¥¹ï¼Œå¥¹è¯´ï¼šâ€œæˆ‘ç›¸ä¿¡ä½ ï¼â€ï¼Œæœ´å®çš„å›ç­”è®©æˆ‘æ— è¨€ä»¥å¯¹ã€‚å…¶å®ï¼Œå½“æˆ‘çœ‹è§å¥¹çš„ç¬¬ä¸€çœ¼ï¼Œå°±æ¯…ç„¶å†³å®šè¿™è¾ˆå­éå¥¹ä¸å¨¶äº†ï¼</p><p>æˆ‘ä»¬ç»“å©šåæ²¡å‡ å¤©ï¼Œå°±ç¦»å¼€äº†è€å®¶èµ¶å¾€æ·±åœ³ï¼Œæˆ‘ä»¬æ‰‹é‡Œä¹Ÿæ²¡æœ‰é’±ï¼Œç©·çš„å®å½“å“ï¼Œè®°å¾—å»æ·±åœ³çš„ç›˜ç¼ è¿˜æ˜¯å¼Ÿå¼Ÿç»™æˆ‘çš„ã€‚åœ¨æ·±åœ³åˆšå·¥ä½œçš„æ—¥å­é‡Œï¼Œæ¯å¤©ä¸­åˆæˆ‘ä»¬è¿˜è¦è‡ªå·±åšé¥­ï¼Œç²—èŒ¶æ·¡é¥­çš„å€’ä¹Ÿè§‰å¾—å¼€å¿ƒï¼Œå°±æ˜¯åœ¨é‚£ä¸ªæ—¶å€™å¤ªå¤ªå¼€å§‹ä¼šåšé¥­äº†ï¼Œç‰¹åˆ«æ˜¯æé¢å’Œè›‹ç‚’é¥­ï¼Œè‡³ä»Šè¿˜è®©æˆ‘è®°å¿†çŠ¹æ–°ï¼Œæ¯å¤©æ™šä¸Šä¸‹ç­æˆ‘éƒ½ä¼šå»æ¥å¥¹ï¼Œåœ¨æœˆå…‰ä¸‹å¥¹ç˜¦å°çš„èº«å½±æ˜¾å¾—æ ¼å¤–åˆ«è‡´ï¼Œä¸€èµ·ç‰µæ‰‹å›å®¶ï¼Œæˆ‘ä»¬å†³å®šå°±è¿™æ ·å¹¸ç¦çš„å¥‹æ–—ä¸‹å»ï¼</p><p>ç»“å©šå‰æˆ‘ä»¬å½¼æ­¤éª‚è¿‡ã€åˆ‡ç£‹è¿‡ï¼Œå¤šåŠæ˜¯æˆ‘çš„è¿‡é”™ä½†æˆ‘æ€»æ˜¯è§‰å¾—è‡ªå·±æ˜¯ä¸ªç”·äººï¼Œä¸èƒ½ä½å¤´ï¼Œä¸ç„¶çœŸä»–å¦ˆæ²¡é¢å­ã€‚ç°åœ¨æƒ³æƒ³è‡ªå·±æŒºå¯ç¬‘çš„ï¼Œæ‰€ä»¥å©šåæˆ‘åŸºæœ¬ä¸Šæ²¡æœ‰å’Œå¤ªå¤ªæ‰“éª‚è¿‡ï¼Œå¥³äººçš„è„¾æ°”å¾ˆå¥‡æ€ªï¼Œä¸€ä¼šæ™´å¤©ä¸€ä¼šé›¨å¤©ï¼Œè‡ªå·±å¿ä¸€å¿å°±è¿‡å»äº†ï¼Œä¸è¦å†ç«ä¸Šæµ‡æ²¹äº†ï¼Œå°±åƒè¿™å¥è¯æ‰€è¯´çš„ï¼šâ€œä½ è™½ç„¶èµ¢äº†åµæ¶ï¼Œä½†æ˜¯ä½ å´è¾“äº†æ„Ÿæƒ…â€ï¼Œé€€ä¸€æ­¥æµ·é˜”å¤©ç©ºï¼</p><p>2012å¹´3æœˆï¼Œå„¿å­å‡ºç”Ÿäº†ï¼Œè¿™ä¸ªå°å®¶ä¼™çš„åˆ°æ¥è®©æˆ‘ä»¬çš„ç”Ÿæ´»å˜å¾—æ›´åŠ å¿™ç¢Œäº†ï¼Œæˆ‘ä»¬ç®—æ˜¯æ­¥å…¥äº†çˆ¶æ¯çš„è¡Œåˆ—äº†ã€‚å¤ªå¤ªç®—å‘Šåˆ«äº†æ‰€æœ‰çš„æ‰“å·¥ç”Ÿæ¶¯ï¼Œå…¨èŒåœ¨å®¶ç…§é¡¾å­©å­ï¼Œæˆ‘è´Ÿè´£åœ¨å¤–æŒ£é’±ï¼Œä¸€å®¶ä¸‰å£å¹¸ç¦çš„ç”Ÿæ´»åœ¨ä¸€èµ·ï¼å¤ªå¤ªè‡ªä»æœ‰äº†å„¿å­ä¹‹åï¼Œå„¿å­å°±åƒæ˜¯ä»–çš„å…¨éƒ¨ï¼ŒæŠŠå­©å­ç…§é¡¾çš„æ— å¾®ä¸è‡³ï¼Œåšäº‹æƒ…æ¯”ä»¥å‰è®¤çœŸäº†å¾ˆå¤šï¼Œå¼€å§‹å…³æ³¨ä¸€äº›å…¬ä¼—å·ï¼Œè¯»ä¸€äº›è‚²å„¿ä¹¦ç±ï¼Œå­¦ä¹ åˆ«äººæ˜¯æ€ä¹ˆå…»è‚²å­©å­çš„ï¼Œå­©å­åœ¨æˆé•¿ï¼Œå¤ªå¤ªä¹Ÿåœ¨æˆé•¿ã€‚ä¹Ÿè®¸ï¼Œå¥³äººä»ä¸€åå¦»å­çš„è§’è‰²è½¬æ¢ä¸ºæ¯äº²çš„è§’è‰²çš„è¿™ä¸ªè¿‡ç¨‹ï¼Œç®—æ˜¯ä¸€æ¬¡èœ•å˜ï¼Œå°¤å…¶æ˜¯æ¯äº²çš„è§’è‰²ï¼Œå¥¹æ‰®æ¼”çš„ååˆ†ç²¾å½©ï¼</p><p>2019å¹´1æœˆï¼Œæˆ‘ä»¬çš„ç¬¬äºŒä¸ªå­©å­å‡ºç”Ÿäº†ï¼Œæ˜¯ä¸ªå¯çˆ±çš„åƒé‡‘ï¼Œæˆ‘ä»¬ä¹‹å‰ä¹Ÿè®¨è®ºè¿‡åˆ°åº•è¦ä¸è¦äºŒèƒï¼Œæˆ‘è¯´ç”Ÿå­©å­å¤ªè¾›è‹¦äº†ï¼Œæœ‰ä¸€ä¸ªå­©å­å°±å¤ŸæŠ˜è…¾çš„äº†ï¼Œä¸è¦äºŒèƒä¹Ÿç½¢ã€‚å¤ªå¤ªåšå†³åå¯¹ï¼Œè¯´ä¸€ä¸ªå­©å­å¤ªå­¤å•ï¼Œä»¥åé‡åˆ°äº‹æƒ…è¿ä¸ªå•†é‡çš„äº²äººéƒ½æ²¡æœ‰ï¼Œå¿…é¡»è¦äºŒèƒï¼Œå°±è¿™æ ·æˆ‘ä»¬å­•è‚²äº†è¿™ä¸ªå°åƒé‡‘ã€‚æ— è®ºä½ è·Ÿä½ çš„å¤ªå¤ªæœ‰å¤šå¤§çš„ä»‡å¤šå¤§çš„å†¤ï¼Œå¥¹èƒ½ä¸ºä½ ç”Ÿå­©å­ï¼Œå°±å€¼å¾—ä½ ä¸ºå¥¹ä»˜å‡ºä¸€è¾ˆå­ã€‚</p><p>ä»Šå¹´æ˜¯æˆ‘ä»¬ç»“å©š8å‘¨å¹´ï¼Œ7å¹´ä¹‹ç—’çš„ä¼ è¯´æ²¡æœ‰åœ¨æˆ‘ä»¬ä¸¤ä¸ªèº«ä¸Šå‘ç”Ÿï¼Œæˆ‘ä»¬ä¼šè¿™æ ·ç»§ç»­å¹¸ç¦ä¸‹å»ï¼Œè¿æ¥ä¸‹ä¸€ä¸ªå‘¨å¹´ã€‚</p><p>ç¥å¤§å®¶æ–°å¹´æ–°æ°”è±¡ï¼Œèº«ä½“å¥åº·ï¼Œé˜–å®¶å¹¸ç¦ï¼Œä¸‡äº‹å¦‚æ„ï¼Œè¯¸äº‹é¡ºåˆ©ï¼ç¥å¤©ä¸‹æœ‰æƒ…äººç»ˆæˆçœ·å±ï¼</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼ŒæœŸå¾…ä¸ä½ çš„äº¤æµ~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éšç¬” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Classã€isaã€å…ƒç±»</title>
      <link href="/2019/01/29/Class-isa-%E5%85%83%E7%B1%BB/"/>
      <url>/2019/01/29/Class-isa-%E5%85%83%E7%B1%BB/</url>
      
        <content type="html"><![CDATA[<h2 id="å£°æ˜"><a href="#å£°æ˜" class="headerlink" title="å£°æ˜"></a>å£°æ˜</h2><p>æœ¬æ–‡çš„æ‰€æ¶‰åŠåˆ°çš„æºç æ˜¯ <a href="https://opensource.apple.com/source/objc4/">objc4</a> æºç ï¼Œæˆªæ­¢åˆ°å†™æœ¬æ–‡æœ€æ–°çš„æ˜¯ <code>objc4-750</code> è¿™ä¸ªç‰ˆæœ¬ã€‚</p><h2 id="Class"><a href="#Class" class="headerlink" title="Class"></a>Class</h2><p>æˆ‘ä»¬åœ¨å­¦ä¹ é¢å‘å¯¹è±¡çš„å­¦ä¹ ä¸­ï¼Œæ¥è§¦æœ€å¤šçš„å°±æ˜¯ç±»ï¼Œé‚£ä¹ˆåœ¨OCç±»æ˜¯ç”±Classç±»å‹æ¥è¡¨ç¤ºçš„ï¼ŒClassæ˜¯ç”¨Cçš„æ•°æ®ç»“æ„æ¥è¡¨ç¤ºçš„ã€‚</p><p>çœ‹ä¸€ä¸‹ <code>NSObject</code> çš„å£°æ˜ï¼Œåœ¨å¤´æ–‡ä»¶ä¸­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2019/01/29/1.jpg"></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSObject</span> &lt;<span class="title">NSObject</span>&gt; </span>&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> clang diagnostic push</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> clang diagnostic ignored <span class="string">&quot;-Wobjc-interface-ivars&quot;</span></span></span><br><span class="line">    Class isa  OBJC_ISA_AVAILABILITY;</span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> clang diagnostic pop</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼š<br>1ã€<code>NSObject</code> æ˜¯å®ç°äº† <code>&lt;NSObject&gt;</code> åè®®çš„ã€‚<br>2ã€<code>NSObject</code> ä¸­æœ‰ <code>Class</code> ç±»å‹çš„ <code>isa</code> æˆå‘˜å˜é‡ï¼Œå¤–ç•Œæ˜¯æ— æ³•è®¿é—®çš„ï¼Œå¦å¤– <code>isa</code> æŒ‡é’ˆå¯èƒ½åœ¨å°†æ¥ä¹Ÿä¼šè¢«éšè—èµ·æ¥(OBJC_ISA_AVAILABILITYæ ‡ç¤ºäº†)ã€‚</p><p>ç»§ç»­çœ‹ä¸€ä¸‹ <code>Class</code> åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</p><p><img src="/upload/images/2019/01/29/2.jpg"></p><p>åœ¨ä¸Šé¢çš„æ–‡ä»¶ä¸­å¯ä»¥çœ‹åˆ° <code>Class</code> çš„å®šä¹‰ï¼Œå¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_class *Class;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_object *<span class="keyword">id</span>;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡º <code>Class</code> æ˜¯ä¸€ä¸ªæŒ‡å‘ <code>objc_class</code> çš„ç»“æ„ä½“æŒ‡é’ˆï¼Œ<code>Objective-C</code> ä¸­çš„ç±»æ˜¯ç”± <code>Class</code> ç±»å‹æ¥è¡¨ç¤ºçš„ï¼Œå®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªæŒ‡å‘ <code>objc_class</code> ç»“æ„ä½“çš„æŒ‡é’ˆã€‚</p><p>åœ¨ä¸‹é¢çš„å¤´æ–‡ä»¶ä¸­çœ‹ä¸€ä¸‹ <code>objc_class</code> çš„å®šä¹‰ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2019/01/29/3.jpg"></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> objc_class : objc_object &#123;</span><br><span class="line">    <span class="comment">// Class ISA;</span></span><br><span class="line">    Class superclass;</span><br><span class="line">    cache_t cache;             <span class="comment">// formerly cache pointer and vtable</span></span><br><span class="line">    class_data_bits_t bits;    <span class="comment">// class_rw_t * plus custom rr/alloc flags</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ....</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œ<code>objc_class</code> ç”¨æ¥æè¿°OCä¸­çš„ç±»ï¼Œè€Œ <code>objc_object</code> ç”¨æ¥æè¿°OCä¸­çš„å¯¹è±¡ï¼Œç±»(objc_class)å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡(objc_object)ï¼Œå¦å¤– <code>id</code> æ˜¯ä»£è¡¨å¯¹è±¡çš„ï¼Œå®ƒæ˜¯æŒ‡å‘ <code>objc_object</code> çš„ç»“æ„ä½“æŒ‡é’ˆï¼Œå®ƒçš„å­˜åœ¨å¯ä»¥è®©æˆ‘ä»¬å®ç°ç±»ä¼¼äºC++ä¸­æ³›å‹çš„ä¸€äº›æ“ä½œã€‚è¯¥ç±»å‹çš„å¯¹è±¡å¯ä»¥è½¬æ¢ä¸ºä»»ä½•ä¸€ç§å¯¹è±¡ï¼Œæœ‰ç‚¹ç±»ä¼¼äºCè¯­è¨€ä¸­ <code>void *</code> æŒ‡é’ˆç±»å‹çš„ä½œç”¨ã€‚</p><p>è¿™é‡Œè¦æ³¨æ„ï¼Œ<code>objc_class</code> çš„å®šä¹‰åœ¨ <code>objc-runtime-old.h</code>ä¸­å’Œ <code>objc-runtime-new.h</code> ä¸­çš„ä¸ä¸€æ ·ã€‚è¿™é‡Œä»¥ <code>objc-runtime-new.h</code> ä¸ºä¸»ï¼Œå»ºè®®å¯ä»¥çœ‹çœ‹ <a href="http://www.veryitman.com/2019/01/28/%E8%A2%AB%E8%AF%AF%E8%A7%A3%E7%9A%84-objc-class/">è¢«è¯¯è§£çš„ objc_class</a> è¿™ç¯‡æ–‡ç« ã€‚</p><p>å†æ¥çœ‹ä¸€ä¸‹ <code>objc_object</code>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2019/01/29/4.jpg"></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> objc_object &#123;</span><br><span class="line">private:</span><br><span class="line">    isa_t isa;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>objc_object</code> æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œé‡Œé¢æœ‰ä¸ªç§æœ‰æˆå‘˜å˜é‡ <code>isa</code> æ˜¯ <code>isa_t</code> ç±»å‹çš„ã€‚</p><p>è€Œ <code>isa_t</code> æ˜¯ä¸€ä¸ª union ç±»å‹çš„ï¼Œå¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">union</span> isa_t &#123;</span><br><span class="line">    isa_t() &#123; &#125;</span><br><span class="line">    isa_t(uintptr_t value) : bits(value) &#123; &#125;</span><br><span class="line"></span><br><span class="line">    Class cls;</span><br><span class="line">    uintptr_t bits;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> defined(ISA_BITFIELD)</span></span><br><span class="line">    <span class="keyword">struct</span> &#123;</span><br><span class="line">        ISA_BITFIELD;  <span class="comment">// defined in isa.h</span></span><br><span class="line">    &#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ€»ä¹‹åœ¨OCä¸­ï¼Œç±»ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ç§°ä¹‹ä¸ºç±»å¯¹è±¡ï¼Œæ ¹æ®å‡¡æ˜¯å¯¹è±¡éƒ½æœ‰è‡ªå·±çš„ç±»çš„åŸç†ï¼Œé‚£ä¹ˆç±»å¯¹è±¡çš„è‚¯å®šå­˜åœ¨è‡ªå·±çš„ç±»ï¼Œè¿™ä¸ªç±»å°±æ˜¯å…ƒç±»(meta-class)ã€‚</p><h2 id="å…ƒç±»"><a href="#å…ƒç±»" class="headerlink" title="å…ƒç±»"></a>å…ƒç±»</h2><p>åœ¨è¯´å…ƒç±»ä¹‹å‰ï¼Œå…ˆçœ‹ä¸€ä¸‹ä¸‹é¢çš„ä¾‹å­ï¼Œåˆ›å»ºä¸€ä¸ª <code>NSMutableDictionary</code> å®ä¾‹å¯¹è±¡ <code>dict</code>ï¼Œå³å‘ <code>NSMutableDictionary</code> å‘é€ <code>alloc</code> å’Œ <code>init</code> æ¶ˆæ¯ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableDictionary</span> *dict = [[<span class="built_in">NSMutableDictionary</span> alloc] init];</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç çš„å¤§æ¦‚æ‰§è¡Œæµç¨‹å¦‚ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><p><strong>1</strong>ã€å…ˆæ‰§è¡Œ <code>[NSMutableDictionary alloc]</code>ï¼Œä½†æ˜¯ <code>NSMutableDictionary</code> æ²¡æœ‰ <code>+alloc</code> æ–¹æ³•ï¼Œäºæ˜¯å†å»çˆ¶ç±»<code>NSObject</code> ä¸­æŸ¥æ‰¾è¯¥æ–¹æ³•ã€‚</p><p><strong>2</strong>ã€<code>NSObject</code> å“åº” <code>+alloc</code> æ–¹æ³•ï¼Œå¼€å§‹æ£€æµ‹ <code>NSMutableDictionary</code> ç±»ï¼Œå¹¶æ ¹æ®å…¶æ‰€éœ€çš„å†…å­˜ç©ºé—´å¤§å°å¼€å§‹åˆ†é…å†…å­˜ç©ºé—´ï¼Œç„¶åæŠŠ <code>isa</code> æŒ‡é’ˆæŒ‡å‘ <code>NSMutableDictionary</code> ç±»ã€‚åŒæ—¶ï¼Œ<code>+alloc</code> ä¹Ÿè¢«åŠ è¿› cache åˆ—è¡¨é‡Œé¢ã€‚</p><p><strong>3</strong>ã€æ¥ç€ï¼Œæ‰§è¡Œ <code>-init</code> æ–¹æ³•ï¼Œå¦‚æœ <code>NSMutableDictionary</code> å“åº”è¯¥æ–¹æ³•ï¼Œåˆ™ç›´æ¥å°†å…¶åŠ å…¥ <code>cache</code>ï¼Œå¦‚æœä¸å“åº”ï¼Œåˆ™å»çˆ¶ç±»æŸ¥æ‰¾ã€‚</p><p><strong>4</strong>ã€åœ¨åæœŸçš„æ“ä½œä¸­ï¼Œå¦‚æœå†ä»¥ <code>[[NSMutableDictionary alloc] init]</code> è¿™ç§æ–¹å¼æ¥åˆ›å»ºå­—å…¸å¯¹è±¡ï¼Œåˆ™ä¼šç›´æ¥ä» cache ä¸­å–å‡ºç›¸åº”çš„æ–¹æ³•ï¼Œç›´æ¥è°ƒç”¨ã€‚</p><p>ä¸Šé¢æ˜¯åˆ›å»ºä¸€ä¸ªå®ä¾‹å¯¹è±¡çš„å¤§è‡´æµç¨‹ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¯´è¯´å…ƒç±»ã€‚</p><p><strong>å…ƒç±»ç®€å•æ¥è¯´å°±æ˜¯ç±»å¯¹è±¡çš„ç±»ã€‚</strong>ç±»æè¿°çš„æ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆå…ƒç±»æè¿°çš„å°±æ˜¯Classç±»å¯¹è±¡çš„ç±»ã€‚å…ƒç±»å®šä¹‰äº†ç±»çš„è¡Œä¸ºï¼ˆç±»æ–¹æ³•ï¼‰ï¼Œåœ¨å¹³æ—¶å¼€å‘æ—¶ï¼Œmeta-class åŸºæœ¬æ˜¯ç”¨ä¸ç€æ¥è§¦çš„ï¼Œä½†æœ€å¥½è¿˜æ˜¯è¦çŸ¥é“å®ƒçš„å­˜åœ¨ï¼Œè¿™æ ·å¯ä»¥æ›´å¥½çš„ç†è§£OCçš„è®¾è®¡ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableDictionary</span> *tDatas = [<span class="built_in">NSMutableDictionary</span> dictionaryWithCapacity:<span class="number">5</span>];</span><br></pre></td></tr></table></figure><p>æ‹¿ä¸Šé¢çš„ç¤ºä¾‹æ¥è¯´ï¼Œå‘ <code>NSMutableDictionary</code> å‘é€ <code>dictionaryWithCapacity</code> è¿™ä¸ªæ¶ˆæ¯çš„æ—¶å€™ï¼ŒRuntime ä¼šåœ¨è¿™ä¸ªç±»çš„ meta-class çš„æ–¹æ³•åˆ—è¡¨ä¸­æŸ¥æ‰¾ï¼Œé€šè¿‡ SEL æ‰¾åˆ°åå–å‡ºæ–¹æ³•ä¸­çš„ IMP å‡½æ•°å…¥å£æŒ‡é’ˆï¼Œå¹¶æ‰§è¡Œè¯¥æ–¹æ³•ï¼Œå¦‚æœæ‰¾ä¸åˆ°å°±è¿›è¡Œæ¶ˆæ¯è½¬å‘çš„æµç¨‹ä¸­ï¼Œæœ€ç»ˆå¯èƒ½ä¼šå¯¼è‡´ Crashï¼Œæ¶ˆæ¯è½¬å‘çš„åŸç†å’Œæœºåˆ¶å¯ä»¥å‚è€ƒ <a href="http://www.veryitman.com/categories/iOS/page/2/">æ¶ˆæ¯æœºåˆ¶</a> è¿™å‡ ç¯‡æ–‡ç« ã€‚</p><p>å…ƒç±»ä¿å­˜äº†ç±»æ–¹æ³•çš„åˆ—è¡¨ã€‚å½“ä¸€ä¸ªç±»æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œå…ƒç±»ä¼šé¦–å…ˆæŸ¥æ‰¾å®ƒæœ¬èº«æ˜¯å¦æœ‰è¯¥ç±»æ–¹æ³•çš„å®ç°ï¼Œå¦‚æœæ²¡æœ‰åˆ™è¯¥å…ƒç±»ä¼šå‘å®ƒçš„çˆ¶ç±»æŸ¥æ‰¾è¯¥æ–¹æ³•ï¼Œç›´åˆ°ä¸€ç›´æ‰¾åˆ°ç»§æ‰¿é“¾çš„å¤´ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class object_getClass(<span class="keyword">id</span> obj); </span><br></pre></td></tr></table></figure><p><code>object_getClass</code> å¯ä»¥è·å–ä¸€ä¸ªå¯¹è±¡çš„ class objectï¼Œå…¶æºç å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Class object_getClass(<span class="keyword">id</span> obj)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (obj) <span class="keyword">return</span> obj-&gt;getIsa();</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> Nil;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸¾ä¸ªä¾‹å­å§ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSObject</span> *obj = [<span class="built_in">NSObject</span> new];</span><br><span class="line">Class obj1 = object_getClass(obj);</span><br><span class="line">Class obj2 = object_getClass([<span class="built_in">NSObject</span> <span class="keyword">class</span>]);</span><br><span class="line">Class obj3 = objc_getMetaClass(<span class="string">&quot;NSObject&quot;</span>);</span><br><span class="line">Class obj4 = object_getClass(obj1);</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *name = [<span class="built_in">NSStringFromClass</span>(obj1) UTF8String];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;name: %s&quot;</span>, name); <span class="comment">//name: NSObject</span></span><br><span class="line">Class obj5 = objc_getMetaClass(name);</span><br><span class="line">Class obj6 = objc_getClass(name);</span><br><span class="line">    </span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;obj : %@, -&gt;%p: &quot;</span>, obj,  obj);</span><br><span class="line">    </span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;obj1: %@, -&gt;%p: &quot;</span>, obj1, obj1);</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;obj2: %@, -&gt;%p: &quot;</span>, obj2, obj2);</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;obj3: %@, -&gt;%p: &quot;</span>, obj3, obj3);</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;obj4: %@, -&gt;%p: &quot;</span>, obj4, obj4);</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;obj5: %@, -&gt;%p: &quot;</span>, obj5, obj5);</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;obj6: %@, -&gt;%p: &quot;</span>, obj6, obj6);</span><br></pre></td></tr></table></figure><p>æ‰“å°ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">obj : &lt;<span class="built_in">NSObject</span>: <span class="number">0x600002b19d70</span>&gt;, -&gt;<span class="number">0x600002b19d70</span>:</span><br><span class="line">obj1: <span class="built_in">NSObject</span>, -&gt;<span class="number">0x10c96bf38</span>:</span><br><span class="line">obj2: <span class="built_in">NSObject</span>, -&gt;<span class="number">0x10c96bee8</span>:</span><br><span class="line">obj3: <span class="built_in">NSObject</span>, -&gt;<span class="number">0x10c96bee8</span>:</span><br><span class="line">obj4: <span class="built_in">NSObject</span>, -&gt;<span class="number">0x10c96bee8</span>:</span><br><span class="line">obj5: <span class="built_in">NSObject</span>, -&gt;<span class="number">0x10c96bee8</span>:</span><br><span class="line">obj6: <span class="built_in">NSObject</span>, -&gt;<span class="number">0x10c96bf38</span>:</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œobj æ˜¯ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œobj1å’Œobj6æ˜¯ä¸€ä¸ª class objectï¼Œå…¶äºŒè€…åœ°å€ä¹Ÿä¸€è‡´ï¼Œobj2ã€obj3ã€obj4 å’Œ obj5 éƒ½è·å–åˆ°çš„æ˜¯å…ƒç±»ã€‚</p><p>é€šè¿‡ç±»å¯¹è±¡è°ƒç”¨çš„ <code>object_getClass</code> å¾—åˆ°çš„æ˜¯è¯¥ç±»å¯¹è±¡çš„ meta-classï¼Œå¦‚ obj2 å’Œ obj4ï¼Œè€Œé€šè¿‡å®ä¾‹å¯¹è±¡è°ƒç”¨çš„<code>object_getClass</code> å¾—åˆ°çš„æ˜¯è¯¥å®ä¾‹å¯¹è±¡çš„ç±»å¯¹è±¡ï¼Œå¦‚ obj1ï¼Œ<code>objc_getClass</code> è¿™ä¸ªæ–¹æ³•è·å–æ˜¯å®ä¾‹å¯¹è±¡çš„ç±»å¯¹è±¡ï¼Œä¸<code>object_getClass</code> è¿˜æ˜¯æœ‰ç‚¹ä¸ä¸€æ ·çš„ã€‚è€Œ <code>objc_getMetaClass</code> å¯ä»¥ç›´æ¥è·å– meta-classï¼Œå¦‚ obj3ã€‚</p><p><strong>æ€»ä¹‹:</strong><br>1ã€<code>objc_getClass</code> å‚æ•°æ˜¯ç±»åçš„å­—ç¬¦ä¸²ï¼Œè¿”å›çš„å°±æ˜¯è¿™ä¸ªç±»çš„ç±»å¯¹è±¡ã€‚<br>2ã€<code>object_getClass</code> å‚æ•°æ˜¯ <code>id</code> ç±»å‹ï¼Œå®ƒè¿”å›çš„æ˜¯è¿™ä¸ª <code>id</code> çš„ <code>isa</code> æŒ‡é’ˆæ‰€æŒ‡å‘çš„Classï¼›å¦‚æœä¼ å‚æ˜¯Classï¼Œåˆ™è¿”å›è¯¥Classçš„meta-classã€‚</p><p>åœ¨ <strong>NSObject.mm</strong> ä¸­ï¼Œå¯ä»¥çœ‹åˆ° self å’Œ class æ–¹æ³•éƒ½è¦å®ä¾‹å’Œç±»æ–¹æ³•ï¼Œclass æ–¹æ³•è¿”å›çš„éƒ½æ˜¯ç±»å¯¹è±¡ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="keyword">id</span>)<span class="keyword">self</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">id</span>)<span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)<span class="keyword">self</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (Class)<span class="keyword">class</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (Class)<span class="keyword">class</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> object_getClass(<span class="keyword">self</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ï¼Œæ— è®ºæ˜¯ç±»è¿˜æ˜¯å®ä¾‹è°ƒç”¨ class æ–¹æ³•ï¼Œè¿”å›çš„éƒ½æ˜¯åŒä¸€ä¸ª class objectï¼Œä¸¾ä¾‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Class objClz1 = [<span class="built_in">NSObject</span> <span class="keyword">class</span>];</span><br><span class="line">Class objClz2 = [[[<span class="built_in">NSObject</span> alloc] init] <span class="keyword">class</span>];</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> (objClz1 == objClz2) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;objClz1: %@, -&gt;%p&quot;</span>, objClz1, objClz1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœæ˜¯ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objClz1: <span class="built_in">NSObject</span>, -&gt;<span class="number">0x10fa30f38</span></span><br></pre></td></tr></table></figure><h2 id="isa"><a href="#isa" class="headerlink" title="isa"></a>isa</h2><p>ä¸‹é¢çš„ä¾‹å­æ¥æºè‡ª <a href="http://zziking.github.io/ios/2016/02/08/Objective-C_Runtime_1_The_object_model.html">è¿™é‡Œ</a>ï¼Œæ„Ÿè°¢ kingizzâ€™s blogï¼Œä»£ç ä¸­ <code>Son</code> æ˜¯ <code>Father</code> çš„å­ç±»ï¼Œè€Œ <code>Father</code> æ˜¯ <code>NSObject</code> çš„å­ç±»ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Father</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Son</span> : <span class="title">Father</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç»“åˆä¸‹é¢è¿™ä¸ªå›¾æ¥ç†è§£ä¸€ä¸‹ï¼Œå­ç±»ã€çˆ¶ç±»ã€å…ƒç±»ä»¥åŠ isa æŒ‡é’ˆã€‚</p><p><img src="/upload/images/2019/01/29/5.jpg"></p><p>ä¸€ä¸ªå®ä¾‹å¯¹è±¡çš„ <code>isa</code> æŒ‡å‘å¯¹è±¡æ‰€å±çš„ç±»ï¼Œè¿™ä¸ªç±»çš„ <code>isa</code> æŒ‡å‘è¿™ä¸ªç±»çš„å…ƒç±»ï¼Œè€Œè¿™ä¸ªå…ƒç±»çš„ <code>isa</code> åˆæŒ‡å‘ <code>NSObject</code> çš„å…ƒç±»ï¼Œ<code>NSObject</code> çš„å…ƒç±»çš„ <code>isa</code> æŒ‡å‘å…¶æœ¬èº«ï¼Œæœ€ç»ˆå½¢æˆå½¢æˆä¸€ä¸ªå®Œç¾çš„é—­ç¯ã€‚</p><p>åœ¨OCä¸­ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª <code>isa</code> æŒ‡é’ˆï¼ŒæŒ‡å‘å¯¹è±¡æ‰€å±çš„ç±»ï¼Œç±»ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç±»å¯¹è±¡çš„ <code>isa</code> æŒ‡é’ˆæŒ‡å‘ç±»çš„å…ƒç±»ã€‚    </p><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p>1ã€<a href="https://tingxins.com/2017/05/metaclass-class-relationship/">Objective-C ä¸­çš„å¯¹è±¡ã€ç±»ã€å…ƒç±»</a></p><p>2ã€<a href="http://zziking.github.io/ios/2016/02/08/Objective-C_Runtime_1_The_object_model.html">Objective-C Runtime(ä¸€)å¯¹è±¡æ¨¡å‹åŠç±»ä¸å…ƒç±»</a></p><p>3ã€<a href="http://www.veryitman.com/2019/01/28/%E8%A2%AB%E8%AF%AF%E8%A7%A3%E7%9A%84-objc-class/">è¢«è¯¯è§£çš„ objc_class</a> </p><hr><p><strong>æ‰«ç å…³æ³¨ï¼ŒæœŸå¾…ä¸ä½ çš„äº¤æµ~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å…ƒç±» isa class meta-class </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¢«è¯¯è§£çš„ objc_class</title>
      <link href="/2019/01/28/%E8%A2%AB%E8%AF%AF%E8%A7%A3%E7%9A%84-objc-class/"/>
      <url>/2019/01/28/%E8%A2%AB%E8%AF%AF%E8%A7%A3%E7%9A%84-objc-class/</url>
      
        <content type="html"><![CDATA[<p>ç½‘ä¸Šç»å¤§å¤šæ•°çš„åšå®¢è®² <code>objc_class</code> çš„å®šä¹‰ï¼ŒåŸºæœ¬ä¸Šéƒ½ä½¿ç”¨äº†ä¸‹é¢çš„<strong>ä»£ç ä¸€</strong>æ¥è®²è§£ï¼Œä¸ <a href="https://opensource.apple.com/source/objc4/">objc4</a> æºç  <code>objc-runtime-new.h</code> ä¸­å…³äº <code>objc_class</code> ä¸­çš„å®šä¹‰å®Œå…¨ä¸ä¸€æ ·ï¼Œæˆ‘è®¤çœŸåœ°å»æ¢ç©¶äº†ä¸€ä¸‹ï¼Œå‘ç°è¿™ä¸ªä¸–ç•Œä¸Šå®å±é›·åŒçš„äº‹ä»¶è¿˜æ˜¯è›®å¤šçš„ï¼Œè€å®åšäº‹åšå­¦é—®çš„äººå°‘çš„å¯æ€œï¼</p><p><img src="/upload/images/2019/01/28/1.jpg"></p><p>æœ¬æ–‡çš„æ‰€æ¶‰åŠåˆ°çš„ <a href="https://opensource.apple.com/source/objc4/">objc4</a> æºç ï¼Œæˆªæ­¢åˆ°å†™æœ¬æ–‡æœ€æ–°çš„æ˜¯ <code>objc4-750</code> è¿™ä¸ªç‰ˆæœ¬ã€‚</p><p><strong>ä»£ç ä¸€ï¼šç®€æ´ç‰ˆä¹Ÿç§°å‘è´§ç‰ˆ</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> objc_class &#123;</span><br><span class="line">    Class _Nonnull isa  OBJC_ISA_AVAILABILITY;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> !__OBJC2__</span></span><br><span class="line">    Class _Nullable super_class                              OBJC2_UNAVAILABLE;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> * _Nonnull name                               OBJC2_UNAVAILABLE;</span><br><span class="line">    <span class="keyword">long</span> version                                             OBJC2_UNAVAILABLE;</span><br><span class="line">    <span class="keyword">long</span> info                                                OBJC2_UNAVAILABLE;</span><br><span class="line">    <span class="keyword">long</span> instance_size                                       OBJC2_UNAVAILABLE;</span><br><span class="line">    <span class="keyword">struct</span> objc_ivar_list * _Nullable ivars                  OBJC2_UNAVAILABLE;</span><br><span class="line">    <span class="keyword">struct</span> objc_method_list * _Nullable * _Nullable methodLists                    OBJC2_UNAVAILABLE;</span><br><span class="line">    <span class="keyword">struct</span> objc_cache * _Nonnull cache                       OBJC2_UNAVAILABLE;</span><br><span class="line">    <span class="keyword">struct</span> objc_protocol_list * _Nullable protocols          OBJC2_UNAVAILABLE;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">&#125; OBJC2_UNAVAILABLE;</span><br><span class="line"><span class="comment">/* Use `Class` instead of `struct objc_class *` */</span></span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ <code>OBJC2_UNAVAILABLE</code> çœ‹èµ·æ¥è®©äººè§‰å¾—æœ‰ç‚¹å¥‡æ€ªï¼Œä»å­—é¢æ„æ€ä¸Šå¯ä»¥ç†è§£ä¸ºåœ¨OC2.0ç‰ˆæœ¬ä¸å¯ç”¨äº†ï¼Œè¿˜æœ‰ä¸€ä¸ª <code>OBJC_ISA_AVAILABILITY</code> æ˜¯åœ¨è¡¨ç¤º Objective-C éƒ½å¯ä»¥ä½¿ç”¨å—ï¼Ÿ</p><p>åœ¨ <code>objc-api.h</code> ä¸­æœ‰å…³äºè¿™ä¸¤ä¸ªå®çš„å®šä¹‰ï¼Œå¦‚ä¸‹ï¼š</p><p><strong>ä»£ç äºŒï¼šå…³é”®å®å®šä¹‰</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* OBJC_ISA_AVAILABILITY: `isa` will be deprecated or unavailable </span></span><br><span class="line"><span class="comment"> * in the future */</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> !defined(OBJC_ISA_AVAILABILITY)</span></span><br><span class="line"><span class="meta">#   <span class="keyword">if</span> __OBJC2__</span></span><br><span class="line"><span class="meta">#       <span class="keyword">define</span> OBJC_ISA_AVAILABILITY  __attribute__((deprecated))</span></span><br><span class="line"><span class="meta">#   <span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#       <span class="keyword">define</span> OBJC_ISA_AVAILABILITY  <span class="comment">/* still available */</span></span></span><br><span class="line"><span class="meta">#   <span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* OBJC2_UNAVAILABLE: unavailable in objc 2.0, deprecated in Leopard */</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> !defined(OBJC2_UNAVAILABLE)</span></span><br><span class="line"><span class="meta">#   <span class="keyword">if</span> __OBJC2__</span></span><br><span class="line"><span class="meta">#       <span class="keyword">define</span> OBJC2_UNAVAILABLE UNAVAILABLE_ATTRIBUTE</span></span><br><span class="line"><span class="meta">#   <span class="keyword">else</span></span></span><br><span class="line">        <span class="comment">/* plain C code also falls here, but this is close enough */</span></span><br><span class="line"><span class="meta">#       <span class="keyword">define</span> OBJC2_UNAVAILABLE                                       \</span></span><br><span class="line"><span class="meta">            __OSX_DEPRECATED(10.5, 10.5, <span class="string">&quot;not available in __OBJC2__&quot;</span>) \</span></span><br><span class="line"><span class="meta">            __IOS_DEPRECATED(2.0, 2.0, <span class="string">&quot;not available in __OBJC2__&quot;</span>)   \</span></span><br><span class="line"><span class="meta">            __TVOS_UNAVAILABLE __WATCHOS_UNAVAILABLE __BRIDGEOS_UNAVAILABLE</span></span><br><span class="line"><span class="meta">#   <span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>ä»å®šä¹‰æ¥çœ‹ï¼Œ<code>OBJC_ISA_AVAILABILITY</code> åœ¨OC2.0ç‰ˆæœ¬ä¸­æ ‡ç¤ºå·²ç»è¿‡æ—¶äº†ï¼Œ<code>OBJC2_UNAVAILABLE</code> æ ‡ç¤ºåœ¨OC2.0ä¸­å·²ç»ä¸å¯ç”¨äº†ï¼Œå°†æ¥ä¼šè¢«ç§»é™¤çš„ã€‚</p><p>æˆ‘ä»¬ä¸å¦¨æ¥æ‘˜å½•å®Œæ•´çš„ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p><p><strong>ä»£ç ä¸‰ï¼šå®Œæ•´ç‰ˆä¹Ÿç§°æ•´æ˜ç™½ç‰ˆ</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">if</span> !OBJC_TYPES_DEFINED</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/// An opaque type that represents a method in a class definition.</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_method *Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// An opaque type that represents an instance variable.</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_ivar *Ivar;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// An opaque type that represents a category.</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_category *Category;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// An opaque type that represents an Objective-C declared property.</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_property *objc_property_t;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> objc_class &#123;</span><br><span class="line">    Class _Nonnull isa  OBJC_ISA_AVAILABILITY;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> !__OBJC2__</span></span><br><span class="line">    Class _Nullable super_class                              OBJC2_UNAVAILABLE;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> * _Nonnull name                               OBJC2_UNAVAILABLE;</span><br><span class="line">    <span class="keyword">long</span> version                                             OBJC2_UNAVAILABLE;</span><br><span class="line">    <span class="keyword">long</span> info                                                OBJC2_UNAVAILABLE;</span><br><span class="line">    <span class="keyword">long</span> instance_size                                       OBJC2_UNAVAILABLE;</span><br><span class="line">    <span class="keyword">struct</span> objc_ivar_list * _Nullable ivars                  OBJC2_UNAVAILABLE;</span><br><span class="line">    <span class="keyword">struct</span> objc_method_list * _Nullable * _Nullable methodLists                    OBJC2_UNAVAILABLE;</span><br><span class="line">    <span class="keyword">struct</span> objc_cache * _Nonnull cache                       OBJC2_UNAVAILABLE;</span><br><span class="line">    <span class="keyword">struct</span> objc_protocol_list * _Nullable protocols          OBJC2_UNAVAILABLE;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">&#125; OBJC2_UNAVAILABLE;</span><br><span class="line"><span class="comment">/* Use `Class` instead of `struct objc_class *` */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œå±…ç„¶è¿˜æœ‰ä¸ªå® <code>OBJC_TYPES_DEFINED</code>ï¼Œçœ‹ä¸€ä¸‹å…¶åœ¨ <code>objc-private.h</code> ä¸­çš„å®šä¹‰ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> OBJC_TYPES_DEFINED 1</span></span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆ <code>#if !OBJC_TYPES_DEFINED</code> å·²ç»é™åˆ¶äº†å…¶åˆ° <code>#endif</code> ä¸­é—´çš„ä»£ç éƒ½æ˜¯æ— æ•ˆçš„ï¼Œæ‰€ä»¥å…³äº<strong>ä»£ç ä¸€</strong>å¤„çš„ä»£ç å…¶å®å·²ç»æ²¡æœ‰å®é™…æ„ä¹‰äº†ï¼Œç½‘ä¸Šçš„æœ‹å‹ä»¬è¯·ä¸è¦æ‹¿è¿™æ®µä»£ç å† <code>éª—äºº</code> äº†ã€‚</p><p>æºç  <code>objc-runtime-new.h</code> ä¸­å…³äº <code>objc_class</code> ä¸­çš„å®šä¹‰ä»£ç å¦‚ä¸‹ï¼š</p><p><strong>ä»£ç å››ï¼šæ­£è§£ç‰ˆ</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> objc_class : objc_object &#123;</span><br><span class="line">    <span class="comment">// Class ISA;</span></span><br><span class="line">    Class superclass;</span><br><span class="line">    cache_t cache;             <span class="comment">// formerly cache pointer and vtable</span></span><br><span class="line">    class_data_bits_t bits;    <span class="comment">// class_rw_t * plus custom rr/alloc flags</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ....</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> objc_object &#123;</span><br><span class="line">private:</span><br><span class="line">    isa_t isa;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">union</span> isa_t &#123;</span><br><span class="line">    isa_t() &#123; &#125;</span><br><span class="line">    isa_t(uintptr_t value) : bits(value) &#123; &#125;</span><br><span class="line"></span><br><span class="line">    Class cls;</span><br><span class="line">    uintptr_t bits;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> defined(ISA_BITFIELD)</span></span><br><span class="line">    <span class="keyword">struct</span> &#123;</span><br><span class="line">        ISA_BITFIELD;  <span class="comment">// defined in isa.h</span></span><br><span class="line">    &#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>æ— è®ºæ˜¯å­¦çŸ¥è¯†è¿˜æ˜¯åšçŸ¥è¯†ï¼Œè€å®è®¤çœŸåº”è¯¥æ˜¯æœ€åŸºæœ¬çš„è¦æ±‚ï¼Œåƒä¸‡ä¸è¦ä»¥è®¹ä¼ è®¹ï¼Œè¯¯äººå­å¼Ÿï¼</strong></p><hr><p><strong>åªè¦ä½ æƒ³åšï¼Œæ€»ä¼šæœ‰åŠæ³•çš„~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS objc_class </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é›†åˆå¯¹è±¡å¯å˜ä¸ä¸å¯å˜çš„é‚£ç‚¹äº‹</title>
      <link href="/2019/01/13/%E9%9B%86%E5%90%88%E5%AF%B9%E8%B1%A1%E5%8F%AF%E5%8F%98%E4%B8%8E%E4%B8%8D%E5%8F%AF%E5%8F%98%E7%9A%84%E9%82%A3%E7%82%B9%E4%BA%8B/"/>
      <url>/2019/01/13/%E9%9B%86%E5%90%88%E5%AF%B9%E8%B1%A1%E5%8F%AF%E5%8F%98%E4%B8%8E%E4%B8%8D%E5%8F%AF%E5%8F%98%E7%9A%84%E9%82%A3%E7%82%B9%E4%BA%8B/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><hr><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åœ¨æ–‡ç«  <a href="http://www.veryitman.com/2018/12/30/NSString%E3%80%81NSMutableString-%E5%8F%AF%E5%8F%98%E4%B8%8E%E4%B8%8D%E5%8F%AF%E5%8F%98%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/">NSString NSMutableString å¯å˜ä¸ä¸å¯å˜çš„é‚£äº›äº‹å„¿</a> åˆ†äº«äº†å…³äº <code>NSString</code> å’Œ <code>NSMutableString</code> ä¸ <code>copy</code> ä»¥åŠ <code>mutableCopy</code> ä¹‹é—´çš„ç‚¹æ»´ã€‚</p><p>ä»Šå¤©è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹é›†åˆç±»æ•°æ®çš„å¯å˜ä¸ä¸å¯å˜æ€§ï¼Œå†ç»“åˆ <code>copy</code> ä»¥åŠ <code>mutableCopy</code> è¯´ä¸€è¯´æ³¨æ„äº‹é¡¹ã€‚å¦‚æœä½ ä»”ç»†çœ‹è¿‡ <a href="http://www.veryitman.com/2018/12/30/NSString%E3%80%81NSMutableString-%E5%8F%AF%E5%8F%98%E4%B8%8E%E4%B8%8D%E5%8F%AF%E5%8F%98%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/">NSString NSMutableString å¯å˜ä¸ä¸å¯å˜çš„é‚£äº›äº‹å„¿</a>  è¿™ç¯‡æ–‡ç« ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥çœ‹æœ¬ç¯‡ä¼šå¾ˆè½»æ¾ã€‚</p><p><strong>æœ¬ç¯‡å†…å®¹ä¸»è¦æ¶‰åŠä»¥ä¸‹å‡ ä¸ªæ–¹é¢:</strong></p><ul><li>åœ¨ OC ä¸­çš„é›†åˆå¯¹è±¡</li><li>é›†åˆå¯¹è±¡çš„ copyã€mutableCopy</li><li>å¯å˜ä¸ä¸å¯å˜é›†åˆå¯¹è±¡ä¹‹é—´ç­‰å·èµ‹å€¼</li><li>property ä¸­çš„é›†åˆå¯¹è±¡çš„ copy å’Œ strong</li><li>å®é™…æ¡ˆä¾‹åˆ†æ</li></ul><p>ä¸ºäº†è¯´æ˜é—®é¢˜ï¼Œè¿™é‡Œï¼Œæˆ‘é€‰ç”¨æ•°ç»„(NSArray)ä½œä¸ºé›†åˆå¯¹è±¡çš„ä»£è¡¨ï¼Œå…¶ä»–çš„é›†åˆç±»ä»¥æ­¤ç±»æ¨å³å¯ã€‚</p><h2 id="é›†åˆå¯¹è±¡"><a href="#é›†åˆå¯¹è±¡" class="headerlink" title="é›†åˆå¯¹è±¡"></a>é›†åˆå¯¹è±¡</h2><p>åœ¨ <code>Objective-C</code> ä¸­ï¼Œéé›†åˆç±»å¯¹è±¡æŒ‡çš„æ˜¯ <code>NSString</code>ã€<code>NSNumber</code>ã€<code>NSValue</code> ä¹‹ç±»çš„å¯¹è±¡ï¼Œé™¤äº† <code>NSString</code> æœ‰å¯¹åº”çš„å¯å˜ç±» <code>NSMutableString</code> å¤–ï¼Œ<code>NSNumber</code>ã€<code>NSValue</code> éƒ½æ²¡æœ‰å¯å˜ç±»ä¸å…¶å¯¹åº”ã€‚</p><p>é›†åˆç±»å¯¹è±¡æ˜¯æŒ‡ <code>NSArray</code>ã€<code>NSMutableArray</code>ã€ <code>NSDictionary</code>ã€<code>NSMutableDictionary</code>ã€<code>NSSet</code>ã€<code>NSMutableSet</code> ä¹‹ç±»çš„å¯¹è±¡ã€‚</p><h2 id="é›†åˆå¯¹è±¡çš„-copyã€mutableCopy"><a href="#é›†åˆå¯¹è±¡çš„-copyã€mutableCopy" class="headerlink" title="é›†åˆå¯¹è±¡çš„ copyã€mutableCopy"></a>é›†åˆå¯¹è±¡çš„ copyã€mutableCopy</h2><p>çœ‹ä¸€ä¸ªå…·ä½“ä¾‹å­ï¼Œè¯·æ¥ç€çœ‹ä¸‹é¢çš„ç¤ºä¾‹ä»£ç å’Œè¯´æ˜ã€‚</p><p><strong>ä¾‹å­1ï¼šNSArray çš„ copyã€mutableCopy</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSArray</span> *array = [<span class="built_in">NSArray</span> arrayWithObjects:<span class="string">@&quot;veryitman.com&quot;</span>, <span class="literal">nil</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;array  addr: %p, array: %@ &quot;</span>, array, array);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ°å€æœªå˜å’Œarrayä¸€è‡´ï¼Œå†…å®¹ä¹Ÿä¸€è‡´</span></span><br><span class="line"><span class="built_in">NSArray</span> *array1 = array;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;array1 addr: %p, array1: %@&quot;</span>, array1, array1);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ°å€æœªå˜å’Œarrayä¸€è‡´ï¼Œå†…å®¹ä¹Ÿä¸€è‡´</span></span><br><span class="line"><span class="comment">// copy ä¹‹åä»ç„¶æ˜¯ä¸å¯å˜çš„æ•°ç»„å¯¹è±¡</span></span><br><span class="line"><span class="keyword">id</span> array2 = [array <span class="keyword">copy</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;array2 addr: %p, array2: %@&quot;</span>, array2, array2);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ°å€æ”¹å˜</span></span><br><span class="line"><span class="keyword">id</span> array3 = [array mutableCopy];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;array3 addr: %p, array3: %@&quot;</span>, array3, array3);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿›ä¸€æ­¥è¯´æ˜äº†ç»è¿‡mutableCopyåï¼Œarray3å˜æˆäº†å¯å˜æ•°ç»„</span></span><br><span class="line">[(<span class="built_in">NSMutableArray</span> *)(array3) addObject:<span class="string">@&quot;my blog&quot;</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;array3 addr: %p, array3: %@&quot;</span>, array3, array3);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å› ä¸ºarray3åœ°å€å˜äº†ï¼Œä¸ä¼šå½±å“arrayçš„åœ°å€å’Œå€¼</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;array  addr: %p, array: %@ &quot;</span>, array, array);</span><br></pre></td></tr></table></figure><p><strong>å°ç»“ 1ï¼š</strong></p><p>1ã€ä¸å¯å˜æ•°ç»„ <code>copy</code> ä¹‹åï¼Œä»ç„¶æ˜¯ä¸å¯å˜æ•°ç»„ï¼Œå…¶åœ°å€å’Œå†…å®¹ä¸å˜ï¼Œå³æ‹·è´äº†åŸå¯¹è±¡çš„å†…å®¹å’ŒæŒ‡é’ˆï¼Œå±äºæŒ‡é’ˆæ‹·è´ã€‚</p><p>2ã€ä¸å¯å˜æ•°ç»„ <code>mutableCopy</code> ä¹‹åï¼Œå˜æˆäº†å¯å˜æ•°ç»„ï¼Œå…¶åœ°å€å‘ç”Ÿäº†å˜åŒ–ï¼Œå³åªæ‹·è´äº†åŸå¯¹è±¡çš„å†…å®¹ï¼ŒæŒ‡é’ˆæ²¡æœ‰æ‹·è´ï¼Œå±äºå†…å®¹æ‹·è´ã€‚</p><p>3ã€ä¸å¯å˜æ•°ç»„ä¹‹é—´çš„<code>ç­‰å·(=)</code>èµ‹å€¼ï¼Œæ˜¯æŒ‡é’ˆæ‹·è´ã€‚</p><p><strong>ä¾‹å­2ï¼šNSMutableArray çš„ copyã€mutableCopy</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableArray</span> *marray = [<span class="built_in">NSMutableArray</span> arrayWithObjects:<span class="string">@&quot;veryitman.com&quot;</span>, <span class="literal">nil</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;marray  addr: %p, marray: %@ &quot;</span>, marray, marray);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ°å€æœªå˜å’Œmarrayä¸€è‡´ï¼Œå†…å®¹ä¹Ÿä¸€è‡´</span></span><br><span class="line"><span class="built_in">NSMutableArray</span> *marray1 = marray;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;marray1 addr: %p, marray1: %@ &quot;</span>, marray1, marray1);</span><br><span class="line"></span><br><span class="line"><span class="comment">// copy ä¹‹åï¼Œåœ°å€æ”¹å˜ä¸”å˜æˆäº†ä¸å¯å˜çš„æ•°ç»„å¯¹è±¡</span></span><br><span class="line"><span class="keyword">id</span> marray2 = [marray <span class="keyword">copy</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;marray2 addr: %p, marray2: %@ &quot;</span>, marray2, marray2);</span><br><span class="line"></span><br><span class="line"><span class="comment">// mutableCopy ä¹‹åï¼Œåœ°å€æ”¹å˜ä½†ä»æ˜¯å¯å˜æ•°ç»„å¯¹è±¡</span></span><br><span class="line"><span class="keyword">id</span> marray3 = [marray mutableCopy];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;marray3 addr: %p, marray3: %@ &quot;</span>, marray3, marray3);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Crashï¼šè¿›ä¸€æ­¥è¯´æ˜äº†å¯å˜æ•°ç»„å¯¹è±¡ç»è¿‡ copy ä¹‹åå˜æˆäº†ä¸å¯å˜çš„marray2</span></span><br><span class="line"><span class="comment">// -[__NSSingleObjectArrayI addObject:]: unrecognized selector sent to instance 0x600002cbd320</span></span><br><span class="line"><span class="comment">// *** Terminating app due to uncaught exception &#x27;NSInvalidArgumentException&#x27;,</span></span><br><span class="line"><span class="comment">// reason: &#x27;-[__NSSingleObjectArrayI addObject:]: unrecognized selector sent to instance 0x600002cbd320&#x27;</span></span><br><span class="line"><span class="comment">// [(NSMutableArray *)(marray2) addObject:@&quot;my blog&quot;];</span></span><br><span class="line"><span class="comment">// NSLog(@&quot;marray2 addr: %p, marray2: %@ &quot;, marray2, marray2);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿›ä¸€æ­¥è¯æ˜äº†mutableCopy ä¹‹åï¼Œmarray3æ˜¯å¯å˜æ•°ç»„</span></span><br><span class="line">[(<span class="built_in">NSMutableArray</span> *)(marray3) addObject:<span class="string">@&quot;my blog&quot;</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;marray3 addr: %p, marray3: %@ &quot;</span>, marray3, marray3);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å› ä¸ºmarray3åœ°å€æ”¹å˜äº†ï¼Œæ‰€ä»¥å¯¹marray3çš„æ“ä½œä¸ä¼šå½±å“åŸæ¥çš„æ•°ç»„å¯¹è±¡marray</span></span><br><span class="line"><span class="comment">// marray åœ°å€å’Œå†…å®¹ä¿æŒä¸å˜</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;marray  addr: %p, marray: %@ &quot;</span>, marray, marray);</span><br></pre></td></tr></table></figure><p><strong>å°ç»“ 2ï¼š</strong></p><p>1ã€å¯å˜æ•°ç»„ <code>copy</code> ä¹‹åï¼Œä¼šå˜æˆä¸å¯å˜æ•°ç»„ï¼Œå…¶å†…å®¹ä¸å˜ï¼Œä½†æ˜¯åœ°å€æ”¹å˜äº†ï¼Œå³åªæ‹·è´äº†åŸå¯¹è±¡çš„å†…å®¹ï¼Œæ²¡æœ‰è¿›è¡ŒæŒ‡é’ˆæ‹·è´ï¼Œå±äºå†…å®¹æ‹·è´ã€‚</p><p>2ã€å¯å˜æ•°ç»„ <code>mutableCopy</code> ä¹‹åï¼Œä»ç„¶æ˜¯ä¸å¯å˜æ•°ç»„ï¼Œå…¶åœ°å€å‘ç”Ÿäº†å˜åŒ–ï¼Œå†…å®¹æ²¡æœ‰å˜åŒ–ï¼Œå³åªæ‹·è´äº†åŸå¯¹è±¡çš„å†…å®¹ï¼ŒæŒ‡é’ˆæ²¡æœ‰æ‹·è´ï¼Œå±äºå†…å®¹æ‹·è´ã€‚</p><p>3ã€å¯å˜æ•°ç»„ä¹‹é—´<code>ç­‰å·(=)</code>èµ‹å€¼ï¼Œæ˜¯æŒ‡é’ˆæ‹·è´ã€‚</p><p><strong>ä¾‹å­3ï¼šNSMutableArray å’Œ NSArray ä¹‹é—´ç­‰å·èµ‹å€¼</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** å‘ä¸å¯å˜æ•°ç»„èµ‹å€¼å¯å˜æ•°ç»„ */</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSMutableArray</span> *tDatas = [<span class="built_in">NSMutableArray</span> arrayWithObjects:<span class="string">@&quot;veryitman.com&quot;</span>, <span class="literal">nil</span>];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;--1--- tDatas addr: %p, tDatas: %@&quot;</span>, tDatas, tDatas);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç±»ä¼¼ä½†ä¸åŒäºå¯å˜æ•°ç»„çš„mutableCopyæ“ä½œï¼Œæ­¤æ—¶ array çš„åœ°å€æœªå˜å’ŒtDatasåœ°å€ä¸€è‡´</span></span><br><span class="line">    <span class="comment">// arrayçš„å†…å®¹å’Œåœ°å€æœªå‘ç”Ÿå˜åŒ–ï¼Œå’ŒtDatasä¸€è‡´</span></span><br><span class="line">    <span class="built_in">NSArray</span> *array = tDatas;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;--2--- array addr: %p, array: %@&quot;</span>, array, array);</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"> <span class="comment">/** å‘å¯å˜æ•°ç»„èµ‹å€¼ä¸å¯å˜æ•°ç»„ */</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSArray</span> *tDatas = [<span class="built_in">NSArray</span> arrayWithObjects:<span class="string">@&quot;veryitman.com&quot;</span>, <span class="literal">nil</span>];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;--1--- tDatas addr: %p, tDatas: %@&quot;</span>, tDatas, tDatas);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç±»ä¼¼è¿›è¡Œäº†ä¸å¯å˜æ•°ç»„çš„ copy æ“ä½œ</span></span><br><span class="line">    <span class="comment">// array ä»æ—§æ˜¯ä¸å¯å˜çš„ï¼Œåœ°å€å’Œå†…å®¹ä¸tDatasä¸€è‡´</span></span><br><span class="line">    <span class="built_in">NSMutableArray</span> *array = tDatas;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;--2--- array addr: %p, array: %@&quot;</span>, array, array);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// crash: è¿˜æ˜¯ä¸å¯å˜çš„æ•°ç»„</span></span><br><span class="line">    <span class="comment">// -[__NSArrayI addObject:]: unrecognized selector sent to instance 0x6000025499c0</span></span><br><span class="line">    <span class="comment">// Terminating app due to uncaught exception &#x27;NSInvalidArgumentException&#x27;,</span></span><br><span class="line">    <span class="comment">// reason: &#x27;-[__NSArrayI addObject:]: unrecognized selector sent to instance 0x6000025499c0&#x27;</span></span><br><span class="line">    <span class="comment">// [array addObject:@&quot;blog&quot;];</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">-<span class="number">-1</span>--- tDatas addr: <span class="number">0x6000023a8bd0</span>, tDatas: (</span><br><span class="line">    <span class="string">&quot;veryitman.com&quot;</span></span><br><span class="line">)</span><br><span class="line">-<span class="number">-2</span>--- array addr: <span class="number">0x6000023a8bd0</span>, array: (</span><br><span class="line">    <span class="string">&quot;veryitman.com&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">-<span class="number">-1</span>--- tDatas addr: <span class="number">0x600002dbbf00</span>, tDatas: (</span><br><span class="line">    <span class="string">&quot;veryitman.com&quot;</span></span><br><span class="line">)</span><br><span class="line">-<span class="number">-2</span>--- array addr: <span class="number">0x600002dbbf00</span>, array: (</span><br><span class="line">  <span class="string">&quot;veryitman.com&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šæ˜¯ä½¿ç”¨ <code>NSArray</code>ã€<code>NSMutableArray</code> æ¥è¿›è¡Œæµ‹è¯•çš„ï¼Œ<code>NSDictionary</code> å’Œ <code>NSSet</code> ä»¥åŠå…¶å¯¹åº”çš„å¯å˜ç±»å‹éƒ½éµå¾ªä¸Šé¢æ€»ç»“çš„å†…å®¹ã€‚</p><h2 id="copyã€strong-ä¿®é¥°å±æ€§"><a href="#copyã€strong-ä¿®é¥°å±æ€§" class="headerlink" title="copyã€strong ä¿®é¥°å±æ€§"></a>copyã€strong ä¿®é¥°å±æ€§</h2><p>åœ¨å±æ€§ä¸­ï¼Œæˆ‘ä»¬å¦‚ä½•æ¥é€‰æ‹© <code>copy</code> æˆ–è€… <code>strong</code> æ¥ä½œä¸ºé›†åˆæ•°æ®çš„ä¿®é¥°è¯­å‘¢ï¼Ÿ</p><p>æ ¹æ®ä¸Šé¢ç¤ºä¾‹åˆ†æç»“æœå¯ä»¥çœ‹å‡ºï¼Œåœ¨å±æ€§ä¸­ï¼Œå¦‚æœä½¿ç”¨ <code>strong</code> ä¿®é¥°ä¸å¯å˜æ•°ç»„ï¼Œé‚£ä¹ˆåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­(è¢«å¯å˜æ•°ç»„èµ‹å€¼)è¯¥ä¸å¯å˜æ•°ç»„æœ‰å¯èƒ½ä¼šå˜ä¸ºå¯å˜æ•°ç»„ã€‚å¦‚æœä½¿ç”¨ <code>copy</code> ä¿®é¥°å¯å˜æ•°ç»„ï¼Œé‚£ä¹ˆåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼ˆè¢«ä¸å¯å˜æ•°ç»„èµ‹å€¼ï¼‰è¯¥å¯å˜æ•°ç»„æœ‰å¯èƒ½å˜ä¸ºä¸å¯å˜æ•°ç»„ã€‚</p><p><strong>å°ç»“ 3ï¼š</strong></p><p>å½“ä¿®é¥°å¯å˜ç±»å‹çš„å±æ€§æ—¶ï¼Œå¦‚ <code>NSMutableArray</code>ã€<code>NSMutableDictionary</code>ã€<code>NSMutableSet</code> ç­‰é›†åˆç±»å‹æ—¶ï¼Œç”¨ <code>strong</code> ä¿®é¥°ã€‚</p><p>å½“ä¿®é¥°ä¸å¯å˜ç±»å‹çš„å±æ€§æ—¶ï¼Œå¦‚ <code>NSArray</code>ã€<code>NSDictionary</code>ã€<code>NSSet</code> ç­‰é›†åˆç±»å‹æ—¶ï¼Œç”¨ <code>copy</code> ä¿®é¥°ã€‚</p><p>å¤§å®¶å¦‚æœæœ‰å…´è¶£å¯ä»¥å‚è€ƒæ–‡ç«  <a href="http://www.veryitman.com/2018/12/30/NSString%E3%80%81NSMutableString-%E5%8F%AF%E5%8F%98%E4%B8%8E%E4%B8%8D%E5%8F%AF%E5%8F%98%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/">NSString NSMutableString å¯å˜ä¸ä¸å¯å˜çš„é‚£äº›äº‹å„¿</a>  çš„åšæ³•æ¥éªŒè¯ä¸Šé¢çš„ç†è®ºçŸ¥è¯†ã€‚</p><h2 id="å®é™…æ¡ˆä¾‹åˆ†æ"><a href="#å®é™…æ¡ˆä¾‹åˆ†æ" class="headerlink" title="å®é™…æ¡ˆä¾‹åˆ†æ"></a>å®é™…æ¡ˆä¾‹åˆ†æ</h2><p>å†ç»™å¤§å®¶ä¸¾ä¸ªå®é™…çš„å¼€å‘æ¡ˆä¾‹ï¼Œæˆ‘ä»¬éœ€è¦å®šæ—¶ä¸ŠæŠ¥ç›®é‡‡é›†APPçš„æ•°æ®ï¼Œè¿™ä¸ªéœ€æ±‚çœ‹èµ·æ¥æ˜¯æ²¡æœ‰ä»»ä½•éš¾åº¦çš„ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨ä»£ç æ¥æ¨¡æ‹Ÿä¸€ä¸‹ä¸ŠæŠ¥æ•°æ®çš„è¿™ä¸ªè¿‡ç¨‹ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é‡‡é›†åˆ°çš„æ•°æ®</span></span><br><span class="line"><span class="built_in">NSMutableDictionary</span> *tDatas = [<span class="built_in">NSMutableDictionary</span> dictionaryWithCapacity:<span class="number">5</span>];</span><br><span class="line">[tDatas setObject:<span class="string">@&quot;https://&quot;</span> forKey:<span class="string">@&quot;req_m&quot;</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;--é‡‡é›†æ•°æ®--- tDatas addr: %p, tDatas: %@&quot;</span>, tDatas, tDatas);</span><br><span class="line"><span class="comment">// å¼€å§‹å‘é€</span></span><br><span class="line">[<span class="keyword">self</span> sendDatas:tDatas];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;--ä¸ŠæŠ¥å®Œæˆï¼ŒåŸæ•°æ®--- tDatas addr: %p, tDatas: %@&quot;</span>, tDatas, tDatas);</span><br></pre></td></tr></table></figure><p>å‘é€æ•°æ®çš„æ¨¡æ‹Ÿç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)sendDatas:(<span class="built_in">NSDictionary</span> *)datas</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;--ä¸ŠæŠ¥ä¸­--- datas addr: %p, datas: %@&quot;</span>, datas, datas);</span><br><span class="line">    </span><br><span class="line"><span class="comment">/** ä¸‹é¢ä¸¤è¡Œä»£ç åªæ˜¯ä¸ºäº†æ¨¡æ‹ŸåŸæ•°æ®è¢«å¤–ç•Œåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è¢«æ”¹å˜ï¼Œæ¯”å¦‚å…¶ä»–é‡‡é›†çº¿ç¨‹æ”¹å˜äº†å®ƒ */</span></span><br><span class="line">    <span class="keyword">if</span> ([datas isKindOfClass:[<span class="built_in">NSMutableDictionary</span> <span class="keyword">class</span>]]) &#123;</span><br><span class="line">        [(<span class="built_in">NSMutableDictionary</span> *)datas setObject:<span class="string">@&quot;veryitman.com&quot;</span> forKey:<span class="string">@&quot;test_m&quot;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;--ä¸ŠæŠ¥å®Œæˆ--- datas addr: %p, datas: %@&quot;</span>, datas, datas);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¹æ®ä¸Šé¢<strong>ä¾‹å­3</strong>æåˆ°çš„ï¼Œä¸å¯å˜å‘å¯å˜ç­‰å·èµ‹å€¼æ—¶ï¼ŒåŸä¸å¯å˜å¯¹è±¡ä¼šå˜æˆå¯å˜å¯¹è±¡ã€‚</p><p>æ§åˆ¶å°è¾“å‡ºæ—¥å¿—ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">--é‡‡é›†æ•°æ®--- tDatas addr: <span class="number">0x600000b788e0</span>, tDatas: &#123;</span><br><span class="line">req_m = https:<span class="comment">//;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">--ä¸ŠæŠ¥ä¸­--- datas addr: <span class="number">0x600000b788e0</span>, datas: &#123;</span><br><span class="line">req_m = https:<span class="comment">//;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">--ä¸ŠæŠ¥å®Œæˆ--- datas addr: <span class="number">0x600000b788e0</span>, datas: &#123;</span><br><span class="line">req_m = https:<span class="comment">//;</span></span><br><span class="line">test_m = veryitman.com;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">--ä¸ŠæŠ¥å®Œæˆï¼ŒåŸæ•°æ®--- tDatas addr: <span class="number">0x600000b788e0</span>, tDatas: &#123;</span><br><span class="line">req_m = https:<span class="comment">//;</span></span><br><span class="line">test_m = veryitman.com;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢ä»£ç çš„ä»£ç ï¼Œæˆ‘æ˜¯ä¸ºäº†æ¨¡æ‹ŸåŸæ•°æ®è¢«å…¶ä»–ä»£ç æ”¹å˜äº†çš„æƒ…å†µï¼Œåªæ˜¯ä¸ºäº†è¯´æ˜ï¼Œä¸å¯å˜å¯¹è±¡å®¹æ˜“è¢«å¤–ç•Œå½±å“å’Œæ”¹å˜ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** ä¸‹é¢ä¸¤è¡Œä»£ç åªæ˜¯ä¸ºäº†æ¨¡æ‹ŸåŸæ•°æ®è¢«å¤–ç•Œåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è¢«æ”¹å˜ï¼Œæ¯”å¦‚å…¶ä»–é‡‡é›†çº¿ç¨‹æ”¹å˜äº†å®ƒ */</span></span><br><span class="line"><span class="keyword">if</span> ([datas isKindOfClass:[<span class="built_in">NSMutableDictionary</span> <span class="keyword">class</span>]]) &#123;</span><br><span class="line">    [(<span class="built_in">NSMutableDictionary</span> *)datas setObject:<span class="string">@&quot;veryitman.com&quot;</span> forKey:<span class="string">@&quot;test_m&quot;</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„æ€»ç»“åˆæåˆ°æ— è®ºæ˜¯å¯å˜å¯¹è±¡è¿˜æ˜¯ä¸å¯å˜å¯¹è±¡ç»è¿‡ <code>copy</code> ä¹‹åéƒ½æ˜¯ä¸å¯å˜å¯¹è±¡çš„åŸç†ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹ä»£ç ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)sendDatas:(<span class="built_in">NSDictionary</span> *)datas</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSDictionary</span> *copy_datas = [datas <span class="keyword">copy</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;--ä¸ŠæŠ¥ä¸­--- copy_datas addr: %p, copy_datas: %@&quot;</span>, copy_datas, copy_datas);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ([copy_datas isKindOfClass:[<span class="built_in">NSMutableDictionary</span> <span class="keyword">class</span>]]) &#123;</span><br><span class="line">        [(<span class="built_in">NSMutableDictionary</span> *)copy_datas setObject:<span class="string">@&quot;veryitman.com&quot;</span> forKey:<span class="string">@&quot;test_m&quot;</span>];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@&quot;Yes, copy_datas æ˜¯ä¸å¯å˜å­—å…¸ã€‚&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;--ä¸ŠæŠ¥å®Œæˆ--- copy_datas addr: %p, copy_datas: %@&quot;</span>, copy_datas, copy_datas);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> --é‡‡é›†æ•°æ®--- tDatas addr: <span class="number">0x600003b08740</span>, tDatas: &#123;</span><br><span class="line">req_m = https:<span class="comment">//;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">--ä¸ŠæŠ¥ä¸­--- copy_datas addr: <span class="number">0x600003b08700</span>, copy_datas: &#123;</span><br><span class="line">req_m = https:<span class="comment">//;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Yes, copy_datas æ˜¯ä¸å¯å˜å­—å…¸ã€‚</span><br><span class="line"></span><br><span class="line">--ä¸ŠæŠ¥å®Œæˆ--- copy_datas addr: <span class="number">0x600003b08700</span>, copy_datas: &#123;</span><br><span class="line">req_m = https:<span class="comment">//;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">--ä¸ŠæŠ¥å®Œæˆï¼ŒåŸæ•°æ®--- tDatas addr: <span class="number">0x600003b08740</span>, tDatas: &#123;</span><br><span class="line">req_m = https:<span class="comment">//;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p><strong>æ‰«ç å…³æ³¨ï¼ŒæœŸå¾…ä¸ä½ çš„äº¤æµ~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS é›†åˆå¯¹è±¡ å¯å˜ ä¸å¯å˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>macOSä¸‹ç”Ÿæˆå­—ç¬¦ä¸²md5</title>
      <link href="/2019/01/13/macOS%E4%B8%8B%E7%94%9F%E6%88%90%E5%AD%97%E7%AC%A6%E4%B8%B2md5/"/>
      <url>/2019/01/13/macOS%E4%B8%8B%E7%94%9F%E6%88%90%E5%AD%97%E7%AC%A6%E4%B8%B2md5/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><hr><p>åœ¨ macOS ç³»ç»Ÿä¸‹ç”Ÿæˆä»»æ„å­—ç¬¦ä¸²çš„ md5 å€¼ï¼Œå¾ˆç®€å•ï¼Œç›´æ¥ä½¿ç”¨ <code>md5</code> å‘½ä»¤å³å¯ã€‚</p><p>ä¾‹å¦‚ï¼Œè¦ç”Ÿæˆ <code>veryitman.com</code> è¿™ä¸ªå­—ç¬¦ä¸²çš„md5å€¼ï¼Œç›´æ¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å³å¯ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md5 -s veryitman.com</span><br></pre></td></tr></table></figure><p>å¯¹åº”ç”Ÿæˆçš„ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MD5 (&quot;veryitman.com&quot;) = c5c401dcdacd95052eef360c3533a8bd</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¦æ³¨æ„ï¼Œæœ‰äº›ä½¿ç”¨è€…ä¼šè¿™æ ·æ¥è®¡ç®—ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;veryitman.com&quot; | md5</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bc239ea4ba4ebbd4ef9e61c160fcac3c</span><br></pre></td></tr></table></figure><p>å‘ç°å’Œä¸Šé¢çš„ç»“æœä¸ä¸€è‡´ï¼Œè¿™æ˜¯å› ä¸º <code>echo</code> é»˜è®¤ä¼šæ·»åŠ ä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œå¯¼è‡´è®¡ç®—çš„md5å€¼ä¸ä¸€è‡´ï¼Œä¿®æ”¹ä¸€ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo -n &quot;veryitman.com&quot; | md5</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆç»“æœ <code>c5c401dcdacd95052eef360c3533a8bd</code> ä¸ä¸Šé¢ä¸€è‡´äº†ã€‚</p><p><strong>æ³¨æ„ï¼š <code>echo -n</code> ç”¨æ¥ä¸æ˜¾ç¤ºç»“å°¾çš„æ¢è¡Œç¬¦ã€‚</strong></p><p>æ›´å¤šå…³äº <code>md5</code> çš„å‘½ä»¤ å¯ä»¥é—®ç”·äºº(man)ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">man md5</span><br></pre></td></tr></table></figure><p><code>MD5(Message-Digest Algorithm 5)</code> å…¨ç§°æ˜¯æŠ¥æ–‡æ‘˜è¦ç®—æ³•ï¼Œæ­¤ç®—æ³•å¯¹ä»»æ„é•¿åº¦çš„ä¿¡æ¯é€ä½è¿›è¡Œè®¡ç®—ï¼Œäº§ç”Ÿä¸€ä¸ªäºŒè¿›åˆ¶é•¿åº¦ä¸º128ä½ï¼ˆåå…­è¿›åˆ¶é•¿åº¦å°±æ˜¯32ä½ï¼‰çš„â€œæŒ‡çº¹â€ï¼ˆæˆ–ç§°â€œæŠ¥æ–‡æ‘˜è¦â€ï¼‰ï¼Œä¸åŒçš„æ–‡ä»¶ä¹Ÿèƒ½äº§ç”Ÿç›¸åŒçš„æŠ¥æ–‡æ‘˜è¦ï¼Œä½†æ˜¯å¯èƒ½æ€§æ˜¯æå…¶å°çš„ã€‚ </p><p><code>MD5 ç®—æ³•</code> å¸¸å¸¸è¢«ç”¨æ¥éªŒè¯ç½‘ç»œæ–‡ä»¶ä¼ è¾“çš„å®Œæ•´æ€§ï¼Œé˜²æ­¢æ–‡ä»¶è¢«äººç¯¡æ”¹ï¼Œä½†æ˜¯ç°åœ¨ MD5 çš„ç®—æ³•å¹¶ä¸å®‰å…¨äº†ã€‚</p><p>åœ¨ macOS ä¸Šé¢è¿˜æœ‰ <code>md5sum</code> è¿™ä¸ªå‘½ä»¤ï¼Œä¸€èˆ¬ç”¨æ¥è®¡ç®—æ–‡ä»¶çš„md5å€¼ã€‚</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼ŒæœŸå¾…ä¸ä½ çš„äº¤æµ~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> MacOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> macOS string md5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS ä¸­å¦‚ä½•ä½¿ç”¨å¯¹è±¡çš„å¼±å¼•ç”¨</title>
      <link href="/2019/01/06/iOS-%E4%B8%AD%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%BC%B1%E5%BC%95%E7%94%A8/"/>
      <url>/2019/01/06/iOS-%E4%B8%AD%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%BC%B1%E5%BC%95%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æˆ‘ä»¬éƒ½çŸ¥é“ä½¿ç”¨ <code>UIImage imageNamed</code> åˆ›å»ºçš„ <code>UIImage</code> å¯¹è±¡ä¼šè¢«æŒæœ‰(å¼ºå¼•ç”¨)ï¼Œå¦‚æœå›¾ç‰‡å¤ªå¤§ä¼šå ç”¨å†…å­˜ï¼ŒæŸè€— APP çš„æ€§èƒ½ï¼Œå½±å“ç”¨æˆ·ä½“éªŒï¼Œå¦‚æœèƒ½æ”¹é€ å¯¹å…¶çš„å¼ºå¼•ç”¨å˜ä¸ºå¼±å¼•ç”¨å°±å¯ä»¥è§£å†³é—®é¢˜ã€‚</p><p>æˆ‘ä»¬å¯èƒ½ä¼šæœ‰ç±»ä¼¼ä¸Šé¢çš„åœºæ™¯ï¼Œæœ‰äº›å¯¹è±¡æš‚æ—¶ä¿å­˜èµ·æ¥ï¼Œå¯èƒ½åé¢ä¼šç”¨åˆ°ï¼Œä¹Ÿæœ‰å¯èƒ½ä¸ä¼šä½¿ç”¨ï¼Œä½†æ˜¯åˆä¸æƒ³å»ç®¡ç†å®ƒä»¬çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¦‚æœå®ƒä»¬èƒ½å¤Ÿè‡ªå·±è¢«é”€æ¯å°±å¾ˆçœäº‹ï¼Œä¸éœ€è¦å»å…³å¿ƒè¿™äº›å¯¹è±¡åˆ°åº•è€—è´¹äº†å¤šå°‘å†…å­˜ã€‚</p><p>ä»Šå¤©è·Ÿå¤§å®¶èŠèŠå¦‚ä½•åœ¨ iOS å¼€å‘ä¸­ä¿æŒå¯¹å¯¹è±¡çš„å¼±å¼•ç”¨è€Œä¸æ˜¯å¼ºå¼•ç”¨ï¼Œå¸Œæœ›çœ‹å®Œä¹‹åï¼Œèƒ½å¸®åŠ©åˆ°å¤§å®¶å»è§£å†³å®é™…é—®é¢˜ã€‚</p><h2 id="NSObject-retainCount"><a href="#NSObject-retainCount" class="headerlink" title="NSObject retainCount"></a>NSObject retainCount</h2><p>åœ¨ iOS ä¸­åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„å¼•ç”¨è®¡æ•°å°±ä¼šåŠ 1ï¼Œä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSObject</span> *obj = [<span class="built_in">NSObject</span> alloc] init];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;obj retain count: %zd&quot;</span>, [obj retainCount]);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä¾‹å­è¾“å‡ºæ˜¯1ï¼Œå½“ç„¶åœ¨ ARC ä¸‹æ˜¯æ— æ³•ä½¿ç”¨ <code>retainCount</code> è¿™ä¸ªæ–¹æ³•çš„ï¼Œåªæœ‰åœ¨é ARC æ¡ä»¶ä¸‹æ‰å¯ä»¥ï¼Œå¦‚æœè¦è¿è¡Œä¸Šé¢çš„ä¾‹å­ï¼Œå¯¹åº”çš„æ–‡ä»¶éœ€è¦è®¾ç½®ä¸º <code>-fno-objc-arc</code>.</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">NSUInteger</span>)retainCount OBJC_ARC_UNAVAILABLE;</span><br></pre></td></tr></table></figure><p>å¯ä»¥åœ¨ <code>usr/include/objc/NSObject.h</code> ä¸­æŸ¥çœ‹ï¼Œ<code>retainCount</code> æ˜¯ <code>NSObject åè®®</code>ï¼ˆ<code>@protocol NSObject</code>ï¼‰ä¸­å®šä¹‰çš„ä¸€ä¸ªæ–¹æ³•ï¼Œè€Œ <code>NSObject</code> ç±»æ˜¯å®ç°äº†è¯¥åè®®çš„ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSObject</span> &lt;<span class="title">NSObject</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ï¼Œä»»ä½•OCå¯¹è±¡éƒ½å…·æœ‰ <code>retainCount</code> æ–¹æ³•ã€‚å¦å¤–ï¼Œä½ æ·»åŠ ä¸€ä¸ªè§†å›¾ï¼Œè§†å›¾å…¶å®ä¹Ÿæ˜¯è¢«å®¹å™¨å¼•ç”¨äº†ï¼Œå…¶è®¡æ•°ä¹Ÿä¼šåŠ 1è¢«å®¹å™¨æŒæœ‰å…¶å¼ºå¼•ç”¨ï¼Œå†ä¾‹å¦‚åœ¨æ•°ç»„ä¸­æ·»åŠ ä¸€ä¸ªå¯¹è±¡ï¼Œä¼šä½¿å¯¹è±¡çš„å¼•ç”¨è®¡æ•°åŠ 1ï¼Œè¢«æ•°ç»„æ‰€æŒæœ‰ã€‚ </p><h2 id="NSValue-valueWithNonretainedObject"><a href="#NSValue-valueWithNonretainedObject" class="headerlink" title="NSValue valueWithNonretainedObject"></a>NSValue valueWithNonretainedObject</h2><p>åœ¨ iOS ä¸­ï¼Œ<code>NSValue</code> çš„ç±»æ–¹æ³• <code>valueWithNonretainedObject</code> å¯ä»¥ä¿æŒå¯¹å¯¹è±¡çš„å¼±å¼•ç”¨ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="built_in">NSValue</span> *)valueWithNonretainedObject:(<span class="keyword">nullable</span> <span class="keyword">id</span>)anObject;</span><br></pre></td></tr></table></figure><blockquote><p>This method is useful if you want to add an object to a Collection but donâ€™t want the collection to create a strong reference to it.</p></blockquote><p>å¤§æ¦‚æ„æ€æ˜¯ï¼Œè¯¥æ–¹æ³•å¯ä»¥ä¸æŒæœ‰å¯¹è±¡çš„å¼ºå¼•ç”¨ï¼Œæ¢å¥è¯è¯´ï¼ŒåªæŒæœ‰å¯¹è±¡çš„å¼±å¼•ç”¨ã€‚</p><p>ä¸¾ä¸ªæ —å­~</p><p><strong>MZDog.h</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MZDog</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p><strong>MZDog.m</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="string">&quot;MZDog.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MZDog</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSString</span> *)description</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@&quot;MZDog-obj retain count: %zd&quot;</span>, [<span class="keyword">self</span> retainCount]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œ <code>MZDog</code> æ˜¯è®¾ç½®äº†é ARC çš„ï¼Œå¦‚å›¾ï¼š<br><img src="/upload/images/2019/01/06/1.jpg"></p><p>åœ¨æµ‹è¯•æ–‡ä»¶ä¸­ä½¿ç”¨ <code>MZDog</code>ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// retainCount -&gt; 1</span></span><br><span class="line">MZDog *dog = [MZDog new];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;dog: %@&quot;</span>, dog);</span><br><span class="line">    </span><br><span class="line"><span class="comment">// å¯¹ dog ä½¿ç”¨å¼±å¼•ç”¨ï¼Œæ­¤æ—¶å…¶å¼•ç”¨è®¡æ•°è¿˜æ˜¯1</span></span><br><span class="line"><span class="built_in">NSValue</span> *value = [<span class="built_in">NSValue</span> valueWithNonretainedObject:dog];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;dog: %@, value: %@&quot;</span>, dog, value);</span><br><span class="line">    </span><br><span class="line"><span class="comment">// è·å– value å¯¹åº”çš„å¯¹è±¡</span></span><br><span class="line"><span class="keyword">id</span> obj = value.nonretainedObjectValue;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;obj isKindOfClass MZDog: %i&quot;</span>, [obj isKindOfClass:[MZDog <span class="keyword">class</span>]]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (obj == dog) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;The obj is same dog object.&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„æ§åˆ¶å°è¾“å‡ºï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dog: MZDog-obj <span class="keyword">retain</span> count: <span class="number">1</span></span><br><span class="line">dog: MZDog-obj <span class="keyword">retain</span> count: <span class="number">1</span>, value: &lt;<span class="number">308</span>cf600 <span class="number">00600000</span>&gt;</span><br><span class="line">obj isKindOfClass MZDog: <span class="number">1</span></span><br><span class="line">The obj is same dog object.</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œ<code>valueWithNonretainedObject</code> å¯¹ <code>MZDog</code> å¯¹è±¡ <code>dog</code> æ˜¯æ²¡æœ‰å¼ºåº”ç”¨çš„ã€‚ä¿®æ”¹ä»£ç ï¼Œç¤ºä¾‹ä¸€ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// retainCount -&gt; 1</span></span><br><span class="line">MZDog *dog = [MZDog new];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;dog: %@&quot;</span>, dog);</span><br><span class="line">    </span><br><span class="line"><span class="comment">// å¯¹ dog ä½¿ç”¨å¼±å¼•ç”¨ï¼Œæ­¤æ—¶å…¶å¼•ç”¨è®¡æ•°è¿˜æ˜¯1</span></span><br><span class="line"><span class="built_in">NSValue</span> *value = [<span class="built_in">NSValue</span> valueWithNonretainedObject:dog];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;dog: %@, value: %@&quot;</span>, dog, value);</span><br><span class="line">    </span><br><span class="line"><span class="comment">// ç»è¿‡NSValueåŒ…è£…åï¼Œå¯ä»¥æ”¾åˆ°å¯¹åº”çš„é›†åˆå¯¹è±¡(å¦‚æ•°ç»„ï¼Œå­—å…¸ç­‰)ä¸­ï¼Œè¿™æ ·è¿™äº›é›†åˆå°±ä¸ä¼šå¯¹ dog è¿›è¡Œå¼ºå¼•ç”¨äº†</span></span><br><span class="line"><span class="built_in">NSArray</span> *array = [<span class="built_in">NSArray</span> arrayWithObjects:value, <span class="literal">nil</span>];</span><br><span class="line"><span class="comment">// dog çš„å¼•ç”¨è®¡æ•°è¿˜æ˜¯1</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;dog: %@, array: %@&quot;</span>, dog, array);</span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„è¾“å‡ºæ—¥å¿—ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dog: MZDog-obj <span class="keyword">retain</span> count: <span class="number">1</span></span><br><span class="line">dog: MZDog-obj <span class="keyword">retain</span> count: <span class="number">1</span>, value: &lt;<span class="number">40</span>b7a401 <span class="number">00600000</span>&gt;</span><br><span class="line">dog: MZDog-obj <span class="keyword">retain</span> count: <span class="number">1</span>, array: (<span class="string">&quot;&lt;40b7a401 00600000&gt;&quot;</span>)</span><br></pre></td></tr></table></figure><p>æ–¹æ³• <code>valueWithNonretainedObject</code> ç­‰åŒäº</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSValue</span> *theValue = [<span class="built_in">NSValue</span> value:&amp;anObject withObjCType:<span class="keyword">@encode</span>(<span class="keyword">void</span> *)];</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ç¤ºä¾‹ï¼Œå¯ä»¥æ”¹å†™ä¸€ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// retainCount -&gt; 1</span></span><br><span class="line">MZDog *dog = [MZDog new];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;dog: %@&quot;</span>, dog);</span><br><span class="line">    </span><br><span class="line"><span class="comment">// å¯¹ dog ä½¿ç”¨å¼±å¼•ç”¨ï¼Œæ­¤æ—¶å…¶å¼•ç”¨è®¡æ•°è¿˜æ˜¯1</span></span><br><span class="line"><span class="built_in">NSValue</span> *value = [<span class="built_in">NSValue</span> value:&amp;dog withObjCType:<span class="keyword">@encode</span>(<span class="keyword">void</span> *)];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;dog: %@, value: %@&quot;</span>, dog, value);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»è¿‡NSValueåŒ…è£…åï¼Œå¯ä»¥æ”¾åˆ°å¯¹åº”çš„é›†åˆå¯¹è±¡(å¦‚æ•°ç»„ï¼Œå­—å…¸ç­‰)ä¸­ï¼Œè¿™æ ·è¿™äº›é›†åˆå°±ä¸ä¼šå¯¹ dog è¿›è¡Œå¼ºå¼•ç”¨äº†</span></span><br><span class="line"><span class="built_in">NSArray</span> *array = [<span class="built_in">NSArray</span> arrayWithObjects:value, <span class="literal">nil</span>];</span><br><span class="line"><span class="comment">// dog çš„å¼•ç”¨è®¡æ•°è¿˜æ˜¯1</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;dog: %@, array: %@&quot;</span>, dog, array);</span><br></pre></td></tr></table></figure><p>è¾“å‡ºæ—¥å¿—ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dog: MZDog-obj <span class="keyword">retain</span> count: <span class="number">1</span></span><br><span class="line">dog: MZDog-obj <span class="keyword">retain</span> count: <span class="number">1</span>, value: &lt;<span class="number">40568</span>a02 <span class="number">00600000</span>&gt;</span><br><span class="line">dog: MZDog-obj <span class="keyword">retain</span> count: <span class="number">1</span>, array: (<span class="string">&quot;&lt;40568a02 00600000&gt;&quot;</span>)</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ <code>dog</code> çš„å¼•ç”¨è®¡æ•°è¿˜æ˜¯æ²¡æœ‰å¢åŠ ~</p><h2 id="è‡ªå†™å¼±å¼•ç”¨çš„é›†åˆåˆ†ç±»"><a href="#è‡ªå†™å¼±å¼•ç”¨çš„é›†åˆåˆ†ç±»" class="headerlink" title="è‡ªå†™å¼±å¼•ç”¨çš„é›†åˆåˆ†ç±»"></a>è‡ªå†™å¼±å¼•ç”¨çš„é›†åˆåˆ†ç±»</h2><p>æ ¹æ®ä¸Šé¢çš„ç†è®ºçŸ¥è¯†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>NSValue</code> å†™å‡ºå¼±å¼•ç”¨çš„é›†åˆå¯¹è±¡ï¼Œæ€è·¯å¾ˆç®€å•ï¼Œåˆ›å»ºé›†åˆç±»çš„åˆ†ç±»ï¼Œç„¶åä½¿ç”¨ <code>NSValue</code> æ¥è¿›è¡ŒåŒ…è£…ã€‚çœ‹ä¸‹é¢çš„ç¤ºä¾‹ä»£ç å³å¯ã€‚</p><p><strong>NSArray+MZWeak.h</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSArray</span> (<span class="title">MZWeak</span>)</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)mz_weak_objectAtIndex:(<span class="built_in">NSUInteger</span>)index;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSMutableArray</span> (<span class="title">MZWeak</span>)</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)mz_weak_addObject:(<span class="keyword">id</span>)obj;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p><strong>NSArray+MZWeak.m</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="string">&quot;NSArray+MZWeak.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NSArray</span> (<span class="title">MZWeak</span>)</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)mz_weak_objectAtIndex:(<span class="built_in">NSUInteger</span>)index</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSValue</span> *value = [<span class="keyword">self</span> objectAtIndex:index];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> value.nonretainedObjectValue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NSMutableArray</span> (<span class="title">MZWeak</span>)</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)mz_weak_addObject:(<span class="keyword">id</span>)obj</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSValue</span> *value = [<span class="built_in">NSValue</span> valueWithNonretainedObject:obj];</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nil</span> != value) &#123;</span><br><span class="line">        [<span class="keyword">self</span> addObject:value];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p>åœ¨æ–‡ä»¶ä¸­ä½¿ç”¨ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// retainCount -&gt; 1</span></span><br><span class="line">MZDog *dog = [MZDog new];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;dog: %@&quot;</span>, dog);</span><br><span class="line">    </span><br><span class="line"><span class="built_in">NSMutableArray</span> *array = [<span class="built_in">NSMutableArray</span> arrayWithCapacity:<span class="number">1</span>];</span><br><span class="line"><span class="comment">// å¼±å¼•ç”¨</span></span><br><span class="line">[array mz_weak_addObject:dog];</span><br><span class="line">    </span><br><span class="line"><span class="comment">// æ­¤æ—¶ dog çš„å¼•ç”¨è®¡æ•°è¿˜æ˜¯1</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;dog: %@&quot;</span>, dog);</span><br></pre></td></tr></table></figure><p>ä¾æ¬¡ç±»æ¨ï¼Œå¯¹äºå…¶ä»–é›†åˆç±» <code>NSDictionary</code>ã€<code>NSSet</code> éƒ½å¯ä»¥å®ç°ã€‚å½“ç„¶å®ç°æ–¹å¼ä¸æ­¢è¿™ä¸€ç§ï¼Œè¿™é‡Œåªæ˜¯ä¸¾äº†ä¸€ä¸ª <code>NSValue</code> åŒ…è£…å¯¹è±¡æ¥å®ç°çš„ä¾‹å­ã€‚</p><p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>NSProxy</code> æˆ–è€… <code>block</code> æ¥è§£é™¤å¯¹å¯¹è±¡çš„å¼ºå¼•ç”¨ã€‚å…³äº <code>block</code> çš„è§£é™¤æ–¹æ³•ï¼Œå¯ä»¥å‚è€ƒå¼€æºé¡¹ç›® <a href="https://github.com/Magic-Unique/HXImage/blob/master/Plan%20B/WeakReference.m">HXImage</a>ï¼Œå¦å¤–å¼€æºé¡¹ç›® <a href="https://github.com/ibireme/YYKit/blob/master/YYKit/Utility/YYWeakProxy.m">YYWeakProxy</a> é‡Œé¢ä½¿ç”¨äº† <code>NSProxy</code> æ¥è§£é™¤å¼ºå¼•ç”¨ã€‚</p><p>é‚£ä¹ˆï¼Œé™¤äº†ä¸Šé¢æåˆ°çš„æ–¹æ³•ï¼Œç³»ç»Ÿç±»åº“ä¸­æœ‰æ²¡æœ‰ç°æˆçš„ç±»å‘¢ï¼Ÿèªæ˜çš„ä½ ä¸€å®šçŒœåˆ°äº†ï¼Œä¸€å®šæœ‰ï¼</p><p>æ˜¯çš„ï¼Œå¾€ä¸‹çœ‹ã€‚ã€‚ã€‚</p><h2 id="NSPointerArrayã€NSMapTableã€NSHashTable"><a href="#NSPointerArrayã€NSMapTableã€NSHashTable" class="headerlink" title="NSPointerArrayã€NSMapTableã€NSHashTable"></a>NSPointerArrayã€NSMapTableã€NSHashTable</h2><p>é›†åˆç±» <code>NSArray</code>ã€<code>NSDictionary</code> å’Œ <code>NSSet</code> ä»¥åŠå…¶å¯¹åº”çš„å¯å˜ç‰ˆæœ¬ï¼Œéƒ½å¯ä»¥ç”¨æ¥å­˜å‚¨ OCå¯¹è±¡çš„, ä½†æ˜¯å¯¹å…¶ä¸­çš„å¯¹è±¡éƒ½æ˜¯å¼ºå¼•ç”¨çš„ã€‚</p><p>ä» <code>iOS6.0</code> ç‰ˆæœ¬åŠä»¥åçš„ç‰ˆæœ¬ä¸­ï¼Œç³»ç»Ÿç»™æˆ‘ä»¬æä¾›äº† <code>NSPointerArray</code>ã€<code>NSMapTable</code> å’Œ <code>NSHashTable</code> åˆ†åˆ«å¯¹åº” <code>NSArray</code>ã€<code>NSDictionary</code> å’Œ <code>NSSet</code>ï¼Œæœ€å¤§çš„ä¸åŒå°±æ˜¯ï¼Œ<code>NSPointerArray</code>ã€<code>NSMapTable</code> å’Œ <code>NSHashTable</code> å¯¹å¯¹è±¡æ˜¯å¼±å¼•ç”¨è€Œä¸æ˜¯å¼ºå¼•ç”¨ã€‚</p><blockquote><p>ç°åœ¨å¤§éƒ¨åˆ†çš„ iOS APP æˆ–è€… iOS æ¸¸æˆåº”è¯¥éƒ½è‡³å°‘åœ¨ iOS7 ä»¥ä¸Šäº†å§ï¼Œæ‰€ä»¥å¯ä»¥å°½æƒ…ä½¿ç”¨è¿™äº›ç³»ç»Ÿæä¾›çš„ç±»åº“äº†ã€‚</p></blockquote><p>ä½¿ç”¨ <code>NSPointerArray</code> ä¿å­˜å¼±å¼•ç”¨çš„å¯¹è±¡ï¼Œéœ€è¦ä½¿ç”¨ä¸‹é¢ä¸‰ç§æ–¹å¼æ¥åˆ›å»º <code>NSPointerArray</code> å¯¹è±¡ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»º NSPointerArray å¯¹è±¡æ–¹å¼ä¸€</span></span><br><span class="line"><span class="built_in">NSPointerArray</span> *pointerArray = [<span class="built_in">NSPointerArray</span> weakObjectsPointerArray];</span><br><span class="line">    </span><br><span class="line"><span class="comment">// åˆ›å»º NSPointerArray å¯¹è±¡æ–¹å¼äºŒ</span></span><br><span class="line"><span class="built_in">NSPointerArray</span> *pointerArray1 = [[<span class="built_in">NSPointerArray</span> alloc] initWithOptions:<span class="built_in">NSPointerFunctionsWeakMemory</span>];</span><br><span class="line">    </span><br><span class="line"><span class="comment">// åˆ›å»º NSPointerArray å¯¹è±¡æ–¹å¼ä¸‰</span></span><br><span class="line"><span class="built_in">NSPointerArray</span> *pointerArray2 = [<span class="built_in">NSPointerArray</span> pointerArrayWithOptions:<span class="built_in">NSPointerFunctionsWeakMemory</span>];</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆä¸‹é¢è¿˜æ˜¯ä»¥ <code>MZDog</code> æ¥ä¸¾ä¾‹å­ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// retainCount -&gt; 1</span></span><br><span class="line">MZDog *dog = [MZDog new];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;dog: %@&quot;</span>, dog);</span><br><span class="line">    </span><br><span class="line"><span class="comment">// åˆ›å»º NSPointerArray å¯¹è±¡æ–¹å¼ä¸€</span></span><br><span class="line"><span class="comment">// æ³¨æ„ weakObjectsPointerArray è€Œä¸æ˜¯ strongObjectsPointerArray</span></span><br><span class="line"><span class="built_in">NSPointerArray</span> *pointerArray = [<span class="built_in">NSPointerArray</span> weakObjectsPointerArray];</span><br><span class="line">[pointerArray addPointer:(__bridge <span class="keyword">void</span> *)(dog)];</span><br><span class="line">    </span><br><span class="line"><span class="comment">// åˆ›å»º NSPointerArray å¯¹è±¡æ–¹å¼äºŒ</span></span><br><span class="line"><span class="built_in">NSPointerArray</span> *pointerArray1 = [[<span class="built_in">NSPointerArray</span> alloc] initWithOptions:<span class="built_in">NSPointerFunctionsWeakMemory</span>];</span><br><span class="line">[pointerArray1 addPointer:(__bridge <span class="keyword">void</span> *)(dog)];</span><br><span class="line">    </span><br><span class="line"><span class="comment">// åˆ›å»º NSPointerArray å¯¹è±¡æ–¹å¼ä¸‰</span></span><br><span class="line"><span class="built_in">NSPointerArray</span> *pointerArray2 = [<span class="built_in">NSPointerArray</span> pointerArrayWithOptions:<span class="built_in">NSPointerFunctionsWeakMemory</span>];</span><br><span class="line">[pointerArray2 addPointer:(__bridge <span class="keyword">void</span> *)(dog)];</span><br><span class="line">    </span><br><span class="line"><span class="comment">// dog å¼•ç”¨è®¡æ•°è¿˜æ˜¯1</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;dog: %@&quot;</span>, dog);</span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„è¾“å‡º <code>dog</code> å¯¹è±¡çš„ <code>retainCount</code> ä»ç„¶æ˜¯ 1ï¼Œå…¶å¼•ç”¨è®¡æ•°æ²¡æœ‰å¢åŠ ã€‚</p><p>å¯¹åº” <code>NSMapTable</code> å’Œ <code>NSHashTable</code> çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><p><strong>NSMapTable ç¤ºä¾‹</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// retainCount -&gt; 1</span></span><br><span class="line">MZDog *dog = [MZDog new];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;dog: %@&quot;</span>, dog);</span><br><span class="line">    </span><br><span class="line"><span class="comment">// å¼±åº”ç”¨å¯¹è±¡</span></span><br><span class="line"><span class="built_in">NSMapTable</span> *map = [<span class="built_in">NSMapTable</span> weakToWeakObjectsMapTable];</span><br><span class="line">[map setObject:dog forKey:<span class="string">@&quot;first&quot;</span>];</span><br><span class="line">    </span><br><span class="line"><span class="comment">// å¼•ç”¨è®¡æ•°è¿˜æ˜¯1ï¼Œæ²¡å˜</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;dog: %@&quot;</span>, dog);</span><br></pre></td></tr></table></figure><p><strong>NSHashTable ç¤ºä¾‹</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// retainCount -&gt; 1</span></span><br><span class="line">MZDog *dog = [MZDog new];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;dog: %@&quot;</span>, dog);</span><br><span class="line">    </span><br><span class="line"><span class="comment">// å¼±åº”ç”¨å¯¹è±¡</span></span><br><span class="line"><span class="built_in">NSHashTable</span> *hashTable = [<span class="built_in">NSHashTable</span> weakObjectsHashTable];</span><br><span class="line">[hashTable addObject:dog];</span><br><span class="line">    </span><br><span class="line"><span class="comment">// å¼•ç”¨è®¡æ•°è¿˜æ˜¯1ï¼Œæ²¡å˜</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;dog: %@&quot;</span>, dog);</span><br></pre></td></tr></table></figure><h2 id="NSPointerArray-ä¸-NULL"><a href="#NSPointerArray-ä¸-NULL" class="headerlink" title="NSPointerArray ä¸ NULL"></a>NSPointerArray ä¸ NULL</h2><p>åœ¨ <code>NSMutableArray</code> ä¸­æ·»åŠ çš„å¯¹è±¡ä¸å¯ä»¥æ˜¯ <code>nil</code>ï¼Œè€Œ <code>NSPointerArray</code> ä¸­å´å¯å­˜å‚¨ <code>NULL</code>(nil ç»è¿‡è½¬æ¢å¾—åˆ°CæŒ‡é’ˆä¸º NULL)ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å­˜å‚¨weakå¯¹è±¡ã€‚weakç±»å‹çš„å¯¹è±¡é‡Šæ”¾ä¹‹åï¼Œ<code>NSPointerArray</code> çš„å¯¹åº”ä½ç½®ä¼šè‡ªåŠ¨å˜æˆ <code>NULL</code>ï¼Œä½¿ç”¨<code>count</code> å±æ€§, ä¼šå°† <code>NULL</code> å…ƒç´ ä¹Ÿè®¡ç®—è¿›æ¥ï¼Œå³ NULL ç®—æ˜¯å®ƒçš„ä¸€å‘˜ã€‚ä¸‹é¢ç¤ºä¾‹å¯ä»¥è¯æ˜ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">MZDog *dog = <span class="literal">nil</span>;</span><br><span class="line">        </span><br><span class="line"><span class="built_in">NSPointerArray</span> *pointerArray = [<span class="built_in">NSPointerArray</span> weakObjectsPointerArray];</span><br><span class="line"><span class="keyword">void</span> *cobj = (__bridge <span class="keyword">void</span> *)(dog);</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;obj: %@&quot;</span>, cobj); <span class="comment">//NULL</span></span><br><span class="line">[pointerArray addPointer:cobj];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è™½ç„¶å­˜å‚¨çš„æ˜¯ NULLï¼Œä½†æ˜¯ count ä»ç„¶æ˜¯ 1</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;pointerArray count: %zd&quot;</span>, [pointerArray count]);</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSArray</span> *array = [pointerArray allObjects];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;pointerArray allObjects: %@&quot;</span>, array);</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬è¿™æ ·åˆ é™¤ <code>NSPointerArray</code> ä¸­çš„ <code>NULL</code> å…ƒç´ ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[pointerArray addPointer:<span class="literal">NULL</span>];</span><br><span class="line">[pointerArray compact];</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¦æ³¨æ„ï¼Œå°†OCå¯¹è±¡è½¬æ¢ä¸ºCæŒ‡é’ˆè¦ä½¿ç”¨ <code>(__bridge void *)</code> è¿™ç§æ–¹å¼ï¼Œä¸è¦ä½¿ç”¨ <code>(__bridge_retained void *)</code> æˆ–è€… <code>CFBridgingRetain</code>ï¼Œè¿™äºŒè€…ä¼šå¯¹ <code>dog</code> å¯¹è±¡è¿›è¡Œå¼ºå¼•ç”¨ã€‚å¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// retainCount -&gt; 1</span></span><br><span class="line">MZDog *dog = [MZDog new];</span><br><span class="line"><span class="built_in">NSPointerArray</span> *pointerArray = [<span class="built_in">NSPointerArray</span> weakObjectsPointerArray];</span><br><span class="line"><span class="comment">// è¿™é‡Œä¼š retain dog å¯¹è±¡ï¼Œä½¿å…¶å¼•ç”¨è®¡æ•°åŠ 1ï¼Œæ­¤æ—¶retainCount æ˜¯ 2</span></span><br><span class="line">[pointerArray addPointer:(__bridge_retained <span class="keyword">void</span> *)dog];</span><br><span class="line"><span class="comment">// è¿™é‡Œä¼š retain dog å¯¹è±¡ï¼Œä½¿å…¶å¼•ç”¨è®¡æ•°å†åŠ 1ï¼ŒretainCount æ˜¯ 3</span></span><br><span class="line">[pointerArray addPointer:<span class="built_in">CFBridgingRetain</span>(dog)];</span><br><span class="line">    </span><br><span class="line"><span class="comment">// æ­¤æ—¶çš„ retainCount æ˜¯ 3</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;dog: %@&quot;</span>, dog);</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ å¯¹ <code>(__bridge_retained void *)</code> æˆ–è€… <code>CFBridgingRetain</code> æ„Ÿå…´è¶£ï¼Œå¯ä»¥çœ‹çœ‹ <a href="http://www.veryitman.com/2018/03/07/C-%E6%8C%87%E9%92%88%E4%B8%8E-OC-%E5%AF%B9%E8%B1%A1%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2/">C æŒ‡é’ˆä¸ OC å¯¹è±¡ä¹‹é—´çš„è½¬æ¢</a> è¿™ç¯‡æ–‡ç« ã€‚</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> weak strong NSPointerArray </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2018ï¼Œä¸ä¼šé‡æ¥</title>
      <link href="/2018/12/31/2018%EF%BC%8C%E4%B8%8D%E4%BC%9A%E9%87%8D%E6%9D%A5/"/>
      <url>/2018/12/31/2018%EF%BC%8C%E4%B8%8D%E4%BC%9A%E9%87%8D%E6%9D%A5/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©æ˜¯2018å¹´çš„æœ€åä¸€å¤©ï¼Œå³2018å¹´12æœˆ31æ—¥ã€‚æå‰ç¥æ„¿æ‰€æœ‰äºº2019èº«ä½“å¥åº·ï¼Œä¸‡äº‹å¦‚æ„ï¼Œé˜–å®¶å¹¸ç¦ï¼</p><p>è¿™ç¯‡æ–‡ç«  <a href="http://www.veryitman.com/2016/12/31/%E5%86%8D%E8%A7%81-2016/">å†è§ 2016</a> æ˜¯åœ¨2016å¹´æœ«å†™çš„ï¼Œç®—æ˜¯ä¸€ä¸ªhinéšå¿ƒçš„å°ç»“ã€‚æ¯”è¾ƒé—æ†¾çš„æ˜¯åœ¨2017å¹´æ²¡æœ‰ç»™è‡ªå·±å†™ä¸ªæ€»ç»“ï¼Œæ‰€ä»¥ï¼Œä¸èƒ½å†é”™è¿‡2018äº†ï¼Œæˆ‘æ€•è€äº†æ²¡æœ‰å¯ä»¥å¯»è¿¹çš„å›å¿†ï¼</p><p>2018 æœ‰å¤ªå¤šéœ€è¦æ„Ÿè°¢çš„äººäº†ï¼Œæ„Ÿè°¢æ‰€æœ‰å·¥ä½œä¸Šï¼Œç”Ÿæ´»ä¸Šå…³å¿ƒã€æ”¯æŒå’Œé¼“åŠ±æˆ‘çš„äººä»¬ï¼Œæ„Ÿè°¢æˆ‘çš„å®¶äººç»™äºˆäº†æˆ‘å¤ªå¤šçš„ç†è§£å’ŒåŒ…å®¹ï¼Œéå¸¸æ„Ÿè°¢ä½ ä»¬ï¼</p><h2 id="å·¥ä½œ"><a href="#å·¥ä½œ" class="headerlink" title="å·¥ä½œ"></a>å·¥ä½œ</h2><p>2018å¹´æˆ‘çš„èŒä¸šæ²¡æœ‰å¤ªå¤§çš„å˜åŒ–ï¼Œä»ç„¶æ˜¯å¥‹æ–—åœ¨ä¸€çº¿å·¥ä½œå²—ä½ä¸Šçš„ä¸€åè½¯ä»¶å·¥ç¨‹å¸ˆï¼Œæˆ‘å–œæ¬¢è¿™ä»½èŒä¸šï¼Œå®ƒæ²¡æœ‰è¿‡å¤šçš„çº·äº‰ï¼Œå·¥ç¨‹å¸ˆä¹‹é—´çš„æ²Ÿé€šç®€å•ã€ç›´æ¥ï¼</p><p>å”¯ä¸€å’Œä»¥å‰ä¸åŒçš„æ˜¯è‡ªå·±å¼€å§‹è´Ÿè´£ä¸€ä¸ªå›¢é˜Ÿäº†ï¼Œè´£ä»»æ¯”ä»¥å‰è¦å¤§äº†å¾ˆå¤šï¼Œå‹åŠ›ä¹Ÿéšä¹‹å‰§å¢ã€‚æ…¢æ…¢åœ°ï¼Œå†™ä»£ç å˜æˆäº†å¯æœ›ä¸å¯æ±‚çš„äº‹æƒ…äº†ï¼Œå› ä¸ºä½ è¦å¤„ç†æ¯”å†™ä»£ç æ›´é‡è¦çš„äº‹æƒ…ï¼Œæ¯”å¦‚å›¢é˜Ÿçš„ç£¨åˆï¼Œç›®æ ‡çš„åˆ¶å®šï¼Œä»»åŠ¡çš„è§„åˆ’ç­‰ç­‰ä¸€ç³»åˆ—å·¥ä½œã€‚</p><p>åœ¨ <code>ã€Šèš‚èšé‡‘æœï¼šç§‘æŠ€é‡‘èç‹¬è§’å…½çš„å´›èµ·ã€‹</code> è¿™æœ¬ä¹¦é‡Œè®²åˆ°è¿‡ï¼š</p><blockquote><p>ä½œä¸ºé¢†å¯¼ï¼Œå›¢é˜Ÿé‡Œæ¯ä¸€ä¸ªäººçš„é”™è¯¯éƒ½æ˜¯è‡ªå·±çš„é”™è¯¯ï¼Œä½†å›¢é˜Ÿé‡Œæ¯ä¸€ä¸ªäººçš„æˆæœæœªå¿…æ˜¯è‡ªå·±çš„æˆæœï¼Œè¿™æ—¶æ•´ä¸ªäººçš„å¿ƒæ€å°±éœ€è¦é‡æ–°è°ƒæ•´ã€‚</p></blockquote><p>æˆ‘ç®—æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¹¸è¿çš„äººï¼Œå› ä¸ºå›¢é˜Ÿä¸­æœ‰å¾ˆå¤šæ¯”è‡ªå·±æ›´ä¼˜ç§€çš„äººï¼Œä»–ä»¬æœ‰æƒ³æ³•ï¼Œæœ‰æ‰§è¡Œï¼Œæ€»æ˜¯èƒ½å¸¦åŠ¨å…¶ä»–äººç§¯æçš„å·¥ä½œã€‚è¿™äº›äººæ˜¯å›¢é˜Ÿå­¦ä¹ çš„æ¦œæ ·ï¼Œæ›´æ˜¯æˆ‘ä»¬å›¢é˜Ÿçš„è´¢å¯Œã€‚</p><p>å…¬å¸åœ¨æ”¹å˜ï¼Œå„ä¸ªæ–¹é¢ä¹Ÿè¶Šæ¥è¶Šæˆç†Ÿï¼Œæ— è®ºæ˜¯å…¬å¸æ–‡åŒ–è¿˜æ˜¯æŠ€æœ¯èƒ½åŠ›éƒ½åœ¨æ­¥æ­¥é«˜å‡ï¼Œä»Šå¹´å°¤ä¸ºçœ‹åˆ°çš„æ˜¯ CTO å¯¹æŠ€æœ¯ä¸­å°ä¸‹å®šçš„ä¸€äº›å†³å¿ƒï¼Œè¿™æ˜¯è®©äººå…´å¥‹çš„ã€‚å…¬å¸ä¸€ç›´åœ¨å¼ºè°ƒèµ‹èƒ½ï¼ŒæŠŠæ›´å¤šä¼˜ç§€ã€æœ‰æ‹…å½“ã€æœ‰è´£ä»»å¿ƒçš„äººææ‹”ä¸Šæ¥ï¼Œç»™ä»–ä»¬é…å¤‡èµ„æºï¼Œä»¥ä¾¿å‘æŒ¥ä»–ä»¬æ›´å¤§çš„æ½œèƒ½ï¼Œå¤§å®¶å·¥ä½œçš„çƒ­æƒ…ä¹Ÿæ›´ä¸Šä¸€å±‚æ¥¼ï¼Œå› ä¸ºå…¬å¸ç›¸ä¿¡ä»–ä»¬ã€‚</p><p>å¾ˆå¤šæ—¶å€™ï¼Œå¹¶ä¸æ˜¯ä½ èº«è¾¹æ²¡æœ‰ä¼˜ç§€çš„äººï¼Œåªæ˜¯ä½ ä¸æ„¿æ„ç›¸ä¿¡ä»–ä»¬ï¼Œå‰æ€•ç‹¼åæ€•è™çš„å¿ƒæ€é˜»æ­¢äº†è¿™äº›ä¼˜ç§€äººçš„å‘æŒ¥ã€‚å…¶å®ï¼Œä»–ä»¬åªæ˜¯éœ€è¦ä½ ä¸€ä¸ªè‚¯å®šçš„ç­”å¤ï¼Œæ‰€ä»¥è¯•ç€å»æ”¹å˜è‡ªå·±ï¼Œç›¸ä¿¡å›¢é˜Ÿé‡Œé¢çš„æ¯ä¸ªäººï¼Œç»™ä»–ä»¬æ›´å¤šçš„è‚¯å®šï¼Œé¼“åŠ±å’Œæ”¯æŒä»–ä»¬ï¼Œç»“æœä¸ä¼šè®©ä½ å¤±æœ›çš„ã€‚</p><h2 id="ç”Ÿæ´»"><a href="#ç”Ÿæ´»" class="headerlink" title="ç”Ÿæ´»"></a>ç”Ÿæ´»</h2><p>è‡ªä»è€å©†å­©å­å›è€å®¶ä¹‹åï¼Œæˆ‘å°±è¿‡ä¸Šäº†â€œå•èº«â€œçš„ç”Ÿæ´»ï¼Œæ¯å¤©æ—©å‡ºæ™šå½’ï¼ŒåŠªåŠ›ç”¨å·¥ä½œæ¥ä»£æ›¿å¯¹ä»–ä»¬çš„æ€å¿µã€‚</p><p>æˆ‘å®¶çš„å¤§å®æ˜¯ä¸ªå¤©ç”Ÿçš„è¿åŠ¨ç‹‚ï¼Œæ„Ÿè§‰ä»–æ€»æ˜¯æœ‰ç”¨ä¸å®Œçš„åŠ›æ°”ï¼Œé™¤éä»–è‡ªå·±åœ¨æ‹¼å›¾æˆ–è€…ç”»ç”»ï¼Œå¦åˆ™ä½ ç”­æƒ³æ¸…é™ã€‚ä¸€ä¼šåœ¨å®¶é‡Œç©¿ä¸Šæºœå†°é‹ç»™ä½ è¡¨æ¼”å„ç§æºœå†°æŠ€èƒ½ï¼Œä¸€ä¼šæ‹¿èµ·ç¯®çƒç»™ä½ è¡¨æ¼”çƒæŠ€ï¼Œå†ä¸æ˜¯å°±è®©ä½ é™ªä»–ç©è·³æ£‹ã€‚</p><p>è€å©†å¤§äººåœ¨å®¶å¾…äº§äº†ï¼Œè‡ªå·±ä¸€ä¸ªäººæŒºç€è‚šå­è¿˜è¦ç»™å¤§å®åšé¥­ï¼Œæ¯å¤©æ¥é€ä»–å»å­¦æ ¡ï¼ŒçŸ¥é“å¥¹ä¸€ä¸ªäººåœ¨å®¶ä¸å®¹æ˜“ï¼Œæˆ‘ä¹Ÿç»å¸¸é¼“åŠ±å¥¹ï¼Œå¥¹è¯´ï¼šâ€œä¸ºäº†å­©å­ï¼Œè¿™ç‚¹è‹¦ä¸ç®—ä»€ä¹ˆï¼â€ã€‚æœ‰æ—¶å€™ï¼Œæƒ³ä¸€æƒ³äºŒå®å¿«è¦è·Ÿæˆ‘ä»¬è§é¢äº†ï¼ŒæŒºå…´å¥‹çš„ã€‚</p><p>æœ‰æ—¶å€™æŒºæƒ³å¿µä»–ä»¬å¨˜ä¿©çš„ï¼Œå·¥ä½œä¸å¿™çš„æ—¶å€™æˆ‘ä¹Ÿä¼šè¯·å‡å›è€å®¶ï¼Œè®°å¾—ä¸Šæ¬¡å›å»ç¦»å¼€çš„æ—¶å€™ï¼Œå„¿å­é—®äº†æˆ‘ä¸€ä¸ªé—®é¢˜ï¼Œä»–è¯´ï¼šâ€œçˆ¸çˆ¸ï¼Œä½ è¯´æ˜¯é’±é‡è¦ï¼Œè¿˜æ˜¯äººé‡è¦ï¼Ÿâ€ï¼Œæˆ‘å½“æ—¶æ„£äº†ä¸€ä¸‹ï¼Œå‘Šè¯‰ä»–ï¼šâ€œå½“ç„¶æ˜¯äººé‡è¦å‘€ï¼â€ï¼Œä»–ä¸å¼€å¿ƒçš„ç‚¹äº†ç‚¹å¤´ã€‚æ˜¾ç„¶ï¼Œè¿™å®¶ä¼™å¯¹æˆ‘çš„ç¦»å¼€å¾ˆä¸æ»¡æ„ï¼Œé‚£å¤©æ™šä¸Šæˆ‘èµ¶ç«è½¦èµ°çš„æ—¶å€™ï¼Œå¤§å®åœ¨è¢«çªé‡Œå“­äº†å¾ˆä¹…ï¼Œå…¶å®ï¼Œæˆ‘ä¹Ÿæµæ³ªäº†ï¼Œåªæ˜¯ä¸æ„¿æ„æ‰¿è®¤ç½¢äº†ï¼</p><p>ä½ è‡ªå·±é™¤äº†æ˜¯ä¸€åå‘˜å·¥ä¹‹å¤–ï¼Œè¿˜æ˜¯ä¸€åå„¿å­ã€å¥³å„¿ï¼Œæˆ–è€…æ˜¯ä¸€åçˆ¶äº²ã€æ¯äº²ï¼Œä¸€åä¸ˆå¤«ã€å¦»å­ï¼Œåªæœ‰å¤„ç†å¥½ç”Ÿæ´»ä¸Šé¢çš„äº‹æƒ…ï¼Œæ‰èƒ½æ›´å¥½çš„æŠ•å…¥åˆ°å·¥ä½œå½“ä¸­æ¥ã€‚æ— è®ºå¦‚ä½•ï¼Œäººè¿˜æ˜¯éœ€è¦æœ‰æ¢¦æƒ³çš„ï¼æˆ‘çš„æ¢¦æƒ³å°±æ˜¯åŠªåŠ›å­¦ä¹ æ›´å¤šæœ‰ç”¨çš„çŸ¥è¯†ï¼Œç„¶åç”¨è‡ªå·±çš„çŸ¥è¯†å»æ•™è‚²è‡ªå·±çš„å­å¥³ï¼Œè®©ä»–ä»¬å°†æ¥èƒ½æœ‰æ›´å¥½çš„ç”Ÿæ´»ï¼Œåšä¸€ä¸ªæœ‰ç”¨çš„ç¤¾ä¼šäººã€‚</p><p>ç”¨ç”µå½±ã€Šä¸­å›½åˆä¼™äººã€‹æˆä¸œé’çš„ä¸€å¥è¯æ¥è¯´ï¼šâ€œæ¢¦æƒ³æ˜¯ä»€ä¹ˆï¼Œæ¢¦æƒ³å°±æ˜¯ä¸€ç§è®©ä½ æ„Ÿåˆ°åšæŒå°±æ˜¯å¹¸ç¦çš„ä¸œè¥¿ï¼â€ã€‚</p><h2 id="é˜…è¯»"><a href="#é˜…è¯»" class="headerlink" title="é˜…è¯»"></a>é˜…è¯»</h2><p>è¿™äº›å¹´ï¼Œè‡ªå·±å”¯ä¸€æ²¡æœ‰ä¸¢å¼ƒçš„çˆ±å¥½å°±æ˜¯é˜…è¯»ã€‚</p><p>å·¥ä½œä¸Šçš„å¿™ç¢Œï¼Œç”Ÿæ´»ä¸Šçš„ç–²æƒ«ï¼Œå¾ˆå¤šæ—¶å€™è®©æˆ‘ä»¬æ— æ³•é™ä¸‹å¿ƒæ¥å»é˜…è¯»ï¼Œç”šè‡³æœ‰æ—¶å€™ä¼šè§‰å¾—é˜…è¯»ç®€ç›´åœ¨æµªè´¹æ—¶é—´ï¼Œæµªè´¹ç”Ÿå‘½ã€‚å¦‚æœä½ æœ‰è¿™ç§æƒ³æ³•ï¼Œå»ºè®®ä½ è¯·å‡å»å¥½å¥½ä¼‘æ¯å‡ å¤©ï¼ŒæŠ›å¼€å–§åš£çš„å°˜ä¸–ï¼Œæ”¾ç©ºä¸€ä¸‹è‡ªå·±ã€‚</p><p>æˆ‘ä¸€ç›´åšæŒé˜…è¯»ï¼Œæ— è®ºæ˜¯æŠ€æœ¯ä¹¦ç±è¿˜æ˜¯äººæ–‡å†å²ï¼ŒæŠ‘æˆ–äººç‰©ä¼ è®°ï¼Œå¹³æ—¶å·¥ä½œä¹Ÿå¾ˆå¿™ï¼Œæˆ‘å°±åˆ©ç”¨é›¶æ•£çš„æ—¶é—´æ¥é˜…è¯»ï¼Œå°±ç®—è¿™æ ·ï¼Œæ¯å‘¨æ¯ä¸ªæœˆç´¯è®¡ä¸‹æ¥é˜…è¯»é‡ä¹Ÿä¸å°‘äº†ï¼Œéšç€é˜…è¯»é‡çš„å¢å¤šï¼Œæ„Ÿè§‰è‡ªå·±çš„æ°”è‰²å¥½äº†å¾ˆå¤šï¼Œå› ä¸ºå¿ƒæ€å¥½äº†ï¼Œé‡äº‹æ¯”ä»¥å‰æ›´åŠ æ²‰ç€å†·é™äº†ï¼Œä¹Ÿæ›´åŠ ç†æ€§äº†ã€‚</p><blockquote><p>æ‚¨çš„æ°”è´¨é‡Œè—ç€ä½ è¯»è¿‡çš„é‚£äº›ä¹¦ã€‚</p></blockquote><p>ä»Šå¹´è¯»åˆ°è‡ªè®¤ä¸ºä¸é”™çš„ä¹¦ç±ï¼Œæ¨èç»™å¤§å®¶ï¼š</p><p><strong>1. èš‚èšé‡‘æœï¼šç§‘æŠ€é‡‘èç‹¬è§’å…½çš„å´›èµ·</strong><br><img src="/upload/images/2018/12/31/1.jpg"></p><p><strong>2. èµ‹èƒ½ï¼šæ‰“é€ åº”å¯¹ä¸ç¡®å®šæ€§çš„æ•æ·å›¢é˜Ÿ</strong><br><img src="/upload/images/2018/12/31/2.jpg"></p><p><strong>3. æˆ‘çš„æƒ…ç»ªä¸ºä½•æ€»è¢«ä»–äººå·¦å³</strong><br><img src="/upload/images/2018/12/31/3.jpg"></p><p><strong>4. ç»ˆèº«æˆé•¿</strong><br><img src="/upload/images/2018/12/31/4.jpg"></p><h2 id="2019"><a href="#2019" class="headerlink" title="2019"></a>2019</h2><p><strong>1. åŠ å¼ºå¯¹ä¸Šæ²Ÿé€š</strong></p><p>æ²Ÿé€šä¸èƒ½ä»…é™äºå¯¹ä¸‹æ²Ÿé€šï¼Œå¯¹ä¸Šæ²Ÿé€šå°¤ä¸ºé‡è¦ï¼Œè®©ä¸Šçº§çŸ¥é“ç›®å‰é¡¹ç›®çš„è¿›åº¦å’Œè§„åˆ’ï¼Œä»¥åŠé‡åˆ°çš„é—®é¢˜ã€‚è¿™ä¸€ç‚¹è‡ªå·±åšçš„è¿˜ä¸å¤Ÿå¥½ï¼Œåœ¨2019å¹´è¦åŠ å¼ºã€‚</p><p><strong>2. åŠ å¼ºè‡ªæˆ‘ç®¡ç†</strong></p><p>ç®¡ç†ï¼Œä¸æ˜¯ç®¡ç†åˆ«äººï¼Œè€Œæ˜¯è¦ç®¡ç†å¥½è‡ªå·±ï¼Œæ²¡æœ‰äººæ„¿æ„è¢«ç®¡ç†ï¼Œå¦‚æœæœ‰éœ€è¦è¢«ä¸¥æ ¼ç®¡ç†çš„ï¼Œä»–å¯èƒ½ä¸é€‚åˆåœ¨ä½ çš„å›¢é˜Ÿä¸­ç”Ÿå­˜ã€‚åŠ å¼ºè‡ªæˆ‘ç®¡ç†æ˜¯æˆ‘ä»¬æ¯ä¸ªäººçš„ç›®æ ‡ã€‚</p><p><strong>3. ä¸ªäººã€å›¢é˜ŸæŠ€æœ¯èƒ½åŠ›å†ä¸Šä¸€å±‚æ¥¼</strong></p><p>è¡¥é½è‡ªå·±çš„çŸ­æ¿ï¼Œæƒ³å°½ä¸€åˆ‡åŠæ³•æé«˜è‡ªå·±å’Œå›¢é˜Ÿå…¶ä»–æŠ€æœ¯äººå‘˜çš„æŠ€æœ¯èƒ½åŠ›ï¼Œåœ¨ç¨³å®šã€é«˜æ•ˆçš„åŒæ—¶å¯»æ‰¾æ›´å¤šè‡ªæˆ‘æˆé•¿çš„é€”å¾„å’Œæ–¹æ³•ã€‚</p><p><strong>4.æ›´åŠ å…³å¿ƒè‡ªå·±çš„å®¶äººå’Œèº«è¾¹çš„æœ‹å‹</strong></p><p>æ²¡æœ‰å®¶äººçš„æ”¯æŒå’Œé¼“åŠ±ï¼Œä½ å¾ˆéš¾å»æŠ•å…¥å·¥ä½œï¼Œæ‰€ä»¥è¦å¥½å¥½çš„å¯¹å¾…è‡ªå·±çš„å®¶äººï¼Œå¤šå…³å¿ƒä»–ä»¬ï¼Œå®¶äººå¯¹ä½ çš„è¦æ±‚ä¸å¤šï¼Œå¾€å¾€åªéœ€è¦çŸ¥é“ä½ æœ‰æ²¡æœ‰æƒ¦è®°ä»–ä»¬å°±å¤Ÿäº†ã€‚å½“ç„¶äº†ï¼Œæˆ‘å¾ˆæœŸå¾…å’Œæˆ‘ä»¬å®¶çš„äºŒå®è§é¢ï¼Œå˜¿å˜¿ğŸ˜œï¼</p><p>æœ‹å‹å¤šäº†ï¼Œè·¯æ‰å¥½èµ°ï¼Œè®°å¾—è·Ÿæœ‹å‹å¤šèŠå¤©ï¼Œå¤šå¬å¬ä»–ä»¬çš„æ•…äº‹ï¼Œæœ€é‡è¦çš„æ˜¯ç»å¸¸çº¦ä»–ä»¬å–å–é…’ã€‚</p><hr><p>æœ€ååˆ†äº«ç»™å¤§å®¶ä¸€å¥è¯ï¼Œå…±å‹‰ï¼š</p><blockquote><p>ä½ çš„ç›®çš„ä¸æ˜¯ç»™è°æ‰“å·¥ï¼Œè€Œæ˜¯æˆä¸ºæ›´å¥½çš„è‡ªå·±ï¼Œå»ºè®¾æ›´å¥½çš„æœªæ¥ï¼æ‰€ä»¥å°½å¿«å»è°ƒæ•´å¿ƒæ€ï¼Œåœæ­¢æŠ±æ€¨ï¼Œç«‹å³è¡ŒåŠ¨ï¼Œç§¯ææ²Ÿé€šï¼</p></blockquote><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éšç¬” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NSStringã€NSMutableString å¯å˜ä¸ä¸å¯å˜çš„é‚£äº›äº‹å„¿</title>
      <link href="/2018/12/30/NSString%E3%80%81NSMutableString-%E5%8F%AF%E5%8F%98%E4%B8%8E%E4%B8%8D%E5%8F%AF%E5%8F%98%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/"/>
      <url>/2018/12/30/NSString%E3%80%81NSMutableString-%E5%8F%AF%E5%8F%98%E4%B8%8E%E4%B8%8D%E5%8F%AF%E5%8F%98%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>è¿™ç¯‡æ–‡ç« çš„ä¸»è¦åŒ…å«å¦‚ä¸‹å†…å®¹ï¼š</p><ul><li>å¯å˜å¯¹è±¡å’Œä¸å¯å˜å¯¹è±¡</li><li>NSString çš„ copy å’Œ mutableCopy</li><li>NSMutableString çš„ copy å’Œ mutableCopy</li><li>property ä¸­ copyã€strong ä¿®é¥° NSString</li><li>property ä¸­ copyã€strong ä¿®é¥° NSMutableString</li></ul><p>å¾ˆå¤š iOS å¼€å‘çš„æœ‹å‹ä¼šäº‰è®ºä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ç”¨ <code>copy</code> å’Œ <code>strong</code> æ¥ä¿®é¥° <code>NSString</code> å¯¹è±¡éƒ½æ˜¯ä¸€æ ·çš„æ•ˆæœï¼Œåœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œè¿™äºŒè€…ç¡®å®æ˜¯æ²¡æœ‰åŒºåˆ«ï¼Œä½†æ˜¯åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ï¼ŒäºŒè€…æˆªç„¶ä¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»ææ¸…æ¥šé‡Œé¢çš„é“é“ã€‚</p><p>æˆ‘å·²ç»å°½åŠ›ç®€åŒ–äº†è¿™ç¯‡æ–‡ç« çš„å†…å®¹äº†ï¼Œä½†ä¾ç„¶éœ€è¦ä½ èŠ±ä¸ª15åˆ†é’Ÿå·¦å³çš„æ—¶é—´ï¼Œæ‰€ä»¥å½“ä½ å¿ƒæƒ…ä¸é”™åˆæ²¡æœ‰å…¶ä»–äº‹æƒ…çš„æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥æ¥é˜…è¯»äº†ã€‚</p><h2 id="å¯å˜å¯¹è±¡å’Œä¸å¯å˜å¯¹è±¡"><a href="#å¯å˜å¯¹è±¡å’Œä¸å¯å˜å¯¹è±¡" class="headerlink" title="å¯å˜å¯¹è±¡å’Œä¸å¯å˜å¯¹è±¡"></a>å¯å˜å¯¹è±¡å’Œä¸å¯å˜å¯¹è±¡</h2><p>åœ¨ <code>Objective-C</code> ä¸­æœ€å¸¸ç”¨æ¥å¤„ç†å­—ç¬¦ä¸²çš„æ˜¯ <code>NSString</code> ä¸ <code>NSMutableString</code> è¿™ä¸¤ä¸ªç±»ï¼Œ<code>NSString</code> è¢«åˆ›å»ºèµ‹å€¼åå­—ç¬¦ä¸²çš„å†…å®¹ä¸é•¿åº¦ä¸èƒ½å†åšåŠ¨æ€çš„ä¿®æ”¹ï¼Œé™¤éé‡æ–°ç»™è¿™ä¸ªå­—ç¬¦ä¸²èµ‹å€¼ã€‚è€Œ <code>NSMutableString</code> è¢«åˆ›å»ºèµ‹å€¼åå¯ä»¥åŠ¨æ€çš„ä¿®æ”¹å­—ç¬¦ä¸²çš„å†…å®¹ã€‚</p><p>é‚£ä¹ˆç®€å•æ¥è¯´ï¼Œå¯å˜å¯¹è±¡æ˜¯æŒ‡ï¼Œå¯¹è±¡çš„å†…å®¹æ˜¯å¯å˜çš„ï¼Œä¾‹å¦‚ <code>NSMutableString</code> å¯¹è±¡ã€‚ä¸å¯å˜çš„å¯¹è±¡åˆ™ç›¸åï¼Œè¡¨ç¤ºå…¶å†…å®¹ä¸å¯å˜ï¼Œä¾‹å¦‚ <code>NSString</code> å¯¹è±¡ã€‚</p><p>å¯å˜ä¸ä¸å¯å˜æ˜¯é’ˆå¯¹å¯¹è±¡æ¥è¯´çš„ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œè¦æ ¹æ®å®é™…çš„ä¸šåŠ¡åœºæ™¯æ¥é€‰æ‹©ä½¿ç”¨å¯å˜è¿˜æ˜¯ä¸å¯å˜å¯¹è±¡ã€‚ä»Šå¤©æˆ‘ä»¬åªè®¨è®º <code>Objective-C</code> ä¸­ <code>NSString</code> ä¸ <code>NSMutableString</code> è¿™ä¸¤ä¸ªç±»ï¼Œå…³äºå…¶ä»–é›†åˆç±»çš„å¯å˜ä¸ä¸å¯å˜ç‰¹æ€§ï¼Œåé¢ä¸“é—¨å†æ¥å†™æ–‡ç« åˆ†äº«ã€‚</p><h2 id="NSString-çš„-copy-å’Œ-mutableCopy"><a href="#NSString-çš„-copy-å’Œ-mutableCopy" class="headerlink" title="NSString çš„ copy å’Œ mutableCopy"></a>NSString çš„ copy å’Œ mutableCopy</h2><p>åœ¨ <code>NSString.h</code> ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSString</span> : <span class="title">NSObject</span> &lt;<span class="title">NSCopying</span>, <span class="title">NSMutableCopying</span>, <span class="title">NSSecureCoding</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>NSString.h</code> æœ¬èº«å®ç°äº† <code>NSCopying</code>, <code>NSMutableCopying</code> è¿™ä¸¤ä¸ªåè®®ï¼Œåè®®çš„å®šä¹‰å¦‚ä¸‹å†…å®¹æ‰€ç¤ºï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">NSCopying</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)copyWithZone:(<span class="keyword">nullable</span> <span class="built_in">NSZone</span> *)zone;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">NSMutableCopying</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)mutableCopyWithZone:(<span class="keyword">nullable</span> <span class="built_in">NSZone</span> *)zone;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é’ˆå¯¹ <code>NSString</code> å¯¹è±¡è¿›è¡Œ <code>copy</code> å’Œ <code>mutableCopy</code> çš„æ“ä½œï¼Œå¦¥å¦¥çš„ã€‚</p><p>ä¸¾ä¸€ä¸ªç®€å•çš„æ —å­ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *name = <span class="string">@&quot;www.&quot;</span>;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;name addr: %p, name content: %@&quot;</span>, name, name);</span><br><span class="line">    </span><br><span class="line"><span class="built_in">NSString</span> *name1 = name;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;name1 addr: %p, name1 content: %@&quot;</span>, name1, name1);</span><br><span class="line">    </span><br><span class="line"><span class="built_in">NSString</span> *name2 = [name <span class="keyword">copy</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;name2 addr: %p, name2 content: %@&quot;</span>, name2, name2);</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">name  addr: <span class="number">0x10090ecf8</span>, name  content: www.</span><br><span class="line">name1 addr: <span class="number">0x10090ecf8</span>, name1 content: www.</span><br><span class="line">name2 addr: <span class="number">0x10090ecf8</span>, name2 content: www.</span><br></pre></td></tr></table></figure><p>ä»è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼Œä¸‰ä¸ªå¯¹è±¡çš„å†…å®¹å’Œåœ°å€éƒ½æ˜¯ä¸€æ ·çš„ï¼Œç»è¿‡ <code>name</code> å¯¹è±¡ <code>copy</code> åçš„ <code>name2</code> ä¸ <code>name</code> è¿˜æ˜¯æŒ‡å‘åŒä¸€å—å†…å­˜åœ°å€ã€‚</p><p>åœ¨æ–­ç‚¹è¿‡ç¨‹ä¸­ï¼Œå‘ç°æ— è®ºæ˜¯ <code>name</code> è¿˜æ˜¯ <code>name1</code>ã€<code>name2</code> å¯¹è±¡ï¼Œå…¶éƒ½æ˜¯ <code>ConstantString</code>ï¼Œè¡¨æ˜ä¸‰è€…éƒ½æ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/12/30/1.jpg"></p><p>ä»è¿™å¼ å›¾ä¹Ÿè¯´æ˜äº†ä¸€ä¸ªé—®é¢˜ï¼Œ<code>NSString</code> å¯¹è±¡ç»è¿‡ <code>copy</code> åä»ç„¶æ˜¯ä¸å¯å˜å¯¹è±¡ã€‚</p><p>ç´§æ¥ç€ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹ <code>mutableCopy</code> çš„ä½¿ç”¨æƒ…å†µï¼Œä¾‹å­å¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *name = <span class="string">@&quot;www.&quot;</span>;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;name addr: %p, name content: %@&quot;</span>, name, name);</span><br><span class="line">    </span><br><span class="line"><span class="built_in">NSString</span> *name1 = name;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;name1 addr: %p, name1 content: %@&quot;</span>, name1, name1);</span><br><span class="line">    </span><br><span class="line"><span class="built_in">NSString</span> *name2 = [name <span class="keyword">copy</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;name2 addr: %p, name2 content: %@&quot;</span>, name2, name2);</span><br><span class="line">    </span><br><span class="line"><span class="keyword">id</span> name3 = [name mutableCopy];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;name3 addr: %p, name3 content: %@&quot;</span>, name3, name3);</span><br></pre></td></tr></table></figure><p>å¯¹è±¡ <code>name3</code> æ˜¯ç»è¿‡ <code>name</code> å¯¹è±¡ <code>mutableCopy</code> åçš„ï¼Œè¿™ä¸ªæ—¶å€™å› ä¸ºæˆ‘ä¸ç¡®å®š <code>name3</code> åˆ°åº•æ˜¯å¯å˜çš„è¿˜æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥é‡‡ç”¨äº† <code>id</code> æ¥ä¿®é¥° <code>name3</code> å¯¹è±¡ã€‚</p><p>å¯ä»¥çœ‹ä¸€ä¸‹è¾“å‡ºå†…å®¹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">name  addr: <span class="number">0x104a6acf8</span>, name  content: www.</span><br><span class="line">name1 addr: <span class="number">0x104a6acf8</span>, name1 content: www.</span><br><span class="line">name2 addr: <span class="number">0x104a6acf8</span>, name2 content: www.</span><br><span class="line">name3 addr: <span class="number">0x1c0052cf0</span>, name3 content: www.</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œ<code>name3</code> çš„åœ°å€å˜äº†ï¼Œå†çœ‹ä¸€ä¸‹æ–­ç‚¹çš„æˆªå›¾ï¼š<br><img src="/upload/images/2018/12/30/2.jpg"></p><p>å……åˆ†è¯´æ˜äº† <code>name3</code> ç»è¿‡ä¸å¯å˜çš„ <code>name</code> è¿›è¡Œ<code>mutableCopy</code> åå˜æˆäº†å¯å˜å¯¹è±¡ã€‚é‚£ä¹ˆå¯ä»¥å°†ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ç¨ä½œä¿®æ”¹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableString</span> *name3 = [name mutableCopy];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;name3 addr: %p, name3 content: %@&quot;</span>, name3, name3);</span><br><span class="line">[name3 appendString:<span class="string">@&quot;veryitman.com&quot;</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;name3 addr: %p, name3 content: %@&quot;</span>, name3, name3);</span><br></pre></td></tr></table></figure><p>ä»ä¸‹é¢çš„è¾“å‡ºç»“æœä¹Ÿå……åˆ†è¯´æ˜äº† <code>name3</code> ç»è¿‡ä¸å¯å˜çš„ <code>name</code> è¿›è¡Œ <code>mutableCopy</code> åå˜æˆäº†å¯å˜å¯¹è±¡ã€‚è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name3 addr: <span class="number">0x1d0058270</span>, name3 content: www.veryitman.com</span><br></pre></td></tr></table></figure><p><strong>ç»“è®º 1ï¼š</strong></p><ul><li>ä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡ç»è¿‡ <code>copy</code> åï¼Œè¿˜æ˜¯ä¸å¯å˜å¯¹è±¡ã€‚</li><li>ä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡ç»è¿‡ <code>mutableCopy</code> åï¼Œå˜æˆäº†å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡ã€‚</li></ul><h2 id="NSMutableString-çš„-copy-å’Œ-mutableCopy"><a href="#NSMutableString-çš„-copy-å’Œ-mutableCopy" class="headerlink" title="NSMutableString çš„ copy å’Œ mutableCopy"></a>NSMutableString çš„ copy å’Œ mutableCopy</h2><p>ç±» <code>NSMutableString</code> ç»§æ‰¿è‡ª <code>NSString</code> çš„ï¼Œå…¶å½“ç„¶ä¹Ÿæ˜¯å®ç°äº† <code>NSCopying</code>, <code>NSMutableCopying</code> è¿™ä¸¤ä¸ªåè®®çš„ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@interface NSMutableString : NSString</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¿˜æ˜¯çœ‹ä¾‹å­ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableString</span> *name = [<span class="built_in">NSMutableString</span> stringWithString:<span class="string">@&quot;www.&quot;</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;name  addr: %p, name  content: %@&quot;</span>, name, name);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç®€å•èµ‹å€¼</span></span><br><span class="line"><span class="built_in">NSMutableString</span> *name1 = name;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;name1 addr: %p, name1 content: %@&quot;</span>, name1, name1);</span><br><span class="line">   </span><br><span class="line"><span class="comment">// ä½¿ç”¨ copy    </span></span><br><span class="line"><span class="keyword">id</span> name2 = [name <span class="keyword">copy</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;name2 addr: %p, name2 content: %@&quot;</span>, name2, name2);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ä½¿ç”¨ mutableCopy   </span></span><br><span class="line"><span class="keyword">id</span> name3 = [name mutableCopy];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;name3 addr: %p, name3 content: %@&quot;</span>, name3, name3);</span><br></pre></td></tr></table></figure><p>å› ä¸ºäº‹å…ˆæˆ‘ä»¬ä¸çŸ¥é“ <code>NSMutableString</code> ç»è¿‡ <code>copy</code> å’Œ <code>mutableCopy</code> ä¹‹ååˆ°åº•ä¼šå˜æˆå¯å˜è¿˜æ˜¯ä¸å¯å˜ï¼Œä¸Šé¢çš„ä¾‹å­æš‚æ—¶å°† <code>name2</code> å’Œ <code>name3</code> ç”¨ <code>id</code> æ¥è¡¨ç¤ºã€‚</p><p>æ–­ç‚¹æˆªå›¾å¦‚ä¸‹ï¼š<br><img src="/upload/images/2018/12/30/3.jpg"></p><p>ç»“åˆä¸€ä¸‹è¾“å‡ºçš„æ—¥å¿—ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">name  addr: <span class="number">0x1d044a980</span>, name  content: www.</span><br><span class="line">name1 addr: <span class="number">0x1d044a980</span>, name1 content: www.</span><br><span class="line">name2 addr: <span class="number">0xa0000002e7777774</span>, name2 content: www.</span><br><span class="line">name3 addr: <span class="number">0x1d044a5f0</span>, name3 content: www.</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡º <code>name2</code> æ˜¯ä¸€ä¸ªä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡ï¼Œ <code>name</code>ã€<code>name1</code> å’Œ <code>name3</code> éƒ½æ˜¯å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡ã€‚</p><p>ä¹Ÿå¯ä»¥ä»å¦å¤–ä¸€ä¸ªè§’åº¦æ¥éªŒè¯ä¸€ä¸‹ä¸Šé¢çš„è¯´æ³•ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹ä»£ç ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableString</span> *name2 = [name <span class="keyword">copy</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;name2 addr: %p, name2 content: %@&quot;</span>, name2, name2);</span><br><span class="line">[name2 appendString:<span class="string">@&quot;veryitman.com&quot;</span>];</span><br><span class="line">    </span><br><span class="line"><span class="built_in">NSMutableString</span> *name3 = [name mutableCopy];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;name3 addr: %p, name3 content: %@&quot;</span>, name3, name3);</span><br><span class="line">[name3 appendString:<span class="string">@&quot;veryitman.com&quot;</span>];</span><br></pre></td></tr></table></figure><p>è¿è¡Œåï¼Œå¯ä»¥çœ‹åˆ°ï¼Œä»£ç  <code>[name2 appendString:@&quot;veryitman.com&quot;]</code> è¿™é‡Œä¼šå¼•èµ· Crashï¼ŒæŠ¥é”™å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> -[<span class="built_in">NSTaggedPointerString</span> appendString:]: unrecognized selector sent to instance <span class="number">0xa0000002e7777774</span></span><br><span class="line"> </span><br><span class="line">*** Terminating app due to uncaught exception <span class="string">&#x27;NSInvalidArgumentException&#x27;</span></span><br><span class="line"></span><br><span class="line">reason: <span class="string">&#x27;-[NSTaggedPointerString appendString:]: unrecognized selector sent to instance 0xa0000002e7777774&#x27;</span></span><br></pre></td></tr></table></figure><p>ä¹Ÿå……åˆ†è¯´æ˜äº†ï¼Œ<code>name2</code> æ˜¯ä¸€ä¸ªä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡ã€‚</p><p><strong>ç»“è®º 2ï¼š</strong></p><ul><li>å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡ç»è¿‡ <code>copy</code> åï¼Œä¼šå˜æˆä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡ã€‚</li><li>å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡ç»è¿‡ <code>mutableCopy</code> åï¼Œä»ç„¶æ˜¯å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡ã€‚</li></ul><h2 id="copyã€strong-ä¿®é¥°-NSString"><a href="#copyã€strong-ä¿®é¥°-NSString" class="headerlink" title="copyã€strong ä¿®é¥° NSString"></a>copyã€strong ä¿®é¥° NSString</h2><p>åˆ›å»º Employee æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Employee</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *userName;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p>å…¶ <code>userName</code> å±æ€§æ˜¯ <code>copy</code>ã€‚</p><p>ä½¿ç”¨ç¤ºä¾‹ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Employee *employee = [Employee new];</span><br><span class="line">employee.userName = <span class="string">@&quot;John&quot;</span>;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;--before-- employee.userName addr: %p, employee.userName content: %@&quot;</span>, employee.userName, employee.userName);</span><br><span class="line">        </span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªå¯å˜å¯¹è±¡</span></span><br><span class="line"><span class="built_in">NSMutableString</span> *newUserName = [[<span class="built_in">NSMutableString</span> alloc] initWithString:<span class="string">@&quot;new_user_name&quot;</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;newUserName addr: %p, newUserName content: %@&quot;</span>, newUserName, newUserName);</span><br><span class="line">    </span><br><span class="line"><span class="comment">// å°†ä¸€ä¸ªæ–°çš„å¯¹åƒèµ‹å€¼ç»™ employee.userNameï¼Œæ­¤æ—¶ employee.userName çš„åœ°å€è‚¯å®šä¼šå˜åŒ–</span></span><br><span class="line">employee.userName = newUserName;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;---after1--- employee.userName addr: %p, employee.userName content: %@&quot;</span>, employee.userName, employee.userName);</span><br><span class="line">    </span><br><span class="line"><span class="comment">// è¯•å›¾æ”¹å˜ newUserName çš„å†…å®¹ï¼Œçœ‹ employee.userName çš„å†…å®¹æ˜¯å¦æ”¹å˜</span></span><br><span class="line">[newUserName appendString:<span class="string">@&quot;_hello&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// newUserName çš„å†…å®¹è¢«æ”¹å˜æˆäº† new_user_name_hello</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;newUserName addr: %p, newUserName content: %@&quot;</span>, newUserName, newUserName);</span><br><span class="line"></span><br><span class="line"><span class="comment">// employee.userName çš„å†…å®¹æœªå˜åŒ–</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;---after2--- employee.userName addr: %p, employee.userName content: %@&quot;</span>, employee.userName, employee.userName);</span><br><span class="line">    </span><br><span class="line"><span class="comment">// Crashï¼Œå› ä¸º employee.userName è¿˜æ˜¯ä¸å¯å˜å¯¹è±¡</span></span><br><span class="line"><span class="comment">// [(NSMutableString *)(employee.userName) appendString:@&quot;nana&quot;];</span></span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæ•…æ„å°† <code>NSMutableString</code> å¯¹è±¡ <code>newUserName</code> èµ‹å€¼ç»™ä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡ <code>employee.userName</code>ï¼Œçœ‹ä¸€ä¸‹è¾“å‡ºç»“æœï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">--before-- employee.userName addr: <span class="number">0x100096cf8</span>, employee.userName content: John</span><br><span class="line"></span><br><span class="line">newUserName addr: <span class="number">0x174070a00</span>, newUserName content: new_user_name</span><br><span class="line"></span><br><span class="line">---after1--- employee.userName addr: <span class="number">0x174023b80</span>, employee.userName content: new_user_name</span><br><span class="line"></span><br><span class="line">newUserName addr: <span class="number">0x174070a00</span>, newUserName content: new_user_name_hello</span><br><span class="line"></span><br><span class="line">---after2--- employee.userName addr: <span class="number">0x174023b80</span>, employee.userName content: new_user_name</span><br></pre></td></tr></table></figure><p>æŒ‰ç…§ </p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¯å˜çš„ `<span class="built_in">NSMutableString</span>` å¯¹è±¡ç»è¿‡ `<span class="keyword">copy</span>` åï¼Œä¼šå˜æˆä¸å¯å˜çš„ `<span class="built_in">NSString</span>` å¯¹è±¡ã€‚</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç»“è®ºæ¥çœ‹ï¼Œ<code>employee.userName</code> è‚¯å®šæ˜¯ä¸å¯å˜çš„å¯¹è±¡ï¼Œå³ä½¿æ”¹å˜ <code>newUserName</code> çš„å†…å®¹ä¹Ÿä¸ä¼šå½±å“ <code>employee.userName</code> è¿™ä¸ªå¯¹è±¡çš„å†…å®¹ã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å°† <code>employee.userName</code> çš„å±æ€§ä¿®é¥°ç¬¦ <code>copy</code> æ”¹ä¸º <code>strong</code>ï¼Œåˆä¼šæ˜¯ä»€ä¹ˆæ ·å­å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬ä¿®æ”¹ä¸¤å¤„ä»£ç </p><p><strong>Employee.h</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Employee</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//@property (nonatomic, copy) NSString *userName;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSString</span> *userName;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ä»£ç ï¼Œåªæ˜¯æ‰“å¼€ä¹‹å‰ä¼š crash çš„éƒ¨åˆ†</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// employee.userName ç»è¿‡ strong ä¿®é¥°è¿‡åï¼Œ å½»åº•å˜æˆäº†å¯å˜å¯¹è±¡</span></span><br><span class="line">[(<span class="built_in">NSMutableString</span> *)(employee.userName) appendString:<span class="string">@&quot;_oc&quot;</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;---after3--- employee.userName addr: %p, employee.userName content: %@&quot;</span>, employee.userName, employee.userName);</span><br></pre></td></tr></table></figure><p>çœ‹ä¸€ä¸‹è¾“å‡ºæ—¥å¿—ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">--before-- employee.userName addr: <span class="number">0x1000a6cf8</span>, employee.userName content: John</span><br><span class="line"></span><br><span class="line">newUserName addr: <span class="number">0x17426b280</span>, newUserName content: new_user_name</span><br><span class="line"></span><br><span class="line">---after1--- employee.userName addr: <span class="number">0x17426b280</span>, employee.userName content: new_user_name</span><br><span class="line"></span><br><span class="line">newUserName addr: <span class="number">0x17426b280</span>, newUserName content: new_user_name_hello</span><br><span class="line"></span><br><span class="line">---after2--- employee.userName addr: <span class="number">0x17426b280</span>, employee.userName content: new_user_name_hello</span><br><span class="line"></span><br><span class="line">---after3--- employee.userName addr: <span class="number">0x17426b280</span>, employee.userName content: new_user_name_hello_oc</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° <code>employee.userName</code> æœ€ç»ˆå’Œ <code>newUserName</code> çš„åœ°å€ã€å†…å®¹å®Œå…¨ç›¸åŒäº†ï¼Œå½»åº•å˜æˆäº†å¯å˜å¯¹è±¡ã€‚</p><p>å¦å¤–ï¼Œå¦‚æœä¸æ˜¯å°†å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡èµ‹å€¼ç»™ä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡ï¼Œæ¢å¥è¯è¯´ï¼Œ<code>NSString</code> å¯¹ <code>NSString</code> èµ‹å€¼ï¼Œé‚£ä¹ˆä½¿ç”¨ <code>strong</code> å’Œ <code>copy</code> æ•ˆæœéƒ½æ˜¯ä¸€æ ·çš„ã€‚</p><p>ç¤ºä¾‹ä»£ç ï¼ˆæ— è®º <code>employee.userName</code> ä½¿ç”¨ <code>strong</code> è¿˜æ˜¯ <code>copy</code>ï¼Œæ•ˆæœéƒ½æ˜¯ <code>employee.userName</code> ä¸å¯å˜çš„ï¼‰ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Employee *employee = [Employee new];</span><br><span class="line">employee.userName = <span class="string">@&quot;John&quot;</span>;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;--before-- employee.userName addr: %p, employee.userName content: %@&quot;</span>, employee.userName, employee.userName);</span><br><span class="line">    </span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªä¸å¯å˜å¯¹è±¡</span></span><br><span class="line"><span class="built_in">NSString</span> *newUserName = <span class="string">@&quot;new_user_name&quot;</span>;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;newUserName addr: %p, newUserName content: %@&quot;</span>, newUserName, newUserName);</span><br><span class="line">    </span><br><span class="line"><span class="comment">// å°†ä¸€ä¸ªæ–°çš„å¯¹åƒèµ‹å€¼ç»™ employee.userNameï¼Œæ­¤æ—¶ employee.userName çš„åœ°å€è‚¯å®šä¼šå˜åŒ–</span></span><br><span class="line">employee.userName = newUserName;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;---after1--- employee.userName addr: %p, employee.userName content: %@&quot;</span>, employee.userName, employee.userName);</span><br></pre></td></tr></table></figure><h2 id="copyã€strong-ä¿®é¥°-NSMutableString"><a href="#copyã€strong-ä¿®é¥°-NSMutableString" class="headerlink" title="copyã€strong ä¿®é¥° NSMutableString"></a>copyã€strong ä¿®é¥° NSMutableString</h2><p>åœ¨ property çš„ä¿®é¥°è¯­ä¸­ï¼Œåªæœ‰ <code>copy</code> ä¿®é¥°è¯­è€Œæ²¡æœ‰ <code>mutableCopy</code> çš„ä¿®é¥°è¯­ã€‚</p><p><strong>Employee.h</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@interface Employee : NSObject</span><br><span class="line"></span><br><span class="line">@property (nonatomic, copy) NSMutableString *userName;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Employee *employee = [Employee new];</span><br><span class="line">employee.userName = [NSMutableString stringWithString:@&quot;John&quot;];</span><br><span class="line">NSLog(@&quot;--before-- employee.userName addr: %p, employee.userName content: %@&quot;, employee.userName, employee.userName);</span><br><span class="line"></span><br><span class="line">// åˆ›å»ºä¸€ä¸ªå¯å˜å¯¹è±¡</span><br><span class="line">NSMutableString *newUserName = [NSMutableString stringWithFormat:@&quot;new_user_name&quot;];</span><br><span class="line">NSLog(@&quot;newUserName addr: %p, newUserName content: %@&quot;, newUserName, newUserName);</span><br><span class="line"></span><br><span class="line">// å°†ä¸€ä¸ªæ–°çš„å¯¹åƒèµ‹å€¼ç»™ employee.userNameï¼Œæ­¤æ—¶ employee.userName çš„åœ°å€è‚¯å®šä¼šå˜åŒ–</span><br><span class="line">employee.userName = newUserName;</span><br><span class="line">NSLog(@&quot;---after1--- employee.userName addr: %p, employee.userName content: %@&quot;, employee.userName, employee.userName);</span><br><span class="line">    </span><br><span class="line">// employee.userName è™½ç„¶æ˜¯ NSMutableString å¯¹è±¡ï¼Œä½†ç»è¿‡ copy ä¿®é¥°è¿‡åï¼Œä»ç„¶æ˜¯ä¸å¯å˜å¯¹è±¡</span><br><span class="line">// æ‰€ä»¥ï¼Œè¿è¡Œåˆ°è¿™é‡Œä¼šå¼•èµ· crash</span><br><span class="line">[employee.userName appendString:@&quot;_oc&quot;];</span><br><span class="line">NSLog(@&quot;---after2--- employee.userName addr: %p, employee.userName content: %@&quot;, employee.userName, employee.userName);</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡º <code>copy</code> åçš„çš„å¯å˜å¯¹è±¡è¿˜æ˜¯ä¸å¯å˜çš„ã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å°† <code>employee.userName</code> çš„å±æ€§ä¿®é¥°ç¬¦ <code>copy</code> æ”¹ä¸º <code>strong</code>ï¼Œåˆä¼šæ˜¯ä»€ä¹ˆæ ·å­å‘¢ï¼Ÿ</p><p><strong>Employee.h</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Employee</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSString</span> *userName;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Employee *employee = [Employee new];</span><br><span class="line">employee.userName = [<span class="built_in">NSMutableString</span> stringWithString:<span class="string">@&quot;John&quot;</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;--before-- employee.userName addr: %p, employee.userName content: %@&quot;</span>, employee.userName, employee.userName);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªå¯å˜å¯¹è±¡</span></span><br><span class="line"><span class="built_in">NSMutableString</span> *newUserName = [<span class="built_in">NSMutableString</span> stringWithFormat:<span class="string">@&quot;new_user_name&quot;</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;newUserName addr: %p, newUserName content: %@&quot;</span>, newUserName, newUserName);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†ä¸€ä¸ªæ–°çš„å¯¹åƒèµ‹å€¼ç»™ employee.userNameï¼Œæ­¤æ—¶ employee.userName çš„åœ°å€è‚¯å®šä¼šå˜åŒ–</span></span><br><span class="line">employee.userName = newUserName;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;---after1--- employee.userName addr: %p, employee.userName content: %@&quot;</span>, employee.userName, employee.userName);</span><br><span class="line">    </span><br><span class="line"><span class="comment">// employee.userName è™½ç„¶æ˜¯ NSMutableString å¯¹è±¡ï¼Œä½†ç»è¿‡ strong ä¿®é¥°è¿‡åï¼Œå˜æˆäº†å¯å˜å¯¹è±¡</span></span><br><span class="line">[employee.userName appendString:<span class="string">@&quot;_hello&quot;</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;---after2--- employee.userName addr: %p, employee.userName content: %@&quot;</span>, employee.userName, employee.userName);</span><br><span class="line">    </span><br><span class="line">[newUserName appendString:<span class="string">@&quot;_oc&quot;</span>];</span><br><span class="line"><span class="comment">// newUserName çš„å†…å®¹è¢«æ”¹å˜æˆäº† new_user_name_hello_oc</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;newUserName addr: %p, newUserName content: %@&quot;</span>, newUserName, newUserName);</span><br><span class="line"><span class="comment">// employee.userName çš„å†…å®¹å‘ç”Ÿäº†å˜åŒ–</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;---after2--- employee.userName addr: %p, employee.userName content: %@&quot;</span>, employee.userName, employee.userName);</span><br></pre></td></tr></table></figure><p>ç»è¿‡ <code>strong</code> ä¿®é¥°åï¼Œå¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡è¿˜æ˜¯å¯å˜çš„å¯¹è±¡ã€‚</p><p>åœ¨è¿™ä¸ªéƒ¨åˆ†çš„å¼€å§‹ï¼Œè¯´è¿‡åœ¨ property ä¸­æ²¡æœ‰ <code>mutableCopy</code> çš„ä¿®é¥°è¯­ï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½å¦è¾¾åˆ° <code>mutableCopy</code> çš„æ•ˆæœå‘¢ï¼Ÿ</p><p>å¾ˆæ˜¾ç„¶æ˜¯å¯ä»¥çš„ï¼Œæˆ‘ä»¬å¯ä»¥é‡å†™å±æ€§çš„ <code>set</code> æ–¹æ³•ï¼Œæ”¹é€ ä¸€ä¸‹ <code>Employee</code> çš„ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p><p><strong>Employee.h</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@interface Employee : NSObject</span><br><span class="line"></span><br><span class="line">@property (nonatomic, copy) NSMutableString *userName;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p><strong>Employee.m</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;Employee.h&quot;</span><br><span class="line"></span><br><span class="line">@implementation Employee</span><br><span class="line"></span><br><span class="line">- (void)setUserName:(NSMutableString *)userName</span><br><span class="line">&#123;</span><br><span class="line">    _userName = [userName mutableCopy];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œå°±è¾¾åˆ°äº†å’Œæ˜¯ <code>strong</code> ä¿®é¥°è¯­ä¸€æ ·çš„æ•ˆæœäº†ã€‚</p><p>å¤§å®¶ï¼Œå¯ä»¥ä½¿ç”¨åŒæ ·çš„æ–¹æ³•æ¥å®è·µä¸€ä¸‹ <code>NSArray</code>ã€<code>NSMutableArry</code> ç­‰é›†åˆæ•°æ®çš„ <code>copy</code> ä»¥åŠ <code>mutableCopy</code> çš„æ•ˆæœäº†ã€‚</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><ul><li><p>ä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡ç»è¿‡ <code>copy</code> åï¼Œè¿˜æ˜¯ä¸å¯å˜å¯¹è±¡ã€‚</p></li><li><p>ä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡ç»è¿‡ <code>mutableCopy</code> åï¼Œå˜æˆäº†å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡ã€‚</p></li><li><p>å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡ç»è¿‡ <code>copy</code> åï¼Œä¼šå˜æˆä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡ã€‚</p></li><li><p>å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡ç»è¿‡ <code>mutableCopy</code> åï¼Œä»ç„¶æ˜¯å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡ã€‚</p></li><li><p>ä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡åœ¨ property ä¸­ï¼Œå°½é‡ä½¿ç”¨ <code>copy</code> æ¥ä¿®é¥°ï¼Œå› ä¸ºä½¿ç”¨ <code>strong</code> ä¿®é¥°ç¬¦å¯å˜å­—ç¬¦ä¸²å¦‚æœç»™ä¸å¯å˜å­—ç¬¦ä¸²èµ‹å€¼åï¼Œä¼šå¯¼è‡´ä½ åŸæœ¬é¢„æœŸå‘ç”Ÿäº†å˜åŒ–ï¼Œé™¤éä½ æœ‰ç‰¹æ®Šçš„ç›®çš„æ‰ä½¿ç”¨ <code>strong</code> ä¿®é¥°ç¬¦ã€‚</p></li><li><p>å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡åœ¨ property ä¸­ï¼Œå°½é‡ä½¿ç”¨ <code>strong</code> æ¥ä¿®é¥°ï¼Œé™¤éä½ æœ‰ç‰¹æ®Šçš„ç›®çš„æ‰ä½¿ç”¨ <code>copy</code> ä¿®é¥°ç¬¦ã€‚</p></li><li><p>è™½ç„¶åœ¨ property ä¸­æ²¡æœ‰ <code>mutableCopy</code> ä¿®é¥°ç¬¦ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡é‡å†™å…¶ <code>set</code> æ–¹æ³•æ¥è¾¾åˆ°ç›®çš„ã€‚</p></li></ul><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NSString NSMutableString copy mutableCopy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OC: self</title>
      <link href="/2018/12/23/OC-self/"/>
      <url>/2018/12/23/OC-self/</url>
      
        <content type="html"><![CDATA[<p>ä¸ºäº†æ›´å¥½çš„è¯´æ˜ Objective-C ä¸­çš„ <code>self</code>ï¼Œæˆ‘ä»¬å…ˆä» Java çš„ <code>this</code> å…³é”®å­—å¼€å§‹æ¥å¼•å…¥è¯é¢˜ã€‚</p><h2 id="Java-ä¸­çš„-this"><a href="#Java-ä¸­çš„-this" class="headerlink" title="Java ä¸­çš„ this"></a>Java ä¸­çš„ this</h2><p>åœ¨ Java ä¸­ <code>this</code> å…³é”®å­—è¡¨ç¤ºå½“å‰ç±»å¯¹è±¡ï¼Œå…¶åªèƒ½åœ¨ç±»çš„éé™æ€æ–¹æ³•ä¸­ä½¿ç”¨ï¼Œé™æ€æ–¹æ³•å’Œé™æ€çš„ä»£ç å—ä¸­ç»å¯¹ä¸èƒ½å‡ºç° <code>this</code>ï¼Œ<code>this</code> åªå’Œç‰¹å®šçš„å¯¹è±¡å…³è”ï¼Œè€Œä¸å’Œç±»å…³è”ï¼ŒåŒä¸€ä¸ªç±»çš„ä¸åŒå¯¹è±¡æœ‰ä¸åŒçš„ <code>this</code>.</p><p>å…ˆçœ‹ä¸€ä¸ª Java ç¤ºä¾‹ï¼Œèƒ½è¯´æ˜ä¸Šé¢çš„é—®é¢˜ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é™æ€ä»£ç å—ä¸­ä¹Ÿä¸å¯ä»¥ä½¿ç”¨ this</span></span><br><span class="line"><span class="comment">// Error: non-static variable this cannot be referenced from a static context</span></span><br><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">    <span class="comment">// this.eat();</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">play</span><span class="params">()</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;play()&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// this è°ƒç”¨ç±»æ–¹æ³•</span></span><br><span class="line">    <span class="built_in">this</span>.eat();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// this è°ƒç”¨å®ä¾‹æ–¹æ³•</span></span><br><span class="line">    <span class="built_in">this</span>.finish();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;static eat()&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸å¯ä»¥åœ¨ç±»æ–¹æ³•ä¸­ä½¿ç”¨ this</span></span><br><span class="line">    <span class="comment">// Error: non-static variable this cannot be referenced from a static context</span></span><br><span class="line">    <span class="comment">// this.play();</span></span><br><span class="line">    <span class="comment">// System.out.println(this);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">finish</span><span class="params">()</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;finish()&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡å®é™…çš„ Java ä¾‹å­ï¼ŒåŸºæœ¬è¡¨æ˜äº†åœ¨é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•ä¸­ <code>this</code> çš„ä½¿ç”¨åœºæ™¯ã€‚</p><h2 id="Objective-C-ä¸­çš„-self"><a href="#Objective-C-ä¸­çš„-self" class="headerlink" title="Objective-C ä¸­çš„ self"></a>Objective-C ä¸­çš„ self</h2><p>åœ¨ <code>Objective-C</code> ä¸­ï¼Œ<code>self</code> æ˜¯ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„å¯¹è±¡ï¼Œå®ƒæ—¢å¯ä»¥æ˜¯å®ä¾‹å¯¹è±¡ä¹Ÿå¯ä»¥æ˜¯ç±»å¯¹è±¡ï¼Œæœ‰ç‚¹ç±»ä¼¼äºä¸Šé¢ Java ä¸­çš„ <code>this</code> å…³é”®å­—ã€‚</p><p>ä¸‹é¢ç»“åˆå®é™…ä¾‹å­ï¼Œæ¥è¯´æ˜ <code>self</code> è¿™ä¸ªå…³é”®å­—ã€‚</p><h3 id="1ã€å®ä¾‹æ–¹æ³•ä¸­çš„-self"><a href="#1ã€å®ä¾‹æ–¹æ³•ä¸­çš„-self" class="headerlink" title="1ã€å®ä¾‹æ–¹æ³•ä¸­çš„ self"></a>1ã€å®ä¾‹æ–¹æ³•ä¸­çš„ self</h3><p>å®ä¾‹æ–¹æ³•ä¸­çš„ <code>self</code> å¯ä»¥ç›´æ¥è°ƒç”¨å®ä¾‹æ–¹æ³•ä½†ä¸å¯ä»¥ç›´æ¥è°ƒç”¨ç±»æ–¹æ³•ï¼Œå¦‚ä¸‹ç¤ºä¾‹ä¸­ï¼Œè°ƒç”¨å®ä¾‹æ–¹æ³• <code>finish</code>æ²¡æœ‰é—®é¢˜ï¼Œè€Œè°ƒç”¨ç±»æ–¹æ³• <code>eat</code> ç›´æ¥æŠ¥ç¼–è¯‘é”™è¯¯ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)play</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---------------- &#x27;- (void)play&#x27; ------------------&quot;</span>);</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;self: %@, self -&gt; %p&quot;</span>, <span class="keyword">self</span>, <span class="keyword">self</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ— æ³•ä½¿ç”¨ self æ¥è°ƒç”¨ç±»æ–¹æ³•</span></span><br><span class="line">    <span class="comment">// Error: No visible @interface for &#x27;MZPerson&#x27; declares the selector &#x27;eat&#x27;</span></span><br><span class="line">    <span class="comment">// [self eat];</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è°ƒç”¨å®ä¾‹æ–¹æ³•</span></span><br><span class="line">    [<span class="keyword">self</span> finish];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)eat</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---------------- &#x27;+ (void)eat&#x27; ------------------&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)finish</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;--------------- &#x27;- (void)finish&#x27; ----------------&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨å®ä¾‹æ–¹æ³•ä¸­å¯ä»¥ç›´æ¥é€šè¿‡&#96;&#96;[ç±» ç±»æ–¹æ³•]<code>çš„æ–¹å¼æ¥è°ƒç”¨ç±»æ–¹æ³•ï¼Œé‚£ä¹ˆå¦‚æœæƒ³åœ¨å®ä¾‹æ–¹æ³•ä¸­ä½¿ç”¨</code>self&#96; å…³é”®å­—ï¼Œå¦‚ä½•åŠå‘¢ï¼Ÿ</p><p>å¾ˆç®€å•ï¼Œä½¿ç”¨ <code>[self class]</code> å³å¯ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)play</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---------------- &#x27;- (void)play&#x27; ------------------&quot;</span>);</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;self: %@, self -&gt; %p&quot;</span>, <span class="keyword">self</span>, <span class="keyword">self</span>);</span><br><span class="line">    </span><br><span class="line">    [[<span class="keyword">self</span> <span class="keyword">class</span>] eat];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³äº <code>class</code> åç»­å†åˆ†äº«ç»™å¤§å®¶ï¼Œè¿™é‡Œåªéœ€è¦çŸ¥é“å¯ä»¥è¿™ä¹ˆä½¿ç”¨å°±å¥½äº†ã€‚</p><h3 id="2ã€ç±»æ–¹æ³•ä¸­çš„-self"><a href="#2ã€ç±»æ–¹æ³•ä¸­çš„-self" class="headerlink" title="2ã€ç±»æ–¹æ³•ä¸­çš„ self"></a>2ã€ç±»æ–¹æ³•ä¸­çš„ self</h3><p>è¿™ä¸ªè·Ÿ Java çš„ <code>this</code> æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œä¸Šé¢çš„ Java ç¤ºä¾‹ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ— è®ºæ˜¯æ‰“å° <code>this</code> è¿˜æ˜¯ä½¿ç”¨ <code>this</code> è°ƒç”¨æ–¹æ³•éƒ½ä¸å¯ä»¥ï¼Œä½†æ˜¯åœ¨ <code>Objective-C</code> ä¸­å´å¯ä»¥ä½¿ç”¨ <code>self</code>ï¼Œåªæ˜¯ä¸èƒ½ä½¿ç”¨ <code>self</code> æ¥è°ƒç”¨å®ä¾‹æ–¹æ³•å’Œå®ä¾‹å˜é‡ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="keyword">void</span>)eat</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---------------- &#x27;+ (void)eat&#x27; ------------------&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// No known class method for selector &#x27;finish&#x27;</span></span><br><span class="line">    <span class="comment">// [self finish];</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è°ƒç”¨ç±»æ–¹æ³•</span></span><br><span class="line">    [<span class="keyword">self</span> beat];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ‰“å° self</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;self: %@&quot;</span>, <span class="keyword">self</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)beat</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---------------- &#x27;+ (void)beat&#x27; ------------------&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆä¸ºä»€ä¹ˆåœ¨ç±»æ–¹æ³•ä¸­å¯ä»¥ä½¿ç”¨ <code>self</code> å‘¢ï¼Ÿ</p><p>åˆ«ç€æ€¥ï¼Œæ¥ç€å¾€ä¸‹çœ‹ã€‚</p><h3 id="3ã€å®ä¾‹å’Œç±»æ–¹æ³•ä¸­çš„-self-åŒºåˆ«"><a href="#3ã€å®ä¾‹å’Œç±»æ–¹æ³•ä¸­çš„-self-åŒºåˆ«" class="headerlink" title="3ã€å®ä¾‹å’Œç±»æ–¹æ³•ä¸­çš„ self åŒºåˆ«"></a>3ã€å®ä¾‹å’Œç±»æ–¹æ³•ä¸­çš„ self åŒºåˆ«</h3><p>å…¶å®ï¼Œåœ¨ç±»æ–¹æ³•ä¸­ï¼Œ<code>self</code> è¡¨ç¤ºå½“å‰ç±»å¯¹è±¡ï¼Œåœ¨å®ä¾‹æ–¹æ³•ä¸­ <code>self</code> è¡¨ç¤ºå®ä¾‹å¯¹è±¡ï¼Œè¿™ä¸ªæ˜¯æœ¬è´¨åŒºåˆ«ï¼ŒåŠ¡å¿…è¦ç†è§£é€å½»ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)play</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---------------- &#x27;- (void)play&#x27; ------------------&quot;</span>);</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;self: %@, self -&gt; %p&quot;</span>, <span class="keyword">self</span>, <span class="keyword">self</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ‰“å°å¯¹åº”çš„ç±»åœ°å€</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;self class: %p&quot;</span>, [<span class="keyword">self</span> <span class="keyword">class</span>]);</span><br><span class="line">    </span><br><span class="line">    [[<span class="keyword">self</span> <span class="keyword">class</span>] eat];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)eat</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---------------- &#x27;+ (void)eat&#x27; ------------------&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// No known class method for selector &#x27;finish&#x27;</span></span><br><span class="line">    <span class="comment">// [self finish];</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ‰“å° self åœ°å€</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;self: %p&quot;</span>, <span class="keyword">self</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è°ƒç”¨ç±»æ–¹æ³•</span></span><br><span class="line">    [<span class="keyword">self</span> beat];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)beat</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---------------- &#x27;+ (void)beat&#x27; ------------------&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ‰“å° self åœ°å€</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;self: %p&quot;</span>, <span class="keyword">self</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨å®ä¾‹æ–¹æ³• <code>play</code> ä¸­æ‰“å°ç±»åœ°å€ï¼Œåœ¨ç±»æ–¹æ³• <code>eat</code> å’Œ <code>beat</code> ä¸­æ‰“å° <code>self</code> çš„åœ°å€ï¼Œè¾“å‡ºç»“æœæ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯ <code>0x10adb3f98</code> è¿™ä¸ªåœ°å€ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---------------- &#x27;- (void)play&#x27; ------------------</span><br><span class="line">self: &lt;MZPerson: 0x6000000d8f90&gt;, self -&gt; 0x6000000d8f90</span><br><span class="line">self class: 0x10adb3f98</span><br><span class="line">---------------- &#x27;+ (void)eat&#x27; ------------------</span><br><span class="line">self: 0x10adb3f98</span><br><span class="line">---------------- &#x27;+ (void)beat&#x27; ------------------</span><br><span class="line">self: 0x10adb3f98</span><br></pre></td></tr></table></figure><p>ä¸ºäº†æ›´å¥½çš„è¯´æ˜ï¼Œæˆ‘ç»™å¤§å®¶å†ä¸¾ä¸€ä¸ªå½¢è±¡çš„ä¾‹å­å¸®åŠ©å¤§å®¶ç†è§£ã€‚</p><p>åœ¨ <code>MZPerson</code> ä¸­å£°æ˜ä¸¤ä¸ªæ–¹æ³•ï¼Œæ–¹æ³•åŒåï¼Œä¸€ä¸ªæ˜¯å®ä¾‹æ–¹æ³•ï¼Œå¦ä¸€ä¸ªæ˜¯ç±»æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MZPerson</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)play;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)play;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)eat;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)finish;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MZPerson</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)play</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---------------- &#x27;- (void)play&#x27; ------------------&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)play</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---------------- &#x27;+ (void)play&#x27; ------------------&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)eat</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---------------- &#x27;+ (void)eat&#x27; ------------------&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> play];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)finish</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---------------- &#x27;- (void)finish&#x27; ------------------&quot;</span>);</span><br><span class="line">    [<span class="keyword">self</span> play];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p>åœ¨ç±»æ–¹æ³• <code>eat</code> ä¸­è°ƒç”¨ <code>[self play]</code> åœ¨å®ä¾‹æ–¹æ³• <code>finish</code> ä¸­ä¹Ÿè°ƒç”¨ <code>[self play]</code>ï¼Œé‚£ä¹ˆç»“æœå¦‚ä½•å‘¢ï¼Ÿ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---------------- &#x27;- (void)finish&#x27; ---------------</span><br><span class="line">---------------- &#x27;- (void)play&#x27; -----------------</span><br><span class="line"></span><br><span class="line">---------------- &#x27;+ (void)eat&#x27; ------------------</span><br><span class="line">---------------- &#x27;+ (void)play&#x27; -----------------</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºç¬¦åˆå¦‚æœŸï¼Œç±»å’Œå®ä¾‹æ–¹æ³•ä¸­çš„ self åˆ†åˆ«ä»£è¡¨ç±»æœ¬èº«å’Œå®ä¾‹å¯¹è±¡ã€‚</p><p><code>self</code> è¡¨ç¤ºè°ï¼Œåœ¨è¿è¡Œæ—¶æ˜¯ç”±ç¼–è¯‘å™¨æ¥å†³å®šçš„ã€‚</p><h3 id="4ã€æ¯ä¸ªå®ä¾‹å¯¹è±¡çš„-self-éƒ½æ˜¯ä¸ä¸€æ ·çš„"><a href="#4ã€æ¯ä¸ªå®ä¾‹å¯¹è±¡çš„-self-éƒ½æ˜¯ä¸ä¸€æ ·çš„" class="headerlink" title="4ã€æ¯ä¸ªå®ä¾‹å¯¹è±¡çš„ self éƒ½æ˜¯ä¸ä¸€æ ·çš„"></a>4ã€æ¯ä¸ªå®ä¾‹å¯¹è±¡çš„ self éƒ½æ˜¯ä¸ä¸€æ ·çš„</h3><p>è¿™ä¸ªè·Ÿ Java çš„ <code>this</code> æ˜¯ä¸€æ ·çš„ï¼Œæ¯ä¸ªç±»çš„å®ä¾‹å¯¹è±¡å¯¹åº”çš„ <code>this</code> éƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œ<code>self</code> äº¦å¦‚æ­¤ã€‚</p><p>ä¸‹é¢çš„ä¾‹å­ï¼Œåˆ†åˆ«åˆ›å»ºä¸¤ä¸ª MZPerson å®ä¾‹å¯¹è±¡ï¼Œç„¶ååˆ†åˆ«è°ƒç”¨<code>play</code> æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MZPerson *iperson1 = [MZPerson new];</span><br><span class="line">[iperson1 play];</span><br><span class="line">    </span><br><span class="line">MZPerson *iperson2 = [MZPerson new];</span><br><span class="line">[iperson2 play];</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœè¡¨æ˜äº†ä¸Šé¢è¯´æ³•çš„æ­£ç¡®æ€§ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">---------------- &#x27;- (void)play&#x27; ------------------</span><br><span class="line">self: &lt;MZPerson: 0x600000576ee0&gt;, self -&gt; 0x600000576ee0</span><br><span class="line">---------------- &#x27;- (void)play&#x27; ------------------</span><br><span class="line">self: &lt;MZPerson: 0x600000576f40&gt;, self -&gt; 0x600000576f40</span><br></pre></td></tr></table></figure><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>åœ¨ç»§æ‰¿å…³ç³»ä¸­ï¼Œä½¿ç”¨ <code>self</code> è°ƒç”¨æ–¹æ³•æ—¶ï¼Œé¦–å…ˆä»å½“å‰ç±»çš„æ–¹æ³•åˆ—è¡¨ä¸­å¼€å§‹å¯»æ‰¾ï¼Œå¦‚æœæ²¡æœ‰å†ä»çˆ¶ç±»ä¸­å¯»æ‰¾ã€‚</p><p>è¿è¡Œæ—¶(runtime)ä¼šä½¿ç”¨ <code>objc_msgSend</code> å‘å¯¹è±¡å‘é€æ¶ˆæ¯ï¼Œè¿™ä¸ªä¹Ÿæ˜¯è°ƒç”¨æ–¹æ³•çš„æœ¬è´¨ã€‚</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Objective-C self keyword </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Wireshark: åˆ†æ TCP å››æ¬¡æŒ¥æ‰‹</title>
      <link href="/2018/12/16/Wireshark-%E5%88%86%E6%9E%90-TCP-%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B/"/>
      <url>/2018/12/16/Wireshark-%E5%88%86%E6%9E%90-TCP-%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>é¦–å…ˆè¦æ˜ç™½ <code>TCP</code> åè®®æ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„ä¼ è¾“å±‚é€šä¿¡åè®®ã€‚</p><p>å…¶æ¬¡ï¼Œ<code>TCP</code> æ˜¯å…¨åŒå·¥æ¨¡å¼ï¼Œéœ€è¦ä¸¤è¾¹çš„è¿æ¥å…¨éƒ¨å…³é—­ï¼Œæ­¤ TCP ä¼šè¯æ‰ç®—å®Œå…¨å…³é—­ï¼Œå››æ¬¡æŒ¥æ‰‹ä½¿å¾— <code>TCP</code> çš„å…¨åŒå·¥è¿æ¥èƒ½å¤Ÿå¯é çš„ç»ˆæ­¢ã€‚</p><p><code>TCP</code> çš„è¿æ¥çš„æ‹†é™¤éœ€è¦å‘é€å››ä¸ªåŒ…ï¼Œå› æ­¤ç§°ä¸ºå››æ¬¡æŒ¥æ‰‹(Four-way handshake)ï¼Œä¹Ÿå«åšæ”¹è¿›çš„ä¸‰æ¬¡æ¡æ‰‹ã€‚å®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨å‡å¯ä¸»åŠ¨å‘èµ·æŒ¥æ‰‹åŠ¨ä½œï¼Œåœ¨ socket ç¼–ç¨‹ä¸­ï¼Œä»»ä½•ä¸€æ–¹æ‰§è¡Œ <code>close()</code> æ“ä½œå³å¯äº§ç”ŸæŒ¥æ‰‹æ“ä½œã€‚</p><p>ä¸‹é¢æ ¹æ®å®¢æˆ·ç«¯(IP: 10.4.17.176)è¯·æ±‚æœåŠ¡ç«¯(IP: 116.211.186.208) æ¥åˆ†æå››æ¬¡æŒ¥æ‰‹(four-way handshake)çš„è¿‡ç¨‹ã€‚</p><p>è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼Œä»»ä½•ä¸€æ–¹æ‰§è¡Œ <code>close()</code> æ“ä½œå³å¯äº§ç”ŸæŒ¥æ‰‹æ“ä½œï¼Œæ‰€ä»¥æ–­å¼€è¿æ¥ç«¯å¯ä»¥æ˜¯ <code>Client</code> ç«¯ï¼Œä¹Ÿå¯ä»¥æ˜¯ <code>Server</code> ç«¯ã€‚</p><p>åœ¨é˜…è¯»ä¸‹é¢å†…å®¹ä¹‹å‰ï¼Œæˆ‘å‡è®¾ä½ å·²ç»é˜…è¯»è¿‡ <a href="http://www.veryitman.com/2018/09/09/Wireshark-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-TCP-%E4%B8%89%E6%AC%A1%E6%8C%A5%E6%89%8B/">Wireshark: ç®€å•åˆ†æ TCP ä¸‰æ¬¡æŒ¥æ‰‹</a> è¿™ç¯‡æ–‡ç« ã€‚</p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>ä½¿ç”¨ iOS è®¾å¤‡çš„æµè§ˆå™¨å®¢æˆ·ç«¯ <code>Safari</code> è®¿é—® <code>116.211.186.208</code> è¿™ä¸ªç½‘ç«™ï¼Œå…³äºå¦‚ä½•å¼€å¯ iOS è®¾å¤‡çš„è™šæ‹Ÿç½‘å¡å¯ä»¥å‚è€ƒ <a href="http://www.veryitman.com/2018/08/20/%E5%88%9D%E8%AF%86-Wireshark/">åˆè¯† Wireshark</a> è¿™ç¯‡æ–‡ç« ã€‚</p><p>é’ˆå¯¹ <code>HTTP</code> çš„è¯·æ±‚ï¼Œå¯ä»¥è¿›è¡Œ <code>Follow</code>ï¼Œé€‰æ‹© <code>TCP Stream</code> å³å¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/12/16/1.jpg"></p><p>æ­¤æ—¶ï¼Œå¯ä»¥çœ‹åˆ°å››æ¬¡æŒ¥æ‰‹çš„æŠ“åŒ…æƒ…å†µï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/12/16/2.jpg"><br>å¦å¤–ï¼Œä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œé¦–å…ˆå‘èµ· <code>Close</code> çš„æ˜¯æœåŠ¡ç«¯ã€‚</p><p><strong>ç¬¬ä¸€æ¬¡æŒ¥æ‰‹</strong>ï¼Œå‘é€ <code>FIN</code> å’Œ <code>ACK</code> æŠ¥æ–‡ï¼Œå¦‚å›¾ï¼š<br><img src="/upload/images/2018/12/16/3.jpg"></p><p><strong>ç¬¬äºŒæ¬¡æŒ¥æ‰‹</strong>ï¼Œå®¢æˆ·ç«¯å‘é€ <code>ACK</code> æŠ¥æ–‡ç»™æœåŠ¡ç«¯ï¼Œå¦‚å›¾ï¼š<br><img src="/upload/images/2018/12/16/4.jpg"></p><p><strong>ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹</strong>ï¼Œå®¢æˆ·ç«¯å‘é€ <code>FIN</code> å’Œ <code>ACK</code> æŠ¥æ–‡ç»™æœåŠ¡ç«¯ï¼Œå¦‚å›¾ï¼š<br><img src="/upload/images/2018/12/16/5.jpg"></p><p><strong>ç¬¬å››æ¬¡æŒ¥æ‰‹</strong>ï¼ŒæœåŠ¡ç«¯å‘é€ <code>ACK</code> æŠ¥æ–‡ç»™å®¢æˆ·ç«¯ï¼Œå¦‚å›¾ï¼š<br><img src="/upload/images/2018/12/16/6.jpg"></p><p>ä»å›¾ä¸­æŠ“åŒ…æ¥çœ‹ï¼Œ<strong>seq</strong> å’Œ <strong>ack</strong> çš„å€¼å˜åŒ–å¦‚ä¸‹è¡¨ï¼š</p><table><thead><tr><th>æ¬¡æ•°</th><th>seq å€¼</th><th>ack å€¼</th></tr></thead><tbody><tr><td>1</td><td>140</td><td>447</td></tr><tr><td>2</td><td>447</td><td>141</td></tr><tr><td>3</td><td>447</td><td>141</td></tr><tr><td>4</td><td>141</td><td>448</td></tr></tbody></table><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>ç»“åˆä¸Šé¢æŠ“åŒ…çš„ç¤ºä¾‹ï¼Œå°ç»“ä¸€ä¸‹å››æ¬¡æŒ¥æ‰‹çš„è¿‡ç¨‹ã€‚</p><p>åœ¨å‰é¢è¯´è¿‡ï¼Œæ–­å¼€è¿æ¥ç«¯å¯ä»¥æ˜¯ <code>Client</code> ç«¯ï¼Œä¹Ÿå¯ä»¥æ˜¯ <code>Server</code> ç«¯ï¼Œæˆ‘ä¸Šé¢çš„ä¾‹å­é¦–å…ˆå‘èµ· <code>close</code> çš„ä¸€æ–¹æ˜¯ <code>Server</code> ç«¯ã€‚</p><p><strong>ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼š</strong><br>æœåŠ¡ç«¯å‘é€ä¸€ä¸ª <code>[FIN+ACK]</code> æŠ¥æ–‡ï¼Œè¡¨ç¤ºè‡ªå·±æ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œæƒ³æ–­å¼€è¿æ¥ï¼Œå¹¶è¿›å…¥ <code>fin_wait_1</code> çŠ¶æ€ï¼ˆä¸èƒ½å†å‘é€æ•°æ®åˆ°å®¢æˆ·ç«¯ï¼Œä½†èƒ½å¤Ÿå‘é€æ§åˆ¶ä¿¡æ¯ <code>ACK</code> åˆ°å®¢æˆ·ç«¯ï¼‰ã€‚</p><p><strong>ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼š</strong><br>å®¢æˆ·ç«¯æ”¶åˆ° <code>[FIN]</code> æŠ¥æ–‡åï¼Œå®¢æˆ·ç«¯çŸ¥é“ä¸ä¼šå†æœ‰æ•°æ®ä»æœåŠ¡ç«¯ä¼ æ¥ï¼Œå‘é€ <code>ACK</code> è¿›è¡Œç¡®è®¤ï¼Œå®¢æˆ·ç«¯è¿›å…¥ <code>close_wait</code> çŠ¶æ€ã€‚æ­¤æ—¶æœåŠ¡ç«¯æ”¶åˆ°äº†å®¢æˆ·ç«¯å¯¹ <code>FIN</code> çš„ <code>ACK</code> åï¼Œè¿›å…¥ <code>fin_wait2</code> çŠ¶æ€ã€‚</p><p><strong>ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼š</strong><br>å®¢æˆ·ç«¯å‘é€ <code>[FIN ACK]</code> æŠ¥æ–‡ç»™å¯¹æ–¹ï¼Œè¡¨ç¤ºè‡ªå·±æ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œå®¢æˆ·ç«¯è¿›å…¥ <code>last_ack</code> çŠ¶æ€ã€‚æœåŠ¡ç«¯æ”¶åˆ°äº†å®¢æˆ·ç«¯çš„ <code>FIN</code> ä¿¡ä»¤åï¼Œè¿›å…¥ <code>time_wait</code> çŠ¶æ€ï¼Œå¹¶å‘é€ <code>ACK</code> ç¡®è®¤æ¶ˆæ¯ã€‚</p><p><strong>ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼š</strong><br>æœåŠ¡ç«¯åœ¨ <code>time_wait</code> çŠ¶æ€ä¸‹ï¼Œç­‰å¾… 2MSL(MSLæ˜¯æ•°æ®åˆ†èŠ‚åœ¨ç½‘ç»œä¸­å­˜æ´»çš„æœ€é•¿æ—¶é—´) ä¸€æ®µæ—¶é—´ï¼Œæ²¡æœ‰æ•°æ®åˆ°æ¥çš„ï¼Œå°±è®¤ä¸ºå¯¹é¢å·²ç»æ”¶åˆ°äº†è‡ªå·±å‘é€çš„ <code>ACK</code> å¹¶æ­£ç¡®å…³é—­äº†è¿›å…¥ <code>close</code> çŠ¶æ€ï¼Œè‡ªå·±ä¹Ÿæ–­å¼€äº†åˆ°å®¢æˆ·ç«¯çš„ <code>TCP</code> è¿æ¥ï¼Œé‡Šæ”¾æ‰€æœ‰èµ„æºã€‚å½“å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„<code>ACK</code> å›åº”åï¼Œä¼šè¿›å…¥ <code>close</code> çŠ¶æ€ï¼Œå¹¶å…³é—­æœ¬ç«¯çš„ä¼šè¯æ¥å£ï¼Œé‡Šæ”¾ç›¸åº”èµ„æºã€‚</p><p>æ ¹æ® wireshark æŠ“åŒ…å’Œä¸Šé¢æµç¨‹çš„åˆ†æï¼Œå¯ä»¥ç”»å‡ºå¦‚ä¸‹ç¤ºæ„æµç¨‹å›¾ï¼š<br><img src="/upload/images/2018/12/16/7.jpg"></p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œåè®® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Wireshark tcp ip http </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å½“ NTFS é‡ä¸Š MacOS</title>
      <link href="/2018/11/24/%E5%BD%93-NTFS-%E9%81%87%E4%B8%8A-MacOS/"/>
      <url>/2018/11/24/%E5%BD%93-NTFS-%E9%81%87%E4%B8%8A-MacOS/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>è‡ªå·±ä½¿ç”¨çš„ <code>MacBook Pro</code> ç”µè„‘æ˜¯ <code>256G</code> çš„ï¼Œè¿™ä¸ªæœ¬é™ªäº†æˆ‘5ä¸ªæ˜¥ç§‹ï¼Œæ€§èƒ½ä¾æ—§å¼ºåŠ²ï¼Œä¸€ç›´èˆä¸å¾—æŠ›å¼ƒæ¢æ–°(å¥½å§ï¼Œæˆ‘æ‰¿è®¤è‡ªå·±ç©·)ã€‚</p><p>ç”±äºå·¥ä½œéœ€è¦ï¼Œé‡Œé¢å®‰è£…äº†ä¸å°‘è½¯ä»¶ï¼Œä¹Ÿå­˜å‚¨äº†ä¸å°‘èµ„æ–™ï¼Œé€æ¸å‘ç°ç¡¬ç›˜å®¹é‡ä¸è¶³ï¼Œæˆ‘ä¹Ÿä¸€ç›´åœ¨åˆ é™¤ä¸€äº›éå¿…è¦çš„ä¸œè¥¿ï¼Œå‘ç°è¿˜æ˜¯æ¯æ°´è½¦è–ªï¼Œæ²¡åŠæ³•ï¼Œåˆä¹°äº†ä¸€å—ç§»åŠ¨ç¡¬ç›˜ï¼Œç½‘ç›˜ç”¨èµ·æ¥è¿˜æ˜¯æ²¡æœ‰ç¡¬ç›˜æ–¹ä¾¿ï¼Œæˆ‘ä½¿ç”¨ç½‘ç›˜çš„é¢‘ç‡å¾ˆä½ã€‚</p><h2 id="MacOS-æŒ‚è½½"><a href="#MacOS-æŒ‚è½½" class="headerlink" title="MacOS æŒ‚è½½"></a>MacOS æŒ‚è½½</h2><p>æˆ‘è§‰å¾—ç§»åŠ¨ç¡¬ç›˜ä¹°å›æ¥ï¼Œç›´æ¥æ’åœ¨ç”µè„‘ä¸Šå°±å¯ä»¥ä½¿ç”¨äº†ï¼Œæœ€åå‘ç°ç¡¬ç›˜åªèƒ½è¯»ä¸èƒ½å†™ï¼Œå§æ§½ï¼</p><p>ä¸Šç½‘æŸ¥äº†ä¸€ä¸‹ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>NTFS</code> æ ¼å¼çš„ç¡¬ç›˜æ’å…¥åˆ° <code>MacOS</code> é‡Œï¼Œæ˜¯åªèƒ½è¯»ä¸èƒ½å†™çš„ï¼Œéœ€è¦æŒ‚è½½ã€‚</p><p>äºæ˜¯ç»“åˆç½‘ä¸Šå‰è¾ˆçš„ç»éªŒï¼Œå¼„äº†ä¸€ä¸ª <code>shell</code> è„šæœ¬ï¼Œç”¨äº†ä¸€æ®µæ—¶é—´ï¼Œå‘ç°æŒºå¥½ç”¨çš„ï¼Œä½†æ˜¯ç”µè„‘é‡å¯åï¼Œè„šæœ¬å°±éœ€è¦ä¿®æ”¹ï¼Œè¿˜è¦æŸ¥æ‰¾å½“å‰ç¡¬ç›˜åˆ°åº•åœ¨ <code>disk0</code> è¿˜æ˜¯åœ¨ <code>disk2</code> ä¸Šé¢ï¼Œéº»çƒ¦ã€‚</p><p>è¿˜å¥½æœ‰ä¸€äº›æ¯”è¾ƒæˆç†Ÿçš„å·¥å…·å¸®æˆ‘ä»¬è§£å†³é—®é¢˜ï¼Œ<a href="http://www.ntfsformac.cn/">Paragon NTFS for MAC</a> å°±æ˜¯å…¶ä¸­ä¸€ä¸ªã€‚</p><p><img src="/upload/images/2018/11/24/1.jpg"></p><p>è¿™ä¸ªå·¥å…·æ˜¯æ”¶è´¹çš„ï¼Œæˆ‘è¯•ç”¨äº†ä¸€æ®µæ—¶é—´ï¼Œæ„Ÿè§‰åŠŸèƒ½æŒºå¼ºå¤§çš„ï¼Œå› ä¸ºç©·ä¹Ÿæ‡’å¾—æŠ˜è…¾ç ´è§£ï¼Œå°±æ‰¾äº†å¦å¤–ä¸€ä¸ªå·¥å…· <a href="https://mounty.app/">mounty</a>ï¼Œå°å·§å¯çˆ±å…³é”®å…è´¹ï¼Œåœ¨å…¬ä¼—å·ä¸Šé¢æ”¶åˆ°çš„èµèµæˆ‘ä¹Ÿä¼š donate ç»™ä»–ä»¬ã€‚</p><p><img src="/upload/images/2018/11/24/2.jpg"></p><p><a href="https://mounty.app/">mounty</a> æœ€æ–°ç‰ˆæœ¬æ˜¯ 1.9ï¼Œä»‹ç»å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A tiny tool to re-mount write-protected NTFS volumes under Mac OS X 10.9+ in read-write mode.</span><br></pre></td></tr></table></figure><h2 id="mounty-å¤±æ•ˆ"><a href="#mounty-å¤±æ•ˆ" class="headerlink" title="mounty å¤±æ•ˆ"></a>mounty å¤±æ•ˆ</h2><p>åœ¨ä½¿ç”¨ mounty æŒ‚è½½ç§»åŠ¨ç¡¬ç›˜æ—¶, å¼¹æ¡†æç¤ºä»¥ä¸‹é”™è¯¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">The volume My Passport is not re-mountable in read/write mode.</span><br><span class="line">Probably it was not clean unmounted before.</span><br></pre></td></tr></table></figure><p>è¿™ç§é”™è¯¯çš„åŸå› å¤§éƒ¨åˆ†æ˜¯å› ä¸ºåœ¨ <code>Windows</code> ä¸Šé¢ä½¿ç”¨åæ²¡æœ‰å®‰å…¨é€€å‡º(ç›´æ¥æ‹¨å‡º)è€Œé€ æˆçš„ï¼Œç½‘ä¸Šæœ‰ä¸¤ç§æ–¹æ¡ˆï¼Œåˆ†åˆ«å¦‚ä¸‹ï¼š</p><p><strong>æ–¹æ¡ˆ 1</strong></p><ol><li>æ’å…¥ç§»åŠ¨ç¡¬ç›˜åˆ° <code>Windows</code> ä¸‹é¢</li><li>æ‰“å¼€ <code>dos</code> å‘½ä»¤è¡Œï¼Œè¾“å…¥ <code>chkdsk /f</code>, ç„¶åå›è½¦ï¼Œè¾“å…¥ <code>Y</code></li><li>ä½¿ç”¨å³ä¸‹è§’çš„å®‰å…¨åˆ é™¤åå†æ‹”å‡ºç§»åŠ¨ç¡¬ç›˜</li><li>å°†ç§»åŠ¨ç¡¬ç›˜å†æ¬¡æ’å…¥ <code>Mac</code> æ‰“å¼€ <code>mounty</code>é‡æ–°æŒ‚è½½å°±å¯ä»¥äº†</li></ol><p>åæ­£è¿™ç§æ–¹æ¡ˆæˆ‘æ˜¯æ²¡æœ‰æˆåŠŸï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2018/11/24/3.jpg"></p><p><strong>æ–¹æ¡ˆ 2</strong></p><p>åœ¨ <code>Windows</code> ç³»ç»Ÿä¸­ï¼Œå°†ç§»åŠ¨ç¡¬ç›˜æ’å…¥ï¼Œä½¿ç”¨ <code>360è½¯ä»¶</code> ç‚¹å‡» <code>å®‰å…¨é€€å‡º</code> é€€å‡ºç¡¬ç›˜ï¼Œä¸è¦ç›´æ¥æ‹”æ‰ï¼Œå†åœ¨ <code>Mac</code> ä¸­æ’å…¥ä½¿ç”¨ <code>mounty</code> é‡æ–°æŒ‚è½½å°±è§£å†³é—®é¢˜äº†ã€‚</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼ŒæœŸå¾…ä¸ä½ çš„äº¤æµ~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> MacOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NTFS MacOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§‚å¯Ÿè€…æ¨¡å¼</title>
      <link href="/2018/10/28/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
      <url>/2018/10/28/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>ç»„ä»¶é—´é€šä¿¡ï¼Œæˆ‘ä¼šä¼˜å…ˆä½¿ç”¨è·¯ç”±çš„é€šä¿¡æ–¹å¼(iOSä¸­éœ€è¦ç”¨åˆ° runtimeï¼ŒAndroid ä¸­éœ€è¦ç”¨åˆ°åå°„å’Œæ³¨è§£)ï¼Œç»„ä»¶ä¹‹é—´æŒ‰ç…§è·¯ç”±åè®®(ç±»ä¼¼ url)å®ç°å„è‡ªçš„èŒè´£å³å¯ï¼Œç»„ä»¶é—´çš„æ¾è€¦åˆæ€§å¢å¼ºäº†è½¯ä»¶è®¾è®¡çš„å¼¹æ€§å’Œé«˜å¯ç”¨æ€§ã€‚</p><p>è·¯ç”±ç»“åˆè§‚å¯Ÿè€…æ¨¡å¼ï¼Œå¯ä»¥è®©ä½ çš„ç»„ä»¶è®¾è®¡æ›´ä¸Šä¸€å±‚æ¥¼ã€‚è·¯ç”±å¯ä»¥è§£å†³å•å‘è°ƒç”¨çš„é—®é¢˜ï¼Œè®©ç»„ä»¶ä¹‹é—´æ— éœ€çŸ¥é“å¯¹æ–¹æ˜¯å¦å­˜åœ¨ã€‚è§‚å¯Ÿè€…æ¨¡å¼å¯ä»¥è®©è°ƒç”¨è€…(ä½¿ç”¨ä½ æ¡†æ¶çš„)å¯ä»¥å¾ˆæ–¹ä¾¿çš„çŸ¥é“ç»„ä»¶çš„å†…éƒ¨äº‹ä»¶ã€‚</p><blockquote><p>æ­¦æ—è‡³å°Šï¼Œå®åˆ€å± é¾™ï¼Œå·ä»¤å¤©ä¸‹ï¼Œè«æ•¢ä¸ä»ï¼Œå€šå¤©ä¸å‡ºï¼Œè°ä¸äº‰é”‹?</p></blockquote><p>åœ¨è¯´è§‚å¯Ÿè€…æ¨¡å¼ä¹‹å‰ï¼Œå…ˆä»‹ç»ä¸€ä¸‹ iOS ä¸­çš„ä»£ç†(delegate).</p><h2 id="ä»£ç†-delegate"><a href="#ä»£ç†-delegate" class="headerlink" title="ä»£ç† delegate"></a>ä»£ç† delegate</h2><p>åœ¨ iOS ä¸­ï¼Œä»£ç†(delegate)çš„æœ¬è´¨æ˜¯ protocolï¼Œç±»ä¼¼ java ä¸­çš„ Interfaceï¼Œä¸€èˆ¬ç”¨æ¥å¤„ç† <code>ä¸€å¯¹ä¸€</code> çš„å…³ç³»ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2018/10/28/1.jpg"></p><p>ä¸‹é¢çš„ä¾‹å­æ¨¡æ‹Ÿäº†è°ƒç”¨å’Œå®ç°è¿‡ç¨‹ï¼Œä½¿ç”¨ <code>Bank</code> å¯¹è±¡å’Œ <code>BankDelegate</code> ä»£ç†æ¥æ¨¡æ‹Ÿè¿™ç§æ¨¡å¼ã€‚<code>Bank</code> æœ‰å˜åŠ¨çš„æ—¶å€™ï¼Œé€šè¿‡ <code>notifyAccount</code> æ¥æˆæƒ <code>onAccountChanged</code> é€šçŸ¥ç”¨æˆ·ã€‚</p><p><strong>BankDelegate.h</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">BankDelegate</span> &lt;<span class="title">NSObject</span>&gt;</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)onAccountChanged:(<span class="built_in">NSUInteger</span>)account;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p><strong>Bank.h</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Bank</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">weak</span>) <span class="keyword">id</span>&lt;BankDelegate&gt; delegate;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)notifyAccount;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p><strong>Bank.m</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Bank</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)notifyAccount</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span>.delegate respondsToSelector:<span class="keyword">@selector</span>(onAccountChanged:)]) &#123;</span><br><span class="line">        [<span class="keyword">self</span>.delegate onAccountChanged:<span class="number">100</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨è€…å®ç° delegate</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line"></span><br><span class="line">    Bank *bank = [Bank new];</span><br><span class="line">    bank.delegate = <span class="keyword">self</span>;</span><br><span class="line">    [bank notifyAccount];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)onAccountChanged:(<span class="built_in">NSUInteger</span>)account</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;Bank tell me that account is changed. %zd&quot;</span>, account);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œdelegate ä¹Ÿå¯ä»¥åšåˆ° <code>ä¸€å¯¹å¤š</code>ï¼Œæ”¹é€ ä¸€ä¸‹ <code>Bank</code> å°±å¯ä»¥å®ç°ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Bank</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)addBankDelegate:(<span class="keyword">id</span>&lt;BankDelegate&gt;)delegate;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)notifyAccount;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p><code>Bank</code> å†…éƒ¨ä½¿ç”¨æ•°ç»„å°† <code>addBankDelegate</code> å¾—åˆ°çš„ <code>delegate</code> å­˜èµ·æ¥ï¼Œ<code>notifyAccount</code> ä¸­å°±å¯ä»¥è¿›è¡Œé€šçŸ¥äº†ã€‚</p><figure class="highlight obj-c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Bank *bank = [Bank new];</span><br><span class="line"><span class="comment">// æ¨¡æ‹Ÿæ·»åŠ å¤šä¸ª delegate</span></span><br><span class="line">[bank addBankDelegate:<span class="keyword">self</span>];</span><br><span class="line">[bank addBankDelegate:<span class="keyword">self</span>];</span><br><span class="line">[bank notifyAccount];</span><br></pre></td></tr></table></figure><h2 id="è§‚å¯Ÿè€…æ¨¡å¼"><a href="#è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="è§‚å¯Ÿè€…æ¨¡å¼"></a>è§‚å¯Ÿè€…æ¨¡å¼</h2><p>ç†è§£äº† delegateï¼Œè§‚å¯Ÿè€…æ¨¡å¼å°±å¾ˆå¥½ç†è§£äº†ã€‚</p><p>å½“ä¸€ä¸ªå¯¹è±¡æ”¹å˜çŠ¶æ€æ—¶ï¼Œå®ƒçš„æ‰€æœ‰ä¾èµ–ç€éƒ½ä¼šæ”¶åˆ°é€šçŸ¥å¹¶è‡ªåŠ¨æ›´æ–°ï¼Œè¿™æ˜¯è§‚å¯Ÿè€…æ¨¡å¼çš„å¸¸è§„å®šä¹‰ã€‚</p><p>è§‚å¯Ÿè€…æ¨¡å¼æ˜¯ä¸€ç§ <code>ä¸€å¯¹å¤š</code> çš„è®¾è®¡æ¨¡å¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/10/28/2.jpg"></p><p>ç»§ç»­ä¸Šé¢çš„ä¾‹å­ï¼Œä½¿ç”¨ <code>Bank</code> å¯¹è±¡å’Œ <code>BankDelegate</code> æ¥æ¨¡æ‹Ÿè¿™ç§æ¨¡å¼ï¼Œ<code>Bank</code> æœ‰å˜åŠ¨çš„æ—¶å€™ï¼Œé€šè¿‡ <code>notifyAccount</code> æ¥æˆæƒ <code>onAccountChanged</code> é€šçŸ¥æ‰€æœ‰æ³¨å†Œäº† <code>BankDelegate</code> çš„ç”¨æˆ·ã€‚</p><p><strong>Talk is cheap. Show me the code</strong></p><p><strong>BankDelegate.h</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">BankDelegate</span> &lt;<span class="title">NSObject</span>&gt;</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)onAccountChanged:(<span class="built_in">NSUInteger</span>)account;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p><strong>Bank.h</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Bank</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)addBankObserver:(<span class="keyword">id</span>&lt;BankDelegate&gt;)delegate;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)removeBankObserver:(<span class="keyword">id</span>&lt;BankDelegate&gt;)delegate;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)notifyAccount;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p><strong>Bank.m</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)notifyAccount</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">id</span>&lt;BankDelegate&gt; delegate <span class="keyword">in</span> <span class="keyword">self</span>.delegates) &#123;</span><br><span class="line">        <span class="keyword">if</span> ([delegate respondsToSelector:<span class="keyword">@selector</span>(onAccountChanged:)]) &#123;</span><br><span class="line">            [delegate onAccountChanged:<span class="number">100</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)addBankObserver:(<span class="keyword">id</span>&lt;BankDelegate&gt;)delegate</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nil</span> == delegate) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="keyword">self</span>.delegates addObject:delegate];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)removeBankObserver:(<span class="keyword">id</span>&lt;BankDelegate&gt;)delegate</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.delegates.count &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        [<span class="keyword">self</span>.delegates removeObject:delegate];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è°ƒç”¨è€…</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> registerObserver];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)onAccountChanged:(<span class="built_in">NSUInteger</span>)account</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;Bank tell me that account is changed. %zd&quot;</span>, account);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)registerObserver</span><br><span class="line">&#123;</span><br><span class="line">    Bank *bank = [Bank new];</span><br><span class="line">    [bank addBankObserver:<span class="keyword">self</span>];</span><br><span class="line">    [bank addBankObserver:<span class="keyword">self</span>];</span><br><span class="line">    [bank notifyAccount];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°è¿™é‡Œï¼Œä½ åº”è¯¥å‘ç° delegate çš„è®¾è®¡å…¶å®å°±æ˜¯è§‚å¯Ÿè€…çš„ä¸€ç§è®¾è®¡æ‰‹æ®µè€Œå·²ï¼Œå®ƒæœ¬èº«ä¹Ÿæ˜¯è§‚å¯Ÿè€…æ¨¡å¼ã€‚</p><p>åœ¨ iOS ä¸­ï¼Œé™¤äº† delegateï¼Œè¿˜æœ‰å¾ˆå¤šè¿™ç§è®¾è®¡æ¨¡å¼çš„ä½“ç°ï¼Œå¦‚ KVOã€Notificationã€Observerã€Block ç­‰ã€‚</p><h2 id="å‘å¸ƒ-è®¢é˜…æ¨¡å¼"><a href="#å‘å¸ƒ-è®¢é˜…æ¨¡å¼" class="headerlink" title="å‘å¸ƒ-è®¢é˜…æ¨¡å¼"></a>å‘å¸ƒ-è®¢é˜…æ¨¡å¼</h2><p>è§‚å¯Ÿè€…æ¨¡å¼ä¸­è§‚å¯Ÿè€…å¯¹è¢«è§‚å¯Ÿè€…(Bank)æ˜¯æœ‰æ„ŸçŸ¥çš„ï¼Œè‡³å°‘éœ€è¦å®ç°å¯¹åº”çš„ <code>BankDelegate</code>ï¼ŒäºŒè€…ä¹‹é—´è¿˜æ˜¯æ˜¯æœ‰ä¸€å®šçš„è€¦åˆåº¦ã€‚</p><p>é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰ä¸€ç§æ–¹æ³•å†æ¥é™ä½è¿™ç§è€¦åˆï¼Œè®©åŒæ–¹éƒ½ä¸ç”¨å»å…³å¿ƒå¯¹æ–¹çš„å­˜åœ¨å‘¢ï¼Ÿå‘å¸ƒ-è®¢é˜…æ¨¡å¼æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚</p><p>å‘å¸ƒ-è®¢é˜…æœ¬è´¨ä¹Ÿæ˜¯è§‚å¯Ÿè€…æ¨¡å¼ï¼Œä½†æ˜¯ä»–æ›´åŠ çš„æ¾è€¦åˆï¼Œå‘å¸ƒè€…å’Œè®¢é˜…è€…éƒ½ä¸ç”¨æ¸…æ¥šå¯¹æ–¹ï¼Œå…¨éƒ¨ç”±è®¢é˜…ä¸­å¿ƒåšå¤„ç†ï¼Œè¿™æ ·è€¦åˆåº¦å°±å‡ ä¹æ²¡æœ‰äº†ã€‚</p><p>å¦‚å›¾å±•ç¤ºå‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼š<br><img src="/upload/images/2018/10/28/3.jpg"></p><p>åœ¨ iOS ä¸­ï¼ŒNotification å°±æ˜¯å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„ä¸€ç§å®ç°ï¼ŒNSNotificationCenter å°±ç±»ä¼¼è®¢é˜…ä¸­å¿ƒã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‘å¸ƒ</span></span><br><span class="line">[[<span class="built_in">NSNotificationCenter</span> defaultCenter] postNotificationName:<span class="string">@&quot;name_protocol&quot;</span> object:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¢é˜…</span></span><br><span class="line">[[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span></span><br><span class="line">                                         selector:<span class="keyword">@selector</span>(onUpdate:)</span><br><span class="line">                                             name:<span class="string">@&quot;name_protocol&quot;</span></span><br><span class="line">                                           object:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure><h2 id="äº‰è®º"><a href="#äº‰è®º" class="headerlink" title="äº‰è®º"></a>äº‰è®º</h2><p>ç½‘ä¸Šæœ‰å¾ˆå¤šäººè¯´ï¼Œè§‚å¯Ÿè€…æ¨¡å¼å’Œå‘å¸ƒ-è®¢é˜…æ¨¡å¼æ˜¯ä¸¤ç§ä¸åŒçš„è®¾è®¡æ¨¡å¼ï¼Œå®ƒä»¬å‹æ ¹å°±æ˜¯ä¸¤ç äº‹ï¼Œä¸èƒ½æ··ä¸ºä¸€è°ˆã€‚ä¹Ÿæœ‰å¾ˆå¤šäººè¯´ï¼Œä¸¤è€…å…¶å®éƒ½æ˜¯è§‚å¯Ÿè€…æ¨¡å¼ï¼Œåªæ˜¯å®ç°æ‰‹æ®µæœ‰ç‚¹ä¸ä¸€æ ·ç½¢äº†ï¼Œæœ¬è´¨æ˜¯ä¸€æ ·çš„ã€‚</p><p>æ±Ÿæ¹–çº·äº‰ï¼Œä¼—è¯´çº·çº­ï¼</p><p>è®¾è®¡æ¨¡å¼æ˜¯ä¸€ç§è®¾è®¡æ€æƒ³ï¼Œåœ¨è§‚å¯Ÿè€…æ¨¡å¼åŸºç¡€ä¸Šä½ å¯ä»¥è¡ç”Ÿæ›´å¤šçš„è®¾è®¡æ¨¡å¼å’Œæ›´å¤šçš„è®¾è®¡æ€æƒ³ã€‚æ¨¡å¼çš„å®ç°æ‰‹æ®µå¯ä»¥å¤šæ ·åŒ–ï¼Œæ²¡æœ‰æœ€å¥½åªæœ‰æ›´å¥½ï¼Œå°±å¥½æ¯” MVCã€MVPã€MVVM ç­‰ï¼Œä½ è¯´å®ƒä»¬æ˜¯è®¾è®¡æ¨¡å¼ä¹Ÿå¥½ï¼Œæ˜¯è®¾è®¡æ€è·¯ä¹Ÿç½¢ï¼Œå…³é”®æ˜¯åˆ©ç”¨å®ƒä»¬æœ‰æ²¡æœ‰è§£å†³ä¸šåŠ¡éœ€æ±‚ï¼Œä¸ºäº†æ¨¡å¼è€Œæ¨¡å¼çš„è®¾è®¡åè€Œä¸å®ï¼</p><p>ä¸ªäººè§‰å¾—ï¼Œå‘å¸ƒ-è®¢é˜…æ¨¡å¼åªæ˜¯è§‚å¯Ÿè€…æ¨¡å¼çš„ä¸€ç§å®ç°æ‰‹æ®µï¼Œå®ƒæœ¬è´¨è¿˜æ˜¯è§‚å¯Ÿè€…æ¨¡å¼ã€‚</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼ŒæœŸå¾…ä¸ä½ çš„äº¤æµ~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Philosophy </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„ æ¨¡å—åŒ– ç»„ä»¶åŒ– Observer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>macOS ä¸­ç¥ç§˜çš„ GCC</title>
      <link href="/2018/10/13/macOS-%E4%B8%AD%E7%A5%9E%E7%A7%98%E7%9A%84-GCC/"/>
      <url>/2018/10/13/macOS-%E4%B8%AD%E7%A5%9E%E7%A7%98%E7%9A%84-GCC/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><hr><p>è¿™ä¸ªäº‹æƒ…ï¼Œè¦ä»ç¼–è¯‘ä¸€ä¸ªç®€å•çš„ä»£ç å¼€å§‹è¯´èµ·ã€‚</p><h2 id="gcc-å’Œ-g-çš„åŒºåˆ«"><a href="#gcc-å’Œ-g-çš„åŒºåˆ«" class="headerlink" title="gcc å’Œ g++ çš„åŒºåˆ«"></a>gcc å’Œ g++ çš„åŒºåˆ«</h2><p><code>gcc</code> æ˜¯ GCC ä¸­çš„ GUN C Compilerï¼ŒC ç¼–è¯‘å™¨ã€‚</p><p><code>g++</code> æ˜¯ GCC ä¸­çš„ GUN C++ Compilerï¼ŒC++ç¼–è¯‘å™¨ã€‚</p><p>å°±æœ¬è´¨è€Œè¨€ï¼Œ<code>gcc</code> å’Œ <code>g++</code> å¹¶ä¸æ˜¯ç¼–è¯‘å™¨ï¼Œä¹Ÿä¸æ˜¯ç¼–è¯‘å™¨çš„é›†åˆï¼Œå®ƒä»¬åªæ˜¯ä¸€ç§é©±åŠ¨å™¨ï¼Œæ ¹æ®å‚æ•°ä¸­è¦ç¼–è¯‘çš„æ–‡ä»¶çš„ç±»å‹ï¼Œè°ƒç”¨å¯¹åº”çš„ GUN ç¼–è¯‘å™¨è€Œå·²ã€‚</p><p><code>gcc</code> ä¸ <code>g++</code> éƒ½å¯ä»¥ç¼–è¯‘ C å’Œ C++ æ–‡ä»¶ï¼Œåªæ˜¯å¤„ç†æ–¹å¼ä¸åŒã€‚ å¯ä»¥å‚è€ƒ <a href="https://www.cnblogs.com/wb118115/p/5969775.html">GCCçš„gccå’Œg++åŒºåˆ«</a> è¿™ç¯‡æ–‡ç« ã€‚</p><h2 id="äº¤æ¢å˜é‡ï¼šç”¨æŒ‡é’ˆ"><a href="#äº¤æ¢å˜é‡ï¼šç”¨æŒ‡é’ˆ" class="headerlink" title="äº¤æ¢å˜é‡ï¼šç”¨æŒ‡é’ˆ"></a>äº¤æ¢å˜é‡ï¼šç”¨æŒ‡é’ˆ</h2><p>ä¸‹é¢è¿™æ®µä»£ç å¾ˆç®€å•ï¼Œåˆ©ç”¨ C æŒ‡é’ˆå®ç°äº¤æ¢ä¸¤ä¸ªå˜é‡çš„ç›®çš„ã€‚</p><p><strong>æºæ–‡ä»¶ï¼šmz_swap.c</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨æŒ‡é’ˆçš„æ–¹å¼äº¤æ¢ä¸¤ä¸ªå˜é‡</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">mz_swap</span><span class="params">(<span class="type">int</span> *ap, <span class="type">int</span> *bp)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> * argv[])</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> xp = <span class="number">901</span>;</span><br><span class="line"><span class="type">int</span> yp = <span class="number">902</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;--Before-- xp = %i, yp = %i\n&quot;</span>, xp, yp);</span><br><span class="line"></span><br><span class="line">mz_swap(&amp;xp, &amp;yp);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;--After--- xp = %i, yp = %i\n&quot;</span>, xp, yp);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">mz_swap</span><span class="params">(<span class="type">int</span> *ap, <span class="type">int</span> *bp)</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="literal">NULL</span> == ap || <span class="literal">NULL</span> == bp) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> tp = *ap;</span><br><span class="line"></span><br><span class="line">*ap = *bp;</span><br><span class="line"></span><br><span class="line">*bp = tp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ macOS ä¸‹ä½¿ç”¨ <code>gcc</code> ç¼–è¯‘ <code>mz_swap.c</code>ï¼Œäº§ç”Ÿå¯æ‰§è¡Œæ–‡ä»¶ <code>exec_main.out</code>ï¼Œå¦‚ä¸‹æ“ä½œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc mz_swap.c -o exec_main.out</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘æˆåŠŸï¼Œæ‰§è¡Œ <code>./exec_main.out</code>ï¼Œæ­£å¸¸è¾“å‡ºç»“æœï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--Before-- xp = <span class="number">901</span>, yp = <span class="number">902</span></span><br><span class="line">--After--- xp = <span class="number">902</span>, yp = <span class="number">901</span></span><br></pre></td></tr></table></figure><p>é‡‡ç”¨ g++ æ¥ç¼–è¯‘ï¼Œå¦‚ä¸‹æ“ä½œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g++ mz_swap.c -o exec_main.out</span><br></pre></td></tr></table></figure><p>æŠ¥å‡ºå¦‚ä¸‹è­¦å‘Šï¼Œè¯¥è­¦å‘Šçš„æ„æ€æ˜¯åœ¨ C++ æ¨¡å¼ä¸‹å¼ºåˆ¶ç¼–è¯‘ C æ–‡ä»¶ï¼Œè¿™é‡Œå¯ä»¥ä¸äºˆç†ä¼šã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clang: warning: treating <span class="string">&#x27;c&#x27;</span> input as <span class="string">&#x27;c++&#x27;</span> when in C++ mode, this behavior is deprecated [-Wdeprecated]</span><br></pre></td></tr></table></figure><p>è™½ç„¶æœ‰è­¦å‘Šï¼Œä½†æ˜¯ç¼–è¯‘å¯ä»¥äº§ç”Ÿå¯æ‰§è¡Œæ–‡ä»¶ <code>exec_main.out</code> ä¸”å¯ä»¥æ­£å¸¸æ‰§è¡Œçš„ï¼Œæ‰§è¡Œç»“æœè·Ÿä¸Šé¢ä¸€æ ·ã€‚</p><h2 id="äº¤æ¢å˜é‡ï¼šç”¨å¼•ç”¨"><a href="#äº¤æ¢å˜é‡ï¼šç”¨å¼•ç”¨" class="headerlink" title="äº¤æ¢å˜é‡ï¼šç”¨å¼•ç”¨"></a>äº¤æ¢å˜é‡ï¼šç”¨å¼•ç”¨</h2><p>å¤§å®¶éƒ½çŸ¥é“ï¼ŒC æ²¡æœ‰ <code>å¼•ç”¨</code> è¿™ä¸ªæ¦‚å¿µï¼Œè€Œ C++ æ˜¯æœ‰ <code>å¼•ç”¨</code> æ¦‚å¿µçš„ï¼Œå¯ä»¥åœ¨æ­¤äº†è§£ <a href="http://www.runoob.com/cplusplus/cpp-references.html">C++ å¼•ç”¨</a>.</p><p>è¯•ä¸€ä¸‹ä½¿ç”¨ <code>gcc</code> ç¼–è¯‘ä½¿ç”¨ <code>å¼•ç”¨</code> æ–¹å¼ç¼–å†™çš„ C ä»£ç ï¼ŒæŒ‰ç…§è¯´æ³•ï¼Œ<code>gcc</code> æ˜¯æ— æ³•ç¼–è¯‘é€šè¿‡çš„ã€‚</p><p><strong>æºæ–‡ä»¶ï¼šmz_swap_ref.c</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨å¼•ç”¨çš„æ–¹å¼äº¤æ¢ä¸¤ä¸ªå˜é‡</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">mz_swap_ref</span><span class="params">(<span class="type">int</span> &amp;ap, <span class="type">int</span> &amp;bp)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> * argv[])</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> xp = <span class="number">901</span>;</span><br><span class="line"><span class="type">int</span> yp = <span class="number">902</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;--Before-- xp = %i, yp = %i\n&quot;</span>, xp, yp);</span><br><span class="line"></span><br><span class="line">mz_swap_ref(xp, yp);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;--After--- xp = %i, yp = %i\n&quot;</span>, xp, yp);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">mz_swap_ref</span><span class="params">(<span class="type">int</span> &amp;ap, <span class="type">int</span> &amp;bp)</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> tp = ap;</span><br><span class="line"></span><br><span class="line">ap = bp;</span><br><span class="line"></span><br><span class="line">bp = tp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc mz_swap_ref.c -o exec_main.out</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å¤±è´¥ï¼Œé”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mz_swap_ref.c:<span class="number">4</span>:<span class="number">21</span>: error: expected <span class="string">&#x27;)&#x27;</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">mz_swap_ref</span><span class="params">(<span class="type">int</span> &amp;ap, <span class="type">int</span> &amp;bp)</span>;</span><br><span class="line">                    ^</span><br><span class="line">mz_swap_ref.c:<span class="number">4</span>:<span class="number">16</span>: note: to match this <span class="string">&#x27;(&#x27;</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">mz_swap_ref</span><span class="params">(<span class="type">int</span> &amp;ap, <span class="type">int</span> &amp;bp)</span>;</span><br></pre></td></tr></table></figure><p>æ—¢ç„¶æŒ‰ç…§ C çš„ç¼–è¯‘æ–¹å¼ä¸è¡Œï¼Œé‚£å°±æ¢æˆ <code>g++</code> æ¥ç¼–è¯‘ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g++ mz_swap_ref.c -o exec_main.out</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘æˆåŠŸï¼Œæ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./exec_main.out </span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--Before-- xp = 901, yp = 902</span><br><span class="line">--After--- xp = 902, yp = 901</span><br></pre></td></tr></table></figure><p>å¤§å®¶å¯ä»¥è‡ªå·±åŠ¨æ‰‹è¯•è¯•ï¼Œä½¿ç”¨ clang æ¥ç¼–è¯‘ <code>mz_swap_ref.c</code> å’Œä½¿ç”¨ <code>gcc</code> æ¥ç¼–è¯‘éƒ½æ˜¯æŠ¥é”™ï¼Œä½¿ç”¨ <code>clang++</code> å’Œ <code>g++</code> ç¼–è¯‘éƒ½æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚</p><p>åœ¨åšå®¢ <a href="http://www.veryitman.com/2017/10/07/GCC-Homebrew-%E5%AE%89%E8%A3%85-GCC-%E5%92%8C-Binutils/">GCC: Homebrew å®‰è£… GCC å’Œ Binutils</a> ä¸­ï¼Œæˆ‘å·²ç»åˆ†äº«äº†åœ¨ macOS ä¸­çš„ <code>gcc</code> å’Œ <code>g++</code> ä¸æ˜¯ GNU æä¾›çš„ï¼Œè€Œæ˜¯ Apple è‡ªå·±çš„ clangã€‚</p><p>è¿™é‡Œè¦è¯´æ˜çš„æ˜¯å³ä½¿ä½¿ç”¨è‡ªå·±å®‰è£…çš„ gcc(<code>gcc-4.9</code>) æ¥ç¼–è¯‘ <code>mz_swap_ref.c</code> ä¹Ÿæ˜¯æ— æ³•ç¼–è¯‘é€šè¿‡çš„ï¼ŒéªŒè¯å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc-4.9 mz_swap_ref.c -o exec_main.out</span><br></pre></td></tr></table></figure><p>é”™è¯¯ä¿¡æ¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mz_swap_ref.c:4:21: error: expected &#x27;;&#x27;, &#x27;,&#x27; or &#x27;)&#x27; before &#x27;&amp;&#x27; token</span><br><span class="line"> int mz_swap_ref(int &amp;ap, int &amp;bp);</span><br><span class="line">                     ^</span><br><span class="line">mz_swap_ref.c:20:21: error: expected &#x27;;&#x27;, &#x27;,&#x27; or &#x27;)&#x27; before &#x27;&amp;&#x27; token</span><br><span class="line"> int mz_swap_ref(int &amp;ap, int &amp;bp) &#123;              ^</span><br></pre></td></tr></table></figure><h2 id="gccã€g-å’Œ-clang-çš„å…³ç³»"><a href="#gccã€g-å’Œ-clang-çš„å…³ç³»" class="headerlink" title="gccã€g++ å’Œ clang çš„å…³ç³»"></a>gccã€g++ å’Œ clang çš„å…³ç³»</h2><p>åœ¨ macOS ä¸­ï¼Œ<code>gcc</code> ä»¥æŸç§æ–¹å¼æŒ‡å‘ <code>llvm-gcc</code> ç¼–è¯‘å™¨ï¼Œ<code>g++</code> äº¦å¦‚æ­¤ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In Apple&#x27;s version of GCC, both cc and gcc are actually symbolic links to the llvm-gcc compiler. Similarly, c++ and g++ are links to llvm-g++.</span><br></pre></td></tr></table></figure><p><code>llvm-gcc</code> æ˜¯ c&#x2F;c++&#x2F;oc çš„ç¼–è¯‘å™¨ï¼Œç”¨äº† <code>gcc</code> å‰ç«¯å’Œå‘½ä»¤è¡Œç•Œé¢çš„ llvm.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">llvm-gcc is a C, C++, Objective-C and Objective-C++ compiler. llvm-g++ is a compiler driver for C++. llvm-gcc uses gcc front-end and gcc&#x27;s command line interface.</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ <code>llvm-gcc</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>which llvm-gcc</code> çœ‹ä¸€ä¸‹ <code>llvm-gcc</code> æ‰€åœ¨ä½ç½®æ˜¯ <code>/usr/bin/llvm-gcc</code>ï¼Œæ‰“å¼€ç›®å½•å¯ä»¥çœ‹å‡ºå…¶å®æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/10/13/1.jpg" alt="1"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -l /usr/bin/llvm-gcc</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/llvm-gcc -&gt; clang</span><br></pre></td></tr></table></figure><p>å®ƒä»¬æ˜¯ç»Ÿä¸€æŒ‡å‘ <code>clang</code> çš„ç¬¦å·é“¾æ¥ï¼Œå¯ä»¥çœ‹å…¶åŸå§‹æŒ‡å‘ï¼Œ<code>llvm-gcc</code> æŒ‡å‘ <code>clang</code>ï¼Œ<code>llvm-g++</code> æŒ‡å‘ <code>clang++</code>ã€‚</p><p>äºŒè€…éƒ½åœ¨ <code>/usr/bin/</code> ç›®å½•ä¸‹ï¼š<br><img src="/upload/images/2018/10/13/2.jpg" alt="1"></p><p>å…¶å®åœ¨ macOS ä¸­ <code>cc</code> ç¼–è¯‘å™¨ä¹ŸæŒ‡å‘ <code>clang</code>ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬è‡³å°‘å¯ä»¥å­¦åˆ°å¦‚ä¸‹å‡ ç‚¹çŸ¥è¯†ï¼š</p><p><strong>1ã€C è¯­è¨€è§„èŒƒä¸­æ²¡æœ‰ <code>å¼•ç”¨</code> çš„æ¦‚å¿µï¼Œä½¿ç”¨ C ç¼–è¯‘å™¨æ— æ³•ä½¿å…¶ç¼–è¯‘é€šè¿‡ï¼Œä½†æ˜¯ä½¿ç”¨ C++ ç¼–è¯‘å™¨æ˜¯å¯ä»¥ç¼–è¯‘é€šè¿‡çš„ã€‚è¿™æ˜¯å› ä¸ºå„è‡ªçš„ç¼–è¯‘å™¨æ˜¯éµå¾ªè¯­è¨€è§„èŒƒçš„ã€‚</strong></p><p><strong>2ã€macOS ä¸­çš„ <code>gcc</code> å’Œ <code>g++</code> è‹¹æœå¼€å‘è€…ä»¬å¹¶æ²¡æœ‰å»æ”¹é€ å’Œé‡å†™å®ƒä»¬ï¼Œåªæ˜¯åˆ†åˆ«æŒ‡å‘ <code>clang</code> å’Œ <code>clang++</code> ç¼–è¯‘å™¨ã€‚</strong></p><p><strong>3ã€å¦‚æœä¸æƒ³ä½¿ç”¨ macOS ä¸­çš„ <code>gcc</code> å’Œ <code>g++</code>ï¼Œå°±éœ€è¦è‡ªå·±é‡æ–°å®‰è£… GNU çš„ç¼–è¯‘å¥—ä»¶ï¼Œå®‰è£…å’Œä½¿ç”¨æ–¹æ³•å·²ç»åœ¨åšå®¢ä¸­æœ‰è¯´æ˜ã€‚</strong></p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gcc g++ clang clang++ cc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SVN æ£€å‡ºæ–‡ä»¶</title>
      <link href="/2018/10/06/SVN-%E6%A3%80%E5%87%BA%E6%96%87%E4%BB%B6/"/>
      <url>/2018/10/06/SVN-%E6%A3%80%E5%87%BA%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h2 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h2><p>å¯¹äºä¸€äº›å¤§å·¥ç¨‹, æ•´ä¸ª svn ä»“åº“æ–‡ä»¶è¿‡å¤§(åŠ¨è¾„å‡ åä¸ªGçš„éƒ½æœ‰)ï¼Œä¸æƒ³æŠŠæ•´ä¸ª checkout ä¸‹æ¥ï¼Œä½†æ˜¯åˆæƒ³ç»´æŒæ•´ä¸ªç›®å½•ç»“æ„ä»¥æ–¹ä¾¿åç»­ä½¿ç”¨ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ <code>Subversion1.5</code> ä¹‹åçš„ <code>--depth</code> å‚æ•°æ¥åª checkout éœ€è¦çš„å­ç›®å½•.</p><p>å¦‚æœåªæƒ³æŠŠ svn ä»“åº“é‡Œé¢æŸä¸ªæ–‡ä»¶ checkout åˆ°æœ¬åœ°, ä¸æƒ³ checkout æ•´ä¸ªç›®å½•, å¦‚ä½•æ“ä½œå‘¢?</p><h2 id="å®æ–½"><a href="#å®æ–½" class="headerlink" title="å®æ–½"></a>å®æ–½</h2><p>å‡è®¾éœ€è¦ checkout å‡ºæ¥çš„æ–‡ä»¶æ˜¯ <code>ReadMe.md</code>, å…¶ svn åœ°å€æ˜¯: <code>http://svn.xxx.com/path/ReadMe.md</code>ï¼Œå…¶ä¸Šçº§ç›®å½•çš„è¿œç¨‹åœ°å€æ˜¯ <code>http://svn.xxx.com/path</code>.</p><p><strong>æ³¨æ„</strong>ï¼šä»¥ä¸‹å‡ºç° <code>svn co</code> å°±æ˜¯ <code>svn checkout</code> çš„ç¼©å†™.</p><h3 id="æ–¹æ¡ˆä¸€"><a href="#æ–¹æ¡ˆä¸€" class="headerlink" title="æ–¹æ¡ˆä¸€"></a>æ–¹æ¡ˆä¸€</h3><p>å¤§éƒ¨åˆ†äººéƒ½ä¼šåœ¨ç¬¬ä¸€æ—¶é—´æƒ³åˆ°å¦‚ä¸‹çš„æ“ä½œ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">svn co http://svn.xxx.com/path/ReadMe.md</span><br></pre></td></tr></table></figure><p>å®é™…ä¸Šè¿™æ ·æ“ä½œä¼šæŠ¥é”™çš„, æŠ¥é”™ä¿¡æ¯å¤§æ¦‚æ„æ€æ˜¯ <code>ä¸å¯ä»¥ checkout ä¸€ä¸ªæ–‡ä»¶, åªèƒ½ checkout ç›®å½•</code>ã€‚</p><p>æ‰€ä»¥ï¼Œè¯¥æ–¹æ¡ˆä¸å¯è¡Œã€‚</p><h3 id="æ–¹æ¡ˆäºŒ"><a href="#æ–¹æ¡ˆäºŒ" class="headerlink" title="æ–¹æ¡ˆäºŒ"></a>æ–¹æ¡ˆäºŒ</h3><p><strong>ç¬¬ä¸€æ­¥: checkout ç›®å½•</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">svn co --depth=empty http://svn.xxx.com/path/ ./</span><br></pre></td></tr></table></figure><blockquote><p><code>./</code> è¡¨ç¤ºå½“å‰ç›®å½•ï¼Œ<code>--depth=empty</code> è¡¨ç¤ºæ£€å‡ºç©ºç›®å½•ã€‚</p></blockquote><p><strong>ç¬¬äºŒæ­¥: æ›´æ–°æ–‡ä»¶</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">svn up ReadMe.md </span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œç›´æ¥ svn up å°±å¯ä»¥å°†ä½ éœ€è¦çš„æ–‡ä»¶ checkout å‡ºæ¥äº†ã€‚</p></blockquote><p>ä¿®æ”¹æ–‡ä»¶å, ä¹Ÿå¯ä»¥ç›´æ¥æäº¤åˆ° svn ä»“åº“. ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">svn ci ReadMe.md -m &quot;update.&quot;</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ¡ˆä¸‰"><a href="#æ–¹æ¡ˆä¸‰" class="headerlink" title="æ–¹æ¡ˆä¸‰"></a>æ–¹æ¡ˆä¸‰</h3><p>ä½¿ç”¨ <code>svn export</code> å‘½ä»¤å°†æ–‡ä»¶å¯¼å‡ºï¼Œç„¶åå°† <code>svn import</code> å‘½ä»¤å¯¼å…¥æ–‡ä»¶åˆ° svn ä»“åº“ã€‚</p><p>ä¸€èˆ¬ä¸´æ—¶æƒ³ checkout ä¸€ä¸ªæ–‡ä»¶ï¼Œå°±ä¼šä½¿ç”¨ <code>æ–¹æ¡ˆä¸‰</code>, æ¯”è¾ƒæ­£å¼çš„æ“ä½œï¼Œæˆ‘ä¼šé€‰æ‹© <code>æ–¹æ¡ˆäºŒ</code>ï¼Œå› ä¸º <code>æ–¹æ¡ˆäºŒ</code> è¿™æ ·æ—¢å¯åœ¨ä¸å¢åŠ ç£ç›˜å¤§å°çš„æƒ…å†µä¸‹ä¿æŒ svn ä»“åº“çš„ç›®å½•ç»“æ„ï¼Œåˆå¯ä»¥ä»»æ„ checkout æ–‡ä»¶ã€‚</p><h2 id="ç¨€ç–ç›®å½•"><a href="#ç¨€ç–ç›®å½•" class="headerlink" title="ç¨€ç–ç›®å½•"></a>ç¨€ç–ç›®å½•</h2><p>ä¸Šé¢çš„ <code>æ–¹æ¡ˆäºŒ</code>ï¼Œå…¶å®å°±æ˜¯ svn çš„ä¸€ç§ç¨€ç–æ£€å‡ºçš„æ“ä½œã€‚</p><blockquote><p>Subversion 1.5 å¼€å§‹æ”¯æŒç¨€ç–æ£€å‡ºï¼Œå…è®¸å¯¹ç›®å½•è®¾ç½®æ·±åº¦ï¼ˆdepthï¼‰ã€‚</p></blockquote><p><strong>å…³äº depth å‡ ä¸ªå‚æ•°çš„å«ä¹‰</strong>:</p><p>â€“depth emptyï¼šåªåŒ…å«ç›®å½•è‡ªèº«ï¼Œä¸åŒ…å«ç›®å½•ä¸‹çš„ä»»ä½•æ–‡ä»¶å’Œå­ç›®å½•ã€‚</p><p>â€“depth filesï¼šåŒ…å«ç›®å½•å’Œç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œä¸åŒ…å«å­ç›®å½•ã€‚</p><p>â€“depth immediatesï¼šåŒ…å«ç›®å½•å’Œç›®å½•ä¸‹çš„æ–‡ä»¶åŠå­ç›®å½•ã€‚ä½†ä¸å¯¹å­ç›®å½•é€’å½’ã€‚</p><p>â€“depth infinityï¼šè¿™æ˜¯é»˜è®¤çš„ï¼ŒåŒ…å«æ•´ä¸ªç›®å½•æ ‘ã€‚</p><p>ä½¿ç”¨æ ¼å¼å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">svn checkout URL --depth empty|files|immediates|infinity</span><br></pre></td></tr></table></figure><p>æˆ–è€… </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">svn checkout URL --depth=empty|files|immediates|infinity</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> svn depth ç¨€ç–ç›®å½• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cocoapods: ç§æœ‰ä»“åº“</title>
      <link href="/2018/09/24/Cocoapods-%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93/"/>
      <url>/2018/09/24/Cocoapods-%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><p>åœ¨æˆ‘ä¹‹å‰çš„åšå®¢ä¸­åˆ†äº«äº†å‡ ç¯‡å…³äº Cocoapods çš„æ–‡ç« ï¼ˆæ–‡æœ«æœ‰é“¾æ¥ï¼‰ï¼Œä»Šå¤©åˆ†äº«å¦å¤–ä¸€ä¸ªä¸»é¢˜å³å¦‚ä½•åˆ›å»ºä½ è‡ªå·±çš„ç§æœ‰ä»“åº“ä»¥åŠå¦‚ä½•ä½¿ç”¨ç§æœ‰ä»“åº“ã€‚</p><p>ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§éœ€æ±‚å‘¢ï¼Ÿ</p><p>å¼€å‘ç»„å†…æˆ–è€…å…¬å¸å†…ï¼Œä¸å¸Œæœ›æŠŠä¸€äº›æ ¸å¿ƒçš„å…¬ç”¨ä»£ç ç»™åˆ°å¤–ç•Œä½¿ç”¨ï¼ˆä¸å¼€æºï¼‰ï¼Œä½†æ˜¯è¿™äº›ä»£ç åŸºæœ¬å¾ˆç¨³å®šå¾ˆæˆç†Ÿï¼Œå¯ä»¥åšæˆç»„ä»¶ç»™åˆ°å…¶ä»–äººæˆ–è€…ç»„å†…ä½¿ç”¨ã€‚</p><p>é‚£ä¹ˆï¼Œå°±å¯ä»¥ä½¿ç”¨ Cocoapods æ¥åˆ›å»ºè‡ªå·±çš„ç§æœ‰ä»“åº“ï¼Œè®©å¤§å®¶å…±äº«ä»£ç ï¼Œä¹Ÿæ˜¯ç»„ä»¶åŒ–çš„ä¸€ç§æ–¹æ¡ˆã€‚</p><p>ä¸‹é¢çš„åˆ†äº«å…¨æ˜¯åŸºäºå®è·µæ‰€å¾—ï¼Œä¸­é—´ä¹Ÿé‡åˆ°å¾ˆå¤šå‘ï¼Œéƒ½è¢«æˆ‘ä¸€ä¸€è§£å†³äº†ï¼Œå¸Œæœ›èƒ½å¸®åˆ°æ­£åœ¨é˜…è¯»æ–‡ç« çš„ä½ ã€‚</p><h2 id="åˆ›å»ºä»“åº“"><a href="#åˆ›å»ºä»“åº“" class="headerlink" title="åˆ›å»ºä»“åº“"></a>åˆ›å»ºä»“åº“</h2><p>è¿™é‡Œçš„åˆ›å»ºä»“åº“ï¼ŒåŒ…æ‹¬ä¸¤ä¸ªä»“åº“ï¼Œä¸€ä¸ªæ˜¯ä»£ç ä»“åº“ï¼Œå¦ä¸€ä¸ªæ˜¯ pod æºçš„ä»“åº“ã€‚</p><p>åœ¨ <a href="https://github.com/">Github</a> åˆ›å»º repositoryï¼Œå¦‚å›¾ï¼š<br><img src="/upload/images/2018/09/24/1.jpg" alt="1"></p><p><img src="/upload/images/2018/09/24/2.jpg" alt="1"></p><p>åˆ›å»ºåä¸º <code>iOS_private_lib</code> çš„ repositoryï¼Œè¿™ä¸ªä¸»è¦ç”¨æ¥å­˜æ”¾æˆ‘ä»¬çš„ä»£ç ã€‚</p><p>åŒæ ·é“ç†ï¼Œåˆ›å»ºä¸€ä¸ª Repo ç”¨äºå­˜æ”¾ç§æœ‰çš„ SpecRepo æºï¼Œæˆ‘åˆ›å»ºçš„æ˜¯ <code>https://github.com/veryitman/private_spec_repo.git</code> è¿™ä¸ªä»“åº“ã€‚</p><p>ä¸ºäº†è¯´æ˜é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨äº† <code>Public</code> æ¥æ¨¡æ‹Ÿ <code>Private</code> ä»“åº“ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨å…¬å¸è‡ªå·±æ­å»ºçš„ç§æœ‰ git æœåŠ¡å™¨æ¥åšï¼Œæˆ‘è¿™é‡Œä¸»è¦æ˜¯ä¸ºäº†è¯´æ˜é—®é¢˜ã€‚</p><h2 id="åˆ›å»ºä»£ç å·¥ç¨‹"><a href="#åˆ›å»ºä»£ç å·¥ç¨‹" class="headerlink" title="åˆ›å»ºä»£ç å·¥ç¨‹"></a>åˆ›å»ºä»£ç å·¥ç¨‹</h2><p><strong>1. å…ˆ clone åˆšæ‰åˆ›å»ºçš„ repo åˆ°æœ¬åœ°</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/workspace/</span><br><span class="line"></span><br><span class="line">git clone https://github.com/veryitman/iOS_private_lib</span><br></pre></td></tr></table></figure><p><strong>2. åˆ›å»ºå·¥ç¨‹</strong></p><p>åœ¨ <code>~/workspace/iOS_private_lib</code> ä¸‹ä½¿ç”¨ <code>pod lib create</code> åˆ›å»ºå·¥ç¨‹ï¼Œå·¥ç¨‹åå­—ä¸º <code>CoreHTTP</code>ï¼Œæ‰§è¡Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/workspace/iOS_private_lib</span><br><span class="line"></span><br><span class="line">pod lib create CoreHTTP</span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºè¾“å…¥å¯¹åº”çš„ä¿¡æ¯å³å¯å®Œæˆåˆ›å»ºï¼Œå¦‚å›¾ï¼š<br><img src="/upload/images/2018/09/24/3.jpg" alt="1"></p><p>åˆ›å»ºæˆåŠŸåï¼ŒåŒ…å«ä¸€ä¸ª <strong>Example</strong> ä¾‹å­å·¥ç¨‹ï¼Œå·¥ç¨‹ç›®å½•å¦‚ä¸‹ï¼š<br><img src="/upload/images/2018/09/24/4.jpg" alt="1"></p><p>ä½¿ç”¨ Xcode æ‰“å¼€ä¾‹å­å·¥ç¨‹ï¼Œåœ¨ <code>CoreHTTP/Classes</code> ä¸­åˆ›å»ºæ–‡ä»¶å³å¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/09/24/5.jpg" alt="1"></p><p><strong>3. ç¼–è¾‘ podspec æ–‡ä»¶</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Pod::Spec.new do |s|</span><br><span class="line">  s.name             = &#x27;CoreHTTP&#x27;</span><br><span class="line">  s.version          = &#x27;0.1.0&#x27;</span><br><span class="line">  s.summary          = &#x27;CoreHTTP for create private pod, it is a demo only.&#x27;</span><br><span class="line">  s.description      = &lt;&lt;-DESC</span><br><span class="line">                       The project of CoreHTTP is a private pod, it is a demo only.</span><br><span class="line">                       DESC</span><br><span class="line"></span><br><span class="line">  s.homepage         = &#x27;https://github.com/veryitman/iOS_private_lib.git&#x27;</span><br><span class="line">  s.license          = &#123; :type =&gt; &#x27;MIT&#x27;, :file =&gt; &#x27;LICENSE&#x27; &#125;</span><br><span class="line">  s.author           = &#123; &#x27;veryitman@126.com&#x27; =&gt; &#x27;veryitman@126.com&#x27; &#125;</span><br><span class="line">  s.platform         = :ios, &quot;7.0&quot;</span><br><span class="line">  s.source           = &#123; :git =&gt; &#x27;https://github.com/veryitman/iOS_private_lib.git&#x27;, :tag =&gt; s.version.to_s &#125;</span><br><span class="line"></span><br><span class="line">  s.ios.deployment_target = &#x27;8.0&#x27;</span><br><span class="line"></span><br><span class="line">  s.source_files = &#x27;CoreHTTP/Classes/**/*&#x27;</span><br><span class="line">  s.requires_arc = true</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œå¦‚æœ <code>s.source_files</code> å†™çš„ä¸å¯¹ï¼Œä¼šæŠ¥ä¸‹é¢çš„é”™è¯¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- ERROR | [iOS] file patterns: The `source_files` pattern did not match any file.</span><br></pre></td></tr></table></figure><p><code>CoreHTTP</code> çš„åå­—å¿…é¡»æ˜¯ä½ ä»£ç å­˜æ”¾çš„æ–‡ä»¶å¤¹åï¼Œè€Œä¸”è¿™ä¸ªæ–‡ä»¶ä»¶è¦ä¸ <code>podspec</code> æ–‡ä»¶åœ¨åŒä¸€çº§æ–‡ä»¶ç›®å½•ä¸‹ï¼Œä»ä¸Šé¢æˆªå›¾çš„ç›®å½•ç»“æ„å¯ä»¥çœ‹å‡ºã€‚</p><p>å¦å¤–ä¸€ä¸ªæç¤ºçš„é”™è¯¯ç‚¹ï¼Œå¯èƒ½æ˜¯å› ä¸ºç©ºç›®å½•çš„é—®é¢˜é€ æˆçš„ï¼Œå¦‚æœè¿™æ ·çš„è¯ï¼Œå¯ä»¥åœ¨å„ä¸ªæ–‡ä»¶å¤¹ä¸‹é¢åˆ›å»º <code>.gitkeep</code> æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶çš„ä½œç”¨æ˜¯ä¸ºäº†æäº¤ç©ºæ–‡ä»¶å¤¹ï¼Œå› ä¸º git é»˜è®¤æ˜¯ä¸ä¼šæ·»åŠ ç©ºæ–‡ä»¶å¤¹åˆ°ä»“åº“çš„ã€‚</p><p>åˆ›å»º <code>.gitkeep</code> æ–‡ä»¶çš„å‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd æ–‡ä»¶å¤¹ä¸‹</span><br><span class="line"></span><br><span class="line">touch .gitkeep</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘æŠ˜è…¾äº†è›®ä¹…ï¼Œæœ€åæ€è€ƒå’Œå‚è€ƒäº†è‡ªå·±ä¹‹å‰çš„å¼€æºé¡¹ç›®ç®¡ç†åšå®¢ï¼Œæ‰è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p><strong>4. æ£€æŸ¥å’ŒéªŒè¯æœ¬åœ° podspec æ–‡ä»¶</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd CoreHTTP </span><br><span class="line"></span><br><span class="line">pod lib lint CoreHTTP.podspec </span><br></pre></td></tr></table></figure><p>éªŒè¯é€šè¿‡ä¼šæ˜¾ç¤ºå¦‚ä¸‹å›¾æ‰€ç¤ºçš„æˆåŠŸæç¤º<br><img src="/upload/images/2018/09/24/6.jpg" alt="1"></p><p>ä½¿ç”¨ Xcode æ‰“å¼€å·¥ç¨‹ï¼Œåˆ é™¤å¯¹åº”ä»¥ <code>Testå¼€å¤´</code> çš„ç›¸å…³çš„åº“å’Œæ–‡ä»¶å¤¹ï¼Œç¡®ä¿ Xcode èƒ½ç¼–è¯‘é€šè¿‡ï¼Œé€‰æ‹©æ¨¡æ‹Ÿå™¨å³å¯ã€‚</p><p><strong>è¿™é‡Œä¸€å®šè¦å…ˆæ¸…ç©º cocoapods çš„ç¼“å­˜ï¼Œå¦åˆ™åé¢è¿œç¨‹éªŒè¯è¿˜æ˜¯æŠ¥é”™ï¼Œæ— æ³•é€šè¿‡éªŒè¯ã€‚</strong></p><p>æ¸…ç©º cocoapods çš„ç¼“å­˜ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rm ~/Library/Caches/CocoaPods/Pods/External/CoreHTTP</span><br><span class="line"></span><br><span class="line">rm ~/Library/Caches/CocoaPods/Pods/Specs/External/CoreHTTP</span><br></pre></td></tr></table></figure><p><strong>5. ä¸Šä¼ å·¥ç¨‹åˆ° Github è¿œç¨‹ä»£ç ä»“åº“</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd ~/workspace/iOS_private_lib</span><br><span class="line"></span><br><span class="line">git add CoreHTTP/</span><br><span class="line"></span><br><span class="line">git commit -m &quot;Add lib.&quot;</span><br><span class="line"></span><br><span class="line">git push</span><br></pre></td></tr></table></figure><p><strong>6. ç»™ç‰ˆæœ¬æ·»åŠ  tag</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd ~/workspace/iOS_private_lib</span><br><span class="line"></span><br><span class="line">git tag 0.1.0 -m &quot;Add lib and example project.&quot;</span><br><span class="line"></span><br><span class="line">git push --tags</span><br></pre></td></tr></table></figure><p><strong>7. è¿›è¡Œè¿œç¨‹éªŒè¯</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/workspace/iOS_private_lib</span><br><span class="line"></span><br><span class="line">pod spec lint CoreHTTP/CoreHTTP.podspec --verbose --use-libraries --allow-warnings</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong><code>--verbose</code> é€‰é¡¹æ˜¯ä¸ºäº†çœ‹ç¼–è¯‘å’ŒéªŒè¯ä¿¡æ¯ï¼Œ<code>--use-libraries</code> æ˜¯ä¸ºäº†èƒ½æ”¯æŒ i386 æ¶æ„ï¼Œå¦‚æœä¸åŠ æ­¤å‚æ•°ï¼Œç§æœ‰åº“æ— æ³•é€šè¿‡éªŒè¯ï¼Œ<code>--allow-warnings</code> å‚æ•°æ˜¯å…è®¸æœ‰è­¦å‘Šã€‚</p><p>éªŒè¯æˆåŠŸçš„ç¤ºæ„å›¾ï¼š<br><img src="/upload/images/2018/09/24/7.jpg" alt="1"></p><h2 id="æäº¤ç§æœ‰-podspec"><a href="#æäº¤ç§æœ‰-podspec" class="headerlink" title="æäº¤ç§æœ‰ podspec"></a>æäº¤ç§æœ‰ podspec</h2><p><strong>1. å‘æœ¬åœ°çš„ cocoapods ä»“åº“æ·»åŠ ç§æœ‰ Spec Repo</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/workspace/iOS_private_lib</span><br><span class="line"></span><br><span class="line">pod repo add PrivateSpec https://github.com/veryitman/private_spec_repo.git</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¸€å®šè¦æ³¨æ„ï¼šå¯¹åº”çš„åœ°å€æ˜¯ SpecRepo ä»“åº“åœ°å€è€Œä¸æ˜¯ä»£ç ä»“åº“åœ°å€ã€‚</p><p>æœ¬åœ°å­˜æ”¾ spec çš„ç§æœ‰ä»“åº“åç§°ï¼Œæˆ‘è¿™é‡Œå–åä¸º <code>PrivateSpec</code>ï¼Œä½ ä¹Ÿå¯ä»¥å–å…¶ä»–åå­—ï¼Œä½†æ˜¯è®°ä½åœ¨ä¸‹é¢çš„æ­¥éª¤ä¸­è¦ä¿æŒä¸€è‡´ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -alt ~/.cocoapods/repos/</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å·²ç»æˆåŠŸæ·»åŠ æœ¬åœ° repo ä¸­ï¼Œå…¶ä»– master æ˜¯ cocoapods å®˜æ–¹å…¬å¼€çš„æºï¼Œå…¶ä»–ä¸ºç§æœ‰æºã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/09/24/8.jpg" alt="1"></p><p><strong>2. å‘ç§æœ‰çš„ Spec Repo ä¸­æäº¤ podspec</strong></p><p>ä¸‹é¢çš„ <code>PrivateSpec</code> æ˜¯ä¸ä¸Šé¢çš„åç§°å¯¹åº”çš„ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/workspace/iOS_private_lib</span><br><span class="line"></span><br><span class="line">pod repo push PrivateSpec ./CoreHTTP/CoreHTTP.podspec --verbose --use-libraries --allow-warnings</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¦æ³¨æ„ï¼Œæ·»åŠ ç§æœ‰åº“å’Œä¹‹å‰åšæ–‡ <a href="http://www.veryitman.com/2016/11/01/Cocoapods-%E7%AE%A1%E7%90%86%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/">Cocoapods ç®¡ç†å¼€æºé¡¹ç›®</a> ä¸­æåˆ°çš„ <code>pod trunk push</code> æ˜¯ä¸ä¸€æ ·çš„æ“ä½œã€‚</p><h2 id="ä½¿ç”¨ç§æœ‰åº“"><a href="#ä½¿ç”¨ç§æœ‰åº“" class="headerlink" title="ä½¿ç”¨ç§æœ‰åº“"></a>ä½¿ç”¨ç§æœ‰åº“</h2><p><strong>1. æœç´¢åº“</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod search CoreHTTP</span><br></pre></td></tr></table></figure><p>å¦‚æœæœç´¢ä¸åˆ°ï¼Œå¯ä»¥æ‰§è¡Œä¸‹é¢çš„ä¸¤æ¡å‘½ä»¤:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rm ~/Library/Caches/CocoaPods/search_index.json</span><br><span class="line"></span><br><span class="line">pod setup</span><br></pre></td></tr></table></figure><p>ç„¶åç»§ç»­æœç´¢å°±å¯ä»¥äº†ï¼Œæœç´¢æˆåŠŸä¼šæ˜¾ç¤ºå¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CoreHTTP (0.1.0)</span><br><span class="line">   CoreHTTP for create private pod, it is a demo only.</span><br><span class="line">   pod &#x27;CoreHTTP&#x27;, &#x27;~&gt; 0.1.0&#x27;</span><br><span class="line">   - Homepage: https://github.com/veryitman/iOS_private_lib.git</span><br><span class="line">   - Source:   https://github.com/veryitman/iOS_private_lib.git</span><br><span class="line">   - Versions: 0.1.0 [PrivateSpec repo]</span><br></pre></td></tr></table></figure><p>ä¸ºäº†é¿å…å’Œå…¶ä»–ç§æœ‰åº“å‘½åå†²çªï¼Œå»ºè®®åœ¨è‡ªå·±çš„ç§æœ‰åº“å‰é¢åŠ ä¸Šå…¬å¸æˆ–è€…å…¶ä»–æ ‡ç¤ºï¼Œå¦‚ TepdCoreHTTPã€FphCoreHTTP ç­‰ã€‚</p><p><strong>2. åœ¨ Podfile æ–‡ä»¶çš„é¡¶éƒ¨æ·»åŠ  source</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">source &#x27;https://github.com/veryitman/private_spec_repo.git&#x27;</span><br><span class="line">source &#x27;https://github.com/CocoaPods/Specs.git&#x27;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ä¸€ä¸ªæ˜¯æˆ‘ä»¬ç§æœ‰ SpecRepo åœ°å€ï¼ˆéç§æœ‰ä»£ç åº“åœ°å€ï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯å®˜æ–¹å…¬æœ‰æºåœ°å€ã€‚</p><p>ä½¿ç”¨ç§æœ‰åº“çš„å·¥ç¨‹çš„ Podfile å†™æ³•ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">source &#x27;https://github.com/veryitman/private_spec_repo.git&#x27;</span><br><span class="line">source &#x27;https://github.com/CocoaPods/Specs.git&#x27;</span><br><span class="line"></span><br><span class="line">platform :ios, &#x27;7.0&#x27;</span><br><span class="line"></span><br><span class="line">target &#x27;TestCoreHTTP&#x27; do</span><br><span class="line">    pod &#x27;CoreHTTP&#x27;, &#x27;~&gt; 0.1.0&#x27;</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p>åœ¨å·¥ç¨‹ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ç§æœ‰åº“äº†ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;ViewController.h&quot;</span><br><span class="line">#import &lt;CoreHTTPHeader.h&gt;</span><br><span class="line"></span><br><span class="line">@interface ViewController ()</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation ViewController</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    </span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    NSString *lib_desc = [CoreHTTPHeader libDesc];</span><br><span class="line">    NSLog(@&quot;The HTTP&#x27;s library desc: %@&quot;, lib_desc);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><h2 id="pod-å‘½ä»¤"><a href="#pod-å‘½ä»¤" class="headerlink" title="pod å‘½ä»¤"></a>pod å‘½ä»¤</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//å°†å·¥ç¨‹æ·»åŠ åˆ°æœ¬åœ° repo ä¸­ </span><br><span class="line">pod repo add [æœ¬åœ°ç§æœ‰ä»“åº“å] [è¿œç¨‹ä»“åº“åœ°å€]</span><br><span class="line"></span><br><span class="line">//ç§»é™¤æœ¬åœ° repo</span><br><span class="line">pod repo remove [æœ¬åœ°ç§æœ‰ä»“åº“å]</span><br><span class="line"></span><br><span class="line">//æŸ¥çœ‹æœ¬åœ° repo</span><br><span class="line">pod repo </span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//åªä»æœ¬åœ°éªŒè¯ä½ çš„podèƒ½å¦é€šè¿‡éªŒè¯</span><br><span class="line">pod lib lint *.podspec</span><br><span class="line"></span><br><span class="line">//ä»æœ¬åœ°å’Œè¿œç¨‹éªŒè¯ä½ çš„podèƒ½å¦é€šè¿‡éªŒè¯</span><br><span class="line">pod spec lint *.podspec</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p><a href="https://guides.cocoapods.org/making/private-cocoapods.html">Private Pods</a></p><h2 id="æˆ‘çš„å…¶ä»–æ–‡ç« "><a href="#æˆ‘çš„å…¶ä»–æ–‡ç« " class="headerlink" title="æˆ‘çš„å…¶ä»–æ–‡ç« "></a>æˆ‘çš„å…¶ä»–æ–‡ç« </h2><p><a href="http://www.veryitman.com/2016/11/08/Mac-install-Cocoapods/">Mac install Cocoapods</a></p><p><a href="http://www.veryitman.com/2016/11/08/Cocoapods-%E9%97%AE%E9%A2%98%E9%9B%86%E9%94%A6/">Cocoapods é—®é¢˜é›†é”¦</a></p><p><a href="http://www.veryitman.com/2016/11/01/Cocoapods-%E7%AE%A1%E7%90%86%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/">Cocoapods ç®¡ç†å¼€æºé¡¹ç›®</a></p><p><a href="http://www.veryitman.com/2016/09/25/iOS-%E9%A1%B9%E7%9B%AE-%E6%89%93%E9%80%A0%E6%9C%AC%E5%9C%B0-pod-%E5%BA%93/">iOS é¡¹ç›®: æ‰“é€ æœ¬åœ° pod åº“</a></p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> MacOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS cocoapods </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ…è°ˆå®¢æˆ·ç«¯æ¨¡å—åŒ–</title>
      <link href="/2018/09/23/%E6%B5%85%E8%B0%88%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%A8%A1%E5%9D%97%E5%8C%96/"/>
      <url>/2018/09/23/%E6%B5%85%E8%B0%88%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%A8%A1%E5%9D%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h2 id="å›å¿†"><a href="#å›å¿†" class="headerlink" title="å›å¿†"></a>å›å¿†</h2><p>å¤§å­¦é‚£ä¼šå–œæ¬¢è·Ÿç€è€å¸ˆåœ¨å®éªŒå®¤æŠ˜è…¾ï¼Œæ„Ÿè§‰æ¯å¤©å¤§è„‘ä¸­éƒ½æœ‰æ–°çŸ¥è¯†é±¼è´¯è€Œå…¥ã€‚</p><p>å½“æˆ‘è¢«å‘ŠçŸ¥è¦åšä¸€ä¸ªæœ€å°å•ç‰‡æœºç³»ç»Ÿçš„æ—¶å€™ï¼Œå…´å¥‹è€Œåˆç´§å¼ ï¼</p><p>æœ€å°å•ç‰‡æœºç³»ç»Ÿç¤ºæ„å›¾ï¼š<br><img src="/upload/images/2018/09/23/1.jpg"></p><p>ä»ç”» <a href="https://baike.baidu.com/item/PCB/146397?fr=aladdin">PCB</a> åˆ°åˆ¶æ¿ã€æ´—æ¿ï¼Œå†åˆ°é€‰æ‹©å…ƒå™¨ä»¶ï¼Œæœ€åç»„è£…è°ƒè¯•å’Œå†™ä»£ç ï¼Œæˆ‘èŠ±è´¹äº†ä¸¤ä¸ªå¤šæœˆçš„æ—¶é—´ï¼Œå½“æ¿å­ä¸Šé¢çš„è·‘é©¬ç¯äº®èµ·æ¥çš„é‚£ä¸€åˆ»ï¼Œæˆ‘æ¿€åŠ¨çš„æ— æ³•è¨€è¯­ã€‚</p><p>å¤§å®¶å¯ä»¥çœ‹åˆ°è¿™ä¸ªæœ€å°å•ç‰‡æœºç³»ç»Ÿä¸Šé¢æœ‰å¾ˆå¤šç»„ä»¶ç»„æˆï¼Œæœ‰ç”µé˜»ã€ç”µå®¹ã€ç”µé˜»ã€äºŒæç®¡å’Œå¡æ§½ç­‰ï¼Œå½“ç„¶è¿˜æœ‰æœ€æ ¸å¿ƒçš„ç»„ä»¶å°±æ˜¯å•ç‰‡æœºï¼Œå½“æ—¶ç”¨çš„æ˜¯51å•ç‰‡æœºã€‚</p><p>å„ä¸ªå…ƒå™¨ä»¶å°±å¥½æ¯”ç»„ä»¶ï¼ŒåŠŸèƒ½å•ä¸€ï¼ŒèŒè´£æ˜æ˜¾ï¼Œç»„ä»¶ä¹‹é—´éµå¾ªåè®®æ„æˆæ¨¡å—ï¼Œæœ€ç»ˆç»„åˆæˆä¸ºï¼ˆæœ€å°å•ç‰‡æœºï¼‰ç³»ç»Ÿã€‚</p><p>ä¸Šé¢çš„å›å¿†æ˜¯ä¸ºäº†å¼•å‡ºä»Šå¤©çš„åˆ†äº«ï¼Œåˆ†äº«çš„ä¸»è¦å†…å®¹æ˜¯å®¢æˆ·ç«¯å¼€å‘ä¸­å¸¸ç”¨çš„<strong>æ¨¡å—åŒ–</strong>ã€<strong>ç»„ä»¶åŒ–</strong>ã€<strong>æ’ä»¶åŒ–</strong>ä»¥åŠ<strong>çƒ­æ›´æ–°</strong>ç­‰æŠ€æœ¯è¾è—»ï¼Œå¹¶æ²¡æœ‰æ¶‰åŠåˆ°å…·ä½“çš„æŠ€æœ¯é—®é¢˜ã€‚</p><h2 id="æ¨¡å—åŒ–å’Œç»„ä»¶åŒ–"><a href="#æ¨¡å—åŒ–å’Œç»„ä»¶åŒ–" class="headerlink" title="æ¨¡å—åŒ–å’Œç»„ä»¶åŒ–"></a>æ¨¡å—åŒ–å’Œç»„ä»¶åŒ–</h2><p>ä»ç¨‹åºè®¾è®¡çš„è§’åº¦å‡ºå‘ï¼Œæ— è®ºæ˜¯æ¨¡å—åŒ–è¿˜æ˜¯ç»„ä»¶åŒ–ï¼Œéƒ½æ˜¯æŒ‡è½¯ä»¶æ¶æ„çš„èŒƒç•´ï¼Œæ˜¯ä¸€ç§è®¾è®¡æ€æƒ³ã€‚ä¸¤è€…å¹¶æ²¡æœ‰ä¸¥æ ¼æ„ä¹‰ä¸Šé¢çš„åŒºåˆ†ï¼ŒäºŒè€…çš„ç›®çš„ä¸€è‡´ï¼Œå°±æ˜¯å°†å·¥ç¨‹ç»“æ„åŒ–ï¼Œè¾¾åˆ°å¯å¤ç”¨å¯ä¼¸ç¼©çš„èƒ½åŠ›ï¼Œæœ€ç»ˆæä¾›å·¥ä½œæ•ˆç‡ã€‚</p><p>åœ¨è¯´æ¨¡å—åŒ–å’Œç»„ä»¶åŒ–ä¹‹å‰ï¼Œå…ˆè§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯é«˜å†…èšä½è€¦åˆã€‚</p><p>é«˜å†…èšï¼šç»„ä»¶å†…å°½å¯èƒ½ç‹¬ç«‹å®Œæˆè‡ªå·±çš„åŠŸèƒ½ï¼ŒåšæŒå•ä¸€èŒè´£çš„åŸåˆ™ <a href="https://baike.baidu.com/item/%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3%E5%8E%9F%E5%88%99/9456515">SRP</a>ï¼Œä¸ä¾èµ–äºå…¶ä»–ç»„ä»¶çš„ä»£ç ã€‚</p><p>ä½è€¦åˆï¼šæ¨¡å—ä¸æ¨¡å—ä¹‹é—´å°½é‡ä¸è¦äº’ç›¸å¼•ç”¨ï¼Œæ¨¡å—ä¹‹é—´è”ç³»è¶Šå¤æ‚è€¦åˆåº¦è¶Šé«˜ï¼Œä¿®æ”¹çš„æˆæœ¬å°±è¶Šé«˜ã€‚</p><p><strong>ç»„ä»¶</strong>æ›´åŠ å¼ºè°ƒå¯æ›¿æ¢å¯å¤ç”¨çš„ç‰¹æ€§ï¼ŒèŒè´£å’ŒåŠŸèƒ½æ¯”è¾ƒå•ä¸€ã€ç‹¬ç«‹ï¼Œä¸å…¶ä»–ç»„ä»¶ä¹‹é—´æ²¡æœ‰è€¦åˆæ€§ã€‚</p><p><strong>æ¨¡å—</strong>æ›´åŠ å¼ºè°ƒç»„åˆç‰¹æ€§ï¼Œæ›´åŠ åé‡äºä¸šåŠ¡ï¼Œæ¯”å¦‚ä¸€ä¸ªç¤¾åŒºé¡¹ç›®ï¼Œç™»å½•æ³¨å†Œã€è®ºå›å’Œä¸ªäººä¸­å¿ƒéƒ½æ˜¯æ¨¡å—ï¼Œè¿™äº›ä¸šåŠ¡æ¨¡å—åˆæ˜¯æœ‰å¾ˆå¤šä¸ªç»„ä»¶ç»„åˆè€Œæˆã€‚</p><p>ä¸‹å›¾å±•ç¤ºçš„æ˜¯ä¸€ä¸ªç®€æ˜“çš„è®ºå›ç³»ç»Ÿç¤ºä¾‹å›¾ï¼Œå¦‚ä¸‹ï¼š<br><img src="/upload/images/2018/09/23/2.jpg"></p><p>å¯ä»¥çœ‹å‡ºï¼Œå„ä¸ªç»„ä»¶å¯ä»¥å•ç‹¬ä½¿ç”¨åˆ°å…¶ä»–æ¨¡å—å½“ä¸­ï¼Œå„ä¸ªæ¨¡å—ä¹‹é—´ç›¸å¯¹ç‹¬ç«‹ï¼Œåªè¦å®šä¹‰å¥½æ¨¡å—ä¹‹é—´çš„é€šä¿¡åè®®ï¼Œå°±å¯ä»¥åšåˆ°å¹¶è¡Œå¼€å‘ï¼Œå„ä¸ªæ¨¡å—ç”šè‡³å¯ä»¥å¤ç”¨åˆ°å…¶ä»–ç³»ç»Ÿä¹‹ä¸­ã€‚</p><h2 id="é€šä¿¡æœºåˆ¶"><a href="#é€šä¿¡æœºåˆ¶" class="headerlink" title="é€šä¿¡æœºåˆ¶"></a>é€šä¿¡æœºåˆ¶</h2><p>è¿™é‡Œè¯´çš„é€šä¿¡æœºåˆ¶å¹¶ä¸æ˜¯æŒ‡ HTTP æˆ– TCP çš„é€šä¿¡æ–¹å¼ï¼Œè€Œæ˜¯æŒ‡ç»„ä»¶ä¸ç»„ä»¶ä¹‹é—´ï¼Œæ¨¡å—å’Œæ¨¡å—ä¹‹é—´çš„äº¤äº’æ–¹å¼ã€‚</p><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œå†™ä¸šåŠ¡åŠŸèƒ½çš„ä»£ç ï¼Œåœ¨ä¸åŒç»„ä»¶ä¹‹é—´éœ€è¦ç›¸äº’è°ƒç”¨ï¼Œè¿™æ ·å°±éœ€è¦ <strong>import</strong> å…¶ä»–ç»„ä»¶ï¼Œæ— å½¢ä¹‹ä¸­å°±å¢åŠ äº†ç»„ä»¶ä¹‹é—´çš„è€¦åˆåº¦ã€‚</p><p>æœ‰å¼€å‘ç»éªŒçš„åŒå­¦ï¼Œå¯èƒ½ä¼šç”¨åˆ°ç±»ä¼¼ java çš„åå°„æœºåˆ¶ï¼Œæˆ–è€…ä¸€äº›åŠ¨æ€è¯­è¨€çš„è¿è¡Œæ—¶æœºåˆ¶å¦‚ Objective-C Runtimeï¼Œå¯¹å®ƒä»¬ä¸è¿›è¡Œ <strong>import</strong>ï¼Œè€Œæ˜¯åŠ¨æ€çš„è§£æä»£ç ï¼Œè¾¾åˆ°ç»„ä»¶ä¹‹é—´æˆ–è€…æ˜¯ç±»ä¹‹é—´ç›¸äº’è°ƒç”¨çš„ç›®çš„ã€‚</p><p>ç°åœ¨æå€¡ä¹Ÿæ˜¯æ¯”è¾ƒçƒ­é—¨çš„æŠ€æœ¯æ˜¯é€šè¿‡<strong>è·¯ç”±</strong>é€šä¿¡æœºåˆ¶ï¼Œæ¥è¿›è¡Œç»„ä»¶ä¹‹é—´çš„é€šä¿¡ã€‚è¿™é‡Œä¸¾ä¸€ä¸ªå®é™…ä½¿ç”¨åœºæ™¯ã€‚</p><p>ç”¨æˆ·å®‰è£…äº†æˆ‘ä»¬çš„ APPï¼Œè¿è¥åŒäº‹åœ¨æŸä¸ªèŠ‚æ—¥æ¥ä¸´ä¹‹é™…åšä¸€ä¸ªä¿ƒæ´»è·ƒçš„æ´»åŠ¨ï¼ŒæœŸæœ›ç”¨æˆ·ç‚¹åœ¨æ‰“å¼€æ¨é€é€šçŸ¥çš„æ—¶å€™ï¼Œæ‰“å¼€ APP åå¯ä»¥ç›´æ¥è·³è½¬åˆ°å¯¹åº”çš„æ´»åŠ¨è¯¦æƒ…é¡µé¢ã€‚å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š<br><img src="/upload/images/2018/09/23/3.jpg"></p><p>è¿™æ˜¯ä¸€ä¸ªå†å¸¸è§„ä¸è¿‡çš„éœ€æ±‚äº†ï¼Œç›¸ä¿¡ç»å†è¿‡äº§å“å¼€å‘çš„æœ‹å‹éƒ½è§è¿‡è¿™ç§éœ€æ±‚ã€‚</p><p>å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>è·¯ç”±</strong>çš„é€šä¿¡æœºåˆ¶æ¥å®Œæˆè¿™ä¸ªéœ€æ±‚ï¼Œå¼€å‘çš„æµç¨‹å›¾å¤§è‡´å¦‚ä¸‹ï¼š<br><img src="/upload/images/2018/09/23/4.jpg"></p><p>è¿™é‡Œå…³é”®çš„æ ¸å¿ƒå¾—ç›Šäº iOS å’Œ Android å¹³å°çš„ <strong>scheme</strong> æœºåˆ¶ï¼Œå¯¹äº <strong>scheme</strong>ï¼Œé€šä¿—çš„è®²å°±æ˜¯ä¸€ç§å¯ä»¥è·¨è¿›ç¨‹æˆ–è€…è¿›ç¨‹å†…çš„é€šä¿¡åè®®ï¼Œä¾‹å¦‚å¯ä»¥åœ¨ APP ä¸­æ‰“å¼€æŸä¸ªåº”ç”¨å•†åº—ã€‚</p><p>ä¾‹å¦‚ä¸‹é¢çš„ URLï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bbs://page/activity/activity_detail?id=8978&amp;user_id=67890432</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ<code>bbs</code> å°±æ˜¯ <strong>scheme</strong>ï¼Œå¯ä»¥çœ‹åˆ°è¯¥ URL å®Œå…¨å¯ä»¥è¢«å„è‡ªå¹³å°æ¥è§£æã€‚</p><p>iOS å’Œ Android å¹³å°å„æœ‰å¾ˆå¤šå¼€æºçš„è·¯ç”±æ–¹æ¡ˆï¼Œå®ç°æ‰‹æ³•å„æœ‰å·®å¼‚ï¼Œä½†æ˜¯æ€æƒ³æ˜¯ä¸€æ ·çš„ï¼Œå»ºè®®å¤§å®¶å»äº†è§£å’Œå­¦ä¹ ã€‚</p><p>ä¸è¿‡ï¼Œç°åœ¨ä½ åªè¦çŸ¥é“ï¼Œè·¯ç”±çš„é€šä¿¡æœºåˆ¶å¤§å¤§é™ä½äº†ç»„ä»¶ä¹‹é—´çš„è€¦åˆæ€§å°±å¤Ÿäº†ã€‚</p><h2 id="æ’ä»¶åŒ–"><a href="#æ’ä»¶åŒ–" class="headerlink" title="æ’ä»¶åŒ–"></a>æ’ä»¶åŒ–</h2><p><strong>æ’ä»¶</strong>è¿™ä¸ªè¯ï¼Œå¤§å®¶åº”è¯¥å¾ˆç†Ÿæ‚‰ï¼Œä¾‹å¦‚ Chrome æµè§ˆå™¨ä¸­å¯ä»¥å®‰è£…å„ç§å°å·¥å…·ï¼Œè¿™äº›å°å·¥å…·å°±æ˜¯æ’ä»¶ï¼Œè¿˜æœ‰å„ç§å¼€å‘ä½¿ç”¨çš„ IDE ä¹Ÿæ”¯æŒæ’ä»¶å®‰è£…ï¼Œä¾¿äºæé«˜æˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡ã€‚Chrome å’Œ IDE è¢«ç§°ä¹‹ä¸ºå®¿ä¸»ï¼Œæ’ä»¶å¯„ç”Ÿäºä»–ä»¬ã€‚</p><p>æ”¯ä»˜å®å’Œå¾®ä¿¡é‡Œé¢çš„å°ç¨‹åºä¹Ÿå¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªä¸ªæ’ä»¶ï¼Œä½†æ˜¯ä»–ä»¬ä¸èƒ½è„±ç¦»æ”¯ä»˜å®å’Œå¾®ä¿¡ç‹¬ç«‹è¿è¡Œã€‚</p><p>å¯ä»¥å‘ç°è¿™äº›æ’ä»¶å³ä½¿è¢«å¸è½½æˆ–è€…è¢«åˆ é™¤ï¼Œå¹¶ä¸ä¼šè®© Chrome æˆ–è€… IDE å—åˆ°å½±å“ï¼Œæ¢å¥è¯è¯´ï¼Œæ’ä»¶è®©å®¿ä¸»é”¦ä¸Šæ·»èŠ±ã€‚ </p><p>è¿™ç§æ’ä»¶æ€æƒ³å½“ç„¶å¯ä»¥è¿ç”¨åˆ° APP ä¸­æ¥ï¼Œè¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœæŸä¸ª APP åœ¨çº¿ä¸Šç»è¿‡åŠ¨æ€ä¸‹è½½å°±å…·æœ‰äº†ä¸€ä¸ªå¼ºå¤§æˆ–è€…å¥½ç”¨çš„åŠŸèƒ½ï¼Œå²‚ä¸ç¾å“‰ï¼Ÿï¼</p><p><strong>æ’ä»¶åŒ–</strong>ï¼Œå°† APP æ‹†åˆ†æˆå¾ˆå¤šæ¨¡å—ï¼Œè¿™äº›æ¨¡å—åŒ…æ‹¬ä¸€ä¸ªå®¿ä¸»å’Œå¤šä¸ªæ’ä»¶ï¼Œå®¿ä¸»æä¾›æ’ä»¶çš„ç®¡ç†å’Œé€šä¿¡åè®®åŠè§„èŒƒï¼Œæ¯ä¸ªæ¨¡å—éƒ½æ˜¯ä¸€ä¸ªçš„åº“æˆ–è€…åŠŸèƒ½åŒ…ã€‚</p><p><strong>æ’ä»¶åŒ–</strong>æ˜¯ä¸€ç§ç¼–ç¨‹å’Œè§£å†³é—®é¢˜çš„æ€æƒ³ï¼Œæ²¡æœ‰ç»Ÿä¸€çš„å®šä¹‰ã€‚åœ¨ Android ä¸Šé¢è¿ç”¨æ¯”è¾ƒå¤šï¼ŒiOS ä¸Šé¢å¾ˆå°‘ï¼Œå¹¶ä¸æ˜¯ iOS æ²¡æœ‰è¿™æ ·çš„æŠ€æœ¯ï¼Œä¸»è¦æ˜¯å› ä¸ºè‹¹æœå®¡æ ¸ç­‰å„æ–¹é¢çš„é™åˆ¶ã€‚åœ¨ iOS8 ä¸Šçš„ <code>App Extension</code> åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥çœ‹åšæ˜¯æ’ä»¶åŒ–äº†ã€‚</p><p>åœ¨ Android å¹³å°ä¸­ï¼Œæ’ä»¶åŒ–å·²ç»ä¸æ˜¯å¾ˆæ–°é²œçš„æŠ€æœ¯äº†ï¼Œ<strong>VirtualAPKã€Atlasã€Replugin</strong> ç­‰æ¡†æ¶ç›¸ç»§å¼€æºï¼Œæ’ä»¶åŒ–æŠ€æœ¯å·²ç»è¿›å…¥äº†æ¯”è¾ƒæˆç†Ÿçš„é˜¶æ®µäº†ã€‚</p><p>æ’ä»¶åŒ–çš„ç¼–ç¨‹æ€æƒ³å’Œå®ç°ï¼Œåœ¨ä¸åŒçš„å¹³å°æœ‰æ‰€å·®å¼‚ï¼Œå³ä½¿åœ¨åŒä¸€ä¸ªå¹³å°ä¸Šé¢éƒ½ä¼šæœ‰ä¸åŒçš„å®ç°æ‰‹æ®µï¼Œå»ºè®®é€‰æ‹©ä¸€ä¸ªå¼€æºæ–¹æ¡ˆå»äº†è§£å…¶åŸç†ï¼Œç„¶åè¯•ç€åŠ¨æ‰‹å»å®ç°ä¸€ä¸ªï¼Œåƒé‡Œä¹‹è¡Œå§‹äºè¶³ä¸‹ï¼</p><h2 id="çƒ­æ›´æ–°"><a href="#çƒ­æ›´æ–°" class="headerlink" title="çƒ­æ›´æ–°"></a>çƒ­æ›´æ–°</h2><p>â€œä¸å¥½äº†ï¼Œæ˜¨å¤©æœ‰å¾ˆå¤šç”¨æˆ·åé¦ˆæˆ‘ä»¬çš„ APP å‡ºç°é—ªé€€ã€‚â€œ å°ç‹ä¸€å¤§æ—©çš„å¼€å§‹æ’•å–Šï¼Œååœ¨ä»–æ—è¾¹çš„å¼€å‘å¤§ç¥ä»¬é¡¿æ—¶å¾®ç¬‘å‡å›ºï¼Œé©¬ä¸Šå»åå°çœ‹ä¸ŠæŠ¥çš„å´©æºƒæ—¥å¿—ï¼Œç´§æ¥ç€å¼€å§‹å¤ç°å’Œè§£å†³é—®é¢˜ï¼Œæœ€ç»ˆå¾—å‡ºç»“è®ºï¼Œéœ€è¦é‡æ–°æå®¡ APPï¼Œå¹¶å‘¨çŸ¥æ¸ é“éƒ¨é—¨åšå¥½æ›´æ–°å‡†å¤‡ã€‚</p><p>è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœä¸€ä¸ªæ¸¸æˆå‡ Gçš„å¤§å°ï¼Œä½ è®©ç”¨æˆ·ä¸ºäº†ä½ çš„ä¸€ä¸ªå°å¤±è¯¯æ¥æ•´åŒ…æ›´æ–°æ¸¸æˆï¼Œç”¨æˆ·å’Œä½ ä¼°è®¡éƒ½è¦ç–¯äº†ã€‚</p><p>æœ€è¿‘å‡ å¹´ï¼Œéšç€ä¸šåŠ¡å‘å±•çš„éœ€æ±‚ï¼Œ<strong>çƒ­æ›´æ–°</strong>æŠ€æœ¯ä¹Ÿæ˜¯å¾—åˆ°äº†çªé£çŒ›è¿›çš„å‘å±•ã€‚ç±»ä¼¼äºä¸Šé¢çš„åœºæ™¯ï¼Œèƒ½åœ¨ç”¨æˆ·ç¥ä¸çŸ¥é¬¼ä¸è§‰çš„æƒ…å†µä¸‹ä½¿ç”¨çƒ­æ›´æ–°çš„æŠ€æœ¯è§£å†³å´©æºƒçš„é—®é¢˜ï¼Œå²‚ä¸æ˜¯ä¸¤å…¨å…¶ç¾ã€‚</p><p>Android çš„çƒ­æ›´æ–°æŠ€æœ¯å¦‚ç«å¦‚è¼çš„å‘å±•ç€ï¼Œè€Œè‹¹æœè¿™è¾¹ä¸¥å‰ç¦æ­¢<strong>çƒ­æ›´æ–°</strong>ï¼Œä¸€æ—¦æ£€æŸ¥åˆ°ç«‹å³ä¼šè´£ä»¤ä½ ä¿®æ”¹æˆ–è€…ä¸‹æ¶ APPã€‚æˆ‘ä»¬è¿˜æ˜¯ä»æŠ€æœ¯çš„è§’åº¦æ¥çœ‹è¿™ä¸ªé—®é¢˜ï¼Œå­¦ä¹ å’Œäº†è§£ä¸€ä¸‹å¯¹åº”çš„æŠ€æœ¯æ€»å½’æ²¡æœ‰é”™ï¼Œ<a href="https://juejin.im/post/5a5821b6f265da3e3f4c9e2a">è¿™é‡Œ</a> æœ‰ iOS ä¸Šé¢çš„çƒ­æ›´æ–°æ–¹æ¡ˆï¼Œå¦å¤– <a href="https://www.jianshu.com/p/eec0ab6800a4">Androidçƒ­ä¿®å¤æ–¹æ¡ˆæ¯”è¾ƒ</a> ä»‹ç»äº†å¾ˆå¤š Android çƒ­æ›´æ–°çš„å¼€æºçš„æ–¹æ¡ˆï¼Œå¯ä»¥äº†è§£å­¦ä¹ ä¸€ä¸‹ã€‚</p><p>ç«™åœ¨è·¨å¹³å°çš„è§’åº¦ï¼Œæˆ‘ä¸ªäººæ¯”è¾ƒæ¨èä½¿ç”¨ Lua å®ç°<strong>çƒ­æ›´æ–°</strong>ï¼ŒLua ä¸ä»…ç®€å•é«˜æ•ˆï¼Œè€Œä¸”å¯ä»¥å¾ˆå¥½çš„å’Œ C&#x2F;C++ ç»“åˆåœ¨ä¸€èµ·ï¼Œè€Œ Android ä¸Šé¢é€šè¿‡ JNI åˆèƒ½ä¸ C&#x2F;C++ é€šä¿¡ï¼ŒiOS ä¸Šé¢å°±æ›´åŠ ä¸ç”¨è¯´äº†ã€‚è¿™åªæ˜¯æˆ‘ä¸ªäººçš„ä¸€ç‚¹çœ‹æ³•ï¼Œä¸å–œå‹¿å–·ã€‚</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Philosophy </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„ æ¨¡å—åŒ– ç»„ä»¶åŒ– çƒ­æ›´æ–° æ’ä»¶åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTTP æ¼”è¿›å²</title>
      <link href="/2018/09/16/HTTP-%E6%BC%94%E8%BF%9B%E5%8F%B2/"/>
      <url>/2018/09/16/HTTP-%E6%BC%94%E8%BF%9B%E5%8F%B2/</url>
      
        <content type="html"><![CDATA[<h2 id="ç²¾é€š-HTTP-å—ï¼Ÿ"><a href="#ç²¾é€š-HTTP-å—ï¼Ÿ" class="headerlink" title="ç²¾é€š HTTP å—ï¼Ÿ"></a>ç²¾é€š HTTP å—ï¼Ÿ</h2><p>åœ¨é¢è¯•ç›¸å…³å¼€å‘å²—ä½çš„åŒå­¦ä¸­ï¼Œæˆ‘ç»å¸¸ä¼šé—®ä¸€äº›è·Ÿç¼–ç¨‹è¯­è¨€ä¸ç›¸å…³çš„ä¸œè¥¿ï¼Œæ¯”å¦‚ä¸‹é¢è¿™äº›é—®é¢˜ï¼š</p><p><strong>1. ä½ å¹³æ—¶æ˜¯æ€ä¹ˆå­¦ä¹ çš„ï¼Ÿå­¦ä¹ æ¸ é“æœ‰å“ªäº›ï¼Ÿ</strong><br><strong>2. é¡¹ç›®ç»„ä¸­ï¼Œä½ è®¤ä¸ºæœ€é‡è¦çš„æ˜¯ä»€ä¹ˆï¼Ÿ</strong><br><strong>3. ä½ åœ¨é¡¹ç›®ç»„ä¸­é‡åˆ°çš„æœ€å¤§å›°éš¾ï¼ˆéç¼–ç¨‹é—®é¢˜ï¼‰æ˜¯ä»€ä¹ˆï¼Œä½ æ˜¯æ€ä¹ˆè§£å†³çš„ï¼Ÿ</strong><br><strong>4. é¡¹ç›®æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå…¶ä»–åŒäº‹é‡åˆ°å›°éš¾ï¼Œä½ æ˜¯å¦‚ä½•åšçš„ï¼Ÿ</strong></p><p>è¿™äº›é—®é¢˜å¯ä»¥è®©é¢è¯•è€…è‡ªç”±å‘æŒ¥çš„é¢˜ç›®ï¼Œå¹¶æ²¡æœ‰å›ºå®šçš„æ ‡å‡†çš„ç­”æ¡ˆã€‚è¿™æ ·çš„é—®é¢˜é—®å‡ºæ¥æœ‰è¯¸å¤šå¥½å¤„ï¼Œé¦–å…ˆå¯ä»¥è®©é¢è¯•è€…ç¨³å®šä¸€ä¸‹å¿ƒæ€ä¸è‡³äºå¤ªç´§å¼ ï¼Œå…¶æ¬¡å¯ä»¥çœ‹çœ‹ä»–çš„è¯­è¨€ç»„ç»‡èƒ½åŠ›å’Œè¡¨è¾¾èƒ½åŠ›ï¼Œä»ä¸­ä¹Ÿèƒ½çœ‹å‡ºä»–æœ‰æ²¡æœ‰è¿‡å®é™…çš„é¡¹ç›®ç»éªŒã€‚</p><p>å¾ˆå¤šäººçš„ç®€å†ä¸Šé¢å†™çš„å¾ˆå®Œç¾ï¼Œåšè¿‡è¯¸å¤šé¡¹ç›®ï¼Œç²¾é€šæŸæŸè¯­è¨€çš„ç¼–ç¨‹ï¼Œç²¾é€šå„ç§ç½‘ç»œåè®®ï¼Œç†Ÿæ‚‰å„å¤§æ“ä½œç³»ç»Ÿç­‰ç­‰ï¼Œå½“æ·±å…¥é—®ä»–ä»¬ç†Ÿæ‚‰çš„çŸ¥è¯†æ—¶ï¼Œå‘ç°ä»–ä»¬çš„å›ç­”å´å«ç³Šä¸æ¸…ã€‚ä¸æ’é™¤ä¸–ç•Œä¸Šæœ‰è¿™æ ·çš„å…¨æ‰ï¼Œä½†æ˜¯è‚¯å®šä¸ä¼šè¢«æˆ‘ä»¬è½»æ˜“é‡åˆ°ï¼Œè‡³å°‘æˆ‘è§‰å¾—è‡ªå·±è¿˜æ²¡æœ‰è¾¾åˆ°é‚£ä¸ªèƒ½åŠ›ã€‚</p><p>å¦‚æœä½ è¿˜æ²¡æœ‰ä½†åˆæƒ³ç²¾é€šå„ç§çŸ¥è¯†ï¼Œå°±æ…¢æ…¢å»å­¦ä¹ å¹¶ç²¾é€šç›¸å…³çš„çŸ¥è¯†ï¼Œå¾ªåºæ¸è¿›ï¼Œç›¸ä¿¡è‡ªå·±ä¼šåšåˆ°çš„ã€‚å¥½äº†ï¼Œä¸æ‰¯äº†ï¼Œä»Šå¤©èŠèŠ HTTP çš„å‘å±•å†å²ã€‚</p><p>æˆ‘æ•¢ä¿è¯æœ‰ç»å¤§éƒ¨åˆ†çš„äººä¸çŸ¥é“ HTTP&#x2F;2ï¼Œè™½ç„¶ä»–æ—©å°±æ¥ä¸´.</p><h2 id="HTTP-0-x-åˆ°-HTTP-x2F-2"><a href="#HTTP-0-x-åˆ°-HTTP-x2F-2" class="headerlink" title="HTTP 0.x åˆ° HTTP&#x2F;2"></a>HTTP 0.x åˆ° HTTP&#x2F;2</h2><p>HTTP&#x2F;1 æ˜¯ HTTP 1.0 å’Œ HTTP 1.1 çš„ç»Ÿç§°ï¼Œåˆ†åˆ«æŒ‡ HTTP åè®®çš„ç‰ˆæœ¬æ˜¯ 1.0 å’Œ 1.1.</p><p>1960å¹´ç¾å›½äºº <a href="https://baike.baidu.com/item/Ted%20Nelson">Ted Nelson</a> æ„æ€äº†ä¸€ç§é€šè¿‡è®¡ç®—æœºå¤„ç†æ–‡æœ¬ä¿¡æ¯çš„æ–¹æ³•ï¼Œå¹¶ç§°ä¹‹ä¸ºè¶…æ–‡æœ¬ï¼ˆhypertextï¼‰, è¿™æˆä¸ºäº† HTTP è¶…æ–‡æœ¬ä¼ è¾“åè®®æ ‡å‡†æ¶æ„çš„å‘å±•æ ¹åŸºï¼Œæ‰€ä»¥ä»–è¢«ç§°ä¹‹ä¸º <code>HTTP ä¹‹çˆ¶</code>ã€‚</p><p>1989å¹´3æœˆåœ¨ CERNï¼ˆæ¬§æ´²æ ¸å­ç ”ç©¶ç»„ç»‡ï¼‰å·¥ä½œçš„ <a href="%E4%B8%87%E7%BB%B4%E7%BD%91%E4%B9%8B%E7%88%B6">Tim Berners-Leeï¼ˆè’‚å§†.ä¼¯çº³æ–¯.æï¼‰</a> æäº¤äº†ä¸€ä¸ªææ¡ˆ <code>Information Management: A Proposal</code>ï¼Œè¯¥ææ¡ˆæç»˜äº†å…¶å¯¹ä¸‡ç»´ç½‘ï¼ˆWorld Wide Webï¼‰æœ€åˆçš„è®¾æƒ³å³èƒ½è®©è¿œéš”ä¸¤åœ°çš„äººä»¬å…±äº«çŸ¥è¯†ï¼ŒTim æ˜¯ <code>ä¸‡ç»´ç½‘ä¹‹çˆ¶</code>ï¼Œæˆå°±å’Œè´¡çŒ®ä¹Ÿæ˜¯ä¸è®¡å…¶æ•°ã€‚</p><p>ç›´åˆ°1990å¹´ HTTP æ‰ç®—æ˜¯é—®ä¸–ï¼Œå§‘ä¸”ç§°ä¹‹ä¸º HTTP 0.x ç‰ˆæœ¬ï¼Œä¹Ÿæœ‰äº›åœ°æ–¹ç§°ä¹‹ä¸º HTTP 0.9 ç‰ˆæœ¬ï¼Œæ€»ä¹‹è¿™ä¸æ˜¯ä¸€ä¸ªæ­£å¼ç‰ˆã€‚1996å¹´5æœˆï¼ŒHTTP 1.0 ä½œä¸º HTTP çš„ç¬¬ä¸€ä¸ªæ­£å¼ç‰ˆæœ¬æ­£å¼å…¬å¸ƒï¼Œå¹¶è®°è½½äº <a href="https://tools.ietf.org/html/rfc1945">RFC1945</a> ä¸­ã€‚</p><p>éšç€äººä»¬å¯¹äº’è”ç½‘çš„è®¤çŸ¥å’ŒæŠ€æœ¯çš„å‘å±•ï¼ˆå°¤å…¶æ˜¯æµè§ˆå™¨ç­‰ç›¸å…³çš„æŠ€æœ¯ï¼‰ï¼Œå‘ç° HTTP 1.0 ç¼ºç‚¹è¿˜æ˜¯æ¯”è¾ƒå¤šï¼Œæ— æ³•æ»¡è¶³å¿«é€Ÿçš„äº’è”ç½‘å‘å±•éœ€æ±‚ã€‚äºæ˜¯åœ¨1997å¹´1æœˆå‘å¸ƒäº† HTTP 1.1 ç‰ˆæœ¬ï¼Œå¹¶è®°è½½äº <a href="https://www.ietf.org/rfc/rfc2068.txt">RFC2068</a> ä¸­ï¼Œåæ¥åœ¨1999å¹´6æœˆï¼Œå¯¹ RFC2068 åˆåšäº†è¡¥å……å’Œä¿®æ­£ï¼Œç§°ä¹‹ä¸º <a href="https://www.ietf.org/rfc/rfc2616.txt">RFC2616</a>, è‡³æ­¤ HTTP 1.1 å¼€å§‹ä¸€ç»Ÿå¤©ä¸‹ï¼Œç›´åˆ°ç°åœ¨ç»å¤§æ•°å¼€å‘è€…ä½¿ç”¨çš„éƒ½æ˜¯ HTTP 1.1 ç‰ˆæœ¬ã€‚</p><p>å¦å¤–ä¸€ä¸ªç‰ˆæœ¬ <a href="https://zh.wikipedia.org/wiki/HTTP/2">HTTP&#x2F;2</a> æ ‡å‡†äº2015å¹´5æœˆä»¥ <a href="https://tools.ietf.org/html/rfc7540">RFC 7540</a> æ­£å¼å‘è¡¨ï¼Œå¤šæ•°ä¸»æµæµè§ˆå™¨å·²ç»åœ¨2015å¹´åº•æ”¯æŒäº†è¯¥åè®®ï¼Œæ—¶éš”å¤šå¹´ï¼ŒHTTP&#x2F;2 æ‰é—®ä¸–ã€‚</p><p>è‹¹æœä» iOS9 å¼€å§‹æ”¯æŒ HTTP2.0ï¼Œå¯¹ iOS å¼€å‘äººå‘˜æ¥è¯´ä» iOS9 å¼€å§‹ NSURLSession å¯ä»¥æ”¯æŒ HTTP2.0 äº†ã€‚ç›®å‰ Android ç»å¤§éƒ¨åˆ†ç³»ç»Ÿä¸æ”¯æŒ HTTP&#x2F;2ï¼ŒAndroid åŸç”Ÿ HttpURLConnection æ¡†æ¶å¹¶ä¸æ”¯æŒ HTTP&#x2F;2ï¼Œä½†å¯ä»¥é€‰ç”¨ä¸‰æ–¹å¼€æºåº“ <a href="http://square.github.io/okhttp/">okhttp</a> ä½œä¸ºç½‘ç»œæ¡†æ¶ï¼ŒAndroid 5.0+ï¼ˆç³»ç»Ÿç‰ˆæœ¬ï¼‰è®¾å¤‡æ‰æ”¯æŒ HTTP&#x2F;2ã€‚æ‰€ä»¥æƒ³å…¨é¢ä½¿ç”¨ HTTP&#x2F;2 è¿˜æ˜¯è¦ä»˜å‡ºä¸€å®šçš„ä»£ä»·ï¼Œä¸è¿‡éšç€æŠ€æœ¯çš„é©æ–°ï¼Œç›¸ä¿¡ HTTP&#x2F;2 å°†ä¼šå¤§æ”¾å…‰å½©ã€‚</p><h2 id="HTTP-ä¸æ–­çš„æ”¹è¿›"><a href="#HTTP-ä¸æ–­çš„æ”¹è¿›" class="headerlink" title="HTTP ä¸æ–­çš„æ”¹è¿›"></a>HTTP ä¸æ–­çš„æ”¹è¿›</h2><p>ç”¨ä¸€å¼ å›¾æ¥æè¿° HTTP çš„ä¸æ–­æ”¹è¿›å’Œæ¼”å˜å²ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/09/16/1.jpg"></p><p>ä¸‹é¢å…·ä½“çœ‹çœ‹è¿™äº›åè®®ç‰ˆæœ¬çš„æ¼”è¿›è¿‡ç¨‹ä¸­ï¼Œç©¶ç«Ÿæ˜¯æ–°å¢å’Œæ”¹è¿›äº†å“ªäº›ä¸œè¥¿ï¼Ÿ</p><h3 id="HTTP-0-9"><a href="#HTTP-0-9" class="headerlink" title="HTTP 0.9"></a>HTTP 0.9</h3><p>HTTP 0.9 å¹¶éå‡ºè‡ªæŸä¸ªæ ‡å‡†åŒ–ç»„ç»‡ï¼Œåªæ˜¯ Tim çš„ä¸ªäººä½œå“è€Œå·²ï¼Œæ¯”è¾ƒç®€å•ã€‚å¯ä»¥å‚é˜…è¿™ç¯‡æ–‡ç«  <a href="https://www.w3.org/Protocols/HTTP/AsImplemented.html">The Original HTTP as defined in 1991</a> ï¼Œè¯¥ç‰ˆæœ¬è§„å®šäº† HTTP ä½¿ç”¨ TCP&#x2F;IP è¿æ¥ï¼ŒHTTP è¯·æ±‚åªæœ‰ä¸€ä¸ªè¯·æ±‚è¡Œï¼Œåªæœ‰ä¸€ä¸ª GET æ–¹æ³•åŠ ä¸Šè¯·æ±‚çš„URIã€‚HTTP å“åº”åˆ™ç›´æ¥è¿”å› HTML æ–‡æœ¬ï¼Œæ²¡æœ‰çŠ¶æ€ç ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰åŠæ³•åŒºåˆ†é”™è¯¯æ¶ˆæ¯å’Œæ­£å¸¸çš„æ–‡æœ¬ã€‚å¯ä»¥çœ‹å‡ºï¼ŒHTTP&#x2F;0.9å¹¶ä¸å®Œå–„ï¼Œä¹Ÿä¸æ˜¯é‚£ä¹ˆå®Œç¾ï¼Œä½†æ˜¯è¿™çš„ç¡®æ˜¯ Tim åšæŒä¸‹æ¥çš„ç»“æ™¶ã€‚</p><h3 id="HTTP-1-0"><a href="#HTTP-1-0" class="headerlink" title="HTTP 1.0"></a>HTTP 1.0</h3><p>HTTP 1.0 å¢åŠ äº†è¯·æ±‚å¤´åŸŸå’Œå“åº”å¤´åŸŸï¼Œå¢åŠ äº† HEAD å’Œ POST æ–¹æ³•ï¼Œå“åº”å¯¹è±¡ä¸å†å±€é™äº HTML æ–‡æœ¬ï¼Œæ”¯æŒé•¿è¿æ¥å’Œç¼“å­˜æœºåˆ¶ç­‰ç­‰ã€‚</p><blockquote><p>HTTP 1.0 å…·ä½“ç‰¹ç‚¹</p></blockquote><p>1.å¯ä»¥å‘é€æ›´å¤šæ ¼å¼çš„å†…å®¹ï¼Œå¦‚å›¾åƒã€è§†é¢‘ã€äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸ä»…ä»…å±€é™äºæ–‡å­—äº†ã€‚</p><p>2.å¢åŠ äº† POST å’Œ HEAD æ–¹æ³•ã€‚</p><p>3.æ”¹å˜äº† HTTP è¯·æ±‚å’Œå›åº”çš„æ ¼å¼ã€‚é™¤äº†æ•°æ®éƒ¨åˆ†ï¼Œæ¯æ¬¡é€šä¿¡éƒ½å¿…é¡»åŒ…æ‹¬å¤´ä¿¡æ¯ï¼ˆHTTP headerï¼‰ï¼Œç”¨æ¥æè¿°ä¸€äº›å…ƒæ•°æ®ï¼Œå³å¢åŠ äº†è¯·æ±‚å¤´ä¿¡æ¯ï¼Œå“åº”æ•°æ®ä¸å†å±€é™äº HTML æ–‡æœ¬ã€‚</p><p>4.æ–°å¢çŠ¶æ€ç ï¼ˆstatus codeï¼‰ã€å¤šå­—ç¬¦é›†æ”¯æŒã€å¤šéƒ¨åˆ†å‘é€ï¼ˆmulti-part typeï¼‰ã€æƒé™ï¼ˆauthorizationï¼‰ã€ç¼“å­˜ï¼ˆcacheï¼‰ã€å†…å®¹ç¼–ç ï¼ˆcontent encodingï¼‰ç­‰åŠŸèƒ½ã€‚</p><p>5.å¢åŠ äº†é•¿è¿æ¥çš„æ”¯æŒï¼Œä¸è¿‡ HTTP 1.0 éœ€è¦åœ¨ request ä¸­å¢åŠ  â€Connectionï¼š keep-aliveâ€œ header æ‰èƒ½å¤Ÿæ”¯æŒï¼Œåé¢è¦è¯´åˆ°çš„ HTTP 1.1 é»˜è®¤å°±æ”¯æŒäº†ã€‚</p><p>å¯ä»¥çœ‹å‡ºï¼ŒHTTP 1.0åœ¨ HTTP 0.9 çš„åŸºç¡€ä¸Šåšäº†å¤§é‡çš„æ‰©å……å’Œæ”¹è¿›ã€‚</p><blockquote><p>HTTP 1.0 ä¸»è¦ç¼ºç‚¹</p></blockquote><p>1.æ¯æ¬¡è¯·æ±‚éƒ½éœ€è¦å»ºç«‹ TCP è¿æ¥ï¼Œå³æ¯å¯¹ Request&#x2F;Response éƒ½ä½¿ç”¨ä¸€ä¸ªæ–°çš„è¿æ¥ã€‚</p><p>2.ä¸æ”¯æŒæ–­ç‚¹ç»­ä¼ ã€‚</p><h3 id="HTTP-1-1"><a href="#HTTP-1-1" class="headerlink" title="HTTP 1.1"></a>HTTP 1.1</h3><p>æ¯ä¸ªæ–°ç‰ˆæœ¬çš„è¯ç”ŸåŸºæœ¬éƒ½æ˜¯å¯¹ä¸Šä¸€ä¸ªç‰ˆæœ¬çš„è¡¥å……å’Œæ”¹è¿›ï¼Œå°±åƒæˆ‘ä»¬çš„è½¯ä»¶å¼€å‘ä¸€æ ·ï¼Œåè®®ä¹Ÿéœ€è¦è¿­ä»£ã€‚</p><blockquote><p>HTTP 1.1 å…·ä½“ç‰¹ç‚¹</p></blockquote><p>1.åŠ å¼ºå’Œä¼˜åŒ–äº†æŒä¹…è¿æ¥å³é•¿è¿æ¥ã€‚</p><p>HTTP 1.1 æ”¯æŒé•¿è¿æ¥ï¼ˆPersistent Connectionï¼‰å’Œè¯·æ±‚çš„æµæ°´çº¿ï¼ˆPipeliningï¼‰å¤„ç†ï¼Œåœ¨ä¸€ä¸ª TCP è¿æ¥ä¸Šå¯ä»¥ä¼ é€å¤šä¸ª HTTP è¯·æ±‚å’Œå“åº”ï¼Œå‡å°‘äº†å»ºç«‹å’Œå…³é—­è¿æ¥çš„æ¶ˆè€—å’Œå»¶è¿Ÿï¼Œåœ¨ HTTP 1.1 ä¸­é»˜è®¤å¼€å¯ <code>Connectionï¼š keep-alive</code>ï¼Œä¸€å®šç¨‹åº¦ä¸Šå¼¥è¡¥äº† HTTP 1.0 æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ›å»ºè¿æ¥çš„ç¼ºç‚¹ã€‚</p><p>2.å¢å¼ºäº†ç¼“å­˜æœºåˆ¶ã€‚</p><p>å¼•å…¥äº†æ›´å¤šçš„ç¼“å­˜æ§åˆ¶ç­–ç•¥ä¾‹å¦‚ Entity tagï¼ŒIf-Unmodified-Since, If-Match, If-None-Match ç­‰å¯ä¾›é€‰æ‹©çš„ç¼“å­˜å¤´ã€‚</p><p>3.è¯·æ±‚å¤´å¼•å…¥äº† range å¤´åŸŸã€‚</p><p>å®ƒå…è®¸åªè¯·æ±‚èµ„æºçš„æŸä¸ªéƒ¨åˆ†ï¼Œå³è¿”å›ç æ˜¯ 206ï¼ˆPartial Contentï¼‰ï¼Œè¿™æ ·å°±æ–¹ä¾¿äº†å¼€å‘è€…è‡ªç”±çš„é€‰æ‹©ä»¥ä¾¿äºå……åˆ†åˆ©ç”¨å¸¦å®½å’Œè¿æ¥ã€‚</p><p>4.å°† Content-length å­—æ®µçš„ä½œç”¨è¿›è¡Œæ‰©å……ï¼Œå³å£°æ˜æœ¬æ¬¡å›åº”çš„æ•°æ®é•¿åº¦ï¼ˆä¸€ä¸ªTCPè¿æ¥ç°åœ¨å¯ä»¥ä¼ é€å¤šä¸ªå›åº”ï¼ŒåŠ¿å¿…å°±è¦æœ‰ä¸€ç§æœºåˆ¶ï¼ŒåŒºåˆ†æ•°æ®åŒ…æ˜¯å±äºå“ªä¸€ä¸ªå›åº”çš„ï¼‰ã€‚</p><p>5.é‡‡ç”¨åˆ†å—ä¼ è¾“ç¼–ç ã€‚</p><p>å¯¹äºä¸€äº›å¾ˆè€—æ—¶çš„åŠ¨æ€æ“ä½œï¼ŒæœåŠ¡å™¨éœ€è¦ç­‰åˆ°æ‰€æœ‰æ“ä½œå®Œæˆï¼Œæ‰èƒ½å‘é€æ•°æ®ï¼Œæ˜¾ç„¶è¿™æ ·çš„æ•ˆç‡ä¸é«˜ã€‚æ›´å¥½çš„å¤„ç†æ–¹æ³•æ˜¯ï¼Œäº§ç”Ÿä¸€å—æ•°æ®ï¼Œå°±å‘é€ä¸€å—ï¼Œé‡‡ç”¨æµæ¨¡å¼ï¼ˆstreamï¼‰å–ä»£ç¼“å­˜æ¨¡å¼ï¼ˆbufferï¼‰ã€‚</p><p>6.æ–°å¢äº†è®¸å¤šåŠ¨è¯æ–¹æ³•ï¼šPUTã€PATCHã€HEADã€OPTIONSã€DELETEã€‚å¦å¤–ï¼Œå®¢æˆ·ç«¯è¯·æ±‚çš„å¤´ä¿¡æ¯æ–°å¢äº† Host å­—æ®µï¼Œç”¨æ¥æŒ‡å®šæœåŠ¡å™¨çš„åŸŸåã€‚</p><p>7.æ–°å¢äº† 24 ä¸ªé”™è¯¯çŠ¶æ€å“åº”ç ã€‚</p><blockquote><p>HTTP 1.0 ä¸»è¦ç¼ºç‚¹</p></blockquote><p>HTTP 1.1 è™½ç„¶å¢åŠ äº†å¾ˆå¤šåŠŸèƒ½ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå·²ç»å¾ˆå¼ºå¤§äº†ï¼Œä½†æ˜¯ä»–è‡ªèº«ä¹Ÿæ˜¯æœ‰ç¼ºç‚¹çš„ï¼Œæ¢å¥è¯è¯´æœ‰ä¼˜åŒ–çš„ç©ºé—´ï¼Œä¸»è¦é—®é¢˜å¦‚ä¸‹ï¼š</p><p>1.é˜Ÿå¤´å µå¡ï¼ˆHead-of-line blockingï¼‰ï¼Œå„ä¸ªè¯·æ±‚åˆ°è¾¾çš„æœåŠ¡å™¨çš„é€Ÿåº¦æ˜¯ä¸åŒçš„ï¼Œå¦‚æœå…ˆå‘çš„è¯·æ±‚å…ˆåˆ°è¾¾å¯èƒ½ä¼šå‘ç”Ÿé˜»å¡ï¼Œå‰©ä¸‹æ‰€æœ‰çš„å·¥ä½œéƒ½ä¼šè¢«é˜»å¡åœ¨é‚£æ¬¡è¯·æ±‚åº”ç­”ä¹‹åï¼Œè¿™æ ·å°±é™ä½äº†å¸¦å®½ã€‚</p><p>ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼šä¸€æ˜¯å‡å°‘è¯·æ±‚æ•°ï¼ŒäºŒæ˜¯åŒæ—¶å¤šå¼€æŒä¹…è¿æ¥ã€‚</p><p>2.è‡ƒè‚¿çš„æ¶ˆæ¯å¤´éƒ¨</p><p>3.ä¸æ”¯æŒæœåŠ¡ç«¯æ¨é€ï¼Œä¾‹å¦‚è¦æ±‚ä½¿ç”¨ HTTP åè®®åšä¸€ä¸ªæœåŠ¡ç«¯æ•°æ®å˜åŠ¨é¡µé¢ç«‹å³æ”¹å˜çš„ç»„ä»¶å°±ä¸å¥½åšï¼Œå¯ç”¨è½®è¯¢çš„æ–¹å¼è¿›è¡Œï¼Œè¿™æ ·å°±ä¼šå¯¹å¸¦å®½å½±å“è¾ƒå¤§ã€‚</p><h3 id="SPDY"><a href="#SPDY" class="headerlink" title="SPDY"></a>SPDY</h3><p>åœ¨è¯´åˆ° HTTP&#x2F;2 ä¹‹å‰ï¼Œå¿…é¡»è¦å…ˆè¯´è¯´ <a href="https://zh.wikipedia.org/wiki/SPDY">SPDY</a>ã€‚SPDY æ˜¯ç”± Google å…¬å¸æ¨å‡ºçš„ï¼ŒSPDY çš„æ¨å‡ºæ˜¯ä¸ºäº†è§£å†³ HTTP 1.1 ä¸­å­˜åœ¨çš„ä¸€äº›é—®é¢˜çš„ã€‚</p><p>1.å¤šè·¯å¤ç”¨ï¼ˆmultiplexingï¼‰</p><p>å¤šè·¯å¤ç”¨é€šè¿‡å¤šä¸ªè¯·æ±‚ stream å…±äº«ä¸€ä¸ª TCP è¿æ¥çš„æ–¹å¼ï¼Œè§£å†³äº†HOL blocking çš„é—®é¢˜ï¼Œé™ä½äº†å»¶è¿ŸåŒæ—¶æé«˜äº†å¸¦å®½çš„åˆ©ç”¨ç‡ã€‚</p><p>2.å¯ä»¥å¯¹è¯·æ±‚è®¾ç½®ä¼˜å…ˆçº§</p><p>å¤šè·¯å¤ç”¨å¸¦æ¥ä¸€ä¸ªæ–°çš„é—®é¢˜æ˜¯ï¼Œåœ¨è¿æ¥å…±äº«çš„åŸºç¡€ä¹‹ä¸Šæœ‰å¯èƒ½ä¼šå¯¼è‡´å…³é”®è¯·æ±‚è¢«é˜»å¡ã€‚SPDYå…è®¸ç»™æ¯ä¸ªrequestè®¾ç½®ä¼˜å…ˆçº§ï¼Œè¿™æ ·é‡è¦çš„è¯·æ±‚å°±ä¼šä¼˜å…ˆå¾—åˆ°å“åº”ã€‚æ¯”å¦‚æµè§ˆå™¨åŠ è½½é¦–é¡µï¼Œé¦–é¡µçš„htmlå†…å®¹åº”è¯¥ä¼˜å…ˆå±•ç¤ºï¼Œä¹‹åæ‰æ˜¯å„ç§é™æ€èµ„æºæ–‡ä»¶ï¼Œè„šæœ¬æ–‡ä»¶ç­‰åŠ è½½ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ç”¨æˆ·èƒ½ç¬¬ä¸€æ—¶é—´çœ‹åˆ°ç½‘é¡µå†…å®¹ã€‚</p><p>3.å¯¹è¯·æ±‚å¤´çš„å‹ç¼©</p><p>é€‰æ‹©åˆé€‚çš„å‹ç¼©ç®—æ³•å¯ä»¥å‡å°åŒ…çš„å¤§å°å’Œæ•°é‡ï¼Œè¿™æ ·åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥æé«˜ç½‘ç»œä½¿ç”¨æ•ˆç‡ã€‚</p><p>4.ä¸ºäº†æ•°æ®ä¼ è¾“çš„å®‰å…¨æ€§ï¼Œå¼ºåˆ¶ä½¿ç”¨åŸºäº HTTPS çš„åŠ å¯†åè®®ä¼ è¾“ã€‚</p><p>5.æ”¯æŒæœåŠ¡ç«¯æ¨é€ã€‚</p><p>ç§°ä¹‹ä¸º Server Push åŠŸèƒ½ï¼ŒæœåŠ¡å™¨åœ¨è¿˜æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨å°±å¯ä»¥æŠŠå„ç§èµ„æºæ¨é€ç»™å®¢æˆ·ç«¯ã€‚</p><p>æ¯”å¦‚ï¼Œå®¢æˆ·ç«¯åªè¯·æ±‚äº† index.htmlï¼Œä½†æ˜¯æœåŠ¡å™¨æŠŠ index.htmlã€x.cssã€x.jpg ç­‰èµ„æºå…¨éƒ¨å‘é€ç»™å®¢æˆ·ç«¯ã€‚è¿™æ ·çš„è¯ï¼Œåªéœ€è¦ä¸€è½® HTTP é€šä¿¡ï¼Œå®¢æˆ·ç«¯å°±å¾—åˆ°äº†å…¨éƒ¨èµ„æºï¼Œæé«˜äº†é€šä¿¡çš„æ€§èƒ½ï¼Œä¹Ÿæé«˜äº†ç”¨æˆ·ä½“éªŒã€‚</p><h3 id="HTTP-x2F-2"><a href="#HTTP-x2F-2" class="headerlink" title="HTTP&#x2F;2"></a>HTTP&#x2F;2</h3><p>æœ¬è´¨ä¸Šæ¥è®²ï¼ŒHTTP&#x2F;2 æ˜¯å»ºç«‹åœ¨ SPDY åŸºç¡€ä¹‹ä¸Šçš„ï¼Œå€Ÿé‰´äº†å¾ˆå¤š SPDY çš„è®¾è®¡æ€æƒ³å’Œç­–ç•¥ã€‚ HTTP å…·æœ‰ SPDY çš„ä¼˜ç‚¹ï¼ŒåŒæ—¶è‡ªå·±ä¹Ÿæœ‰ä¸ SPDY çš„ä¸åŒç‚¹ï¼Œä¸»è¦å¦‚ä¸‹ï¼š</p><p>1.HTTP&#x2F;2 æ”¯æŒæ˜æ–‡ HTTP ä¼ è¾“ï¼Œè€Œ SPDY å¼ºåˆ¶ä½¿ç”¨ HTTPSã€‚è¿™ä¸€ç‚¹ HTTP&#x2F;2 ç›¸å¯¹äººæ€§åŒ–ä¸€äº›ã€‚</p><p>2.HTTP&#x2F;2 ä¼šå¯¹è¯·æ±‚å¤´å’Œå“åº”å¤´åšå‹ç¼©ä»¥æå‡è¯·æ±‚æ€§èƒ½ï¼ŒHTTP&#x2F;2 æ¶ˆæ¯å¤´çš„å‹ç¼©ç®—æ³•ä¸åŒäº SPDYã€‚ HTTP&#x2F;2 é‡‡ç”¨ <a href="http://http2.github.io/http2-spec/compression.html">HPACK</a>ï¼ŒSPDY é‡‡ç”¨çš„ <a href="http://zh.wikipedia.org/wiki/DEFLATE">DEFLATE</a> ç®—æ³•ã€‚</p><p>HTTP&#x2F;2 æ”¯æŒæ‰€æœ‰çš„ HTTP 1.1 çš„æ ¸å¿ƒç‰¹å¾ï¼Œå…¶æä¾›äº† HTTP è¯­ä¹‰çš„ä¼ è¾“ä¼˜åŒ–ï¼Œå¹¶ä¸”åœ¨å„æ–¹é¢åšåˆ°æ›´é«˜æ•ˆã€‚HTTP&#x2F;2 çš„å¤´ä¿¡æ¯æ˜¯ä¸€ä¸ªå½»åº•çš„äºŒè¿›åˆ¶åè®®ï¼Œå¤´ä¿¡æ¯å’Œæ•°æ®ä½“éƒ½æ˜¯äºŒè¿›åˆ¶ï¼Œå¹¶ä¸”ç»Ÿç§°ä¸ºå¸§ï¼ˆframeï¼‰ï¼Œå³å¤´ä¿¡æ¯å¸§å’Œæ•°æ®å¸§ã€‚å¯¹ HTTP&#x2F;2 æ„Ÿå…´è¶£çš„å¯ä»¥çœ‹ä¸€ä¸‹ <a href="https://www.jianshu.com/p/40378501d1fc">HTTP2 åè®®åˆè¯†</a> è¿™ç¯‡æ–‡ç« ã€‚</p><h2 id="æ¨èæ–‡ç« "><a href="#æ¨èæ–‡ç« " class="headerlink" title="æ¨èæ–‡ç« "></a>æ¨èæ–‡ç« </h2><ul><li><p><a href="http://www.veryitman.com/2017/02/06/ATS-HTTP-HTTPS-%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D/">ATS: HTTP&#x2F;HTTPS åè®®ä»‹ç»</a></p></li><li><p><a href="http://www.veryitman.com/2017/02/08/ATS-HTTPS-%E8%AE%A4%E8%AF%81/">ATS: HTTPS è®¤è¯</a></p></li></ul><hr><p><strong>æ²¡æœ‰äººèƒ½ç…§é¡¾ä½ ä¸€è¾ˆå­ï¼Œä½ è‡ªå·±å¿…é¡»æ…¢æ…¢å¼ºå¤§èµ·æ¥~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œåè®® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Wireshark udp http https spdy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Wireshark: ç®€å•åˆ†æ TCP ä¸‰æ¬¡æŒ¥æ‰‹</title>
      <link href="/2018/09/09/Wireshark-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-TCP-%E4%B8%89%E6%AC%A1%E6%8C%A5%E6%89%8B/"/>
      <url>/2018/09/09/Wireshark-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-TCP-%E4%B8%89%E6%AC%A1%E6%8C%A5%E6%89%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="è¯è¯´æ¡æ‰‹"><a href="#è¯è¯´æ¡æ‰‹" class="headerlink" title="è¯è¯´æ¡æ‰‹"></a>è¯è¯´æ¡æ‰‹</h2><p>ä½ è¦æ˜¯å¼€å‘äººå‘˜ï¼Œç›¸ä¿¡ä½ ä¸€å®šå¬è¯´è¿‡ TCPï¼ˆTransmission Control Protocol ä¼ è¾“æ§åˆ¶åè®®ï¼‰æˆ–æ˜¯ TCP æ¡æ‰‹çš„è¯´æ³•ã€‚</p><p>æ‰€è°“<strong>æ¡æ‰‹</strong>ï¼Œé€šä¿—æ¥è®²å°±æ˜¯é€šä¿¡åŒæ–¹åå•†åœ¨åç»­é€šä¿¡è¿‡ç¨‹ä¸­éœ€è¦ä½¿ç”¨çš„é€šä¿¡ä¿¡æ¯çš„è¿‡ç¨‹ã€‚TCP ä¸ºäº†å»ºç«‹å¯é çš„è¿æ¥éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œåç»­ç»™å¤§å®¶åˆ†äº« TLS ä¸ºäº†å®ç°åŠ å¯†ã€æ ¡éªŒã€èº«ä»½è®¤è¯åŒæ ·éœ€è¦æ¡æ‰‹çš„è¿‡ç¨‹ã€‚</p><p>TCP ä¸‰æ¬¡æ¡æ‰‹å¯ä»¥ä½¿ç”¨ä¸‹å›¾æ¥è¡¨è¾¾ï¼š<br><img src="/upload/images/2018/09/09/1.jpg"></p><p>æœ¬ç¯‡ç»™å¤§å®¶åˆ†äº«å¦‚ä½•ä½¿ç”¨ <code>Wireshark</code> æ¥è·Ÿè¸ª HTTP åŒ…ï¼ŒæŸ¥çœ‹ TCP æ¡æ‰‹çš„è¿‡ç¨‹ã€‚</p><p>åœ¨çœ‹ä¸‹é¢å†…å®¹ä¹‹å‰ï¼Œå…ˆç®€å•çœ‹ä¸€ä¸‹ TCP åè®®æŠ¥å¤´ã€‚</p><p>ä¸‹å›¾æ˜¯ TCP æŠ¥å¤´çš„æ ¼å¼ï¼š<br><img src="/upload/images/2018/09/09/2.png"></p><p>å…¶ä¸­ï¼ŒSeq(Sequence Number) æ˜¯ 32 ä½çš„åºåˆ—å·ï¼Œ<code>Acknowledgment number</code> ç§°ä¹‹ä¸ºç¡®è®¤åºå·ï¼Œä¹Ÿæ˜¯ 32 ä½çš„ï¼Œä½†æ˜¯ä»–ä¸æ˜¯æ ‡å¿—ä½ ACKï¼Œè¿™ä¸ªè¦åŒºåˆ«å¼€ï¼Œå½“ ACK ç½® 1 æ—¶ <code>Acknowledgment number</code> æ‰æœ‰æ•ˆï¼ŒæŒ‡æ¥æ”¶æ–¹æœŸå¾…çš„ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µçš„åºåˆ—å·ã€‚</p><p>TCP æŠ¥å¤´ä¿¡æ¯ä¸­æœ‰å…­ä¸ªæ§åˆ¶ä½(æ ‡å¿—ä½)ï¼Œåˆ†åˆ«æ˜¯ï¼šSYNã€ACKã€PSHã€FINã€RST å’Œ URGã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SYN: è¡¨ç¤ºå»ºç«‹è¿æ¥</span><br><span class="line">FIN: è¡¨ç¤ºå…³é—­è¿æ¥</span><br><span class="line">ACK: è¡¨ç¤ºå“åº”</span><br><span class="line">PSH: è¡¨ç¤ºæœ‰æ•°æ®ä¼ è¾“</span><br><span class="line">RST: è¡¨ç¤ºè¿æ¥é‡ç½®</span><br><span class="line">URG: è¡¨ç¤ºç´§æ€¥æ•°æ®</span><br></pre></td></tr></table></figure><p><strong>Seq åºåˆ—å·æœ‰ä¸¤ä¸ªä½œç”¨ï¼š</strong><br>ç¬¬ä¸€ï¼Œåœ¨ SYN ç½® 1 æ—¶ï¼Œæ­¤ä¸ºå½“å‰è¿æ¥çš„åˆå§‹åºåˆ—å·(Initial Sequence Number, ISN)è¯¥å€¼æ˜¯ä¸ªéšæœºå€¼ï¼Œæ•°æ®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚åºå·ä¸ºæ­¤ ISN+1ã€‚</p><p>ç¬¬äºŒï¼Œåœ¨ SYN ç½® 0 æ—¶ï¼Œä¸ºå½“å‰è¿æ¥æŠ¥æ–‡æ®µçš„ç´¯è®¡æ•°æ®åŒ…å­—èŠ‚æ•°ã€‚</p><p>TCP åè®®è®¾è®¡æ¯”è¾ƒå¤æ‚ï¼Œå…¶æ¶‰åŠçš„çŸ¥è¯†è¾ƒå¤šï¼Œè¿™é‡Œå¤§å®¶æ•´ä¸æ˜ç™½ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œå¹¶ä¸å½±å“ä½ é˜…è¯»ä¸‹é¢çš„å†…å®¹ï¼Œå¦‚æœå¯¹ TCP åè®®æœ¬èº«æ„Ÿå…´è¶£ï¼Œå¯ä»¥å»æ‹œè¯»ã€TCP&#x2F;IP è¯¦è§£ï¼Œå· 1ï¼šåè®®ã€‘è¿™æœ¬ä¹¦ã€‚</p><h2 id="ç½‘ç»œæ¨¡å‹"><a href="#ç½‘ç»œæ¨¡å‹" class="headerlink" title="ç½‘ç»œæ¨¡å‹"></a>ç½‘ç»œæ¨¡å‹</h2><p>æ¯æ¬¡è¯´åˆ°ç½‘ç»œå±‚ï¼Œå°±è¦æ‹¿å‡ºç±»ä¼¼ä¸‹é¢çš„ç½‘ç»œæ¨¡å‹å›¾ï¼ŒOSI å°†ç½‘ç»œæ¨¡å‹åˆ†ä¸º7å±‚ï¼ŒTCP&#x2F;IP æ¨¡å‹å°†ç½‘ç»œæ¨¡å‹åˆ†ä¸º 4 å±‚ï¼Œç½‘ç»œ 4 å±‚æ¨¡å‹ç”± 7 å±‚æ¨¡å‹ç®€åŒ–åˆå¹¶è€Œæ¥ï¼Œæ²¡æœ‰æœ¬è´¨çš„åŒºåˆ«ï¼Œå¦‚å›¾ï¼š<br><img src="/upload/images/2018/09/09/3.jpg"></p><p>HTTP ä»…ä»…æ˜¯ä¸ªåè®®ï¼Œå±äºåº”ç”¨å±‚çš„é¢å‘å¯¹è±¡çš„åè®®ï¼Œä»ä¸Šå›¾å¯ä»¥çœ‹å‡º HTTP æ˜¯åœ¨ TCP åŸºç¡€ä¹‹ä¸Šçš„ã€‚</p><blockquote><p>HTTP åè®®ä¸€å…±æœ‰äº”å¤§ç‰¹ç‚¹</p></blockquote><p><em>1ã€æ”¯æŒå®¢æˆ·&#x2F;æœåŠ¡å™¨æ¨¡å¼</em><br><em>2ã€ç®€å•å¿«é€Ÿ</em><br><em>3ã€çµæ´»</em><br><em>4ã€æ— è¿æ¥</em><br><em>5ã€æ— çŠ¶æ€</em></p><p>è¿™é‡Œå¼ºè°ƒä¸€ä¸‹ <strong>æ— è¿æ¥</strong> å’Œ <strong>æ— çŠ¶æ€</strong> è¿™ä¸¤ä¸ªç‰¹ç‚¹ã€‚</p><p><strong>æ— è¿æ¥</strong>ï¼ŒæŒ‡çš„æ˜¯é™åˆ¶æ¯æ¬¡è¿æ¥åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ã€‚æœåŠ¡å™¨å¤„ç†å®Œå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¹¶æ”¶åˆ°å®¢æˆ·ç«¯çš„åº”ç­”åï¼Œå³æ–­å¼€è¿æ¥ã€‚é‡‡ç”¨è¿™ç§æ–¹å¼å¯ä»¥èŠ‚çœä¼ è¾“æ—¶é—´ã€‚<code>Keep-Alive</code> ç‰¹æ€§ä¸åœ¨æœ¬ç¯‡è®¨è®ºèŒƒå›´ï¼Œæš‚æ—¶ä½ å¯ä»¥å°†å…¶å¿½ç•¥ã€‚</p><p><strong>æ— çŠ¶æ€</strong>ï¼ŒæŒ‡çš„æ˜¯åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ï¼ŒæœåŠ¡å™¨ä¸çŸ¥é“å®¢æˆ·ç«¯æ˜¯ä»€ä¹ˆçŠ¶æ€ã€‚å³æˆ‘ä»¬ç»™æœåŠ¡å™¨å‘é€ HTTP è¯·æ±‚ä¹‹åï¼ŒæœåŠ¡å™¨æ ¹æ®è¯·æ±‚ï¼Œä¼šç»™æˆ‘ä»¬å‘é€æ•°æ®è¿‡æ¥ï¼Œä½†æ˜¯å‘é€å®Œï¼Œä¸ä¼šè®°å½•ä»»ä½•ä¿¡æ¯ã€‚</p><p>å¯ä»¥åˆ©ç”¨ HTTP çš„è¿™ä¸¤ä¸ªç‰¹ç‚¹æ¥åˆ†æ TCP ä¸‰æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹ã€‚</p><h2 id="ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹"><a href="#ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹" class="headerlink" title="ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹"></a>ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹</h2><p>ä¸‰æ¬¡è¿‡ç¨‹å¦‚ä¸‹é¢è‰å›¾ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2018/09/09/8.jpg"></p><p>æˆ‘ä»¬ç”¨å®é™…ä¾‹å­æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹ï¼Œä»¥ GET è¯·æ±‚ä¸‹é¢åœ°å€ä¸ºä¾‹ï¼Œä½¿ç”¨ <code>Wireshark</code> æŠ“åŒ…ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.baidu.com/news/detailV3.html?id=1279391&amp;COMMON_ACCESS_TOKEN=(null)&amp;COMMON_ACCESS_TOKEN_SECRET=(null)&amp;_cT=IOS&amp;_cV=3.1.3&amp;_cA=PM</span><br></pre></td></tr></table></figure><p>çœ‹è¿”å›ç»“æœï¼Œé€‰ä¸­ <code>HTTP/1.1 200 OK</code> å³é”®, åœ¨å¼¹å‡ºæ¡†ä¸­é€‰æ‹© <code>Follow/TCP Stream</code>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/09/09/4.jpg"></p><p>å…³é—­å¼¹å‡ºçš„å¼¹çª—ï¼Œå›åˆ°ä¸»ç•Œé¢ï¼Œçœ‹åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ä¸‰æ¬¡ï¼ˆçº¢è‰² 1ã€2ã€3å¤„ï¼‰ TCP æ¡æ‰‹è¿‡ç¨‹ï¼š<br><img src="/upload/images/2018/09/09/5.jpg"></p><p>ç¬¬ä¸€æ¬¡ï¼Œè¯·æ±‚å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª [SYN] åŒ…ï¼Œåºåˆ—å·æ˜¯ 0ï¼ˆseq&#x3D;0ï¼‰ã€‚</p><p>ç¬¬äºŒæ¬¡ï¼ŒæœåŠ¡å™¨æ”¶åˆ° [SYN] åŒ…ï¼Œç„¶åä¼šå‘é€ä¸€ä¸ª [SYN, ACK] åŒ…ï¼Œåºåˆ—å·æ˜¯ 0ï¼ŒACK ç½® 1ï¼ˆseq&#x3D;0ï¼Œack&#x3D;1ï¼‰ã€‚</p><p>ç¬¬ä¸‰æ¬¡ï¼Œå®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯ä¼šå‘é€ä¸€ä¸ª [ACK] åŒ…ï¼Œåºåˆ—å·æ˜¯ 1ï¼ŒAck ç½® 1ï¼ˆseq&#x3D;1ï¼Œack&#x3D;1ï¼‰æ¥å›å¤æœåŠ¡å™¨ã€‚</p><p><strong>è¿™é‡Œæ³¨æ„ä¸€ä¸‹</strong>ï¼Œå¤§å†™çš„ <code>ACK</code> æ˜¯ä¸€ä¸ª bit ä½è¡¨ç¤ºç¡®è®¤ï¼Œå°å†™çš„ <code>ack</code> æ˜¯ä¸€ä¸ªç¡®è®¤åºåˆ—å·ï¼Œè¡¨ç¤ºæ•°å€¼ã€‚</p><p>ç®€å•çš„ç”»ä¸€ä¸ªè‰å›¾ï¼Œå¦‚ä¸‹ï¼š<br><img src="/upload/images/2018/09/09/6.jpg"></p><p><strong>è¿™ä¸ªè¿‡ç¨‹ï¼Œç®€å•æè¿°ä¸ºä¸‹é¢ä¸‰ä¸ªæ­¥éª¤ï¼š</strong></p><p>åŒæ–¹åœ¨å»ºç«‹è¿æ¥ä¹‹å‰éƒ½å¤„äº CLOSED çš„çŠ¶æ€ã€‚</p><p>1ã€å‘é€æ–¹ç»™æ¥æ”¶æ–¹å‘é€ SYN ä¿¡å·ï¼Œæ­¤æ—¶å‘é€æ–¹å¤„äº <code>SYN_SENT</code> çŠ¶æ€ã€‚<br>2ã€æ¥æ”¶æ–¹ç¡®è®¤å¹¶å›å¤ç»™å‘é€æ–¹ SYN&#x2F;ACK ä¿¡å·ï¼Œæ­¤æ—¶æ¥æ”¶æ–¹å¤„äº <code>SYN_RCVD</code> çŠ¶æ€ã€‚<br>3ã€å‘é€æ–¹ç»™æ¥æ”¶æ–¹å‘é€ç¡®è®¤ ACK ä¿¡å·ï¼Œå‘é€å®Œæ¯•åï¼Œå‘é€æ–¹(å®¢æˆ·ç«¯)è¿›å…¥ <code>ESTABLISHED</code> çŠ¶æ€ï¼Œå½“æ¥æ”¶ç«¯(æœåŠ¡ç«¯)æ¥æ”¶åˆ°è¿™ä¸ªåŒ…æ—¶ï¼Œä¹Ÿè¿›å…¥ <code>ESTABLISHED</code> çŠ¶æ€ï¼ŒTCP æ¡æ‰‹ç»“æŸã€‚</p><p>ä¸Šé¢çš„æ­¥éª¤ï¼Œå»ºè®®æ„Ÿå…´è¶£çš„æœ‹å‹å»å®é™…æ“ä½œä¸€ä¸‹ã€‚</p><h2 id="ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹"><a href="#ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹"></a>ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹</h2><p>å›å¤´å†æ¥æƒ³ä¸€æƒ³ï¼ŒTCP çš„è¿æ¥ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹å‘¢ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯ä¸€æ¬¡ï¼Œä¸¤æ¬¡å‘¢ï¼Ÿä¸€æ¬¡ä¸å°±æŒºå¥½å—ï¼Œä¸‰æ¬¡æ˜¯ä¸æ˜¯æœ‰ç‚¹å¤šæ­¤ä¸€ä¸¾äº†ï¼Ÿ</p><p>TCP åè®®ä¸æ˜¯ä¸€ä¸ªäººå®šå‡ºæ¥çš„è€Œæ˜¯ä¸€ç¾¤äººæ‹Ÿå®šçš„ï¼Œè®¾è®¡ä¸‰æ¬¡æ¡æ‰‹å›ºç„¶æœ‰å®ƒçš„æ„ä¹‰ï¼Œæ˜¯ç»è¿‡ç²¾å¿ƒè®¾è®¡ä¸”åœ¨æ€§èƒ½å’Œæ•ˆç‡ä¸Šé¢è¡¡é‡è¿‡çš„ã€‚</p><p>åœ¨çŸ¥ä¹ <a href="https://www.zhihu.com/question/24853633">TCP ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œè€Œä¸æ˜¯ä¸¤æ¬¡æˆ–å››æ¬¡ï¼Ÿ</a> ä¸Šé¢æœ‰ä¸é”™çš„ç­”æ¡ˆï¼Œè™½ç„¶æœ‰äº›å›ç­”æ¯”è¾ƒæç¬‘ï¼Œä½†æ˜¯å¾ˆå¥½ç†è§£ï¼Œæ¯”å¦‚è¿™ä½ä»å…„ï¼š<br><img src="/upload/images/2018/09/09/7.jpg"></p><p>æˆ‘ä»¬ä¸å¦¨æ¢ä¸ªæ€è·¯æ¥æƒ³è¿™ä¸ªé—®é¢˜ï¼ŒTCP åè®®è®¾è®¡åˆè¡·æ˜¯ <code>è®©æ•°æ®è¿›è¡Œå¯é ï¼Œé«˜æ•ˆï¼Œå®‰å…¨çš„ä¼ è¾“</code>ï¼Œå¦‚æœæ¡æ‰‹æ˜¯ä¸€æ¬¡ï¼Œä¸¤æ¬¡æˆ–å››æ¬¡ï¼Œå°±æ— æ³•å¾ˆå¥½çš„ä¿è¯ TCP çš„ <code>å¯é ï¼Œå®‰å…¨åŠé«˜æ•ˆ</code> çš„ä¼ è¾“ï¼Œè¯´ä¸å®šå“ªå¤©æœ‰äººè®¾è®¡å‡ºæ¥ä¸€ç§å¯æ›¿ä»£ TCP åè®®çš„å…¶ä»–åè®®å°±æ˜¯ä¸¤æ¬¡æ¡æ‰‹æˆ–è€…ä¸éœ€è¦æ¡æ‰‹ï¼Œå“ˆå“ˆï¼</p><h2 id="å‚è€ƒé˜…è¯»"><a href="#å‚è€ƒé˜…è¯»" class="headerlink" title="å‚è€ƒé˜…è¯»"></a>å‚è€ƒé˜…è¯»</h2><p><a href="https://cloud.tencent.com/info/d6b27fce815445c3c5f783a39ec204f6.html">å¦‚ä½•ç†è§£HTTPåè®®çš„â€œæ— è¿æ¥ï¼Œæ— çŠ¶æ€â€ç‰¹ç‚¹?</a></p><p><a href="https://www.zhihu.com/question/24853633">TCP ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œè€Œä¸æ˜¯ä¸¤æ¬¡æˆ–å››æ¬¡ï¼Ÿ</a></p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œåè®® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Wireshark tcp ip udp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Wiresharkï¼šæŠ“å– HTTP åŒ…</title>
      <link href="/2018/09/01/Wireshark%EF%BC%9A%E6%8A%93%E5%8F%96-HTTP-%E5%8C%85/"/>
      <url>/2018/09/01/Wireshark%EF%BC%9A%E6%8A%93%E5%8F%96-HTTP-%E5%8C%85/</url>
      
        <content type="html"><![CDATA[<p>å¹¿å‘Šæ—¶é—´ï¼Œè§è°…å‹¿æ€ªï¼Œçœ‹åˆ°äº†å°±ç‚¹ä¸€ä¸‹å§ï¼Œæ„Ÿæ¿€ä¸å°½ğŸ™‡â€ï¼</p><hr><p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚</p><p>ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><hr><h2 id="å¼€ç¯‡ç®€è¦"><a href="#å¼€ç¯‡ç®€è¦" class="headerlink" title="å¼€ç¯‡ç®€è¦"></a>å¼€ç¯‡ç®€è¦</h2><p><a href="http://www.veryitman.com/2018/08/20/%E5%88%9D%E8%AF%86-Wireshark/">åˆè¯† Wireshark</a> ç®€å•ä»‹ç»äº†å¼ºå¤§çš„ <code>Wireshark</code> å·¥å…·ï¼Œæƒ³ç”¨å¥½æˆ–è€…æ˜¯è¯´æƒ³å‘æŒ¥ <code>Wireshark</code> çš„å·¨å¤§å¨åŠ›ï¼Œè¿˜æœ‰å¾ˆé•¿çš„è·¯è¦èµ°ï¼ˆå¯¹æˆ‘æ¥è¯´ï¼‰ã€‚å­¦ä¹  <code>Wireshark</code> çš„æˆæœ¬è¦æ¯”å…¶ä»–ç½‘ç»œæŠ“åŒ…å·¥å…·çš„æˆæœ¬é«˜ï¼Œæ‰€ä»¥è¯·åšå¥½å­¦ä¹ çš„å‡†å¤‡ã€‚</p><p>æˆ‘èº«è¾¹å¾ˆå¤šå¼€å‘åŒäº‹ï¼Œç”šè‡³åŒ…æ‹¬ä¸€äº›åˆšå…¥èŒçš„æµ‹è¯•å·¥ç¨‹å¸ˆéƒ½ä¸å–œæ¬¢ä½¿ç”¨æŠ“åŒ…å·¥å…·ï¼Œé‡åˆ°é—®é¢˜å‡­ç€è‡ªå·±çš„æ„Ÿè§‰åœ¨é‚£é‡Œä¾ƒä¾ƒè€Œè°ˆï¼Œæ—¢è€½è¯¯æ—¶é—´åˆæ²¡æœ‰è§£å†³é—®é¢˜ï¼Œæœ‰æ—¶å€™è¿˜ä¼¤äº†å’Œæ°”ï¼Œæ˜æ˜å¯ä»¥ä½¿ç”¨å·¥å…·å¯ä»¥è§£å†³çš„é—®é¢˜ï¼Œååè¦å„æŠ’å·±è§ã€‚</p><p>è¯´åˆ° <code>Wireshark</code> æ›´æ˜¯å¾ˆå°‘äººä½¿ç”¨ï¼Œè‡³å°‘æˆ‘èº«è¾¹çš„åŒäº‹æ˜¯è¿™æ ·ã€‚å¦‚æœè®©ä½ ä¸€ç›´å»çœ‹é‚£äº› RFC ç­‰ç½‘ç»œåè®®ï¼Œä¸åˆ°åŠå°æ—¶ä¼°è®¡ä½ å°±ä¼šæ„Ÿåˆ°ç–²æƒ«ï¼Œä½†æ˜¯ç»“åˆ <code>Wireshark</code> æ¥ç†è§£ç½‘ç»œåè®®å°±ä¼šæ„Ÿåˆ°æ— æ¯”çš„å¿«ä¹ï¼Œä½•ä¹è€Œä¸ä¸ºå‘¢ï¼Ÿï¼</p><p>ç»§ç»­é˜…è¯»ä¸‹å»ï¼Œä½ å¯ä»¥äº†è§£åˆ°å¦‚ä¸‹å‡ ä¸ªçŸ¥è¯†ï¼š</p><p><strong>1. å¦‚ä½•æŠ“å– PC ç«¯ã€iOS è®¾å¤‡çš„ç½‘ç»œåŒ…ï¼Ÿ</strong><br><strong>2. ä½¿ç”¨ä¸€äº›è¿‡æ»¤æ¡ä»¶å¦‚ä½•æŸ¥çœ‹åŒ…çš„å†…å®¹ï¼Ÿ</strong><br><strong>3. å¦‚ä½•åœ¨ <code>Wireshark</code> ä¸­æ˜¾ç¤ºåŸŸåï¼Ÿ</strong></p><h2 id="PC-ç«¯çš„-HTTP-è¯·æ±‚"><a href="#PC-ç«¯çš„-HTTP-è¯·æ±‚" class="headerlink" title="PC ç«¯çš„ HTTP è¯·æ±‚"></a>PC ç«¯çš„ HTTP è¯·æ±‚</h2><p>æ‰“å¼€ <code>Wireshark</code>ï¼Œé€‰æ‹©å¯¹åº”çš„ç½‘å£ï¼Œå› ä¸ºæˆ‘ä½¿ç”¨çš„æ˜¯æ— çº¿ç½‘ç»œï¼ˆWiFiï¼‰ï¼Œæ‰€ä»¥é€‰æ‹© <code>Wi-Fiï¼šen0</code> è¿™ä¸ªç½‘å£ï¼Œä½ å¯ä»¥æ ¹æ®ä½ çš„ç½‘ç»œä½¿ç”¨æƒ…å†µæ¥é€‰æ‹©å¯¹åº”çš„ç½‘å£ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="/upload/images/2018/09/01/1.jpg"></p><p>å¯ä»¥çœ‹åˆ°å¯¹åº”æœ‰ç½‘ç»œæ•°æ®çš„ç½‘å£ï¼Œ<code>Wireshark</code> è¿˜åœ¨å³ä¾§æ˜¾ç¤ºå¯¹åº”çš„æ³¢æµªï¼Œå¾ˆäººæ€§åŒ–çš„è®¾è®¡ã€‚åŒå‡»å¯¹åº”çš„ç½‘å£ï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>Wireshark</code> æ¥æŠ“åŒ…çœ‹æ•°æ®äº†ã€‚</p><p>ä¸‹é¢æˆ‘å°±ä»¥ PC ç«¯è®¿é—® <code>www.veryitman.com</code> æ¥æ¼”ç¤º HTTP è¯·æ±‚çš„æŠ“åŒ…æƒ…å†µã€‚</p><p>æŸ¥çœ‹æœ¬æœºçš„ ip åœ°å€ï¼Œæˆ‘çš„æ˜¯ <code>10.4.17.7</code>, å†æ¥çœ‹ä¸€ä¸‹ <code>www.veryitman.com</code> å¯¹åº”çš„ ip åœ°å€ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping ww.veryitman.com</span><br></pre></td></tr></table></figure><p>æ˜¾ç¤ºç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">64 bytes from 185.199.110.153: icmp_seq=0 ttl=52 time=317.074 ms</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆï¼Œ <code>185.199.110.153</code> å°±æ˜¯å…¶å¯¹åº”çš„ ip åœ°å€ã€‚æ€»çš„æ¥è¯´ï¼Œå¯¹äº PC ç«¯ï¼Œæºåœ°å€æ˜¯ <code>10.4.17.7</code>ï¼Œç›®çš„åœ°å€æ˜¯ <code>185.199.110.153</code>ï¼Œå¯¹äºæœåŠ¡å™¨æ¥è¯´ï¼Œæ­£å¥½åè¿‡æ¥ã€‚</p><p>é¦–å…ˆåœ¨è¿‡æ»¤å™¨ä¸­è¾“å…¥ <code>http</code>, å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/upload/images/2018/09/01/2.jpg"></p><p>ç„¶åæ‰“å¼€æµè§ˆå™¨ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ Chromeï¼Œæ‰“å¼€ <code>http://www.veryitman.com/2018/08/20/%E5%88%9D%E8%AF%86-Wireshark/</code> ç½‘ç«™ç«™ç‚¹ï¼Œ<code>Wireshark</code> æ˜¾ç¤ºå¦‚ä¸‹ï¼ˆéƒ¨åˆ†æˆªå›¾ï¼‰ï¼š<br><img src="/upload/images/2018/09/01/3.jpg"></p><p>æ”¹å˜ä¸€ä¸‹è¿‡æ»¤è¯­å¥ï¼Œå°†ä¹‹å‰çš„ <code>http</code> æ”¹ä¸º <code>ip.src==10.4.17.7 &amp;&amp; http &amp;&amp; ip.dst==185.199.109.153</code>ï¼Œ æ˜¾ç¤ºå¦‚ä¸‹ï¼š<br><img src="/upload/images/2018/09/01/4.jpg"></p><p>å¯ä»¥é€‰æ‹©ä»»ä½•ä¸€ä¸ªè¯·æ±‚ï¼Œå±•ç¤ºåŒºåŸŸå¦‚ä¸‹ï¼š<br><img src="/upload/images/2018/09/01/5.jpg"></p><p>ä¸Šå›¾ä¸­çš„ä¸‰ä¸ªåŒºåŸŸåˆ†åˆ«å¯¹åº”çš„æ˜¯ <code>View</code> ä¸­çš„ <code>Packet List</code>ï¼Œ <code>Packet Details</code>ï¼Œ<code>Packet Bytes</code> ä¸‰ä¸ªè§†å›¾ã€‚<br><img src="/upload/images/2018/09/01/6.jpg"></p><p>é€‰æ‹©ä»»ä½•ä¸€ä¸ªè¯·æ±‚ï¼Œåœ¨å¯¹åº”çš„ <code>åŒºåŸŸ2</code> å¯ä»¥çœ‹åˆ°è¯¥è¯·æ±‚çš„è¯¦æƒ…ã€‚</p><p>åˆšæ‰ä½¿ç”¨çš„è¿‡æ»¤æ¡ä»¶åªçœ‹åˆ° PCï¼ˆå®¢æˆ·ç«¯ï¼‰çš„è¯·æ±‚ï¼Œæ²¡æœ‰çœ‹åˆ°æœåŠ¡å™¨è¿”å›ä¿¡æ¯ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹è¿‡æ»¤æ¡ä»¶ä¸º <code>ip.src==185.199.109.153 &amp;&amp; http &amp;&amp; ip.dst==10.4.17.7</code>ï¼Œè¿™æ ·å°±çœ‹ä»¥çœ‹åˆ°æœåŠ¡å™¨çš„å›åŒ…ä¿¡æ¯äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/09/01/7.jpg"></p><p>åŒå‡»è¿›å…¥è¯¥å“åº”ï¼Œå°±å¯ä»¥çœ‹åˆ°å¯¹åº”çš„å“åº”æ•°æ®è¯¦æƒ…äº†ã€‚</p><h2 id="iOS-è®¾å¤‡çš„-HTTP-è¯·æ±‚"><a href="#iOS-è®¾å¤‡çš„-HTTP-è¯·æ±‚" class="headerlink" title="iOS è®¾å¤‡çš„ HTTP è¯·æ±‚"></a>iOS è®¾å¤‡çš„ HTTP è¯·æ±‚</h2><p>è·ŸæŸ¥çœ‹ PC ç«¯çš„ HTTP è¯·æ±‚æ–¹å¼åŸºæœ¬ä¸€è‡´ï¼Œåªæ˜¯æ­¤æ—¶çš„æœ¬æœº ip åœ°å€æ˜¯æ‰‹æœºç«¯çš„è€Œä¸æ˜¯ pc ç«¯çš„ã€‚</p><p><a href="http://www.veryitman.com/2018/08/20/%E5%88%9D%E8%AF%86-Wireshark/">åˆè¯† Wireshark</a> ä¸­å·²ç»è·Ÿå¤§å®¶åˆ†äº«è¿‡å¦‚ä½•å»è¿æ¥ iOS è®¾å¤‡åˆ° <code>Wireshark</code> æŠ“åŒ…äº†ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</p><p>è‡³äºæŸ¥çœ‹ iOS è®¾å¤‡çš„ ip åœ°å€ï¼Œå°±å¾ˆç®€å•äº†ï¼Œæ‰“å¼€ <code>è®¾ç½®/wifi</code> çœ‹ä¸€ä¸‹è¯¦æƒ…å°±çŸ¥é“äº†ã€‚</p><h2 id="æ˜¾ç¤ºåŸŸå"><a href="#æ˜¾ç¤ºåŸŸå" class="headerlink" title="æ˜¾ç¤ºåŸŸå"></a>æ˜¾ç¤ºåŸŸå</h2><p>å¦‚æœä½ ç»å¸¸ä½¿ç”¨ <code>Charles</code> æŠ“åŒ…ï¼Œå°±å¯ä»¥å‘ç° <code>Charles</code> å±•ç¤ºçš„è¯·æ±‚ä¸­éƒ½æ˜¯ä»¥åŸŸåæ¥æ˜¾ç¤ºçš„ï¼Œä½†æ˜¯åœ¨ <code>Wireshark</code> éƒ½æ˜¯æ˜¾ç¤º ip åœ°å€ï¼Œæˆ–è®¸å› æ­¤æ„Ÿåˆ°ä¸é€‚ï¼Œé‚£ä¹ˆï¼Œ<code>Wireshark</code> èƒ½å¦å±•ç¤ºåŸŸåå‘¢ï¼Ÿ</p><p><code>Wireshark</code> æ˜¯å¯ä»¥åƒ <code>Charles</code> é‚£æ ·å±•ç¤ºåŸŸåçš„ï¼Œåªæ˜¯å®ƒé»˜è®¤æ˜¾ç¤º ip åœ°å€ç½¢äº†ã€‚</p><p>æ‰“å¼€ Preferencesï¼Œå¦‚å›¾ï¼š<br><img src="/upload/images/2018/09/01/8.jpg"><br><img src="/upload/images/2018/09/01/9.jpg"></p><p>è¿™æ · <code>Wireshark</code> çš„æ˜¾ç¤ºå°±æ˜¯å¦ä¸€ç•ªæ™¯è±¡äº†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/09/01/10.jpg"></p><p>å½“ç„¶ï¼Œä½ ä¹Ÿçœ‹å‡ºæ¥äº†ï¼Œè¿‡æ»¤æ¡ä»¶è¿˜æ˜¯å¯ä»¥ä½¿ç”¨çš„ã€‚</p><p>ä½ è¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–çš„è¿‡æ»¤æ¡ä»¶ï¼Œå¦‚ä¸‹é¢çš„ä¸€äº›è¿‡æ»¤æ¡ä»¶ï¼Œèƒ½å¸®ä½ å¿«é€Ÿå®šä½ä½ è¦çš„æ•°æ®ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http.host == &quot;veryitman.com&quot;</span><br><span class="line"></span><br><span class="line">http.host contains &quot;veryitman.com&quot;</span><br><span class="line"></span><br><span class="line">http contains &quot;HTTP/1.1 200 OK&quot;</span><br></pre></td></tr></table></figure><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œåè®® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Wireshark http https </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å–åºŸå“çš„ä¸€æ¬¡ç»å†</title>
      <link href="/2018/08/26/%E5%8D%96%E5%BA%9F%E5%93%81%E7%9A%84%E4%B8%80%E6%AC%A1%E7%BB%8F%E5%8E%86/"/>
      <url>/2018/08/26/%E5%8D%96%E5%BA%9F%E5%93%81%E7%9A%84%E4%B8%80%E6%AC%A1%E7%BB%8F%E5%8E%86/</url>
      
        <content type="html"><![CDATA[<h2 id="å¶é‡"><a href="#å¶é‡" class="headerlink" title="å¶é‡"></a>å¶é‡</h2><p>è¿™ä¸¤å¤©åœ¨æ”¶æ‹¾å±‹å­ï¼Œæœ¬æ¥æƒ³æŠŠä¸€äº›ä¸é‡è¦çš„ç‰©å“ç›´æ¥å–æ‰ï¼Œçœå¾—ç»™è‡ªå·±å¢åŠ è¿è¾“æˆæœ¬ã€‚ä½†æ˜¯åˆæœ‰äº›ä¸èˆï¼Œæ¯•ç«Ÿè·Ÿè‡ªå·±åœ¨ä¸€èµ·ç”Ÿæ´»äº†è¿™ä¹ˆå¤šå¹´ï¼Œæ¯ä¸€æœ¬ä¹¦ï¼Œæ¯å¯¹æ¡Œæ¤…ï¼Œæ¯ä»¶è¡£æœéƒ½æ˜¯æˆ‘å’Œè€å©†åŠªåŠ›æŒ£é’±ä¹°å›æ¥çš„ï¼Œé‡Œé¢éƒ½åŒ…å«ç€å¥‹æ–—çš„æ•…äº‹ã€‚</p><p>è¯åˆè¯´å›æ¥ï¼Œæ— èˆæ— å¾—ã€‚äºæ˜¯ï¼Œæˆ‘å°±å¼€å§‹å°†ç‰©å“åˆ†ç±»ï¼ŒæŒ‰ç…§ä¼˜å…ˆçº§æŒ‘é€‰ï¼Œé‡è¦çš„ä¸œè¥¿å°±æ”¾åˆ°ç®±å­ä¸­ï¼Œæ¬¡è¦çš„å°±æ”¾åˆ°æ²™å‘ä¸Šï¼Œä¸é‡è¦çš„å°±æ‰”åˆ°å¤§å…é‡Œï¼Œæœ€åå†æ¥å®¡è§†ä¸€éè¿™äº›ä¸é‡è¦çš„ç‰©å“æ˜¯å¦è¿˜æœ‰ç•™ä¸‹æ¥çš„å¿…è¦ï¼Œæœ€ç»ˆæˆ‘æŠŠä¸é‡è¦çš„ä¸œè¥¿æ”¾åˆ°ä¸€ä¸ªå¤§è¢‹å­ä¸­ï¼Œå‡†å¤‡æŠŠå®ƒä»¬å–ç»™åºŸå“ç«™ã€‚</p><p>åœ¨ç™¾åº¦ä¸Šé¢æ‰¾äº†å¥½å‡ å®¶é™„è¿‘æ”¶åºŸå“çš„ï¼Œæ‰“ç”µè¯è¿‡å»éƒ½è¦æ±‚å–å®¶è‡ªå·±æŠŠä¸œè¥¿æ‹¿è¿‡å»ï¼Œæ€åº¦ååˆ†ä¸å‹å¥½ï¼Œæˆ‘ä¹Ÿå°±æ²¡å†å¤šé—®ï¼Œå°±æŒ‚æ‰äº†ç”µè¯ã€‚</p><p>æ— ç‹¬æœ‰å¶ï¼Œä¸­åˆä¸‹æ¥¼å»ä¹°ä¸œè¥¿å›æ¥çš„æ—¶å€™ï¼Œæ­£å¥½çœ‹åˆ°ä¸€ä¸ªå¤§çˆ·éª‘ç€ä¸‰è½®è½¦åœ¨æˆ‘å‰é¢é©°éª‹ï¼Œå¤§çˆ·çš„è½¦æŠ€è´¼æºœï¼Œåœ¨å°å··å­ä¸­å¼€å‡ºäº†èµ›è½¦çš„æ„Ÿè§‰ã€‚è¿˜æ²¡ç­‰æˆ‘å¼ å˜´ï¼Œä»–å°±å³å°†è¦ç¦»å¼€æˆ‘çš„è§†çº¿ï¼Œæ€¥ä¸­ç”Ÿæ™ºï¼Œæˆ‘çœ‹åˆ°ä»–è½¦å­åé¢ç•™æœ‰ç”µè¯ï¼Œäºæ˜¯æˆ‘å°±æ€¥å¿™çš„åŠªåŠ›çš„è¿½èµ¶ç€å»è®°ä½ä»–çš„ç”µè¯ï¼Œæœ€åè¿«ä¸åŠå¾…çš„æ”¾ä¸‹æ‰‹ä¸­çš„ä¸œè¥¿ï¼Œæ‹¿å‡ºæ‰‹æœºæ‹¨æ‰“äº†ä»–çš„ç”µè¯ã€‚</p><p>å¤§çˆ·åŠäº‹åˆ©è½ï¼Œä¸ä¸€ä¼šå°±åˆ°äº†æ¥¼ä¸‹ï¼Œä¸‰ä¸‹äº”é™¤äºŒçš„æŠŠåºŸå“æ”¶æ‹¾äº†ä¸€ç•ªï¼Œåƒæ˜¯æ”¶è·äº†ä¸€æ‰¹æˆ˜åˆ©å“ä¸€æ ·ã€‚ä»–å¾ˆæƒŠè¯§ä¸ºä»€ä¹ˆæˆ‘çŸ¥é“ä»–çš„ç”µè¯ï¼Œæˆ‘è¯´æˆ‘çœ‹åˆ°äº†ä½ è½¦ä¸Šçš„ç”µè¯å·ç äº†ï¼Œå°±è®°ä¸‹æ¥äº†ã€‚</p><p>å¤§çˆ·è¯´ï¼šâ€œå°ä¼™å­ï¼Œä½ çš„è®°æ€§è¿˜çœŸå¥½ï¼Œä¸æ„§æ˜¯ä¸Šè¿‡å¤§å­¦çš„äººã€‚â€œï¼Œæˆ‘è¯´ï¼šâ€œæ˜¯å‘€ï¼Œæˆ‘è¿‡ç›®ä¸å¿˜ï¼å“ˆå“ˆï¼â€ã€‚</p><p>é‚£å¤©ä¸­åˆï¼Œæˆ‘æŠŠä¸œè¥¿åŠå–åŠé€çš„éƒ½ç»™è¿™ä½å¤§çˆ·äº†ï¼Œè°å«ä»–å¤¸æˆ‘å‘¢ï¼</p><h2 id="æ€é‡"><a href="#æ€é‡" class="headerlink" title="æ€é‡"></a>æ€é‡</h2><p>ä¸Šé¢è¿™ä»¶äº‹ç®—ä¸ä¸Šä»€ä¹ˆå¤§äº‹ï¼Œé¡¶å¤šä¹Ÿå°±ç®—ä¸ªé¸¡æ¯›è’œçš®çš„å°äº‹ï¼Œä½†æ˜¯ç»™äº†æˆ‘å¾ˆå¤šå›å¿†å’Œæ€è€ƒã€‚</p><p>å¾ˆå¤šé«˜ä¸­ç”Ÿä¹ŸåŒ…æ‹¬ä»–ä»¬çš„å®¶é•¿ä»¬ï¼Œéƒ½ç»å¸¸ä¼šè¯´ç­‰ä¸Šäº†å¤§å­¦å°±å¥½äº†ï¼Œä¸ç”¨é‚£ä¹ˆç´¯äº†ï¼Œåœ¨å¤§å­¦çš„æ®¿å ‚é‡Œå¯ä»¥æ— å¿§æ— è™‘çš„ <code>äº«å—</code> äº†ã€‚åœ¨æˆ‘çœ‹æ¥è¿™æ˜¯ä¸å¯¹çš„ï¼Œé«˜ä¸­ä¹‹æ‰€ä»¥ç´¯æ˜¯å› ä¸ºæœ‰è¿ç»µä¸ç»çš„ä½œä¸šå’Œæ²¡æœ‰å°½å¤´çš„è€ƒè¯•ï¼Œå½“ç„¶è¿˜æœ‰ç­ä¸»ä»»å–‹å–‹ä¸ä¼‘çš„æ•™å¯¼ï¼Œè®©ä½ çš„ç¥ç»æ—¶é•¿å¤„äºç´§ç»·çš„çŠ¶æ€ã€‚é«˜ä¸­æ˜¯äººç”Ÿä¸­å¿…ç»çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œè‡³å°‘æˆ‘è§‰å¾—å®ƒé”»ç‚¼äº†æˆ‘çš„æ„å¿—å’Œè€åŠ›ï¼ŒåŒ…æ‹¬å¯¹å¿ƒç†ä¸Šçš„è€ƒéªŒï¼Œæˆ‘å¾ˆæ„Ÿæ¿€é«˜ä¸­ä¸‰å¹´çš„ç”Ÿæ´»ã€‚</p><p>å¤§å­¦ç”Ÿæ´»å’Œå­¦ä¹ çš„ç¡®æ˜¯ä¸€ä¸ªå€¼å¾—å‘å¾€å’Œæƒ³è±¡çš„ï¼Œä½ å¯ä»¥åŠå„¿éƒå½“çš„è¿‡å®Œå‡ å¹´å¤§å­¦ç”Ÿæ´»ï¼Œä¹Ÿå¯ä»¥åŠªåŠ›æ‹¼æè¿‡æ¥ï¼Œæ²¡æœ‰äººé€¼ä½ å»æ€ä¹ˆåšï¼Œå®Œå…¨å–å†³äºä½ è‡ªå·±ã€‚</p><p>æˆ‘å¤§å­¦çš„æˆç»©ç®—æ˜¯ä¼˜å¼‚ï¼Œæ¯æ¬¡çœ‹åˆ°å¥–å­¦é‡‘åå•ä¸Šæœ‰è‡ªå·±çš„åå­—ï¼ŒåŒå­¦ä»¬éƒ½ä¼šè¯´ä½ çœŸå‰å®³ï¼Œå±…ç„¶è€ƒè¿™ä¹ˆå¥½çš„æˆç»©ã€‚æˆ‘ä¼šè¯´ï¼Œå¦‚æœä½ å†åŠªåŠ›ä¸€ä¸‹è‚¯å®šæ¯”æˆ‘è€ƒçš„æ›´å¥½ï¼Œå°±åƒé‚£ä¸ªå¤§çˆ·è¯´æˆ‘å¥½è®°æ€§ä¸€æ ·ï¼Œå…¶å®å¹¶ä¸æ˜¯æˆ‘è¿‡ç›®ä¸å¿˜ï¼Œè€Œæ˜¯è‡ªå·±åŠªåŠ›çš„ç»“æœï¼Œå› ä¸ºæˆ‘çŸ¥é“è‡ªå·±å¹¶ä¸æ˜¯å¤©æ‰ã€‚</p><p>å¾ˆå¤šäººè¿›å…¥ç¤¾ä¼šå‚åŠ å·¥ä½œåï¼Œå‘ç°å·¥ä½œå¹¶ä¸æ˜¯æƒ³è±¡ä¸­çš„é‚£èˆ¬ä¸€å¸†é£é¡ºï¼Œè‡ªå·±ä¸€èµ·è¿›å…¬å¸çš„åŒäº‹ï¼Œæ˜æ˜èƒ½åŠ›å’Œè‡ªå·±ç›¸å½“ç”šè‡³è¿˜ä¸å¦‚è‡ªå·±ï¼Œä¸ºä»€ä¹ˆåˆ«äººå°±å‡èŒåŠ è–ªï¼Œé©¬ä¸Šå°±è¦èµ°ä¸Šäººç”Ÿå·…å³°äº†ï¼Œè‡ªå·±å´è¿˜æ˜¯åŸåœ°è¸æ­¥æˆ–è€…ä¸¾æ­¥ç»´è‰°å‘¢ï¼Ÿæ€»æ˜¯æƒ³ä¸æ˜ç™½è¿™æ˜¯ä¸ºä»€ä¹ˆï¼Œé‚£æ˜¯å› ä¸ºä½ è‡ªå·±æ²¡æœ‰çœ‹åˆ°åˆ«äººæ¯”ä½ æ›´åŠ åŠªåŠ›ã€‚</p><p>è¿˜æœ‰ä¸å°‘äººä¼šæŠ±æ€¨ä¸ºä»€ä¹ˆåˆ«äººèƒ½åŠ›æ²¡æœ‰æˆ‘å¼ºï¼Œé¢†å¯¼ååæŠŠä¸€äº›é‡è¦çš„äº‹æƒ…äº¤ç»™äº†ä»–ï¼Œå¼€å§‹æ€€ç–‘å¯¹æ–¹æ˜¯ä¸æ˜¯å¯¹é¢†å¯¼æ–½äº†ä»€ä¹ˆé­”æ³•ï¼Œè€Œè‡ªå·±ä»æ¥éƒ½æ²¡æœ‰æƒ³è¿‡æ€ä¹ˆå»å‘å¯¹æ–¹è¯·æ•™ï¼Œæˆ–è€…æ€è€ƒè‡ªå·±æ˜¯ä¸æ˜¯çœŸçš„åšå¥½äº†æœ¬èŒå·¥ä½œã€‚</p><p><em><strong>è¿™ä»¶å°äº‹ç»™äº†æˆ‘å‡ ä¸ªå¯å‘ï¼š</strong></em></p><p><strong>1. ä¸€å®šè¦ç»™è‡ªå·±æ ‘ç«‹ä¸€ä¸ªé•¿è¿œç›®æ ‡å’ŒçŸ­æœŸç›®æ ‡ï¼Œä¸æ–­çš„å®ŒæˆçŸ­æœŸç›®æ ‡ï¼Œå‘é•¿è¿œç›®æ ‡å‰è¿›ã€‚</strong></p><p><strong>2. å¯¹äºåˆ«äººçš„èµç¾æˆ–æ˜¯è¯‹æ¯ï¼Œè¦ä¿æŒä¸€é¢—å¹³å¸¸å¿ƒï¼Œæˆ’éª„æˆ’èºã€‚</strong></p><p><strong>3. ä¸è¦æ€»æ˜¯å¤¸ä½ çš„å­©å­èªæ˜ï¼Œè¦å¤¸ä»–æ¯”åˆ«äººæ›´åŠªåŠ›ï¼Œå› ä¸ºåŠªåŠ›æ¯”èªæ˜æ›´é‡è¦ã€‚</strong></p><p><strong>4. ä¸è¦æ€»æ˜¯æŠ±æ€¨å‘½è¿çš„ä¸å…¬ï¼Œå¤šå»å®¡è§†è‡ªå·±çš„ä¸è¶³ï¼Œæƒ³åŠæ³•å»è¡¥å…¨ã€‚</strong></p><p><strong>5. æœ‰ä¸ªå¯ä»¥äº¤å¿ƒçš„æœ‹å‹å°¤ä¸ºé‡è¦ï¼Œå¯ä»¥è®©å½¼æ­¤æ•å¼€å¿ƒæ‰‰ï¼Œæ— æ‰€é¡¾å¿Œçš„äº¤è°ˆã€‚</strong></p><p>è¿™ä¸ªä¸–ä¸Šæ²¡æœ‰å…è´¹çš„åˆé¤ï¼Œä¸€åˆ‡éƒ½è¦é ä½ è‡ªå·±å»å¥‹æ–—å»äº‰å–ï¼Œæœºä¼šæ€»æ˜¯ç•™ç»™æœ‰å‡†å¤‡çš„äººï¼ŒåšæŒè‡ªå·±çš„ç›®æ ‡ä¸€ç›´å‰è¡Œï¼Œç›¸ä¿¡è‡ªå·±ï¼Œæœºä¼šæ€»æœ‰ä¸€å¤©ä¼šå’Œä½ ä¸æœŸè€Œé‡ã€‚</p><p>ç›¸ä¿¡æ€»æœ‰ä¸€å¤©ï¼Œä½ ä¼šæ„Ÿæ¿€æ­£åœ¨åŠªåŠ›çš„è‡ªå·±ï¼</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç”Ÿæ´» æ„Ÿæ‚Ÿ å­¦ä¹  é˜…è¯» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆè¯† Wireshark</title>
      <link href="/2018/08/20/%E5%88%9D%E8%AF%86-Wireshark/"/>
      <url>/2018/08/20/%E5%88%9D%E8%AF%86-Wireshark/</url>
      
        <content type="html"><![CDATA[<p><a href="http://www.veryitman.com/2017/07/23/%E4%BD%BF%E7%94%A8-Charles/">ä½¿ç”¨ Charles</a> ä»‹ç»äº†åœ¨ MacOS ä¸Šé¢çš„ä½¿ç”¨ <code>Charles</code> å·¥å…·, è™½ç„¶ <code>Charles</code> å¾ˆä¸é”™, ä½†æ˜¯å…¶åªèƒ½æŠ“ HTTP&#x2F;HTTPS çš„åŒ…, å¯¹ TCPã€UDP ç­‰å…¶ä»–åè®®çš„ç½‘ç»œåŒ…, çˆ±è«èƒ½åŠ©ã€‚</p><p>ä»Šå¤©ç»™å¤§å®¶åˆ†äº«å¼ºå¤§çš„ç½‘ç»œæŠ“åŒ…å·¥å…· <code>Wireshark</code>ï¼Œç®—æ˜¯åˆæ­¥è®¤è¯†ä¸€ä¸‹è¿™ä¸ªå·¥å…·ï¼Œåç»­åˆ†äº«æ›´å¤šå…³äº <code>Wireshark</code> çš„å†…å®¹ã€‚</p><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><code>Wireshark</code> æ˜¯å…è´¹çš„ï¼Œæ”¯æŒ Windowsã€MacOS å’Œ Linuxï¼Œæä¾›ä¸°å¯Œçš„ GUI äº¤äº’ï¼Œèƒ½åˆ†ææ‰€æœ‰çš„ç½‘ç»œåè®®ï¼Œå¹¶ä¸”æ˜¯å¼€æºçš„ã€‚</p><p><img src="/upload/images/2018/08/20/1.jpg"></p><p>æŒæ¡å¥½ <code>Wireshark</code>ï¼Œèƒ½å¯¹ç»å¤§éƒ¨åˆ†çš„ç½‘ç»œåè®®è¿›è¡Œåˆ†æäº†ï¼Œæ‰€ä»¥å­¦ä¹ å®ƒçš„ä½¿ç”¨å¯¹ä½ çš„å·¥ä½œä¸æ— è£¨ç›Šã€‚</p><p>å…³äº <code>Wireshark</code> æœ¬èº« UIï¼ˆå±•ç¤ºçš„ç•Œé¢å†…å®¹ï¼‰ çš„éƒ¨åˆ†ä¸åœ¨æœ¬æ–‡çš„è®¨è®ºèŒƒå›´å†…ï¼Œæ›´å¤šå…³äº <code>Wireshark</code> çš„ä»‹ç»å’Œç‰¹æ€§ï¼Œå¯ä»¥å» <a href="https://www.wireshark.org/">Wireshark å®˜ç½‘</a> æŸ¥é˜…ã€‚</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>æˆ‘çš„ MacOS ç‰ˆæœ¬:<br><img src="/upload/images/2018/08/20/2.jpg"></p><p>ç‚¹å‡» <code>Wireshark</code> çš„ <a href="https://www.wireshark.org/download.html">ä¸‹è½½åœ°å€</a>, å¯ä»¥å»ä¸‹è½½å¯¹åº”çš„å¹³å°ç‰ˆæœ¬ã€‚</p><p><img src="/upload/images/2018/08/20/3.jpg"></p><blockquote><p>æ³¨æ„: ä¹‹å‰çš„ Mac ç³»ç»Ÿç‰ˆæœ¬å¯èƒ½éœ€è¦å®‰è£… <code>x11</code>, ç°åœ¨æ–°ç³»ç»Ÿä¸éœ€è¦å®‰è£…äº†.</p></blockquote><h2 id="æŠ“-iOS-è®¾å¤‡çš„æ•°æ®åŒ…"><a href="#æŠ“-iOS-è®¾å¤‡çš„æ•°æ®åŒ…" class="headerlink" title="æŠ“ iOS è®¾å¤‡çš„æ•°æ®åŒ…"></a>æŠ“ iOS è®¾å¤‡çš„æ•°æ®åŒ…</h2><p>æƒ³æŠ“ iOS è®¾å¤‡çš„ç½‘ç»œæ•°æ®ï¼Œéœ€è¦è®© iOS è®¾å¤‡æ•°æ®é€šè¿‡ MacOS æ‰è¡Œï¼Œå› ä¸º <code>Wireshark</code> æ˜¯é’ˆå¯¹ç½‘å£è¿›è¡ŒæŠ“åŒ…çš„ã€‚</p><p>å½“ç„¶äº†ï¼Œä½ çš„ iOS è®¾å¤‡ä¸éœ€è¦è¶Šç‹±.</p><p>é€šè¿‡ usb è¿æ¥ iOS è®¾å¤‡åï¼Œæ¥ä¸‹æ¥åˆ›å»ºè¿œç¨‹è™šæ‹Ÿæ¥å£ï¼Œåœ¨ç»ˆç«¯æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rvictl -s è®¾å¤‡id(udid)</span><br></pre></td></tr></table></figure><blockquote><p>rvictl å³ Remote Virtual Interface Toolã€‚å®ƒå¯ä»¥é€šè¿‡ iOS è®¾å¤‡çš„ UDID åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç½‘å¡ï¼Œç„¶åé€šè¿‡è¿™ä¸ªè™šæ‹Ÿç½‘å¡ç›‘å¬è®¾å¤‡ä¸Šæ‰€æœ‰çš„ç½‘ç»œæµé‡ã€‚</p></blockquote><p>æ‰§è¡ŒæˆåŠŸåï¼ŒMac ä¼šå‡ºç°ä¸€ä¸ªå¯¹åº”çš„è™šæ‹Ÿç½‘ç»œæ¥å£ï¼Œåå­—æ˜¯ rvi0ï¼ˆå¦‚æœæœ‰å¤šä¸ª iOS è®¾å¤‡ï¼Œ åˆ™ç´¯åŠ ï¼Œrvi1ï¼Œrvi2â€¦ï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/08/20/4.jpg"></p><p>åªè¦å¯åŠ¨ <code>Wireshark</code>ï¼Œç›‘å¬ rvi0 æ¥å£å°±èƒ½æŠ“åˆ° iOS è®¾å¤‡çš„æ•°æ®äº†ã€‚</p><blockquote><p>å…³äºè·å– iOS è®¾å¤‡ ID(UDID)ï¼Œå¯ä»¥ä½¿ç”¨ Xcode, åœ¨ <code>Window/Devices and Simulators</code> ä¸­é€‰æ‹©ç›¸åº”è®¾å¤‡ï¼Œå³é¢è®¾å¤‡ä¿¡æ¯çš„ identifier é‡Œå°±æ˜¯å¯¹åº”çš„ UDID. ä¹Ÿå¯ä»¥é€šè¿‡ iTunes æˆ–è€…ç¬¬ä¸‰æ–¹å·¥å…·å¦‚ iTools è·å–.</p></blockquote><p>ä½ å¯ä»¥å®‰è£… <code>ideviceinstaller</code> æ¥æŸ¥çœ‹è®¾å¤‡ ID.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install ideviceinstaller</span><br></pre></td></tr></table></figure><p>ç„¶åæ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">idevice_id -l</span><br></pre></td></tr></table></figure><p>ä»¥æŠ“å–ä¸‹é¢çš„ä¸€ä¸ª HTTP è¯·æ±‚ä¸ºä¾‹ï¼Œç®€å•è¯´æ˜ä¸€ä¸‹ç›¸å…³çš„çŸ¥è¯†ã€‚</p><p>GET è¯·æ±‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/news/detailV3.html?id=1279391&amp;COMMON_ACCESS_TOKEN=(null)&amp;COMMON_ACCESS_TOKEN_SECRET=(null)&amp;_cT=IOS&amp;_cV=3.1.3&amp;_cA=PM</span><br></pre></td></tr></table></figure><p>çœ‹è¿”å›ç»“æœï¼Œé€‰ä¸­ Rsponse(200 OK) å³é”®, Follow&#x2F;HTTP Streamï¼Œå¦‚å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/08/20/5.jpg"></p><p>åœ¨å¼¹å‡ºçš„çª—å£ä¸­å°±å¯ä»¥çœ‹åˆ°å…·ä½“çš„å“åº”å†…å®¹ï¼Œä»¥åŠå“åº”çš„ json æ•°æ®ã€‚</p><h2 id="è¿‡æ»¤å™¨è¿‡æ»¤"><a href="#è¿‡æ»¤å™¨è¿‡æ»¤" class="headerlink" title="è¿‡æ»¤å™¨è¿‡æ»¤"></a>è¿‡æ»¤å™¨è¿‡æ»¤</h2><p>åœ¨ <code>Wireshark</code> ä¸­æ˜¾ç¤ºè¿‡æ»¤å™¨ä¼šæ˜¾ç¤ºå¾ˆå¤šå½“å‰ç½‘ç»œçš„æ•°æ®åŒ…ï¼Œå¦‚æœä½ æƒ³çœ‹æŒ‡å®šè§„åˆ™çš„æ•°æ®åŒ…æ€ä¹ˆåŠï¼Ÿ</p><p>åˆ«æ‹…å¿ƒï¼Œ<code>Wireshark</code> ç»™æˆ‘ä»¬æä¾›äº†è¿‡æ»¤åŠŸèƒ½ï¼ŒæŒ‰ç…§ä¸€å®šçš„è¿‡æ»¤è§„åˆ™å°±å¯ä»¥è¾¾åˆ°ä½ çš„ç›®çš„ã€‚</p><p><strong>1. ç½‘ç»œåè®®è¿‡æ»¤</strong></p><p>æ¯”å¦‚ TCPï¼Œåªæ˜¾ç¤º TCP åè®®ï¼ŒHTTP åªæ˜¾ç¤º HTTP åè®®ç­‰ã€‚åœ¨è¿‡æ»¤å™¨è¾“å…¥æ¡†ä¸­ç›´æ¥è¾“å…¥åè®®åç§°å³å¯ï¼Œä¸åŒºåˆ†å¤§å°å†™ã€‚</p><p><strong>2. IP åœ°å€è¿‡æ»¤</strong></p><p>å¦‚ ip.src &#x3D;&#x3D; 192.168.1.102 æ˜¾ç¤ºæºåœ°å€ä¸º <code>192.168.1.102</code>ï¼Œ<br>è€Œ ip.dst &#x3D;&#x3D; 192.168.1.102, ç›®æ ‡åœ°å€ä¸º <code>192.168.1.102</code>ã€‚</p><p><strong>3. ç«¯å£è¿‡æ»¤</strong></p><p>tcp.port &#x3D;&#x3D; 80, ç«¯å£ä¸º 80 çš„</p><p>tcp.srcport &#x3D;&#x3D; 80, åªæ˜¾ç¤º TCP åè®®çš„åŸç«¯å£ä¸º 80 çš„ã€‚</p><p><strong>4. Http æ¨¡å¼è¿‡æ»¤</strong></p><p>http.request.method &#x3D;&#x3D; â€œGETâ€ï¼Œåªæ˜¾ç¤º HTTP GET æ–¹æ³•çš„ã€‚</p><p><strong>5. ç»“åˆé€»è¾‘è¿ç®—ç¬¦ AND&#x2F;OR ç»„æˆå¤æ‚çš„è¡¨è¾¾å¼</strong></p><blockquote><p>AND&#x2F;OR ä¹Ÿå¯ä»¥å†™æˆ <code>&amp;&amp;</code> &#x2F; <code>||</code></p></blockquote><p>ä¸‹é¢ä¸¾å‡ ä¸ªå¸¸ç”¨çš„ç¤ºä¾‹ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//æºåœ°å€æˆ–è€…ç›®æ ‡åœ°å€æ˜¯192.168.1.103</span><br><span class="line">ip.src == 192.168.1.103 or ip.dst == 192.168.1.103</span><br><span class="line"></span><br><span class="line">//æ˜¾ç¤ºæ‰€æœ‰ç›®æ ‡æˆ–æºåœ°å€æ˜¯192.168.1.1çš„æ•°æ®åŒ…</span><br><span class="line">ip.addr == 192.168.1.1 </span><br><span class="line"></span><br><span class="line">//æ˜¾ç¤ºç›®æ ‡åœ°å€æ˜¯192.168.1.1çš„æ•°æ®åŒ…</span><br><span class="line">ip.dst == 192.168.1.1 </span><br><span class="line"></span><br><span class="line">//æ˜¾ç¤ºæºåœ°å€æ˜¯192.168.1.1çš„æ•°æ®åŒ…</span><br><span class="line">ip.src == 192.168.1.1 </span><br><span class="line"></span><br><span class="line">//tcp è¿æ¥ç«¯å£ä¸º9101çš„æ•°æ®åŒ…</span><br><span class="line">tcp.port == 9101 </span><br></pre></td></tr></table></figure><p>æ›´å¤šçš„è¿‡æ»¤è§„åˆ™å¯ä»¥å» <a href="https://www.wireshark.org/docs/man-pages/wireshark-filter.html">å®˜æ–¹æ‰‹å†Œ</a> å’Œ <a href="https://wiki.wireshark.org/CaptureFilters">CaptureFilters</a> æŸ¥é˜…å’Œå­¦ä¹ ã€‚</p><h2 id="ç¾ä¸­ä¸è¶³"><a href="#ç¾ä¸­ä¸è¶³" class="headerlink" title="ç¾ä¸­ä¸è¶³"></a>ç¾ä¸­ä¸è¶³</h2><p><code>Wireshark</code> åªèƒ½æŸ¥çœ‹å°åŒ…ï¼Œè€Œä¸èƒ½ä¿®æ”¹å°åŒ…çš„å†…å®¹ï¼Œæˆ–è€…å‘é€å°åŒ…ã€‚</p><p>å¯¹äº HTTPã€HTTPS ç½‘ç»œå°åŒ…ï¼Œ<code>Wireshark</code> éƒ½å¯ä»¥æ•è·ï¼Œ ä½†ä¸èƒ½ç›´æ¥è§£å¯† HTTPSï¼Œæ‰€ä»¥æƒ³ä½¿ç”¨ <code>Wireshark</code> æ¥åˆ†æ HTTPS åŒ…ä¸­çš„å†…å®¹ï¼Œéœ€è¦å»é¢å¤–é…ç½®ï¼Œè¾ƒéº»çƒ¦ï¼Œåç»­ç ”ç©¶å†åˆ†äº«ç»™å¤§å®¶ã€‚</p><p>æ‰€ä»¥å»ºè®®å¤§å®¶ï¼Œåˆ†æ HTTP&#x2F;HTTPS å»ä½¿ç”¨å„è‡ªå¹³å°ä¸Šé¢çš„å…¶ä»–å·¥å…·ï¼Œ å¦‚ <code>Fiddler</code> å’Œ <code>Charles</code> ç­‰ä¼˜ç§€çš„æŠ“åŒ…å·¥å…·ã€‚</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Wireshark tcp ip udp http https </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é…ç½® php7 + Nginx</title>
      <link href="/2018/08/19/%E9%85%8D%E7%BD%AE-php7-Nginx/"/>
      <url>/2018/08/19/%E9%85%8D%E7%BD%AE-php7-Nginx/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><hr><h2 id="PHP7"><a href="#PHP7" class="headerlink" title="PHP7"></a>PHP7</h2><p>ä¹‹å‰ä¸ºäº†é…åˆå®Œæˆä¸€ä¸ªé¡¹ç›®ï¼ˆPHP ç‰ˆæœ¬ä¸º5.6ï¼‰ï¼Œåœ¨æœ¬æœºæ­å»ºäº† PHP56 çš„ç¯å¢ƒï¼Œåé¢è‡ªå·±ç³»ç»Ÿå‡çº§ä¸º <code>macOS High Sierra</code>ï¼Œå‘ç°ç³»ç»Ÿè‡ªå¸¦çš„ PHP ç‰ˆæœ¬å·²ç»æ˜¯ 7.1 äº†ï¼Œäºæ˜¯å°±å¼€å§‹ä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦çš„ PHP ç‰ˆæœ¬äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -v</span><br></pre></td></tr></table></figure><p>æ˜¾ç¤º PHP ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PHP 7.1.16 (cli) (built: Apr  1 2018 13:14:42) ( NTS )</span><br><span class="line">Copyright (c) 1997-2018 The PHP Group</span><br><span class="line">Zend Engine v3.1.0, Copyright (c) 1998-2018 Zend Technologies</span><br></pre></td></tr></table></figure><p>ç³»ç»Ÿè‡ªå¸¦çš„ PHP7.1 æ²¡æœ‰é»˜è®¤çš„ <code>php.ini</code> æ–‡ä»¶ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤æŸ¥æ‰¾ä¸€ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -r &quot;echo php_ini_loaded_file();&quot;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å¹¶æ²¡æœ‰æ‰“å°å¯¹åº”çš„é…ç½®æ–‡ä»¶ä¿¡æ¯ã€‚éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å»å¤åˆ¶ä¸€ä»½ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /private/etc/php.ini.default /private/etc/php.ini</span><br></pre></td></tr></table></figure><p>å†æ¬¡æ‰§è¡Œä¸Šé¢å‘½ä»¤ï¼Œå³å¯çœ‹åˆ°é…ç½®æ–‡ä»¶çš„ç»å¯¹è·¯å¾„äº†ã€‚æˆ–è€…æ‰§è¡Œ <code>php --ini</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">php --ini</span><br><span class="line"></span><br><span class="line">Configuration File (php.ini) Path: /etc</span><br><span class="line">Loaded Configuration File:         /etc/php.ini</span><br><span class="line">Scan for additional .ini files in: (none)</span><br><span class="line">Additional .ini files parsed:      (none)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸ªé—®é¢˜éœ€è¦æ³¨æ„ï¼Œ<code>php.ini</code> æ–‡ä»¶å¤åˆ¶æˆåŠŸåï¼Œéœ€è¦ä¸‹é¢ä¸¤æ­¥æ“ä½œï¼Œå¦åˆ™åœ¨ php ä»£ç å‘ç”Ÿè‡´å‘½é”™è¯¯çš„æ—¶å€™ï¼Œé¡µé¢ä¸ä¼šè¾“å‡ºä»»ä½•å†…å®¹ï¼Œåªæ˜¯æŠ¥ <code>HTTP ERROR 500</code> çš„é”™è¯¯ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼Œä¿®æ”¹ <code>php.ini</code> æ–‡ä»¶çš„æƒé™ï¼Œå¦åˆ™æ— æ³•ç¼–è¾‘ä¿å­˜ï¼Œé»˜è®¤æ˜¯åªè¯»å±æ€§ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod 777 /private/etc/php.ini</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒæ­¥ï¼Œç¼–è¾‘ <code>php.ini</code> æ–‡ä»¶ï¼Œå°† <code>display_errors = Off</code> æ”¹ä¸ºä¸‹é¢ <code>on</code> å³å¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">display_errors = On</span><br></pre></td></tr></table></figure><p>è®°å¾—æ¯æ¬¡ä¿®æ”¹å®Œé…ç½®æ–‡ä»¶ï¼Œéœ€è¦é‡å¯ <code>php-fpm</code> å’Œ <code>nginx</code> æœåŠ¡ã€‚</p><h2 id="PHP56"><a href="#PHP56" class="headerlink" title="PHP56"></a>PHP56</h2><p><strong>1. å®‰è£… PHP56</strong> </p><p>å¯ä»¥å‚è€ƒä¸‹é¢ä¸¤ç¯‡æ–‡ç« ã€‚</p><ul><li><p><a href="http://www.veryitman.com/2017/02/02/PHP-%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87/">PHPå¼€å‘å‡†å¤‡</a></p></li><li><p><a href="http://www.veryitman.com/2017/02/02/%E5%AE%89%E8%A3%85-PHP-%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/">å®‰è£… PHP é‡åˆ°çš„é—®é¢˜</a></p></li></ul><p><strong>2. å¸è½½ï¼ˆåˆ é™¤ï¼‰PHP56</strong></p><p>æ‰§è¡Œ brew uninstall </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew uninstall php</span><br></pre></td></tr></table></figure><p>å³å¯å®Œæˆå¸è½½ã€‚</p><p>å¦‚æœå¸è½½é‡åˆ°é—®é¢˜ï¼Œå°±æ‰“å¼€ <code>/usr/local/Cellar/</code> ç›®å½•ï¼Œåˆ é™¤å¯¹åº”çš„ PHP ç›®å½•å³å¯ã€‚</p><h2 id="é…ç½®-php-fpm"><a href="#é…ç½®-php-fpm" class="headerlink" title="é…ç½® php-fpm"></a>é…ç½® php-fpm</h2><p>ç°åœ¨æ–°ç‰ˆæœ¬çš„ PHP å…¶å†…æ ¸å·²ç»é›†æˆäº† php-fpmï¼Œæˆ‘ä»¬ä¸éœ€è¦å¦å¤–å®‰è£…äº†ã€‚</p><p>é…ç½® php-fpm é…ç½®æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /private/etc/php-fpm.conf.default /private/etc/php-fpm.conf</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹é…ç½®æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /private/etc/php-fpm.conf</span><br></pre></td></tr></table></figure><p>æ‰¾åˆ° error_log é¡¹ï¼Œæ·»åŠ ä¸‹é¢ä¸¤ä¸ªé…ç½®é¡¹ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">error_log = /usr/local/var/log/php-fpm.log</span><br><span class="line">pid = /usr/local/var/run/php-fpm.pid</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸é…ç½®ä¸Šé¢çš„é…ç½®é¡¹ï¼Œå¯åŠ¨ php-fpm ä¼šæŠ¥é”™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ERROR: failed to open error_log (/usr/var/log/php-fpm.log): No such file or directory (2)</span><br><span class="line">ERROR: failed to post process the configuration</span><br><span class="line">ERROR: FPM initialization failed</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥, ç»§ç»­é…ç½®ï¼Œå°† <code>www.conf.default</code> å¤åˆ¶ä¸€ä»½å‘½åä¸º <code>www.conf</code> å³å¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /private/etc/php-fpm.d/</span><br><span class="line"></span><br><span class="line">sudo cp www.conf.default www.conf </span><br></pre></td></tr></table></figure><p>ä¸é…ç½®ä¸Šé¢çš„ï¼Œä¼šæŠ¥å¦‚ä¸‹é”™è¯¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ERROR: No pool defined. at least one pool section must be specified in config file</span><br><span class="line">ERROR: FPM initialization failed</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œå¯ä»¥å¯åŠ¨ php-fpm äº†ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo php-fpm -D</span><br></pre></td></tr></table></figure><p>ä¸å‡ºæ„å¤–çš„è¯ï¼Œå·²ç»æˆåŠŸå¯åŠ¨ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤æŸ¥çœ‹ç«¯å£ä½¿ç”¨æƒ…å†µ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -an | grep 9000</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ åœ¨å¯åŠ¨ php-fpm é‡åˆ°ä¸‹é¢çš„é”™è¯¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ERROR: unable to bind listening socket for address &#x27;127.0.0.1:9000&#x27;: Address already in use (48)</span><br><span class="line">ERROR: FPM initialization failed</span><br></pre></td></tr></table></figure><p>æœ‰ä¸¤ç§æ–¹å¼è§£å†³è¿™ä¸ªé—®é¢˜</p><p>**1.**ä¿®æ”¹ php-fpm ä½¿ç”¨çš„ç«¯å£å·</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /private/etc/php-fpm.d/www.conf</span><br></pre></td></tr></table></figure><p>å°† <code>listen = 127.0.0.1:9000</code> æ”¹ä¸º <code>listen = 127.0.0.1:9001</code> å³å¯ã€‚</p><p>**2.**æ€æ‰9000ç«¯å£å ç”¨çš„è¿›ç¨‹</p><p>å…³é—­æ‰€æœ‰ä¹‹å‰å¯åŠ¨çš„ php-fpm</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">killall php-fpm</span><br></pre></td></tr></table></figure><p>æ‰¾åˆ°å ç”¨ç«¯å£çš„è¿›ç¨‹å·</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -an | grep 9000</span><br></pre></td></tr></table></figure><p>ç„¶å <code>kill -9 pid</code>ï¼Œé‡æ–°å¯åŠ¨ php-fpm å³å¯ã€‚</p><h2 id="å®‰è£…å’Œé…ç½®-Nginx"><a href="#å®‰è£…å’Œé…ç½®-Nginx" class="headerlink" title="å®‰è£…å’Œé…ç½® Nginx"></a>å®‰è£…å’Œé…ç½® Nginx</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install nginx</span><br></pre></td></tr></table></figure><p>åˆ›å»ºæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /usr/local/var/log/nginx</span><br><span class="line">mkdir -p /usr/local/etc/nginx/sites-available</span><br><span class="line">mkdir -p /usr/local/etc/nginx/sites-enabled</span><br><span class="line">mkdir -p /usr/local/etc/nginx/conf.d</span><br><span class="line">mkdir -p /usr/local/etc/nginx/ssl</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir -p /var/www</span><br><span class="line">sudo chown :staff /var/www</span><br><span class="line">sudo chmod 775 /var/www</span><br><span class="line">vi /var/www/info.php</span><br><span class="line">vi /var/www/index.html</span><br><span class="line">vi /var/www/403.html</span><br><span class="line">vi /var/www/404.html</span><br></pre></td></tr></table></figure><p>æ”¹å˜ nginx.conf é…ç½®æ–‡ä»¶</p><p>è¯¥é…ç½®æ–‡ä»¶åœ¨ <code>/usr/local/etc/nginx/nginx.conf</code> ä¸‹é¢.</p><p>æˆ‘çš„é…ç½®:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1;</span><br><span class="line"> </span><br><span class="line">error_log  /usr/local/etc/nginx/logs/error.log debug;</span><br><span class="line">pid        /usr/local/var/run/nginx.pid;</span><br><span class="line"> </span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  256;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">http &#123;</span><br><span class="line">    include             mime.types;</span><br><span class="line">    default_type        application/octet-stream;</span><br><span class="line"> </span><br><span class="line">    log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br><span class="line">                      &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class="line">                      &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br><span class="line"> </span><br><span class="line">    access_log  /usr/local/etc/nginx/logs/access.log  main;</span><br><span class="line"> </span><br><span class="line">    sendfile            on;</span><br><span class="line"> </span><br><span class="line">    keepalive_timeout   65;</span><br><span class="line"> </span><br><span class="line">    index index.html index.php;</span><br><span class="line"> </span><br><span class="line">    include /usr/local/etc/nginx/sites-enabled/*; </span><br><span class="line">    include /usr/local/etc/nginx/conf.d/*;</span><br><span class="line">     server &#123;</span><br><span class="line">        listen       8080;</span><br><span class="line">        server_name  localhost;</span><br><span class="line">        #charset koi8-r;</span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line">        location / &#123;</span><br><span class="line">            root   ~/projs/phpdev/nginx/nginx_sites/; #webçš„æ ¹ç›®å½•</span><br><span class="line">            index  index.php index.html index.htm; #åŠ index.php</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">root   ~/projs/phpdev/nginx/nginx_sites/; #webçš„æ ¹ç›®å½•</span><br><span class="line">index  index.php index.html index.htm; #åŠ index.php</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é…ç½®äº†æˆ‘çš„ web ç›®å½•å’Œæ”¯æŒçš„æ–‡ä»¶.</p><h2 id="è¿è¡Œ-PHP"><a href="#è¿è¡Œ-PHP" class="headerlink" title="è¿è¡Œ PHP"></a>è¿è¡Œ PHP</h2><ul><li><p>åˆ›å»º index.php</p></li><li><p>å¯åŠ¨ php-fpm</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo php-fpm</span><br></pre></td></tr></table></figure><p>æˆ–è€…ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼æ¥å¯åŠ¨ PHP-fpm</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo php-fpm -D</span><br></pre></td></tr></table></figure><ul><li>å¯åŠ¨ Nginx</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nginx</span><br></pre></td></tr></table></figure><ul><li>ç¼–è¾‘ index.php</li></ul><p>åœ¨ web ç›®å½•(æˆ‘é…ç½®çš„) <code>~/projs/phpdev/nginx/nginx_sites/</code> æ–°å»ºæ–‡ä»¶ <code>index.php</code>.</p><p>index.php é‡Œé¢å¯ä»¥ç¼–å†™ä»£ç :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- lang: php --&gt;</span><br><span class="line">&lt;!-- ~/nginx_sites/index.php --&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">    echo &quot;Hello PHP&quot;;</span><br><span class="line">    echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">    </span><br><span class="line">    echo &quot;å­¦ä¹  php&quot;;</span><br><span class="line">    echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">    echo phpinfo();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æ‰“å¼€æµè§ˆå™¨, è¾“å…¥åœ°å€ï¼š<a href="http://localhost:8080/index.php">http://localhost:8080/index.php</a> ä½ ä¼šçœ‹åˆ°ä¸‹é¢çš„é¡µé¢:<br><img src="/upload/images/2018/08/19/1.jpg"></p><p>ä¹Ÿå¯ä»¥åœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºå…¶ä»– PHP æ–‡ä»¶, å¦‚ <code>m.php</code> æ–‡ä»¶.</p><p>æµè§ˆå™¨ä¸­è¾“å…¥ <a href="http://localhost:8080/m.php">http://localhost:8080/m.php</a> å¯ä»¥æ‰§è¡Œç›¸å¯¹åº”çš„æ–‡ä»¶.</p><p><strong>æ³¨æ„ï¼š</strong>è¿™é‡Œçš„ <code>m.php</code> æ˜¯æ–°å»ºçš„ PHP æ–‡ä»¶.</p><h2 id="é‡è¦æ–‡ä»¶"><a href="#é‡è¦æ–‡ä»¶" class="headerlink" title="é‡è¦æ–‡ä»¶"></a>é‡è¦æ–‡ä»¶</h2><p><strong>1. php é…ç½®æ–‡ä»¶</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/private/etc/php.ini</span><br></pre></td></tr></table></figure><p><strong>2. nginx log æ–‡ä»¶</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/var/log/nginx/access.log</span><br><span class="line"></span><br><span class="line">/usr/local/var/log/nginx/error.log</span><br><span class="line"></span><br><span class="line">/usr/local/etc/nginx/logs/error.log</span><br></pre></td></tr></table></figure><p><strong>3. nginx é…ç½®æ–‡ä»¶</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/etc/nginx/nginx.conf</span><br></pre></td></tr></table></figure><p><strong>4. php-fpm é…ç½®æ–‡ä»¶</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/private/etc/php-fpm.d/www.conf</span><br></pre></td></tr></table></figure><h2 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h2><p><strong>502 bad gateaway</strong></p><p>æˆ‘æ˜¯ç»å¸¸çœ‹åˆ°è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯æ¯æ¬¡å¼•èµ·çš„åŸå› åˆä¸å¤ªä¸€æ ·ï¼Œç»å¤§éƒ¨åˆ†æ˜¯å› ä¸º <code>php-fpm</code> å¯åŠ¨ä¸äº†æˆ–è€…æ˜¯å…¶ç«¯å£é”™è¯¯å¯¼è‡´çš„ã€‚</p><p>è¿™ç§æƒ…å†µä¸‹ï¼Œå»ºè®®å»çœ‹ <code>/usr/local/etc/nginx/logs/error.log</code> æ—¥å¿—æ–‡ä»¶ã€‚</p><p>ä¾‹å¦‚ä¸‹é¢çš„é”™è¯¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[error] </span><br><span class="line">61016#0: *1 kevent() reported that connect() failed (61: Connection refused) while connecting to upstream, </span><br><span class="line">client: 127.0.0.1, </span><br><span class="line">server: localhost, </span><br><span class="line">request: &quot;GET /3.php HTTP/1.1&quot;, </span><br><span class="line">upstream: &quot;fastcgi://127.0.0.1:9000&quot;, </span><br><span class="line">host: &quot;localhost:8080&quot;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆï¼Œæˆ‘ä¿®æ”¹äº† <code>/private/etc/php-fpm.d/www.conf</code> ä¸­ç«¯å£ä¸º <code>9000</code>ï¼ˆæˆ‘ä¹‹å‰å°†è¯¥ç«¯å£ä¿®æ”¹äº†å…¶ä»–çš„ï¼‰ï¼Œé‡å¯ <code>php-fpm</code> è§£å†³é—®é¢˜ã€‚ </p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP MySql nginx php-fpm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®€å•é…ç½® Apache</title>
      <link href="/2018/07/14/%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE-Apache/"/>
      <url>/2018/07/14/%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE-Apache/</url>
      
        <content type="html"><![CDATA[<h2 id="å£°æ˜"><a href="#å£°æ˜" class="headerlink" title="å£°æ˜"></a>å£°æ˜</h2><p>æœ‰æ—¶å€™, æˆ‘ä»¬å¸Œæœ›åœ¨è‡ªå·±æœ¬æœº(PC)æ­å»ºä¸€ä¸ª WebServer, ç„¶åè‡ªå·±å¯ä»¥åœ¨æµè§ˆå™¨æˆ–è€…æ‰‹æœºä¸Šé¢å¯ä»¥è®¿é—®å¯¹åº”çš„åœ°å€ç›´æ¥æŸ¥çœ‹æ•ˆæœ, å†æˆ–è€…å¸Œæœ›æµ‹è¯•ä¸‹è½½åŠŸèƒ½ç­‰, å…¶å® MacOS è‡ªå¸¦çš„æœ‰ Apache æœåŠ¡å™¨.</p><p>ä¸‹é¢ç®€å•åˆ†äº«ä¸€ä¸‹, åœ¨ MacOS ä¸­å¦‚ä½•ç®€å•çš„ä½¿ç”¨ Apache æœåŠ¡å™¨.</p><h2 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h2><p>å¸¸ç”¨çš„å‘½ä»¤æœ‰å¼€å¯&#x2F;é‡å¯&#x2F;åœæ­¢ç­‰.</p><p>1.å¼€å¯: <code>sudo apachectl start</code><br>2.é‡å¯: <code>sudo apachectl restart</code><br>3.å…³é—­: <code>sudo apachectl stop</code><br>4.æŸ¥çœ‹ç‰ˆæœ¬å·: <code>httpd -v</code></p><p><strong>1.æŸ¥çœ‹ Apache ç‰ˆæœ¬å·</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">httpd -v  </span><br></pre></td></tr></table></figure><p>æˆ–è€…ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apachectl -v</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ç»“æœå¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Server version: Apache/2.4.28 (Unix)</span><br><span class="line">Server built:   Oct  9 2017 19:54:20</span><br></pre></td></tr></table></figure><p><strong>2.å¯åŠ¨ Apache</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apachectl start</span><br></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨æ‰“å¼€: <a href="http://localhost/">http://localhost</a></p><p>ä¼šæ˜¾ç¤º:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">It works</span><br></pre></td></tr></table></figure><p><img src="/upload/images/2018/07/14/1.jpg"></p><p><strong>3.åœæ­¢ Apache</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apachectl stop</span><br></pre></td></tr></table></figure><p>å¦‚æœæ²¡æœ‰å¼€å¯ Apache æœåŠ¡, æ‰§è¡Œä¸Šé¢å‘½ä»¤çš„è¯, ä¼šæŠ¥ä¸‹é¢çš„é”™è¯¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/System/Library/LaunchDaemons/org.apache.httpd.plist: </span><br><span class="line">Could not find specified service</span><br></pre></td></tr></table></figure><p><strong>4.é‡æ–°å¯åŠ¨ Apache</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apachectl restart</span><br></pre></td></tr></table></figure><p>å¦‚æœä¿®æ”¹äº† Apache çš„é…ç½®æ–‡ä»¶, éœ€è¦é‡æ–°å¯åŠ¨ Apache æœåŠ¡, æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤å³å¯.</p><h2 id="é…ç½®-Sites"><a href="#é…ç½®-Sites" class="headerlink" title="é…ç½® Sites"></a>é…ç½® Sites</h2><p>åœ¨è‡ªå·±çš„ç”¨æˆ·ç›®å½•, æ–°å»ºä¸€ä¸ª <code>Sites</code> ç›®å½•, ä¾‹å¦‚æˆ‘çš„ç”¨æˆ·ç›®å½•æ˜¯ <code>/Users/mark</code>, å¯ä»¥åœ¨ç»ˆç«¯åˆ†åˆ«æ‰§è¡Œ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /Users/mark</span><br><span class="line"></span><br><span class="line">mkdir Sites</span><br></pre></td></tr></table></figure><p>æ‰§è¡ŒæˆåŠŸå, å¯ä»¥çœ‹åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ç›®å½•:</p><p><img src="/upload/images/2018/07/14/2.jpg"></p><p>æ¥ä¸‹æ¥ä¿®æ”¹ Apache ä¸­çš„é…ç½®æ–‡ä»¶, æ‰§è¡Œä¸‹é¢å‘½ä»¤å¼€å§‹ç¼–è¾‘ <code>httpd.conf</code> æ–‡ä»¶.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/apache2/httpd.conf </span><br></pre></td></tr></table></figure><p>æ‰“å¼€ httpd.conf æ–‡ä»¶ï¼ŒæŸ¥æ‰¾ <code>userdir</code> å…³é”®å­—.</p><p>æ‰¾åˆ°å¦‚ä¸‹ä¸¤è¡Œè¢«æ³¨é‡Šæ‰çš„å†…å®¹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#Include /private/etc/apache2/extra/httpd-userdir.conf</span><br><span class="line"></span><br><span class="line">#LoadModule userdir_module libexec/apache2/mod_userdir.so</span><br></pre></td></tr></table></figure><p>å°†å…¶å‰é¢çš„ <code>#</code>(æ³¨é‡Š) å»æ‰, ç´§æ¥ç€ç¼–è¾‘è¿™ä¸ªæ–‡ä»¶, å¢åŠ å¦‚ä¸‹å†…å®¹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Directory /Users/mark/Sites&gt;</span><br><span class="line">  Require all granted</span><br><span class="line">&lt;/Directory&gt;</span><br></pre></td></tr></table></figure><p>å°†ä¸Šé¢çš„è¿™äº›ä»£ç æ”¾åˆ°å¦‚ä¸‹ä»£ç ä¸‹é¢å³å¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;Directory &quot;/Library/WebServer/CGI-Executables&quot;&gt;</span><br><span class="line">    AllowOverride None</span><br><span class="line">    Options All</span><br><span class="line">    Require all granted</span><br><span class="line">&lt;/Directory&gt;</span><br></pre></td></tr></table></figure><p>ä¿å­˜è¯¥æ–‡ä»¶å¹¶é€€å‡º vim.</p><p>æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ä¿®æ”¹ <code>httpd-userdir.conf</code> æ–‡ä»¶:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /private/etc/apache2/extra/httpd-userdir.conf</span><br></pre></td></tr></table></figure><p>å¢åŠ å¦‚ä¸‹å†…å®¹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">UserDir Sites</span><br><span class="line"></span><br><span class="line">&lt;IfModule bonjour_module&gt;</span><br><span class="line">   RegisterUserSite customized-users</span><br><span class="line">&lt;/IfModule&gt;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„:</strong> å¦‚æœåœ¨ <code>/private/etc/apache2/extra/</code> ç›®å½•ä¸‹æ²¡æœ‰è¯¥æ–‡ä»¶, æ–°å»ºä¸€ä¸ªå³å¯.</p><p>ä¿å­˜æ–‡ä»¶å¹¶é€€å‡ºå³å¯.</p><p>æˆ‘ä»¬å¯ä»¥å°†è‡ªå·±éœ€è¦è¿è¡Œçš„ html ç­‰æ–‡ä»¶æ”¾åˆ°è¯¥ç›®å½•, å¦‚æˆ‘å°† <code>index.html</code> æ”¾åˆ°è¯¥ç›®å½•.</p><p>é‡æ–°å¯åŠ¨ Apache æœåŠ¡, åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ <code>http://localhost/~mark/</code>, å¯ä»¥çœ‹åˆ° <code>index.html</code> é‡Œé¢çš„å†…å®¹.</p><h2 id="WebServer-ç›®å½•"><a href="#WebServer-ç›®å½•" class="headerlink" title="WebServer ç›®å½•"></a>WebServer ç›®å½•</h2><p>ä¸Šé¢æˆ‘ä»¬æåˆ°, å¯åŠ¨ Apache æœåŠ¡ä¹‹å, åœ¨æµè§ˆå™¨å¯ä»¥çœ‹åˆ° <code>It Works</code> çš„å­—æ ·, é‚£ä¹ˆè¿™ä¸ªæ˜¯å“ªä¸ªæ–‡ä»¶è¾“å‡ºçš„å‘¢?</p><p>è¿™ä¸ªæ–‡ä»¶æ˜¯ <code>sudo mvim index.html.en~orig</code>, åœ¨å¦‚ä¸‹ç›®å½•:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/Library/WebServer/Documents</span><br></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨ vim ç¼–è¾‘è¯¥æ–‡ä»¶, ç„¶åå†åˆ·æ–°æµè§ˆå™¨å°±å¯ä»¥çœ‹åˆ°å…¶å˜åŒ–.</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠè‡ªå·±çš„ html æ–‡ä»¶æ”¾åˆ°è¿™é‡Œ, å¦‚ <code>mark.html</code>, å†…å®¹å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">&lt;h1&gt;Hi, mark, Apache server works!&lt;/h1&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ <code>http://localhost/mark.html</code>, å¯ä»¥çœ‹åˆ°å¯¹åº”çš„è¾“å‡º.</p><p>å¦‚æœå«Œé…ç½® <code>Sites</code> ç›®å½•éº»çƒ¦, å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼, ç›´æ¥æ‹·è´å¯¹åº”çš„æ–‡ä»¶æˆ–è€…ç›®å½•æ”¾åˆ° <code>/Library/WebServer/Documents</code> ä¸­, åªä¸è¿‡éœ€è¦ root æƒé™ç½¢äº†.</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Apache WebServer MacOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RunLoop: ç§»é™¤å¸¸é©»çº¿ç¨‹</title>
      <link href="/2018/07/01/RunLoop-%E7%A7%BB%E9%99%A4%E5%B8%B8%E9%A9%BB%E7%BA%BF%E7%A8%8B/"/>
      <url>/2018/07/01/RunLoop-%E7%A7%BB%E9%99%A4%E5%B8%B8%E9%A9%BB%E7%BA%BF%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h2><p>ä¸‹é¢ä¸¤ç¯‡æ–‡ç« :</p><ul><li><p><a href="http://www.veryitman.com/2018/04/21/%E5%B8%B8%E9%A9%BB%E7%BA%BF%E7%A8%8B%E6%98%AF%E4%B8%80%E7%A7%8D%E4%BB%80%E4%B9%88%E4%BD%93%E9%AA%8C/">å¸¸é©»çº¿ç¨‹æ˜¯ä¸€ç§ä»€ä¹ˆä½“éªŒ</a></p></li><li><p><a href="http://www.veryitman.com/2018/05/06/RunLoop-NSTimer-%E5%AE%9E%E7%8E%B0%E5%B8%B8%E9%A9%BB%E7%BA%BF%E7%A8%8B%E7%9A%84%E9%97%AE%E9%A2%98/">NSTimer å®ç°å¸¸é©»çº¿ç¨‹çš„é—®é¢˜</a></p></li></ul><p>éƒ½æ˜¯åœ¨ iOS å¹³å°ä¸Šå¦‚ä½•åˆ©ç”¨ <code>RunLoop</code> çš„ç‰¹æ€§å®ç°å¸¸é©»çº¿ç¨‹.</p><p>å¯èƒ½ä½ çœ‹åˆ°æœ¬ç¯‡æ–‡ç« çš„æ ‡é¢˜ <code>ç§»é™¤å¸¸é©»çº¿ç¨‹</code>, æœ‰ç‚¹ä¸ç†è§£ç”šè‡³è§‰å¾—ä½œè€…æ˜¯ä¸æ˜¯æœ‰ç‚¹ç¥ç»ç—…, éƒ½å·²ç»éœ€è¦å¸¸é©»çº¿ç¨‹äº†, ä¸ºä»€ä¹ˆè¿˜è¦å»é€€å‡ºå‘¢?</p><p>å®é™…åº”ç”¨åœºæ™¯ä¸­çš„ç¡®å‡ ä¹é‡ä¸åˆ°è¿™ç§æƒ…å†µ, æ‰€ä»¥, æœ¬ç¯‡åªæ˜¯ä»æŠ€æœ¯çš„è§’åº¦ç»™å¤§å®¶åˆ†äº« <code>RunLoop</code> å…¶ä»–çš„ä¸€äº›çŸ¥è¯†ç‚¹.</p><p>ä¸”è€ä½æ€§å­å¾€ä¸‹çœ‹â€¦</p><p>ä¸ºäº†ä¸è®©å¤§å®¶è¯¯è§£, ç»Ÿä¸€ä¸€ä¸‹ç›¸å…³çš„è¯æ±‡å’Œè¯­å¢ƒ.</p><ul><li>è¾“å…¥æº, åŒ…æ‹¬ source å’Œ timer.</li><li>é€€å‡º RunLoop æŒ‡çš„æ˜¯åœ¨å¸¸é©»çº¿ç¨‹çš„æ–¹æ³•ä¸­ç«‹å³è¿”å›.</li><li>è¿™é‡Œçš„ RunLoop æŒ‡çš„æ˜¯å­çº¿ç¨‹ä¸­çš„ RunLoop ä¸æ˜¯ä¸»çº¿ç¨‹ä¸­çš„.</li><li>ç»“åˆä¹‹å‰ä»‹ç»å¸¸é©»çº¿ç¨‹çš„æ–‡ç« æ¥çœ‹ç°åœ¨çš„æ–‡ç« , ä¸ç„¶ä¸å¥½ç†è§£.</li></ul><h2 id="è¿è¡Œ-RunLoop-çš„æ–¹æ³•"><a href="#è¿è¡Œ-RunLoop-çš„æ–¹æ³•" class="headerlink" title="è¿è¡Œ RunLoop çš„æ–¹æ³•"></a>è¿è¡Œ RunLoop çš„æ–¹æ³•</h2><p>è¿™é‡Œæœ‰ä¸‰ç§æ–¹å¼å¼€å¯è¿è¡Œ RunLoop, åˆ†åˆ«å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (void)run;</span><br><span class="line"></span><br><span class="line">- (void)runUntilDate:(NSDate *)limitDate;</span><br><span class="line"></span><br><span class="line">- (void)runMode:(NSString *)mode beforeDate:(NSDate *)limitDate;</span><br></pre></td></tr></table></figure><ul><li><strong>run æ–¹æ³•</strong></li></ul><p>çœ‹ä¸€ä¸‹ API æ–‡æ¡£å¦‚ä½•è§£é‡Š <code>run</code> æ–¹æ³•çš„:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Puts the receiver into a permanent loop, </span><br><span class="line">during which time it processes data from all attached input sources.</span><br><span class="line">If no input sources or timers are attached to the run loop, this method exits immediately; </span><br><span class="line">otherwise, it runs the receiver in the NSDefaultRunLoopMode by repeatedly invoking runMode:beforeDate:. </span><br><span class="line">In other words, this method effectively begins an infinite loop that processes data from the run loopâ€™s input sources and timers.</span><br></pre></td></tr></table></figure><p>å¤§è‡´æ„æ€è®²çš„æ˜¯, åœ¨æ²¡æœ‰ä»»ä½•è¾“å…¥æºçš„æƒ…å†µä¸‹, <code>run</code> æ–¹æ³•ä¼šç«‹å³æ‰§è¡Œåé€€å‡º, ä¸ä¼šä¿æŒçº¿ç¨‹çš„æŒä¹…æ€§, æ¢å¥è¯è¯´, åœ¨æœ‰è¾“å…¥æºçš„æƒ…å†µä¸‹, è¯¥æ–¹æ³•ä¼šè¿›å…¥ä¸€ä¸ªæ— é™å¾ªç¯å½“ä¸­. æœ¬è´¨ä¸Š, åœ¨ <code>NSDefaultRunLoopMode</code> æ¨¡å¼ä¸‹, è¯¥æ–¹æ³•æ˜¯åå¤è°ƒç”¨ <code>runMode:beforeDate:</code> æ–¹æ³•çš„.</p><p>åœ¨ä¹‹å‰æ–‡ç« å®ç°å¸¸é©»çº¿ç¨‹çš„ä»£ç ä¸­, æˆ‘ä»¬ä½¿ç”¨äº† <code>run</code> æ–¹æ³•æ¥å¼€å¯è¿è¡Œ RunLoop.</p><p>å¯ä»¥çœ‹å‡º, æˆ‘ä»¬ä¹‹å‰å®ç°çš„å¸¸é©»çº¿ç¨‹ä½¿ç”¨ <code>run</code> æ–¹æ³•æ˜¯æ— æ³•é€€å‡ºå¸¸é©»çº¿ç¨‹çš„.</p><ul><li>*<em>runUntilDate:(NSDate <em>)limitDate æ–¹æ³•</em></em></li></ul><p>è¯¥æ–¹æ³• API é‡Šä¹‰:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Runs the loop until the specified date, </span><br><span class="line">during which time it processes data from all attached input sources.</span><br></pre></td></tr></table></figure><p>ä¿è¯æœ‰è¾“å…¥æºçš„æƒ…å†µä¸‹è¯¥æ–¹æ³•å¯åŠ¨çš„ RunLoop å¯ä»¥åœ¨æŒ‡å®šçš„æ—¥æœŸå†…ä¸€ç›´è¿è¡Œä¸ä¼šè¿”å›. æ¢å¥è¯è¯´, æ—¥æœŸåªè¦å·²åˆ°è¯¥æ–¹æ³•å°±ä¼šç«‹å³é€€å‡º RunLoop.</p><p>ç¤ºä¾‹ä»£ç :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//ç­‰åŒäº run, å¯ä¿è¯ä¸€ç›´è¿è¡Œ</span><br><span class="line">[runLoop runUntilDate:[NSDate distantFuture]];</span><br><span class="line"></span><br><span class="line">//ç«‹å³è¿”å›, é€€å‡º RunLoop</span><br><span class="line">[runLoop runUntilDate:[NSDate date]];</span><br><span class="line"></span><br><span class="line">//ç„¶åè¿‡12ç§’åè¿”å›</span><br><span class="line">[runLoop runUntilDate:[NSDate dateWithTimeIntervalSinceNow:12.0f]];</span><br></pre></td></tr></table></figure><ul><li>**runMode:(NSString <em>)mode beforeDate:(NSDate <em>)limitDate æ–¹æ³•</em></em></li></ul><p>è¯¥æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•° <code>mode</code> å’Œ <code>limitDate</code>, <code>mode</code> å°±æ˜¯ RunLoop çš„è¿è¡Œæ¨¡å¼, <code>limitDate</code> å°±æ˜¯ä¸Šé¢æ–¹æ³•ä¸€æ ·çš„é‡Šä¹‰å³åœ¨æŒ‡å®šçš„æ—¥æœŸå†….</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Runs the loop once, blocking for input in the specified mode until a given date.</span><br></pre></td></tr></table></figure><p>å¯ä»¥è¿™ä¹ˆç†è§£, è¯¥æ–¹æ³•å¼€å¯çš„ RunLoop å¤„ç†å®Œä¹‹åä¼šç«‹å³è¿”å›(once), å¦‚æœåœ¨æŒ‡å®šæ—¥æœŸå†…äº‹ä»¶è¿˜æ²¡å¤„ç†, åœ¨è¯¥æ—¥æœŸåä¼šç«‹å³è¿”å›.<br>æ¢å¥è¯è¯´, å¦‚æœæŒ‡å®šçš„æ—¥æœŸæ˜¯å½“å‰çš„, è¯¥æ–¹æ³•æ‰§è¡Œå RunLoop ä¼šç«‹å³é€€å‡º.</p><p>ç¤ºä¾‹ä»£ç :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//ç«‹å³è¿”å›</span><br><span class="line">[runLoop runMode:NSDefaultRunLoopMode beforeDate:[NSDate date]];</span><br><span class="line">        </span><br><span class="line">//æœ‰äº‹ä»¶åˆ°è¾¾å¤„ç†åå°±è¿”å›ï¼Œå¦‚æœæ²¡æœ‰åˆ™è¿‡12ç§’è¿”å›</span><br><span class="line">[runLoop runMode:NSDefaultRunLoopMode beforeDate:[NSDate dateWithTimeIntervalSinceNow:12.0]]; </span><br></pre></td></tr></table></figure><p>è¿™ä¸‰ä¸ªæ–¹æ³•, æ€»ç»“ä¸€ä¸‹å¤§æ¦‚å¦‚ä¸‹:</p><ul><li>è¿™ä¸‰ä¸ªæ–¹æ³•åœ¨æ²¡æœ‰ä»»ä½•è¾“å…¥æºæƒ…å†µä¸‹ä¼šéƒ½ç«‹å³è¿”å›(é€€å‡º RunLoop), ä¸ä¼šç­‰å¾….</li><li><code>run</code> å¯ä¿è¯ RunLoop åœ¨æœ‰è¾“å…¥æºçš„æƒ…å†µä¸‹ä¸€ç›´è¿è¡Œ.</li><li><code>runUntilDate</code> å¯ä»¥é€šè¿‡è®¾ç½®è¶…æ—¶æ—¶é—´æ¥é€€å‡º RunLoop. è¶…æ—¶æ—¶é—´ä¸€è¿‡å°±ä¼šç«‹å³é€€å‡º RunLoop.</li><li>ä½¿ç”¨ <code>runMode</code> æ–¹å¼å¯åŠ¨çš„ RunLoop ä¼šåœ¨å¤„ç†å®Œäº‹ä»¶åæˆ–è€…è¶…æ—¶å, ç«‹å³è¿”å›. å³å¯ä»¥é€šè¿‡è®¾ç½®è¶…æ—¶æ—¶é—´æˆ–è€…ä½¿ç”¨ <code>CFRunLoopStop</code> æ–¹æ³•æ¥é€€å‡º RunLoop.</li></ul><h2 id="ç§»é™¤å¸¸é©»çº¿ç¨‹"><a href="#ç§»é™¤å¸¸é©»çº¿ç¨‹" class="headerlink" title="ç§»é™¤å¸¸é©»çº¿ç¨‹"></a>ç§»é™¤å¸¸é©»çº¿ç¨‹</h2><p>å…ˆçœ‹ä¸€ä¸‹, åœ¨å­çº¿ç¨‹æ‰§è¡Œçš„æ–¹æ³•ä¸­å¦‚ä½•å®ç°çš„. ç¤ºä¾‹ä»£ç å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">- (void)asyncRun &#123;</span><br><span class="line">    </span><br><span class="line">    @autoreleasepool &#123;</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;veryitman--asyncRun. Current Thread: %@&quot;, [NSThread currentThread]);</span><br><span class="line">        </span><br><span class="line">        NSRunLoop *runLoop = [NSRunLoop currentRunLoop];</span><br><span class="line">        _threadRunLoop = runLoop;</span><br><span class="line">        </span><br><span class="line">        // ä¿æŒå¸¸é©»çº¿ç¨‹çš„æ–¹å¼1: source</span><br><span class="line">        NSPort *port = [NSMachPort port];</span><br><span class="line">        _threadPort = port;</span><br><span class="line">        [runLoop addPort:port forMode:NSRunLoopCommonModes];</span><br><span class="line"></span><br><span class="line">        NSLog(@&quot;veryitman--asyncRun. Current RunLoop: %@&quot;, runLoop);</span><br><span class="line">        </span><br><span class="line">        // æ‰§è¡Œå…¶ä»–é€»è¾‘</span><br><span class="line">        //...</span><br><span class="line">        </span><br><span class="line">        // æ‰‹åŠ¨å¼€å¯ RunLoop</span><br><span class="line">        // [runLoop run];</span><br><span class="line">        </span><br><span class="line">        while (!self.stopLoopRunning &amp;&amp; [runLoop runMode:NSDefaultRunLoopMode beforeDate:[NSDate distantPast]]) &#123;</span><br><span class="line">            </span><br><span class="line">            // è¿™é‡Œæ˜¯ä¸ºäº†éªŒè¯å¸¸é©»çº¿ç¨‹æ˜¯å¦å·²ç»é€€å‡º</span><br><span class="line">            NSLog(@&quot;--- asyncRun ----&quot;);</span><br><span class="line">            </span><br><span class="line">            // å®é™…ä¸šåŠ¡ä¸­, å»ºè®®ä½¿ç”¨ç©ºè¯­å¥å®ç°</span><br><span class="line">            ; //å®ç°ä¸ºç©ºè¯­å¥</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;veryitman--asyncRun. End Run.&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“åˆä¸Šé¢è®²è§£çš„åŸç†, è¿™é‡Œé€‰æ‹©ä½¿ç”¨ <code>runMode</code> æ–¹æ³•æ¥å¼€å¯è¿è¡Œ RunLoop. å¤§å®¶ä¹Ÿå¯ä»¥è‡ªç”±å‘æŒ¥ä½¿ç”¨å…¶ä»–çš„æ–¹æ³•.</p><p><strong>æ³¨æ„: <code>stopLoopRunning</code> æ˜¯å®šä¹‰çš„ä¸€ä¸ªå±æ€§.</strong></p><p>ç§»é™¤çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidDisappear:(BOOL)animated &#123;</span><br><span class="line">    </span><br><span class="line">    [super viewDidDisappear:animated];</span><br><span class="line">    </span><br><span class="line">    // å–æ¶ˆçº¿ç¨‹</span><br><span class="line">    // å®é™…ä¸šåŠ¡åœºæ™¯ä¸­è‡ªè¡Œå†³å®š canCancel çš„è®¾ç½®, è¿™é‡Œåªæ˜¯ç¤ºä¾‹</span><br><span class="line">    BOOL canCancel = YES;</span><br><span class="line">    if (canCancel) &#123;</span><br><span class="line">        [[self permanentThread] cancel];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    /// åœæ­¢å¸¸é©»çº¿ç¨‹</span><br><span class="line">    &#123;</span><br><span class="line">        self.stopLoopRunning = YES;</span><br><span class="line">        </span><br><span class="line">        // ç§»é™¤ port</span><br><span class="line">        // å¦‚æœæ˜¯ç”¨ timer çš„æ–¹å¼çš„å¸¸é©»çº¿ç¨‹, å¯ä»¥ invalid å¯¹åº”çš„ timer</span><br><span class="line">        [self.threadRunLoop removePort:self.threadPort forMode:NSRunLoopCommonModes];</span><br><span class="line">        </span><br><span class="line">        // åœæ­¢ RunLoop</span><br><span class="line">        if (nil != self.threadRunLoop) &#123;</span><br><span class="line">            CFRunLoopStop([self.threadRunLoop getCFRunLoop]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¦»å¼€é¡µé¢å, å¯ä»¥å‘ç° <code>NSLog(@&quot;--- asyncRun ----&quot;);</code> åœæ­¢äº†æ‰“å°, å¹¶ä¸”å½“å‰çš„ Controller ä¹Ÿ dealloc äº†.</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RunLoop å¸¸é©»çº¿ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS é€†å‘: dumpdecrypted ç ¸å£³è®°</title>
      <link href="/2018/06/07/iOS-%E9%80%86%E5%90%91-dumpdecrypted-%E7%A0%B8%E5%A3%B3%E8%AE%B0/"/>
      <url>/2018/06/07/iOS-%E9%80%86%E5%90%91-dumpdecrypted-%E7%A0%B8%E5%A3%B3%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©æ˜¯ä¸€ä¸ªç‰¹åˆ«çš„æ—¥å­, é«˜è€ƒçš„ç¬¬ä¸€å¤©, ç¥å„ä½è˜è˜å­¦å­é‡‘æ¦œé¢˜å.</p><p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><hr><p><a href="http://www.veryitman.com/2018/05/13/iOS-%E9%80%86%E5%90%91-%E7%A0%B8%E5%A3%B3/">iOS é€†å‘: ç ¸å£³</a> ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨å·¥å…· <code>Clutch</code> å¯¹ iOS çš„åº”ç”¨è¿›è¡Œç ¸å£³æ“ä½œ, ä»Šå¤©ç»§ç»­ç»™å¤§å®¶åˆ†äº«ä½¿ç”¨å¦å¤–ä¸€ä¸ªå·¥å…· <code>dumpdecrypted</code> å¯¹ APP è¿›è¡Œç ¸å£³.</p><h2 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h2><p>æœ‰äº›æœ‹å‹å°±ä¼šé—®äº†, æ—¢ç„¶ <code>Clutch</code> å·²ç»å¾ˆç‰›Bäº†, ä¸ºä»€ä¹ˆè¿˜éœ€è¦ <code>dumpdecrypted</code> è¿™ä¸ªå·¥å…·å‘¢? </p><p>åˆšå¼€å§‹çš„æ—¶å€™, æˆ‘ä¹Ÿå¾ˆæ’æ–¥ä½¿ç”¨ <code>dumpdecrypted</code> è¿™ä¸ªå·¥å…·çš„, ä½¿ç”¨èµ·æ¥æ¯”è¾ƒå¤æ‚, å¹¶ä¸”å¥—è·¯ä¸ç†Ÿçš„æƒ…å†µä¸‹è¿˜å¾ˆå®¹æ˜“å‡ºé”™. </p><p>ä¹‹å‰è¯´è¿‡ <code>Clutch</code> å¹¶ä¸æ˜¯ä¸‡èƒ½çš„, ä» App Store ä¸‹è½½çš„ App(æ¯”å¦‚ WeChat)æœ‰äº›å¹¶ä¸èƒ½ä½¿ç”¨ <code>Clutch</code> æ¥è¿›è¡Œç ¸å£³, æ¢å¥è¯è¯´, ä½¿ç”¨ <code>Clutch</code> å·¥å…·æ¥è¿›è¡Œç ¸å£³ä¼šå¤±è´¥, é‚£ä¹ˆ, <code>dumpdecrypted</code> å°±ç™»åœºäº†.</p><p>æœ¬æ¬¡ç ¸å£³çš„ç³»ç»Ÿä¾ç„¶æ˜¯ <code>iOS10.3.x</code>, å·¥å…·ä½¿ç”¨ <code>dumpdecrypted</code>, ç ¸å£³çš„å¯¹è±¡æ˜¯ WeChat è¿™ä¸ª App.</p><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><ul><li>MacOS PC</li><li>è¶Šç‹±æ‰‹æœºä¸€å°(æˆ‘ç”¨çš„æ˜¯iPhone6SPlus 10.3.1)</li><li>dumpdecrypted</li><li>class-dump</li><li>åœ¨ Cydia ä¸­å®‰è£… cycript, å¯ä»¥å…ˆä¸ç”¨ç®¡ cycript æ˜¯ä»€ä¹ˆ, ä¸‹è½½å®‰è£…å³å¯.</li><li>iFunBox æˆ–è€…å…¶ä»–åŠ©æ‰‹å·¥å…·</li></ul><h2 id="ç¼–è¯‘-dumpdecrypted"><a href="#ç¼–è¯‘-dumpdecrypted" class="headerlink" title="ç¼–è¯‘ dumpdecrypted"></a>ç¼–è¯‘ dumpdecrypted</h2><p>å» <a href="https://github.com/stefanesser/dumpdecrypted">Github</a> ä¸‹è½½ <code>dumpdecrypted</code> æºç , æºç å°±ä¸€ä¸ª C æºæ–‡ä»¶.</p><p>ä¸‹è½½ zip åŒ…ä¹‹å, è§£å‹, å¦‚å›¾:<br><img src="/upload/images/2018/06/07/1.jpg"></p><p>åœ¨å½“å‰ç›®å½•, æ‰§è¡Œ <code>make</code> å³å¯å®Œæˆç¼–è¯‘, å¦‚å›¾æ‰€ç¤º:<br><img src="/upload/images/2018/06/07/2.jpg"></p><p>ç¼–è¯‘æˆåŠŸåç”Ÿæˆ <code>dumpdecrypted.dylib</code> æ–‡ä»¶.</p><p>è¿™é‡Œæœ‰ä¸ªå°æ’æ›², ç¼–è¯‘ <code>dumpdecrypted</code> çš„æ—¶å€™æŠ¥é”™äº†, é”™è¯¯ä¿¡æ¯å¦‚ä¸‹:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xcrun: error: SDK <span class="string">&quot;iphoneos&quot;</span> cannot be located</span><br><span class="line">xcrun: error: unable to lookup item <span class="string">&#x27;Path&#x27;</span> <span class="keyword">in</span> SDK <span class="string">&#x27;iphoneos&#x27;</span></span><br><span class="line">clang: warning: no such sysroot directory: <span class="string">&#x27;-F/System/Library/Frameworks&#x27;</span> [-Wmissing-sysroot]</span><br><span class="line">dumpdecrypted.c:27:10: fatal error: <span class="string">&#x27;stdio.h&#x27;</span> file not found</span><br></pre></td></tr></table></figure><p>æ— æ³•æ‰¾åˆ°å¯¹åº”çš„ <code>SDK</code> å’Œ <code>stdio.h</code> æ–‡ä»¶, è¿™ç§é—®é¢˜å¤§å¤šæ•°æ˜¯ Xcode è·¯å¾„é€ æˆçš„.</p><p>ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤çœ‹ä¸€ä¸‹ç³»ç»ŸæŒ‡å‘çš„ Xcode è·¯å¾„:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcode-select -p</span><br></pre></td></tr></table></figure><p>æ§åˆ¶å°è¾“å‡º:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/Library/Developer/CommandLineTools</span><br></pre></td></tr></table></figure><p>æ˜¾ç„¶ä¸æ˜¯ Xcode çš„è·¯å¾„, é‚£åªèƒ½é‡æ–°åˆ‡æ¢ä¸€ä¸‹å…¶è·¯å¾„å³æŒ‡å‘æ­£ç¡®çš„<code> Xcode</code> è·¯å¾„å³å¯.</p><p>å‘½ä»¤å¦‚ä¸‹:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo xcode-select --switch /Applications/Xcode.app</span><br></pre></td></tr></table></figure><p>å†æ¬¡ç¼–è¯‘ <code>dumpdecrypted</code> å³å¯æˆåŠŸå®Œæˆ.</p><h2 id="å¯¹-dumpecrypted-dylib-ç­¾å"><a href="#å¯¹-dumpecrypted-dylib-ç­¾å" class="headerlink" title="å¯¹ dumpecrypted.dylib ç­¾å"></a>å¯¹ dumpecrypted.dylib ç­¾å</h2><blockquote><p>å¦‚æœä¸å¯¹è¯¥æ–‡ä»¶è¿›è¡Œç­¾å, åç»­ç ¸å£³çš„æ“ä½œä¼šå¤±è´¥.</p></blockquote><p>å…ˆæ‰¾åˆ°å·²ç»åœ¨ç”µè„‘ä¸Šé¢å®‰è£…çš„è‹¹æœå¼€å‘è€…è¯ä¹¦, æ“ä½œå¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">## åˆ—å‡ºå¯ç­¾åè¯ä¹¦, æ‰¾åˆ° mac ä¸Šé¢å·²ç»å®‰è£…çš„è¯ä¹¦</span><br><span class="line">security find-identity -v -p codesigning</span><br></pre></td></tr></table></figure><p>ä¸º dumpecrypted.dylib ç­¾å, å‘½ä»¤å¦‚ä¸‹:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codesign --force --verify --verbose --sign <span class="string">&quot;iPhone Developer: xxx xxxx (xxxxxxxxxx)&quot;</span> dumpdecrypted.dylib</span><br></pre></td></tr></table></figure><p>å…¶ä¸­, <code>&quot;iPhone Developer: xxx xxxx (xxxxxxxxxx)&quot;</code> ä¸ºä½ è‡ªå·±æœ¬æœºå®‰è£…çš„å¼€å‘è€…è¯ä¹¦åç§°.</p><h2 id="SSH-è¿æ¥æ‰‹æœº"><a href="#SSH-è¿æ¥æ‰‹æœº" class="headerlink" title="SSH è¿æ¥æ‰‹æœº"></a>SSH è¿æ¥æ‰‹æœº</h2><p>ä½¿ç”¨ OpenSSH è®© Mac å’Œæ‰‹æœºè¿æ¥èµ·æ¥ è¿™æ ·å¯ä»¥å¾ˆæ–¹ä¾¿çš„åœ¨ Mac ç»ˆç«¯ä½¿ç”¨ shell å‘½ä»¤æ¥æ“ä½œæ‰‹æœºçš„ç›®å½•äº†.</p><p>å…³äº OpenSSH çš„ä½¿ç”¨è¯·å‚è€ƒæˆ‘ä¹‹å‰çš„åšæ–‡ <a href="http://www.veryitman.com/2018/05/12/iOS-%E9%80%86%E5%90%91-%E8%B6%8A%E7%8B%B1%E4%BD%BF%E7%94%A8-SSH/">iOS é€†å‘: è¶Šç‹±ä½¿ç”¨ SSH</a>.</p><h2 id="æŸ¥æ‰¾ç›®æ ‡-App-æ‰€åœ¨è¿›ç¨‹"><a href="#æŸ¥æ‰¾ç›®æ ‡-App-æ‰€åœ¨è¿›ç¨‹" class="headerlink" title="æŸ¥æ‰¾ç›®æ ‡ App æ‰€åœ¨è¿›ç¨‹"></a>æŸ¥æ‰¾ç›®æ ‡ App æ‰€åœ¨è¿›ç¨‹</h2><ul><li>åŒå‡» Home æŒ‰é”®å, æ‰‹åŠ¨æ€æ‰ iPhone ä¸Šé¢æ‰€æœ‰åœ¨åå°çš„ App.</li><li>Home åˆ°æ‰‹æœºæ¡Œé¢.</li><li>æ‰“å¼€ç›®æ ‡ App å³WeChat, è¿™é‡Œç§°ä¹‹ä¸º TargetApp.</li><li>Home åˆ°æ‰‹æœºæ¡Œé¢.</li><li>æŸ¥çœ‹å½“å‰è¿è¡Œçš„æ‰€æœ‰è¿›ç¨‹, å‘½ä»¤å¦‚ä¸‹:</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -e</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°è¿™ä¸ªè´§:<br><img src="/upload/images/2018/06/07/3.jpg"></p><p>åœ¨å¦‚ä¸‹ç›®å½•:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/var/containers/Bundle/Application/2837EC87-7C28-45C5-9309-24FACD3A97C9/WeChat.app/WeChat</span><br></pre></td></tr></table></figure><p><code>WeChat.app</code> å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ TargetApp.</p><p>è¿æ¥ SSH æˆåŠŸå, åœ¨ MacOS ç»ˆç«¯ <code>ls</code> ä¸€ä¸‹è¯¥ç›®å½•, å¯ä»¥å‘ç° <code>WeChat.app</code> èººåœ¨é‚£é‡Œ.<br><img src="/upload/images/2018/06/07/4.jpg"></p><h2 id="ç ¸å£³"><a href="#ç ¸å£³" class="headerlink" title="ç ¸å£³"></a>ç ¸å£³</h2><p><strong>1. æŸ¥æ‰¾ Documents ç›®å½•</strong></p><p><code>WeChat</code> ä¸ºå½“å‰çš„è¿›ç¨‹ç›®æ ‡æ‰§è¡Œæ–‡ä»¶åç§°, ä»ä¸Šé¢çš„å›¾å¯ä»¥çœ‹å‡º, å…¶å¯¹åº”çš„è¿›ç¨‹ id æ˜¯ <code>18983</code>.</p><p>åœ¨å‘½ä»¤è¡Œä¸­é€šè¿‡ cycript æ‰§è¡Œå¦‚ä¸‹æ“ä½œ:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cycript -p 18983</span><br></pre></td></tr></table></figure><p>å†æ‰§è¡Œ OC çš„æ–¹æ³•, å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="built_in">NSFileManager</span> defaultManager] URLsForDirectory:<span class="built_in">NSDocumentDirectory</span> inDomains:<span class="built_in">NSUserDomainMask</span>][<span class="number">0</span>]</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å¯¹åº”çš„è¾“å‡º, å¦‚ä¸‹å›¾æ‰€ç¤º, è¿™å°±æ˜¯å¯¹åº”çš„ Documents ç›®å½•.<br><img src="/upload/images/2018/06/07/5.jpg"></p><blockquote><p>æ³¨æ„: æ‰§è¡Œè¿‡ç¨‹ä¸­, åœ¨ iPhone ä¸Šé¢æ‰“å¼€è¿è¡Œä¸€ä¸‹ App, ä¸ç„¶ä¸Šé¢çš„æ‰§è¡Œä¸€ç›´å¡åœ¨é‚£é‡Œä¸åŠ¨.</p></blockquote><p>æ‰¾åˆ°ç›®å½•å¦‚ä¸‹:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/var/mobile/Containers/Data/Application/2EFA08B6-DD7B-41A6-92C9-C6115CA6DDA1/Documents/</span><br></pre></td></tr></table></figure><p>åŒç†, ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ iFunBox æŸ¥çœ‹è¯¥ç›®å½•.</p><p><strong>2. æ‹·è´ dumpdecrypted.dylib</strong>.</p><p>æ‹·è´ <code>dumpdecrypted.dylib</code> è¿™ä¸ªä¹‹å‰ç¼–è¯‘ç­¾åå¥½çš„æ–‡ä»¶åˆ°iPhone ä¸Šé¢è¯¥ APP çš„ Documents ç›®å½•æœ‰ä¸¤ç§æ–¹æ³•.</p><p>ç¬¬ä¸€ç§æ–¹æ³•, ç›´æ¥åœ¨ mac ä¸Šé¢æ‹–æ‹½ <code>dumpdecrypted.dylib</code> åˆ° iFunBox æ˜¾ç¤ºçš„è¿™ä¸ªç›®å½•ä¸­, è¿™ç§æ–¹æ³•æ¯”è¾ƒç®€å•ä¸”å¿«.</p><p>ç¬¬äºŒç§æ–¹æ³•, ä½¿ç”¨ <code>scp</code> å‘½ä»¤è¿›è¡Œæ“ä½œ.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp ~/dumpdecrypted.dylib root@192.168.99.231:/var/mobile/Containers/Data/Application/2EFA08B6-DD7B-41A6-92C9-C6115CA6DDA1/Documents/</span><br></pre></td></tr></table></figure><p><code>192.168.99.231</code> æ˜¯ iPhone è®¾å¤‡çš„ ip åœ°å€.</p><p><strong>3. é€€å‡º cycript, å›åˆ°å‘½ä»¤è¡Œæ¨¡å¼</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctrl + d</span><br></pre></td></tr></table></figure><p><strong>4. cd åˆ° Documents ç›®å½•</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /var/mobile/Containers/Data/Application/2EFA08B6-DD7B-41A6-92C9-C6115CA6DDA1/Documents/</span><br></pre></td></tr></table></figure><p><strong>5. ç ¸å£³</strong></p><p>ç»ˆç«¯åœ¨ Documents ç›®å½•ä¸‹é¢, æ‰§è¡Œä¸‹é¢å‘½ä»¤å³å¯:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DYLD_INSERT_LIBRARIES=dumpdecrypted.dylib /var/containers/Bundle/Application/2837EC87-7C28-45C5-9309-24FACD3A97C9/WeChat.app/WeChat</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œè¿‡ç¨‹æ˜¾ç¤ºå¦‚ä¸‹:<br><img src="/upload/images/2018/06/07/6.jpg"></p><p>æœ€åç”Ÿæˆäº† <code>WeChat.decrypted</code> æ–‡ä»¶, å¦‚ä¸‹:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">-rw-r--r--  1 root   mobile 74513728 Jun  7 15:20 WeChat.decrypted</span><br><span class="line">drwxr-xr-x 14 mobile mobile      448 Jun  7 15:20 .</span><br><span class="line">-rw-r--r--  1 root   mobile   207760 Jun  7 15:15 dumpdecrypted.dylib</span><br><span class="line">-rw-r--r--  1 mobile mobile        8 Jun  7 13:22 db.globalconfig</span><br><span class="line">-rw-r--r--  1 mobile mobile       15 Jun  7 11:35 SafeMode.dat</span><br><span class="line">drwxr-xr-x 26 mobile mobile      832 Jun  7 11:35 MMappedKV</span><br><span class="line">drwxr-xr-x  3 mobile mobile       96 Jun  7 11:35 CrashReport</span><br><span class="line">-rw-r--r--  1 mobile mobile     1011 Jun  7 11:35 LocalInfo.lst</span><br><span class="line">drwxr-xr-x  5 mobile mobile      160 Jun  7 11:35 MemoryStat</span><br><span class="line">drwxr-xr-x  6 mobile mobile      192 Jun  7 11:35 00000000000000000000000000000000</span><br><span class="line">drwxr-xr-x 15 mobile mobile      480 Jun  5 13:43 MMResourceMgr</span><br><span class="line">-rw-r--r--  1 mobile mobile      592 Jun  5 13:43 heavy_user_id_mapping.dat</span><br><span class="line">drwxr-xr-x  2 mobile mobile       64 Jun  5 10:07 OpenImResource</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>iFunBox</code> æˆ–è€… <code>scp</code> å‘½ä»¤å°† <code>WeChat.decrypted</code> æ–‡ä»¶å¯¼å‡ºåˆ° mac çš„ä»»æ„ç›®å½•å³å¯.</p><p>åç»­ä¼šè·Ÿå¤§å®¶åˆ†äº«å¦‚ä½•ä½¿ç”¨ç ¸å£³åçš„æ–‡ä»¶, æ•¬è¯·æœŸå¾….</p><h2 id="è¶Šç‹±ç³»åˆ—æ–‡ç« "><a href="#è¶Šç‹±ç³»åˆ—æ–‡ç« " class="headerlink" title="è¶Šç‹±ç³»åˆ—æ–‡ç« "></a>è¶Šç‹±ç³»åˆ—æ–‡ç« </h2><blockquote><p>åŸºäº iOS10.3.1 è¿›è¡Œçš„å®è·µã€‚</p></blockquote><ul><li><p><a href="http://www.veryitman.com/2018/06/07/iOS-%E9%80%86%E5%90%91-dumpdecrypted-%E7%A0%B8%E5%A3%B3%E8%AE%B0/">iOS é€†å‘: dumpdecrypted ç ¸å£³è®°</a></p></li><li><p><a href="http://www.veryitman.com/2018/05/13/iOS-%E9%80%86%E5%90%91-%E7%A0%B8%E5%A3%B3/">iOS é€†å‘: ç ¸å£³</a></p></li><li><p><a href="http://www.veryitman.com/2018/05/13/iOS-%E9%80%86%E5%90%91-%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E5%92%8C%E7%BB%93%E6%9E%84/">iOS é€†å‘: æŸ¥çœ‹ç³»ç»Ÿæ–‡ä»¶ç›®å½•å’Œç»“æ„</a></p></li><li><p><a href="http://www.veryitman.com/2018/05/12/iOS-%E9%80%86%E5%90%91-%E8%B6%8A%E7%8B%B1%E4%BD%BF%E7%94%A8-SSH/">iOS é€†å‘: è¶Šç‹±ä½¿ç”¨ SSH</a></p></li><li><p><a href="http://www.veryitman.com/2019/04/07/dumpdecrypted-%E7%A0%B8%E5%A3%B3%EF%BC%9A%E5%AF%BC%E5%87%BA%E5%A4%B4%E6%96%87%E4%BB%B6/">dumpdecrypted ç ¸å£³ï¼šå¯¼å‡ºå¤´æ–‡ä»¶</a></p></li></ul><hr><p><strong>æ€»æœ‰ä¸€å¤©ï¼Œä½ ä¸€å®šä¼šæ„Ÿæ¿€æ­£åœ¨åŠªåŠ›çš„è‡ªå·±~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOSå®‰å…¨ è¶Šç‹± jailbreak </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS é€†å‘: ç ¸å£³</title>
      <link href="/2018/05/13/iOS-%E9%80%86%E5%90%91-%E7%A0%B8%E5%A3%B3/"/>
      <url>/2018/05/13/iOS-%E9%80%86%E5%90%91-%E7%A0%B8%E5%A3%B3/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æ‰€è°“çš„ç ¸å£³, æŒ‡çš„æ˜¯å°†ä» App Store ä¸Šé¢ä¸‹è½½çš„ App è¿›è¡Œç ´è§£çš„è¿‡ç¨‹. ä» App Store ä¸Šä¸‹è½½çš„ ipa ä¸­çš„äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯ç»è¿‡åŠ å¯†(åŠ å£³)çš„ï¼Œéœ€è¦é€šè¿‡ç ´è§£æ‰èƒ½è®©æˆ‘ä»¬å¯¹å…¶ <code>ä¸ºæ‰€æ¬²ä¸º</code>, è¿™é‡Œçš„ç ´è§£å°±æ˜¯é€šå¸¸æ‰€è¯´çš„ç ¸å£³.</p><p>ç±»ä¼¼çš„, Android åº”ç”¨(apk æ–‡ä»¶)ä¹Ÿæœ‰åŠ å£³æ“ä½œ, å¦‚æœæƒ³ç ´è§£åˆ«äººçš„ apk, é¦–å…ˆè¦è¿›è¡Œç ¸å£³æ“ä½œ.</p><h2 id="å‡†å¤‡å·¥å…·"><a href="#å‡†å¤‡å·¥å…·" class="headerlink" title="å‡†å¤‡å·¥å…·"></a>å‡†å¤‡å·¥å…·</h2><p>[1]. Clutch<br>[2]. iFunBox æˆ–è€… <code>pp åŠ©æ‰‹</code><br>[3]. è¶Šç‹±æ‰‹æœºä¸€å°(æœ¬äººiPhone6sPlus iOS10.3.x ç³»ç»Ÿ).<br>[4]. å¯ä»¥æ­£å¸¸ä½¿ç”¨ SSH åŠŸèƒ½.</p><p>å¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£…ä¸Šé¢æåˆ°çš„é™¤ <code>Clutch</code> ä¹‹å¤–çš„å·¥å…·, è¯·å…ˆé˜…è¯» <a href="http://www.veryitman.com/2018/05/13/iOS-%E9%80%86%E5%90%91-%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E5%92%8C%E7%BB%93%E6%9E%84/">iOS é€†å‘: æŸ¥çœ‹ç³»ç»Ÿæ–‡ä»¶ç›®å½•å’Œç»“æ„</a> è¿™ç¯‡æ–‡ç« , å¹¶å®‰è£…å¯¹åº”çš„å·¥å…·.</p><h2 id="å®‰è£…-Clutch"><a href="#å®‰è£…-Clutch" class="headerlink" title="å®‰è£… Clutch"></a>å®‰è£… Clutch</h2><p>å¯ä»¥åœ¨ Github è·å– <a href="https://github.com/KJCracks/Clutch">Clutch æºç </a>, ç„¶åè‡ªå·±åœ¨ MacOS ä¸Šé¢ç¼–è¯‘å¾—åˆ°äºŒè¿›åˆ¶æ–‡ä»¶.</p><p>ä¹Ÿå¯ä»¥å»ç›´æ¥ä¸‹è½½å·²ç»ç¼–è¯‘å¥½çš„ <a href="https://github.com/KJCracks/Clutch/releases">äºŒè¿›åˆ¶åŒ…</a>, ç›´æ¥ä½¿ç”¨, æˆ‘æ˜¯ç›´æ¥ä¸‹è½½äº†å·²ç»ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶åŒ…çš„, æˆªæ­¢åˆ°å†™è¿™ç¯‡æ–‡ç« ä¸ºæ­¢, <code>Clutch</code> ç‰ˆæœ¬ä¸º <code>2.0.4</code>.</p><p>ä¸‹è½½å®Œæˆå, æˆ‘å°†å…¶æ”¾åˆ° <code>~/Downloads</code> ç›®å½•ä¸‹é¢äº†.</p><p>å‡†å¤‡å¥½è¶Šç‹±è®¾å¤‡, ä¿è¯å¯ä»¥æ­£å¸¸è¿æ¥ wifi, ä½¿ç”¨ scp å‘½ä»¤å°† <code>Clutch</code> äºŒè¿›åˆ¶æ–‡ä»¶å¤åˆ¶åˆ°è®¾å¤‡çš„ç³»ç»Ÿç›®å½•ä¸­, å‘½ä»¤å¦‚ä¸‹:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp ~/Downloads/Clutch root@192.168.91.126:/usr/bin</span><br></pre></td></tr></table></figure><p>å…¶ä¸­, <code>192.168.91.126</code> æ˜¯æˆ‘è®¾å¤‡è¿æ¥ wifi åçš„ IP åœ°å€.</p><p>å¤åˆ¶æˆåŠŸå, ä½¿ç”¨ iFunBox å¯ä»¥çœ‹åˆ° <code>Clutch</code> é™é™åœ°èººåœ¨é‚£é‡Œ.</p><p><img src="/upload/images/2018/05/13/6.jpg"></p><p>ä½ å¯ä»¥ä½¿ç”¨ iFunBox æˆ–è€… <code>pp åŠ©æ‰‹</code>, ç›´æ¥å°† <code>~/Downloads/Clutch</code> æ‹–æ‹½åˆ° <code>/usr/bin</code> ç›®å½•.</p><h2 id="Clutch-çš„åŸºæœ¬ä½¿ç”¨"><a href="#Clutch-çš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="Clutch çš„åŸºæœ¬ä½¿ç”¨"></a>Clutch çš„åŸºæœ¬ä½¿ç”¨</h2><p>SSH è¿æ¥è¶Šç‹±è®¾å¤‡, å¼€å§‹ä½¿ç”¨ <code>Clutch</code>. å…³äºä½¿ç”¨ SSH, å¯ä»¥é˜…è¯»ä¸€ä¸‹ <a href="http://www.veryitman.com/2018/05/12/iOS-%E9%80%86%E5%90%91-%E8%B6%8A%E7%8B%B1%E4%BD%BF%E7%94%A8-SSH/">iOS é€†å‘: è¶Šç‹±ä½¿ç”¨ SSH</a> è¿™ç¯‡æ–‡ç« .</p><p>å¦‚æœä½ å‘ç°ç›´æ¥æ‰§è¡Œ <code>Clutch</code> è¯´æ²¡æœ‰æƒé™ä¹‹ç±»çš„æç¤º, å¯ä»¥å…ˆå°†å…¶æˆäºˆå¯æ‰§è¡Œçš„æƒé™.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x /usr/bin/Clutch</span><br></pre></td></tr></table></figure><p>Clutch å‘½ä»¤é€‰é¡¹å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-b --binary-dump     Only dump binary files from specified bundleID</span><br><span class="line">-d --dump            Dump specified bundleID into .ipa file</span><br><span class="line">-i --print-installed Print installed application</span><br><span class="line">--clean              Clean /var/tmp/clutch directory</span><br><span class="line">--version            Display version and exit</span><br><span class="line">-? --help            Display this help and exit</span><br></pre></td></tr></table></figure><p><code>-b</code> é€‰é¡¹è¡¨ç¤ºäº§å‡ºä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶, <code>-d</code> é€‰é¡¹è¡¨ç¤ºäº§å‡ºä¸€ä¸ª ipa æ–‡ä»¶, <code>-i</code> è¡¨ç¤ºåˆ—å‡ºæ‰‹æœºä¸Šé¢å·²ç»å®‰è£…çš„ APP.</p><p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹æ‰‹æœºä¸Šå·²ç»å®‰è£…çš„ App, å‘½ä»¤å¦‚ä¸‹:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Clutch -i</span><br></pre></td></tr></table></figure><p><img src="/upload/images/2018/05/13/7.jpg"></p><p>è¿™äº› APP å‰é¢çš„æ•°å­—è¡¨ç¤ºæŒ‡å®šçš„ id. <code>-d</code> å’Œ <code>-b</code> é€‰é¡¹éƒ½éœ€è¦æŒ‡å®šè¿™äº› id.</p><h2 id="ç ¸å§-éªšå¹´"><a href="#ç ¸å§-éªšå¹´" class="headerlink" title="ç ¸å§, éªšå¹´"></a>ç ¸å§, éªšå¹´</h2><p>æˆ‘ä»¬ç°åœ¨å¼€å§‹ä½¿ç”¨ <code>Clutch</code> æ¥å¯¹ APP è¿›è¡Œç ¸å£³æ“ä½œ, è¿™é‡Œä»¥å·²ç»å®‰è£…çš„ App åºå·ä¸º 8 çš„ä¸ºä¾‹å­.</p><p>ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å¼€å§‹ç ¸å£³:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Clutch -d 8</span><br></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤º:</p><p><img src="/upload/images/2018/05/13/8.jpg"></p><p>ç ¸å£³æˆåŠŸåä¼šåœ¨ <code>/private/var/mobile/Documents/Dumped</code>  è¿™ä¸ªç›®å½•ç”Ÿæˆå¯¹åº”çš„ <code>*.ipa</code> æ–‡ä»¶.</p><p>ç ¸å£³åçš„ ipa æ–‡ä»¶, å¯ä»¥ä» iFunBox ä¸­å¤åˆ¶åˆ° MacOS çš„ç›®å½•ä¸­, ç„¶åä½ å°±å¯ä»¥å¯¹è¯¥ ipa è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œäº†, æ¯”å¦‚è·å–å›¾ç‰‡&#x2F;éŸ³é¢‘&#x2F;è§†é¢‘ç­‰èµ„æºå’Œå¯¹åº”çš„å¤´æ–‡ä»¶. å…³äºè¿™äº›åç»­çš„è¶Šç‹±å·¥ä½œ, æˆ‘ä¼šåœ¨ä¸‹å‡ ç¯‡åšå®¢ä¸­åˆ†äº«ç»™å¤§å®¶.</p><p>ä¹Ÿè®¸æœ‰äººä¼šè¯´äº†, æˆ‘è‡ªå·±ä» <code>pp åŠ©æ‰‹</code> ä¸­å¤‡ä»½æŒ‡å®šçš„ App å°±å¯ä»¥è·å–èµ„æºäº†, ä¸éœ€è¦ä½¿ç”¨ <code>Clutch</code> è¿™ä¹ˆéº»çƒ¦äº†. é«˜ç³»ç»Ÿç‰ˆæœ¬, <code>pp åŠ©æ‰‹</code> æ˜¯æ— æ³•ç›´æ¥è·å– ipa æ–‡ä»¶çš„, å†µä¸”æˆ‘ä»¬ä¹Ÿä¸ä»…ä»…æ˜¯æƒ³è·å–åˆ«äºº APP çš„èµ„æºæ–‡ä»¶.</p><p>å½“ç„¶äº†, ä½ å¯ä»¥ä»è¶Šç‹± APP å¸‚åœºç›´æ¥ä¸‹è½½å·²ç»è¢«ç ¸å£³çš„ App è¿›è¡Œç©è€, ä¸éœ€è¦è‡ªå·±åƒè¾›ä¸‡è‹¦çš„å»ç ¸å£³äº†.</p><h2 id="Clutch-å¹¶ä¸æ˜¯ä¸‡èƒ½çš„"><a href="#Clutch-å¹¶ä¸æ˜¯ä¸‡èƒ½çš„" class="headerlink" title="Clutch å¹¶ä¸æ˜¯ä¸‡èƒ½çš„"></a>Clutch å¹¶ä¸æ˜¯ä¸‡èƒ½çš„</h2><p>ä¸Šé¢å¤§å®¶å¯ä»¥çœ‹å‡º, <code>Clutch</code> æ˜¯å¯ä»¥è¿›è¡Œç ¸å£³çš„å¹¶ä¸”ä¹ŸæŒºæ–¹ä¾¿, ä½† <code>Clutch</code> å¹¶ä¸æ˜¯ä¸‡èƒ½çš„, ä¹Ÿå°±æ˜¯è¯´, <code>Clutch</code> ä¸èƒ½å°†ä»»æ„ä¸€ä¸ª App Store ä¸‹è½½ APP è¿›è¡Œç ¸å£³.</p><p>æ‹¿ä¸Šé¢åºå·ä¸º4 çš„å¾®ä¿¡æ¥è¯´, æ‰§è¡Œä¸‹é¢å‘½ä»¤æŠ¥é”™:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Clutch -d 4</span><br></pre></td></tr></table></figure><p>ç ¸å£³æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Writing new checksum</span><br><span class="line">...</span><br><span class="line">FAILED: &lt;WeChat bundleID: com.tencent.xin&gt;</span><br><span class="line">Finished dumping com.tencent.xin <span class="keyword">in</span> 28.7 seconds</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€äº› APP, å†è¢«ç ¸å£³çš„æ—¶å€™ä¼šæŠ¥å¦‚ä¸‹çš„é”™è¯¯:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">could not obtain mach port either the process is dead</span><br></pre></td></tr></table></figure><p>è™½ç„¶æœ€æ–°ç‰ˆæœ¬(2.0.4)è¯´è§£å†³äº†è¯¥é—®é¢˜, ä½†æ˜¯å®é™…æ“ä½œè¿‡ç¨‹ä¸­, è¿˜æ˜¯ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜, æ— æ³•è¿›è¡Œç ¸å£³.</p><h2 id="è¶Šç‹±ç³»åˆ—æ–‡ç« "><a href="#è¶Šç‹±ç³»åˆ—æ–‡ç« " class="headerlink" title="è¶Šç‹±ç³»åˆ—æ–‡ç« "></a>è¶Šç‹±ç³»åˆ—æ–‡ç« </h2><blockquote><p>åŸºäº iOS10.3.1 è¿›è¡Œçš„å®è·µã€‚</p></blockquote><ul><li><p><a href="http://www.veryitman.com/2018/06/07/iOS-%E9%80%86%E5%90%91-dumpdecrypted-%E7%A0%B8%E5%A3%B3%E8%AE%B0/">iOS é€†å‘: dumpdecrypted ç ¸å£³è®°</a></p></li><li><p><a href="http://www.veryitman.com/2018/05/13/iOS-%E9%80%86%E5%90%91-%E7%A0%B8%E5%A3%B3/">iOS é€†å‘: ç ¸å£³</a></p></li><li><p><a href="http://www.veryitman.com/2018/05/13/iOS-%E9%80%86%E5%90%91-%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E5%92%8C%E7%BB%93%E6%9E%84/">iOS é€†å‘: æŸ¥çœ‹ç³»ç»Ÿæ–‡ä»¶ç›®å½•å’Œç»“æ„</a></p></li><li><p><a href="http://www.veryitman.com/2018/05/12/iOS-%E9%80%86%E5%90%91-%E8%B6%8A%E7%8B%B1%E4%BD%BF%E7%94%A8-SSH/">iOS é€†å‘: è¶Šç‹±ä½¿ç”¨ SSH</a></p></li><li><p><a href="http://www.veryitman.com/2019/04/07/dumpdecrypted-%E7%A0%B8%E5%A3%B3%EF%BC%9A%E5%AF%BC%E5%87%BA%E5%A4%B4%E6%96%87%E4%BB%B6/">dumpdecrypted ç ¸å£³ï¼šå¯¼å‡ºå¤´æ–‡ä»¶</a></p></li></ul><hr><p><strong>ç‰¹åˆ«å–œæ¬¢ä¸Šå–„å¦‚æ°´è¿™å¥è¯ï¼Œä½ å‘¢ï¼Ÿ</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOSå®‰å…¨ è¶Šç‹± jailbreak </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS é€†å‘: æŸ¥çœ‹ç³»ç»Ÿæ–‡ä»¶ç›®å½•å’Œç»“æ„</title>
      <link href="/2018/05/13/iOS-%E9%80%86%E5%90%91-%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E5%92%8C%E7%BB%93%E6%9E%84/"/>
      <url>/2018/05/13/iOS-%E9%80%86%E5%90%91-%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E5%92%8C%E7%BB%93%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åœ¨ <a href="http://www.veryitman.com/2018/05/12/iOS-%E9%80%86%E5%90%91-%E8%B6%8A%E7%8B%B1%E4%BD%BF%E7%94%A8-SSH/">iOS é€†å‘: è¶Šç‹±ä½¿ç”¨ SSH</a> ä¸­ç»™å¤§å®¶åˆ†äº«äº†å¦‚ä½•ä½¿ç”¨å·¥å…·å¯¹ iOS10.3 çš„ç³»ç»Ÿè¿›è¡Œè¶Šç‹±å’Œé…ç½®ä½¿ç”¨ SSH çš„å†…å®¹, ä»Šå¤©ç»§ç»­æ¢é€†å‘çš„çŸ¥è¯†.</p><p>æ‰‹æœºè¢«è¶Šç‹±ä¹‹å, æˆ‘ä»¬é¦–å…ˆè¦ææ¸…æ¥šæ˜¯å¦èƒ½å¤Ÿæ­£å¸¸çš„è®¿é—®æ‰‹æœºé‡Œé¢çš„æ–‡ä»¶å’Œç›®å½•ç»“æ„, è¿™äº›æ–‡ä»¶å’Œç›®å½•ç»“æ„ç©¶ç«Ÿæ˜¯ä»€ä¹ˆæ ·çš„, è™½ç„¶è¿™äº›çŸ¥è¯†å¾ˆåŸºç¡€, ä½†æ˜¯è¿˜æ˜¯å¾ˆæœ‰å¿…è¦å»äº†è§£å’Œå­¦ä¹ çš„, å°±ç®—æ˜¯ä¸ºåæœŸé€†å‘ APP åšç‚¹å‡†å¤‡å§. </p><h2 id="å®‰è£…-iFunBox"><a href="#å®‰è£…-iFunBox" class="headerlink" title="å®‰è£… iFunBox"></a>å®‰è£… iFunBox</h2><p><code>iFunBox</code> æ˜¯ä¸€ä¸ªå¯ä»¥æµè§ˆ iPhone æ–‡ä»¶ç›®å½•çš„æ–‡ä»¶ç®¡ç†å·¥å…·, æ”¯æŒ MacOS å’Œ Windows ä¸¤ä¸ªå¹³å°.</p><p>ç‚¹å‡» <a href="http://www.i-funbox.com/">ä¸‹è½½åœ°å€</a> å¯ä»¥å»ä¸‹è½½ MacOS ç‰ˆæœ¬çš„ iFunBox. å…³äº <code>iFunBox</code> çš„ä»‹ç»å’Œç‰¹æ€§å¯ä»¥å» <a href="http://www.i-funbox.com/en_about.html">è¿™é‡Œ</a> æŸ¥é˜….</p><p>æœ€æ–°ç‰ˆæœ¬æ˜¯ <code>1.8</code>, å¦‚å›¾:</p><p><img src="/upload/images/2018/05/13/1.jpg"></p><p>æ‰‹æœºæ’ä¸Š USB è¿æ¥ä¸Š Mac ç”µè„‘, iFunBox å°±å¯ä»¥è¯†åˆ«ä½ çš„æ‰‹æœºäº†, å¦‚å›¾æ‰€ç¤º:</p><p><img src="/upload/images/2018/05/13/2.jpg"></p><p>è¿™ä¸ªæ—¶å€™, ä½ ç‚¹å‡» <code>Raw File System</code> å…¶å®æ˜¯çœ‹ä¸åˆ° iPhone çš„ç³»ç»Ÿç›®å½•çš„, æ¥ä¸‹æ¥åœ¨ iPhone ä¸­å®‰è£…å¦å¤–ä¸€ä¸ªè½¯ä»¶å°±å¯ä»¥äº†.</p><h2 id="å®‰è£…-Apple-File-Conduit-2"><a href="#å®‰è£…-Apple-File-Conduit-2" class="headerlink" title="å®‰è£… Apple File Conduit 2"></a>å®‰è£… Apple File Conduit 2</h2><p>åœ¨ Cydia ä¸­æœç´¢ Apple File Conduit, å¦‚ä¸‹å›¾æ‰€ç¤º.</p><p><img src="/upload/images/2018/05/13/3.jpg"></p><p>ç‚¹å‡»æ›´æ”¹&#x2F;å®‰è£…å³å¯.</p><p>å¦‚æœä½ æ²¡æœ‰æœç´¢åˆ°, é‚£ä¹ˆå°±éœ€è¦è‡ªå·±æ·»åŠ å¯¹åº”çš„è½¯ä»¶æºåœ°å€.</p><p>ç‚¹å‡»ã€è½¯ä»¶æºã€‘â€“ç¼–è¾‘&#x2F;æ·»åŠ  â€“è¾“å…¥æºåœ°å€ <code>apt.25pp.com</code> â€“ æ·»åŠ æº, ç„¶åå†å»æœç´¢ <code>Apple File Conduit</code> å®‰è£….</p><p>å®‰è£…å¥½ä¹‹å, å†ç”¨ <code>iFunBox</code>, å°±å¯ä»¥æ­£å¸¸æŸ¥çœ‹ iPhone çš„ç³»ç»Ÿç›®å½•äº†, å¦‚ä¸‹å›¾æ‰€ç¤º:</p><p><img src="/upload/images/2018/05/13/4.jpg"></p><p>çœ‹åˆ°è¿™äº›ç›®å½•, æ˜¯ä¸æ˜¯è·Ÿ linux æˆ–è€… MacOS çš„ç›®å½•æœ‰å¾ˆå¤šç›¸ä¼¼çš„åœ°æ–¹, å“ˆå“ˆ.</p><h2 id="å®‰è£…-pp-åŠ©æ‰‹"><a href="#å®‰è£…-pp-åŠ©æ‰‹" class="headerlink" title="å®‰è£… pp åŠ©æ‰‹"></a>å®‰è£… pp åŠ©æ‰‹</h2><p>æ—¢ç„¶å·²ç»å®‰è£…äº† <code>iFunBox</code> å·¥å…·, é‚£ä¸ºä»€ä¹ˆè¿˜éœ€è¦å®‰è£… <code>pp åŠ©æ‰‹</code> ä¹‹ç±»çš„å·¥å…·å‘¢? å…¶å®, è¿™ä¸ªçœ‹ä¸ªäººçš„éœ€è¦å§, åœ¨æŸç§ç¨‹åº¦ä¸Š, <code>pp åŠ©æ‰‹</code> çš„ç•Œé¢å’Œä¾¿æ·æ€§è¦æ¯” <code>iFunBox</code> å¥½ä¸€ç‚¹.</p><p>å®‰è£…å¥½ <code>pp åŠ©æ‰‹</code> å, ç‚¹å‡» Tools&#x2F;File Manager æ˜¾ç¤ºçš„ç›®å½•å¯¼èˆª, å¦‚å›¾:</p><p><img src="/upload/images/2018/05/13/5.jpg"></p><p>å¯ä»¥çœ‹å‡º, ç›¸æ¯” <code>iFunBox</code> çš„ç•Œé¢æ˜¾ç¤º, <code>pp åŠ©æ‰‹</code> å·¥å…·æ˜¾å¾—æ›´åŠ å‹å¥½ä¸€äº›. </p><p>è‡³äºä½¿ç”¨å“ªä¸ªå·¥å…·, è¦çœ‹ä¸ªäººçˆ±å¥½å’Œè‡ªå·±çš„å·¥ä½œéœ€è¦, æ¯•ç«Ÿå·¥å…·éƒ½æ˜¯ä¸ºäº†æé«˜æˆ‘ä»¬å­¦ä¹ å’Œå·¥ä½œæ•ˆç‡çš„, æ²¡æœ‰ä»€ä¹ˆç»å¯¹çš„å¥½ä¸å, è‡ªå·±è§‰å¾—åˆé€‚é¡ºæ‰‹å°±å¥½äº†, æœ€ä¸»è¦çš„æ˜¯èƒ½å¤Ÿå¸®åˆ°è‡ªå·±. æˆ‘ä¸€èˆ¬æ˜¯å°†ä¸¤è€…ç»“åˆä½¿ç”¨çš„, å½“ç„¶ä½ å¦‚æœä½ æœ‰æ›´å¥½çš„å·¥å…·ä¹Ÿå¯ä»¥æ¨èç»™æˆ‘.</p><h2 id="è¶Šç‹±ç³»åˆ—æ–‡ç« "><a href="#è¶Šç‹±ç³»åˆ—æ–‡ç« " class="headerlink" title="è¶Šç‹±ç³»åˆ—æ–‡ç« "></a>è¶Šç‹±ç³»åˆ—æ–‡ç« </h2><blockquote><p>åŸºäº iOS10.3.1 è¿›è¡Œçš„å®è·µã€‚</p></blockquote><ul><li><p><a href="http://www.veryitman.com/2018/06/07/iOS-%E9%80%86%E5%90%91-dumpdecrypted-%E7%A0%B8%E5%A3%B3%E8%AE%B0/">iOS é€†å‘: dumpdecrypted ç ¸å£³è®°</a></p></li><li><p><a href="http://www.veryitman.com/2018/05/13/iOS-%E9%80%86%E5%90%91-%E7%A0%B8%E5%A3%B3/">iOS é€†å‘: ç ¸å£³</a></p></li><li><p><a href="http://www.veryitman.com/2018/05/13/iOS-%E9%80%86%E5%90%91-%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E5%92%8C%E7%BB%93%E6%9E%84/">iOS é€†å‘: æŸ¥çœ‹ç³»ç»Ÿæ–‡ä»¶ç›®å½•å’Œç»“æ„</a></p></li><li><p><a href="http://www.veryitman.com/2018/05/12/iOS-%E9%80%86%E5%90%91-%E8%B6%8A%E7%8B%B1%E4%BD%BF%E7%94%A8-SSH/">iOS é€†å‘: è¶Šç‹±ä½¿ç”¨ SSH</a></p></li><li><p><a href="http://www.veryitman.com/2019/04/07/dumpdecrypted-%E7%A0%B8%E5%A3%B3%EF%BC%9A%E5%AF%BC%E5%87%BA%E5%A4%B4%E6%96%87%E4%BB%B6/">dumpdecrypted ç ¸å£³ï¼šå¯¼å‡ºå¤´æ–‡ä»¶</a></p></li></ul><hr><p><strong>æ¯ä¸€ä¸ªå…³æ³¨ï¼Œéƒ½ä¼šæ¿€åŠ±æˆ‘ç»§ç»­å‰è¡Œ</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOSå®‰å…¨ è¶Šç‹± jailbreak </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS é€†å‘: è¶Šç‹±ä½¿ç”¨ SSH</title>
      <link href="/2018/05/12/iOS-%E9%80%86%E5%90%91-%E8%B6%8A%E7%8B%B1%E4%BD%BF%E7%94%A8-SSH/"/>
      <url>/2018/05/12/iOS-%E9%80%86%E5%90%91-%E8%B6%8A%E7%8B%B1%E4%BD%BF%E7%94%A8-SSH/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><h2 id="è¶Šç‹±"><a href="#è¶Šç‹±" class="headerlink" title="è¶Šç‹±"></a>è¶Šç‹±</h2><p>ä½¿ç”¨è‹¹æœè®¾å¤‡æˆ–è€…åš iOS å¼€å‘çš„æœ‹å‹ä»¬ï¼Œå‡ ä¹éƒ½åº”è¯¥å¬è¯´è¿‡è¶Šç‹±è¿™ä¸ªè¯. é‚£ä¹ˆç©¶ç«Ÿä»€ä¹ˆæ˜¯è¶Šç‹±å‘¢?</p><blockquote><p>iOSè¶Šç‹±ï¼ˆè‹±è¯­ï¼šiOS Jailbreakingï¼‰æ˜¯è·å– iOS è®¾å¤‡çš„ Root æƒé™çš„æŠ€æœ¯æ‰‹æ®µã€‚iOS è®¾å¤‡çš„ Root æƒé™ä¸€èˆ¬æ˜¯ä¸å¼€æ”¾çš„ã€‚ç”±äºè·å¾—äº†Root æƒé™ï¼Œåœ¨è¶Šç‹±ä¹‹å‰æ— æ³•æŸ¥çœ‹çš„ iOS çš„æ–‡ä»¶ç³»ç»Ÿä¹Ÿå¯æŸ¥çœ‹.</p></blockquote><p>iOS çš„è¶Šç‹±å°±ç±»ä¼¼ Android è·å– root æƒé™ä¸€æ ·çš„é“ç†ï¼Œè¯´ç®€å•ç‚¹å°±æ˜¯è·å–ç³»ç»Ÿçš„ root æƒé™åšä¸€äº›æ›´é«˜çº§çš„äº‹æƒ…ã€‚</p><p>æ‰‹å¤´ä¸Šé¢ä¹‹å‰é—²ç½®äº†ä¸€å° iPhone4sï¼Œé—²æ¥æ— äº‹å°±æŠŠä»–è¶Šç‹±äº†ï¼Œåé¢ä¸çŸ¥é“æ€ä¹ˆæ“ä½œçš„ï¼Œæ‰‹æœºå˜æˆäº†ç™½è‹¹æœ(å¼€æœºå°±ç™½å±ï¼Œæ— æ³•è¿›å…¥ç³»ç»Ÿ)ï¼Œæœ€åæ²¡åŠæ³•ï¼Œåªèƒ½å‡çº§ç³»ç»Ÿï¼Œè¿™å°æ‰‹æœºä¹Ÿç®—æ˜¯åºŸäº†. </p><p>å½“æ—¶ä½¿ç”¨çš„å·¥å…·æ˜¯ <a href="http://www.pangu.io/">ç›˜å¤è¶Šç‹±</a>ï¼Œè¶Šç‹±çš„ iOS ç³»ç»Ÿæ˜¯ 7.x. ç°åœ¨ iOS å·²ç»å‡çº§åˆ° 11.x äº†ï¼Œå¾ˆå¤š APP å’Œæ¸¸æˆå·²ç»ä¸å†æ”¯æŒ iOS8 ä»¥ä¸‹çš„ç³»ç»Ÿäº†ï¼Œç³»ç»Ÿçš„å®‰å…¨æ€§ä¹Ÿè¶Šæ¥è¶Šå¥½äº†ï¼Œè¶Šç‹±ç ´è§£çš„éš¾åº¦ä¹Ÿéšä¹‹æé«˜äº†ï¼Œç›®å‰å¸‚é¢ä¸Šèƒ½è¶Šç‹±çš„æœ€é«˜ç‰ˆæœ¬åº”è¯¥æ˜¯ 10.3.x çš„ç³»ç»Ÿ(æˆªæ­¢åˆ°è¯¥ç¯‡æ–‡ç« å†™çš„æ—¶å€™). </p><p>ä¸ºäº†èƒ½å¤Ÿåˆ†æå’Œå­¦ä¹ ä¸€äº›ä¼˜ç§€ App çš„è®¾è®¡ï¼Œæˆ‘ç´¢æ€§ä¹°äº†å°iPhone6sPlus æ‹¿æ¥è¶Šç‹±ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥çš„åˆ†äº«éƒ½æ˜¯åŸºäºè¿™å°æ‰‹æœºçš„.</p><p><strong>è¶Šç‹±å·¥å…·å’Œè®¾å¤‡</strong></p><p>[1]. è®¾å¤‡ iPhone6s Plusï¼Œç³»ç»Ÿ iOS10.3.2<br>[2]. è¶Šç‹±å·¥å…·: çˆ±æ€åŠ©æ‰‹å’Œ doubleH3lix.ipa</p><p>å®‰è£…å¹¶æ‰“å¼€ pc ä¸Šé¢çš„ <code>çˆ±æ€åŠ©æ‰‹</code> ç›´æ¥å¼€å§‹è¶Šç‹±ï¼Œçˆ±æ€åŠ©æ‰‹ä¼šå¸®æ‚¨åœ¨è®¾å¤‡ä¸Šå®‰è£… <code>doubleH3lix</code>. è¿è¡Œ <code>doubleH3lix</code> åº”ç”¨ï¼Œç‚¹å‡» <code>jailbreak</code> æŒ‰é’®ï¼Œç­‰å¾…è®¾å¤‡è‡ªè¡Œé‡å¯.</p><p>æ‰‹æœºé‡å¯åï¼Œä½ ä¼šçœ‹åˆ° <code>Cydia</code> é™é™çš„å‘†åœ¨é‚£é‡Œäº†ï¼Œè¿™ç§æ–¹å¼çš„è¶Šç‹±å±äºéå®Œç¾è¶Šç‹±ï¼Œæ¢å¥è¯è¯´å°±æ˜¯æ²¡æœ‰çœŸæ­£çš„ç ´è§£ iOS ç³»ç»Ÿ.</p><p>å¦‚æœå‘ç°æ‰‹æœºæ–­ç”µå…³æœºæˆ–è€…é‡å¯å <code>Cydia</code> ä¸€æ‰“å¼€å°±é—ªé€€ï¼Œå°±ä½¿ç”¨ <code>doubleH3lix</code> é‡æ–°è¶Šç‹±å°±å¯ä»¥äº†ï¼Œå¦‚æœè¿˜æ˜¯ä¸è¡Œå°±éœ€è¦é‡æ–°ä½¿ç”¨ <code>çˆ±æ€åŠ©æ‰‹</code> äº†ã€‚</p><p>å‚è€ƒè¶Šç‹±æ•™ç¨‹ <a href="https://weibo.com/ttarticle/p/show?id=2309404217487167220184">64ä½è®¾å¤‡iOS 10-10.3.3çˆ±æ€åŠ©æ‰‹ä¸€é”®è¶Šç‹±æ•™ç¨‹</a>.</p><h2 id="å®‰è£…-iOS-ç»ˆç«¯"><a href="#å®‰è£…-iOS-ç»ˆç«¯" class="headerlink" title="å®‰è£… iOS ç»ˆç«¯"></a>å®‰è£… iOS ç»ˆç«¯</h2><p>å®‰è£…ç»ˆç«¯ï¼Œåœ¨ <code>Cydia</code> ä¸­æœç´¢ <code>MTerminal</code>ï¼Œå®‰è£…å³å¯.</p><p><img src="/upload/images/2018/05/12/1.jpg"></p><p>å®‰è£…å¥½ç»ˆç«¯å·¥å…·åï¼Œæ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su</span><br></pre></td></tr></table></figure><p>ç´§æ¥ç€è®©ä½ è¾“å…¥å¯†ç ï¼Œé»˜è®¤çš„ root ç”¨æˆ·å¯†ç æ˜¯ <code>alpine</code>. è¾“å…¥æ”¹å¯†ç å›è½¦å³å¯ã€‚</p><p>ä¸ºäº†å®‰å…¨èµ·è§ï¼Œä¿®æ”¹é»˜è®¤å¯†ç  <code>alpine</code>.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd</span><br></pre></td></tr></table></figure><p>è¿ç»­è¾“å…¥ç›¸åŒçš„å¯†ç å³ä¸ºå‘¢ä¿®æ”¹åçš„æ–°å¯†ç ã€‚</p><h2 id="é…ç½®-SSH"><a href="#é…ç½®-SSH" class="headerlink" title="é…ç½® SSH"></a>é…ç½® SSH</h2><p>é…ç½®å’Œä½¿ç”¨ SSH åŠŸèƒ½æ˜¯åç»­è¶Šç‹±å·¥ä½œçš„åŸºç¡€ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ MacOS çš„ç»ˆç«¯ä¸­è®¿é—® iOS ç³»ç»Ÿäº†ï¼Œå„ç§ shell å‘½ä»¤è®©ä½ å€æ„Ÿäº²åˆ‡ï¼Œæ‰€ä»¥å¤§å®¶å°½é‡è¦å®Œæˆè¯¥æ­¥éª¤. è¯•æƒ³ä¸€ä¸‹ï¼Œæœ¬æ¥æ‰‹æœºä¸Šé¢æ–‡å­—è¾“å…¥çš„ä½“éªŒå°±ä¸å¥½ï¼Œè¿˜éœ€è¦åœ¨ iPhone è®¾å¤‡ä¸Šé¢çš„ç»ˆç«¯ä¸­æ•²ç€å‘½ä»¤â€¦æ²¡æ³•å¿!</p><p>iOS 10 è¶Šç‹±ä»¥åè‡ªå¸¦äº† SSHï¼Œæ‰€ä»¥ä¸éœ€è¦å•ç‹¬å» Cydia ä¸‹è½½å’Œå®‰è£… <code>OpenSSH</code>.</p><p>å¾ˆå¤šäººè¶Šç‹±åï¼Œå‘ç°ä¹Ÿå®‰è£…äº† OpenSSHï¼Œä½†æ˜¯ä¸€æ—¦è¿æ¥ iPhone è®¾å¤‡å°±æ— æ³•è¿æ¥ç”šè‡³æŠ¥é”™. å¦‚æœä½ å·²ç»å®‰è£…äº† OpenSSH å¹¶ä¸”æ— æ³•ä½¿ç”¨ SSH æ¥æ“ä½œä½ çš„ iPhone è®¾å¤‡ï¼Œè¯·ç»§ç»­å¾€ä¸‹çœ‹.</p><p>[1]. æ‰“å¼€ Cydiaï¼Œåˆ†åˆ«æœç´¢ OpenSSL å’Œ Opensshï¼Œç„¶ååˆ†åˆ«å¸è½½ OpenSSL å’Œ Openssh.</p><p>[2]. æ‰“å¼€ Cydiaï¼Œæ·»åŠ æºï¼š<code>http://cydia.ichitaso.com/test</code></p><p><img src="/upload/images/2018/05/12/2.jpg"></p><p>ç‚¹å‡»å·¦ä¸Šè§’çš„ <code>æ·»åŠ </code>ï¼Œåœ¨å¼¹æ¡†ä¸­è¾“å…¥å¯¹åº”çš„æºåœ°å€å³å¯.</p><p>[3]. åœ¨ Cydia ä¸­æœç´¢ <code>dropbear</code> å¹¶å®‰è£….</p><p><img src="/upload/images/2018/05/12/3.jpg"></p><p>å®‰è£…å³å¯.</p><p>å®‰è£…æˆåŠŸåï¼Œä¸€èˆ¬å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨ SSH åŠŸèƒ½äº†.</p><p>æ‰“å¼€ MacOS ç»ˆç«¯ï¼Œå¼€å§‹ä½¿ç”¨ SSH è¿æ¥ä½ çš„ iPhone è®¾å¤‡.</p><p>[1]. æŸ¥çœ‹ iPhone è®¾å¤‡çš„(wifi) IP åœ°å€. å¦‚æˆ‘çš„æ˜¯ <code>192.168.1.105</code>.<br>[2]. ä½¿ç”¨ MacOS ç»ˆç«¯ï¼Œè¾“å…¥:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh root@192.168.1.105</span><br></pre></td></tr></table></figure><p>æˆåŠŸçš„è¯ï¼Œå®ƒå…ˆä¼šè­¦å‘Šä½ æ˜¯å¦ç»§ç»­æ“ä½œï¼Œè¾“å…¥ <code>yes</code> å³å¯ï¼Œç„¶ååˆæç¤ºä½ è¾“å…¥ root å¯†ç ï¼Œå¯†ç å°±æ˜¯å‰é¢è¯´çš„ä¿®æ”¹åçš„å¯†ç . å¦‚æœä½ æ²¡æœ‰ä¿®æ”¹å¯†ç ï¼Œé‚£å°±æ˜¯ <code>alpine</code>. æ“ä½œæµç¨‹å¦‚ä¸‹:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">The authenticity of host <span class="string">&#x27;192.168.1.105 (192.168.1.105)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:ANF7Cvc1yM/ZdaHyz9V1EHjG115cylIcHWyOzCL+kzs.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no)? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.1.105<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">root@192.168.1.105&#x27;</span>s password: </span><br></pre></td></tr></table></figure><p>ä¹‹å‰åœ¨ iOS 10.2.x è¶Šç‹±ä¿®æ”¹å¯¹åº”çš„é…ç½®æ–‡ä»¶ï¼Œå°±å¯ä»¥ä½¿ç”¨ SSH åŠŸèƒ½äº†ï¼Œä½†æ˜¯åœ¨ iOS10.3.x æ— æµäºäº‹ï¼Œå¦‚æœä½ æ˜¯iOS 10.2.x çš„è¶Šç‹±æ‰‹æœºï¼Œå¯ä»¥å‚è€ƒæœ¬æ–‡æœ«é™„å½•é…ç½® SSHï¼Œä¹Ÿæ˜¯æˆ‘ä¹‹å‰å®è·µçš„ç»“æœ.</p><h2 id="usbmuxd"><a href="#usbmuxd" class="headerlink" title="usbmuxd"></a>usbmuxd</h2><p>ä¸Šé¢æ˜¯é€šè¿‡ wifi æ¥è¿æ¥ iPhone è®¾å¤‡çš„ï¼Œå…¶å®è¿˜æœ‰ä¸€ç§æ–¹å¼ï¼Œå°±æ˜¯å€ŸåŠ©äº <code>usbmuxd</code> è¿™ä¸ªå·¥å…·é€šè¿‡ USB è¿æ¥(æ‰‹æœºæ•°æ®çº¿è¿æ¥ç”µè„‘)ä¸éœ€è¦ wifiï¼ŒUSBè¿æ¥æ¯” wifi å“åº”é€Ÿåº¦å¿«ï¼Œä¸”æ— ç½‘ç»œç¯å¢ƒçš„é™åˆ¶.</p><p>ä½¿ç”¨ usbmuxd çš„å‰ææ˜¯ä½ çš„æ‰‹æœºå¯ä»¥æ­£å¸¸çš„ä½¿ç”¨ SSH åŠŸèƒ½ï¼Œå¦åˆ™ usbmuxd ä¹Ÿæ— æ³•æ•‘ä½ ã€‚</p><p>[1]. MacOS å®‰è£… <code>usbmuxd</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install usbmuxd</span><br></pre></td></tr></table></figure><p>[2]. ä½¿ç”¨ <code>usbmuxd</code> è‡ªå¸¦å·¥å…· <code>iproxy</code>.</p><p><code>iproxy</code> å¯ä»¥å¿«æ·çš„æ“ä½œè¿æ¥ iPhone ç­‰æ“ä½œ.</p><p>MacOS ä¸Šåªæ”¯æŒ 4 ä½çš„ç«¯å£å·ï¼Œéœ€è¦æŠŠ iPhone çš„é»˜è®¤ç«¯å£ 22 æ˜ å°„åˆ° Mac ä¸Šé¢ä¸€ä¸ª 4 ä½ç«¯å£å·çš„ç«¯å£ä¸Šé¢ï¼Œç›¸å½“äºå»ºç«‹ä¸€ä¸ª Mac å’Œ iPhone ä¹‹é—´çš„é€šé“. <code>iproxy</code> å…·ä½“ä½¿ç”¨ï¼Œåé¢å†è®². å¤§å®¶å…ˆå®‰è£…ä¸€ä¸‹å³å¯.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iproxy 5678 22</span><br><span class="line">waiting <span class="keyword">for</span> connection</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šå‘½ä»¤å°±æ˜¯æŠŠå½“å‰è¿æ¥è®¾å¤‡çš„ <code>22</code> ç«¯å£(SSHç«¯å£)æ˜ å°„åˆ°ç”µè„‘çš„ <code>5678</code> ç«¯å£ï¼Œé‚£ä¹ˆæƒ³å’Œè®¾å¤‡ <code>22</code> ç«¯å£é€šä¿¡ï¼Œç›´æ¥å’Œæœ¬åœ°çš„ <code>5678</code> ç«¯å£é€šä¿¡å°±å¯ä»¥äº†ã€‚</p><p>ç»ˆç«¯æç¤º <code>waiting for connection</code>ï¼Œè¡¨ç¤ºè¿™ä¸¤ä¸ªç«¯å£ä¹‹é—´å·²ç»å¯ä»¥é€šä¿¡äº†ï¼Œä¿ç•™å½“å‰ç»ˆç«¯çª—å£(å¦‚æœå…³é—­å°±åœæ­¢ç«¯å£ä¹‹é—´çš„é€šä¿¡äº†)ï¼Œæ–°å»ºå¦ä¸€ä¸ªç»ˆç«¯è¾“å…¥ï¼Œé»˜è®¤å¯†ç  root å¯†ç ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -p 5678 root@127.0.0.1</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼Œç±»ä¼¼ä¸Šé¢é€šè¿‡ WIFI æ“ä½œçš„æ–¹å¼ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">The authenticity of host <span class="string">&#x27;[127.0.0.1]:5678 ([127.0.0.1]:5678)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:ANF7Cvc1yM/ZdaHyz9V1EHjG115cylIcHWyOzCL+kzs.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no)? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>[127.0.0.1]:5678<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">root@127.0.0.1&#x27;</span>s password: </span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œä½ å°±å¯ä»¥åœ¨ MacOS ç»ˆç«¯ä¸Šé¢æ“ä½œä½ çš„ iPhone è®¾å¤‡äº†ï¼Œå°½æƒ…çš„äº«å— shell å‘½ä»¤å§ã€‚ä¸ä½¿ç”¨çš„æ—¶å€™ï¼Œè¾“å…¥ <code>exit</code> å³å¯é€€å‡º SSH.</p><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p><strong>[1]. iOS 10.2.x è¶Šç‹±ä½¿ç”¨ SSH åŠŸèƒ½.</strong></p><p>é¦–å…ˆä¿®æ”¹ root å¯†ç ã€‚</p><p>iOS 10.2 (è¶Šç‹±å)è‡ªå¸¦ <code>OpenSSH</code>ï¼Œä¸éœ€è¦è‡ªå·±é‡æ–°å®‰è£… OpenSSHï¼Œä½†æ˜¯éœ€è¦ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶æ‰èƒ½ä½¿ç”¨ã€‚</p><p>åœ¨æ‰‹æœºä¸Šå®‰è£… <code>MTERMINAL</code>ï¼Œè¿è¡Œ <code>su</code>ï¼Œè¾“å…¥ <code>root</code> å¯†ç ï¼Œæ‰§è¡Œ:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux|grep dropbear</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ çœ‹åˆ°çš„è¿›ç¨‹æ²¡æœ‰ dropbearï¼Œæ‰§è¡Œ:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/bin/dropbear -F -R -p 22</span><br></pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥è¿æ¥äº†ï¼Œé‡å¯ä¾ç„¶æœ‰æ•ˆã€‚</p><p>å¦‚æœä½ çœ‹åˆ°è¿›ç¨‹æ˜¯è¿™æ ·çš„:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/bin/dropbear -F -R -p 127.0.0.1:22</span><br></pre></td></tr></table></figure><p>æ„æ€æ˜¯åªèƒ½æ•°æ®çº¿é‡å®šå‘è¿æ¥ SSHï¼Œå¦‚æœä½ æƒ³æ”¹æˆ WIFI å¯ä»¥è®¿é—®ï¼Œéœ€è¦ä¿®æ”¹ <code>/private/var/containers/Bundle/Application/D9185B6D-EA9E-4678-B59C-BF43DEFE67BF/yalu102.app/dropbear.plist</code><br>æŠŠé‡Œé¢æœ‰ä¸ªå‚æ•° <code>127.0.0.1:22</code> æ”¹æˆ<code>22</code> ä¿å­˜ï¼Œé‡å¯æ‰‹æœºå³å¯ã€‚</p><p><strong>[2]. ä½¿ç”¨ <code>usbmuxd</code> æ— æ³•ä½¿ç”¨ SSH</strong></p><p>æ‰§è¡Œ <code>ssh -p 5678 root@127.0.0.1</code> åæŠ¥é”™ï¼Œå¦‚ä¸‹:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh_exchange_identification: <span class="built_in">read</span>: Connection reset by peer</span><br></pre></td></tr></table></figure><p>è¿™ç§æƒ…å†µä¸€èˆ¬æ˜¯æ²¡æœ‰æ­£ç¡®çš„ä½¿ç”¨æ•°æ®çº¿è¿æ¥ Mac ç”µè„‘ï¼Œä½¿ç”¨æ•°æ®çº¿æ­£å¸¸è¿æ¥ Mac ç”µè„‘å³å¯è§£å†³é—®é¢˜ã€‚</p><h2 id="è¶Šç‹±ç³»åˆ—æ–‡ç« "><a href="#è¶Šç‹±ç³»åˆ—æ–‡ç« " class="headerlink" title="è¶Šç‹±ç³»åˆ—æ–‡ç« "></a>è¶Šç‹±ç³»åˆ—æ–‡ç« </h2><blockquote><p>åŸºäº iOS10.3.1 è¿›è¡Œçš„å®è·µã€‚</p></blockquote><ul><li><p><a href="http://www.veryitman.com/2018/06/07/iOS-%E9%80%86%E5%90%91-dumpdecrypted-%E7%A0%B8%E5%A3%B3%E8%AE%B0/">iOS é€†å‘: dumpdecrypted ç ¸å£³è®°</a></p></li><li><p><a href="http://www.veryitman.com/2018/05/13/iOS-%E9%80%86%E5%90%91-%E7%A0%B8%E5%A3%B3/">iOS é€†å‘: ç ¸å£³</a></p></li><li><p><a href="http://www.veryitman.com/2018/05/13/iOS-%E9%80%86%E5%90%91-%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E5%92%8C%E7%BB%93%E6%9E%84/">iOS é€†å‘: æŸ¥çœ‹ç³»ç»Ÿæ–‡ä»¶ç›®å½•å’Œç»“æ„</a></p></li><li><p><a href="http://www.veryitman.com/2018/05/12/iOS-%E9%80%86%E5%90%91-%E8%B6%8A%E7%8B%B1%E4%BD%BF%E7%94%A8-SSH/">iOS é€†å‘: è¶Šç‹±ä½¿ç”¨ SSH</a></p></li><li><p><a href="http://www.veryitman.com/2019/04/07/dumpdecrypted-%E7%A0%B8%E5%A3%B3%EF%BC%9A%E5%AF%BC%E5%87%BA%E5%A4%B4%E6%96%87%E4%BB%B6/">dumpdecrypted ç ¸å£³ï¼šå¯¼å‡ºå¤´æ–‡ä»¶</a></p></li></ul><hr><p><strong>å…³æ³¨ä¸æ˜¯ç›®çš„ï¼Œäº¤æµã€å­¦ä¹ ï¼Œä¸€èµ·è¿›æ­¥æ‰æ˜¯å…³é”®</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOSå®‰å…¨ è¶Šç‹± jailbreak </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RunLoop: NSTimer å®ç°å¸¸é©»çº¿ç¨‹çš„é—®é¢˜</title>
      <link href="/2018/05/06/RunLoop-NSTimer-%E5%AE%9E%E7%8E%B0%E5%B8%B8%E9%A9%BB%E7%BA%BF%E7%A8%8B%E7%9A%84%E9%97%AE%E9%A2%98/"/>
      <url>/2018/05/06/RunLoop-NSTimer-%E5%AE%9E%E7%8E%B0%E5%B8%B8%E9%A9%BB%E7%BA%BF%E7%A8%8B%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h2 id="å¯è¡Œæ€§"><a href="#å¯è¡Œæ€§" class="headerlink" title="å¯è¡Œæ€§"></a>å¯è¡Œæ€§</h2><p>åœ¨ <a href="http://www.veryitman.com/2018/04/21/%E5%B8%B8%E9%A9%BB%E7%BA%BF%E7%A8%8B%E6%98%AF%E4%B8%80%E7%A7%8D%E4%BB%80%E4%B9%88%E4%BD%93%E9%AA%8C/">å¸¸é©»çº¿ç¨‹æ˜¯ä¸€ç§ä»€ä¹ˆä½“éªŒ</a> è¿™ç¯‡æ–‡ç« ä¸­ç»™å¤§å®¶åˆ†äº«äº†å¦‚ä½•åˆ©ç”¨ RunLoop çš„ç‰¹æ€§, ç»“åˆ <code>NSMachPort</code> å®ç°ä¸€ä¸ª <code>å¸¸é©»çº¿ç¨‹</code> çš„ä¸»é¢˜å†…å®¹.</p><p>ä»Šå¤©æˆ‘ä»¬æ¢è®¨ä¸€ä¸‹ä½¿ç”¨ <code>NSTimer</code> å¦‚ä½•å®ç° <code>å¸¸é©»çº¿ç¨‹</code> ä»¥åŠæ³¨æ„äº‹é¡¹.</p><p>ä» RunLoop çš„ç‰¹æ€§æ¥çœ‹, åªè¦æœ‰ Source æˆ–è€… Timer éƒ½ä¼šä½¿å…¶èƒ½è‡ªå¾ªç¯ä½¿ç”¨, ä¸ä¼šç«‹å³ç»ˆæ­¢å½“å‰çº¿ç¨‹çš„æ‰§è¡Œ, æ‰€ä»¥ä»ç†è®ºä¸Šæ¥çœ‹ <code>NSTimer</code> æ˜¯å¯ä»¥è¾¾åˆ°åˆ›å»º <code>å¸¸é©»çº¿ç¨‹</code> çš„ç›®çš„çš„.</p><h2 id="å¼€å§‹å®è·µ"><a href="#å¼€å§‹å®è·µ" class="headerlink" title="å¼€å§‹å®è·µ"></a>å¼€å§‹å®è·µ</h2><p>å®Œæ•´çš„ä¾‹å­ä»£ç , å¯ä»¥ä»æ–‡ç« çš„é™„å½•è·å–å’ŒæŸ¥çœ‹, è¿™é‡Œåªç»™å‡ºæ ¸å¿ƒä»£ç .</p><p><em><strong>åˆ›å»ºçº¿ç¨‹</strong></em></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">- (NSThread *)permanentThread &#123;</span><br><span class="line">    </span><br><span class="line">    static NSThread *thread = nil;</span><br><span class="line">    static dispatch_once_t onceToken;</span><br><span class="line">    dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line">        </span><br><span class="line">        thread = [[NSThread alloc] initWithTarget:self selector:@selector(asyncRun) object:nil];</span><br><span class="line">        [thread setName:@&quot;veryitman-thread&quot;];</span><br><span class="line">        </span><br><span class="line">        // åŒä¸€ä¸ªçº¿ç¨‹è¿ç»­å¤šæ¬¡ start ä¼šå¯¼è‡´ crash</span><br><span class="line">        [thread start];</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    return thread;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em><strong>çº¿ç¨‹æ‰§è¡Œçš„å‡½æ•°</strong></em></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">- (void)asyncRun &#123;</span><br><span class="line">    </span><br><span class="line">    @autoreleasepool &#123;</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;veryitman--asyncRun. Current Thread: %@&quot;, [NSThread currentThread]);</span><br><span class="line">        </span><br><span class="line">        NSRunLoop *runLoop = [NSRunLoop currentRunLoop];</span><br><span class="line">        </span><br><span class="line">        // ä¿æŒå¸¸é©»çº¿ç¨‹: ä½¿ç”¨ NSTimer</span><br><span class="line">        [self _attachTimerToRunLoop];</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;veryitman--asyncRun. Current RunLoop: %@&quot;, runLoop);</span><br><span class="line">        </span><br><span class="line">        // æ‰§è¡Œå…¶ä»–é€»è¾‘</span><br><span class="line">        //...</span><br><span class="line">        </span><br><span class="line">        // æ‰‹åŠ¨å¼€å¯ RunLoop</span><br><span class="line">        [runLoop run];</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;veryitman--asyncRun. End Run.&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em><strong>åˆ›å»ºå®šæ—¶å™¨</strong></em></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (void)_attachTimerToRunLoop &#123;</span><br><span class="line">    </span><br><span class="line">    if (nil == self.timer) &#123;</span><br><span class="line">        </span><br><span class="line">        // scheduledTimerWithTimeInterval è¿™ç§æ–¹å¼</span><br><span class="line">        // åˆ›å»ºçš„ Timer ä¼šé»˜è®¤åŠ å…¥åˆ°å½“å‰çš„ RunLoop çš„ NSDefaultRunLoopMode ä¸­</span><br><span class="line">        _timer = [NSTimer scheduledTimerWithTimeInterval:2</span><br><span class="line">                                                  target:self</span><br><span class="line">                                                selector:@selector(runTimer)</span><br><span class="line">                                                userInfo:nil</span><br><span class="line">                                                 repeats:YES];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡º, <code>_attachTimerToRunLoop</code> ä¸­æ˜¯å°† timer åŠ å…¥åˆ°å½“å‰çš„ RunLoop å½“ä¸­äº†. è¿™é‡Œæ³¨æ„, repeats å€¼è¢«è®¾ç½®ä¸º <code>YES</code> äº†.</p><p>è·Ÿä¹‹å‰ä¸€æ ·, å¯ä»¥ä½¿ç”¨ç‚¹å‡»äº‹ä»¶æ¥æ¨¡æ‹Ÿå’ŒéªŒè¯å¸¸é©»çº¿ç¨‹çš„æœ‰æ•ˆæ€§.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event &#123;</span><br><span class="line">    </span><br><span class="line">    // æ¨¡æ‹Ÿåœ¨æŒ‡å®šçº¿ç¨‹ä¸Šé¢å†æ¬¡æ‰§è¡Œæ–¹æ³•</span><br><span class="line">    SEL seltor = NSSelectorFromString(@&quot;runAnyTime&quot;);</span><br><span class="line">    </span><br><span class="line">    [self performSelector:seltor onThread:[self permanentThread] withObject:nil waitUntilDone:NO];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯ç‚¹å‡»ä¸€æ¬¡å±å¹•, éƒ½ä¼šå¯¹åº”æ‰§è¡Œ <code>runAnyTime</code> é‡Œé¢çš„å†…å®¹.</p><h2 id="å¯¹-repeat-çš„æ€è€ƒ"><a href="#å¯¹-repeat-çš„æ€è€ƒ" class="headerlink" title="å¯¹ repeat çš„æ€è€ƒ"></a>å¯¹ repeat çš„æ€è€ƒ</h2><p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­, æˆ‘å°† <code>repeat</code> å‚æ•°è®¾ç½®ä¸º <code>YES</code>, è¯•æƒ³ä¸€ä¸‹å¦‚æœæŠŠ <code>repeat</code> å‚æ•°è®¾ç½®ä¸º <code>NO</code>, ä¼šä¸ä¼šé€ æˆå¸¸é©»çº¿ç¨‹å¤±æ•ˆå‘¢?</p><p>åŠ¨æ‰‹è¯•è¯•â€¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (void)_attachTimerToRunLoop &#123;</span><br><span class="line">    </span><br><span class="line">    if (nil == self.timer) &#123;</span><br><span class="line">        </span><br><span class="line">        // scheduledTimerWithTimeInterval è¿™ç§æ–¹å¼</span><br><span class="line">        // åˆ›å»ºçš„ Timer ä¼šé»˜è®¤åŠ å…¥åˆ°å½“å‰çš„ RunLoop çš„ NSDefaultRunLoopMode ä¸­</span><br><span class="line">        _timer = [NSTimer scheduledTimerWithTimeInterval:2</span><br><span class="line">                                                  target:self</span><br><span class="line">                                                selector:@selector(runTimer)</span><br><span class="line">                                                userInfo:nil</span><br><span class="line">                                                 repeats:NO];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†æ¬¡ç‚¹å‡»å±å¹•è‹¥å¹²æ¬¡, åŒæ ·ä¼šæ‰§è¡Œå¯¹åº”å‡½æ•°é‡Œé¢çš„å†…å®¹. è¿™å°±è¯´æ˜äº†å³ä½¿å°† <code>repeat</code> å‚æ•°è®¾ç½®ä¸º <code>NO</code>, ä¹Ÿä¸ä¼šå½±å“å¸¸é©»çº¿ç¨‹.</p><p>é‚£æˆ‘ä»¬å†æ¥ç‚¹å…·æœ‰æŒ‘æˆ˜çš„æ´»åŠ¨â€¦</p><p>å°†å½“å‰é¡µé¢åŠ å…¥ <code>UIScrollview</code> è¿™ä¸ªè§†å›¾, è¿˜æ˜¯ä¿æŒ <code>repeat</code> å‚æ•°è®¾ç½®ä¸º <code>NO</code>.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    </span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    self.view.backgroundColor = [UIColor lightGrayColor];</span><br><span class="line">    self.navigationItem.title = @&quot;NSTimer åˆ›å»ºå¸¸é©»çº¿ç¨‹&quot;;</span><br><span class="line">    </span><br><span class="line">    // åŠ å…¥æ»šåŠ¨è§†å›¾</span><br><span class="line">    _scrollView = [[UIScrollView alloc] initWithFrame:self.view.bounds];</span><br><span class="line">    [self.view addSubview:self.scrollView];</span><br><span class="line">    self.scrollView.contentSize = CGSizeMake(1000, 1000);</span><br><span class="line">    self.scrollView.delegate = self;</span><br><span class="line">    </span><br><span class="line">    // å¯åŠ¨çº¿ç¨‹</span><br><span class="line">    [self permanentThread];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºåŠ å…¥äº†æ»šåŠ¨è§†å›¾, æˆ‘ä»¬æ¢ä¸€ç§æ–¹å¼æ¥æ¨¡å¼å’ŒéªŒè¯å¸¸é©»çº¿ç¨‹.</p><p>åœ¨ <code>UIScrollview</code> ä»£ç†ä¸­æ¥æ¨¡æ‹Ÿ, ç¤ºä¾‹å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView &#123;</span><br><span class="line">    </span><br><span class="line">    // æ¨¡æ‹Ÿåœ¨æŒ‡å®šçº¿ç¨‹ä¸Šé¢å†æ¬¡æ‰§è¡Œæ–¹æ³•</span><br><span class="line">    SEL seltor = NSSelectorFromString(@&quot;runAnyTime&quot;);</span><br><span class="line">    </span><br><span class="line">    [self performSelector:seltor onThread:[self permanentThread] withObject:nil waitUntilDone:NO];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œåè¿›å…¥è¯¥é¡µé¢, å¯ä»¥å‘ç°å¸¸é©»çº¿ç¨‹è¢«ç»ˆæ­¢äº†.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">veryitman--timerRun.</span><br><span class="line">veryitman--asyncRun. End Run.</span><br></pre></td></tr></table></figure><p>å½“é™¤æˆ‘ä»¥ä¸ºæ›´æ¢ä¸€ä¸‹æ¨¡å¼å³ä½¿ å°† <code>repeat</code> å‚æ•°è®¾ç½®ä¸º <code>NO</code>, ä¹Ÿä¸ä¼šå‡ºç°å¸¸é©»çº¿ç¨‹è¢«ç»ˆæ­¢çš„é—®é¢˜. å¦‚ä¸‹é¢çš„ä»£ç :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">_timer = [NSTimer timerWithTimeInterval:2 target:self selector:@selector(runTimer) userInfo:nil repeats:NO];</span><br><span class="line">[[NSRunLoop currentRunLoop] addTimer:self.timer forMode:NSRunLoopCommonModes];</span><br></pre></td></tr></table></figure><p>è¿™æ ·æ›´æ¢æ¨¡å¼ä¸º <code>NSRunLoopCommonModes</code> ä¹Ÿä¸è¡Œ.</p><p>åœ¨è¿™ç§æƒ…å†µ(æœ‰æ»šåŠ¨è§†å›¾çš„)ä¸‹, å°† <code>repeat</code> å‚æ•°è®¾ç½®ä¸º <code>YES</code> å°±ä¸ä¼šå¯¼è‡´å¸¸é©»çº¿ç¨‹è¢«ç»ˆæ­¢äº†, æ— è®ºå“ªç§æ–¹å¼åˆ›å»ºçš„ Timer.</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>1.å­çº¿ç¨‹åˆ›å»ºä¸­çš„ RunLoop çš„æ¨¡å¼ä¸ä¼šä¸ä¸»çº¿ç¨‹ä¸­ RunLoop çš„æ¨¡å¼å†²çª, å„è‡ªè¿è¡Œåœ¨å„è‡ªçš„ mode å½“ä¸­. </p><p>2.ä½¿ç”¨ <code>NSTimer</code> æ¥åˆ›å»ºå¸¸é©»çº¿ç¨‹, åœ¨æœ‰ <code>UIScrollview</code> æˆ–è€…å…¶å­ç±»çš„æƒ…å†µä¸‹, éœ€è¦å°† <code>repeats</code> è®¾ç½®ä¸º <code>YES</code>, å¦åˆ™ä¸ä¼šåˆ›å»ºå¸¸é©»çº¿ç¨‹. æ²¡æœ‰æ»šåŠ¨è§†å›¾çš„æƒ…å†µä¸‹, <code>repeats</code> è®¾ç½®ä¸º <code>NO</code> ä¹Ÿæ²¡æœ‰å…³ç³».</p><p>3.åˆ›å»º NSTimer</p><p>ä¸‹é¢ä¸¤ç§åˆ›å»º Timer çš„æ•ˆæœæ˜¯ä¸€è‡´çš„.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[NSTimer scheduledTimerWithTimeInterval:2</span><br><span class="line">                  target:self</span><br><span class="line">                selector:@selector(runTimer)</span><br><span class="line">                userInfo:nil</span><br><span class="line">                 repeats:YES];</span><br></pre></td></tr></table></figure><p><code>scheduledTimerWithTimeInterval</code> é»˜è®¤ä¼šå°† Timer åŠ å…¥åˆ°å½“å‰çš„ RunLoop ä¸­.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[NSTimer timerWithTimeInterval:2 target:self selector:@selector(runTimer) userInfo:nil repeats:NO];</span><br><span class="line">[[NSRunLoop currentRunLoop] addTimer:self.timer forMode:NSDefaultRunLoopMode];</span><br></pre></td></tr></table></figure><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p>å®Œæ•´ç¤ºä¾‹ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;MZTimerPermanentThreadController.h&quot;</span><br><span class="line"></span><br><span class="line">@interface MZTimerPermanentThreadController () &lt;UIScrollViewDelegate&gt;</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong) NSTimer *timer;</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong) UIScrollView *scrollView;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@implementation MZTimerPermanentThreadController</span><br><span class="line"></span><br><span class="line">- (void)dealloc &#123;</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;veryitman---MZTimerPermanentThreadController dealloc.&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    </span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    self.view.backgroundColor = [UIColor lightGrayColor];</span><br><span class="line">    self.navigationItem.title = @&quot;NSTimer åˆ›å»ºå¸¸é©»çº¿ç¨‹&quot;;</span><br><span class="line">    </span><br><span class="line">    // åŠ å…¥æ»šåŠ¨è§†å›¾</span><br><span class="line">    _scrollView = [[UIScrollView alloc] initWithFrame:self.view.bounds];</span><br><span class="line">    [self.view addSubview:self.scrollView];</span><br><span class="line">    self.scrollView.contentSize = CGSizeMake(1000, 1000);</span><br><span class="line">    self.scrollView.delegate = self;</span><br><span class="line">    </span><br><span class="line">    // å¯åŠ¨çº¿ç¨‹</span><br><span class="line">    [self permanentThread];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewDidDisappear:(BOOL)animated &#123;</span><br><span class="line">    </span><br><span class="line">    [super viewDidDisappear:animated];</span><br><span class="line">    </span><br><span class="line">    // å–æ¶ˆçº¿ç¨‹</span><br><span class="line">    // å®é™…ä¸šåŠ¡åœºæ™¯ä¸­è‡ªè¡Œå†³å®š canCancel çš„è®¾ç½®, è¿™é‡Œåªæ˜¯ç¤ºä¾‹</span><br><span class="line">    BOOL canCancel = YES;</span><br><span class="line">    if (canCancel) &#123;</span><br><span class="line">        </span><br><span class="line">        [self.timer invalidate];</span><br><span class="line">        _timer = nil;</span><br><span class="line">        </span><br><span class="line">        [[self permanentThread] cancel];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView &#123;</span><br><span class="line">    </span><br><span class="line">    // æ¨¡æ‹Ÿåœ¨æŒ‡å®šçº¿ç¨‹ä¸Šé¢å†æ¬¡æ‰§è¡Œæ–¹æ³•</span><br><span class="line">    SEL seltor = NSSelectorFromString(@&quot;runAnyTime&quot;);</span><br><span class="line">    </span><br><span class="line">    [self performSelector:seltor onThread:[self permanentThread] withObject:nil waitUntilDone:NO];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event &#123;</span><br><span class="line">    </span><br><span class="line">    // æ¨¡æ‹Ÿåœ¨æŒ‡å®šçº¿ç¨‹ä¸Šé¢å†æ¬¡æ‰§è¡Œæ–¹æ³•</span><br><span class="line">    SEL seltor = NSSelectorFromString(@&quot;runAnyTime&quot;);</span><br><span class="line">    </span><br><span class="line">    [self performSelector:seltor onThread:[self permanentThread] withObject:nil waitUntilDone:NO];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (NSThread *)permanentThread &#123;</span><br><span class="line">    </span><br><span class="line">    static NSThread *thread = nil;</span><br><span class="line">    static dispatch_once_t onceToken;</span><br><span class="line">    dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line">        </span><br><span class="line">        thread = [[NSThread alloc] initWithTarget:self selector:@selector(asyncRun) object:nil];</span><br><span class="line">        [thread setName:@&quot;veryitman-thread&quot;];</span><br><span class="line">        </span><br><span class="line">        // åŒä¸€ä¸ªçº¿ç¨‹è¿ç»­å¤šæ¬¡ start ä¼šå¯¼è‡´ crash</span><br><span class="line">        [thread start];</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    return thread;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)asyncRun &#123;</span><br><span class="line">    </span><br><span class="line">    @autoreleasepool &#123;</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;veryitman--asyncRun. Current Thread: %@&quot;, [NSThread currentThread]);</span><br><span class="line">        </span><br><span class="line">        NSRunLoop *runLoop = [NSRunLoop currentRunLoop];</span><br><span class="line">        </span><br><span class="line">        // ä¿æŒå¸¸é©»çº¿ç¨‹: ä½¿ç”¨ NSTimer</span><br><span class="line">        [self _attachTimerToRunLoop];</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;veryitman--asyncRun. Current RunLoop: %@&quot;, runLoop);</span><br><span class="line">        </span><br><span class="line">        // æ‰§è¡Œå…¶ä»–é€»è¾‘</span><br><span class="line">        //...</span><br><span class="line">        </span><br><span class="line">        // æ‰‹åŠ¨å¼€å¯ RunLoop</span><br><span class="line">        [runLoop run];</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;veryitman--asyncRun. End Run.&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)runAnyTime &#123;</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;veryitman--runAnyTime. Current Thread: %@&quot;, [NSThread currentThread]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)_attachTimerToRunLoop &#123;</span><br><span class="line">    </span><br><span class="line">    if (nil == self.timer) &#123;</span><br><span class="line">        </span><br><span class="line">        // scheduledTimerWithTimeInterval è¿™ç§æ–¹å¼</span><br><span class="line">        // åˆ›å»ºçš„ Timer ä¼šé»˜è®¤åŠ å…¥åˆ°å½“å‰çš„ RunLoop çš„ NSDefaultRunLoopMode ä¸­</span><br><span class="line">        _timer = [NSTimer scheduledTimerWithTimeInterval:2</span><br><span class="line">                                                  target:self</span><br><span class="line">                                                selector:@selector(runTimer)</span><br><span class="line">                                                userInfo:nil</span><br><span class="line">                                                 repeats:YES];</span><br><span class="line">        </span><br><span class="line">#if 0</span><br><span class="line">        _timer = [NSTimer timerWithTimeInterval:2 target:self selector:@selector(runTimer) userInfo:nil repeats:NO];</span><br><span class="line">        [[NSRunLoop currentRunLoop] addTimer:self.timer forMode:NSRunLoopCommonModes];</span><br><span class="line">#endif</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)runTimer &#123;</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;--veryitman--timerRun.&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RunLoop å¸¸é©»çº¿ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¸¸é©»çº¿ç¨‹æ˜¯ä¸€ç§ä»€ä¹ˆä½“éªŒ</title>
      <link href="/2018/04/21/%E5%B8%B8%E9%A9%BB%E7%BA%BF%E7%A8%8B%E6%98%AF%E4%B8%80%E7%A7%8D%E4%BB%80%E4%B9%88%E4%BD%93%E9%AA%8C/"/>
      <url>/2018/04/21/%E5%B8%B8%E9%A9%BB%E7%BA%BF%E7%A8%8B%E6%98%AF%E4%B8%80%E7%A7%8D%E4%BB%80%E4%B9%88%E4%BD%93%E9%AA%8C/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€è¯´-RunLoop"><a href="#ç®€è¯´-RunLoop" class="headerlink" title="ç®€è¯´ RunLoop"></a>ç®€è¯´ RunLoop</h2><p>å…³äº iOS RunLoop ç½‘ä¸Šå¾ˆå¤šæ–‡ç« éƒ½æœ‰ä»‹ç»è¿‡, å¾ˆå¤šæŠ€æœ¯é¢è¯•å®˜ä¹Ÿä¼šé—®å…³äº RunLoop çš„ç›¸å…³çŸ¥è¯†. æˆ‘æŠŠè‡ªå·±å·¥ä½œä¸­é‡åˆ°çš„é—®é¢˜å’Œæ€»ç»“çš„ç»éªŒåˆ†äº«å‡ºæ¥(ä¼šåšæˆä¸€ç³»åˆ—çš„æ–‡ç« ), ä¹Ÿç®—æ˜¯å¯¹è‡ªå·±çš„ä¸€ä¸ªæ€»ç»“å’Œæ²‰æ·€, æ¬¢è¿å¤§å®¶äº¤æµ.</p><p>ç½‘ä¸Šçš„æ–‡ç« åŸºæœ¬éƒ½æ˜¯é’ˆå¯¹äº <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/Multithreading/RunLoopManagement/RunLoopManagement.html">Apple Developer Doc - Run Loops</a> è¿™ç¯‡æ¥å±•å¼€çš„, æ‰€ä»¥å»ºè®®å¤§å®¶è®¤çœŸçš„å»é€šè¯»è¿™ç¯‡æ–‡ç« , å¹¶å†™ä»£ç éªŒè¯, å®è·µ.</p><p>å¯ä»¥ç®€å•ç²—æš´çš„è¿™ä¹ˆç†è§£ä¸€ä¸‹ RunLoop, åŸºäºäº‹ä»¶é©±åŠ¨çš„æ­»å¾ªç¯(ç”±å†…æ ¸æ¥è°ƒåº¦å’Œç®¡ç†çš„), åœ¨éœ€è¦å¤„ç†äº‹æƒ…çš„æ—¶å€™å°±å‡ºæ¥å¹²ç‚¹äº‹, å¦åˆ™ä¼‘çœ å¾…å‘½.<br>RunLoop çš„æ ¸å¿ƒæ˜¯åŸºäº <code>machport</code> çš„ï¼Œå…¶è¿›å…¥ä¼‘çœ æ—¶è°ƒç”¨çš„å‡½æ•°æ˜¯ mach_msg().</p><p>ç±»ä¼¼ä¸‹é¢çš„ä»£ç æ¥è¯´æ˜ä¸€ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">BOOL stopRunning = NO;</span><br><span class="line"></span><br><span class="line">do &#123;</span><br><span class="line">   </span><br><span class="line">   // å¤„ç† App ä¸­å„ç§æ“ä½œå„ç§äº‹ä»¶</span><br><span class="line">   // ç‚¹å‡»å±å¹•, è§¦æ‘¸åˆ°ç¡¬ä»¶ä¹Ÿä¼šå”¤é†’ RunLoop</span><br><span class="line">   </span><br><span class="line">  &#125; while(!stopRunning);</span><br></pre></td></tr></table></figure><p>è¯´åˆ°è¿™é‡Œ, éšä¾¿æåŠä¸€ä¸‹, å­¦ä¹ è¿‡ Android å¼€å‘çš„åŒäº‹åº”è¯¥å’Œå¥½ç†è§£ RunLoop äº†,  iOS çš„ RunLoop è·Ÿ Android çš„ Looper æœºåˆ¶å‡ ä¹ä¸€æ ·, åªæ˜¯ä¸åŒçš„ç³»ç»Ÿä¹‹é—´å®ç°æœ‰å·®å¼‚ç½¢äº†!</p><p>æœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥çœ‹ä¸€ä¸‹æˆ‘ä¹‹å‰å†™çš„æ–‡ç«  <a href="https://blog.csdn.net/veryitman/article/details/6384641">Handler: æ›´æ–°UIçš„æ–¹æ³•</a>.</p><hr><p>ä»Šå¤©è·Ÿå¤§å®¶åˆ†äº«å¦‚ä½•åœ¨ iOS ä¸­ç»“åˆ RunLoop å’Œ machport å®ç°å¸¸é©»çº¿ç¨‹, å…ˆè·Ÿç€å®ä¾‹èµ°, åç»­å†å»æ€»ç»“ RunLoop çš„å„ç§ç»†èŠ‚ç‚¹.</p><h2 id="ç¥å¥‡çš„-main"><a href="#ç¥å¥‡çš„-main" class="headerlink" title="ç¥å¥‡çš„ main"></a>ç¥å¥‡çš„ main</h2><p>å¼€å‘è¿‡ iOS åº”ç”¨ä¸­çš„æœ‹å‹, å¯¹ <code>main.m</code> å†ä¹Ÿç†Ÿæ‚‰ä¸è¿‡äº†, <code>main</code> å‡½æ•°æ­£æ˜¯åº”ç”¨çš„å…¥å£å‡½æ•°.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">int main(int argc, char * argv[]) &#123;</span><br><span class="line">    @autoreleasepool &#123;</span><br><span class="line">        return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class]));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å°† <code>return</code> ä»£ç åˆ†å¼€å†™, çœ‹çœ‹æœ‰ä»€ä¹ˆè››ä¸é©¬è¿¹å¯å¯».</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">int main(int argc, char * argv[]) &#123;</span><br><span class="line">    </span><br><span class="line">    @autoreleasepool &#123;</span><br><span class="line">        </span><br><span class="line">        int ret = UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class]));</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;veryitman--- UIApplicationMain end.&quot;);</span><br><span class="line">        </span><br><span class="line">        return ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ— è®ºå¦‚ä½•ä½ ä¹Ÿçœ‹ä¸åˆ°æ—¥å¿— <code>veryitman--- UIApplicationMain end.</code> çš„æ‰“å°, è¿™è¯´æ˜ <code>UIApplicationMain</code> ä¸€ç›´åœ¨å‘µæŠ¤ç€ APP çš„è¿è¡Œ, å“ˆå“ˆ.</p><p>æˆ‘ä»¬ä¸å¦¨å†æ”¹ä¸€æ¬¡, å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">int main(int argc, char * argv[]) &#123;</span><br><span class="line">    </span><br><span class="line">    @autoreleasepool &#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†å»è¿è¡Œ APP, ä½ ä¼šå‘ç°æ ¹æœ¬æ²¡æœ‰è®© APP è¿è¡Œèµ·æ¥, å†æ¬¡è¯´æ˜æ²¡æœ‰äº† <code>UIApplicationMain</code> çš„å‘µæŠ¤, APP æ— æ³•èµ·æ­»å›ç”Ÿ.</p><p>çŒœæµ‹åœ¨ <code>UIApplicationMain</code> å‡½æ•°ä¸­ï¼Œå¼€å¯äº†å’Œä¸»çº¿ç¨‹ç›¸å…³çš„ RunLoopï¼Œä½¿ <code>UIApplicationMain</code> ä¸ä¼šè¿”å›ä¸€ç›´åœ¨è¿è¡Œä¸­ï¼Œä»è€Œä¿è¯äº†ç¨‹åºçš„æŒç»­è¿è¡Œ, æœ€å¤§çš„åŠŸè‡£å°±æ˜¯  RunLoop.</p><h2 id="æ™®é€šçº¿ç¨‹"><a href="#æ™®é€šçº¿ç¨‹" class="headerlink" title="æ™®é€šçº¿ç¨‹"></a>æ™®é€šçº¿ç¨‹</h2><p>ä¸€èˆ¬æˆ‘ä»¬å¼€å¯çš„çº¿ç¨‹åœ¨æ‰§è¡Œå®Œä»»åŠ¡å, å°±ä¼šç»“æŸè¯¥çº¿ç¨‹. é™¤éä½ å†™äº†ç±»ä¼¼ä¸‹é¢çš„ä»£ç :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">while(1) &#123;</span><br><span class="line">// ä¸šåŠ¡å¤„ç†</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ–è€…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">while (æ¡ä»¶æ»¡è¶³) &#123;</span><br><span class="line">// ä¸šåŠ¡å¤„ç†</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼€å¯ä¸€ä¸ªçº¿ç¨‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">- (NSThread *)permanentThread &#123;</span><br><span class="line">    </span><br><span class="line">    static NSThread *thread = nil;</span><br><span class="line">    static dispatch_once_t onceToken;</span><br><span class="line">    dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line"></span><br><span class="line">        thread = [[NSThread alloc] initWithTarget:self selector:@selector(asyncRun) object:nil];</span><br><span class="line">        [thread setName:@&quot;veryitman-thread&quot;];</span><br><span class="line">        </span><br><span class="line">        // åŒä¸€ä¸ªçº¿ç¨‹è¿ç»­å¤šæ¬¡ start ä¼šå¯¼è‡´ crash</span><br><span class="line">        [thread start];</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    return thread;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå¯¹åº”çš„ <code>asyncRun</code> å‡½æ•°, å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">- (void)asyncRun &#123;</span><br><span class="line">    </span><br><span class="line">    @autoreleasepool &#123;</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;veryitman--asyncRun. Current Thread: %@&quot;, [NSThread currentThread]);</span><br><span class="line">        </span><br><span class="line">        // æ‰§è¡Œå…¶ä»–é€»è¾‘</span><br><span class="line">        //...</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;veryitman--asyncRun. End Run.&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç° <code>asyncRun</code> å¾ˆå¿«å°±å¯ä»¥æ‰§è¡Œå®Œæˆ (End Run).</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">veryitman--asyncRun. Current Thread: &lt;NSThread: 0x60000066c400&gt;&#123;number = 3, name = veryitman-thread&#125;</span><br><span class="line">veryitman--asyncRun. End Run.</span><br></pre></td></tr></table></figure><h2 id="å­çº¿ç¨‹å¼€å¯-RunLoop"><a href="#å­çº¿ç¨‹å¼€å¯-RunLoop" class="headerlink" title="å­çº¿ç¨‹å¼€å¯ RunLoop"></a>å­çº¿ç¨‹å¼€å¯ RunLoop</h2><p>ä¸»çº¿ç¨‹æ˜¯é»˜è®¤å¼€å¯ RunLoop çš„å³ mainRunLoop æ˜¯ç³»ç»Ÿé»˜è®¤å¼€å¯çš„, ä½†æ˜¯å­çº¿ç¨‹ä¸­çš„ RunLoop éœ€è¦æˆ‘ä»¬è‡ªå·±æ‰‹åŠ¨å¼€å¯.</p><blockquote><p>å…³äºä¸ºä»€ä¹ˆå­çº¿ç¨‹ä¸­éœ€è¦æ‰‹åŠ¨å¼€å¯, åç»­æ–‡ç« ç»“åˆæºç ç»™å¤§å®¶åˆ†æ, è¿™é‡Œæš‚æ—¶å¯ä»¥ç†è§£ä¸ºè·å– RunLoop å¯¹è±¡æ˜¯ä¸€ç§æ‡’åŠ è½½æ¨¡å¼. åªä¸è¿‡ä¸»çº¿ç¨‹ä¸­, ç³»ç»Ÿå¸®æˆ‘ä»¬å¼€å¯äº†, ç„¶è€Œå­çº¿ç¨‹ä¸­éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å¼€å¯è€Œå·².</p></blockquote><p>ç±»ä¼¼è¿™æ ·:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">- (void)asyncRun &#123;</span><br><span class="line">    </span><br><span class="line">    @autoreleasepool &#123;</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;veryitman--asyncRun. Current Thread: %@&quot;, [NSThread currentThread]);</span><br><span class="line">        </span><br><span class="line">        NSRunLoop *runLoop = [NSRunLoop currentRunLoop];</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;veryitman--asyncRun. Current RunLoop: %@&quot;, runLoop);</span><br><span class="line">        </span><br><span class="line">        // æ‰§è¡Œå…¶ä»–é€»è¾‘</span><br><span class="line">        //...</span><br><span class="line">        </span><br><span class="line">        // æ‰‹åŠ¨å¼€å¯ RunLoop</span><br><span class="line">        [runLoop run];</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;veryitman--asyncRun. End Run.&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æ§åˆ¶å°å¯ä»¥çœ‹åˆ°è¾“å‡º:</p><p><img src="/upload/images/2018/04/21/1.jpg" alt="1"></p><p>RunLoop æ²¡æœ‰ä»»ä½•è¾“å…¥æº(input source) å’Œå®šæ—¶å™¨(timer), è¿™æ—¶å³ä½¿å¼€å¯äº† RunLoop ä¹Ÿä¸ä¼šè®©å…¶ç­‰å¾…æ‰§è¡Œ, æ¢å¥è¯è¯´ä¼šç«‹å³ç»“æŸå½“å‰çš„ RunLoop.</p><p>æ—¢ç„¶è¿™æ ·æˆ‘ä»¬ç»™å­çº¿ç¨‹çš„ RunLoop æ·»åŠ æºæˆ–è€…å®šæ—¶å™¨å³å¯. è¿™é‡Œä»¥æ·»åŠ  NSPort ä¸ºä¾‹.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">- (void)asyncRun &#123;</span><br><span class="line">    </span><br><span class="line">    @autoreleasepool &#123;</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;veryitman--asyncRun. Current Thread: %@&quot;, [NSThread currentThread]);</span><br><span class="line">        </span><br><span class="line">        NSRunLoop *runLoop = [NSRunLoop currentRunLoop];</span><br><span class="line">        </span><br><span class="line">        // æ·»åŠ  source</span><br><span class="line">        NSPort *port = [NSMachPort port];</span><br><span class="line">        [runLoop addPort:port forMode:NSRunLoopCommonModes];</span><br><span class="line">               </span><br><span class="line">        NSLog(@&quot;veryitman--asyncRun. Current RunLoop: %@&quot;, runLoop);</span><br><span class="line">        </span><br><span class="line">        // æ‰§è¡Œå…¶ä»–é€»è¾‘</span><br><span class="line">        //...</span><br><span class="line">        </span><br><span class="line">        // æ‰‹åŠ¨å¼€å¯ RunLoop</span><br><span class="line">        [runLoop run];</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;veryitman--asyncRun. End Run.&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†æ¬¡è¿è¡Œ, ä½ ä¼šå‘ç° <code>End Run</code> è¿™ä¸ª Log æ˜¯ä¸ä¼šæ‰“å°å‡ºæ¥çš„. å¯¹åº”å½“å‰çš„ RunLoop ä¹Ÿæœ‰äº†æºå’Œå®šæ—¶å™¨, å¦‚å›¾æ‰€ç¤º:<br><img src="/upload/images/2018/04/21/2.jpg" alt="1"></p><p>å…³äºå®šæ—¶å™¨å’Œ RunLoop çš„ç»“åˆ, ä¸‹ç¯‡å†åˆ†äº«. </p><p>ç°åœ¨æœ‰è¿™æ ·ä¸€ä¸ªéœ€æ±‚, éœ€è¦åœ¨æŒ‡å®šçš„çº¿ç¨‹ä¸­æ‰§è¡ŒæŸé¡¹ä»»åŠ¡, æ˜¾ç„¶ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•æ¥æ»¡è¶³éœ€æ±‚, ä¸‹é¢è¿›å…¥ä»Šå¤©çš„æ­£é¢˜.</p><h2 id="éªŒè¯å¸¸é©»çº¿ç¨‹"><a href="#éªŒè¯å¸¸é©»çº¿ç¨‹" class="headerlink" title="éªŒè¯å¸¸é©»çº¿ç¨‹"></a>éªŒè¯å¸¸é©»çº¿ç¨‹</h2><p>ä¸€å®šåˆ° <code>å¸¸é©»</code> è¿™ä¸ªè¯, å°±çŸ¥é“æ˜¯èƒ½å¤Ÿè®©è¯¥çº¿ç¨‹éšæ—¶å¾…å‘½, ä¿è¯å…¶ä¸æŒ‚æ‰.</p><p>iOS ä¸­é»˜è®¤å°±æœ‰ä¸ªä¸»çº¿ç¨‹å³ <code>main çº¿ç¨‹</code>, æˆ‘ä»¬çš„ UI çº¿ç¨‹æŒ‡çš„å°±æ˜¯ä¸»çº¿ç¨‹, ä¸€èˆ¬éƒ½æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­æ“ä½œ UI, ä»æŸä¸ªè§’åº¦æ¥è¯´, ä¸»çº¿ç¨‹å°±æ˜¯ä¸€ä¸ªå¸¸é©»çº¿ç¨‹.</p><p>æˆ‘ä»¬å¼€å¯å…¶ä»–çº¿ç¨‹, ç›®çš„æ˜¯ä¸ºäº†å¼‚æ­¥å®Œæˆä¸€äº›ä»»åŠ¡, è¿™äº›ä»»åŠ¡ä¸€èˆ¬éƒ½æ¯”è¾ƒè€—æ—¶, å¦‚æœæ”¾åœ¨ä¸»çº¿ç¨‹å½“ä¸­å®Œæˆè¿™äº›ä»»åŠ¡å°±ä¼šå¯¼è‡´ä¸»çº¿ç¨‹çš„å¡é¡¿, ç”¨æˆ·ä½“éªŒæå…¶å·®. </p><p>è¯´äº†è¿™ä¹ˆå¤š, ä¹Ÿè®¸ä½ ä¼šé—®, ä¸ºä»€ä¹ˆè¦å¸¸é©»çº¿ç¨‹å‘¢?</p><p>é¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹ï¼Œä¼šé€ æˆèµ„æº(ä¸»è¦æ˜¯å†…å­˜)çš„æµªè´¹, æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸è®©é¢‘ç¹ä½¿ç”¨çš„å­çº¿ç¨‹å¸¸é©»åœ¨å†…å­˜ä¸­, æƒ³ç”¨çš„æ—¶å€™å°±ç”¨, ä¸ç”¨çš„æ—¶å€™è®©ä»–ä¼‘çœ å‘¢?! </p><p>ä¸Šé¢å·²ç»ä½¿ç”¨ RunLoop æ¥å®ç°äº†è®©çº¿ç¨‹é•¿æ—¶é—´å­˜æ´»è€Œä¸è¢«é”€æ¯äº†.</p><p>ç”¨ <code>touchesBegan</code> æ¥æ¨¡æ‹Ÿåœ¨æŒ‡å®šçº¿ç¨‹ä¸­å†æ¬¡æ‰§è¡Œä»»åŠ¡(runAnyTime)çš„æ–¹æ³•.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- (void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event &#123;</span><br><span class="line">    </span><br><span class="line">    // æ¨¡æ‹Ÿåœ¨æŒ‡å®šçº¿ç¨‹ä¸Šé¢å†æ¬¡æ‰§è¡Œæ–¹æ³•</span><br><span class="line">    SEL seltor = NSSelectorFromString(@&quot;runAnyTime&quot;);</span><br><span class="line">    [self performSelector:seltor onThread:[self permanentThread] withObject:nil waitUntilDone:NO];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)runAnyTime &#123;</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;veryitman--runAnyTime. Current Thread: %@&quot;, [NSThread currentThread]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹åº”ä¸Šé¢çš„ <code>asyncRun</code> å®ç°å³å¯, ä½ ä¼šå‘ç°åœ¨å½“å‰é¡µé¢æ¯æ¬¡ç‚¹å‡»å±å¹•éƒ½ä¼šæ‰§è¡Œ <code>runAnyTime</code>.</p><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p>ä»£ç çš„å®Œæ•´å®ç°</p><blockquote><p>å¸¸é©»çº¿ç¨‹, å¯ä»¥å‚è€ƒå…·ä½“çš„æ³¨é‡Š.</p></blockquote><p><strong>MZCreatePermanentThreadController.m</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">@implementation MZCreatePermanentThreadController</span><br><span class="line"></span><br><span class="line">- (void)dealloc &#123;</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;veryitman---MZCreatePermanentThreadController dealloc.&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    </span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    self.view.backgroundColor = [UIColor lightGrayColor];</span><br><span class="line">    self.navigationItem.title = @&quot;åˆ›å»ºå¸¸é©»çº¿ç¨‹&quot;;</span><br><span class="line">    </span><br><span class="line">    // å¯åŠ¨çº¿ç¨‹</span><br><span class="line">    [self permanentThread];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewDidDisappear:(BOOL)animated &#123;</span><br><span class="line">    </span><br><span class="line">    [super viewDidDisappear:animated];</span><br><span class="line">    </span><br><span class="line">    // å–æ¶ˆçº¿ç¨‹</span><br><span class="line">    // å®é™…ä¸šåŠ¡åœºæ™¯ä¸­è‡ªè¡Œå†³å®š canCancel çš„è®¾ç½®, è¿™é‡Œåªæ˜¯ç¤ºä¾‹</span><br><span class="line">    BOOL canCancel = YES;</span><br><span class="line">    if (canCancel) &#123;</span><br><span class="line">        [[self permanentThread] cancel];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event &#123;</span><br><span class="line">    </span><br><span class="line">    // æ¨¡æ‹Ÿåœ¨æŒ‡å®šçº¿ç¨‹ä¸Šé¢å†æ¬¡æ‰§è¡Œæ–¹æ³•</span><br><span class="line">    SEL seltor = NSSelectorFromString(@&quot;runAnyTime&quot;);</span><br><span class="line">    </span><br><span class="line">    [self performSelector:seltor onThread:[self permanentThread] withObject:nil waitUntilDone:NO];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (NSThread *)permanentThread &#123;</span><br><span class="line">    </span><br><span class="line">    static NSThread *thread = nil;</span><br><span class="line">    static dispatch_once_t onceToken;</span><br><span class="line">    dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line"></span><br><span class="line">        thread = [[NSThread alloc] initWithTarget:self selector:@selector(asyncRun) object:nil];</span><br><span class="line">        [thread setName:@&quot;veryitman-thread&quot;];</span><br><span class="line">        </span><br><span class="line">        // åŒä¸€ä¸ªçº¿ç¨‹è¿ç»­å¤šæ¬¡ start ä¼šå¯¼è‡´ crash</span><br><span class="line">        [thread start];</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    return thread;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)asyncRun &#123;</span><br><span class="line">    </span><br><span class="line">    @autoreleasepool &#123;</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;veryitman--asyncRun. Current Thread: %@&quot;, [NSThread currentThread]);</span><br><span class="line">        </span><br><span class="line">        NSRunLoop *runLoop = [NSRunLoop currentRunLoop];</span><br><span class="line">        </span><br><span class="line">        // æ·»åŠ  source</span><br><span class="line">        NSPort *port = [NSMachPort port];</span><br><span class="line">        [runLoop addPort:port forMode:NSRunLoopCommonModes];</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;veryitman--asyncRun. Current RunLoop: %@&quot;, runLoop);</span><br><span class="line">        </span><br><span class="line">        // æ‰§è¡Œå…¶ä»–é€»è¾‘</span><br><span class="line">        //...</span><br><span class="line">        </span><br><span class="line">        // æ‰‹åŠ¨å¼€å¯ RunLoop</span><br><span class="line">        [runLoop run];</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;veryitman--asyncRun. End Run.&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)runAnyTime &#123;</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;veryitman--runAnyTime. Current Thread: %@&quot;, [NSThread currentThread]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p><a href="https://developer.apple.com/library/content/documentation/General/Conceptual/CocoaEncyclopedia/Toll-FreeBridgin/Toll-FreeBridgin.html">Toll-Free Bridging</a></p><p><a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/Multithreading/RunLoopManagement/RunLoopManagement.html">Run Loops</a></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RunLoop å¸¸é©»çº¿ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‘äººå‘˜éœ€å…·å¤‡ä¸€ç‚¹äº§å“èƒ½åŠ›</title>
      <link href="/2018/04/17/%E5%8F%91%E4%BA%BA%E5%91%98%E9%9C%80%E5%85%B7%E5%A4%87%E4%B8%80%E7%82%B9%E4%BA%A7%E5%93%81%E8%83%BD%E5%8A%9B/"/>
      <url>/2018/04/17/%E5%8F%91%E4%BA%BA%E5%91%98%E9%9C%80%E5%85%B7%E5%A4%87%E4%B8%80%E7%82%B9%E4%BA%A7%E5%93%81%E8%83%BD%E5%8A%9B/</url>
      
        <content type="html"><![CDATA[<p><img src="/upload/images/2018/04/17/12332.jpg"></p><p>ä¸ºäº†å¼€å§‹ä»Šå¤©çš„è¯é¢˜, æˆ‘å…ˆæ¥å€ŸåŠ©å‡ ä¸ªè§’è‰², æ¨¡æ‹Ÿä¸€ä¸‹å·¥ä½œä¸­çš„æŸäº›åœºæ™¯.</p><h2 id="è®¾ç«‹äººç‰©"><a href="#è®¾ç«‹äººç‰©" class="headerlink" title="è®¾ç«‹äººç‰©"></a>è®¾ç«‹äººç‰©</h2><p>å° A æ˜¯ååˆšå…¥é—¨çš„æŠ€æœ¯äººå‘˜, æ¯”è¾ƒå¬è¯.<br>å° B æ˜¯æœ‰å·¥ä½œç»éªŒçš„ä¸€åæŠ€æœ¯äººå‘˜, å¹³æ—¶å–œæ¬¢çœ‹çœ‹äº§å“ç›¸å…³çš„ä¹¦ç±, å–œæ¬¢å’Œäº§å“ç»ç†æ’•é€¼.<br>å° C å°±å‰å®³äº†, ä¸ä»…æŠ€æœ¯å‰å®³, ä¹Ÿå…·æœ‰äº§å“æ€ç»´, é™¤äº†é˜…è¯»äº§å“ç±»çš„ä¹¦ç±, è¿˜å†™äº§å“ä½“éªŒæŠ¥å‘Šå’Œä½“éªŒç«å“(å’Œå½“å‰è‡ªå·±äº§å“ç›¸å…³çš„äº§å“).<br>å° D å°±æ˜¯ä¸€åäº§å“ç»ç†, å…·æœ‰ä¸€å®šçš„äº§å“èƒ½åŠ›, æ•°æ®åˆ†æèƒ½åŠ›å’Œç®¡ç†èƒ½åŠ›.</p><p>äººç‰©å·²ç»è®¾ç«‹å¥½äº†, ç°åœ¨è®©ä»–ä»¬ç™»åœº.</p><h2 id="æƒ…æ™¯å†ç°-éœ€æ±‚è¯„å®¡"><a href="#æƒ…æ™¯å†ç°-éœ€æ±‚è¯„å®¡" class="headerlink" title="æƒ…æ™¯å†ç°: éœ€æ±‚è¯„å®¡"></a>æƒ…æ™¯å†ç°: éœ€æ±‚è¯„å®¡</h2><p>è¿™å¤©é£å’Œæ—¥ä¸½, å° D(äº§å“ç»ç†) é€šçŸ¥é¡¹ç›®ç»„çš„æ‰€æœ‰æˆå‘˜, åŒ…æ‹¬è®¾è®¡&#x2F;å¼€å‘&#x2F;è¿è¥&#x2F;æµ‹è¯•ç­‰äººå‘˜æŒ‰æ—¶å‚åŠ äº§å“éœ€æ±‚è¯„å®¡ä¼šè®®.</p><p>ä¸ºäº†ç¼“è§£å¤§å®¶çš„æƒ…ç»ª, å° D ä¹°äº†å¾ˆå¤šé›¶é£Ÿå’Œæ°´æœ, ä¹Ÿç®—æ˜¯çŠ’åŠ³ä¸€ä¸‹å¤§å®¶. å° D å¼€å§‹ç»™å¤§å®¶è®²éœ€æ±‚äº†, åƒå¾€å¸¸ä¸€æ ·, æ‹¿å‡ºç²¾æ¹›çš„åŸå‹, å£æ²«ç›´é£çš„å‘å¤§å®¶å±•ç¤ºå…¶ç»µç»µä¸ç»çš„å£æ‰å’Œäº§å“æ€ç»´. å° A ä¸€ç›´åœ¨ç‚¹å¤´, ä¹Ÿä¸çŸ¥é“åˆ°åº•æœ‰æ²¡æœ‰å¬æ‡‚å° D åœ¨è¯´ä»€ä¹ˆ, åæ­£æˆ‘çœ‹åˆ°æœ‰éƒ¨åˆ†è®¾è®¡äººå‘˜å·²ç»å¼€å§‹æ‰“çŒç¡äº†.</p><p>çªç„¶, å° C ä¸­æ–­äº†æ­£åœ¨å£è¿°çš„å° D, å° D ä¸æ…Œä¸å¿™çš„åœæ­¢äº†æ‰‹ä¸­çš„ä¸€åˆ‡åŠ¨ä½œ, èšç²¾ä¼šç¥çš„å¬å° C çš„æ„è§å’Œå»ºè®®. å° C ä¹Ÿæœ‰æ¡ä¸ç´Šçš„å°†åˆšæ‰çš„æŸé¡¹éœ€æ±‚å£è¿°äº†ä¸€é, æŒ‰ç…§å° C çš„é€»è¾‘, ç›®å‰çš„éœ€æ±‚è¿˜æ˜¯å­˜åœ¨ä¸€äº›æ¼æ´çš„, è¿™ä¸ªæ—¶å€™, å° D å¼€å§‹è®¤çœŸçš„è·Ÿå° C å¼€å§‹äº¤æµ, ä½†æ˜¯æ²¡æœ‰é©¬ä¸Šè‚¯å®šå° C, åªæ˜¯è¯´æˆ‘æš‚æ—¶è®°ä¸‹è¿™ä¸ªç‚¹, å›å¤´åœ¨æ€è€ƒä¸€ç•ª. äº§å“å° D ç¨³å¦‚è€ç‹—, ç»§ç»­è‡ªå·±çš„è¡¨æ¼”.</p><p>äº§å“éœ€æ±‚åŸºæœ¬å·²ç»è®²å®Œäº†, ç°åœ¨æ˜¯å¤§å®¶æé—®é¢˜å’Œäº¤æµçš„æ—¶é—´, æˆ‘çœ‹åˆ°æœ‰äº›åŒäº‹æ‰äº†æ‰çœ¼ç›, åƒæ˜¯å¦‚æ¢¦åˆé†’èˆ¬çš„çœ‹ç€äº§å“å° D, ä¸æ˜¯æ—è¾¹çš„åŒäº‹æ‹‰ä½ Ta, ä¼°è®¡éƒ½èƒ½å†²å‡ºä¼šè®®å®¤. å° B ä¹Ÿä¸æ·¡å®šäº†, æå‡ºäº†ä¸å°‘é—®é¢˜, å¹¶ä»æŠ€æœ¯çš„è§’åº¦è¯´æ˜äº†å®ç°çš„éš¾åº¦. äº§å“ç»ç†å¬çš„ä¹Ÿæ˜¯ä¸€è„¸æ‡µé€¼, å¿ƒç†æƒ³: â€œä½ å®ç°æ˜¯å¦æœ‰å›°éš¾ç®¡æˆ‘é¸Ÿäº‹?â€.</p><p>å° B åœ¨äº§å“å° D é‚£é‡Œå¹¶æ²¡æœ‰å¾—åˆ°åº”æœ‰çš„è¡¨æ‰¬å’Œé¼“åŠ±, åé­åˆ°åŒäº‹å° C çš„é„™è§†, å° C è¯´, ä½ å…ˆä¸è¦å‘Šè¯‰ä»–å®ç°æ–¹æ¡ˆ, å…ˆè®¨è®ºè¿™ä¸ªéœ€æ±‚çš„åœºæ™¯å’ŒçœŸä¼ªåº¦. å° D é»˜é»˜çš„å¯¹å° C æŠ•è¿‡èµèµçš„ç›®å…‰. ç´§æ¥ç€æµ‹è¯•å’Œå…¶ä»–äººå‘˜æå‡ºäº†å‡ ä¸ªä¸ç—›ä¸ç—’çš„é—®é¢˜, éƒ½è¢«è€ç»ƒçš„å° D ä¸€ä¸€ç ´è§£, é‚£æ°”åŠ¿, å•§å•§! åŠ¿å¦‚ç ´ç«¹!</p><p>éœ€æ±‚è¯„å®¡ä¼šè®®å°±è¿™æ ·ç»“æŸäº†.</p><h2 id="æƒ…æ™¯å†ç°-éœ€æ±‚å˜æ›´"><a href="#æƒ…æ™¯å†ç°-éœ€æ±‚å˜æ›´" class="headerlink" title="æƒ…æ™¯å†ç°: éœ€æ±‚å˜æ›´"></a>æƒ…æ™¯å†ç°: éœ€æ±‚å˜æ›´</h2><p>åœ¨äº§å“è¿›å…¥å¼€å‘å’Œè®¾è®¡é˜¶æ®µ, æŒ‰ç†è¯´éœ€æ±‚å˜æ›´ä¹Ÿç®—æ˜¯æ¯”è¾ƒæ­£å¸¸çš„ä¸€ä»¶äº‹æƒ….</p><p>è¿™å¹´å¤´, å”¯ä¸€ä¸å˜çš„å°±æ˜¯å˜åŒ–.</p><p>å° B æ­£åœ¨èšç²¾ä¼šç¥çš„å†™ä»£ç , çªç„¶å° D è·Ÿä»–è¯´, è¿™ä¸ªåœ°æ–¹çš„éœ€æ±‚éœ€è¦ä¿®æ”¹ä¸€ä¸‹, ä½ çœ‹æ”¹åŠ¨æœ‰å¤šå¤§?</p><p>å° B é„™è§†çš„çœ‹ç€äº§å“ç»ç†å° D, å¿ƒç†åœ¨è¯´æ”¹åŠ¨æœ‰å¤šå¤§ä½ å¿ƒé‡Œè¿˜æ²¡æœ‰ç‚¹ Bæ•°å˜›. å° B è¿˜æ˜¯æ§åˆ¶äº†è‡ªå·±çš„æƒ…ç»ª, æ¥ç€è¯´é“, ä½ å½“åˆåº”è¯¥å¥½å¥½æ€è€ƒçš„, ä½ çœ‹æˆ‘éƒ½å¿«åšå®Œäº†, ä½ æ‰å‘Šè¯‰æˆ‘éœ€è¦æ”¹åŠ¨.</p><p>å™¼é‡Œå•ªå•¦çš„è¯´å®Œ, ä¼°è®¡å° B å¿ƒç†ä¹Ÿæš—çˆ½äº†ä¸å°‘, æœ€ç»ˆè¿˜æ˜¯æ¥å—äº†è¿™æ¬¡çš„å˜åŠ¨.</p><p>å° A è´Ÿè´£çš„æ¨¡å—, ä¹Ÿè¢«äº§å“ç»ç†ä¿®æ”¹è¿‡, Ta å’Œäº§å“ç»ç†å° D çš„äº¤æµåŸºæœ¬æ˜¯, å“¦, æ©, å¥½, å¯ä»¥!</p><p>å½“å° C æ‰¾åˆ°å° D çš„æ—¶å€™, å¹¶æ²¡æœ‰ç›´æ¥å‘Šè¯‰å° D éœ€è¦æ”¹ä¸œæ”¹è¥¿, è€Œæ˜¯é—®é—®å° D, ä½ çœ‹è¿™æ ·ä¼šä¸ä¼šæ›´å¥½ä¸€äº›?</p><p>å° C å½“ç„¶æ˜ç™½å° D çš„ç›®çš„äº†, äºæ˜¯æ‹¿å‡ºè‡ªå·±çœ‹è¿‡çš„ç«å“, å¹¶è¯´å‡ºäº†è‡ªå·±çš„æ„è§, æ„‰å¿«çš„å’Œå° D äº¤æµå, å±…ç„¶ TMD çš„ç äº†ä¸€ä¸ªéœ€æ±‚. è¿™è®©æ—è¾¹çš„å° A å’Œå° B ç¾¡æ…•ä¸å·².</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä¸Šé¢çš„ä¸¤ç§æƒ…æ™¯, æˆ‘ç›¸ä¿¡åšè¿‡å¼€å‘çš„åŒäº‹åº”è¯¥éƒ½æ·±æœ‰ä½“ä¼š, ä½†æ˜¯åƒä¸‡ä¸è¦å¯¹å·å…¥åº§, æˆ‘åªæ˜¯æ‰“ä¸ªæ¯”æ–¹.</p><p>ä»ä¸Šé¢çœ‹å‡º, å° C æ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„è§’è‰², æ— è®ºæ˜¯æ€ç»´è¿˜æ˜¯æ²Ÿé€šèƒ½åŠ›éƒ½æœ‰åˆ«ä¸ä»–äºº, æœ€é‡è¦çš„æ˜¯ä»–æ²¡æœ‰ä»…ä»…æŠŠè‡ªå·±å½“åšä¸€åå¼€å‘äººå‘˜, è€Œæ˜¯ç«™åœ¨äº§å“çš„è§’åº¦å»æ€è€ƒé—®é¢˜å’Œè§£å†³é—®é¢˜.</p><p>éœ€æ±‚å˜æ›´æ˜¯å¸¸æ€, ä½œä¸ºå¼€å‘äººå‘˜, è¦æœ€å¤§é™åº¦çš„ç»™äº§å“ä»¥æ”¯æŒ. äº§å“ç»ç†ä¹Ÿæ˜¯äºº, å½“ç„¶æœ‰è€ƒè™‘ä¸å‘¨çš„åœ°æ–¹, å¦‚æœä½ ä¸èƒ½æƒ³å‡ºæ›´å¥½æ›´å®Œç¾çš„è§£å†³æ–¹æ¡ˆ, è¯·æ”¯æŒä»–çš„å†³å®š.</p><p>å¤šç«™åœ¨åˆ«äººçš„è§’åº¦å»æ€è€ƒé—®é¢˜, æ¢ä½æ€è€ƒ, æ‰èƒ½ä¿è¯æœ‰æ•ˆçš„æ²Ÿé€š. ä½œä¸ºä¸€åæŠ€æœ¯äººå‘˜, å°¤å…¶æ˜¯åœ¨äº’è”ç½‘è¡Œä¸š, å¤šå¤šå°‘å°‘éƒ½åº”è¯¥éœ€è¦å…·å¤‡ä¸€å®šçš„äº§å“æ€ç»´.</p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æŠ€æœ¯ ç”Ÿæ´» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸è®© SIGPIPE signal å¤ªåš£å¼ </title>
      <link href="/2018/04/15/%E4%B8%8D%E8%AE%A9-SIGPIPE-signal-%E5%A4%AA%E5%9A%A3%E5%BC%A0/"/>
      <url>/2018/04/15/%E4%B8%8D%E8%AE%A9-SIGPIPE-signal-%E5%A4%AA%E5%9A%A3%E5%BC%A0/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><h2 id="èµ·å› "><a href="#èµ·å› " class="headerlink" title="èµ·å› "></a>èµ·å› </h2><p>ç”±äºé¡¹ç›®è¿­ä»£æ¯”è¾ƒå¿«, å¤§å®¶è¿˜æ²¡æœ‰æ¥å¾—åŠåšè‡ªæˆ‘è°ƒæ•´å’Œæ€»ç»“, å°±éœ€è¦æŠ•å…¥åˆ°æ–°ç‰ˆæœ¬å½“ä¸­å¼€å‘æ–°åŠŸèƒ½äº†.</p><p>åœ¨æœ€è¿‘çš„ä¸€æ¬¡ç‰ˆæœ¬æµ‹è¯•å’Œä½“éªŒè¿‡ç¨‹ä¸­, å¾ˆå¤šå†…æµ‹ç”¨æˆ·åé¦ˆè¿›å…¥æˆ–è€…é€€å‡º App çš„èŠå¤©å®¤, ä¼šè«åå…¶å¦™çš„å´©æºƒæ‰(Crash).<br>å¯¹äº Crash çš„é—®é¢˜, æˆ‘ä»¬å¼€å‘åŒäº‹ç»å¯¹æ˜¯é›¶å®¹å¿, äºæ˜¯å°±å¼€å§‹è·Ÿè¸ªé—®é¢˜.</p><p>è·Ÿè¸ªäº†å¾ˆä¹…, å‘ç°è¿™ä¸ª Crash å¹¶ä¸æ˜¯é‚£ä¹ˆçš„ â€˜ä¹–å·§â€™, å¾ˆéš¾å¤ç°!<br>æ—¢ç„¶ç”¨æˆ·å·²ç»åé¦ˆäº†å¹¶ä¸”åå°ä¹Ÿæœ‰ Crash ä¸ŠæŠ¥, è¿™ä¸ªé—®é¢˜è‚¯å®šå­˜åœ¨, æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½æ”¾å¼ƒ.</p><p>å¥½å§, ç»§ç»­åŠ ç­æâ€¦è‹¦é€¼ä¸­â€¦</p><p>æœ€ç»ˆ, æˆ‘ä»¬å‘ç°ä¸€ä¸ªè§„å¾‹, åœ¨æ—¥å¿—åå°, çœ‹åˆ°å¾ˆå¤šç±»ä¼¼ä¸‹é¢çš„æ—¥å¿—:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Signal <span class="number">13</span> was raised. SIGPIPE (_mh_execute_header + <span class="number">420728</span>)</span><br></pre></td></tr></table></figure><p>å¾ˆé—æ†¾çš„æ˜¯, å †æ ˆä¿¡æ¯ä¸­æ²¡æœ‰æä¾›ç»™æˆ‘ä»¬æ›´æœ‰åŠ›çš„è¯æ®, æ‰€ä»¥å½“æ—¶å®šä½åœ¨ <code>Signal 13</code> è¿™ä¸ªç‚¹ä¸Šé¢.</p><p>ä¹Ÿç®—æ˜¯æœ‰äº†çªç ´â€¦è¿™ç­æ²¡æœ‰ç™½åŠ â€¦</p><h2 id="æ’æŸ¥é—®é¢˜"><a href="#æ’æŸ¥é—®é¢˜" class="headerlink" title="æ’æŸ¥é—®é¢˜"></a>æ’æŸ¥é—®é¢˜</h2><p>æ—¢ç„¶æ‰€æœ‰çš„ç½ªè¯éƒ½æŒ‡å‘äº† <code>Signal 13</code>, æˆ‘ä»¬å°±éœ€è¦å»è·Ÿè¸ªå®ƒ, å»è°ƒæŸ¥å®ƒ, å»ç ”ç©¶å®ƒ.</p><p>åœ¨ <code>signal.h</code> æ–‡ä»¶ä¸­, å¯ä»¥å‘ç°å…¶å®šä¹‰å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* write on a pipe with no one to read it */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>SIGPIPE13</span></span><br></pre></td></tr></table></figure><p>ç”¨é€šä¿—çš„è¯æ¥è®², å°±æ˜¯ç®¡é“ç ´è£‚.</p><blockquote><p>ç®¡é“ç ´è£‚ï¼Œè¿™ä¸ªä¿¡å·é€šå¸¸åœ¨è¿›ç¨‹é—´é€šä¿¡äº§ç”Ÿï¼Œæ¯”å¦‚é‡‡ç”¨ FIFO(ç®¡é“)é€šä¿¡çš„ä¸¤ä¸ªè¿›ç¨‹ï¼Œè¯»ç®¡é“æ²¡æ‰“å¼€æˆ–è€…æ„å¤–ç»ˆæ­¢å°±å¾€ç®¡é“å†™ï¼Œå†™è¿›ç¨‹ä¼šæ”¶åˆ° SIGPIPE ä¿¡å·.<br>æ­¤å¤–ç”¨ Socket é€šä¿¡çš„ä¸¤ä¸ªè¿›ç¨‹ï¼Œå†™è¿›ç¨‹åœ¨å†™ Socket çš„æ—¶å€™ï¼Œè¯»è¿›ç¨‹å·²ç»ç»ˆæ­¢.<br>å¦å¤–, åœ¨ send&#x2F;write æ—¶ä¼šå¼•èµ·ç®¡é“ç ´è£‚ï¼Œå…³é—­ Socket, ç®¡é“æ—¶ä¹Ÿä¼šå‡ºç°ç®¡é“ç ´è£‚.<br>ä½¿ç”¨ Socket ä¸€èˆ¬éƒ½ä¼šæ”¶åˆ°è¿™ä¸ª SIGPIPE ä¿¡å·.</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´, è¯¥ä¿¡å·æ˜¯è·Ÿ Socket çš„è¿æ¥ä»¥åŠæ•°æ®çš„è¯»å†™ç›¸å…³è”çš„.</p><p>è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å°±çŸ¥é“ä¸ºä»€ä¹ˆè¿›é€€æˆ¿é—´å¯¼è‡´ Crash äº†ï¼Œæˆ‘ä»¬çš„è¿›é€€æˆ¿é—´éƒ½å’Œ Socket æœ‰å…³è”ï¼Œè¿™ç§ Crash å¤§éƒ½æ•°æ˜¯åœ¨ç”¨æˆ·ç½‘ç»œä¸å¥½çš„æƒ…å†µä¸‹å‘ç”Ÿçš„.</p><h2 id="è§£å†³é—®é¢˜"><a href="#è§£å†³é—®é¢˜" class="headerlink" title="è§£å†³é—®é¢˜"></a>è§£å†³é—®é¢˜</h2><p>ç±»ä¼¼ <code>signal 13</code> è¿™ç§é”™è¯¯æ˜¯ç³»ç»Ÿå‘å‡ºæ¥çš„, å’Œå†…å­˜ä½¿ç”¨å¼‚å¸¸å’Œé‡æŒ‡é’ˆä¸€æ ·ï¼Œç”±äºæ˜¯ç³»ç»Ÿçº§åˆ«å´©æºƒï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@try</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@catch</span>(<span class="built_in">NSException</span> *exception) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ•è·åˆ°è¿™ç±»å¼‚å¸¸.</p><p>å› æ­¤, <code>try catch</code> æ˜¯æ— æ³•è§£å†³é—®é¢˜çš„.</p><p>ç›®å‰æœ‰ä¸¤ä¸ªæ–¹æ¡ˆå¯ç”¨:</p><blockquote><p>æ–¹æ¡ˆ1. å¿½ç•¥è¿™ç±»ä¿¡å·.</p></blockquote><blockquote><p>æ–¹æ¡ˆ2. ä¿®æ”¹æºç , åœ¨ IM ä»£ç é‡Œé¢ä¿®æ”¹.</p></blockquote><p>å› ä¸º, IMSDK æˆ‘ä»¬æ˜¯ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„, æ‰€ä»¥æ— æ³•æ›´æ”¹å…¶æºç , æ‰€ä»¥é‡‡å–äº†æ–¹æ¡ˆ1: å¿½ç•¥è¿™ç±»ä¿¡å·.</p><p>å¿½ç•¥çš„æ–¹æ¡ˆå¾ˆç®€å•, åœ¨ä½ è¿æ¥æˆ–è€…åˆå§‹åŒ– IMSDK ä¹‹å‰, åªéœ€è¦ä¸€è¡Œä»£ç :</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">signal(SIGPIPE, SIG_IGN);</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ä»£ç :</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions </span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">signal(SIGPIPE, SIG_IGN);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äº <code>æ–¹æ¡ˆ2</code>, æˆ‘æŸ¥é˜…äº†ä¸€ä¸‹ <code>CocoaAsyncSocket</code> çš„æºç :</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Prevent SIGPIPE signals</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">int</span> nosigpipe = <span class="number">1</span>;</span><br><span class="line">setsockopt(socketFD, SOL_SOCKET, SO_NOSIGPIPE, &amp;nosigpipe, <span class="keyword">sizeof</span>(nosigpipe));</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥å¯¹äº <code>æ–¹æ¡ˆ2</code>, å°±æ˜¯å¢åŠ ä¸Šé¢çš„ä»£ç å³å¯, å³è®¾ç½® Socket ä¸å‘é€ SIGPIPE ä¿¡å·.</p><p>å¯¹äºä¸Šé¢çš„ä¸¤ç§æ–¹æ¡ˆ, è‹¹æœå¼€å‘è€…æ–‡æ¡£ <a href="https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/NetworkingOverview/CommonPitfalls/CommonPitfalls.html">Avoiding Common Networking Mistakes</a> éƒ½æœ‰æåŠ.</p><p><img src="/upload/images/2018/04/15/1.jpg" alt="-w380"></p><h2 id="é—®é¢˜å¤ç°"><a href="#é—®é¢˜å¤ç°" class="headerlink" title="é—®é¢˜å¤ç°"></a>é—®é¢˜å¤ç°</h2><p>æ—¢ç„¶è¿™ä¸ªé—®é¢˜å¾ˆéš¾å¤ç°, æˆ‘ä»¬å°±æƒ³åŠæ³•è®©ä»–å¾ˆå®¹æ˜“å¤ç°.</p><p>å¯ä»¥é‡‡ç”¨æ‰‹åŠ¨å‘é€ signal çš„æ–¹å¼, æ¥å¤ç°è¿™ä¸ªé—®é¢˜.</p><p>å…ˆçœ‹ä¸€ä¸‹ <a href="https://linux.die.net/man/3/kill">kill(3) - Linux man page</a> å‡½æ•°:</p><blockquote><p>The kill() function shall send a signal to a process or a group of processes specified by pid. The signal to be sent is specified by sig and is either one from the list given in &lt;signal.h&gt; or 0. If sig is 0 (the null signal), error checking is performed but no signal is actually sent. The null signal can be used to check the validity of pid.</p></blockquote><p>kill å‡½æ•°æ˜¯å¯ç§»æ¤æ“ä½œç³»ç»Ÿæ¥å£ POSIX(Portable Operating System Interface of UNIX) å®šä¹‰çš„, å¯ä»¥å‚è€ƒ <a href="https://zh.wikipedia.org/wiki/POSIX">ç»´åŸºç™¾ç§‘</a>.</p><p>ç¤ºä¾‹ä»£ç :</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//è·å–è¿›ç¨‹ id</span></span><br><span class="line">    pid_t cur_pid = getpid();</span><br><span class="line">    printf(<span class="string">&quot;current process&#x27;s id: %i\n&quot;</span>, cur_pid);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//å»¶æ—¶10s ä¸ºäº†è®© Bugtags æœ‰æ—¶é—´ä¸ŠæŠ¥æ—¥å¿—.</span></span><br><span class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(<span class="number">10</span> * <span class="built_in">NSEC_PER_SEC</span>)), dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        </span><br><span class="line">        wpcSendSignal(cur_pid);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">///æ‰‹åŠ¨å‘é€ä¿¡å·</span></span><br><span class="line"><span class="keyword">int</span> wpcSendSignal(<span class="keyword">int</span> pid)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = kill(pid, SIGPIPE);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å°† <code>signal(SIGPIPE, SIG_IGN)</code> ä»£ç å…ˆæ³¨é‡Š.</p><p>è¿è¡Œ APP åˆ°æ‰‹æœº, ç„¶åé€€å‡º Xcode çš„è¿æ¥.</p><blockquote><p>æ³¨æ„: è¿™é‡Œå¦‚æœè¿æ¥ Xcode, ä¸ä¼šç›´æ¥ Crash, æ‰€ä»¥éœ€è¦æ–­å¼€æ‰‹æœºä¸ Xcode çš„è¿æ¥.</p></blockquote><p>åœ¨åå°å¯ä»¥çœ‹åˆ°ç±»ä¼¼çš„ Crash æ—¥å¿—:</p><p><img src="/upload/images/2018/04/15/2.jpg" alt="-w500"></p><p>é™¤äº†ä¸Šé¢ä½¿ç”¨ <code>kill</code> å‡½æ•°å¤–, æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ <code>raise</code> å‡½æ•°æ¥å‘é€ signal.</p><p>å…³äº raise å‡½æ•°, å¯ä»¥æŸ¥é˜… <a href="https://linux.die.net/man/3/raise">æ‰‹å†Œ</a>.</p><p>æˆ–è€…ç›´æ¥é—®ç”·äºº(man):</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">man raise</span><br></pre></td></tr></table></figure><h2 id="é—®é¢˜å†æ¬¡æ¥ä¸´-ä¸-Bugtags-çš„ç»“åˆ"><a href="#é—®é¢˜å†æ¬¡æ¥ä¸´-ä¸-Bugtags-çš„ç»“åˆ" class="headerlink" title="é—®é¢˜å†æ¬¡æ¥ä¸´: ä¸ Bugtags çš„ç»“åˆ"></a>é—®é¢˜å†æ¬¡æ¥ä¸´: ä¸ Bugtags çš„ç»“åˆ</h2><p>æœ¬ä»¥ä¸ºé‡‡ç”¨ä¸Šè¿°æ–¹æ¡ˆå°±ä¸‡äº‹å¤§å‰äº†, åœ¨ç¬¬äºŒæ¬¡ææµ‹å, è¿˜æ˜¯æœ‰è¿™ç§ Crash çš„é—®é¢˜åœ¨åå°ä¸ŠæŠ¥.</p><p>æ’æŸ¥äº†å¾ˆä¹…åæ‰å‘ç°ï¼Œé—®é¢˜çš„åŸå› æ˜¯ BugTags ä¹Ÿä¼šæ§åˆ¶è¿™ä¸ªå¼€å¤´ï¼Œé»˜è®¤æ˜¯ä¸å¿½ç•¥ï¼Œè¿™æ ·ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ˜¯å¦å¿½ç•¥ PIPE Signal (SIGPIPE) é—ªé€€ï¼Œé»˜è®¤ NO</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">BOOL</span> ignorePIPESignalCrash;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé»˜è®¤è®¾ç½®ä¸º NO, å³å¯ä»¥ä¸ŠæŠ¥ PIPE Signal Crash çš„é—®é¢˜.</p><p>è¿™é‡Œä¹Ÿè¯´æ˜ä¸€ä¸ªé—®é¢˜, å³ä½¿æˆ‘ä»¬é‡‡ç”¨ <code>æ–¹æ¡ˆ1</code> è§£å†³ Crash çš„é—®é¢˜äº†, Bugtags è¿˜æ˜¯ä¼šå°†è¿™ç§ Crash ä¸ŠæŠ¥åˆ°åå°.</p><p>ç¤ºä¾‹ä»£ç :</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">bugtag.option.ignorePIPESignalCrash = <span class="literal">YES</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">signal(SIGPIPE, SIG_IGN);</span><br></pre></td></tr></table></figure><p>å¯¹æ¯”ä¸€ä¸‹æµ‹è¯•çš„ä¸¤å¼ å›¾, ç¬¬ä¸€å¼ å›¾åˆ°ç¬¬äºŒå¼ å›¾æ˜¯å¢åŠ äº†ä¸¤æ¬¡å´©æºƒæ¬¡æ•°, åŸå› æ˜¯æ•…æ„è®¾ç½®äº† <code>bugtag.option.ignorePIPESignalCrash = NO</code>, ä¹Ÿæ­£å¥½éªŒè¯äº†æˆ‘ä»¬çš„æƒ³æ³•.</p><p><img src="/upload/images/2018/04/15/3.jpg" alt="-w600"><br><img src="/upload/images/2018/04/15/4.jpg" alt="-w600"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol><li><p>Xcode è¿æ¥çœŸæœºæˆ–è€…æ¨¡æ‹Ÿå™¨, è¿è¡Œå‡ºç°å¼‚å¸¸æ–­ç‚¹, å¯èƒ½å°±æ˜¯éšæ‚£ç‚¹.</p></li><li><p>å­¦ä¼šä½¿ç”¨åå°æ—¥å¿—æ‰¾åˆ°è§„å¾‹, ç»§è€Œå»æ€è€ƒå¹¶è§£å†³é—®é¢˜.</p></li><li><p>å¯¹ Crash è¿›è¡Œæ›´æ·±å…¥çš„åˆ†æå’Œæ€»ç»“, ä¸è¦è½»æ˜“æ”¾å¼ƒ.</p></li></ol><h2 id="åç»­ç ”ç©¶"><a href="#åç»­ç ”ç©¶" class="headerlink" title="åç»­ç ”ç©¶"></a>åç»­ç ”ç©¶</h2><ol><li><p>æ˜¯å¦å¯ä»¥å¿½ç•¥å…¶ä»–çš„ signal, æ¥é¿å…ä¸å¿…è¦çš„ Crash?</p></li><li><p>è‡ªå®šä¹‰ä¸€å¥—å…³äº signal æ•è·çš„è·¨å¹³å°åº“, åœ¨å¼€å‘é˜¶æ®µå¯ä»¥ç›´æ¥çœ‹åˆ°å®Œæ•´çš„æ—¥å¿—.</p></li></ol><h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><ol><li><p><a href="https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/NetworkingOverview/CommonPitfalls/CommonPitfalls.html">Avoiding Common Networking Mistakes</a></p></li><li><p><a href="https://linux.die.net/">linux die</a></p></li><li><p><a href="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/NetworkingTopics/Articles/UsingSocketsandSocketStreams.html#//apple_ref/doc/uid/CH73-SW1">Using Sockets and Socket Streams</a></p></li></ol><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Crash linux signal SIGPIPE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿™æ ·å­¦ä¹ ä½ æ„¿æ„å—?</title>
      <link href="/2018/04/07/%E8%BF%99%E6%A0%B7%E5%AD%A6%E4%B9%A0%E4%BD%A0%E6%84%BF%E6%84%8F%E5%90%97/"/>
      <url>/2018/04/07/%E8%BF%99%E6%A0%B7%E5%AD%A6%E4%B9%A0%E4%BD%A0%E6%84%BF%E6%84%8F%E5%90%97/</url>
      
        <content type="html"><![CDATA[<p><img src="/upload/images/2018/04/07/1.jpg"></p><p>ä¸å¾—ä¸æ‰¿è®¤, å­¦ä¹ ç¡®å®æ˜¯ä¸ªã€Œè‹¦å·®äº‹ã€, è¿™é‡Œè¯´çš„å­¦ä¹ ä¸ä»…ä»…æŒ‡ä¼æ¡ˆå­¦ä¹ , ä¹‹ä¹è€…ä¹Ÿç­‰, è€Œæ˜¯ä¸€ç§å¹¿æ³›çš„å­¦ä¹ .</p><p>å¦‚ä½•å­¦ä¹ æ˜¯å§‹ç»ˆè¦å»æ¢è®¨çš„ä¸€ä¸ªè¯é¢˜, æ—¶ä»£åœ¨å˜, ç¯å¢ƒåœ¨å˜, å­¦ä¹ å½“ç„¶ä¹Ÿä¸èƒ½ä¸€æˆä¸å˜. åšæŒå­¦ä¹ æ˜¯ä¸€è¾ˆå­çš„äº‹, æ´»åˆ°è€å­¦åˆ°è€.</p><p>æ—¢ç„¶å­¦ä¹ æ˜¯ä¸€ä¸ªæ¼«é•¿çš„é©¬æ‹‰æ¾, é‚£æˆ‘ä»¬åªæœ‰æŒä¹‹ä»¥æ’çš„â€™è·‘â€™ä¸‹å», æ‰èƒ½ä¿æŒä¸æ‰é˜Ÿ. è¿™æ ·ä¸€æ¥, å­¦ä¹ æ–¹æ³•å’Œå­¦ä¹ æŠ€å·§å°±æ˜¯å–èƒœçš„å…³é”®äº†.</p><p>ä¸–ä¸Šæ²¡æœ‰ç»å¯¹çš„å­¦ä¹ å¦™æ‹›å’Œå­¦ä¹ å®å…¸, æ‰¾åˆ°é€‚åˆè‡ªå·±çš„å°±æ˜¯æœ€å¥½çš„. ä¸‹é¢æˆ‘ç»“åˆè‡ªå·±çš„ä¸€äº›ç»å†ç»™å¤§å®¶åˆ†äº«åœ¨å­¦ä¹ çš„é“è·¯ä¸Šé‡åˆ°çš„é‚£äº›äº‹.</p><blockquote><p>ä¸ç®¡æ€æ ·, å­¦ä¹ ä¸€å®šè¦å¸¦ç€ç›®æ ‡, ç»“åˆç†è®ºå†å»å®è·µ, äº‹åŠåŠŸå€.</p></blockquote><hr><p>æ¬¢è¿å¤§å®¶åœ¨è¯„è®ºåŒºäº¤æµ, ä¸å–œå‹¿å–·~ </p><h2 id="å›å¿†å½“å¤©äº‹"><a href="#å›å¿†å½“å¤©äº‹" class="headerlink" title="å›å¿†å½“å¤©äº‹"></a>å›å¿†å½“å¤©äº‹</h2><p>æ¯æ™šèººåœ¨åºŠä¸Šæˆ–è€…æ²™å‘ä¸Š, å‘å‘å‘†, æŠŠå½“å¤©åšè¿‡çš„äº‹æƒ…, åœ¨è„‘æµ·ä¸­ç»Ÿç»Ÿçš„è¿‡ä¸€é, åƒæ”¾ç”µå½±ä¸€æ ·, èƒ½æœ‰å¤šè¯¦ç»†å°±å¤šè¯¦ç»†, ä¹Ÿå°±æ˜¯è¯´å°½é‡çš„å›å¿†ç»†èŠ‚.</p><p>è¿™ç§åšæ³•çœ‹ä¼¼å¾ˆç®€å•, å…¶å®å¾ˆéš¾åšæŒä¸‹å». ç‰¹åˆ«æ˜¯ä¸­é—´å‡ å¤©, å¾ˆå¤šäººéƒ½ä¼šæ”¾å¼ƒ, å†åŠ ä¸Šç°åœ¨æ‰‹æœºäº’è”ç½‘çš„ â€œæ¯’å®³â€, ç•™ç»™è‡ªå·±å»çœŸæ­£å­¦ä¹ çš„æ—¶é—´æ›´å°‘äº†. ä½†æ˜¯åªè¦ä½ å’¬å’¬ç‰™åšæŒä¸€ä¸‹, æŠŠè¿™ä¸ªä¹ æƒ¯å…»æˆ, å°±ä¼šç»ˆç”Ÿå—ç”¨.</p><p>æˆ‘åœ¨åˆä¸­æ—¶æœŸå·²ç»å…»æˆäº†è¿™ä¸ªä¹ æƒ¯, ç›´åˆ°å¤§å­¦éƒ½æ²¡æœ‰æ”¾å¼ƒ. å¤§å­¦é‡Œé¢æ¯æ¬¡æœŸæœ«è€ƒè¯•, çœ‹åˆ°å¾ˆå¤šäººå¿™çš„ä¸å¯å¼€äº¤, æˆ‘éƒ½æ˜¯ä¸æ…Œä¸å¿™çš„, æ‚ é—²è‡ªå¾—, å®¤å‹é—®æˆ‘æ€ä¹ˆåšåˆ°æ¸¸åˆƒæœ‰ä½™, æˆ‘è¯´ä½ ç™½å¤©å°‘ç¡ç‚¹è§‰, å¹³æ—¶æ³¨æ„å¬è®², æ™šä¸Šå›å¿†ä¸€ä¸‹å°±å¯ä»¥äº†, ä»ä»–è¿·èŒ«çš„çœ¼ç¥ä¸­å¯ä»¥çœ‹å‡º, ä»–å½“æ—¶å¹¶ä¸å®Œå…¨ç›¸ä¿¡æˆ‘è¯´çš„!</p><p>æ¯æ¬¡å›å¿†ç»“æŸ, æœ‰äº›ä¸œè¥¿è¿˜æ˜¯æ¯”è¾ƒæ¨¡ç³Šç”šè‡³ä¸€çŸ¥åŠè§£, æ²¡äº‹, ä½ ç¬¬äºŒå¤©å»ç¿»é˜…ç›¸å…³çŸ¥è¯†å†å»æ•´ç†å’Œç†è§£ä¸€ä¸‹å°±å¥½äº†, è¿™ç§è‡ªæˆ‘æ¿€åŠ±æ¯”ä»»ä½•é­ç­–éƒ½æœ‰ç”¨.</p><blockquote><p>æœ‰äº›å›°éš¾åªæ˜¯æš‚æ—¶çš„, æƒ³åŠæ³• â€˜æŒºâ€™ è¿‡å», ä½ å°±èµ¢äº†. å¾ˆå¤šæ—¶å€™ä¸æ˜¯å›°éš¾å“åˆ°äº†æˆ‘ä»¬, è€Œæ˜¯æˆ‘ä»¬æ”¾å¼ƒäº†è‡ªå·±.</p></blockquote><h2 id="å¤šæƒ³å¤šé—®"><a href="#å¤šæƒ³å¤šé—®" class="headerlink" title="å¤šæƒ³å¤šé—®"></a>å¤šæƒ³å¤šé—®</h2><p>å’Œä½ èº«è¾¹å…´è¶£ç›¸æŠ•æˆ–è€…æ¯”ä½ æœ‰èƒ½åŠ›çš„äººå¤šäº¤æµ, äº¤æµçš„è¿‡ç¨‹ä¹Ÿæ˜¯ä½ ç»ƒä¹ è‡ªæˆ‘è¡¨è¾¾èƒ½åŠ›çš„è¿‡ç¨‹, æŠŠè‡ªå·±çš„é—®é¢˜èƒ½å¤Ÿæ¸…æ¥šçš„æè¿°ç»™åˆ«äººå¬, ä¹Ÿæ˜¯ä¸€ç§èƒ½åŠ›.</p><p>ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰è¿™æ ·ä¸€ç§æ„Ÿè§‰, åœ¨è·Ÿåˆ«äººäº¤æµçš„è¿‡ç¨‹ä¸­, è™½ç„¶åˆ«äººæ²¡æœ‰ç›´æ¥å¸®ä½ è§£å†³é—®é¢˜, ä½†æ˜¯ä½ çªç„¶æœ‰äº†è§£å†³é—®é¢˜çš„åŠæ³•. ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢? å¾ˆç®€å•, å› ä¸ºè¿™ä¸ªé—®é¢˜ä½ ä¹‹å‰æ€è€ƒè¿‡, åªæ˜¯åœ¨äº¤æµçš„è¿‡ç¨‹ä¸­, ä½ çš„å¤§è„‘ä¸“æ³¨åœ¨æ­¤, èšç²¾ä¼šç¥çš„åœ¨æƒ³è¿™ä»¶äº‹æƒ….</p><p>é—®é—®é¢˜æœ‰ä¸€å¥—é—¨é“. åœ¨è¯·æ•™åˆ«äººé—®é¢˜ä¹‹å‰, æœ€å¥½è‡ªå·±å…ˆå°½åŠ›æƒ³ä¸€æƒ³, ä¸è¦é‡åˆ°ä¸€ç‚¹é—®é¢˜å°±å»é—®ä¸œé—®è¥¿, å³ä½¿åˆ«äººç»™ä½ è®²äº†, ä½ ä¹Ÿåªæ˜¯å½“æ—¶æ˜ç™½äº†, ä¸‹æ¬¡å†é‡åˆ°æ­¤ç±»é—®é¢˜, ä½ ä¾ç„¶æ‡µé€¼. è¿˜æœ‰å°±æ˜¯ä¼šè®©ä½ å½¢æˆä¸€ç§ä¾èµ–å¿ƒç†, åæ­£æœ‰äººèƒ½è§£å†³, æˆ‘é—®å°±å¯ä»¥äº†, å¹²å˜›è¿˜æœ‰è´¹æ—¶è´¹åŠ›çš„å»æƒ³?! ä¹…è€Œä¹…ä¹‹, å°±ç ´ç½å­ç ´æ‘”äº†.</p><p>å¦å¤–ä¸€ä¸ªè¦è¯´çš„å°±æ˜¯åœ¨è¯·æ•™æˆ–è€…äº¤æµé—®é¢˜çš„æ—¶å€™, è¦å¯¹å¯¹æ–¹è°¦è™š.</p><p>æˆ‘å¾ˆæ„Ÿæ¿€é«˜ä¸­æ—¶ä»£, ç­ä¸»ä»»å¾ˆä¿¡ä»»æˆ‘, è®©æˆ‘å½“äº†ä¸‰å¹´ç­é•¿, é‚£ä¸‰å¹´è®©æˆ‘å­¦åˆ°äº†å¾ˆå¤šä¹¦æœ¬ä¹‹å¤–çš„ä¸œè¥¿, å…¶ä¸­æ²Ÿé€šå’Œç®¡ç†è®©æˆ‘åœ¨ä»Šåçš„å·¥ä½œä¸­å—ç›ŠåŒªæµ…. </p><h2 id="é˜…è¯»å’Œå†™ä½œ"><a href="#é˜…è¯»å’Œå†™ä½œ" class="headerlink" title="é˜…è¯»å’Œå†™ä½œ"></a>é˜…è¯»å’Œå†™ä½œ</h2><blockquote><p>è¿™é‡Œè¯´çš„å†™ä½œä¸æ˜¯æŒ‡ä¸“ä¸šçš„ä½œå®¶çº§çš„å†™ä½œ, æ³›æŒ‡ä»»ä½•æ–‡å­—çš„è®°å½•, æ—¥è®°ä¹Ÿç®—.</p></blockquote><p>æ¯å¤©æœ€å¹¸ç¦çš„æ—¶åˆ»å°±æ˜¯åœ¨ 23:00 ç‚¹ä¹‹å‰ååœ¨ç”µè„‘å‰, å¯ä»¥å†™è‡ªå·±å¿ƒä¸­è¦è¡¨è¾¾çš„å†…å®¹, ä»»æ€ç»ªé£˜æ‘‡.</p><p>åªè¦æœ‰é—²æš‡çš„æ—¶é—´, æˆ‘å°±ä¼šæ•´ç†å’Œæ€»ç»“è¿™æ®µæ—¶é—´å‘ç”Ÿçš„äº‹æƒ…, æ—¢æœ‰å·¥ä½œä¸Šçš„ä¹Ÿæœ‰ç”Ÿæ´»ä¸Šçš„.</p><p>å°çš„æ—¶å€™, å®¶é‡Œæ¯”è¾ƒç©·, äº¤å­¦è´¹éƒ½æ˜¯é—®é¢˜, æ›´åˆ«è¯´æ˜¯ä¹°ä¹¦äº†. æˆ‘è®°å¾—åˆä¸­ä¸€å¹´çº§, æˆ‘å¾ˆæƒ³è¦ä¸€æœ¬è‹±è¯­ä¹¦ç±, é‚£ç§æ¸´æœ›è‡³ä»Šéš¾å¿˜! åæ¥, æˆ‘æ¯å¤©ä»è‡ªå·±çš„ç”Ÿæ´»è´¹é‡ŒæŠ å‡ºä¸€ç‚¹é’±(ç”Ÿæ´»è´¹æœ¬æ¥å°±å°‘), å°±è¿™æ ·ç§¯æ”’äº†å‡ ä¸ªæ˜ŸæœŸ, å»æ–°åä¹¦åº—ä¹°äº†ä¸€æœ¬è‹±è¯­ä¹¦ç±. é«˜ä¸­æ—¶æœŸ, æœ‰åŒå­¦ä¸è¦çš„æˆ–è€…å·²ç»ä¸è¯»çš„ä¹¦ç±, æˆ‘éƒ½ä¼šå€Ÿè¿‡æ¥çœ‹, æ²‰æµ¸åœ¨è‡ªå·±çš„å¹¸ç¦å½“ä¸­.</p><p>å‚åŠ å·¥ä½œä¹‹å, æˆ‘ä¹Ÿæœ‰å†™åšå®¢çš„ä¹ æƒ¯, æŠŠè‡ªå·±å·¥ä½œä¸­é‡åˆ°çš„é—®é¢˜ä»¥åŠè§£å†³é—®é¢˜çš„æ€è·¯å’Œæ–¹å¼å†™å‡ºæ¥, åˆ†äº«ç»™å…¶ä»–äºº, å¿«ä¹æ— æ¯”. ç‰¹åˆ«æ˜¯æ”¶åˆ°æ–‡ç« çš„è¯„è®ºå, å¿ƒç†ç¾æ»‹æ»‹çš„. åœ¨äº’è”ç½‘çš„æµ·æ´‹é‡Œ, å¤§å®¶ç´ ä¸ç›¸è¯†, é€šè¿‡é”®ç›˜ä¸Šæ•²å‡»çš„æ–‡å­—äº’ç›¸äº¤æµçŸ¥è¯†å’Œæƒ³æ³•, å½¼æ­¤æˆé•¿ç€, ä¹Ÿåˆ«å…·ä¸€ç•ªä¹è¶£.</p><p>é˜…è¯»å’Œå†™ä½œå¯ä»¥åŸ¹å…»è‡ªå·±çš„ä¸“æ³¨åŠ›, è¿™ä¹ˆå¥½çš„ä¹ æƒ¯ä½ åƒä¸‡ä¸è¦æ‹’ç». å†™ä½œå¯ä»¥å€’é€¼ç€ä½ å»é˜…è¯», å»å…³å¿ƒç”Ÿæ´»é‡Œé¢çš„ç‚¹æ»´, é˜…è¯»å’Œç”Ÿæ´»ä¸­çš„ä½“éªŒåˆå¯ä»¥æ¿€å‘ä½ å†™ä½œçš„æ¬²æœ›, ä¸¤è€…ç›¸è¾…ç›¸æˆ.</p><p>æ¨èç»™å¤§å®¶ä¸€æœ¬ä¹¦: <strong>Google å·¥ä½œæ•´ç†æœ¯</strong></p><p><img src="/upload/images/2018/04/07/2.png" alt="-w200"></p><blockquote><p>è°·æ­Œå‰CIOï¼ˆé¦–å¸­ä¿¡æ¯å®˜ï¼‰åˆ†äº«é£é¡è°·æ­Œçš„ä¿¡æ¯æ•´ç†æœ¯ï¼Œå¸®åŠ©ç°ä»£äººå½»åº•å‘Šåˆ«æ— åºå·¥ä½œï¼Œå­¦ä¼šåˆ©ç”¨æ•°å­—å·¥å…·ä¸ºå¤§è„‘å‡å‹ï¼ä¿¡æ¯å¤ªå¤šã€æ—¶é—´å¤ªå°‘ï¼Œæ•´ç†ä¿¡æ¯å·²æˆä¸ºç°ä»£äººæ€¥éœ€æŒæ¡çš„å¿…å¤‡æŠ€èƒ½ã€‚è°·æ­Œä½œä¸ºå¼•é¢†å…¨çƒçš„ä¿¡æ¯æœç´¢ä¸æ•´åˆå·¨å¤´ï¼Œæ‹¥æœ‰èƒ½å¤Ÿæœ‰åºæ•´ç†ä¿¡æ¯çš„ç‹¬ç‰¹æ–¹å¼ï¼Œè€Œè°·æ­Œé¦–å¸­ä¿¡æ¯å®˜ä¾¿æ˜¯ä¸»å¯¼è¿™ä¸€â€œä¿¡æ¯å·¥å‚â€çš„æ€»å·¥ç¨‹å¸ˆã€‚å¦‚ä»Šï¼Œæ›¾æ‹…ä»»â€œæ€»å·¥ç¨‹å¸ˆâ€çš„é“æ ¼æ‹‰æ–¯æ¢…é‡Œå°”äº²è‡ªå°†é£é¡è°·æ­Œçš„ä¿¡æ¯æ•´ç†æ–¹å¼åˆ†äº«ç»™å¤§ä¼—è¯»è€…ï¼Œå¸®åŠ©ç°ä»£äººå…‹æœæ— åºå·¥ä½œçš„é€šç—…ã€‚ã€ŠGoogleå·¥ä½œæ•´ç†æœ¯ã€‹å‘Šè¯‰ä½ ï¼šä¸è¦èŠ±å¤ªå¤šæ—¶é—´ç»™ä¿¡æ¯å½’æ¡£ï¼Œç”¨çš„æ—¶å€™å­¦ä¼šå»æœç´¢ï¼›åœ¨æ•°å­—ä¿¡æ¯æ–‡æ¡£ä¸­åŠ ä¸Šå…³é”®è¯ï¼Œæ–¹ä¾¿æ—¥åæ£€ç´¢ï¼›ä»å‰ï¼ŒçŸ¥è¯†å°±æ˜¯åŠ›é‡,ç°åœ¨ï¼Œå…±äº«çŸ¥è¯†æ‰æ˜¯åŠ›é‡ï¼›æŠŠå·¥ä½œå’Œç”Ÿæ´»èä¸ºä¸€ä½“ï¼Œè€Œä¸æ˜¯åŠ›å›¾åœ¨äºŒè€…ä¹‹é—´æ±‚å¹³è¡¡ã€‚è¿™äº›å®ç”¨ Tips éƒ½æ­ç¤ºäº†ï¼šä¿¡æ¯æ•´ç†æ‰æ˜¯é«˜æ•ˆå·¥ä½œçš„å…³é”®ï¼Œä¿¡æ¯æ•´ç†å·²æ˜¯ç°ä»£äººçš„å·¥ä½œå¿…å¤‡æŠ€èƒ½ï¼</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç”Ÿæ´» æ„Ÿæ‚Ÿ å­¦ä¹  é˜…è¯» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OC-RunTime: æ€»ç»“æ¶ˆæ¯è½¬å‘ä¸­ç”¨åˆ°çš„çŸ¥è¯†ç‚¹</title>
      <link href="/2018/04/05/OC-RunTime-%E6%80%BB%E7%BB%93%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B8%AD%E7%94%A8%E5%88%B0%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
      <url>/2018/04/05/OC-RunTime-%E6%80%BB%E7%BB%93%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B8%AD%E7%94%A8%E5%88%B0%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><a href="http://www.veryitman.com/2018/03/31/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹</a></p><p><a href="http://www.veryitman.com/2018/04/01/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B-%E5%AE%9E%E4%BE%8B%E8%AE%B2%E8%A7%A3/">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹å®ä¾‹è®²è§£</a></p><p><a href="http://www.veryitman.com/2018/04/03/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E7%B1%BB%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B/">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹ç±»æ–¹æ³•çš„è½¬å‘æµç¨‹</a></p><p>åœ¨ä¸Šé¢çš„å‡ ç¯‡æ–‡ç« ä¸­æˆ‘åˆ†äº«äº†å…³äºæ¶ˆæ¯è½¬å‘ç›¸å…³çš„çŸ¥è¯†ç‚¹ï¼Œé‡Œé¢æœ‰å¾ˆå¤šç»†èŠ‚æ²¡æœ‰é˜è¿°ã€‚</p><p>è‹¥åœ¨ä¸Šé¢çš„æ–‡ç« ä¸­åŠ å…¥å¾ˆå¤šç»†èŠ‚ç‚¹çš„è¯ï¼Œä¸€æ˜¯æ‹‰é•¿äº†æ–‡ç« çš„å†…å®¹, äºŒæ˜¯å¯¹äºåˆšæ¥è§¦ Runtime çš„æœ‹å‹æ¥è¯´ä¸ä¸€å®šèƒ½æ¥å—, äºæ˜¯å°±æœ‰äº†è¿™ç¯‡æ–‡ç« çš„è¯ç”Ÿ.</p><h2 id="RunTime-çš„å®šä¹‰åŠä½¿ç”¨åœºæ™¯"><a href="#RunTime-çš„å®šä¹‰åŠä½¿ç”¨åœºæ™¯" class="headerlink" title="RunTime çš„å®šä¹‰åŠä½¿ç”¨åœºæ™¯"></a>RunTime çš„å®šä¹‰åŠä½¿ç”¨åœºæ™¯</h2><p>è‹¹æœ <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Introduction/Introduction.html">å¼€å‘æ–‡æ¡£</a> çš„è¿™æ ·è§£é‡Š runtime çš„ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The Objective-C language defers as many decisions as it can from compile time and link time to runtime. Whenever possible, it does things dynamically. This means that the language requires not just a compiler, but also a runtime system to execute the compiled code. The runtime system acts as a kind of operating system for the Objective-C language; itâ€™s what makes the language work</span><br></pre></td></tr></table></figure><p>å°½é‡å°†å†³å®šæ”¾åˆ°è¿è¡Œçš„æ—¶å€™ï¼Œè€Œä¸æ˜¯åœ¨ç¼–è¯‘å’Œé“¾æ¥è¿‡ç¨‹ä¸­.</p><p>RunTime çš„åº”ç”¨åœºæ™¯:</p><blockquote><p>1.é¢å‘åˆ‡é¢ç¼–ç¨‹ AOP.<br>2.æ–¹æ³•è°ƒé… method swizzling. æœ‰äº›åœ°æ–¹ç§°ä¹‹ä¸ºâ€é»‘é­”æ³•â€.<br>3.æ¶ˆæ¯è½¬å‘.<br>4.ç»™åˆ†ç±»æ·»åŠ å±æ€§(å…³è”å¯¹è±¡).<br>5.åŠ¨æ€è·å– class å’Œ slector.<br>6.KVO&#x2F;KVC, ä¿®æ”¹ç§æœ‰å±æ€§çš„å€¼.</p></blockquote><p>å»ºè®®å»é˜…è¯»ä¸‹é¢æ¡†æ¶çš„æºç ï¼Œæ•æˆ‘æ²¡æœ‰åŠ å…¥é“¾æ¥:</p><blockquote><p>Aspectsï¼ˆAOPå¿…å¤‡ï¼Œâ€œå–ç¼”â€ baseVCï¼Œæ— ä¾µå…¥åŸ‹ç‚¹ï¼‰</p></blockquote><blockquote><p>MJExtensionï¼ˆJSON è½¬ modelï¼Œä¸€è¡Œä»£ç å®ç° NSCoding åè®®çš„è‡ªåŠ¨å½’æ¡£å’Œè§£æ¡£ï¼‰</p></blockquote><blockquote><p>JSPatchï¼ˆåŠ¨æ€ä¸‹å‘ JS è¿›è¡Œçƒ­ä¿®å¤ï¼‰</p></blockquote><blockquote><p>NullSafeï¼ˆé˜²æ­¢å› å‘ unrecognised messages ç»™ NSNull å¯¼è‡´çš„å´©æºƒï¼‰</p></blockquote><blockquote><p>UITableView-FDTemplateLayoutCellï¼ˆè‡ªåŠ¨è®¡ç®—å¹¶ç¼“å­˜ table view çš„ cell é«˜åº¦ï¼‰</p></blockquote><blockquote><p>UINavigationController+FDFullscreenPopGestureï¼ˆå…¨å±æ»‘åŠ¨è¿”å›ï¼‰</p></blockquote><h2 id="æ€è€ƒé—®é¢˜"><a href="#æ€è€ƒé—®é¢˜" class="headerlink" title="æ€è€ƒé—®é¢˜"></a>æ€è€ƒé—®é¢˜</h2><p>åœ¨å‰é¢çš„æ–‡ç« ä¸­ï¼Œå¾ˆå¤šæ¬¡çœ‹åˆ° IMPã€SELã€selector ä»¥åŠ Method ç­‰å…³é”®å­—ï¼Œç›¸ä¿¡å¤§å®¶éšç€å¯¹ RunTime çš„é€æ­¥äº†è§£ï¼Œæ…¢æ…¢ä¼šé€æ¸ç†Ÿæ‚‰å®ƒä»¬çš„ï¼Œåªæ˜¯æ—¶é—´é—®é¢˜ã€‚å¾ˆå¤šæ¦‚å¿µä¸Šé¢çš„ä¸œè¥¿ç†è§£èµ·æ¥æ²¡é‚£ä¹ˆç®€å•ï¼Œéœ€è¦åŠ¨æ‰‹å»å†™å†™ä»£ç ã€‚</p><p>åœ¨çœ‹ä¸‹é¢å†…å®¹ä¹‹å‰, å…ˆæŠ›å‡ºä¸€ä¸ªé—®é¢˜:</p><blockquote><p>runtime å¦‚ä½•é€šè¿‡ selector æ‰¾åˆ°å¯¹åº”çš„ IMP åœ°å€?</p></blockquote><p>æ¥ä¸‹æ¥åˆ†åˆ«è¯´ä¸€ä¸‹ IMPã€SELã€selector ä»¥åŠ Method.</p><h2 id="IMP"><a href="#IMP" class="headerlink" title="IMP"></a>IMP</h2><p>IMP ä¿å­˜çš„æ˜¯ Method çš„åœ°å€ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œç”±ç¼–è¯‘å™¨ç”Ÿæˆã€‚</p><p>IMP åœ¨ <code>objc.h</code> ä¸­çš„å®šä¹‰ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// A pointer to the function of a method implementation. </span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> !OBJC_OLD_DISPATCH_PROTOTYPES</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">void</span> (*IMP)(<span class="keyword">void</span> <span class="comment">/* id, SEL, ... */</span> ); </span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">id</span> (*IMP)(<span class="keyword">id</span>, SEL, ...); </span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>å‘å¯¹è±¡å‘é€æ¶ˆæ¯ä¹‹åï¼Œæ˜¯ç”±è¿™ä¸ªå‡½æ•°æŒ‡é’ˆ IMP æŒ‡å®šçš„, å³ IMP å‡½æ•°æŒ‡é’ˆå°±æŒ‡å‘äº†æ–¹æ³•çš„å®ç°.</p><p>IMP å‡½æ•°æŒ‡é’ˆæœ€å°‘åŒ…å« id å’Œ SEL ç±»å‹çš„ä¸¤ä¸ªå‚æ•°ï¼Œåé¢å…¶ä»–çš„å‚æ•°æ˜¯å¯¹åº”æ–¹æ³•éœ€è¦çš„å‚æ•°ã€‚å…¶ä¸­ id ä»£è¡¨æ‰§è¡Œè¯¥æ–¹æ³•çš„ target(å¯¹è±¡), SEL å°±æ˜¯å¯¹åº”çš„æ–¹æ³•, é€šè¿‡ id å’Œ SEL å‚æ•°å°±èƒ½ç¡®å®šå”¯ä¸€çš„æ–¹æ³•å®ç°åœ°å€.</p><p>é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è·å–æ–¹æ³•çš„ IMP å‘¢ï¼Ÿå¾ˆç®€å•.</p><p>NSObject æä¾›äº†å¦‚ä¸‹ä¸¤ä¸ªæ–¹æ³•:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (IMP)methodForSelector:(SEL)aSelector;</span><br><span class="line">+ (IMP)instanceMethodForSelector:(SEL)aSelector;</span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„å®ç°(æºç  NSObject.mm), å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">+ (IMP)instanceMethodForSelector:(SEL)sel &#123;</span><br><span class="line">    <span class="keyword">if</span> (!sel) [<span class="keyword">self</span> doesNotRecognizeSelector:sel];</span><br><span class="line">    <span class="keyword">return</span> class_getMethodImplementation(<span class="keyword">self</span>, sel);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (IMP)methodForSelector:(SEL)sel &#123;</span><br><span class="line">    <span class="keyword">if</span> (!sel) [<span class="keyword">self</span> doesNotRecognizeSelector:sel];</span><br><span class="line">    <span class="keyword">return</span> object_getMethodImplementation((<span class="keyword">id</span>)<span class="keyword">self</span>, sel);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (IMP)methodForSelector:(SEL)sel &#123;</span><br><span class="line">    <span class="keyword">if</span> (!sel) [<span class="keyword">self</span> doesNotRecognizeSelector:sel];</span><br><span class="line">    <span class="keyword">return</span> object_getMethodImplementation(<span class="keyword">self</span>, sel);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œå¯¹åº”çš„ <code>methodForSelector</code> æ—¢æœ‰å®ä¾‹æ–¹æ³•åˆæœ‰ç±»æ–¹æ³•ï¼Œè€Œ <code>instanceMethodForSelector</code> åªæœ‰ç±»æ–¹æ³•ã€‚</p><p>åœ¨ä½¿ç”¨ <code>methodForSelector</code> æ–¹æ³•æ—¶ï¼Œå‘ç±»å‘é€æ¶ˆæ¯ï¼Œåˆ™ SEL åº”è¯¥æ˜¯ç±»æ–¹æ³•, è‹¥å‘å®ä¾‹å¯¹è±¡å‘é€æ¶ˆæ¯ï¼Œåˆ™ SEL åº”è¯¥ä¸ºå®ä¾‹å¯¹è±¡æ–¹æ³•.</p><p>è€Œ <code>instanceMethodForSelector</code> ä»…ä»…å…è®¸ç±»å‘é€è¯¥æ¶ˆæ¯, ä»è€Œè·å–å®ä¾‹æ–¹æ³•çš„ IMP. è¯¥æ–¹æ³•æ— æ³•è·å–ç±»æ–¹æ³•çš„ IMP, å¦‚æœæƒ³è·å–ç±»æ–¹æ³•çš„ IMP å¯ä»¥ä½¿ç”¨ <code>methodForSelector</code> æ¥è·å–ã€‚</p><p>å‡½æ•°æ–‡æ¡£åŸæ–‡è§£é‡Šå¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Use this method to ask the class object for the implementation of instance methods only. </span><br><span class="line">To ask the class for the implementation of a class method, send the methodForSelector: instance method to the class instead.</span><br></pre></td></tr></table></figure><p>ä¸¾ä¸ªä¾‹å­ï¼Œæˆ–è®¸æ›´å¥½ç†è§£ã€‚</p><p>ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•, ä¸€ä¸ªæ˜¯ç±»æ–¹æ³•(testClassMethod), å¦ä¸€ä¸ªæ˜¯å®ä¾‹æ–¹æ³•(testInstanceMethod).</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="keyword">void</span>)testClassMethod &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)testInstanceMethod &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ†åˆ«ä½¿ç”¨ä¸Šé¢æåˆ°çš„æ–¹æ³•æ¥è·å– IMP çš„å‡ ä¸ªæ–¹æ³•.</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">IMP imp = [[<span class="keyword">self</span> <span class="keyword">class</span>] instanceMethodForSelector:<span class="keyword">@selector</span>(testClassMethod)];</span><br><span class="line">IMP imp2 = [[<span class="keyword">self</span> <span class="keyword">class</span>] instanceMethodForSelector:<span class="keyword">@selector</span>(testInstanceMethod)];</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¹Ÿå¯ä»¥æ”¹æˆ NSObject è°ƒç”¨çš„æ–¹å¼, ç»“æœä¸€æ ·.</span></span><br><span class="line"><span class="comment">// IMP imp = [NSObject instanceMethodForSelector:@selector(testClassMethod)];</span></span><br><span class="line"><span class="comment">// IMP imp2 = [NSObject instanceMethodForSelector:@selector(testInstanceMethod)];</span></span><br><span class="line">    </span><br><span class="line">IMP imp3 = [[<span class="keyword">self</span> <span class="keyword">class</span>] methodForSelector:<span class="keyword">@selector</span>(testClassMethod)];</span><br><span class="line">IMP imp4 = [<span class="keyword">self</span> methodForSelector:<span class="keyword">@selector</span>(testInstanceMethod)];</span><br></pre></td></tr></table></figure><p>è°ƒè¯•å™¨å¯ä»¥çœ‹å‡º, å¦‚ä¸‹æ—¥å¿—:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Printing description of imp:</span><br><span class="line">(IMP) imp = <span class="number">0x000000010d8455c0</span> (libobjc.A.dylib`_objc_msgForward)</span><br><span class="line"></span><br><span class="line">Printing description of imp2:</span><br><span class="line">(IMP) imp2 = <span class="number">0x000000010cf19b90</span> (-[ViewController testInstanceMethod] at ViewController.m:<span class="number">94</span>)</span><br><span class="line"></span><br><span class="line">Printing description of imp3:</span><br><span class="line">(IMP) imp3 = <span class="number">0x000000010cf19b60</span> (+[ViewController testClassMethod] at ViewController.m:<span class="number">89</span>)</span><br><span class="line"></span><br><span class="line">Printing description of imp4:</span><br><span class="line">(IMP) imp4 = <span class="number">0x000000010cf19b90</span> (-[ViewController testInstanceMethod] at ViewController.m:<span class="number">94</span>)</span><br><span class="line">(lldb) </span><br></pre></td></tr></table></figure><p>imp2ã€imp3ã€imp4 éƒ½æ˜¯æ­£å¸¸çš„ï¼Œå”¯ç‹¬ imp ä¸æ­£å¸¸ï¼Œä¹Ÿå……åˆ†è¯´æ˜äº† <code>instanceMethodForSelector</code> æ— æ³•è·å–ç±»æ–¹æ³•çš„ IMP.</p><h2 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h2><p>åœ¨æºç  <code>runtime.h</code> ä¸­, å®šä¹‰ method, å…¶æœ¬è´¨æ˜¯ä¸€ä¸ªç»“æ„ä½“.</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> objc_method &#123;</span><br><span class="line">    SEL method_name     OBJC2_UNAVAILABLE;</span><br><span class="line">    <span class="keyword">char</span> *method_types  OBJC2_UNAVAILABLE;</span><br><span class="line">    IMP method_imp      OBJC2_UNAVAILABLE;</span><br><span class="line">&#125;                                                            </span><br></pre></td></tr></table></figure><p>æ–¹æ³•å <code>method_name</code> ç±»å‹ä¸º SEL.</p><p><code>method_types</code> æ–¹æ³•ç±»å‹, æ˜¯ä¸€ä¸ª char æŒ‡é’ˆï¼Œå­˜å‚¨ç€æ–¹æ³•çš„å‚æ•°ç±»å‹å’Œè¿”å›å€¼ç±»å‹ã€‚</p><p>æ–¹æ³•å®ç° <code>method_imp</code> çš„ç±»å‹ä¸º IMP.</p><p>å¯ä»¥çœ‹å‡º, æœ‰ SEL å’Œ IMP, method_types æ˜¯å¯¹åº”çš„æ–¹æ³•è¿”å›å€¼å’Œå‚æ•°ç±»å‹, å¦‚ <code>v@:</code>ï¼Œæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p><p><code>runtime.h</code> ä¸­æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œå¯ä»¥æ ¹æ® SEL ç›´æ¥è·å–å®ä¾‹æ–¹æ³•å’Œç±»æ–¹æ³•çš„ Methodï¼Œå¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Method class_getInstanceMethod(Class cls, SEL name);</span><br><span class="line"></span><br><span class="line">Method class_getClassMethod(Class cls, SEL name);</span><br></pre></td></tr></table></figure><h2 id="SEL"><a href="#SEL" class="headerlink" title="SEL"></a>SEL</h2><p><code>selector</code>, ç§°ä¹‹ä¸ºæ–¹æ³•é€‰æ‹©å™¨ï¼ŒSEL æ˜¯ <code>selector</code> çš„è¡¨ç¤ºç±»å‹ï¼Œä¹Ÿæ˜¯æ–¹æ³•çš„ç¼–å·ï¼Œæ˜¯ç±»æˆå‘˜æ–¹æ³•çš„æŒ‡é’ˆã€‚</p><p>SEL å®šä¹‰åœ¨æºç  <code>objc.h</code> ä¸­, æ˜¯ä¸€ä¸ªç»“æ„ä½“æŒ‡é’ˆ, å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// An opaque type that represents a method selector.</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_selector *SEL;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æºç ä¸­æŸ¥ä¸åˆ° <code>objc_selector</code> å…·ä½“çš„å®šä¹‰å’Œå®ç°.</p><p>è·å– SEL æœ‰ä¸‰ä¸ªæ–¹æ³•:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SEL sel = <span class="keyword">@selector</span>(play:);</span><br><span class="line">SEL sel = sel_registerName(<span class="string">&quot;play:&quot;</span>); </span><br><span class="line">SEL sel = <span class="built_in">NSSelectorFromString</span>(<span class="string">@&quot;play&quot;</span>);</span><br></pre></td></tr></table></figure><p>SEL è¡¨ç¤ºä¸€ä¸ª selector çš„æŒ‡é’ˆï¼Œæ— è®ºä»€ä¹ˆç±»é‡Œï¼Œåªè¦æ–¹æ³•åç›¸åŒï¼ŒSEL å°±ç›¸åŒï¼ŒSEL å®é™…æ˜¯æ ¹æ®æ–¹æ³•å hash åŒ–äº†çš„å­—ç¬¦ä¸²ã€‚è€Œå¯¹äºå­—ç¬¦ä¸²çš„æ¯”è¾ƒä»…ä»…éœ€è¦æ¯”è¾ƒä»–ä»¬çš„åœ°å€å°±å¯ä»¥äº†ï¼Œæ‰€ä»¥é€Ÿåº¦ä¸Šéå¸¸å¿«ï¼ŒSEL çš„å­˜åœ¨åŠ å¿«äº†æŸ¥è¯¢æ–¹æ³•çš„é€Ÿåº¦ã€‚</p><blockquote><p>æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šä¸ºä»€ä¹ˆåœ¨åŒä¸€ä¸ª OC ç±»ä¸­ï¼Œä¸èƒ½å­˜åœ¨åŒåçš„å‡½æ•°ï¼Œå³ä½¿å‚æ•°ç±»å‹ä¸åŒä¹Ÿä¸è¡Œï¼Œæ¢å¥è¯è¯´ OCä¸ºä»€ä¹ˆæ²¡æœ‰é‡è½½ï¼Ÿ</p></blockquote><blockquote><p>ç­”æ¡ˆå·²ç»åœ¨ä¸Šé¢è¯´äº†ï¼ŒSEL è¡¨ç¤ºä¸€ä¸ª selector çš„æŒ‡é’ˆï¼Œæ— è®ºä»€ä¹ˆç±»é‡Œï¼Œåªè¦æ–¹æ³•åç›¸åŒï¼ŒSEL å°±ç›¸åŒï¼Œç›¸åŒçš„å‡½æ•°åï¼Œç¼–è¯‘å™¨æ— æ³•ç¼–è¯‘é€šè¿‡ã€‚</p></blockquote><p><code>dispatch table</code> å­˜æ”¾ SEL å’Œ IMP çš„å¯¹åº”å…³ç³»ï¼ŒSEL æœ€ç»ˆä¼šé€šè¿‡ <code>dispatch table</code> å¯»æ‰¾åˆ°å¯¹åº”çš„IMPã€‚</p><p>æ€»ä¹‹ï¼ŒSelectorã€Method å’Œ IMP ä¸‰è€…ä¹‹é—´çš„å…³ç³»å¯ä»¥è¿™ä¹ˆè§£é‡Šï¼Œåœ¨ç±»çš„(å®ä¾‹å’Œç±»æ–¹æ³•)è°ƒåº¦è¡¨(dispatch table)ä¸­çš„æ¯ä¸€ä¸ªå®ä½“ä»£è¡¨ä¸€ä¸ªæ–¹æ³• Methodï¼Œå…¶åå­—å«åšé€‰æ‹©å™¨ SELï¼Œå¹¶å¯¹åº”ç€ä¸€ç§æ–¹æ³•å®ç°ç§°ä¹‹ä¸º IMPï¼Œæœ‰äº† Method å°±å¯ä»¥ä½¿ç”¨ SEL æ‰¾åˆ°å¯¹åº”çš„ IMPï¼ŒSEL å°±æ˜¯ä¸ºäº†æŸ¥æ‰¾æ–¹æ³•çš„æœ€ç»ˆå®ç° IMPã€‚</p><h2 id="class-addMethod"><a href="#class-addMethod" class="headerlink" title="class_addMethod"></a>class_addMethod</h2><p>æŸ¥çœ‹æºç  <code>objc-runtime-new.mm</code> ä¸­è¯¥å‡½æ•°å®ç°å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">BOOL</span> class_addMethod(Class cls, SEL name, IMP imp, <span class="keyword">const</span> <span class="keyword">char</span> *types)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!cls) <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line"></span><br><span class="line">    rwlock_writer_t lock(runtimeLock);</span><br><span class="line">    <span class="keyword">return</span> ! addMethod(cls, name, imp, types ?: <span class="string">&quot;&quot;</span>, <span class="literal">NO</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼€å‘æ–‡æ¡£ä¸­è¿™æ ·æè¿°è¯¥å‡½æ•°:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Adds a new method to a <span class="keyword">class</span> with a given name and implementation.</span><br><span class="line">class_addMethod will add an override of a superclass<span class="string">&#x27;s implementation, </span></span><br><span class="line"><span class="string">but will not replace an existing implementation in this class. </span></span><br><span class="line"><span class="string">To change an existing implementation, use method_setImplementation.</span></span><br></pre></td></tr></table></figure><p>è§£é‡Šä¸€ä¸‹ï¼Œå¯ä»¥ä¸ºç±»æ ¹æ® SEL å’Œ IMP åŠ¨æ€æ·»åŠ ä¸€ä¸ªæ–°æ–¹æ³•ã€‚<code>class_addMethod</code> ä»…å¯ä»¥åŠ¨æ€æ·»åŠ æ–¹æ³•ï¼Œä¸ä¼šæ›¿æ¢ã€‚å¦‚æœæƒ³è¾¾åˆ°æ–¹æ³•æ›¿æ¢çš„æ•ˆæœå¯ä½¿ç”¨ <code>method_setImplementation</code> å‡½æ•°ã€‚</p><p>å…³äº <code>method_setImplementation</code> å’Œ <code>method_exchangeImplementations</code> åé¢æ–‡ç« å†åšåˆ†æ.</p><p>å…¶å®, <code>method_exchangeImplementations</code> çš„å†…éƒ¨å®ç°ç›¸å½“äºè°ƒç”¨äº† 2 æ¬¡ <code>method_setImplementation</code> æ–¹æ³•ã€‚</p><p><code>class_addMethod</code> ä¸ä»…å¯ä»¥åŠ¨æ€æ·»åŠ ç±»æ–¹æ³•, ä¹Ÿå¯ä»¥æ·»åŠ å®ä¾‹æ–¹æ³•ã€‚</p><p>å‚æ•°åŠè¿”å›å€¼è§£é‡Š:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">è¿”å›å€¼: è¿”å› <span class="literal">YES</span> è¡¨ç¤ºæ–¹æ³•æ·»åŠ æˆåŠŸ, å¦åˆ™æ·»åŠ å¤±è´¥ã€‚</span><br><span class="line"></span><br><span class="line">å‚æ•° Class cls: å°†è¦ç»™æ·»åŠ æ–¹æ³•çš„ç±», å³ï¼»ç±»å <span class="keyword">class</span>ï¼½</span><br><span class="line"></span><br><span class="line">å‚æ•° SEL name: å°†è¦æ·»åŠ çš„æ–¹æ³• SEL, å³ <span class="keyword">@selector</span>(æ–¹æ³•å)ï¼Œå¦‚æœå·²ç»å­˜åœ¨ï¼Œè¯¥æ–¹æ³•è¿”å›å¤±è´¥ï¼Œä¸å­˜åœ¨å°±æ·»åŠ æˆåŠŸã€‚</span><br><span class="line"></span><br><span class="line">å‚æ•° IMP impï¼šå®ç°è¿™ä¸ªæ–¹æ³•çš„å‡½æ•°. æœ‰ä¸¤ç§å†™æ³•å³ C å’Œ OC çš„å†™æ³•. ä¸€ä¸ª IMP æœ€å°‘åŒ…æ‹¬ä¸¤ä¸ªå‚æ•°, ä¸Šé¢å·²ç»è¯´è¿‡ã€‚</span><br><span class="line"></span><br><span class="line">å‚æ•° <span class="keyword">const</span> <span class="keyword">char</span> *types: å®ç°æ–¹æ³•çš„å‡½æ•°çš„è¿”å›å’Œå‚æ•°ç¼–ç ç±»å‹. å¦‚ <span class="string">&quot;v@:&quot;</span> è¡¨ç¤ºè¿”å›å€¼ä¸º <span class="keyword">void</span>, æ²¡æœ‰å‚æ•°çš„ä¸€ä¸ªå‡½æ•°, å…¶ä¸­ @å’Œ:åˆ†åˆ«ä»£è¡¨ IMP çš„é»˜è®¤ä¸¤ä¸ªå‚æ•°å³ <span class="keyword">id</span> å’Œ sel.</span><br></pre></td></tr></table></figure><p>å…³äº typesï¼Œå¯ä»¥ä½¿ç”¨ <code>method_getTypeEncoding</code> æ¥è·å–ã€‚</p><p>æ›´å¤šå…³äº types çš„å†…å®¹å¯ä»¥å‚è€ƒå¼€å‘è€…æ–‡æ¡£ <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtTypeEncodings.html#//apple_ref/doc/uid/TP40008048-CH100-SW1">Type Encodings</a>.</p><h2 id="è§£ç­”é—®é¢˜"><a href="#è§£ç­”é—®é¢˜" class="headerlink" title="è§£ç­”é—®é¢˜"></a>è§£ç­”é—®é¢˜</h2><p>è¯»åˆ°è¿™é‡Œ, å¤§å®¶å¯¹ IMP, SEL ä»¥åŠ Method åº”è¯¥æœ‰åˆæ­¥çš„äº†è§£äº†, é‚£ä¹ˆæ¥è§£ç­”ä¸€ä¸‹åˆšæ‰æå‡ºçš„é—®é¢˜:</p><blockquote><p>runtime å¦‚ä½•é€šè¿‡ selector æ‰¾åˆ°å¯¹åº”çš„ IMP åœ°å€?</p></blockquote><p>å›ç­”è¿™ä¸ªé—®é¢˜çš„å…³é”®æ˜¯è¦çŸ¥é“æ¶ˆæ¯è°ƒåº¦è¡¨(dispatch table)ï¼Œå¦å¤–ä¸€ä¸ªè¦å›ç­”çš„è¦ç‚¹æ˜¯ IMP çš„å®ç°å’Œè·å–ä»¥åŠå’Œ Method ä¹‹é—´çš„å…³ç³»ã€‚</p><p>ç±»å¯¹è±¡ä¸­æœ‰ç±»æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•çš„åˆ†å‘è¡¨ï¼Œè¡¨ä¸­è®°å½•ç€æ–¹æ³•çš„åå­—ã€å‚æ•°å’Œå®ç°ï¼Œselector æœ¬è´¨å°±æ˜¯æ–¹æ³•åç§°ï¼Œruntime é€šè¿‡è¿™ä¸ªæ–¹æ³•åç§°å°±å¯ä»¥åœ¨åˆ—è¡¨ä¸­æ‰¾åˆ°è¯¥æ–¹æ³•å¯¹åº”çš„å®ç°.</p><p>ç³»ç»Ÿä¸ºæˆ‘ä»¬æä¾›äº†è·å– IMP æŒ‡é’ˆçš„å‡½æ•°ï¼Œæ— è®ºæ˜¯ç±»æ–¹æ³•è¿˜æ˜¯å®ä¾‹æ–¹æ³•æˆ‘ä»¬éƒ½å¯ä»¥è·å–å¯¹åº”çš„ IMP.</p><p>è€Œ Method å°† Selector å’Œ IMP è”ç³»èµ·æ¥ï¼Œå¯ä»æºç ä¸­çœ‹å‡º:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> objc_method &#123;</span><br><span class="line">    SEL method_name     OBJC2_UNAVAILABLE;</span><br><span class="line">    <span class="keyword">char</span> *method_types  OBJC2_UNAVAILABLE;</span><br><span class="line">    IMP method_imp      OBJC2_UNAVAILABLE;</span><br><span class="line">&#125;                                                            </span><br></pre></td></tr></table></figure><p>IMP æ˜¯å‡½æ•°çš„æŒ‡é’ˆï¼Œå®ƒæ˜¯ç”±ç¼–è¯‘å™¨ç¼–è¯‘ç”Ÿæˆçš„ã€‚å½“å‘ä¸€ä¸ªæ¶ˆæ¯æ—¶ï¼Œå®ƒä¼šæ‰¾åˆ°é‚£æ®µä»£ç æ‰§è¡Œï¼ŒIMP æŒ‡å‘äº†è¿™ä¸ªæ–¹æ³•çš„å…·ä½“çš„å®ç°ï¼Œå¾—åˆ°è¿™ä¸ªå‡½æ•°çš„æŒ‡é’ˆå¯ä»¥ç›´æ¥æ‰§è¡Œã€‚</p><p>IMP æŒ‡å‘çš„æ–¹æ³•ä¸ <code>objc_msgSend</code> å‡½æ•°ç±»å‹ç›¸åŒï¼Œå‚æ•°éƒ½åŒ…å« id å’Œ SEL ç±»å‹ã€‚æ¯ä¸ªæ–¹æ³•åéƒ½å¯¹åº”ä¸€ä¸ª SEL ç±»å‹çš„æ–¹æ³•é€‰æ‹©å™¨ï¼Œè€Œæ¯ä¸ªå®ä¾‹å¯¹è±¡ä¸­çš„ SEL å¯¹åº”çš„æ–¹æ³•å®ç°è‚¯å®šæ˜¯å”¯ä¸€çš„ï¼Œé€šè¿‡ä¸€ç»„ id å’Œ SEL å‚æ•°å°±èƒ½ç¡®å®šå”¯ä¸€çš„æ–¹æ³•å®ç°åœ°å€ï¼Œåä¹‹äº¦ç„¶ã€‚å½“å‘é€æ¶ˆæ¯ç»™ä¸€ä¸ªå¯¹è±¡æ—¶ï¼ŒrunTime ä¼šåœ¨å¯¹è±¡çš„ç±»å¯¹è±¡æ–¹æ³•åˆ—è¡¨é‡ŒæŸ¥æ‰¾ï¼Œå½“æˆ‘ä»¬å‘é€ä¸€ä¸ªæ¶ˆæ¯ç»™ä¸€ä¸ªç±»æ—¶ï¼Œè¿™æ¡æ¶ˆæ¯ä¼šåœ¨ç±»çš„ <code>Meta Class</code> å¯¹è±¡çš„æ–¹æ³•åˆ—è¡¨é‡ŒæŸ¥æ‰¾ï¼Œç›´åˆ°è¶…æ‰¾åˆ° NSObject ä¸­ä¸ºæ­¢ã€‚</p><p><strong>æ¶ˆæ¯ä¼ é€’çš„è¿‡ç¨‹</strong></p><p><strong>1.</strong> å½“æ¶ˆæ¯è¢«å‘é€ç»™ä¸€ä¸ªå¯¹è±¡ï¼Œmessaging function è·Ÿéšå¯¹è±¡çš„ isa æŒ‡é’ˆæ‰¾åˆ°å®ƒçš„ class structureï¼Œåœ¨ dispatch table ä¸­å¯»æ‰¾ method selector.</p><p><strong>2.</strong> å¦‚æœæ²¡æœ‰æ‰¾åˆ° selectorï¼Œobjc_msgsend è·Ÿéšè¯¥ç±»å®ä¾‹çš„ isa æ‰¾åˆ°çˆ¶ç±»ï¼Œå°è¯•åœ¨çˆ¶ç±»çš„ dispatch table ä¸­å¯»æ‰¾ selector.</p><p><strong>3.</strong> é‡å¤æ­¥éª¤ <strong>2</strong>ï¼Œç›´åˆ° isa æŒ‡å‘ NSObject Class ä¸ºæ­¢ã€‚</p><p>å…³äºåˆ†å‘è¡¨å’Œæ¶ˆæ¯ç›¸å…³çš„çŸ¥è¯†å¯ä»¥å‚è€ƒå¼€å‘æ–‡æ¡£ <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtHowMessagingWorks.html">Messaging</a>ï¼Œè®²å¾—å¾ˆæ¸…æ¥šã€‚</p><h2 id="å®é™…ä¾‹å­"><a href="#å®é™…ä¾‹å­" class="headerlink" title="å®é™…ä¾‹å­"></a>å®é™…ä¾‹å­</h2><p>è¯´äº†è¿™ä¹ˆå¤šç†è®ºçŸ¥è¯†ï¼Œæ˜¯æ—¶å€™ä¸¾æ —å­äº†ï¼Œæ–¹ä¾¿å¤§å®¶æ›´å¥½çš„ç†è§£ä¸Šé¢çš„å†…å®¹ã€‚</p><h3 id="1-åŠ¨æ€æ·»åŠ å®ä¾‹æ–¹æ³•"><a href="#1-åŠ¨æ€æ·»åŠ å®ä¾‹æ–¹æ³•" class="headerlink" title="1. åŠ¨æ€æ·»åŠ å®ä¾‹æ–¹æ³•"></a>1. åŠ¨æ€æ·»åŠ å®ä¾‹æ–¹æ³•</h3><p><strong>Student.m</strong></p><p>é™¤ <code>init</code> å¤–ï¼ŒStudent åªæœ‰ä¸€ä¸ªå®ä¾‹æ–¹æ³• <code>studentWalkImp</code>.</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Student</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)init</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        </span><br><span class="line">        SEL proxySelector = <span class="built_in">NSSelectorFromString</span>(<span class="string">@&quot;studentWalkImp&quot;</span>);</span><br><span class="line">        IMP impletor = class_getMethodImplementation([<span class="keyword">self</span> <span class="keyword">class</span>], proxySelector);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è·å–å®ä¾‹æ–¹æ³•</span></span><br><span class="line">        Method method = class_getInstanceMethod([<span class="keyword">self</span> <span class="keyword">class</span>], proxySelector);</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">char</span> *types = method_getTypeEncoding(method);</span><br><span class="line">        </span><br><span class="line">        SEL origSel = <span class="built_in">NSSelectorFromString</span>(<span class="string">@&quot;walk&quot;</span>);</span><br><span class="line">        class_addMethod([<span class="keyword">self</span> <span class="keyword">class</span>], origSel, impletor, types);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)studentWalkImp</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- Student studentWalkImp&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p>è°ƒç”¨æµ‹è¯•ä¸€ä¸‹.</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    Student *stud = [[Student alloc] init];</span><br><span class="line">    [stud performSelector:<span class="built_in">NSSelectorFromString</span>(<span class="string">@&quot;walk&quot;</span>) withObject:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œ Student å¹¶æ²¡æœ‰ <code>walk</code> æ–¹æ³•ï¼Œæ•…æ„ä¸ºä¹‹ï¼Œè¿è¡Œåæ§åˆ¶å°ä¼šæ‰“å°:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">---veryitman--- Student studentWalkImp</span><br></pre></td></tr></table></figure><p>æˆåŠŸçš„ä¸º Student æ·»åŠ äº†ä¸€ä¸ªå®ä¾‹æ–¹æ³• <code>walk</code> çš„å®ç° <code>studentWalkImp</code>.</p><p>ä¸Šé¢çš„ä¾‹å­æ˜¯ä½¿ç”¨ OC çš„ IMP æ–¹å¼æ¥å®ç°çš„ï¼Œå¯ä»¥æ”¹ä¸º C å®ç°ç‰ˆæœ¬çš„.</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Student</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)init</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        SEL origSel = <span class="built_in">NSSelectorFromString</span>(<span class="string">@&quot;walk&quot;</span>);</span><br><span class="line">        class_addMethod([<span class="keyword">self</span> <span class="keyword">class</span>], origSel, (IMP)studentWalkImp, <span class="string">&quot;v:@&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> studentWalkImp()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- Student studentWalkImp&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-åŠ¨æ€æ·»åŠ ç±»æ–¹æ³•"><a href="#2-åŠ¨æ€æ·»åŠ ç±»æ–¹æ³•" class="headerlink" title="2. åŠ¨æ€æ·»åŠ ç±»æ–¹æ³•"></a>2. åŠ¨æ€æ·»åŠ ç±»æ–¹æ³•</h3><p>åŠ¨æ€æ·»åŠ ç±»æ–¹æ³•ï¼Œå’ŒåŠ¨æ€æ·»åŠ å®ä¾‹æ–¹æ³•ç¨å¾®æœ‰ç‚¹ä¸åŒã€‚ä¸‹é¢æ˜¯æ”¹é€ åçš„ <code>Student.m</code>.</p><p><strong>Student.m</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Student</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)init</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è·å– MetaClass, ç±»æ–¹æ³•ä¸å¯ä»¥ä½¿ç”¨ [self class]</span></span><br><span class="line">        Class metaCls = objc_getMetaClass([<span class="built_in">NSStringFromClass</span>([<span class="keyword">self</span> <span class="keyword">class</span>]) UTF8String]);</span><br><span class="line">        </span><br><span class="line">        SEL proxySelector = <span class="built_in">NSSelectorFromString</span>(<span class="string">@&quot;clsImp&quot;</span>);</span><br><span class="line">        IMP impletor = class_getMethodImplementation(metaCls, proxySelector);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è·å–ç±»æ–¹æ³•</span></span><br><span class="line">        Method method = class_getClassMethod([<span class="keyword">self</span> <span class="keyword">class</span>], proxySelector);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">char</span> *types = method_getTypeEncoding(method);</span><br><span class="line">        SEL origSel = <span class="built_in">NSSelectorFromString</span>(<span class="string">@&quot;walk&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        class_addMethod(metaCls, origSel, impletor, types);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)clsImp</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- Student clsImp&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šè¿™é‡Œè·å– Class ç¨å¾®ä¸åŒçš„æ˜¯ä½¿ç”¨äº† <code>objc_getMetaClass</code>ï¼Œè¿™é‡Œå…³ç³»åˆ° Objective-C ä¸­çš„ç±»ã€Classã€æ ¹ç±»å’Œå…ƒç±»çš„åŒºåˆ«ï¼Œå¯ä»¥å‚è€ƒ <a href="http://www.veryitman.com/2019/01/29/Class%E3%80%81isa%E3%80%81%E5%85%83%E7%B1%BB/">Classã€isaã€å…ƒç±»</a> è¿™ç¯‡æ–‡ç« ã€‚</p><p>è°ƒç”¨æµ‹è¯•ä¸€ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    Student *stud = [[Student alloc] init];</span><br><span class="line">    </span><br><span class="line">    [[stud <span class="keyword">class</span>] performSelector:<span class="built_in">NSSelectorFromString</span>(<span class="string">@&quot;walk&quot;</span>) withObject:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ§åˆ¶å°æ‰“å°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">---veryitman--- Student clsImp</span><br></pre></td></tr></table></figure><p>æˆåŠŸåœ°ä¸ºç±»åŠ¨æ€çš„æ·»åŠ äº†ä¸€ä¸ªç±»æ–¹æ³• <code>clsImp</code>.</p><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p><strong>1. <a href="http://blog.devtang.com/2013/10/15/objective-c-object-model/">Objective-C å¯¹è±¡æ¨¡å‹åŠåº”ç”¨</a></strong></p><p><strong>2. <a href="https://opensource.apple.com/tarballs/objc4/">Apple RunTime æºç  objc4-723.tar.gz</a></strong></p><p><strong>3. <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtHowMessagingWorks.html">Messaging</a></strong></p><p><strong>4. <a href="https://junyixie.github.io/2017/05/01/Objective-C-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E4%B8%AD%E7%9A%84%E6%B6%88%E6%81%AF%E6%9C%BA%E5%88%B6%E5%92%8C%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8/">Objective-C æ·±å…¥ç†è§£ä¸­çš„æ¶ˆæ¯æœºåˆ¶å’Œæ–¹æ³•è°ƒç”¨</a></strong></p><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><p>ç‚¹å‡»ä¸‹è½½æ–‡ä¸­å®Œæ•´çš„ <a href="https://github.com/veryitman/iOSDemo/tree/master/MZRuntimeMsgForward">Demo</a>.</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS RunTime MessageForward </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹ç±»æ–¹æ³•çš„è½¬å‘æµç¨‹</title>
      <link href="/2018/04/03/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E7%B1%BB%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B/"/>
      <url>/2018/04/03/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E7%B1%BB%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç¯‡æ˜¯ã€Œæ¶ˆæ¯è½¬å‘ã€ç³»åˆ—çš„ç¬¬ä¸‰ç¯‡, åœ¨ <a href="http://www.veryitman.com/2018/03/31/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B/">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹</a> å’Œ <a href="http://www.veryitman.com/2018/04/01/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B-%E5%AE%9E%E4%BE%8B%E8%AE%B2%E8%A7%A3/">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹[å®ä¾‹è®²è§£]</a> ä¸­åˆ†äº«äº†å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹.</p><p>ä»Šå¤©åˆ†äº«å¦‚ä½•å¯¹ç±»æ–¹æ³•è¿›è¡Œæ¶ˆæ¯çš„è½¬å‘.</p><h2 id="resolveClassMethod"><a href="#resolveClassMethod" class="headerlink" title="resolveClassMethod"></a>resolveClassMethod</h2><p>NSObject æä¾›äº† <code>resolveClassMethod</code> æ¥è®©å¼€å‘è€…åœ¨é‡Œé¢åŠ¨æ€æ·»åŠ ä¸€ä¸ªç±»æ–¹æ³•.</p><p>ç±»æ–¹æ³•çš„è½¬å‘æµç¨‹å’Œå®ä¾‹æ–¹æ³•è½¬å‘çš„æµç¨‹å¤§è‡´ä¸€æ ·, å”¯ç‹¬ä¸åŒçš„æ˜¯éœ€è¦é‡å†™çš„æ–¹æ³•(NSObjectä¸­)çš„ä¸ä¸€æ ·.</p><p>å½“æ—¶æˆ‘åœ¨å†™ Demo, ä»¥ä¸ºåªéœ€è¦å°† <code>resolveInstanceMethod</code> æ”¹ä¸º <code>resolveClassMethod</code> å°±ä¸‡äº‹å¤§å‰äº†å³é‡å†™ä¸‹é¢å‡ ä¸ªæ–¹æ³•å°±å¯ä»¥è§£å†³é—®é¢˜, äº‹å®è¯æ˜è¿™æ ·æ˜¯ä¸è¡Œçš„.</p><blockquote><ol><li>+resolveClassMethod</li><li>-forwardingTargetForSelector</li><li>-methodSignatureForSelector</li><li>-forwardInvocation</li><li>-doesNotRecognizeSelector:</li></ol></blockquote><p>ç½‘ä¸Šå¾ˆå¤šåšæ–‡å¹¶æ²¡æœ‰æ·±å…¥çš„æ¢è®¨å…³äºç±»æ–¹æ³•è½¬å‘çš„æµç¨‹, åªæ˜¯åœ¨ä»‹ç»å®ä¾‹æ–¹æ³•è½¬å‘çš„æµç¨‹çš„åŒæ—¶, ä¸€ç¬”å¸¦è¿‡ç±»æ–¹æ³•è½¬å‘æœºåˆ¶å’Œæµç¨‹.</p><p>é€šè¿‡å¯¹ <code>NSObject.mm</code> æºç çš„æŸ¥çœ‹, å¯ä»¥çœ‹åˆ°å¯¹åº”ä¸Šé¢çš„å‡ ä¸ªæ–¹æ³•éƒ½æœ‰ç±»æ–¹æ³•. å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> +resolveClassMethod</span><br><span class="line"><span class="number">2.</span> +forwardingTargetForSelector</span><br><span class="line"><span class="number">3.</span> +methodSignatureForSelector</span><br><span class="line"><span class="number">4.</span> +forwardInvocation</span><br><span class="line"><span class="number">5.</span> +doesNotRecognizeSelector:</span><br></pre></td></tr></table></figure><p>é‡æ–°è¿™å‡ ä¸ªæ–¹æ³•æ‰æ˜¯è§£å†³é—®é¢˜çš„å…³é”®.</p><p>ç°åœ¨æˆ‘ä»¬é‡å†™ <code>resolveClassMethod</code>, å¦‚ä¸‹.</p><hr><p><strong>ViewController.m</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="string">&lt;objc/runtime.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> sPerformClassMethodName = <span class="string">@&quot;veryClassMethod&quot;</span>;</span><br><span class="line"></span><br><span class="line">+ (<span class="built_in">BOOL</span>)resolveClassMethod:(SEL)sel</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- 1--- +resolveClassMethod&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *methodName = <span class="built_in">NSStringFromSelector</span>(sel);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ([sPerformClassMethodName isEqualToString:methodName]) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è·å– MetaClass</span></span><br><span class="line">        Class predicateMetaClass = objc_getMetaClass([<span class="built_in">NSStringFromClass</span>(<span class="keyword">self</span>) UTF8String]);</span><br><span class="line">        <span class="comment">// æ ¹æ® metaClass è·å–æ–¹æ³•çš„å®ç°</span></span><br><span class="line">        IMP impletor = class_getMethodImplementation(predicateMetaClass, <span class="keyword">@selector</span>(proxyMethod));</span><br><span class="line">        <span class="comment">// è·å–ç±»æ–¹æ³•</span></span><br><span class="line">        Method predicateMethod = class_getClassMethod(predicateMetaClass, <span class="keyword">@selector</span>(proxyMethod));</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">char</span> *encoding = method_getTypeEncoding(predicateMethod);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åŠ¨æ€æ·»åŠ ç±»æ–¹æ³•</span></span><br><span class="line">        class_addMethod(predicateMetaClass, sel, impletor, encoding);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">super</span> resolveClassMethod:sel];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)proxyMethod</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- +proxyMethod of class&#x27;s method for OC.&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¨¡æ‹Ÿè°ƒç”¨</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¿è¡Œç±»æ–¹æ³•</span></span><br><span class="line">    SEL selector = <span class="built_in">NSSelectorFromString</span>(sPerformClassMethodName);</span><br><span class="line">    SuppressPerformSelectorLeakWarning(</span><br><span class="line">        [[<span class="keyword">self</span> <span class="keyword">class</span>] performSelector:selector withObject:<span class="literal">nil</span>];</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³äº <code>SuppressPerformSelectorLeakWarning</code> å¯ä»¥å‚è€ƒ <a href="http://www.veryitman.com/2018/04/01/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B-%E5%AE%9E%E4%BE%8B%E8%AE%B2%E8%A7%A3/">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹[å®ä¾‹è®²è§£]</a>.</p><p>å°†åŠ¨æ€æ·»åŠ çš„æ–¹æ³•è®© <code>proxyMethod</code> æ¥æ‰§è¡Œ, æ˜¾ç¤ºç»“æœè¾¾åˆ°é¢„æœŸ.</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">---veryitman--- <span class="number">1</span>--- +resolveClassMethod</span><br><span class="line">---veryitman--- +proxyMethod of <span class="keyword">class</span><span class="string">&#x27;s method for OC.</span></span><br></pre></td></tr></table></figure><h2 id="åˆ›å»ºè¢«è½¬å‘è€…"><a href="#åˆ›å»ºè¢«è½¬å‘è€…" class="headerlink" title="åˆ›å»ºè¢«è½¬å‘è€…"></a>åˆ›å»ºè¢«è½¬å‘è€…</h2><p><strong>MZTempObj.m</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MZTempObj</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/// ç±»æ–¹æ³•</span></span><br><span class="line">+ (<span class="keyword">void</span>)veryClassMethod</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- veryClassMethod&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ç±»æ–¹æ³•çš„ä¸€ä¸ªå®ç° <code>veryClassMethod</code>.</p><h2 id="é‡å†™è½¬å‘æ¶ˆæ¯çš„å‡½æ•°"><a href="#é‡å†™è½¬å‘æ¶ˆæ¯çš„å‡½æ•°" class="headerlink" title="é‡å†™è½¬å‘æ¶ˆæ¯çš„å‡½æ•°"></a>é‡å†™è½¬å‘æ¶ˆæ¯çš„å‡½æ•°</h2><p>åŒç†å°† <code>resolveClassMethod</code> ä¿®æ”¹ä¸€ä¸‹, ä¸ºäº†ä¿è¯æµç¨‹ç»§ç»­.</p><p>ç¤ºä¾‹ä»£ç å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="built_in">BOOL</span>)resolveClassMethod:(SEL)sel</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- 1--- +resolveClassMethod. selector: %@&quot;</span>, <span class="built_in">NSStringFromSelector</span>(sel));</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *methodName = <span class="built_in">NSStringFromSelector</span>(sel);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¿™é‡Œæ•…æ„å°† sPerformClassMethodName æ”¹ä¸º @&quot;&quot;, ä¸ºäº†æµç¨‹å¾€ä¸‹èµ°</span></span><br><span class="line">    <span class="keyword">if</span> ([<span class="string">@&quot;&quot;</span> isEqualToString:methodName]) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è·å– MetaClass</span></span><br><span class="line">        Class predicateMetaClass = objc_getMetaClass([<span class="built_in">NSStringFromClass</span>(<span class="keyword">self</span>) UTF8String]);</span><br><span class="line">        <span class="comment">// æ ¹æ® metaClass è·å–æ–¹æ³•çš„å®ç°</span></span><br><span class="line">        IMP impletor = class_getMethodImplementation(predicateMetaClass, <span class="keyword">@selector</span>(proxyMethod));</span><br><span class="line">        <span class="comment">// è·å–ç±»æ–¹æ³•</span></span><br><span class="line">        Method predicateMethod = class_getClassMethod(predicateMetaClass, <span class="keyword">@selector</span>(proxyMethod));</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">char</span> *encoding = method_getTypeEncoding(predicateMethod);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åŠ¨æ€æ·»åŠ ç±»æ–¹æ³•</span></span><br><span class="line">        class_addMethod(predicateMetaClass, sel, impletor, encoding);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">super</span> resolveClassMethod:sel];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">id</span>)forwardingTargetForSelector:(SEL)aSelector</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- 2--- +forwardingTargetForSelector&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *selectorName = <span class="built_in">NSStringFromSelector</span>(aSelector);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ([sPerformClassMethodName isEqualToString:selectorName]) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ³¨æ„1: ä¹Ÿå¯åœ¨æ­¤è½¬å‘å®ä¾‹æ–¹æ³•</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> 0</span></span><br><span class="line">        <span class="comment">// è®© MZTempObj å»æ‰§è¡Œ aSelector, å®ç°æ¶ˆæ¯çš„è½¬å‘</span></span><br><span class="line">        MZTempObj *myobject = [[MZTempObj alloc] init];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> myobject;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è½¬å‘ç±»æ–¹æ³•å¯¹åº”è¿”å›ç±»å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">return</span> [MZTempObj <span class="keyword">class</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">id</span> obj = [<span class="keyword">super</span> forwardingTargetForSelector:aSelector];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="built_in">NSMethodSignature</span> *)methodSignatureForSelector:(SEL)aSelector</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- 3--- +methodSignatureForSelector&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ‰¾å‡ºå¯¹åº”çš„ aSelector ç­¾å</span></span><br><span class="line">    <span class="built_in">NSMethodSignature</span> *signature = [<span class="keyword">super</span> methodSignatureForSelector:aSelector];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ³¨æ„2: ä¹Ÿå¯ä»¥åœ¨æ­¤è·å–å®ä¾‹æ–¹æ³•çš„ç­¾å</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> 0</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nil</span> == signature) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ˜¯å¦æœ‰ aSelector</span></span><br><span class="line">        <span class="keyword">if</span> ([MZTempObj instancesRespondToSelector:aSelector]) &#123;</span><br><span class="line">            signature = [MZTempObj instanceMethodSignatureForSelector:aSelector];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> signature;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nil</span> == signature) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ˜¯å¦æœ‰ aSelector</span></span><br><span class="line">        <span class="keyword">if</span> ([MZTempObj respondsToSelector:aSelector]) &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//methodSignatureForSelector å¯ä»¥è·å–ç±»æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•çš„ç­¾å</span></span><br><span class="line">            <span class="comment">//instanceMethodSignatureForSelectoråªèƒ½è·å–å®ä¾‹æ–¹æ³•çš„ç­¾å</span></span><br><span class="line">            signature = [MZTempObj methodSignatureForSelector:aSelector];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> signature;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)forwardInvocation:(<span class="built_in">NSInvocation</span> *)anInvocation</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- 4--- +forwardInvocation&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ³¨æ„3: ä¹Ÿå¯ä»¥è°ƒç”¨å®ä¾‹æ–¹æ³•</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> 0</span></span><br><span class="line">    <span class="keyword">if</span> ([MZTempObj instancesRespondToSelector:anInvocation.selector]) &#123;</span><br><span class="line">        [anInvocation invokeWithTarget:[[MZTempObj alloc] init]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        [<span class="keyword">super</span> forwardInvocation:anInvocation];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ([MZTempObj respondsToSelector:anInvocation.selector]) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è¿™é‡Œè½¬å‘çš„æ˜¯ MZTempObj Class, ä¸æ˜¯å¯¹è±¡</span></span><br><span class="line">        [anInvocation invokeWithTarget:[MZTempObj <span class="keyword">class</span>]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        [<span class="keyword">super</span> forwardInvocation:anInvocation];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)doesNotRecognizeSelector:(SEL)aSelector</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- 5--- +doesNotRecognizeSelector: %@&quot;</span>, <span class="built_in">NSStringFromSelector</span>(aSelector));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå, æ§åˆ¶å°è¾“å‡ºæ—¥å¿—:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">---veryitman--- <span class="number">1</span>--- +resolveClassMethod. selector: veryClassMethod</span><br><span class="line">---veryitman--- <span class="number">2</span>--- +forwardingTargetForSelector</span><br><span class="line">---veryitman--- veryClassMethod</span><br></pre></td></tr></table></figure><p><strong>è¿™é‡Œæ³¨æ„ä¸€ä¸‹</strong></p><blockquote><p>å°†ä»£ç ä¸­ <code>æ³¨æ„1</code> <code>æ³¨æ„2</code> ç­‰éƒ¨åˆ†å¯ä»¥è‡ªè¡Œæ‰“å¼€æµ‹è¯•ä¸€ä¸‹, ç„¶åå°† <code>MZTempObj.m</code> ä¸­çš„ç±»æ–¹æ³•(+veryClassMethod)æ”¹ä¸ºå®ä¾‹æ–¹æ³•(-veryClassMethod), ä¹Ÿæ˜¯å¯ä»¥çš„, è¿™æ ·å°±è¾¾åˆ°äº†å°†ç±»æ–¹æ³•è½¬å‘ç»™å®ä¾‹æ–¹æ³•çš„æ•ˆæœ.</p></blockquote><p>ä¿®æ”¹ä¸€ä¸‹ <code>forwardingTargetForSelector</code> ä¸­çš„å®ç°, å¯ä»¥çœ‹åˆ° 4, 5ä¹Ÿä¼šæ‰§è¡Œ.</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="keyword">id</span>)forwardingTargetForSelector:(SEL)aSelector</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- 2--- +forwardingTargetForSelector&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *selectorName = <span class="built_in">NSStringFromSelector</span>(aSelector);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ([<span class="string">@&quot;&quot;</span> isEqualToString:selectorName]) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ³¨æ„1: ä¹Ÿå¯åœ¨æ­¤è½¬å‘å®ä¾‹æ–¹æ³•</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> 0</span></span><br><span class="line">        <span class="comment">// è®© MZTempObj å»æ‰§è¡Œ aSelector, å®ç°æ¶ˆæ¯çš„è½¬å‘</span></span><br><span class="line">        MZTempObj *myobject = [[MZTempObj alloc] init];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> myobject;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è½¬å‘ç±»æ–¹æ³•å¯¹åº”è¿”å›ç±»å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">return</span> [MZTempObj <span class="keyword">class</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">id</span> obj = [<span class="keyword">super</span> forwardingTargetForSelector:aSelector];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---veryitman--- <span class="number">1</span>--- +resolveClassMethod. selector: veryClassMethod</span><br><span class="line">---veryitman--- <span class="number">2</span>--- +forwardingTargetForSelector</span><br><span class="line">---veryitman--- <span class="number">3</span>--- +methodSignatureForSelector</span><br><span class="line">---veryitman--- <span class="number">1</span>--- +resolveClassMethod. selector: _forwardStackInvocation:</span><br><span class="line">---veryitman--- <span class="number">4</span>--- +forwardInvocation</span><br><span class="line">---veryitman--- veryClassMethod</span><br></pre></td></tr></table></figure><p>åŒç†æˆ‘ä»¬å¯ä»¥å¾—åˆ°ç±»æ–¹æ³•çš„æ¶ˆæ¯è½¬å‘æµç¨‹å›¾, å¦‚ä¸‹å›¾æ‰€ç¤º:</p><p><img src="/upload/images/2018/04/03/1.jpg" alt="1"></p><h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><p><a href="http://www.veryitman.com/2018/03/31/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹</a></p><p><a href="http://www.veryitman.com/2018/04/01/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B-%E5%AE%9E%E4%BE%8B%E8%AE%B2%E8%A7%A3/">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹å®ä¾‹è®²è§£</a></p><p><a href="http://www.veryitman.com/2018/04/05/OC-RunTime-%E6%80%BB%E7%BB%93%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B8%AD%E7%94%A8%E5%88%B0%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9/">OC-RunTime: æ€»ç»“æ¶ˆæ¯è½¬å‘ä¸­ç”¨åˆ°çš„çŸ¥è¯†ç‚¹</a></p><p>ç‚¹å‡»ä¸‹è½½æ–‡ä¸­å®Œæ•´çš„ <a href="https://github.com/veryitman/iOSDemo/tree/master/MZRuntimeMsgForward">Demo</a>.</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS RunTime MessageForward </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹[å®ä¾‹è®²è§£]</title>
      <link href="/2018/04/01/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B-%E5%AE%9E%E4%BE%8B%E8%AE%B2%E8%A7%A3/"/>
      <url>/2018/04/01/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B-%E5%AE%9E%E4%BE%8B%E8%AE%B2%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p><a href="http://www.veryitman.com/2018/03/31/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B/">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹</a> åˆ†äº«äº†æ¶ˆæ¯è½¬å‘çš„æµç¨‹, æœ¬æ¬¡ç»“åˆå®é™…ä¾‹å­ç»§ç»­åˆ†æä¸€ä¸‹æ¶ˆæ¯è½¬å‘æµç¨‹.</p><h2 id="å‘é€ä¸å­˜åœ¨çš„æ¶ˆæ¯"><a href="#å‘é€ä¸å­˜åœ¨çš„æ¶ˆæ¯" class="headerlink" title="å‘é€ä¸å­˜åœ¨çš„æ¶ˆæ¯"></a>å‘é€ä¸å­˜åœ¨çš„æ¶ˆæ¯</h2><p>åœ¨ ViewController çš„ viewDidLoad ä¸­è¿è¡Œ <code>veryTestMethod</code> æ–¹æ³•.</p><p><strong>ViewController.m</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> sPerformInstanceMethodName = <span class="string">@&quot;veryTestMethod&quot;</span>;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¿è¡Œå®ä¾‹æ–¹æ³•</span></span><br><span class="line">    SEL selector = <span class="built_in">NSSelectorFromString</span>(sPerformInstanceMethodName);</span><br><span class="line">    </span><br><span class="line">    SuppressPerformSelectorLeakWarning(</span><br><span class="line">        [<span class="keyword">self</span> performSelector:selector withObject:<span class="literal">nil</span>];</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­, <code>SuppressPerformSelectorLeakWarning</code> æ˜¯å®šä¹‰çš„ä¸€ä¸ªå®.</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> SuppressPerformSelectorLeakWarning(Stuff) \</span></span><br><span class="line"><span class="meta">do &#123; \</span></span><br><span class="line"><span class="meta">    _Pragma(<span class="string">&quot;clang diagnostic push&quot;</span>) \</span></span><br><span class="line"><span class="meta">    _Pragma(<span class="string">&quot;clang diagnostic ignored \&quot;-Warc-performSelector-leaks\&quot;&quot;</span>) \</span></span><br><span class="line"><span class="meta">    Stuff; \</span></span><br><span class="line"><span class="meta">    _Pragma(<span class="string">&quot;clang diagnostic pop&quot;</span>) \</span></span><br><span class="line"><span class="meta">&#125; while (0)</span></span><br></pre></td></tr></table></figure><p>åœ¨ ViewController ä¸­æˆ‘å¹¶æ²¡æœ‰å†™ <code>veryTestMethod</code> è¿™ä¸ªå‡½æ•°, åªæ˜¯å€ŸåŠ© <code>performSelector</code> åŠ¨æ€æ‰§è¡Œ, å¦‚æœç¼–è¯‘è¿è¡Œç›´æ¥ä¼š crash.</p><p>å¯ä»¥æŸ¥çœ‹ <code>NSObject.mm</code> æºç , é‡Œé¢å…³äºæ¶ˆæ¯è½¬å‘çš„å‡ ä¸ªé‡è¦å‡½æ•°éƒ½å†™ç€ <code>_objc_fatal</code>, å¯è°“æ˜¯æ‹›æ‹›æ¯™å‘½.</p><p>ç´§æ¥ç€, æˆ‘ä»¬å¯ä»¥å€ŸåŠ© <code>resolveInstanceMethod</code> æ¥å®Œæˆæ¶ˆæ¯è½¬å‘ç»™ ViewController.</p><h2 id="resolveInstanceMethod-è½¬å‘"><a href="#resolveInstanceMethod-è½¬å‘" class="headerlink" title="resolveInstanceMethod è½¬å‘"></a>resolveInstanceMethod è½¬å‘</h2><p>é‡å†™ NSObject ä¸­çš„ <code>resolveInstanceMethod</code> å‡½æ•°.</p><blockquote><p>+resolveInstanceMethod</p></blockquote><p><strong>ViewController.m</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®°å¾—å¯¼å…¥ RunTime å¤´æ–‡ä»¶</span></span><br><span class="line"><span class="meta">#import <span class="string">&lt;objc/runtime.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">+ (<span class="built_in">BOOL</span>)resolveInstanceMethod:(SEL)sel</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- 1--- +resolveInstanceMethod&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *methodName = <span class="built_in">NSStringFromSelector</span>(sel);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ([sPerformInstanceMethodName isEqualToString:methodName]) &#123;</span><br><span class="line">        </span><br><span class="line">        SEL proxySelector = <span class="built_in">NSSelectorFromString</span>(<span class="string">@&quot;proxyMethod&quot;</span>);</span><br><span class="line">        IMP impletor = class_getMethodImplementation(<span class="keyword">self</span>, proxySelector);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è·å–å®ä¾‹æ–¹æ³•</span></span><br><span class="line">        Method method = class_getInstanceMethod(<span class="keyword">self</span>, proxySelector);</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">char</span> *types = method_getTypeEncoding(method);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ·»åŠ  OC çš„å‡½æ•°</span></span><br><span class="line">        class_addMethod([<span class="keyword">self</span> <span class="keyword">class</span>], sel, impletor, types);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">super</span> resolveInstanceMethod:sel];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ViewController ä¸­å®ç°çš„ <code>proxyMethod</code></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// OC å®ç°</span></span><br><span class="line">- (<span class="keyword">void</span>)proxyMethod</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- -proxyMethod of instance&#x27;s method for OC.&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ <code>resolveInstanceMethod</code> ä¸­åŠ¨æ€æ·»åŠ äº† <code>veryTestMethod</code> æ–¹æ³•, å¹¶è®© <code>proxyMethod</code> å‡½æ•°æ¥å®ç°(IMP).</p><p>è¿è¡Œå¯ä»¥çœ‹åˆ°, ç¨‹åºå¹¶æ²¡æœ‰ crash, æˆåŠŸçš„æ‰§è¡Œäº† <code>proxyMethod</code>.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">---veryitman--- 1--- +resolveInstanceMethod</span><br><span class="line">---veryitman--- -proxyMethod of instance&#x27;s method for OC.</span><br></pre></td></tr></table></figure><p>åˆ°æ­¤ä¸ºæ­¢, æˆ‘ä»¬å·²ç»çœ‹åˆ°åŠ¨æ€æ·»åŠ ä¸€ä¸ªæ–¹æ³•çš„å®ç°å¹¶æˆåŠŸè¿è¡Œçš„å®Œæ•´ä¾‹å­.</p><p>æ¥ä¸‹æ¥, æˆ‘ä»¬å°†è½¬å‘ç»™å…¶ä»–å¯¹è±¡ <code>MZTempObj</code> æ¥æ‰§è¡Œ.</p><h2 id="è‡ªå®šä¹‰è¢«è½¬å‘çš„å¯¹è±¡"><a href="#è‡ªå®šä¹‰è¢«è½¬å‘çš„å¯¹è±¡" class="headerlink" title="è‡ªå®šä¹‰è¢«è½¬å‘çš„å¯¹è±¡"></a>è‡ªå®šä¹‰è¢«è½¬å‘çš„å¯¹è±¡</h2><p><strong>MZTempObj.m</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MZTempObj</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)veryTestMethod</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- veryTestMethod&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>veryTestMethod</code> å°±æ˜¯æˆ‘ä»¬è¦è½¬å‘å¯¹åº”çš„æ¶ˆæ¯.</p><h2 id="æ¶ˆæ¯è½¬å‘å®è·µ"><a href="#æ¶ˆæ¯è½¬å‘å®è·µ" class="headerlink" title="æ¶ˆæ¯è½¬å‘å®è·µ"></a>æ¶ˆæ¯è½¬å‘å®è·µ</h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠå‘ ViewController å‘é€ <code>veryTestMethod</code> çš„æ¶ˆæ¯è½¬å‘ç»™ <code>MZTempObj</code> çš„  <code>veryTestMethod</code> æ–¹æ³•.</p><p>ç»§ç»­é‡å†™ä¸‹é¢å‡½æ•°, ä¸è¿‡ <code>resolveInstanceMethod</code> è¦ç¨å¾®æ”¹é€ ä¸€ä¸‹, æ‰èƒ½è¾¾åˆ°æˆ‘ä»¬å®è·µçš„ç›®çš„.</p><blockquote><ol><li>+resolveInstanceMethod</li><li>-forwardingTargetForSelector</li><li>-methodSignatureForSelector</li><li>-forwardInvocation</li><li>-doesNotRecognizeSelector:</li></ol></blockquote><p><strong>ViewController.m</strong></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®°å¾—å¯¼å…¥ RunTime å¤´æ–‡ä»¶</span></span><br><span class="line"><span class="meta">#import <span class="string">&lt;objc/runtime.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">+ (<span class="built_in">BOOL</span>)resolveInstanceMethod:(SEL)sel</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- 1--- +resolveInstanceMethod: %@&quot;</span>, <span class="built_in">NSStringFromSelector</span>(sel));</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *methodName = <span class="built_in">NSStringFromSelector</span>(sel);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¿™é‡Œæ•…æ„ä¸ºä¹‹, è®©æµç¨‹å¾€ä¸‹èµ°</span></span><br><span class="line">    <span class="keyword">if</span> ([<span class="string">@&quot;&quot;</span> isEqualToString:methodName]) &#123;</span><br><span class="line">        </span><br><span class="line">        SEL proxySelector = <span class="built_in">NSSelectorFromString</span>(<span class="string">@&quot;proxyMethod&quot;</span>);</span><br><span class="line">        IMP impletor = class_getMethodImplementation(<span class="keyword">self</span>, proxySelector);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è·å–å®ä¾‹æ–¹æ³•</span></span><br><span class="line">        Method method = class_getInstanceMethod(<span class="keyword">self</span>, proxySelector);</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">char</span> *types = method_getTypeEncoding(method);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ·»åŠ  OC çš„å‡½æ•°</span></span><br><span class="line">        class_addMethod([<span class="keyword">self</span> <span class="keyword">class</span>], sel, impletor, types);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">super</span> resolveInstanceMethod:sel];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// è½¬å‘ç»™å¯¹åº”çš„æŸä¸ªå¯¹è±¡æ¥æ‰§è¡Œ aSelector</span></span><br><span class="line">- (<span class="keyword">id</span>)forwardingTargetForSelector:(SEL)aSelector</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- 2--- -forwardingTargetForSelector&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *selectorName = <span class="built_in">NSStringFromSelector</span>(aSelector);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ([sPerformInstanceMethodName isEqualToString:selectorName]) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®© MZTempObj å»æ‰§è¡Œ aSelector, å®ç°æ¶ˆæ¯çš„è½¬å‘</span></span><br><span class="line">        MZTempObj *myobject = [[MZTempObj alloc] init];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> myobject;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">id</span> obj = [<span class="keyword">super</span> forwardingTargetForSelector:aSelector];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSMethodSignature</span> *)methodSignatureForSelector:(SEL)aSelector</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- 3--- -methodSignatureForSelector&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ‰¾å‡ºå¯¹åº”çš„ aSelector ç­¾å</span></span><br><span class="line">    <span class="built_in">NSMethodSignature</span> *signature = [<span class="keyword">super</span> methodSignatureForSelector:aSelector];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nil</span> == signature) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ˜¯å¦æœ‰ aSelector</span></span><br><span class="line">        <span class="keyword">if</span> ([MZTempObj instancesRespondToSelector:aSelector]) &#123;</span><br><span class="line">            signature = [MZTempObj instanceMethodSignatureForSelector:aSelector];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> signature;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)forwardInvocation:(<span class="built_in">NSInvocation</span> *)anInvocation</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- 4--- -forwardInvocation&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ([MZTempObj instancesRespondToSelector:anInvocation.selector]) &#123;</span><br><span class="line">        [anInvocation invokeWithTarget:[[MZTempObj alloc] init]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        [<span class="keyword">super</span> forwardInvocation:anInvocation];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)doesNotRecognizeSelector:(SEL)aSelector</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- 5--- -doesNotRecognizeSelector: %@&quot;</span>, <span class="built_in">NSStringFromSelector</span>(aSelector));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç¨‹åº, æ§åˆ¶å°æ‰“å°ç»“æœå¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">---veryitman--- 1--- +resolveInstanceMethod</span><br><span class="line">---veryitman--- 2--- -forwardingTargetForSelector</span><br><span class="line">---veryitman--- veryTestMethod</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯¹ç…§ä¹‹å‰çš„æµç¨‹å›¾æ˜¯å®Œå…¨ç¬¦åˆçš„, é‚£ä¹ˆæ€ä¹ˆè®©å…¶æ‰§è¡Œ 3 å’Œ 4 å‘¢? å¾ˆç®€å•, ä¿®æ”¹ä¸€ä¸‹ <code>forwardingTargetForSelector</code> é‡Œé¢çš„å®ç°å³å¯.</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">id</span>)forwardingTargetForSelector:(SEL)aSelector</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---veryitman--- 2--- -forwardingTargetForSelector&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *selectorName = <span class="built_in">NSStringFromSelector</span>(aSelector);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ•…æ„ä¸ºä¹‹</span></span><br><span class="line">    <span class="keyword">if</span> ([<span class="string">@&quot;&quot;</span> isEqualToString:selectorName]) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®© MZTempObj å»æ‰§è¡Œ aSelector, å®ç°æ¶ˆæ¯çš„è½¬å‘</span></span><br><span class="line">        MZTempObj *myobject = [[MZTempObj alloc] init];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> myobject;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">id</span> obj = [<span class="keyword">super</span> forwardingTargetForSelector:aSelector];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†æ¬¡æ‰§è¡Œçœ‹ç»“æœ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---veryitman--- 1--- +resolveInstanceMethod veryTestMethod</span><br><span class="line">---veryitman--- 2--- -forwardingTargetForSelector</span><br><span class="line">---veryitman--- 3--- -methodSignatureForSelector</span><br><span class="line">---veryitman--- 1--- +resolveInstanceMethod: _forwardStackInvocation:</span><br><span class="line">---veryitman--- 4--- -forwardInvocation</span><br><span class="line">---veryitman--- veryTestMethod</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„:</strong> è¿™é‡Œåœ¨ 3åé¢ä¼šå¤šäº†ä¸€ä¸ª <code>1--- resolveInstanceMethod</code> çš„æ‰“å°, æ˜¯ç³»ç»Ÿè°ƒç”¨çš„, æ­¤æ—¶å¯¹åº”çš„ sel æ˜¯ <code>_forwardStackInvocation</code>.</p><p>å¦‚æœä¸å»é‡å†™ <code>methodSignatureForSelector</code> æ‰“å°ç»“æœå¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">---veryitman--- 1--- +resolveInstanceMethod</span><br><span class="line">---veryitman--- 2--- -forwardingTargetForSelector</span><br><span class="line">---veryitman--- 5--- -doesNotRecognizeSelector: veryTestMethod</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p>1.Apple RunTime æºç  <a href="https://opensource.apple.com/tarballs/objc4/">objc4-723.tar.gz</a></p><p>2.<a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtForwarding.html#//apple_ref/doc/uid/TP40008048-CH105-SW1">Message Forwarding</a></p><h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><p><a href="http://www.veryitman.com/2018/03/31/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹</a></p><p><a href="http://www.veryitman.com/2018/04/03/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E7%B1%BB%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B/">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹ç±»æ–¹æ³•çš„è½¬å‘æµç¨‹</a></p><p><a href="http://www.veryitman.com/2018/04/05/OC-RunTime-%E6%80%BB%E7%BB%93%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B8%AD%E7%94%A8%E5%88%B0%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9/">OC-RunTime: æ€»ç»“æ¶ˆæ¯è½¬å‘ä¸­ç”¨åˆ°çš„çŸ¥è¯†ç‚¹</a></p><p>ç‚¹å‡»ä¸‹è½½æ–‡ä¸­å®Œæ•´çš„ <a href="https://github.com/veryitman/iOSDemo/tree/master/MZRuntimeMsgForward">Demo</a>.</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS RunTime MessageForward </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹</title>
      <link href="/2018/03/31/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B/"/>
      <url>/2018/03/31/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><hr><p>æœ¬ç¯‡åªæ˜¯ä»ç³»ç»Ÿå‡½æ•°çš„å®ç°ä¸Š, æ¥åˆ†ææ¶ˆæ¯è½¬å‘çš„æµç¨‹. </p><p>ä¸‹ä¸€ç¯‡ç»“åˆæœ¬ç¯‡çš„ç†è®ºå’Œå®é™…çš„ä¾‹å­æ¥åˆ†æä¸€ä¸‹æ¶ˆæ¯è½¬å‘.</p><h2 id="éœ€è¦æ˜ç¡®çš„å‡ ä¸ªé—®é¢˜"><a href="#éœ€è¦æ˜ç¡®çš„å‡ ä¸ªé—®é¢˜" class="headerlink" title="éœ€è¦æ˜ç¡®çš„å‡ ä¸ªé—®é¢˜"></a>éœ€è¦æ˜ç¡®çš„å‡ ä¸ªé—®é¢˜</h2><p>åœ¨å¾€ä¸‹çœ‹è¿™ç¯‡åšæ–‡ä¹‹å‰, æœ‰å‡ ä¸ªé—®é¢˜éœ€è¦å¤§å®¶è¾¾æˆå…±è¯†.</p><p><strong>1.Objective-C çš„ç‰¹ç‚¹</strong><br>æŒ‰ç…§æ˜¯å¦éœ€è¦ç¼–è¯‘çš„åŸç†æ¥è¯´, ç¼–ç¨‹è¯­è¨€ä¸€èˆ¬å¯ä»¥åˆ†ä¸ºé™æ€ç¼–è¯‘ç±»å‹å’ŒåŠ¨æ€è§£é‡Šç±»å‹.</p><p>å¦‚ Java&#x2F;C&#x2F;C++ æ˜¯å±äºç¼–è¯‘ç±»å‹çš„è¯­è¨€, Php&#x2F;Python&#x2F;Ruby å±äºè§£é‡Šç±»å‹çš„è¯­è¨€.</p><p>Objective-C æ˜¯åŸºäº C å¹¶å…·æœ‰è‡ªèº«ç‰¹ç‚¹çš„ç¼–è¯‘å‹è¯­è¨€, å†åŠ ä¸Šå…¶ RunTime æœºåˆ¶, Objective-C æ—¢æ˜¯ç¼–è¯‘å‹åˆæ˜¯åŠ¨æ€çš„ä¸€é—¨ç¼–ç¨‹è¯­è¨€. æ‰€è°“çš„åŠ¨æ€æŒ‡çš„æ˜¯åœ¨ç¨‹åºç¼–è¯‘åè¿è¡Œä¸­å¯ä»¥æ”¹å˜å…¶ç»“æ„.</p><p><strong>2.å‡½æ•°è°ƒç”¨</strong><br>åœ¨ Objective-C ä¸­è°ƒç”¨å‡½æ•°, è¢«è§£é‡Šä¸ºå‘ä¸€ä¸ªå¯¹è±¡å‘é€æ¶ˆæ¯, è¯¥å¯¹è±¡å¯ä»¥æ˜¯ç±»å¯¹è±¡ä¹Ÿå¯ä»¥æ˜¯å®ä¾‹å¯¹è±¡.</p><p>ä¾‹å¦‚:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[person play];</span><br></pre></td></tr></table></figure><p>æ„æ€æ˜¯å‘å®ä¾‹å¯¹è±¡ person å‘é€ä¸€ä¸ª play çš„æ¶ˆæ¯. </p><p>è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„æ˜¯, å‘ä¸€ä¸ªç©ºå¯¹è±¡(nil) å‘é€æ¶ˆæ¯ä¸ä¼š crash, å¦‚æœåœ¨ Java ä¸­è¿™ä¸ªæ˜¯ä¸è¡Œçš„.ä¾‹å¦‚:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">person = <span class="literal">nil</span>;</span><br><span class="line">[person play];</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¸ä¼šå¯¼è‡´ç¨‹åºå´©æºƒ, åªæ˜¯è°ƒç”¨ <code>play</code> å‡½æ•°æ²¡æœ‰ä»»ä½•ååº”ç½¢äº†!</p><p><strong>3.self</strong><br>åœ¨ C++&#x2F;Java è¯­è¨€ä¸­, æœ‰ this æŒ‡é’ˆçš„æ¦‚å¿µ, åœ¨ Objective-C ä¸­, ä¹Ÿæœ‰ç±»ä¼¼çš„ this æŒ‡é’ˆå³ self. self æ—¢å¯ä»¥æ˜¯å®ä¾‹å¯¹è±¡ä¹Ÿå¯ä»¥æ˜¯ç±»å¯¹è±¡.</p><p>è¿™é‡Œä¸¾ä¸ªä¾‹å­, ä¸‹é¢ä¸¤ä¸ªåŒåå‡½æ•°, ä¸€ä¸ªæ˜¯ç±»æ–¹æ³•(+)ä¸€ä¸ªæ˜¯å®ä¾‹æ–¹æ³•(-).<br>è·Ÿ Java ä¸­çš„ç±»ä¼¼, å®ä¾‹æ–¹æ³•å¯ä»¥ç›´æ¥ä½¿ç”¨ç±»æ–¹æ³•, ä½†æ˜¯ç±»æ–¹æ³•ä¸å¯ä»¥ç›´æ¥ä½¿ç”¨å®ä¾‹æ–¹æ³•.</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="keyword">void</span>)testClassMethod</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">self</span> sendMsg];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)testInstanceMethod</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">self</span> sendMsg];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç±»æ–¹æ³•</span></span><br><span class="line">+ (<span class="keyword">void</span>)sendMsg</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;+ sendMsg. self: %@&quot;</span>, <span class="keyword">self</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ä¾‹æ–¹æ³•</span></span><br><span class="line">- (<span class="keyword">void</span>)sendMsg</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;- sendMsg. self: %@&quot;</span>, <span class="keyword">self</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ ViewController ä¸­åˆ†åˆ«è°ƒç”¨ä¸¤ä¸ª test æ–¹æ³•, è¾“å‡ºå†…å®¹, å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">+ sendMsg. <span class="keyword">self</span>: ViewController</span><br><span class="line"></span><br><span class="line">- sendMsg. <span class="keyword">self</span>: &lt;ViewController: <span class="number">0x7fc64740a5e0</span>&gt;</span><br></pre></td></tr></table></figure><p>ä»ç»“æœå¯ä»¥çœ‹å‡ºç±»æ–¹æ³•ä¸­çš„ <code>self</code> ä»£è¡¨çš„æ˜¯è¯¥ç±», å®ä¾‹æ–¹æ³•ä¸­çš„ <code>self</code> æŒ‡çš„æ˜¯ç±»çš„ä¸€ä¸ªå®ä¾‹å³å¯¹è±¡.</p><p>æ›´å¤š <code>self</code> çš„çŸ¥è¯†ç‚¹ï¼Œå¯ä»¥å‚è€ƒ <a href="http://www.veryitman.com/2018/12/23/OC-self/">OC: self</a> è¿™ç¯‡æ–‡ç« ã€‚</p><h2 id="å…³äº-Message-Forwarding"><a href="#å…³äº-Message-Forwarding" class="headerlink" title="å…³äº Message Forwarding"></a>å…³äº Message Forwarding</h2><p>Message Forwarding å³æ¶ˆæ¯è½¬å‘. </p><p>å…³äºæ¶ˆæ¯è½¬å‘, å®˜æ–¹æ–‡æ¡£ <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtForwarding.html#//apple_ref/doc/uid/TP40008048-CH105-SW1">Message Forwarding</a> æ˜¯è¿™ä¹ˆè§£é‡Šçš„:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Sending a message to an object that does not handle that message is an error. However, </span><br><span class="line">before announcing the error, </span><br><span class="line">the runtime system gives the receiving object a second chance to handle the message.</span><br></pre></td></tr></table></figure><p>å¤§æ¦‚æ„æ€æ˜¯è¿™æ ·çš„:</p><blockquote><p>å‘ä¸€ä¸ªå¯¹è±¡å‘é€æ¶ˆæ¯, è¯¥å¯¹è±¡å¦‚æœæ— æ³•å¤„ç†è¯¥æ¶ˆæ¯, ç³»ç»Ÿå°±ä¼šæŠ¥é”™, ä½†æ˜¯åœ¨æŠ¥é”™ä¹‹å‰, åˆ©ç”¨ Objective-C æä¾›çš„è¿è¡Œæ—¶æœºåˆ¶å¯ä»¥é˜²æ­¢æŠ¥é”™çš„å‘ç”Ÿ. åœ¨ iOS ä¸­ç±»ä¼¼è¿™æ ·çš„æŠ¥é”™ä¼šå¯¼è‡´ç¨‹åºç›´æ¥ crash.<br>è¿™é‡Œçš„å¯¹è±¡, å¯ä»¥æ˜¯å®ä¾‹å¯¹è±¡åˆå¯ä»¥æ˜¯ç±»å¯¹è±¡.</p></blockquote><p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­, å¤§å®¶ä¸€èˆ¬éƒ½ä¼šé‡åˆ°ç±»ä¼¼çš„ crash:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> *** Terminating app due to uncaught exception  </span><br><span class="line"><span class="string">&#x27;NSInvalidArgumentException&#x27;</span>, </span><br><span class="line">reason: <span class="string">&#x27;-[Controller play]: unrecognized selector sent to instance 0x7ff779f322a0&#x27;</span></span><br><span class="line">*** First throw call stack:</span><br><span class="line">(</span><br><span class="line">CoreFoundation  <span class="number">0x000000010d89712b</span> __exceptionPreprocess + <span class="number">171</span></span><br><span class="line">libobjc.A.dylib <span class="number">0x000000010cf2bf41</span> objc_exception_throw + <span class="number">48</span></span><br><span class="line">CoreFoundation  <span class="number">0x000000010d918024</span> -[<span class="built_in">NSObject</span>(<span class="built_in">NSObject</span>) doesNotRecognizeSelector:] + <span class="number">132</span></span><br><span class="line"><span class="built_in">UIKit</span> <span class="number">0x000000010df48f51</span> -[<span class="built_in">UIResponder</span> doesNotRecognizeSelector:] + <span class="number">295</span></span><br><span class="line">CoreFoundation  <span class="number">0x000000010d819f78</span> ___forwarding___ + <span class="number">1432</span></span><br><span class="line">CoreFoundation  <span class="number">0x000000010d819958</span> _CF_forwarding_prep_0 + <span class="number">120</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ª crash å¾ˆæ˜æ˜¾, <code>Controller</code> ä¸­è°ƒç”¨äº†ä¸€ä¸ªä¸å­˜åœ¨çš„å‡½æ•° <code>play</code>.</p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªè¢«è°ƒç”¨çš„ç³»ç»Ÿå‡½æ•° <code>doesNotRecognizeSelector</code>, ä»Šå¤©æˆ‘ä»¬å‰–æä¸€ä¸‹æ¶ˆæ¯è½¬å‘çš„æµç¨‹.</p><h2 id="å®ä¾‹æ–¹æ³•-æ¶ˆæ¯-è½¬å‘çš„æµç¨‹"><a href="#å®ä¾‹æ–¹æ³•-æ¶ˆæ¯-è½¬å‘çš„æµç¨‹" class="headerlink" title="å®ä¾‹æ–¹æ³•(æ¶ˆæ¯)è½¬å‘çš„æµç¨‹"></a>å®ä¾‹æ–¹æ³•(æ¶ˆæ¯)è½¬å‘çš„æµç¨‹</h2><p>åœ¨ä¸Šé¢å·²ç»è¯´è¿‡, OC å¯ä»¥é€šè¿‡è¿è¡Œæ—¶æ¥é¿å…å› ä¸ºæ‰¾ä¸åˆ°æ–¹æ³•è€Œå¯¼è‡´é”™è¯¯.</p><p>å…¶å®, å«ä¹‰å°±æ˜¯ OC ç»™äº†æˆ‘ä»¬ç¬¬äºŒæ¬¡æœºä¼šæ¥é¿å…ç±»ä¼¼çš„é”™è¯¯.</p><p>æˆ‘ä»¬é‡å†™ NSObject ä¸­çš„ 5 ä¸ªæ–¹æ³•, åˆ†åˆ«æ˜¯:</p><blockquote><ol><li>+resolveInstanceMethod</li><li>-forwardingTargetForSelector</li><li>-methodSignatureForSelector</li><li>-forwardInvocation</li><li>-doesNotRecognizeSelector:</li></ol></blockquote><p>å½“æ— æ³•æ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•æ—¶, è°ƒç”¨çš„æ–¹æ³•å’Œé¡ºåºå¤§è‡´å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">+resolveInstanceMethod</span><br><span class="line">-forwardingTargetForSelector</span><br><span class="line">-methodSignatureForSelector</span><br><span class="line">-doesNotRecognizeSelector:</span><br></pre></td></tr></table></figure><p>å½“æ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•æ—¶, è°ƒç”¨æ–¹æ³•å’Œé¡ºåºå¤§è‡´å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">+resolveInstanceMethod</span><br><span class="line">-forwardingTargetForSelector</span><br><span class="line">-methodSignatureForSelector</span><br><span class="line">-forwardInvocation</span><br></pre></td></tr></table></figure><p>æ ¹æ®å®è·µç»“æœ, ç”»æµç¨‹å›¾å¦‚ä¸‹:<br><img src="/upload/images/2018/03/31/1.jpg" alt="1"></p><p>ä¸‹é¢åˆ†åˆ«è§£é‡Šä¸€ä¸‹è¿™å‡ ä¸ªæ–¹æ³•çš„ä½œç”¨å’Œæ„ä¹‰.</p><p><strong>+ (BOOL)resolveInstanceMethod:(SEL)sel</strong></p><p>è§£æå¯¹åº”çš„å®ä¾‹æ–¹æ³•. åœ¨è¯¥æ–¹æ³•ä¸­å…è®¸å¢åŠ ä¸€ä¸ªæ–¹æ³•çš„å®ç°, ä»è€Œå®ç°åŠ¨æ€æ·»åŠ æ–¹æ³•.</p><p>é»˜è®¤è¿”å› NO.</p><p>åœ¨ <code>NSObject.mm</code> ä¸­å¯ä»¥çœ‹åˆ°æ–¹æ³•çš„å®ç°:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="built_in">BOOL</span>)resolveInstanceMethod:(SEL)sel &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>- (id)forwardingTargetForSelector:(SEL)aSelector</strong></p><p>å°†å¯¹åº”çš„ selector è½¬å‘ç»™æŒ‡å®šçš„å¯¹è±¡. æ¢å¥è¯è¯´å°±æ˜¯å°†ä¹‹å‰æ²¡æœ‰å®ç°çš„ selector è½¬äº¤ç»™å¦å¤–ä¸€ä¸ªå¯èƒ½å®ç°äº†è¯¥ selector çš„å¯¹è±¡å»å¤„ç†.</p><p>é»˜è®¤è¿”å› nil.</p><p>**- (NSMethodSignature <em>)methodSignatureForSelector:(SEL)aSelector</em>*</p><p>è¯¥æ–¹æ³•è¿”å›å¯¹ selector å®ç°çš„æ–¹æ³•ç­¾å.</p><p>é»˜è®¤å®ç°å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">NSMethodSignature</span> *)methodSignatureForSelector:(SEL)sel &#123;</span><br><span class="line">    _objc_fatal(<span class="string">&quot;-[NSObject methodSignatureForSelector:] &quot;</span></span><br><span class="line">                <span class="string">&quot;not available without CoreFoundation&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>**- (void)forwardInvocation:(NSInvocation <em>)anInvocation</em>*</p><p>è¯¥æ–¹æ³•æ˜¯ä¾èµ–ç¬¬3ä¸ªæ–¹æ³•çš„, å¦‚æœç¬¬ä¸‰ä¸ªæ–¹æ³•æ‰¾åˆ°äº†å¯¹åº”çš„æ–¹æ³•ç­¾å, è¯¥æ–¹æ³•å°±å¯ä»¥å®ç°è½¬å‘è°ƒç”¨äº†.</p><p><strong>- (void)doesNotRecognizeSelector:(SEL)sel</strong></p><p>å¦‚æœå‰é¢å‡ ä¸ªæ–¹æ³•éƒ½æ²¡æœ‰å¤„ç†å¥½, ç³»ç»Ÿä¼šè°ƒç”¨è¯¥æ–¹æ³•, ç›´æ¥å¯¼è‡´ç¨‹åº crash, ä¹Ÿç§°ä¹‹ä¸ºç»ˆææ­»äº¡æ–¹æ³•.</p><p>æºç å®ç°å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)doesNotRecognizeSelector:(SEL)sel &#123;</span><br><span class="line">    _objc_fatal(<span class="string">&quot;-[%s %s]: unrecognized selector sent to instance %p&quot;</span>, </span><br><span class="line">                object_getClassName(<span class="keyword">self</span>), sel_getName(sel), <span class="keyword">self</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“, Objective-C ä¸­ç»™ä¸€ä¸ªå¯¹è±¡å‘é€æ¶ˆæ¯ä¼šç»è¿‡å¦‚ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><p><strong>æ­¥éª¤1.</strong> åœ¨ç±»çš„è°ƒåº¦è¡¨(dispatch table) ä¸­æ‰¾è¦æ‰§è¡Œçš„å‡½æ•°(æ¶ˆæ¯), å¦‚æœæ‰¾åˆ°äº†ï¼Œåˆ°ç›¸åº”çš„å‡½æ•° IMP å»æ‰§è¡Œ.</p><blockquote><p>æ¯ä¸ªç±»çš„ç»“æ„ä½“åŒ…å«ç€ä¸¤ä¸ªå¿…å¤‡çš„å…ƒç´ :<br>[1]. æŒ‡å‘çˆ¶ç±»çš„æŒ‡é’ˆ<br>[2]. class dispatch table(è°ƒåº¦è¡¨). è°ƒåº¦è¡¨ä¸­åŒ…å«äº† method selectors å’Œç‰¹å®š class ç›¸åº”æ–¹æ³•å®ç°çš„åœ°å€.</p></blockquote><p><strong>æ­¥éª¤2.</strong> å¦‚æœæ²¡æ‰¾åˆ°ï¼Œè¿è¡Œæ—¶ä¼šè°ƒç”¨ +resolveInstanceMethod: æˆ–è€… +resolveClassMethod: å°è¯•è§£æè¿™ä¸ªæ¶ˆæ¯. åœ¨è¯¥æ–¹æ³•ä¸­, å…è®¸åŠ¨æ€æ·»åŠ ä¸€ä¸ªæ–¹æ³•çš„å®ç°.</p><blockquote><p>å…³äº <code>resolveClassMethod</code> è¿™ä¸ªæ”¾åœ¨å¦ä¸€ç¯‡åšå®¢ä¸­è®²è§£.</p></blockquote><p><strong>æ­¥éª¤3.</strong> å¦‚æœ resolveXX è¿”å› YES, ç›´æ¥ç»“æŸåé¢çš„æµç¨‹, æ‰§è¡Œè§£æå¾—åˆ°çš„æ–¹æ³•. å¦‚æœ resolveXX è¿”å› NOï¼Œè¿è¡Œæ—¶å°±å‘é€ forwardingTargetForSelector æ¶ˆæ¯, å…è®¸è¿™ä¸ªæ¶ˆæ¯è½¬å‘ç»™å¦ä¸€ä¸ªå¯èƒ½å®ç°äº†å¯¹åº” selector çš„å¯¹è±¡.</p><p><strong>æ­¥éª¤4.</strong> å¦‚æœæ²¡æœ‰æ–°çš„ç›®æ ‡å¯¹è±¡è¿”å›, è¿è¡Œæ—¶å°±ä¼šå‘é€methodSignatureForSelector æ¶ˆæ¯, æ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•ç­¾å.<br>å¦‚æœæ‰¾åˆ°äº†, ä¼šæ¥ç€è°ƒç”¨ forwardInvocation, å¦‚æœæ²¡æœ‰æ‰¾åˆ°å³è¿”å› nil, é‚£ä¹ˆç›´æ¥è°ƒç”¨ doesNotRecognizeSelector.</p><p>ä¸‹ä¸€ç¯‡ç»“åˆå®é™…ä¾‹å­åˆ†æä¸€ä¸‹æ•´ä¸ªå®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹.</p><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p>1.Apple å¼€å‘è€…æ–‡æ¡£ <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtForwarding.html#//apple_ref/doc/uid/TP40008048-CH105-SW1">Message Forwarding</a></p><p>2.Apple RunTime æºç  <a href="https://opensource.apple.com/tarballs/objc4/">objc4-723.tar.gz</a></p><h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><p><a href="http://www.veryitman.com/2018/04/01/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B-%E5%AE%9E%E4%BE%8B%E8%AE%B2%E8%A7%A3/">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹å®ä¾‹è®²è§£</a></p><p><a href="http://www.veryitman.com/2018/04/03/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E7%B1%BB%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B/">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹ç±»æ–¹æ³•çš„è½¬å‘æµç¨‹</a></p><p><a href="http://www.veryitman.com/2018/04/05/OC-RunTime-%E6%80%BB%E7%BB%93%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B8%AD%E7%94%A8%E5%88%B0%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9/">OC-RunTime: æ€»ç»“æ¶ˆæ¯è½¬å‘ä¸­ç”¨åˆ°çš„çŸ¥è¯†ç‚¹</a></p><p>ç‚¹å‡»ä¸‹è½½æ–‡ä¸­å®Œæ•´çš„ <a href="https://github.com/veryitman/iOSDemo/tree/master/MZRuntimeMsgForward">Demo</a>.</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS RunTime MessageForward </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MacOS æ–‡ä»¶å¤§å°çš„å•ä½</title>
      <link href="/2018/03/24/MacOS-%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F%E7%9A%84%E5%8D%95%E4%BD%8D/"/>
      <url>/2018/03/24/MacOS-%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F%E7%9A%84%E5%8D%95%E4%BD%8D/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¼˜ç”±"><a href="#ç¼˜ç”±" class="headerlink" title="ç¼˜ç”±"></a>ç¼˜ç”±</h2><p>æˆ‘ä¸€ç›´ä»¥ä¸ºæ–‡ä»¶å¤§å°éƒ½æ˜¯æŒ‰ç…§ <code>1024</code> ä¸ºå•ä½æ¥è®¡ç®—çš„, ä½†æ˜¯åœ¨ MacOS ä¸Šé¢æ˜¯æŒ‰ç…§ <code>1000</code> ä¸ºå•ä½è®¡ç®—çš„, windows ä¸Šé¢æ˜¯æŒ‰ç…§ <code>1024</code> ä¸ºå•ä½æ¥è®¡ç®—çš„.</p><h2 id="å¶ç„¶çš„å‘ç°"><a href="#å¶ç„¶çš„å‘ç°" class="headerlink" title="å¶ç„¶çš„å‘ç°"></a>å¶ç„¶çš„å‘ç°</h2><p>ä¹‹å‰å†™ä»£ç , éœ€è¦ç”¨åˆ°è·å–æ–‡ä»¶å¤§å°çš„åŠŸèƒ½, ä»£ç å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// è¯»å–æ–‡ä»¶å¤§å°</span><br><span class="line">long getFileSize(char *filename) &#123;</span><br><span class="line">    </span><br><span class="line">    FILE *fp = fopen(filename, &quot;r&quot;);</span><br><span class="line">    if (!fp) &#123;</span><br><span class="line">        return -1;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    fseek(fp, 0, SEEK_END);</span><br><span class="line">    </span><br><span class="line">    long size = ftell(fp);</span><br><span class="line">    fclose(fp);</span><br><span class="line">    </span><br><span class="line">    return size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–‡ä»¶åæ˜¯ <code>mm.aac</code>, ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶, è·å–åˆ°çš„æ–‡ä»¶å¤§å°æ˜¯ <code>76395</code> å­—èŠ‚.</p><p>æˆ‘æ— èŠè‡³æ, ä½¿ç”¨ <code>du</code> å‘½ä»¤æ¥è·å–è¯¥æ–‡ä»¶çš„å¤§å°:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">du -sh mm.aac </span><br></pre></td></tr></table></figure><p>æ˜¾ç¤ºæ–‡ä»¶å¤§å°æ˜¯ <code>76KB</code>.</p><p>MacOS ä¸Šé¢æŸ¥çœ‹æ–‡ä»¶å±æ€§, è·å–åˆ°çš„å¤§å°ä¹Ÿæ˜¯ <code>76KB</code></p><p><img src="/upload/images/2018/03/24/1.jpg" alt="1"></p><p>äºŒè€…è·å–çš„æ–‡ä»¶å¤§å°ä¸€è‡´, å¯ä»¥çœ‹å‡ºæ–‡ä»¶çš„å¤§å°æ˜¯æ­£ç¡®çš„.</p><p>äºæ˜¯æˆ‘æŸ¥äº†ä¸€ä¸‹åœ¨ windows ä¸Šé¢çš„è¯¥æ–‡ä»¶çš„å¤§å°, å¦‚ä¸‹æˆªå›¾:</p><p><img src="/upload/images/2018/03/24/2.png" alt="1"></p><p>å¯ä»¥çœ‹å‡º, MacOS ä¸Šé¢æ–‡ä»¶å¤§å°æ˜¯æŒ‰ç…§ 1000 å•ä½æ¥è®¡ç®—çš„, è€Œ windows ä¸Šé¢æ˜¯æŒ‰ç…§ 1024 å•ä½æ¥è®¡ç®—çš„.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">76395 / 1000 = 76.395</span><br><span class="line">76395 / 1024 = 74.604</span><br></pre></td></tr></table></figure><blockquote><p>æŒ‰ç…§ GNU çš„ä¹ æƒ¯ï¼Œå•çº¯çš„ <code>K</code> <code>M</code> <code>G</code> <code>T</code> åˆ†åˆ«æŒ‡ä»£ <code>KiB</code> <code>MiB</code> <code>GiB</code> <code>TiB</code> ä»¥ 1024 è¿›åˆ¶æ•°æ®é‡å•ä½ï¼Œç”¨ <code>KB</code> <code>MB</code> <code>GB</code> <code>TB</code> ä»¥ 1000 è¿›åˆ¶æ•°æ®é‡å•ä½. </p></blockquote><p>æ‰€ä»¥, åœ¨ windows ä¸Šé¢å‡†ç¡®è¡¨ç¤º <code>76395bytes</code> åº”è¯¥æ˜¯ <code>74.6KiB</code>.</p><h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><p>åœ¨çº¿è®¡ç®— <a href="http://www.justintools.com/unit-conversion/data-storage.php">å•ä½æ¢ç®—</a>.</p>]]></content>
      
      
      <categories>
          
          <category> MacOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MacOS C æ–‡ä»¶å¤§å°å•ä½ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GO: å†™ç¬¬ä¸€ä¸ª GOLang ç¨‹åº</title>
      <link href="/2018/03/11/GO-%E5%86%99%E7%AC%AC%E4%B8%80%E4%B8%AA-GOLang-%E7%A8%8B%E5%BA%8F/"/>
      <url>/2018/03/11/GO-%E5%86%99%E7%AC%AC%E4%B8%80%E4%B8%AA-GOLang-%E7%A8%8B%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æœ¬æ–‡åˆ†äº«åœ¨ MacOS ä¸Šé¢é€šè¿‡ pkg çš„æ–¹å¼å®‰è£… GO ç¼–ç¨‹ç¯å¢ƒ, ä»¥åŠç¼–è¯‘è¿è¡Œç¬¬ä¸€ä¸ªä½¿ç”¨ GOLang ç¼–å†™çš„ç¨‹åº.</p><p>å…¶ä»–å…³äº GO çš„å®‰è£…æ–¹å¼, å¦‚ä½¿ç”¨ Homebrew å®‰è£…æˆ–è€…ä½¿ç”¨æºç å®‰è£…çš„æ–¹å¼, è¯·è‡ªè¡Œå°è¯•.</p><h2 id="ä¸‹è½½å®‰è£…"><a href="#ä¸‹è½½å®‰è£…" class="headerlink" title="ä¸‹è½½å®‰è£…"></a>ä¸‹è½½å®‰è£…</h2><p>åœ¨ <a href="https://golang.org/doc/install">è¿™é‡Œ</a> ä¸‹è½½ GO çš„ pkg å®‰è£…åŒ….</p><p>ä½†æ˜¯ä½ éœ€è¦ç§‘(fan)å­¦(qiang)æ‰èƒ½ä¸‹è½½.</p><p><img src="/upload/images/2018/03/11/1.jpg" alt="1"></p><p>ä½ ä¹Ÿå¯ä»¥ä¸‹è½½ Stable versions.</p><p>ä¸‹è½½å®Œæˆå, ç›´æ¥åŒå‡»å®‰è£…å³å¯.</p><h2 id="é…ç½®ç¯å¢ƒå˜é‡"><a href="#é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="é…ç½®ç¯å¢ƒå˜é‡"></a>é…ç½®ç¯å¢ƒå˜é‡</h2><p>å®‰è£…å®Œæˆå, GO å®‰è£…ç›®å½•åœ¨ <code>/usr/local</code> ä¸‹é¢.</p><p>å®‰è£…ç›®å½•å¦‚ä¸‹å›¾æ‰€ç¤º:</p><p><img src="/upload/images/2018/03/11/2.jpg" alt="1"></p><p>éœ€è¦å°†å…¶è®¾ç½®åˆ°ç¯å¢ƒå˜é‡ä¸­, æ‰èƒ½åœ¨ç»ˆç«¯ä½¿ç”¨å…¶ç›¸å…³çš„å‘½ä»¤.</p><p>ç¼–è¾‘ <code>~/.bash_profile</code>, å¢åŠ ä¸‹é¢å‡ è¡Œå³å¯.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Golang</span><br><span class="line"></span><br><span class="line">export GOROOT=/usr/local/go</span><br><span class="line">export GOPATH=~/gowork</span><br><span class="line">export PATH=$GOROOT/bin:$GOPATH:$PATH</span><br></pre></td></tr></table></figure><blockquote><p>è®°ä½, GOROOT å’Œ GOPATH å¿…é¡»è®¾ç½®.<br><code>gowork</code> æ˜¯æˆ‘è‡ªå·±æ–°å»ºçš„ç›®å½•. GOPATH å¯ä»¥ç†è§£ä¸ºå·¥ä½œç›®å½•.</p></blockquote><p>å…³äº GOPATH å¯ä»¥å‚è€ƒè¿™ä¸ªæ–‡æ¡£ <a href="https://github.com/golang/go/wiki/SettingGOPATH">SettingGOPATH</a>.</p><p>æˆ‘åˆšå¼€å§‹æ²¡æœ‰é…ç½® GOROOT å˜é‡, æ‰§è¡Œ go å‘½ä»¤ä¼šæç¤ºè­¦å‘Š, è­¦å‘Šå†…å®¹å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">warning: GOPATH set to GOROOT (/usr/local/go) has no effect</span><br></pre></td></tr></table></figure><p>ç¼–è¾‘ä¿å­˜, ç„¶åä½¿å…¶ç«‹å³ç”Ÿæ•ˆ.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bash_profile</span><br></pre></td></tr></table></figure><p>æ£€æŸ¥ç¯å¢ƒå˜é‡æ˜¯å¦ç”Ÿæ•ˆ.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go version</span><br></pre></td></tr></table></figure><p>å¯¹åº”è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go version go1.9.4 darwin/amd64</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>go env</code> æ¥æŸ¥çœ‹æ›´åŠ è¯¦ç»†çš„å†…å®¹.</p><h2 id="ç¼–è¯‘è¿è¡Œ-GOLang-ç¨‹åº"><a href="#ç¼–è¯‘è¿è¡Œ-GOLang-ç¨‹åº" class="headerlink" title="ç¼–è¯‘è¿è¡Œ GOLang ç¨‹åº"></a>ç¼–è¯‘è¿è¡Œ GOLang ç¨‹åº</h2><p><strong>1.ç¼–å†™ä»£ç </strong></p><p>ç¼–è¾‘ä¸€ä¸ª <code>Hello GOLang</code> çš„ç¨‹åº.</p><p>åœ¨ä»»æ„ä¸€ä¸ªæ–‡ä»¶å¤¹ä½ç½®, æ–°å»ºä¸€ä¸ª <code>go_hello.go</code> çš„æ–‡ä»¶.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch go_hello.go</span><br></pre></td></tr></table></figure><p>å†™å…¥å¦‚ä¸‹ç¨‹åº:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import &quot;fmt&quot;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">   fmt.Println(&quot;Hello, GOLang!&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2.ç¼–è¯‘è¿è¡Œ</strong></p><p>ä½¿ç”¨ <code>go build</code> å‘½ä»¤ç¼–è¯‘.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go build go_hello.go</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘æˆåŠŸå, ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ <code>go_hello</code>. æ‰§è¡Œå³å¯.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./go_hello</span><br></pre></td></tr></table></figure><p>æˆ–è€…ç›´æ¥è¿è¡Œ, æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go run go_hello.go </span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¸ä¼šç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶.</p><p>è‡³æ­¤, GO çš„ç¼–ç¨‹ç¯å¢ƒå·²ç»æ­å»ºå®Œæˆ, æ¯”è¾ƒç®€å•.</p><h2 id="å¸è½½-GO"><a href="#å¸è½½-GO" class="headerlink" title="å¸è½½ GO"></a>å¸è½½ GO</h2><p>å¦‚æœä½ æƒ³å¸è½½ GO ç¯å¢ƒ, åªéœ€è¦ä¸‰ä¸ªæ­¥éª¤.</p><p><strong>1.åˆ é™¤å®‰è£…ç›®å½•</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rm -fr /usr/local/go</span><br></pre></td></tr></table></figure><p><strong>2.åˆ é™¤ go æ–‡ä»¶</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rm -f /etc/paths.d/go</span><br></pre></td></tr></table></figure><p><strong>3.åˆ é™¤ç¯å¢ƒå˜é‡</strong></p><p>ç¼–è¾‘ etc, åˆ é™¤å¯¹åº”æ·»åŠ çš„ go ç¯å¢ƒå˜é‡å³å¯.</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://golang.org/doc/install">GO: Getting Started</a></p><p><a href="https://golang.org/doc/">GO: DOC</a></p><p><a href="https://github.com/golang/go/wiki/SettingGOPATH">SettingGOPATH</a></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GOLanguage Google </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C æŒ‡é’ˆä¸ OC å¯¹è±¡ä¹‹é—´çš„è½¬æ¢</title>
      <link href="/2018/03/07/C-%E6%8C%87%E9%92%88%E4%B8%8E-OC-%E5%AF%B9%E8%B1%A1%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2/"/>
      <url>/2018/03/07/C-%E6%8C%87%E9%92%88%E4%B8%8E-OC-%E5%AF%B9%E8%B1%A1%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="Core-Foundation-æ¡†æ¶"><a href="#Core-Foundation-æ¡†æ¶" class="headerlink" title="Core Foundation æ¡†æ¶"></a>Core Foundation æ¡†æ¶</h2><p>Core Foundation æ¡†æ¶ (CoreFoundation.framework) æ˜¯ä¸€ç»„ C è¯­è¨€æ¥å£ï¼Œ ç®€ç§° CF. </p><p>å®ƒä»¬ä¸º iOS åº”ç”¨ç¨‹åºæä¾›åŸºæœ¬æ•°æ®ç®¡ç†å’ŒæœåŠ¡åŠŸèƒ½.</p><p>å¦‚ Core Graphicsã€Core Textï¼Œå¹¶ä¸”æˆ‘ä»¬å¯èƒ½éœ€è¦å°† CF å¯¹è±¡å’ŒOC å¯¹è±¡è¿›è¡Œç›¸äº’è½¬åŒ–ï¼ŒARC ä¸‹ï¼Œç¼–è¯‘å™¨ä¸ä¼šè‡ªåŠ¨ç®¡ç† CF å¯¹è±¡çš„å†…å­˜ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ç®¡ç†. </p><p>åˆ›å»ºä¸€ä¸ª CF å¯¹è±¡ä½¿ç”¨å, éœ€è¦ä½¿ç”¨ CFRelease å°†å…¶æ‰‹åŠ¨é‡Šæ”¾, æ¢å¥è¯è¯´, Core Foundation å¯¹è±¡ç±»å‹ä¸åœ¨ ARC ç®¡ç†èŒƒç•´å†….</p><p>å¦‚ä½•å°† CF å’Œ OC å¯¹è±¡æœ‰æ•ˆçš„ç»“åˆèµ·æ¥, åœ¨ ARC ç¯å¢ƒä¸‹, æä¾›äº† <code>æ¡¥æ¥</code> çš„æŠ€æœ¯, å³ ARC ä¸‹ OC å¯¹è±¡å’Œ Core Foundation å¯¹è±¡ä¹‹é—´çš„æ¡¥æ¢.</p><h2 id="ARC-æ¡¥æ¥"><a href="#ARC-æ¡¥æ¥" class="headerlink" title="ARC æ¡¥æ¥"></a>ARC æ¡¥æ¥</h2><p>ARC ä¸‹ C æŒ‡é’ˆä¸ OC æŒ‡é’ˆ(å¯¹è±¡)ä¹‹é—´è½¬æ¢, ä¸€èˆ¬ä¼šç”¨åˆ°ä¸‹é¢çš„æ–¹æ³•.</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">__bridge_retained &lt;#CF type#&gt;)&lt;<span class="meta">#expression#&gt;</span></span><br><span class="line"></span><br><span class="line">__bridge_transfer &lt;#Objective-C type#&gt;)&lt;<span class="meta">#expression#&gt;</span></span><br><span class="line"></span><br><span class="line">__bridge &lt;<span class="meta">#type#&gt;)<span class="string">&lt;#expression#&gt;</span></span></span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯æ‰€è°“çš„ <code>æ¡¥æ¥</code>, å®ƒæ˜¯ Object-C åœ¨ ARC ç¯å¢ƒä¸‹å¼€å‘å‡ºæ¥çš„ä¸€ç§ç”¨ä½œè½¬æ¢ C æŒ‡é’ˆè·Ÿ OC (ç±»)æŒ‡é’ˆçš„ä¸€ç§è½¬æ¢æŠ€æœ¯, æ‰€ä»¥æ˜¯ ARC ä¸‹çš„ç§°è°“, åœ¨ MRC ä¸‹æ²¡æœ‰ <code>æ¡¥æ¥</code>.</p><p>é’ˆå¯¹å†…å­˜ç®¡ç†é—®é¢˜ï¼ŒARC å¯ä»¥ç®¡ç† Objective-C å¯¹è±¡, ä½†ä¸æ”¯æŒ Core Foundation å¯¹è±¡çš„ç®¡ç†ï¼Œæ‰€ä»¥è½¬æ¢åè¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼šè°æ¥é‡Šæ”¾ä½¿ç”¨åçš„å¯¹è±¡.</p><p>ç»“åˆ ARC å’Œ å†…å­˜ç®¡ç†, ä¸‹é¢åˆ†åˆ«ä»‹ç»ä¸€ä¸‹.</p><p>Core Foundation å¯¹è±¡å¿…é¡»ä½¿ç”¨ CFRetain å’Œ CFRelease æ¥è¿›è¡Œå†…å­˜ç®¡ç†.<br>å½“ä½¿ç”¨ Objective-C å’Œ Core Foundation å¯¹è±¡ç›¸äº’è½¬æ¢çš„æ—¶å€™ï¼Œå¿…é¡»è®©ç¼–è¯‘å™¨çŸ¥é“ï¼Œåˆ°åº•ç”±è°æ¥è´Ÿè´£é‡Šæ”¾å¯¹è±¡ï¼Œæ˜¯å¦äº¤ç»™ ARC å¤„ç†, åªæœ‰æ­£ç¡®çš„å¤„ç†ï¼Œæ‰èƒ½é¿å…å†…å­˜æ³„æ¼å’Œ double free å¯¼è‡´ç¨‹åºå´©æºƒ.</p><h2 id="bridge-retained-lt-CF-type-gt-lt-expression-gt"><a href="#bridge-retained-lt-CF-type-gt-lt-expression-gt" class="headerlink" title="__bridge_retained &lt;#CF type#&gt;)&lt;#expression#&gt;"></a>__bridge_retained &lt;#CF type#&gt;)&lt;#expression#&gt;</h2><p><code>__bridge_retained</code> ç­‰åŒäº <code>CFBridgingRetain()</code>.</p><p>å°† Objective-C å¯¹è±¡è½¬æ¢ä¸º Core Foundation å¯¹è±¡ï¼ŒæŠŠå¯¹è±¡æ‰€æœ‰æƒæ¡¥æ¥ç»™ Core Foundation å¯¹è±¡ï¼ŒåŒæ—¶å‰¥å¤º ARC çš„ç®¡ç†æƒï¼Œåç»­éœ€è¦å¼€å‘è€…ä½¿ç”¨ CFRelease æˆ–è€…ç›¸å…³æ–¹æ³•æ‰‹åŠ¨æ¥é‡Šæ”¾ CF å¯¹è±¡.</p><p>ç¤ºä¾‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> *cPointer;</span><br><span class="line"><span class="built_in">NSObject</span> *objc = [[<span class="built_in">NSObject</span> alloc] init];</span><br><span class="line"></span><br><span class="line"><span class="comment">//å°† OC å¯¹è±¡è½¬æ¢ä¸º C æŒ‡é’ˆ</span></span><br><span class="line">cPointer = (__bridge_retained <span class="keyword">void</span>*)objc;</span><br><span class="line"></span><br><span class="line"><span class="comment">//use cPointer ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//éœ€è¦é‡Šæ”¾èµ„æº</span></span><br><span class="line"><span class="built_in">CFRelease</span>(cPointer);</span><br></pre></td></tr></table></figure><p>åœ¨ ARC ä¸‹, CFBridgingRetain å®ç°å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NS_INLINE</span> <span class="built_in">CF_RETURNS_RETAINED</span> <span class="built_in">CFTypeRef</span> _Nullable <span class="built_in">CFBridgingRetain</span>(<span class="keyword">id</span> _Nullable X) &#123;</span><br><span class="line">    <span class="keyword">return</span> (__bridge_retained <span class="built_in">CFTypeRef</span>)X;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³äº CFTypeRef, å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">const</span> <span class="built_in">CF_BRIDGED_TYPE</span>(<span class="keyword">id</span>) <span class="keyword">void</span> * <span class="built_in">CFTypeRef</span>;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ CFBridgingRetain è¿”å›å€¼æ˜¯ <code>const void *</code> ç±»å‹çš„.</p><p>ä¸Šé¢çš„ç¤ºä¾‹å¯ä»¥æ”¹å†™ä¸º:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">void</span> *cPointer;</span><br><span class="line"><span class="keyword">const</span> <span class="built_in">NSObject</span> *objc = [[<span class="built_in">NSObject</span> alloc] init];</span><br><span class="line">cPointer = <span class="built_in">CFBridgingRetain</span>(objc);</span><br><span class="line">    </span><br><span class="line"><span class="comment">//use cPointer ...</span></span><br><span class="line">    </span><br><span class="line"><span class="built_in">CFRelease</span>(cPointer);</span><br></pre></td></tr></table></figure><h2 id="bridge-transfer-lt-Objective-C-type-gt-lt-expression-gt"><a href="#bridge-transfer-lt-Objective-C-type-gt-lt-expression-gt" class="headerlink" title="__bridge_transfer &lt;#Objective-C type#&gt;)&lt;#expression#&gt;"></a>__bridge_transfer &lt;#Objective-C type#&gt;)&lt;#expression#&gt;</h2><p><code>__bridge_transfer</code> ç­‰åŒäº <code>CFBridgingRelease()</code>.</p><p>å°†é OC å¯¹è±¡è½¬æ¢ä¸º OC å¯¹è±¡ï¼ŒåŒæ—¶å°†å¯¹è±¡çš„ç®¡ç†æƒäº¤ç»™ ARCï¼Œå¼€å‘è€…æ— éœ€æ‰‹åŠ¨ç®¡ç†å†…å­˜.</p><p>ç¤ºä¾‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">CFUUIDRef</span> uuid = <span class="built_in">CFUUIDCreate</span>(kCFAllocatorDefault);</span><br><span class="line"><span class="built_in">CFStringRef</span> strUUID = <span class="built_in">CFUUIDCreateString</span>(kCFAllocatorDefault, uuid);</span><br><span class="line"><span class="built_in">NSString</span> *str = (__bridge_transfer <span class="built_in">NSString</span> *)strUUID;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ— éœ€é‡Šæ”¾ strUUID</span></span><br><span class="line"><span class="comment">//CFRelease(strUUID);</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">CFRelease</span>(uuid);</span><br></pre></td></tr></table></figure><p>CFBridgingRelease å®ç°å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NS_INLINE</span> <span class="keyword">id</span> _Nullable <span class="built_in">CFBridgingRelease</span>(<span class="built_in">CFTypeRef</span> <span class="built_in">CF_CONSUMED</span> _Nullable X) &#123;</span><br><span class="line">    <span class="keyword">return</span> (__bridge_transfer <span class="keyword">id</span>)X;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ç¤ºä¾‹å¯ä»¥æ”¹å†™ä¸º:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">CFUUIDRef</span> uuid = <span class="built_in">CFUUIDCreate</span>(kCFAllocatorDefault);</span><br><span class="line"><span class="built_in">CFStringRef</span> strUUID = <span class="built_in">CFUUIDCreateString</span>(kCFAllocatorDefault, uuid);</span><br><span class="line"><span class="built_in">NSString</span> *str = <span class="built_in">CFBridgingRelease</span>(strUUID);</span><br><span class="line">    </span><br><span class="line"><span class="comment">//æ— éœ€é‡Šæ”¾ strUUID</span></span><br><span class="line"><span class="comment">//CFRelease(strUUID);</span></span><br><span class="line">    </span><br><span class="line"><span class="built_in">CFRelease</span>(uuid);</span><br></pre></td></tr></table></figure><h2 id="bridge"><a href="#bridge" class="headerlink" title="__bridge"></a>__bridge</h2><p><code>__bridge</code> ä¸æ”¹å˜å¯¹è±¡æ‰€æœ‰æƒ, éœ€è¦æˆ‘ä»¬è‡ªå·±æ¥ç®¡ç†å†…å­˜, å®ƒä¹Ÿæ˜¯æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„æ–¹æ³•, ä»æŸç§ç¨‹åº¦ä¸Šæ¥è¯´, å®ƒæ˜¯ä¸Šé¢ä¸¤ä¸ªæ–¹æ³•çš„ç®€åŒ–ç‰ˆæœ¬.</p><p><code>__bridge</code> å¯ä»¥å°† OC å¯¹è±¡ ä¸ C æŒ‡é’ˆç›¸äº’è½¬æ¢, ç¤ºä¾‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//CFString -&gt; OC å¯¹è±¡</span></span><br><span class="line"><span class="built_in">CFStringRef</span> cfString = <span class="built_in">CFStringCreateWithCString</span>(kCFAllocatorDefault, <span class="string">&quot;very&quot;</span>, kCFStringEncodingUTF8);</span><br><span class="line"><span class="built_in">NSString</span> *nsString = (__bridge <span class="built_in">NSString</span> *)cfString;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;CFString -&gt; NSString: %@&quot;</span>, nsString);</span><br><span class="line"><span class="built_in">CFRelease</span>(cfString);</span><br></pre></td></tr></table></figure><p>å¦‚æœå°† <code>CFRelease(cfString)</code> æ³¨é‡Šæ‰, Xcode çš„é™æ€æ£€æµ‹å™¨ä¼šå‘Šè¯‰ä½ æœ‰å†…å­˜æ³„éœ²çš„æƒ…å†µ, å¦‚å›¾:<br><img src="/upload/images/2018/03/07/2.png" alt="1"></p><p>å†æ¥å¦å¤–ä¸€ä¸ªä¾‹å­, å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//OC å¯¹è±¡ -&gt; CFString</span></span><br><span class="line"><span class="built_in">NSString</span> *nstr = <span class="string">@&quot;itman&quot;</span>;</span><br><span class="line"><span class="built_in">CFStringRef</span> cfStringRef = (__bridge <span class="built_in">CFStringRef</span>)nstr;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;NSString -&gt; CFString: %@&quot;</span>, cfStringRef);</span><br><span class="line"><span class="built_in">CFRelease</span>(cfStringRef);</span><br></pre></td></tr></table></figure><p>æ— è®ºæ˜¯ä½¿ç”¨ <code>CFRelease(cfStringRef)</code>, è¿˜æ˜¯æ³¨é‡Šæ‰ <code>CFRelease(cfStringRef)</code>, é™æ€æ£€æµ‹å™¨éƒ½ä¸ä¼šæŠ¥é”™. è¯´æ˜è¿™ç§æƒ…å†µä¸‹, å½“å‰çš„å†…å­˜ç®¡ç†å·²ç»è¢« OC å¯¹è±¡ç®¡ç†.</p><h2 id="ç»å…¸ä¾‹å­"><a href="#ç»å…¸ä¾‹å­" class="headerlink" title="ç»å…¸ä¾‹å­"></a>ç»å…¸ä¾‹å­</h2><h3 id="NSString-ä¸-CFString-è½¬æ¢"><a href="#NSString-ä¸-CFString-è½¬æ¢" class="headerlink" title="NSString ä¸ CFString è½¬æ¢"></a>NSString ä¸ CFString è½¬æ¢</h3><p>1ã€NSString â†’ CFString</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *string = <span class="string">@&quot;veryitman.com&quot;</span>;</span><br><span class="line">    <span class="comment">// æ–¹æ³•1: ä¸éœ€è¦é‡Šæ”¾</span></span><br><span class="line">    <span class="built_in">CFStringRef</span> cfStr = (__bridge <span class="built_in">CFStringRef</span>)string;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ–¹æ³•2: éœ€è¦é‡Šæ”¾, è¿™é‡Œ retain äº†</span></span><br><span class="line">    <span class="built_in">CFStringRef</span> cfStr2 = (__bridge_retained <span class="built_in">CFStringRef</span>)string;</span><br><span class="line">    <span class="built_in">CFRelease</span>(cfStr2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ã€CFString â†’ NSString</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">CFStringRef</span> cfStr = <span class="built_in">CFStringCreateWithCString</span>(kCFAllocatorDefault, <span class="string">&quot;veryitman&quot;</span>, kCFStringEncodingUnicode);</span><br><span class="line">    </span><br><span class="line"><span class="comment">// æ–¹æ³•1: éœ€è¦é‡Šæ”¾</span></span><br><span class="line"><span class="built_in">NSString</span> *string = (__bridge <span class="built_in">NSString</span> *)cfStr;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;OC string: %@&quot;</span>, string);</span><br><span class="line"><span class="built_in">CFRelease</span>(cfStr);</span><br><span class="line">    </span><br><span class="line"><span class="comment">// æ–¹æ³•2: ä¸éœ€è¦é‡Šæ”¾, __bridge_transfer è‡ªå¸¦ release</span></span><br><span class="line">string = (__bridge_transfer <span class="built_in">NSString</span> *)cfStr;</span><br></pre></td></tr></table></figure><h3 id="é‡æŒ‡é’ˆ"><a href="#é‡æŒ‡é’ˆ" class="headerlink" title="é‡æŒ‡é’ˆ"></a>é‡æŒ‡é’ˆ</h3><p>è¿è¡Œä¸‹é¢çš„ç¤ºä¾‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> *p;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSObject</span> *objc = [[<span class="built_in">NSObject</span> alloc] init];</span><br><span class="line">    p = (__bridge <span class="keyword">void</span>*)objc;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;mark: %@&quot;</span>, (__bridge <span class="built_in">NSObject</span>*)p);</span><br></pre></td></tr></table></figure><p>ä¼šç›´æ¥ crash, å¦‚å›¾:</p><p><img src="/upload/images/2018/03/07/1.jpg" alt="1"></p><p>å½“ <code>objc</code> è¿™ä¸ªå¯¹è±¡è¶…å‡ºä½œç”¨åŸŸèŒƒå›´ï¼Œå…¶å†…å­˜å°±ä¼šè¢«å›æ”¶ï¼Œæ¥ç€åœ¨ä½œç”¨åŸŸèŒƒå›´å¤–ç”¨ <code>void *p</code> å»è®¿é—® <code>objc</code> çš„å†…å­˜ï¼Œå°±é€ æˆäº†é‡æŒ‡é’ˆ.</p><p>ç»“åˆä¸Šé¢æ‰€è¯´çš„, æˆ‘ä»¬å¯ä»¥è®©æŒ‡é’ˆ p å¯¹ objc è¿›è¡Œå¼•ç”¨å³ retain æ“ä½œ, ä¿®æ”¹å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> *p;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSObject</span> *objc = [[<span class="built_in">NSObject</span> alloc] init];</span><br><span class="line">    <span class="comment">//p = (__bridge void*)objc;</span></span><br><span class="line">    p = (__bridge_retained <span class="keyword">void</span>*)objc;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;mark: %@&quot;</span>, (__bridge <span class="built_in">NSObject</span>*)p);</span><br><span class="line">    </span><br><span class="line"><span class="comment">// ä¸€å®šè¦é‡Šæ”¾</span></span><br><span class="line"><span class="built_in">CFRelease</span>(p);</span><br></pre></td></tr></table></figure><p>å¯ä»¥æ­£å¸¸çš„è¿è¡Œ. è¿˜å¯ä»¥ä¿®æ”¹ä¸ºå¦ä¸€ç§æ–¹å¼:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> *p;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSObject</span> *objc = [[<span class="built_in">NSObject</span> alloc] init];</span><br><span class="line">    <span class="comment">//p = (__bridge void*)objc;</span></span><br><span class="line">    <span class="comment">//p = (__bridge_retained void*)objc;</span></span><br><span class="line">    p = (<span class="keyword">void</span> *)<span class="built_in">CFBridgingRetain</span>(objc);</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;mark: %@&quot;</span>, (__bridge <span class="built_in">NSObject</span>*)p);</span><br><span class="line">    </span><br><span class="line"><span class="comment">// ä¸€å®šè¦é‡Šæ”¾</span></span><br><span class="line"><span class="built_in">CFRelease</span>(p);</span><br></pre></td></tr></table></figure><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Objective-C ARC Foundation </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éŸ³è§†é¢‘ç¼–ç¨‹: iOS æ¨æµ</title>
      <link href="/2018/02/26/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E6%8E%A8%E6%B5%81/"/>
      <url>/2018/02/26/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E6%8E%A8%E6%B5%81/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç¯‡åˆ†äº«æ˜¯åŸºäº <a href="http://www.veryitman.com/2018/02/25/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E6%9E%84%E5%BB%BA-nginx-%E6%8E%A8%E6%B5%81%E6%9C%8D%E5%8A%A1%E5%99%A8/">éŸ³è§†é¢‘ç¼–ç¨‹: æ„å»º nginx æ¨æµæœåŠ¡å™¨</a> è¿™ç¯‡æ–‡ç« çš„, ä¹‹å‰æ˜¯ä½¿ç”¨ ffmpeg å‘½ä»¤è¿›è¡Œæ¨æµå¹¶ä¸”éƒ½æ˜¯åœ¨ macos ä¸Šé¢è¿›è¡Œçš„æ“ä½œ.</p><p>ç°åœ¨åœ¨ iOS å¹³å°ä¸Šä½¿ç”¨ <a href="https://github.com/LaiFengiOS/LFLiveKit">LFLiveKit</a> è¿›è¡Œæ¨æµ, ç„¶åä½¿ç”¨ VLC æ’­æ”¾å™¨æ’­æ”¾æµè§†é¢‘.</p><p><strong>è¯¥ç³»åˆ—åšæ–‡:</strong></p><ul><li><p><a href="http://www.veryitman.com/2018/02/14/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%BC%96%E8%AF%91-faac-faad2/">éŸ³è§†é¢‘ç¼–ç¨‹: ç¼–è¯‘ faac&#x2F;faad2</a></p></li><li><p><a href="http://www.veryitman.com/2018/02/16/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faac-%E7%BC%96%E7%A0%81/">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faac ç¼–ç </a></p></li><li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-WAV-%E6%96%87%E4%BB%B6/">éŸ³è§†é¢‘ç¼–ç¨‹: ç®€å•åˆ†æ WAV æ–‡ä»¶</a></p></li><li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faad2/">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faad2</a> </p></li><li><p><a href="http://www.veryitman.com/2018/02/25/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E6%9E%84%E5%BB%BA-nginx-%E6%8E%A8%E6%B5%81%E6%9C%8D%E5%8A%A1%E5%99%A8/">éŸ³è§†é¢‘ç¼–ç¨‹: æ„å»º nginx æ¨æµæœåŠ¡å™¨</a></p></li><li><p><a href="http://www.veryitman.com/2018/02/26/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E6%8E%A8%E6%B5%81/">éŸ³è§†é¢‘ç¼–ç¨‹: iOS æ¨æµ</a> (æœ¬ç¯‡)</p></li></ul><h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><p>ä¸€èˆ¬ç›´æ’­è¿‡ç¨‹åŒ…æ‹¬å¯¹éŸ³è§†é¢‘çš„é‡‡é›†ã€å¤„ç†ã€ç¼–ç ã€å°åŒ…ã€æ¨æµã€ä¼ è¾“ã€è½¬ç ã€åˆ†å‘ã€è§£ç ã€æ’­æ”¾ç­‰. </p><p><strong>æ¨æµ</strong>, æŒ‡ä½¿ç”¨æ¨æµå·¥å…·æŠŠç›´æ’­å†…å®¹ä¼ è¾“åˆ°æœåŠ¡å™¨çš„è¿‡ç¨‹. æœ¬ç¯‡åˆ†äº«ä½¿ç”¨ LFLiveKit å·¥å…·å°† iPhone æ‘„åƒå¤´å’Œéº¦å…‹é£é‡‡é›†çš„æ•°æ®æ¨æµåˆ°æœ¬åœ°æµæœåŠ¡å™¨.</p><p><strong>æ‹‰æµ</strong>, æŒ‡å¯¹æœåŠ¡å™¨ç›´æ’­çš„å†…å®¹ï¼Œç”¨æŒ‡å®šåœ°å€è¿›è¡Œæ‹‰å–(æ’­æ”¾)çš„è¿‡ç¨‹, æœ¬ç¯‡åˆ†äº«ä½¿ç”¨ VLC å……å½“æ‹‰æµçš„è§’è‰².</p><h2 id="é›†æˆ-LFLiveKit"><a href="#é›†æˆ-LFLiveKit" class="headerlink" title="é›†æˆ LFLiveKit"></a>é›†æˆ LFLiveKit</h2><p>LFLiveKit æ˜¯ä¸€ä¸ªå¼€æºçš„æ¨æµ SDK, æ”¯æŒ H264 and AAC çš„ç¡¬ç¼–ç , æ”¯æŒç¾é¢œ(é›†æˆäº† GPUImage).</p><p>ä½¿ç”¨ LFLiveKit æ¯”è¾ƒç®€å•, æŒ‰ç…§å…¶ demo é›†æˆå³å¯.</p><p><strong>1.å·¥ç¨‹é…ç½®info.plist</strong></p><p>éœ€è¦è®¿é—®ç›¸æœºå’Œéº¦å…‹é£æƒé™.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Privacy - Camera Usage Description</span><br><span class="line"></span><br><span class="line">Privacy - Microphone Usage Description</span><br></pre></td></tr></table></figure><p><strong>2.è¯·æ±‚ç›¸æœºå’Œéº¦å…‹é£æƒé™.</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">- (void)requestAccessForVideo &#123;</span><br><span class="line">    </span><br><span class="line">    __weak typeof(self) _self = self;</span><br><span class="line">    AVAuthorizationStatus status = [AVCaptureDevice authorizationStatusForMediaType:AVMediaTypeVideo];</span><br><span class="line">    </span><br><span class="line">    switch (status) &#123;</span><br><span class="line">            </span><br><span class="line">        case AVAuthorizationStatusNotDetermined: &#123;</span><br><span class="line">            </span><br><span class="line">            [AVCaptureDevice requestAccessForMediaType:AVMediaTypeVideo completionHandler:^(BOOL granted) &#123;</span><br><span class="line">                </span><br><span class="line">                if (granted) &#123;</span><br><span class="line">                    </span><br><span class="line">                    dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                        [_self.session setRunning:YES];</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;];</span><br><span class="line">            </span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">            </span><br><span class="line">        case AVAuthorizationStatusAuthorized: &#123;</span><br><span class="line">            </span><br><span class="line">            dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                [_self.session setRunning:YES];</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">            </span><br><span class="line">        case AVAuthorizationStatusDenied:</span><br><span class="line">        case AVAuthorizationStatusRestricted:</span><br><span class="line">            // ç”¨æˆ·æ˜ç¡®åœ°æ‹’ç»æˆæƒï¼Œæˆ–è€…ç›¸æœºè®¾å¤‡æ— æ³•è®¿é—®</span><br><span class="line">            break;</span><br><span class="line">            </span><br><span class="line">        default:</span><br><span class="line">            break;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)requestAccessForAudio &#123;</span><br><span class="line">    </span><br><span class="line">    AVAuthorizationStatus status = [AVCaptureDevice authorizationStatusForMediaType:AVMediaTypeAudio];</span><br><span class="line">    </span><br><span class="line">    switch (status) &#123;</span><br><span class="line">            </span><br><span class="line">        case AVAuthorizationStatusNotDetermined: &#123;</span><br><span class="line">            [AVCaptureDevice requestAccessForMediaType:AVMediaTypeAudio completionHandler:^(BOOL granted) &#123;</span><br><span class="line">            &#125;];</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">            </span><br><span class="line">        case AVAuthorizationStatusAuthorized: &#123;</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">            </span><br><span class="line">        case AVAuthorizationStatusDenied:</span><br><span class="line">        case AVAuthorizationStatusRestricted:</span><br><span class="line">            break;</span><br><span class="line">        default:</span><br><span class="line">            break;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŠ¡å¿…è¦è°ƒç”¨ LFLiveSession çš„ <code>setRunning</code> æ–¹æ³•.</p><p>å®Œæ•´çš„å·¥ç¨‹ä»£ç , åç»­æˆ‘ä¼šæ”¾åˆ° Github ä¸Šé¢. æ–¹ä¾¿æœ‰éœ€è¦çš„ä¸‹è½½.</p><h2 id="æ¨æµæ’­æ”¾"><a href="#æ¨æµæ’­æ”¾" class="headerlink" title="æ¨æµæ’­æ”¾"></a>æ¨æµæ’­æ”¾</h2><p>ä¸Šé¢çš„åŸºæœ¬é…ç½®å®Œæˆå, å¯ä»¥å¼€å§‹æ¨æµäº†.</p><p><strong>1.å¯åŠ¨ nginx</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nginx</span><br></pre></td></tr></table></figure><p><strong>2.å¯åŠ¨æ¨æµ</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (void)startLive &#123;</span><br><span class="line">    </span><br><span class="line">    LFLiveStreamInfo *streamInfo = [LFLiveStreamInfo new];</span><br><span class="line">    streamInfo.url = sRTMPUrl;</span><br><span class="line">    [self.session startLive:streamInfo];</span><br><span class="line">    self.session.beautyFace = YES;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ <code>sRTMPUrl</code> æ˜¯ä¸€ä¸ªå¸¸é‡å®šä¹‰:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">static NSString * const sRTMPUrl = @&quot;rtmp://192.168.1.102:1935/rtmplive/channel&quot;;</span><br></pre></td></tr></table></figure><p><code>192.168.1.102</code> æ˜¯æˆ‘çš„æœ¬æœº(mac) ip åœ°å€.</p><p>å¦‚æœä¸€åˆ‡æ­£å¸¸çš„è¯, ä½ åœ¨æ‰‹æœºä¸Šé¢å¯ä»¥çœ‹åˆ°è‡ªå·±çš„é¢„è§ˆç”»é¢.</p><p><strong>3.VLC æ’­æ”¾</strong></p><p>ä½¿ç”¨ VLC æ’­æ”¾ rtmp çš„æµ, æ‰“å¼€ VLC æ’­æ”¾å™¨, é€‰æ‹© File&#x2F;Open Network, è¾“å…¥ <code>rtmp://192.168.1.102:1935/rtmplive/channel</code> è¿™ä¸ªåœ°å€å³å¯å®æ—¶æ’­æ”¾äº†.</p><p>è¿™é‡Œæ³¨æ„ä¸€å®šè¦ä½¿ç”¨æœ¬æœºçš„ ip åœ°å€, ä¸è¦ä½¿ç”¨ <code>localhost:1935</code> ç±»ä¼¼çš„åœ°å€, å¦åˆ™æ— æ³•æ’­æ”¾å’Œæ¨æµ.</p><p>åç»­åˆ†äº«å¦‚ä½•åœ¨ iOS ä¸Šé¢ä½¿ç”¨æ’­æ”¾å™¨æ¥æ’­æ”¾ç›´æ’­æµ.</p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éŸ³è§†é¢‘ rtmp nginx æ¨æµ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éŸ³è§†é¢‘ç¼–ç¨‹: æ„å»º nginx æ¨æµæœåŠ¡å™¨</title>
      <link href="/2018/02/25/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E6%9E%84%E5%BB%BA-nginx-%E6%8E%A8%E6%B5%81%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
      <url>/2018/02/25/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E6%9E%84%E5%BB%BA-nginx-%E6%8E%A8%E6%B5%81%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æœ¬ç¯‡åˆ†äº«çš„ä¸»è¦å†…å®¹</p></blockquote><p>å¦‚ä½•åœ¨ macos ä¸­æ„å»ºæœ¬åœ°çš„æ¨æµæœåŠ¡å™¨(nginx + rtmp-nginx-module), å¹¶ä½¿ç”¨ ffmpeg å‘½ä»¤è¿›è¡Œè§†é¢‘æ¨æµ, ç„¶åä½¿ç”¨ VLC æ’­æ”¾å™¨æ’­æ”¾è§†é¢‘.</p><p><strong>è¯¥ç³»åˆ—åšæ–‡:</strong></p><ul><li><p><a href="http://www.veryitman.com/2018/02/14/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%BC%96%E8%AF%91-faac-faad2/">éŸ³è§†é¢‘ç¼–ç¨‹: ç¼–è¯‘ faac&#x2F;faad2</a></p></li><li><p><a href="http://www.veryitman.com/2018/02/16/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faac-%E7%BC%96%E7%A0%81/">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faac ç¼–ç </a></p></li><li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-WAV-%E6%96%87%E4%BB%B6/">éŸ³è§†é¢‘ç¼–ç¨‹: ç®€å•åˆ†æ WAV æ–‡ä»¶</a></p></li><li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faad2/">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faad2</a> </p></li><li><p><a href="http://www.veryitman.com/2018/02/25/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E6%9E%84%E5%BB%BA-nginx-%E6%8E%A8%E6%B5%81%E6%9C%8D%E5%8A%A1%E5%99%A8/">éŸ³è§†é¢‘ç¼–ç¨‹: æ„å»º nginx æ¨æµæœåŠ¡å™¨</a> (æœ¬ç¯‡)</p></li></ul><h2 id="å®‰è£…-rtmp-nginx-module"><a href="#å®‰è£…-rtmp-nginx-module" class="headerlink" title="å®‰è£… rtmp-nginx-module"></a>å®‰è£… rtmp-nginx-module</h2><p>ä¹‹å‰åœ¨æµ‹è¯• php ç¨‹åºçš„æ—¶å€™, æˆ‘å·²ç»å®‰è£…è¿‡ nginx, ä½†æ˜¯å‘ç°è¿™æ ·åœ¨é…ç½® rtmp-nginx-module çš„æ—¶å€™, æ— æ³•æˆåŠŸ.</p><p>é…ç½®æ–‡ä»¶ä¿®æ”¹å®Œæˆä¹‹å, nginx æ€»æ˜¯æ— æ³•è¯†åˆ« <code>rtmp</code>, æŠ¥é”™å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[emerg] 30766#0: unknown directive &quot;rtmp&quot; in /usr/local/etc/nginx/nginx.conf:40</span><br></pre></td></tr></table></figure><p>ç°åœ¨éœ€è¦å¸è½½åŸæ¥å·²ç»å®‰è£…çš„ nginx, å‘½ä»¤å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew uninstall nginx</span><br></pre></td></tr></table></figure><p>å†æ¬¡å®‰è£…:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install nginx-full --with-rtmp-module </span><br></pre></td></tr></table></figure><p>è€å¿ƒç­‰å¾…ä¸€ä¼š ~~</p><p>nginx çš„ç‰ˆæœ¬(nginx -v):</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx/1.12.2</span><br></pre></td></tr></table></figure><p>rtmp-nginx-module ç‰ˆæœ¬:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1.1.7.11-dev_2</span><br></pre></td></tr></table></figure><h2 id="é…ç½®-rtmp"><a href="#é…ç½®-rtmp" class="headerlink" title="é…ç½® rtmp"></a>é…ç½® rtmp</h2><p>ç¼–è¾‘ nginx çš„é…ç½®æ–‡ä»¶, æ–‡ä»¶ä½ç½®ä½äº:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/etc/nginx/nginx.conf</span><br></pre></td></tr></table></figure><p>åœ¨ <code>http &#123;&#125;</code> åé¢å†™å…¥å¦‚ä¸‹å†…å®¹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">rtmp &#123;</span><br><span class="line">   server &#123;</span><br><span class="line">        #rtmpåè®®çš„é»˜è®¤ç«¯å£å·æ˜¯ 1935</span><br><span class="line">        listen 1935;</span><br><span class="line">        #ç›´æ’­æµé…ç½®, è®¿é—® path æ˜¯ rtmplive</span><br><span class="line">        application rtmplive &#123;</span><br><span class="line">              #å¼€å¯å®æ—¶</span><br><span class="line">              live on;</span><br><span class="line">              #è®¾ç½® rtmp å¼•æ“çš„æœ€å¤§è¿æ¥æ•°. é»˜è®¤ä¸ºoff</span><br><span class="line">              max_connections 1024;</span><br><span class="line">              #ä¸è®°å½•æ•°æ®</span><br><span class="line">             record off;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„: <code>rtmplive</code> æ˜¯å›ºå®šçš„.</p><p>å…·ä½“çš„ nginx é…ç½®è¯¦è§åé¢çš„é™„å½•å†…å®¹.</p><h2 id="æ¨æµ"><a href="#æ¨æµ" class="headerlink" title="æ¨æµ"></a>æ¨æµ</h2><p>**1.å®‰è£… ffmpeg å³å¯. **</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install ffmpeg</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè¿‡ç¨‹æœ‰ç‚¹ä¹…, å¦‚æœä½ æ²¡æœ‰æ¢¯å­åŸºæœ¬å®‰è£…ä¸äº† [å¤§å“­]~</p><p><strong>2.å®‰è£… VLC</strong></p><p>ç›´æ¥å»å®˜ç½‘ä¸‹è½½ dmg åŒ…, å®‰è£…å³å¯.</p><p>æ‰“å¼€ VLC ç„¶åé€‰æ‹©ä» File&#x2F;Open Network æ‰“å¼€æ–‡ä»¶, å¦‚ä¸‹å›¾æ‰€ç¤º:</p><p><img src="/upload/images/2018/02/25/1.jpg" alt="1"></p><p>åœ¨å¼¹å‡ºçš„æ¡†ä¸­, å†™å…¥æ¨æµåœ°å€ <code>rtmp://localhost:1935/rtmplive/channel</code>, å¦‚å›¾æ‰€ç¤º:</p><p><img src="/upload/images/2018/02/25/2.jpg" alt="1"></p><p>ç›´æ¥ç‚¹å‡» Open.</p><blockquote><p>æ³¨æ„: å¦‚æœ localhost æ— æ³•æ’­æ”¾, è¯·æ›´æ¢ä¸ºä½ çš„æœ¬æœº ip, å¦‚æˆ‘çš„æœ¬æœº ip æ˜¯ <code>192.168.1.122</code>, å¯¹åº”çš„æ’­æ”¾åœ°å€ä¸º <code>rtmp://192.168.1.122:1935/rtmplive/channel</code>.<br>å¦‚æœè¿˜æ˜¯æ— æ³•æˆåŠŸ, è¯·å…³é—­ macos çš„é˜²ç«å¢™.</p></blockquote><p><strong>3.å¯åŠ¨ nginx</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nginx</span><br></pre></td></tr></table></figure><p>å¯ä»¥åœ¨æµè§ˆå™¨è®¿é—®å¦‚ä¸‹åœ°å€, çœ‹çœ‹ nginx æ˜¯å¦å¯åŠ¨æˆåŠŸ.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/index.html</span><br></pre></td></tr></table></figure><p><strong>4.ffmpeg æ¨æµ</strong></p><p>æ¨æµçš„å‘½ä»¤å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -re -i ~/Desktop/launcher.mp4 -vcodec libx264 -acodec aac -strict -2 -f flv rtmp://localhost:1935/rtmplive/channel</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>launcher.mp4</code> æ˜¯æˆ‘è‡ªå·±ä»ç½‘ç»œä¸Šé¢ä¸‹è½½çš„ä¸€ä¸ªè§†é¢‘æ–‡ä»¶, æ—¶é•¿å¤§çº¦æ˜¯ 5 åˆ†é’Ÿ.</p><p>åœ¨ VLC ä¸­, å°±å¯ä»¥çœ‹åˆ°æ¨æµæ’­æ”¾çš„è§†é¢‘äº†. [å¼€å¿ƒ]~~</p><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><h3 id="nginx-é…ç½®æ–‡ä»¶"><a href="#nginx-é…ç½®æ–‡ä»¶" class="headerlink" title="nginx é…ç½®æ–‡ä»¶"></a>nginx é…ç½®æ–‡ä»¶</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1;</span><br><span class="line"> </span><br><span class="line">error_log  /usr/local/etc/nginx/logs/error.log debug;</span><br><span class="line"></span><br><span class="line">pid        /usr/local/var/run/nginx.pid;</span><br><span class="line"> </span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  256;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">http &#123;</span><br><span class="line">    include             mime.types;</span><br><span class="line">    default_type        application/octet-stream;</span><br><span class="line"> </span><br><span class="line">    log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br><span class="line">                      &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class="line">                      &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br><span class="line"> </span><br><span class="line">    access_log  /usr/local/etc/nginx/logs/access.log  main;</span><br><span class="line"> </span><br><span class="line">    sendfile            on;</span><br><span class="line"> </span><br><span class="line">    keepalive_timeout   65;</span><br><span class="line"> </span><br><span class="line">    index index.html index.php;</span><br><span class="line"> </span><br><span class="line">    include /usr/local/etc/nginx/sites-enabled/*; </span><br><span class="line">    include /usr/local/etc/nginx/conf.d/*;</span><br><span class="line"></span><br><span class="line">     server &#123;</span><br><span class="line">        listen       8080;</span><br><span class="line">        server_name  localhost;</span><br><span class="line"></span><br><span class="line">        #charset koi8-r;</span><br><span class="line"></span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   /Users/me/workspace/projs/phpwork/; #webçš„æ ¹ç›®å½•</span><br><span class="line">            index  index.php index.html index.htm; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rtmp &#123;</span><br><span class="line">   server &#123;</span><br><span class="line">        #rtmpåè®®çš„é»˜è®¤ç«¯å£å·æ˜¯1935</span><br><span class="line">        listen 1935;</span><br><span class="line">        #ç›´æ’­æµé…ç½®,è®¿é—®è·¯å¾„æ˜¯rtmplive</span><br><span class="line">        application rtmplive &#123;</span><br><span class="line">              #å¼€å¯å®æ—¶</span><br><span class="line">              live on;</span><br><span class="line">              #ä¸ºrtmpå¼•æ“è®¾ç½®æœ€å¤§è¿æ¥æ•°.é»˜è®¤ä¸ºoff</span><br><span class="line">              max_connections 1024;</span><br><span class="line">              #ä¸è®°å½•æ•°æ®</span><br><span class="line">             record off;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è§†é¢‘æ–‡ä»¶"><a href="#è§†é¢‘æ–‡ä»¶" class="headerlink" title="è§†é¢‘æ–‡ä»¶"></a>è§†é¢‘æ–‡ä»¶</h2><p>ä½¿ç”¨ä¸‹è½½çš„ mp4 æ–‡ä»¶, æœ‰äº›æ— æ³•æ’­æ”¾, æš‚æ—¶ä¼°è®¡åº”è¯¥æ˜¯ç ç‡çš„é—®é¢˜, å¤§å®¶åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­, å‘ç°è§†é¢‘æ— æ³•æ’­æ”¾, æœ€åè¯•è¯•å…¶ä»–è§†é¢‘æ–‡ä»¶.</p><p>å¦å¤–, è§†é¢‘æ–‡ä»¶ä¸è¦å¤ªå°, å°½é‡èƒ½è®©å…¶æ’­æ”¾æ—¶é•¿åœ¨ 3-5 åˆ†é’Ÿ.</p><h2 id="brew-install-x2F-uninstall-æŠ¥é”™"><a href="#brew-install-x2F-uninstall-æŠ¥é”™" class="headerlink" title="brew install&#x2F;uninstall æŠ¥é”™"></a>brew install&#x2F;uninstall æŠ¥é”™</h2><p>æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Error: undefined method `patch&#x27; for #&lt;Resource:0x000001040877a8&gt;</span><br><span class="line">/usr/local/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/gcc@4.9.rb:55:in `block in &lt;class:GccAT49&gt;&#x27;</span><br><span class="line">/usr/local/Homebrew/Library/Homebrew/resource.rb:49:in `instance_eval&#x27;</span><br><span class="line">/usr/local/Homebrew/Library/Homebrew/resource.rb:49:in `initialize&#x27;</span><br><span class="line">/usr/local/Homebrew/Library/Homebrew/software_spec.rb:111:in `new&#x27;</span><br><span class="line">/usr/local/Homebrew/Library/Homebrew/software_spec.rb:111:in `resource&#x27;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆæ˜¯é‡æ–°å®‰è£… Homebrew, å‘½ä»¤å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</span><br></pre></td></tr></table></figure><h2 id="æ£€æŸ¥æœ¬æœºçš„-ip"><a href="#æ£€æŸ¥æœ¬æœºçš„-ip" class="headerlink" title="æ£€æŸ¥æœ¬æœºçš„ ip"></a>æ£€æŸ¥æœ¬æœºçš„ ip</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifconfig | grep &quot;inet &quot; | grep -v 127.0.0.1</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éŸ³è§†é¢‘ rtmp nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NSLog æ ¼å¼åŒ–è¾“å‡º NSInteger/NSUInteger</title>
      <link href="/2018/02/22/NSLog-%E6%A0%BC%E5%BC%8F%E5%8C%96%E8%BE%93%E5%87%BA-NSInteger-NSUInteger/"/>
      <url>/2018/02/22/NSLog-%E6%A0%BC%E5%BC%8F%E5%8C%96%E8%BE%93%E5%87%BA-NSInteger-NSUInteger/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åœ¨ Xcode ä¸­ ä½¿ç”¨ NSLog æ‰“å° NSInteger&#x2F;NSUInteger æ•°æ®, ç»å¸¸ä¼šé‡åˆ°ç±»ä¼¼çš„è­¦å‘Š. </p><p>å¦‚ä¸‹å›¾æ‰€ç¤º:<br><img src="/upload/images/2018/02/22/1.jpg" alt="1"></p><p>ä½†æ˜¯åœ¨ iphone 4s(32ä½)æœºå™¨ä¸Šå°±æ²¡æœ‰ä»»ä½•è­¦å‘Š, åªæ˜¯åœ¨64ä½çš„æœºå‹ä¸Šé¢æœ‰è¿™æ ·çš„è­¦å‘Š.</p><p>åœ¨ <code>NSObjCRuntime.h</code> é‡Œé¢å®šä¹‰ <code>NSInteger</code> å’Œ <code>NSUInteger</code> å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">if</span> __LP64__ || (TARGET_OS_EMBEDDED &amp;&amp; !TARGET_OS_IPHONE) || TARGET_OS_WIN32 || NS_BUILD_32_LIKE_64</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="built_in">NSInteger</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="built_in">NSUInteger</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> <span class="built_in">NSInteger</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="built_in">NSUInteger</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ 64 ä½ä¸‹æ˜¯ long ç±»å‹ï¼Œ32 ä½ä¸‹æ˜¯ int ç±»å‹.</p><p>æ‰€ä»¥, ä¸Šé¢çš„ä»£ç åœ¨ 32 ä½æœºå‹ä¸Šé¢ä¸ä¼šæœ‰è­¦å‘Š.</p><p>æŒ‰ç…§ Xcode çš„æç¤º, Fix it: </p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSUInteger</span> iun = <span class="number">3</span>;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;iun: %lu&quot;</span>, (<span class="keyword">unsigned</span> <span class="keyword">long</span>)iun);</span><br><span class="line">    </span><br><span class="line"><span class="built_in">NSInteger</span> nsi = <span class="number">6</span>;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;nsi: %ld&quot;</span>, (<span class="keyword">long</span>)nsi);</span><br></pre></td></tr></table></figure><p>è¿™æ ·æ— è®ºåœ¨ 32 ä½è¿˜æ˜¯åœ¨ 64 ä½æœºå‹ä¸Šé¢, éƒ½æ²¡æœ‰è­¦å‘Šäº†.</p><h2 id="Twitter-å¸–å­"><a href="#Twitter-å¸–å­" class="headerlink" title="Twitter å¸–å­"></a>Twitter å¸–å­</h2><p>åœ¨ <a href="https://twitter.com/gparker/status/377910611453046784">twitter æœ‰ä¸ªå¸–å­</a> è¯´äº†å¦ä¸€ç§è§£å†³åŠæ³•, åŸæ–‡å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%zd, %tu, %tx (<span class="keyword">signed</span>, <span class="keyword">unsigned</span>, hex) currently format <span class="built_in">NSInteger</span> and <span class="built_in">NSUInteger</span> with no warnings.</span><br></pre></td></tr></table></figure><blockquote><p>æ„æ€æ˜¯ä½¿ç”¨ zd å¯ä»¥æ ¼å¼åŒ–æœ‰ç¬¦å·çš„å¦‚ NSInteger, ä½¿ç”¨ tu æ ¼å¼åŒ–æ— ç¬¦å·çš„å¦‚ NSUInteger. è€Œ tx å¯ä»¥ç”¨æ¥æ ¼å¼åŒ–è¾“å‡º 16 è¿›åˆ¶æ•°æ®.</p></blockquote><p>æŒ‰ç…§è¿™ä¸ªè¯´æ³•, ä¿®æ”¹å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSUInteger</span> iun = <span class="number">3</span>;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;iun: %zd&quot;</span>, iun);</span><br><span class="line">    </span><br><span class="line"><span class="built_in">NSInteger</span> nsi = <span class="number">6</span>;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;nsi: %td&quot;</span>, nsi);</span><br></pre></td></tr></table></figure><p>æˆ–è€…è¿™æ ·ä¿®æ”¹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">NSUInteger iun = 3;</span><br><span class="line">NSLog(@&quot;iun: %tu&quot;, iun);</span><br><span class="line">    </span><br><span class="line">NSInteger nsi = 6;</span><br><span class="line">NSLog(@&quot;nsi: %td&quot;, nsi);</span><br></pre></td></tr></table></figure><p>ç¡®å®æ²¡æœ‰äº†è­¦å‘Šçš„é—®é¢˜.</p><p>æˆ‘åœ¨å®è·µè¿‡ç¨‹ä¸­å‘ç°ä¸€ä¸ªé—®é¢˜: ä½¿ç”¨ <code>zu</code> æ¥æ ¼å¼åŒ–è¾“å‡º NSUInteger, åœ¨ 32 ä½æœºå™¨ä¸Šé¢, ä»æ—§ä¼šæŠ¥è­¦å‘Š.</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSUInteger</span> iun = <span class="number">3</span>;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;iun: %zu&quot;</span>, iun);</span><br></pre></td></tr></table></figure><p>è¿™å°±è®©æˆ‘å¼€å§‹æ€€ç–‘ z å’Œ t çš„å¯é æ€§äº†.</p><p>ä¸‹é¢æ¥ç€äº†è§£ä¸€ä¸‹å®ƒä»¬.</p><h2 id="å…³äº-z-t"><a href="#å…³äº-z-t" class="headerlink" title="å…³äº z t"></a>å…³äº z t</h2><p>å…³äº <code>z</code> <code>t</code> çš„è¯´æ˜å¯ä»¥å‚è€ƒ <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/Strings/Articles/formatSpecifiers.html">String Format Specifiers</a></p><p><img src="/upload/images/2018/02/22/2.jpg" alt="1"></p><p>å¯ä»¥è¯´æ˜:</p><blockquote><p>æ ¼å¼åŒ– z å¯ä»¥ç”¨æ¥ä»£è¡¨ size_t.<br>æ ¼å¼åŒ– t å¯ä»¥ç”¨æ¥ä»£è¡¨ ptrdiff_t.</p></blockquote><p>ptrdiff_t æ˜¯C&#x2F;C++æ ‡å‡†åº“ä¸­å®šä¹‰çš„ä¸€ä¸ªä¸æœºå™¨ç›¸å…³çš„æ•°æ®ç±»å‹.<br>ptrdiff_t ç±»å‹å˜é‡é€šå¸¸ç”¨æ¥ä¿å­˜ä¸¤ä¸ªæŒ‡é’ˆå‡æ³•æ“ä½œçš„ç»“æœ, å…¶å®šä¹‰åœ¨ C99 æ ‡å‡†ä¸­.</p><p><strong>size_t ç±»å‹ç”¨äºæŒ‡æ˜æ•°ç»„é•¿åº¦, å®ƒå¿…é¡»æ˜¯ä¸€ä¸ªæ­£æ•°, è€Œ ptrdiff_t ç±»å‹åˆ™åº”ä¿è¯è¶³ä»¥å­˜æ”¾åŒä¸€æ•°ç»„ä¸­ä¸¤ä¸ªæŒ‡é’ˆä¹‹é—´çš„å·®è·, å®ƒæœ‰å¯èƒ½æ˜¯è´Ÿæ•°.</strong></p><p>å³: size_t æ˜¯ unsigned ç±»å‹, è€Œ ptrdiff_t åˆ™æ˜¯ signed æ•´å‹.</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">printf(<span class="string">&quot;size_t bytes = %d\n&quot;</span> ,<span class="keyword">sizeof</span>(size_t));</span><br><span class="line">printf(<span class="string">&quot;ptrdiff_t bytes = %d\n&quot;</span> ,<span class="keyword">sizeof</span>(ptrdiff_t));</span><br></pre></td></tr></table></figure><p>åœ¨ 32 ä½æœºå‹ä¸­è¾“å‡ºç»“æœ:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">size_t bytes = <span class="number">4</span></span><br><span class="line">ptrdiff_t bytes = <span class="number">4</span></span><br></pre></td></tr></table></figure><p>åœ¨ 64 ä½æœºå‹ä¸­è¾“å‡ºç»“æœ:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">size_t bytes = <span class="number">8</span></span><br><span class="line">ptrdiff_t bytes = <span class="number">8</span></span><br></pre></td></tr></table></figure><p>è¿™è¯´æ˜, sizet_t å’Œ ptrdiff_t æ˜¯å’Œæœºå™¨ç±»å‹ç›¸å…³çš„è·¨å¹³å°çš„.</p><p>ç³»ç»Ÿå®šä¹‰:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> __SIZE_TYPE__ size_t;</span><br><span class="line"><span class="keyword">typedef</span> __PTRDIFF_TYPE__ ptrdiff_t;</span><br></pre></td></tr></table></figure><p>32 ä½æœºå‹å®šä¹‰:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> __SIZE_TYPE__ long unsigned int</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __PTRDIFF_TYPE__ int</span></span><br></pre></td></tr></table></figure><p>64 ä½æœºå‹å®šä¹‰:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> __SIZE_TYPE__ long unsigned int</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __PTRDIFF_TYPE__ long int</span></span><br></pre></td></tr></table></figure><h2 id="ç»ˆæè§£å†³æ–¹æ¡ˆ"><a href="#ç»ˆæè§£å†³æ–¹æ¡ˆ" class="headerlink" title="ç»ˆæè§£å†³æ–¹æ¡ˆ"></a>ç»ˆæè§£å†³æ–¹æ¡ˆ</h2><p>æ—¢ç„¶åœ¨ Xcode é‡Œé¢æç¤º Fix it å¯ä»¥ä½¿ç”¨, é‚£ä¹ˆä¸ºäº†æé«˜ä»£ç çš„å¥å£®æ€§å’Œå¯ç»´æŠ¤æ€§, å¯ä»¥å®šä¹‰å®å®šä¹‰æ¥è§£å†³.</p><p>å®å®šä¹‰å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">if</span> __LP64__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MZNSI @<span class="string">&quot;ld&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MZNSU @<span class="string">&quot;lu&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MZNSI @<span class="string">&quot;d&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MZNSU @<span class="string">&quot;u&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">//__LP64__</span></span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ–¹æ³•, å¦‚ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSInteger</span> nsi = <span class="number">6</span>;</span><br><span class="line"><span class="built_in">NSUInteger</span> iun = <span class="number">3</span>;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;NSInteger nsi = %&quot;</span>MZNSI, nsi);</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;NSUInteger iun = %&quot;</span>MZNSU, iun);</span><br></pre></td></tr></table></figure><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p>ç»™å‡ºå¸¸ç”¨çš„æ ¼å¼åŒ–æ‰“å°è¾“å‡ºå­—ç¬¦ä¸²ä¸­çš„æ ¼å¼ç¬¦, å¦‚ä¸‹æ‰€ç¤º:</p><p>1ï¼‰%cï¼šå¯¹åº”å‚æ•°æ˜¯ä¸€ä¸ª <code>int</code> ç±»å‹ï¼Œä½†å®é™…è¿è¡Œæ—¶ä¼šå°†è¯¥ <code>int </code>ç±»å‹å¯¹è±¡è½¬æ¢ä¸º <code>unsigned char</code> ç±»å‹.</p><p>2ï¼‰%d æˆ–è€… %iï¼šå¯¹åº”å‚æ•°æ˜¯ä¸€ä¸ª <code>int</code> ç±»å‹. åªä¸è¿‡, %d ä¸€èˆ¬ç”¨äºåè¿›åˆ¶, %i å¯ä»¥å¯¹åº”å„ç§è¿›åˆ¶çš„æ•°æ®.</p><blockquote><p>äºŒè€…åœ¨æ‰“å°è¾“å‡ºä¸Šé¢æ²¡æœ‰ä»€ä¹ˆå¤ªå¤§çš„å·®åˆ«. ä½†æ˜¯åœ¨æ¥æ”¶è¾“å…¥(scanf)ä¸Š, %d ç”¨äºåè¿›åˆ¶, %i å¯¹åº”å„ç§è¿›åˆ¶çš„æ•°æ®. å¯ä»¥å‚è€ƒ <a href="https://www.geeksforgeeks.org/difference-d-format-specifier-c-language/">Difference between %d and %i format specifier in C language</a> è¿™ç¯‡æ–‡ç« .</p></blockquote><p>3ï¼‰%fï¼šå¯¹åº”å‚æ•°æ˜¯ä¸€ä¸ª <code>double</code> ç±»å‹.</p><p>4ï¼‰%ldï¼šå¯¹åº”å‚æ•°æ˜¯ä¸€ä¸ª <code>long int</code> ç±»å‹.</p><p>5ï¼‰%sï¼šå¯¹åº”å‚æ•°æ˜¯ä¸€ä¸ª <code>const char*</code> ç±»å‹ï¼Œè¡¨ç¤ºè¾“å‡ºä¸€ä¸ªå­—ç¬¦ä¸².</p><p>6ï¼‰%uï¼šå¯¹åº”å‚æ•°æ˜¯ä¸€ä¸ª <code>unsigned int</code> ç±»å‹.</p><p>7ï¼‰%zuï¼šå¯¹åº”å‚æ•°æ˜¯ä¸€ä¸ª <code>size_t</code> ç±»å‹.</p><p>8ï¼‰%tdï¼šå¯¹åº”å‚æ•°æ˜¯ä¸€ä¸ª <code>ptrdiff_t</code> ç±»å‹.</p><p>9ï¼‰%xï¼ˆæˆ– %Xï¼‰ï¼šå¯¹åº”å‚æ•°æ˜¯ä¸€ä¸ª <code>int</code> ç±»å‹ï¼Œä¸è¿‡ä¼šä»¥åå…­è¿›åˆ¶å½¢å¼è¾“å‡ºï¼Œå…¶ä¸­å¤§äº 9 çš„æ•°å­—æ ¹æ®å­—æ¯ <code>x</code> å¤§å°å†™è¿›è¡Œè½¬æ¢ï¼Œå¦‚æœæ˜¯ <code>%x</code>ï¼Œåˆ™å¤§äº 9 çš„æ•°ç”¨ <code>aï½f</code> è¡¨ç¤ºï¼›å¦‚æœæ˜¯ <code>%X</code>ï¼Œåˆ™ç”¨ <code>Aï½F</code> è¡¨ç¤º.</p><p>10ï¼‰%%ï¼šè¾“å‡ºä¸€ä¸ª % ç¬¦å·.</p><h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><p><a href="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/Strings/Articles/formatSpecifiers.html">Appleï¼šString Format Specifiers</a></p><hr><p><strong>æ‰«ç å…³æ³¨ï¼ŒæœŸå¾…ä¸ä½ çš„äº¤æµ~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NSLog printf scanf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faad2</title>
      <link href="/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faad2/"/>
      <url>/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faad2/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æœ¬æ¬¡åˆ†äº«ä½¿ç”¨ faad2 è§£ç  AAC éŸ³é¢‘æ–‡ä»¶, å°† AAC æ–‡ä»¶è½¬æ¢ä¸º WAV æ–‡ä»¶å¹¶ä½¿ç”¨ AVAudioPlayer è¿›è¡Œæ’­æ”¾ã€‚</p><p>åœ¨åšæ–‡ <a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-WAV-%E6%96%87%E4%BB%B6/">éŸ³è§†é¢‘ç¼–ç¨‹: ç®€å•åˆ†æ WAV æ–‡ä»¶</a> ç»™å¤§å®¶ç®€å•çš„åˆ†æäº†ä¸€ä¸‹ WAV çš„æ•°æ®å¤´åè®®, å…¶å®ä¹Ÿæ˜¯ä¸ºäº†è¿™ç¯‡åšæ–‡æ¥æœåŠ¡çš„, æ‰€ä»¥é˜…è¯»æœ¬æ–‡ä¹‹å‰, å»ºè®®å…ˆçœ‹ä¸Šæ–‡ã€‚</p><p><strong>è¯¥ç³»åˆ—åšæ–‡:</strong></p><ul><li><p><a href="http://www.veryitman.com/2018/02/14/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%BC%96%E8%AF%91-faac-faad2/">éŸ³è§†é¢‘ç¼–ç¨‹: ç¼–è¯‘ faac&#x2F;faad2</a></p></li><li><p><a href="http://www.veryitman.com/2018/02/16/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faac-%E7%BC%96%E7%A0%81/">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faac ç¼–ç </a></p></li><li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-WAV-%E6%96%87%E4%BB%B6/">éŸ³è§†é¢‘ç¼–ç¨‹: ç®€å•åˆ†æ WAV æ–‡ä»¶</a></p></li><li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faad2/">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faad2</a> (æœ¬ç¯‡)</p></li><li><p><a href="http://www.veryitman.com/2018/02/25/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E6%9E%84%E5%BB%BA-nginx-%E6%8E%A8%E6%B5%81%E6%9C%8D%E5%8A%A1%E5%99%A8/">éŸ³è§†é¢‘ç¼–ç¨‹: æ„å»º nginx æ¨æµæœåŠ¡å™¨</a></p></li></ul><h2 id="ä¾‹å­ä»‹ç»"><a href="#ä¾‹å­ä»‹ç»" class="headerlink" title="ä¾‹å­ä»‹ç»"></a>ä¾‹å­ä»‹ç»</h2><p>æœ¬æ–‡ä»¥ä¸€ä¸ªå®é™…çš„ä¾‹å­, ä½¿ç”¨ faad2çš„å„ä¸ªå‡½æ•°æ¥è§£ç  AAC æ•°æ®.</p><p>ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤:</p><ul><li>è·å–è¾“å…¥æ–‡ä»¶</li><li>è·å– faad è§£ç å™¨å¥æŸ„</li><li>åˆå§‹åŒ– faad è§£ç å™¨</li><li>æ ¹æ®æ–‡ä»¶è§£ææ–‡ä»¶å¸§, å¹¶å†™å…¥è¾“å‡ºæ–‡ä»¶ä¸­</li><li>å†™å…¥æ–‡ä»¶å¤´å°†å…¶å°è£…ä¸º WAV æ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶</li><li>å…³é—­ faad è§£ç å™¨å¥æŸ„</li></ul><h2 id="å·¥ç¨‹å®æˆ˜"><a href="#å·¥ç¨‹å®æˆ˜" class="headerlink" title="å·¥ç¨‹å®æˆ˜"></a>å·¥ç¨‹å®æˆ˜</h2><h3 id="å¼•å…¥-faad2"><a href="#å¼•å…¥-faad2" class="headerlink" title="å¼•å…¥ faad2"></a>å¼•å…¥ faad2</h3><p>å°†ç¼–è¯‘å¥½çš„ faad2 å¯¼å…¥å·¥ç¨‹å³å¯.</p><p><img src="/upload/images/2018/02/20/11.jpg" alt="1"><br>å…¶ä¸­å…³é”®çš„ API åœ¨ neaacdec.h ä¸­æœ‰æè¿°.</p><p>å·¥ç¨‹æ•ˆæœå›¾:<br><img src="/upload/images/2018/02/20/22.jpg" alt="1"></p><h3 id="ç¼–ç å®ç°"><a href="#ç¼–ç å®ç°" class="headerlink" title="ç¼–ç å®ç°"></a>ç¼–ç å®ç°</h3><p>åœ¨ <a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-WAV-%E6%96%87%E4%BB%B6/">éŸ³è§†é¢‘ç¼–ç¨‹: ç®€å•åˆ†æ WAV æ–‡ä»¶</a> ä¸­å·²ç»å®šä¹‰äº† WAV çš„æ•°æ®å¤´.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MZWavAudioFileHeader</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">char</span>       riff[<span class="number">4</span>];       <span class="comment">// å­—ç¬¦ä¸² &quot;RIFF&quot;</span></span><br><span class="line">    <span class="type">uint32_t</span>   totalLength; <span class="comment">// æ–‡ä»¶æ€»å¤§å°, åŒ…æ‹¬PCM æ•°æ®å¤§å°å’Œè¯¥æ–‡ä»¶å¤´å¤§å°</span></span><br><span class="line">    <span class="type">char</span>       wave[<span class="number">4</span>];     <span class="comment">// å­—ç¬¦ä¸² &quot;WAVE&quot;</span></span><br><span class="line">    <span class="type">char</span>       fmt[<span class="number">4</span>];      <span class="comment">// å­—ç¬¦ä¸² &quot;fmt &quot;</span></span><br><span class="line">    <span class="type">uint32_t</span>   format;      <span class="comment">// WAV å¤´å¤§å°, å›ºå®šä¸ºå€¼ 16</span></span><br><span class="line">    <span class="type">uint16_t</span>   pcm;         <span class="comment">// PCM ç¼–ç æ–¹å¼, å›ºå®šå€¼ä¸º 1</span></span><br><span class="line">    <span class="type">uint16_t</span>   channels;    <span class="comment">// å£°é“æ•°é‡, ä¸º 2</span></span><br><span class="line">    <span class="type">uint32_t</span>   frequency;   <span class="comment">// é‡‡æ ·é¢‘ç‡</span></span><br><span class="line">    <span class="type">uint32_t</span>   bytes_per_second; <span class="comment">// æ¯ç§’å­—èŠ‚æ•°(ç ç‡), å…¶å€¼=é‡‡æ ·ç‡xé€šé“æ•°xä½æ·±åº¦/8</span></span><br><span class="line">    <span class="type">uint16_t</span>   bytes_by_capture; <span class="comment">// é‡‡æ ·å—å¤§å°</span></span><br><span class="line">    <span class="type">uint16_t</span>   bits_per_sample; <span class="comment">// é‡‡æ ·ç‚¹å¤§å°, è¿™é‡Œæ˜¯ 16 ä½</span></span><br><span class="line">    <span class="type">char</span>       data[<span class="number">4</span>];         <span class="comment">// å­—ç¬¦ä¸² &quot;data&quot;</span></span><br><span class="line">    <span class="type">uint32_t</span>   bytes_in_pcmdata;  <span class="comment">// pcm æ•°æ®é•¿åº¦</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç°åœ¨å®ç°å†™å…¥æ•°æ®å¤´çš„æ–¹æ³• <code>mz_write_wav_header</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å†™å…¥ wav å¤´æ•°æ®.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param file  wav æ–‡ä»¶æŒ‡é’ˆ.</span></span><br><span class="line"><span class="comment"> *  @param total_samples_per_channel æ¯ä¸ªå£°é“çš„é‡‡æ ·æ•°.</span></span><br><span class="line"><span class="comment"> *  @param samplerate é‡‡æ ·ç‡.</span></span><br><span class="line"><span class="comment"> *  @param channels å£°é“æ•°.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">mz_write_wav_header</span><span class="params">(FILE *file, <span class="type">int</span> total_samples_per_channel, <span class="type">int</span> samplerate, <span class="type">int</span> channels)</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">NULL</span> == file) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (total_samples_per_channel &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;FAAD. total_samples_per_channel: %i, samplerate: %i, channels: %i\n&quot;</span>,</span><br><span class="line">           total_samples_per_channel, samplerate, channels);</span><br><span class="line">    </span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">MZWavAudioFileHeader</span> <span class="title">wavHeader</span>;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å†™å…¥ RIFF</span></span><br><span class="line">    <span class="built_in">strcpy</span>(wavHeader.riff, <span class="string">&quot;RIFF&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    wavHeader.bits_per_sample = <span class="number">16</span>;</span><br><span class="line">    </span><br><span class="line">    wavHeader.totalLength = (total_samples_per_channel * channels * wavHeader.bits_per_sample/<span class="number">8</span>) + <span class="keyword">sizeof</span>(wavHeader) - <span class="number">8</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å†™å…¥ WAVE å’Œ fmt</span></span><br><span class="line">    <span class="built_in">strcpy</span>(wavHeader.wave, <span class="string">&quot;WAVE&quot;</span>);</span><br><span class="line">    <span class="built_in">strcpy</span>(wavHeader.fmt, <span class="string">&quot;fmt &quot;</span>);</span><br><span class="line">    </span><br><span class="line">    wavHeader.format = <span class="number">16</span>;</span><br><span class="line">    wavHeader.pcm = <span class="number">1</span>;</span><br><span class="line">    wavHeader.channels = channels;</span><br><span class="line">    wavHeader.frequency = samplerate;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ¯ç§’çš„å­—èŠ‚æ•°(ç ç‡)=é‡‡æ ·ç‡xé€šé“æ•°xä½æ·±åº¦/8</span></span><br><span class="line">    wavHeader.bytes_per_second = wavHeader.channels * wavHeader.frequency * wavHeader.bits_per_sample/<span class="number">8</span>;</span><br><span class="line">    </span><br><span class="line">    wavHeader.bytes_by_capture = wavHeader.channels*wavHeader.bits_per_sample/<span class="number">8</span>;</span><br><span class="line">    </span><br><span class="line">    wavHeader.bytes_in_pcmdata = total_samples_per_channel * wavHeader.channels * wavHeader.bits_per_sample/<span class="number">8</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å†™å…¥ data</span></span><br><span class="line">    <span class="built_in">strcpy</span>(wavHeader.data, <span class="string">&quot;data&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    fwrite(&amp;wavHeader, <span class="number">1</span>, <span class="keyword">sizeof</span>(wavHeader), file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£ç ä¸»è¦ç”¨åˆ°äº† FAAD2 ä¸­çš„ <code>NeAACDecDecode</code> å‡½æ•°. å‡½æ•°åŸå‹å¦‚ä¸‹:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span>* NEAACDECAPI <span class="title function_">NeAACDecDecode</span><span class="params">(NeAACDecHandle hDecoder,</span></span><br><span class="line"><span class="params">                                 NeAACDecFrameInfo *hInfo,</span></span><br><span class="line"><span class="params">                                 <span class="type">unsigned</span> <span class="type">char</span> *buffer,</span></span><br><span class="line"><span class="params">                                 <span class="type">unsigned</span> <span class="type">long</span> buffer_size)</span>;</span><br></pre></td></tr></table></figure><p>å¯¹åº”å¸§å®šä¹‰çš„ç»“æ„ä½“: <code>NeAACDecFrameInfo</code>, å®šä¹‰å¦‚ä¸‹:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">NeAACDecFrameInfo</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> bytesconsumed;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> samples;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> channels;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> error;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> samplerate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* SBR: 0: off, 1: on; upsample, 2: on; downsampled, 3: off; upsampled */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> sbr;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* MPEG-4 ObjectType */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> object_type;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* AAC header type; MP4 will be signalled as RAW also */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> header_type;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* multichannel configuration */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> num_front_channels;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> num_side_channels;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> num_back_channels;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> num_lfe_channels;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> channel_position[<span class="number">64</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* PS: 0: off, 1: on */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> ps;</span><br><span class="line">&#125; NeAACDecFrameInfo;</span><br></pre></td></tr></table></figure><p>å…·ä½“çš„è§£ç å®ç°, æˆ‘æ”¾åˆ°äº† Github ä¸Šé¢äº†, å¤§å®¶å¯ä»¥å» <a href="https://github.com/veryitman/faacfaad2">è¿™é‡Œ</a> æŸ¥çœ‹.</p><h2 id="éº»çƒ¦"><a href="#éº»çƒ¦" class="headerlink" title="éº»çƒ¦"></a>éº»çƒ¦</h2><blockquote><p>è§£ç  aac, è§£å†³é‡‡æ ·é¢‘ç‡å’Œé€šé“æ•°ä¸å¯¹çš„é—®é¢˜</p></blockquote><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//é˜²æ­¢é‡‡æ ·é¢‘ç‡åŠ å€</span></span><br><span class="line">NeAACDecConfigurationPtr conf = NeAACDecGetCurrentConfiguration(decoder);</span><br><span class="line">conf-&gt;dontUpSampleImplicitSBR = <span class="number">1</span>;</span><br><span class="line">NeAACDecSetConfiguration(decoder, conf);</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä»åŒå£°é“çš„æ•°æ®ä¸­æå–å•é€šé“  </span></span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>,j=<span class="number">0</span>; i&lt;<span class="number">4096</span> &amp;&amp; j&lt;<span class="number">2048</span>; i+=<span class="number">4</span>, j+=<span class="number">2</span>) &#123;</span><br><span class="line"></span><br><span class="line">frame_mono[j]=pcm_data[i];</span><br><span class="line">frame_mono[j+<span class="number">1</span>]=pcm_data[i+<span class="number">1</span>];</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><p>å…·ä½“å¯ä»¥æŸ¥é˜… FAAD2 çš„æºç . æ„Ÿè°¢ <a href="http://blog.csdn.net/machh/article/details/47153111">ä½¿ç”¨FAADåº“è§£ç AACå®ä¾‹åŠ åŠ faadè§£ç åçš„é€šé“æ•°ä¸æ­£ç¡®çš„é—®é¢˜</a> æä¾›.</p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éŸ³è§†é¢‘ wav pcm faad2 aac </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éŸ³è§†é¢‘ç¼–ç¨‹: ç®€å•åˆ†æ WAV æ–‡ä»¶</title>
      <link href="/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-WAV-%E6%96%87%E4%BB%B6/"/>
      <url>/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-WAV-%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><hr><p>è¿™ç¯‡åˆ†äº«æ˜¯ä¸‹ç¯‡ <a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faad2/">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faad2</a> çš„é¢„å¤‡çŸ¥è¯†, å¦‚æœè¦è§£ç  WAV æ–‡ä»¶, é¦–å…ˆéœ€è¦äº†è§£ä¸€ä¸‹ WAV éŸ³é¢‘æ–‡ä»¶çš„æ ¼å¼ã€‚</p><p>ä»Šå¤©è¯´çš„æ˜¯ <code>çº¿æ€§ PCM</code> å¯¹åº”çš„ WAV æ ¼å¼çš„æ•°æ®ã€‚</p><blockquote><p>PCM çš„ç§ç±»</p></blockquote><ul><li>çº¿æ€§åŒ– PCM</li><li>Aå¾‹é‡åŒ–çš„ PCM</li><li>Uå¾‹é‡åŒ–çš„ PCM</li><li>AD PCM</li><li>GSM</li></ul><p><strong>è¯¥ç³»åˆ—åšæ–‡:</strong></p><ul><li><p><a href="http://www.veryitman.com/2018/02/14/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%BC%96%E8%AF%91-faac-faad2/">éŸ³è§†é¢‘ç¼–ç¨‹: ç¼–è¯‘ faac&#x2F;faad2</a></p></li><li><p><a href="http://www.veryitman.com/2018/02/16/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faac-%E7%BC%96%E7%A0%81/">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faac ç¼–ç </a></p></li><li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-WAV-%E6%96%87%E4%BB%B6/">éŸ³è§†é¢‘ç¼–ç¨‹: ç®€å•åˆ†æ WAV æ–‡ä»¶</a>(æœ¬ç¯‡)</p></li><li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faad2/">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faad2</a> </p></li><li><p><a href="http://www.veryitman.com/2018/02/25/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E6%9E%84%E5%BB%BA-nginx-%E6%8E%A8%E6%B5%81%E6%9C%8D%E5%8A%A1%E5%99%A8/">éŸ³è§†é¢‘ç¼–ç¨‹: æ„å»º nginx æ¨æµæœåŠ¡å™¨</a></p></li></ul><h2 id="WAV-ç®€ä»‹"><a href="#WAV-ç®€ä»‹" class="headerlink" title="WAV ç®€ä»‹"></a>WAV ç®€ä»‹</h2><p>WAV åªæ˜¯è¯¥éŸ³é¢‘æ–‡ä»¶çš„åç¼€å, å…¶å®Œæ•´åç§°ç¼©å†™æ˜¯ WAVEï¼ŒWAVE(Waveform Audio File Format), é‡‡ç”¨RIFFï¼ˆResource Interchange File Formatï¼‰æ–‡ä»¶æ ¼å¼ç»“æ„ã€‚</p><p>WAV æ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶é€šå¸¸ç”¨æ¥ä¿å­˜ PCM æ ¼å¼çš„åŸå§‹éŸ³é¢‘æ•°æ®ï¼Œé€šå¸¸è¢«ç§°ä¹‹ä¸ºæ— æŸéŸ³é¢‘ã€‚</p><p>WAV éŸ³é¢‘æ–‡ä»¶, ç²—ç•¥æ¥è¯´æ˜¯ WAV æ•°æ®å¤´ + PCM æ•°æ®ç»„æˆçš„. è£¸æ•°æ® PCM å¤–é¢åŒ…äº†ä¸€å±‚æ–‡ä»¶å¤´ï¼ŒWAV å®è´¨ä¸ºä¸€ä¸ª <a href="http://www.cnblogs.com/wangguchangqing/p/5957531.html">RIFF æ–‡ä»¶</a>.</p><h2 id="WAV-æ•°æ®å¤´"><a href="#WAV-æ•°æ®å¤´" class="headerlink" title="WAV æ•°æ®å¤´"></a>WAV æ•°æ®å¤´</h2><p>å…³äº WAV éŸ³é¢‘æ–‡ä»¶çš„æ•°æ®å¤´å®šä¹‰å¦‚ä¸‹å›¾æ‰€ç¤º:</p><p><img src="/upload/images/2018/02/20/1.jpg" alt="1"></p><p>æœ€å‰é¢çš„4ä¸ªå­—èŠ‚ç”¨æ¥æ ‡ç¤ºæ˜¯ RIFF å­—ç¬¦ä¸²ã€‚</p><p>å¯ä»¥çœ‹å‡º, ä¸€èˆ¬çš„ WAV æ–‡ä»¶çš„æ•°æ®å¤´ä¸º 44 ä¸ªå­—èŠ‚, å…¶åé¢è·Ÿçš„æ˜¯ PCM æ•°æ®ã€‚</p><h2 id="åˆ†æ-WAV-æ•°æ®å¤´"><a href="#åˆ†æ-WAV-æ•°æ®å¤´" class="headerlink" title="åˆ†æ WAV æ•°æ®å¤´"></a>åˆ†æ WAV æ•°æ®å¤´</h2><p>ä½¿ç”¨ <code>hexdump</code> æ¥çœ‹ä¸€ä¸‹ WAV æ–‡ä»¶çš„æ•°æ®å¤´ã€‚</p><p>åœ¨å½“å‰è·¯å¾„ä¸‹, æœ‰ä¸ª wav æ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶ <code>m.wav</code>, ä½¿ç”¨ <code>hexdump</code> åˆ†æä¸€ä¸‹.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexdump -n 44 m.wav</span><br></pre></td></tr></table></figure><p><img src="/upload/images/2018/02/20/2.jpg" alt="2"></p><p>å…¶ä¸­, <code>-n 44</code> è¡¨ç¤ºæŸ¥çœ‹å‰ 44 ä¸ªå­—èŠ‚.</p><p>æŒ‰å­—èŠ‚åˆ†ç»„çš„å›¾, å¦‚ä¸‹æ‰€ç¤º:<br><img src="/upload/images/2018/02/20/3.png" alt="2"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">52 49 46 46</span><br></pre></td></tr></table></figure><p>åˆ†åˆ«æ˜¯ RIFF çš„ ASCII ç .</p><p>è·Ÿåœ¨ RIFF åé¢çš„å››ä¸ªå­—èŠ‚æ˜¯æ–‡ä»¶çš„å¤§å°ä¿¡æ¯, æˆ‘ä»¬å…ˆä½¿ç”¨ <code>ls</code> å‘½ä»¤çœ‹ä¸€ä¸‹è¯¥æ–‡ä»¶çš„å¤§å°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -al</span><br></pre></td></tr></table></figure><p>è¾“å‡ºæ–‡ä»¶å¤§å°ä¸º(å­—èŠ‚æ•°): 1080808</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">staff  1080808 Jan 25 15:44 m.wav</span><br></pre></td></tr></table></figure><p>RIFF åé¢çš„å››ä¸ªå­—èŠ‚åˆ†åˆ«æ˜¯: e0 7d 10 00, ç”±äºè¯¥å­˜å‚¨ä½¿ç”¨äº†å°ç«¯åº(Little-Endian å­˜å‚¨ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹å…¶ä¸­çš„æ•°æ®ï¼Œä½ä½å­—èŠ‚åœ¨å‰ï¼Œé«˜ä½å­—èŠ‚åœ¨å), æ‰€ä»¥16è¿›åˆ¶è¡¨ç¤ºä¸º: 0x00107de0, å¯¹åº”çš„å­—èŠ‚å¤§å°æ˜¯ <code>1080808</code>.</p><p>ä¸Šé¢è¯´åˆ°, çº¿æ€§ PCM, å…¶å®åœ¨è¯¥æ–‡ä»¶å¤´ä¸­, ç¬¬17åˆ°ç¬¬ç¬¬22ä¸ªå­—èŠ‚(ä¸Šå›¾çº¢è‰²çš„5å’Œ6ç»„åˆ)æ ‡ç¤ºäº† PCM çš„ç±»å‹, å³:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10 00 00 00 01 00 </span><br></pre></td></tr></table></figure><p>å…¶ä»–ç±»å‹çš„ PCM ç±»å‹å®šä¹‰ä¸º:</p><blockquote><p>Aå¾‹é‡åŒ–çš„PCM: 12 00 00 0006 00<br>Uå¾‹é‡åŒ–çš„PCM: 12 00 00 00 07 00<br>AD PCM: 32 00 00 00 02 00<br>GSM: 14 00 00 00 31 00</p></blockquote><p>æœ€å4ä¸ªå­—èŠ‚è¡¨ç¤ºçœŸæ­£ PCM æ•°æ®çš„æ–‡ä»¶å¤§å°, å³: 0x00107dbc, å…¶10è¿›åˆ¶å¤§å°ä¸º: 1080764, ç”¨æ€»æ–‡ä»¶å¤§å°å‡å» 1080764, å°±æ˜¯æ–‡ä»¶å¤´çš„å¤§å°, å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1080808 - 1080764 = 44</span><br></pre></td></tr></table></figure><p>å…¶ä»–å¯¹åº”çš„æ•°æ®, å¤§å®¶å¯ä»¥å¯¹ç…§è¡¨è‡ªè¡Œåˆ†æã€‚</p><h2 id="å®šä¹‰æ•°æ®å¤´"><a href="#å®šä¹‰æ•°æ®å¤´" class="headerlink" title="å®šä¹‰æ•°æ®å¤´"></a>å®šä¹‰æ•°æ®å¤´</h2><blockquote><p>æ•°æ®ç±»å‹</p></blockquote><ul><li>char å ç”¨ 1 ä¸ªå­—èŠ‚</li><li>uint32_t å ç”¨ 4 ä¸ªå­—èŠ‚</li><li>uint16_t å ç”¨ 2 ä¸ªå­—èŠ‚</li></ul><p>è¿™é‡Œä½¿ç”¨ç»“æ„ä½“å®šä¹‰ WAV æ–‡ä»¶å¤´, å…¶å®šä¹‰å¦‚ä¸‹:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MZWavAudioFileHeader</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">char</span>       riff[<span class="number">4</span>];       <span class="comment">// å­—ç¬¦ä¸² &quot;RIFF&quot;</span></span><br><span class="line">    <span class="type">uint32_t</span>   totalLength; <span class="comment">// æ–‡ä»¶æ€»å¤§å°, åŒ…æ‹¬PCM æ•°æ®å¤§å°å’Œè¯¥æ–‡ä»¶å¤´å¤§å°</span></span><br><span class="line">    <span class="type">char</span>       wave[<span class="number">4</span>];     <span class="comment">// å­—ç¬¦ä¸² &quot;WAVE&quot;</span></span><br><span class="line">    <span class="type">char</span>       fmt[<span class="number">4</span>];      <span class="comment">// å­—ç¬¦ä¸² &quot;fmt &quot;</span></span><br><span class="line">    <span class="type">uint32_t</span>   format;      <span class="comment">// WAV å¤´å¤§å°, å›ºå®šä¸ºå€¼ 16</span></span><br><span class="line">    <span class="type">uint16_t</span>   pcm;         <span class="comment">// PCM ç¼–ç æ–¹å¼, å›ºå®šå€¼ä¸º 1</span></span><br><span class="line">    <span class="type">uint16_t</span>   channels;    <span class="comment">// å£°é“æ•°é‡, ä¸º 2</span></span><br><span class="line">    <span class="type">uint32_t</span>   frequency;   <span class="comment">// é‡‡æ ·é¢‘ç‡</span></span><br><span class="line">    <span class="type">uint32_t</span>   bytes_per_second; <span class="comment">// æ¯ç§’å­—èŠ‚æ•°(ç ç‡), å…¶å€¼=é‡‡æ ·ç‡xé€šé“æ•°xä½æ·±åº¦/8</span></span><br><span class="line">    <span class="type">uint16_t</span>   bytes_by_capture; <span class="comment">// é‡‡æ ·å—å¤§å°</span></span><br><span class="line">    <span class="type">uint16_t</span>   bits_per_sample; <span class="comment">// é‡‡æ ·ç‚¹å¤§å°, è¿™é‡Œæ˜¯ 16 ä½</span></span><br><span class="line">    <span class="type">char</span>       data[<span class="number">4</span>];         <span class="comment">// å­—ç¬¦ä¸² &quot;data&quot;</span></span><br><span class="line">    <span class="type">uint32_t</span>   bytes_in_pcmdata;  <span class="comment">// pcm æ•°æ®é•¿åº¦</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨ä¸‹é¢ä»£ç æ¥è®¡ç®—è¯¥ç»“æ„ä½“æ‰€å çš„å­—èŠ‚æ•°(ç»“æœæ˜¯44):</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> wav_header_size = <span class="keyword">sizeof</span>(<span class="keyword">struct</span> MZWavAudioFileHeader);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éŸ³è§†é¢‘ wav pcm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faac ç¼–ç </title>
      <link href="/2018/02/16/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faac-%E7%BC%96%E7%A0%81/"/>
      <url>/2018/02/16/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faac-%E7%BC%96%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æœ¬æ–‡åˆ†äº«å¦‚ä½•å°† WAV æ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶è½¬æ¢(ç¼–ç )ä¸º AAC æ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶å¹¶ä½¿ç”¨ AVAudioPlayer æ’­æ”¾ç¼–ç åçš„æ–‡ä»¶. </p><p>è¿™é‡Œçš„ç¼–ç åŠŸèƒ½ä½¿ç”¨ faac è¿™ä¸ªåº“æ¥å®ç°.</p><p><strong>è¯¥ç³»åˆ—åšæ–‡:</strong></p><ul><li><p><a href="http://www.veryitman.com/2018/02/14/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%BC%96%E8%AF%91-faac-faad2/">éŸ³è§†é¢‘ç¼–ç¨‹: ç¼–è¯‘ faac&#x2F;faad2</a></p></li><li><p><a href="http://www.veryitman.com/2018/02/16/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faac-%E7%BC%96%E7%A0%81/">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faac ç¼–ç </a>(æœ¬ç¯‡)</p></li><li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-WAV-%E6%96%87%E4%BB%B6/">éŸ³è§†é¢‘ç¼–ç¨‹: ç®€å•åˆ†æ WAV æ–‡ä»¶</a></p></li><li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faad2/">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faad2</a> </p></li><li><p><a href="http://www.veryitman.com/2018/02/25/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E6%9E%84%E5%BB%BA-nginx-%E6%8E%A8%E6%B5%81%E6%9C%8D%E5%8A%A1%E5%99%A8/">éŸ³è§†é¢‘ç¼–ç¨‹: æ„å»º nginx æ¨æµæœåŠ¡å™¨</a></p></li></ul><h2 id="å‡½æ•°ä»‹ç»"><a href="#å‡½æ•°ä»‹ç»" class="headerlink" title="å‡½æ•°ä»‹ç»"></a>å‡½æ•°ä»‹ç»</h2><blockquote><p>è·å– faac çš„ç‰ˆæœ¬</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int FAACAPI faacEncGetVersion(char **faac_id_string, char **faac_copyright_string);</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">char *version;</span><br><span class="line">char *copyright;</span><br><span class="line">faacEncGetVersion(&amp;version, &amp;copyright);</span><br><span class="line">printf(&quot;FAAC version: %s, copyright: %s&quot;, version, copyright);</span><br></pre></td></tr></table></figure><p>æ‰“å°ç»“æœ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FAAC version: 1.28, copyright: FAAC - Freeware Advanced Audio Coder (http://www.audiocoding.com/)</span><br><span class="line">Copyright (C) 1999,2000,2001  Menno Bakker</span><br><span class="line">Copyright (C) 2002,2003  Krzysztof Nikiel</span><br><span class="line">This software is based on the ISO MPEG-4 reference source code.</span><br></pre></td></tr></table></figure><blockquote><p>æ‰“å¼€å¹¶åˆå§‹åŒ– faac ç¼–ç å™¨</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// sampleRate: é‡‡æ ·ç‡</span><br><span class="line">// numChannels: é€šé“æ•°é‡ï¼Œ1-å•å£°é“ 2-ç«‹ä½“å£°</span><br><span class="line">// inputSamples: ç¼–ç åçš„æ•°æ®é•¿åº¦</span><br><span class="line">// maxOutputBytes: ç¼–ç åçš„ä¿¡æ¯æœ€å¤§é•¿åº¦</span><br><span class="line">faacEncHandle FAACAPI faacEncOpen(unsigned long sampleRate,</span><br><span class="line">  unsigned int numChannels,</span><br><span class="line">  unsigned long *inputSamples,</span><br><span class="line">  unsigned long *maxOutputBytes);</span><br></pre></td></tr></table></figure><p>è¯¥å‡½æ•°è¿”å›ä¸€ä¸ª faac ç¼–ç å™¨å¥æŸ„. å…¶å¾ˆå¤šå‡½æ•°éƒ½éœ€è¦è¿™ä¸ªå¥æŸ„.</p><blockquote><p>å…³é—­ faac ç¼–ç å™¨</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int FAACAPI faacEncClose(faacEncHandle hEncoder);</span><br></pre></td></tr></table></figure><p>å°†å¼€å¯ faac ç¼–ç å™¨è¿”å›çš„å¥æŸ„ä¼ å…¥å³å¯.</p><blockquote><p>è·å–é…ç½®å’Œè®¾ç½®é…ç½®</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">faacEncConfigurationPtr FAACAPI</span><br><span class="line">  faacEncGetCurrentConfiguration(faacEncHandle hEncoder);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int FAACAPI faacEncSetConfiguration(faacEncHandle hEncoder,</span><br><span class="line">    faacEncConfigurationPtr config);</span><br></pre></td></tr></table></figure><p>faac çš„é…ç½®è¢«å®šä¹‰ä¸ºäº†ä¸€ä¸ªç»“æ„ä½“ faacEncConfiguration, å¤§å®¶å¯ä»¥çœ‹æºç .</p><blockquote><p>ç¼–ç (ç¼–ç ä¸€å¸§éŸ³é¢‘æ•°æ®)</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//hEncoder: faacEncOpen è¿”å›çš„ç¼–ç å™¨å¥æŸ„</span><br><span class="line">//inputBuffer: è¾“å…¥ä¿¡æ¯ç¼“å†²åŒº</span><br><span class="line">//samplesInput: faacEncOpenç¼–ç åçš„æ•°æ®é•¿åº¦ï¼Œå³ç¼“å†²åŒºé•¿åº¦</span><br><span class="line">//outputBuffer: ç¼–ç åè¾“å‡ºä¿¡æ¯ç¼“å†²åŒº</span><br><span class="line">//bufferSize: è¾“å‡ºä¿¡æ¯é•¿åº¦</span><br><span class="line">int FAACAPI faacEncEncode(faacEncHandle hEncoder, int32_t * inputBuffer, unsigned int samplesInput,</span><br><span class="line"> unsigned char *outputBuffer,</span><br><span class="line"> unsigned int bufferSize);</span><br></pre></td></tr></table></figure><h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><p>å¯ä»¥è‡ªå·±æ–°å»ºä¸€ä¸ª iOS å·¥ç¨‹.</p><p>å‡†å¤‡å¥½ä¸€ä¸ª <code>wav</code> æ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶.</p><p>æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤º:<br><img src="/upload/images/2018/02/16/1.jpg" alt="1"></p><p>æ–°å»ºä¸€ä¸ª C++ æ–‡ä»¶, MZCodec.</p><blockquote><p>MZCodec.hpp</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#ifndef MZCodec_hpp</span><br><span class="line">#define MZCodec_hpp</span><br><span class="line"></span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">int codeWAV(const char *srcFilePath,  const char *destPath);</span><br><span class="line"></span><br><span class="line">#endif /* MZCodec_hpp */</span><br></pre></td></tr></table></figure><blockquote><p>MZCodec.cpp</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;MZCodec.hpp&quot;</span><br><span class="line"></span><br><span class="line">#include &quot;faac.h&quot;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">int codeWAV(const char *srcFilePath,  const char *destPath) &#123;</span><br><span class="line">    </span><br><span class="line">    unsigned long nSampleRate   = 44100;//é‡‡æ ·ç‡</span><br><span class="line">    unsigned int nChannels      = 2;//å£°é“æ•°</span><br><span class="line">    unsigned int nPCMBitSize    = 16;//å•æ ·æœ¬ä½æ•°</span><br><span class="line">    </span><br><span class="line">    unsigned long nInputSamples   = 0;</span><br><span class="line">    unsigned long nMaxOutputBytes = 0;</span><br><span class="line">    </span><br><span class="line">    int nRet;</span><br><span class="line">    faacEncHandle hEncoder;</span><br><span class="line">    faacEncConfigurationPtr pConfiguration;</span><br><span class="line">    </span><br><span class="line">    size_t nBytesRead;</span><br><span class="line">    unsigned long nPCMBufferSize;</span><br><span class="line">    unsigned char *pbPCMBuffer;</span><br><span class="line">    unsigned char *pbAACBuffer;</span><br><span class="line">    </span><br><span class="line">    FILE *fpIn; // WAV file for input</span><br><span class="line">    FILE *fpOut; // AAC file for output</span><br><span class="line">    </span><br><span class="line">    /// è·å– faac ç‰ˆæœ¬ä¿¡æ¯</span><br><span class="line">    &#123;</span><br><span class="line">        char *version;</span><br><span class="line">        char *copyright;</span><br><span class="line">        faacEncGetVersion(&amp;version, &amp;copyright);</span><br><span class="line">        printf(&quot;FAAC version: %s, copyright: %s&quot;, version, copyright);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    fpIn = fopen(srcFilePath, &quot;rb&quot;);</span><br><span class="line">    </span><br><span class="line">    if (NULL == fpIn) &#123;</span><br><span class="line">        return -2;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    fpOut = fopen(destPath, &quot;wb&quot;);</span><br><span class="line">    </span><br><span class="line">    /// 1. æ‰“å¼€ FAAC</span><br><span class="line">    hEncoder = faacEncOpen(nSampleRate, nChannels, &amp;nInputSamples, &amp;nMaxOutputBytes);</span><br><span class="line">    </span><br><span class="line">    if (NULL == hEncoder) &#123;</span><br><span class="line">        </span><br><span class="line">        printf(&quot;[ERROR] Failed to call faacEncOpen()\n&quot;);</span><br><span class="line">        return -1;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    nPCMBufferSize = nInputSamples * nPCMBitSize / 8;</span><br><span class="line">    pbPCMBuffer = new unsigned char[nPCMBufferSize];</span><br><span class="line">    pbAACBuffer = new unsigned char[nMaxOutputBytes];</span><br><span class="line">    </span><br><span class="line">    /// 2.1. è·å–å½“å‰çš„ç¼–ç å™¨é…ç½®</span><br><span class="line">    pConfiguration = faacEncGetCurrentConfiguration(hEncoder);</span><br><span class="line">    </span><br><span class="line">    pConfiguration-&gt;inputFormat = FAAC_INPUT_16BIT;</span><br><span class="line">    // å¯¹è±¡ç±»å‹åªæœ‰ä¸º LOW, iOS çš„ AVAudioPlayer æ‰èƒ½æ’­æ”¾</span><br><span class="line">    pConfiguration-&gt;aacObjectType = LOW;</span><br><span class="line">    // 0 = Raw; 1 = ADTS</span><br><span class="line">    pConfiguration-&gt;outputFormat = 1;</span><br><span class="line">    pConfiguration-&gt;mpegVersion = MPEG4;</span><br><span class="line">    pConfiguration-&gt;useTns = 1;</span><br><span class="line">    pConfiguration-&gt;bitRate = 30;</span><br><span class="line">    </span><br><span class="line">    /// 2.2. é…ç½®ç¼–ç å™¨</span><br><span class="line">    nRet = faacEncSetConfiguration(hEncoder, pConfiguration);</span><br><span class="line">    </span><br><span class="line">    //æ˜¯wavæ ¼å¼, å…ˆè¯»å–å‰é¢çš„</span><br><span class="line">    fseek(fpIn, 58, SEEK_SET);</span><br><span class="line">    </span><br><span class="line">    do &#123;</span><br><span class="line">        </span><br><span class="line">        //è¯»å…¥çš„å®é™…å­—èŠ‚æ•°ï¼Œæœ€å¤§ä¸ä¼šè¶…è¿‡ nPCMBufferSize</span><br><span class="line">        nBytesRead = fread(pbPCMBuffer, 1, nPCMBufferSize, fpIn);</span><br><span class="line">        </span><br><span class="line">        //è¾“å…¥æ ·æœ¬æ•°ï¼Œç”¨å®é™…è¯»å…¥å­—èŠ‚æ•°è®¡ç®—</span><br><span class="line">        //ä¸€èˆ¬åªæœ‰è¯»åˆ°æ–‡ä»¶å°¾æ—¶æ‰ä¸æ˜¯ nPCMBufferSize/(nPCMBitSize/8)</span><br><span class="line">        nInputSamples = nBytesRead / (nPCMBitSize / 8);</span><br><span class="line">        </span><br><span class="line">        /// 3. ç¼–ç </span><br><span class="line">        nRet = faacEncEncode(hEncoder,</span><br><span class="line">                             (int *)pbPCMBuffer,</span><br><span class="line">                             (unsigned int)nInputSamples,</span><br><span class="line">                             pbAACBuffer,</span><br><span class="line">                             (unsigned int)nMaxOutputBytes);</span><br><span class="line">        </span><br><span class="line">        fwrite(pbAACBuffer, 1, nRet, fpOut);</span><br><span class="line">        </span><br><span class="line">        printf(&quot;FaacEncEncode returns %d\n&quot;, nRet);</span><br><span class="line">    &#125; while (nBytesRead &gt; 0);</span><br><span class="line">    </span><br><span class="line">    /// 4. å…³é—­ FAAC</span><br><span class="line">    nRet = faacEncClose(hEncoder);</span><br><span class="line">    </span><br><span class="line">    delete[] pbPCMBuffer;</span><br><span class="line">    delete[] pbAACBuffer;</span><br><span class="line">    </span><br><span class="line">    fclose(fpIn);</span><br><span class="line">    fclose(fpOut);</span><br><span class="line">    </span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ MZCodec çš„ Controller éœ€è¦å‘½åä¸º <code>.mm</code> æ–‡ä»¶.</p><blockquote><p>ViewController.mm</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">NSBundle *bundle = [NSBundle mainBundle];</span><br><span class="line">NSString *resPath = [bundle pathForResource:@&quot;m&quot; ofType:@&quot;wav&quot;];</span><br><span class="line">NSLog(@&quot;The path of wav file: %@&quot;, resPath);</span><br><span class="line">    </span><br><span class="line">NSArray&lt;NSString *&gt; *docPath = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);</span><br><span class="line">NSString *destPath = [[docPath lastObject] stringByAppendingString:@&quot;/out.aac&quot;];</span><br><span class="line">NSLog(@&quot;The path of aac file: %@&quot;, destPath);</span><br><span class="line">    </span><br><span class="line">dispatch_async(dispatch_get_global_queue(0, 0), ^&#123;</span><br><span class="line">    </span><br><span class="line">    codeWAV([resPath UTF8String], [destPath UTF8String]);</span><br><span class="line">    </span><br><span class="line">    dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">//è½¬æ¢å®Œæˆ.</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ç¼–ç è¿‡ç¨‹éœ€è¦ç‚¹æ—¶é—´, å¦‚æœæ–‡ä»¶å¾ˆå¤§, æ—¶é—´è¶Šä¹…. æ‰€ä»¥, æ–°å¼€çº¿ç¨‹æ¥è¿›è¡Œç¼–ç .</p><p>ç¼–ç å®Œæˆå, å¯åœ¨å¯¹åº”çš„æ²™ç›’ç›®å½•æ‰¾åˆ° <code>out.aac</code> æ–‡ä»¶.</p><p>å…·ä½“ä»£ç åœ¨ <a href="https://github.com/veryitman/faacfaad2/tree/master/MZAudioCodec">Github</a> ä¸Šé¢, æ„Ÿå…´è¶£çš„å¯ä»¥ç‚¹å‡» <a href="https://github.com/veryitman/faacfaad2/tree/master/MZAudioCodec">å‰å¾€</a>.</p><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><p>è¿™ä¸ª <code>aacObjectType</code> éœ€è¦æ³¨æ„, ä¹‹å‰æˆ‘åœ¨è¿™é‡ŒæŠ˜è…¾äº†å¾ˆä¹….</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pConfiguration-&gt;aacObjectType = LOW;</span><br></pre></td></tr></table></figure><p>å¦‚æœè®¾ç½®ä¸ºå…¶ä»–ä¸‰ç§, ç¼–ç åçš„ aac æ–‡ä»¶, AVAudioPlayer æ’­æ”¾ä¸äº†, åˆå§‹åŒ– AVAudioPlayer å°±ä¼šæŠ¥é”™, æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹:</p><p><img src="/upload/images/2018/02/16/2.jpg" alt="1"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éŸ³è§†é¢‘ faac faad2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éŸ³è§†é¢‘ç¼–ç¨‹: ç¼–è¯‘ faac/faad2</title>
      <link href="/2018/02/14/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%BC%96%E8%AF%91-faac-faad2/"/>
      <url>/2018/02/14/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%BC%96%E8%AF%91-faac-faad2/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡åˆ†äº«å¦‚ä½•åœ¨ MacOS ä¸Šé¢ç¼–è¯‘ faac å’Œ faad2, ç¼–è¯‘åçš„åº“æ–‡ä»¶å¯ä»¥ç›´æ¥åœ¨ iOS ä¸Šé¢ä½¿ç”¨.</p><p>åç»­ä¼šåˆ†äº«å¦‚ä½•ç¼–è¯‘ç»™ Android ä½¿ç”¨çš„åº“æ–‡ä»¶çš„æ–¹æ³•ä»¥åŠå®æˆ˜.</p><p><strong>è¯¥ç³»åˆ—åšæ–‡:</strong></p><ul><li><p><a href="http://www.veryitman.com/2018/02/14/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%BC%96%E8%AF%91-faac-faad2/">éŸ³è§†é¢‘ç¼–ç¨‹: ç¼–è¯‘ faac&#x2F;faad2</a>(æœ¬ç¯‡)</p></li><li><p><a href="http://www.veryitman.com/2018/02/16/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faac-%E7%BC%96%E7%A0%81/">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faac ç¼–ç </a></p></li><li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-WAV-%E6%96%87%E4%BB%B6/">éŸ³è§†é¢‘ç¼–ç¨‹: ç®€å•åˆ†æ WAV æ–‡ä»¶</a></p></li><li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faad2/">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faad2</a> </p></li><li><p><a href="http://www.veryitman.com/2018/02/25/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E6%9E%84%E5%BB%BA-nginx-%E6%8E%A8%E6%B5%81%E6%9C%8D%E5%8A%A1%E5%99%A8/">éŸ³è§†é¢‘ç¼–ç¨‹: æ„å»º nginx æ¨æµæœåŠ¡å™¨</a></p></li></ul><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><code>faad</code> æ˜¯ AAC æ ¼å¼æ–‡ä»¶çš„éŸ³é¢‘è§£ç åº“. ç›¸å¯¹äº FFmpeg æ¥è¯´æ¯”è¾ƒè½»é‡å’Œç®€å•. ç¼–è¯‘å‡ºæ¥å…¨å¹³å°é™æ€åº“æ–‡ä»¶è¾ƒå°, API ä¹Ÿæ¯”è¾ƒç®€å•, ç¼ºç‚¹æ˜¯åŠŸèƒ½å•ä¸€, åªèƒ½å¤„ç† AAC æ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶ã€‚</p><p><code>faac</code> æ˜¯ä¸ä¹‹å¯¹åº”çš„ AAC éŸ³é¢‘ç¼–ç åº“. æ”¯æŒ MPEG-4 å’Œ MPEG-2 çš„AAC ç¼–ç ï¼Œå…¶ç‰¹æ€§åŒ…æ‹¬ï¼šå¯ç§»æ¤æ€§å¥½ï¼Œå¿«é€Ÿï¼Œæ”¯æŒLC&#x2F;Main&#x2F;LTPï¼Œé€šè¿‡ Dream æ”¯æŒ DRM.</p><p>è¿™ä¸¤ä¸ªåº“è™½ç„¶å¾ˆä¹…æ²¡æœ‰æ›´æ–°äº†, ä½†æ˜¯å…¶åŠŸèƒ½å·²ç»æ»¡è¶³å¾ˆå¤šä¸šåŠ¡åœºæ™¯äº†, å¹¶ä¸”å¾ˆå¥½ç”¨ã€‚</p><h2 id="ä¸‹è½½æºç "><a href="#ä¸‹è½½æºç " class="headerlink" title="ä¸‹è½½æºç "></a>ä¸‹è½½æºç </h2><p><del>ç‚¹å‡» <a href="http://www.audiocoding.com/downloads.html">æºç é“¾æ¥</a> å³å¯ä¸‹è½½æºç </del> </p><p><img src="/upload/images/2018/02/14/1.jpg" alt="1"></p><p>è‡ªä» 2020.08 åè¯¥ç½‘ç«™å·²ç»æ— æ³•è®¿é—®äº†ï¼Œå¯ä»¥ä» <a href="https://www.videoproc.com/resource/what-happened-to-audiocoding.htm">What Happened to Audiocoding.com (FAAC &amp; FAAD2)</a> äº†è§£ä¸€ä¸‹ã€‚</p><p>å¯ä»¥ä» <a href="https://sourceforge.net/projects/faac/">Sourceforge.net</a> ä¸‹è½½ã€‚</p><h2 id="ç¼–è¯‘-faac"><a href="#ç¼–è¯‘-faac" class="headerlink" title="ç¼–è¯‘ faac"></a>ç¼–è¯‘ faac</h2><p>ä¸‹è½½å®Œæˆå, è§£å‹, å°† <code>faac-1.28</code> æ”¾åˆ°æ–°å»ºç›®å½•  <code>src</code> ä¸‹é¢å³å¯, ç›®å½•ç»“æ„å¦‚ä¸‹:<br><img src="/upload/images/2018/02/14/2.jpg" alt="1"></p><p>ä¿®æ”¹ <code>build_faac.sh</code> æƒé™:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x build_faac.sh</span><br></pre></td></tr></table></figure><p>ç¼–è¾‘ <code>build_faac.sh</code> å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh  </span><br><span class="line">  </span><br><span class="line"># http://www.linuxfromscratch.org/blfs/view/svn/multimedia/faac.html  </span><br><span class="line"># ftp://mirror.ovh.net/gentoo-distfiles/distfiles/  </span><br><span class="line">  </span><br><span class="line">major=1  </span><br><span class="line">minor=28  </span><br><span class="line">micro=  </span><br><span class="line"></span><br><span class="line">XCD_ROOT=&quot;/Applications/Xcode.app/Contents/Developer&quot;  </span><br><span class="line">TOL_ROOT=&quot;/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain&quot;  </span><br><span class="line">#ä¿®æ”¹ä¸ºæœ€æ–°çš„ sdk ç‰ˆæœ¬</span><br><span class="line">SDK_ROOT=&quot;/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS11.2.sdk&quot;  </span><br><span class="line">SDK_SML_ROOT=&quot;/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator11.2.sdk&quot;  </span><br><span class="line"></span><br><span class="line">export PATH=$TOL_ROOT/usr/bin:$PATH  </span><br><span class="line">  </span><br><span class="line">work=`pwd`  </span><br><span class="line">srcs=$work/src  </span><br><span class="line">buid=$work/build  </span><br><span class="line">insl=$buid/install  </span><br><span class="line">name=faac-$&#123;major&#125;.$&#123;minor&#125;  </span><br><span class="line">pakt=$&#123;name&#125;.tar.gz  </span><br><span class="line">dest=$work/faac-iOS-$&#123;major&#125;.$&#123;minor&#125;.$&#123;micro&#125;.tgz  </span><br><span class="line">  </span><br><span class="line">rm -rf $srcs $buid $dest &amp;&amp; mkdir -p $srcs $buid  </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">archs=&quot;i386 x86_64 armv7 armv7s arm64&quot;  </span><br><span class="line">  </span><br><span class="line">for a in $archs; do  </span><br><span class="line">  case $a in  </span><br><span class="line">    arm*)  </span><br><span class="line">      sys_root=$&#123;SDK_ROOT&#125;  </span><br><span class="line">      host=arm-apple-darwin</span><br><span class="line">      ;;  </span><br><span class="line">    i386|x86_64)  </span><br><span class="line">      sys_root=$&#123;SDK_SML_ROOT&#125;  </span><br><span class="line">      host=$a-apple-darwin</span><br><span class="line">      ;;  </span><br><span class="line">  esac  </span><br><span class="line">  prefix=$insl/$a &amp;&amp; rm -rf $prefix &amp;&amp; mkdir -p $prefix  </span><br><span class="line">  rm -rf $srcs &amp;&amp; mkdir -p $srcs &amp;&amp; cd $work &amp;&amp; tar xvzf $pakt -C $srcs &amp;&amp; cd $srcs/$name  </span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  export CC=&quot;$TOL_ROOT/usr/bin/clang -arch $a -isysroot $sys_root&quot;</span><br><span class="line">  export CXX=&quot;$TOL_ROOT/usr/bin/clang++ -arch $a -isysroot $sys_root&quot;</span><br><span class="line">  export CXXFLAGS=&quot;-arch $a -isysroot $sys_root&quot;</span><br><span class="line">  export CFLAGS=&quot;-arch $a -isysroot $sys_root&quot;</span><br><span class="line">  export LDFLAGS=&quot;-isysroot $sys_root&quot;</span><br><span class="line">  export LIBS=&quot;-L$&#123;sys_root&#125;/usr/lib&quot;</span><br><span class="line"></span><br><span class="line">  chmod +x bootstrap  </span><br><span class="line">  ./bootstrap \</span><br><span class="line">    &amp;&amp;./configure \</span><br><span class="line">    --host=$host \</span><br><span class="line">    --with-sysroot=$sys_root \</span><br><span class="line">    --prefix=$prefix \</span><br><span class="line">    --disable-shared \</span><br><span class="line">    --enable-static \</span><br><span class="line">    --disable-faac \</span><br><span class="line">    --with-mp4v2 \</span><br><span class="line">    &amp;&amp;make &amp;&amp; make install</span><br><span class="line">  lipo_archs=&quot;$lipo_archs $prefix/lib/libfaac.a&quot;</span><br><span class="line"></span><br><span class="line">  echo &#x27;continue any key pressed..&#x27;</span><br><span class="line">  read -n 1</span><br><span class="line">done</span><br><span class="line">  </span><br><span class="line">univ=$insl/universal &amp;&amp; mkdir -p $univ/lib  </span><br><span class="line">cp -r $prefix/include $univ/  </span><br><span class="line">lipo $lipo_archs -create -output $univ/lib/libfaac.a  </span><br><span class="line">ranlib $univ/lib/libfaac.a  </span><br><span class="line">strip -S $univ/lib/libfaac.a  </span><br><span class="line">  </span><br><span class="line">cd $univ &amp;&amp; tar cvzf $dest *</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œ <code>./build_faac.sh</code>, å¼€å§‹ç¼–è¯‘ã€‚</p><p>ç¼–è¯‘æˆåŠŸå, ç”Ÿæˆ build ç›®å½•ã€‚<br><img src="/upload/images/2018/02/14/3.jpg" alt="1"></p><p>å…¶ä¸­, universal ç”Ÿæˆçš„åº“æ˜¯é€šç”¨åº“ã€‚</p><h2 id="ç¼–è¯‘-faad2"><a href="#ç¼–è¯‘-faad2" class="headerlink" title="ç¼–è¯‘ faad2"></a>ç¼–è¯‘ faad2</h2><p>è§£å‹å, å°† <code>faad2-2.7</code> æ”¹åä¸º <code>faad</code>.</p><p>ç¼–å†™ç¼–è¯‘çš„è„šæœ¬æ–‡ä»¶, è¿™é‡Œå–åä¸º <code>build_fadd2.sh</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch build_fadd2.sh</span><br></pre></td></tr></table></figure><p>ç¼–è¾‘ <code>build_fadd2.sh</code> æ–‡ä»¶ã€‚</p><p>å†™å…¥å¦‚ä¸‹å†…å®¹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line"></span><br><span class="line">CONFIGURE_FLAGS=&quot;--enable-static --with-pic&quot;</span><br><span class="line"></span><br><span class="line">ARCHS=&quot;arm64 armv7s armv7 x86_64 i386&quot;</span><br><span class="line"></span><br><span class="line"># directories</span><br><span class="line">SOURCE=&quot;faad&quot;</span><br><span class="line">FAT=&quot;fat-faad&quot;</span><br><span class="line"></span><br><span class="line">SCRATCH=&quot;scratch-faad&quot;</span><br><span class="line"># must be an absolute path</span><br><span class="line">THIN=`pwd`/&quot;thin-faad&quot;</span><br><span class="line"></span><br><span class="line">COMPILE=&quot;y&quot;</span><br><span class="line">LIPO=&quot;y&quot;</span><br><span class="line"></span><br><span class="line">if [ &quot;$*&quot; ]</span><br><span class="line">then</span><br><span class="line">if [ &quot;$*&quot; = &quot;lipo&quot; ]</span><br><span class="line">then</span><br><span class="line"># skip compile</span><br><span class="line">COMPILE=</span><br><span class="line">else</span><br><span class="line">ARCHS=&quot;$*&quot;</span><br><span class="line">if [ $# -eq 1 ]</span><br><span class="line">then</span><br><span class="line"># skip lipo</span><br><span class="line">LIPO=</span><br><span class="line">fi</span><br><span class="line">fi</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">if [ &quot;$COMPILE&quot; ]</span><br><span class="line">then</span><br><span class="line">CWD=`pwd`</span><br><span class="line">for ARCH in $ARCHS</span><br><span class="line">do</span><br><span class="line">echo &quot;building $ARCH...&quot;</span><br><span class="line">mkdir -p &quot;$SCRATCH/$ARCH&quot;</span><br><span class="line">cd &quot;$SCRATCH/$ARCH&quot;</span><br><span class="line"></span><br><span class="line">if [ &quot;$ARCH&quot; = &quot;i386&quot; -o &quot;$ARCH&quot; = &quot;x86_64&quot; ]</span><br><span class="line">then</span><br><span class="line">PLATFORM=&quot;iPhoneSimulator&quot;</span><br><span class="line">CPU=</span><br><span class="line">if [ &quot;$ARCH&quot; = &quot;x86_64&quot; ]</span><br><span class="line">then</span><br><span class="line">SIMULATOR=&quot;-mios-simulator-version-min=7.0&quot;</span><br><span class="line">HOST=&quot;--host=x86_64-apple-darwin&quot;</span><br><span class="line">else</span><br><span class="line">SIMULATOR=&quot;-mios-simulator-version-min=5.0&quot;</span><br><span class="line">HOST=&quot;--host=i386-apple-darwin&quot;</span><br><span class="line">fi</span><br><span class="line">else</span><br><span class="line">PLATFORM=&quot;iPhoneOS&quot;</span><br><span class="line">if [ $ARCH = &quot;armv7s&quot; ]</span><br><span class="line">then</span><br><span class="line">CPU=&quot;--cpu=swift&quot;</span><br><span class="line">else</span><br><span class="line">CPU=</span><br><span class="line">fi</span><br><span class="line">SIMULATOR=</span><br><span class="line">HOST=&quot;--host=arm-apple-darwin&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">XCRUN_SDK=`echo $PLATFORM | tr &#x27;[:upper:]&#x27; &#x27;[:lower:]&#x27;`</span><br><span class="line">CC=&quot;xcrun -sdk $XCRUN_SDK clang -Wno-error=unused-command-line-argument-hard-error-in-future&quot;</span><br><span class="line">AS=&quot;$CWD/$SOURCE/extras/gas-preprocessor.pl $CC&quot;</span><br><span class="line">CFLAGS=&quot;-arch $ARCH $SIMULATOR&quot;</span><br><span class="line">CXXFLAGS=&quot;$CFLAGS&quot;</span><br><span class="line">LDFLAGS=&quot;$CFLAGS&quot;</span><br><span class="line"></span><br><span class="line">CC=$CC CFLAGS=$CXXFLAGS LDFLAGS=$LDFLAGS CPPFLAGS=$CXXFLAGS CXX=$CC CXXFLAGS=$CXXFLAGS  $CWD/$SOURCE/configure \</span><br><span class="line">$CONFIGURE_FLAGS \</span><br><span class="line">$HOST \</span><br><span class="line">--prefix=&quot;$THIN/$ARCH&quot; \</span><br><span class="line">--disable-shared \</span><br><span class="line">--without-mp4v2</span><br><span class="line"></span><br><span class="line">make clean &amp;&amp; make &amp;&amp; make install-strip</span><br><span class="line">cd $CWD</span><br><span class="line">done</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">if [ &quot;$LIPO&quot; ]</span><br><span class="line">then</span><br><span class="line">echo &quot;building fat binaries...&quot;</span><br><span class="line">mkdir -p $FAT/lib</span><br><span class="line">set - $ARCHS</span><br><span class="line">CWD=`pwd`</span><br><span class="line">cd $THIN/$1/lib</span><br><span class="line">for LIB in *.a</span><br><span class="line">do</span><br><span class="line">cd $CWD</span><br><span class="line">lipo -create `find $THIN -name $LIB` -output $FAT/lib/$LIB</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">cd $CWD</span><br><span class="line">cp -rf $THIN/$1/include $FAT</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p>ç»™äºˆæ‰§è¡Œæƒé™:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x build_fadd2.sh</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ç›®å½•ç»“æ„å¦‚ä¸‹:<br><img src="/upload/images/2018/02/14/4.jpg" alt="1"></p><p>æ‰§è¡Œç¼–è¯‘è„šæœ¬, åœ¨å½“å‰ç›®å½•ç”Ÿæˆ <code>scratch-faad</code> å’Œ <code>fat-faad</code> ä»¥åŠ <code>thin-faad</code> ç›®å½•, å¦‚ä¸‹:<br><img src="/upload/images/2018/02/14/5.jpg" alt="1"></p><p>ä½¿ç”¨ <code>fat-faad</code> é‡Œé¢çš„åº“å’Œæ–‡ä»¶å³å¯ã€‚</p><p>å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹å¯¹åº”çš„ <code>.a</code> æ–‡ä»¶æ‰€æ”¯æŒçš„æ¶æ„:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lipo -info libfaad.a</span><br></pre></td></tr></table></figure><p>ä¼šå¾—åˆ°å¯¹åº”çš„è¾“å‡º:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Architectures in the fat file: libfaad.a are: i386 armv7 armv7s arm64 </span><br></pre></td></tr></table></figure><p>åŒæ ·å¯ä»¥æŸ¥çœ‹ <code>libfaac.a</code>.</p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>ç¼–è¯‘å¥½çš„æ–‡ä»¶, å·²ç»æ”¾åˆ° github ä¸Šé¢äº†, æœ‰éœ€è¦çš„å¯ä»¥ä¸‹è½½ä½¿ç”¨, ç‚¹å‡» <a href="https://github.com/veryitman/faacfaad2">ä¸‹è½½é“¾æ¥</a> è¿›å…¥ã€‚</p><p>æ„Ÿè°¢ <a href="https://github.com/fflydev/faac-ios-build">fflydev&#x2F;faac-ios-build</a> æä¾›ç¼–è¯‘ <code>faac</code> çš„ shell, åªéœ€è¦å°†é‡Œé¢å¯¹åº”çš„ SDK æ”¹ä¸ºæœ¬æœºæœ€æ–°çš„ SDK å³å¯ã€‚</p><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><ul><li><p><a href="http://www.voidcn.com/article/p-ftajkybd-p.html">faac 1.28çš„äº¤å‰ç¼–è¯‘ä¸é—®é¢˜è§£å†³</a></p></li><li><p><a href="http://blog.csdn.net/coloriy/article/details/52053144">ä½¿ç”¨FAADåº“è§£ç AACå®ä¾‹</a></p></li><li><p><a href="https://magiclen.org/linux-fdk-aac-2/">åœ¨Linuxä¸Šä½¿ç”¨FDK AACå°‡éŸ³æ¨‚è½‰æˆM4A(AACã€HE-AACã€HE-AACv2)æ ¼å¼</a></p></li><li><p><a href="https://www.jianshu.com/p/45928cdafde0">aacæ–‡ä»¶è½¬ç ä¸ºwavæ–‡ä»¶</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éŸ³è§†é¢‘ faac faad2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS å¤šçº¿ç¨‹: åˆæ­¥è®¤è¯†</title>
      <link href="/2018/02/12/iOS-%E5%A4%9A%E7%BA%BF%E7%A8%8B-%E5%88%9D%E6%AD%A5%E8%AE%A4%E8%AF%86/"/>
      <url>/2018/02/12/iOS-%E5%A4%9A%E7%BA%BF%E7%A8%8B-%E5%88%9D%E6%AD%A5%E8%AE%A4%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<p>å‡ ä¹æ¯ä¸ªç¼–ç¨‹è¯­è¨€æˆ–è€…å¹³å°éƒ½ä¼šé‡åˆ°å¤šçº¿ç¨‹çš„é—®é¢˜, è¯´æ˜å¤šçº¿ç¨‹æ˜¯ä¸€ä¸ªéå¸¸é‡è¦ä¸”å¼€å‘è€…å¿…é¡»äº†è§£å’ŒæŒæ¡çš„.</p><p>å¤šçº¿ç¨‹ä¹Ÿæ˜¯é¢è¯•å®˜æ¯”è¾ƒå–œæ¬¢é—®çš„é—®é¢˜, ä¾‹å¦‚:</p><ul><li>è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«, Android æ˜¯å¦æ”¯æŒå¤šè¿›ç¨‹?</li><li>çº¿ç¨‹æ± å¦‚ä½•å®ç°çš„?</li><li>é”æœºåˆ¶?</li><li>å¤šçº¿ç¨‹ä¹‹é—´å¦‚ä½•é€šä¿¡?</li></ul><p>è°ˆåŠ iOS ä¸­çš„å¤šçº¿ç¨‹ï¼Œä¸€èˆ¬è¯´çš„æ˜¯ pthreadï¼ŒNSthreadï¼ŒGCDï¼ŒNSOperation è¿™å››ç§, ç”¨çš„æœ€å¤šä¹Ÿæœ€æ–¹ä¾¿çš„å°±æ˜¯ GCD äº†. å…³äºè¿™å››è€…, åç»­ä¼šä¸ºå¤§å®¶ä¸€ä¸€åˆ†äº«.</p><p>phtread æ˜¯è·¨å¹³å°çš„, C&#x2F;C++ ä¸­éƒ½æœ‰å®ƒçš„å£°å½±, GCD å’Œ NSOperation éƒ½æ˜¯å¸¸ç”¨çš„ï¼ŒNSOperation æ˜¯åŸºäº GCD çš„. GCD çš„æ ¸å¿ƒæ¦‚å¿µæ˜¯å°†ä¸€ä¸ªä»»åŠ¡æ·»åŠ åˆ°é˜Ÿåˆ—ï¼ŒæŒ‡å®šä»»åŠ¡æ‰§è¡Œçš„æ–¹æ³•ï¼Œç„¶åæ‰§è¡Œ, NSOperation åˆ™æ˜¯ç›´æ¥å°†ä¸€ä¸ªæ“ä½œæ·»åŠ åˆ°é˜Ÿåˆ—ä¸­.</p><p>è¯¥ç³»åˆ—æ–‡ç« æ¥è·Ÿå¤§å®¶åˆ†äº«å…³äº iOS ä¸­çš„å¤šçº¿ç¨‹.</p><ul><li>iOS å¤šçº¿ç¨‹: åˆæ­¥è®¤è¯†(æœ¬ç¯‡)</li></ul><h2 id="è¿›ç¨‹å’Œçº¿ç¨‹"><a href="#è¿›ç¨‹å’Œçº¿ç¨‹" class="headerlink" title="è¿›ç¨‹å’Œçº¿ç¨‹"></a>è¿›ç¨‹å’Œçº¿ç¨‹</h2><p>è¿›ç¨‹å’Œçº¿ç¨‹çš„å®šä¹‰, å¤§å®¶å¯ä»¥è‡ªè¡Œåˆ°ç»´åŸºç™¾ç§‘ä¸Šé¢å»æŸ¥.</p><p>è¿™é‡Œåªè¯´äºŒè€…çš„åŒºåˆ«.</p><ul><li><p>ä¸€ä¸ªç¨‹åºè‡³å°‘æœ‰ä¸€ä¸ªè¿›ç¨‹, ä¸€ä¸ªè¿›ç¨‹è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹å¦‚ä¸»çº¿ç¨‹.</p></li><li><p>å¤šçº¿ç¨‹ç¨‹åºçš„å¹¶å‘æ€§é«˜.</p></li><li><p>è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ‹¥æœ‰ç‹¬ç«‹çš„å†…å­˜å•å…ƒï¼Œè€Œå¤šçº¿ç¨‹æ˜¯å…±äº«å†…å­˜çš„ï¼Œä»è€Œæå¤§åœ°æé«˜äº†ç¨‹åºçš„è¿è¡Œæ•ˆç‡.</p></li><li><p>æ¯ä¸ªç‹¬ç«‹çš„çº¿ç¨‹æœ‰ä¸€ä¸ªç¨‹åºè¿è¡Œçš„å…¥å£ã€é¡ºåºæ‰§è¡Œåºåˆ—å’Œç¨‹åºçš„å‡ºå£. çº¿ç¨‹ä¸èƒ½å¤Ÿç‹¬ç«‹æ‰§è¡Œï¼Œå¿…é¡»ä¾å­˜åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œç”±åº”ç”¨ç¨‹åºæä¾›å¤šä¸ªçº¿ç¨‹æ‰§è¡Œæ§åˆ¶.</p></li><li><p>æ“ä½œç³»ç»Ÿå¹¶æ²¡æœ‰å°†å¤šä¸ªçº¿ç¨‹çœ‹åšå¤šä¸ªç‹¬ç«‹çš„åº”ç”¨, å¤šçº¿ç¨‹çš„æ„ä¹‰åœ¨äºä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­ï¼Œæœ‰å¤šä¸ªæ‰§è¡Œéƒ¨åˆ†å¯ä»¥åŒæ—¶æ‰§è¡Œ, ä»è€Œå®ç°äº†è¿›ç¨‹çš„è°ƒåº¦å’Œç®¡ç†ä»¥åŠèµ„æºåˆ†é….</p></li></ul><h2 id="é˜Ÿåˆ—"><a href="#é˜Ÿåˆ—" class="headerlink" title="é˜Ÿåˆ—"></a>é˜Ÿåˆ—</h2><p>iOS ä¸­, é˜Ÿåˆ—ä¸»è¦åˆ†ä¸º:</p><ul><li>å…¨å±€é˜Ÿåˆ—</li><li>ä¸»é˜Ÿåˆ—.</li><li>ä¸²è¡Œé˜Ÿåˆ—.</li><li>å¹¶å‘é˜Ÿåˆ—.</li></ul><blockquote><ul><li>Concurrent:<br>tasks are dequeued in FIFO order, but run concurrently and can finish in any order.</li></ul></blockquote><blockquote><ul><li>Serial: .<br>tasks execute one at a time in FIFO order</li></ul></blockquote><p>å¹¶å‘: ä»»åŠ¡ä»¥ FIFO ä»åºåˆ—ä¸­ç§»é™¤ï¼Œç„¶åå¹¶å‘è¿è¡Œï¼Œå¯ä»¥æŒ‰ç…§ä»»ä½•é¡ºåºå®Œæˆ.</p><p>ä¸²è¡Œ: ä»»åŠ¡ä»¥FIFOä»åºåˆ—ä¸­ä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œ. ä¸€æ¬¡åªè°ƒåº¦ä¸€ä¸ªä»»åŠ¡.</p><p>åœ¨ iOS ä¸­, å¹¶å‘ä¸ä¸€å®šä¼šå¼€å¯å¤šä¸ªçº¿ç¨‹, ä¸²è¡Œä¹Ÿä¸ä¸€å®šåªå¼€å¯ä¸€ä¸ªçº¿ç¨‹. å› ä¸ºè¿™é‡Œä¼šç‰µæ‰¯åˆ°æ˜¯å¼‚æ­¥è¿˜æ˜¯åŒæ­¥æ‰§è¡Œ.</p><p>ä¸»é˜Ÿåˆ—, å³ mainQueue.</p><blockquote><p>Returns the default queue that is bound to the main thread.</p></blockquote><p>ä¼šå…³è”ä¸»çº¿ç¨‹.</p><p>å…¨å±€é˜Ÿåˆ—, å³ globalQueue.</p><blockquote><p>The well-known global concurrent queues may not be modified.</p></blockquote><p>å…¨å±€é˜Ÿåˆ—ä¸­æ‰§è¡Œä¸ä¸€å®šä¼šå¼€å¯æ–°çº¿ç¨‹.</p><h2 id="åŒæ­¥å’Œå¼‚æ­¥"><a href="#åŒæ­¥å’Œå¼‚æ­¥" class="headerlink" title="åŒæ­¥å’Œå¼‚æ­¥"></a>åŒæ­¥å’Œå¼‚æ­¥</h2><p>åœ¨ iOS çš„ GCD ä¸­, è¿˜æœ‰åŒæ­¥å’Œå¼‚æ­¥æ‰§è¡Œçš„åŒºåˆ«.</p><blockquote><p>åŒæ­¥</p></blockquote><p>åŒæ­¥æ‰§è¡Œä»£ç å—, è¯¸å¦‚ dispatch_async ä¸­æ‰§è¡Œçš„.</p><blockquote><p>å¼‚æ­¥</p></blockquote><p>å¼‚æ­¥æ‰§è¡Œä»£ç å—, è¯¸å¦‚ dispatch_sync ä¸­æ‰§è¡Œçš„.</p><h2 id="åˆ›å»ºé˜Ÿåˆ—çš„æ–¹æ³•"><a href="#åˆ›å»ºé˜Ÿåˆ—çš„æ–¹æ³•" class="headerlink" title="åˆ›å»ºé˜Ÿåˆ—çš„æ–¹æ³•"></a>åˆ›å»ºé˜Ÿåˆ—çš„æ–¹æ³•</h2><p><strong>åˆ›å»ºä¸»é˜Ÿåˆ—</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dispatch_queue_t dispatch_get_main_queue(void);</span><br></pre></td></tr></table></figure><p><strong>åˆ›å»ºå…¨å±€é˜Ÿåˆ—</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dispatch_queue_t dispatch_get_global_queue(long identifier, unsigned long flags);</span><br></pre></td></tr></table></figure><p>å‚æ•° identifier ç”¨æ¥è¡¨ç¤ºä¼˜å…ˆçº§. å¯¹åº”çš„ä¼˜å…ˆçº§ä¸º:</p><ul><li>DISPATCH_QUEUE_PRIORITY_HIG</li><li>DISPATCH_QUEUE_PRIORITY_DEFAULT</li><li>DISPATCH_QUEUE_PRIORITY_LOW</li><li>DISPATCH_QUEUE_PRIORITY_BACKGROUND</li></ul><p>å¦‚æœä¼ å…¥ 0 æ ‡ç¤º DISPATCH_QUEUE_PRIORITY_DEFAULT.</p><p>å‚æ•° flags æ˜¯ä¸€ä¸ªä¿ç•™å‚æ•°, API æ–‡æ¡£è¦æ±‚ä¼ å…¥ 0, é0å€¼å¯èƒ½ä¼šå¯¼è‡´è¿”å›ç»“æœä¸º NULL.</p><p><strong>è‡ªå®šä¹‰é˜Ÿåˆ—</strong></p><p>dispatch_queue_t dispatch_queue_create(const char *label, dispatch_queue_attr_t attr);</p><p>å‚æ•° label æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸².</p><p>å‚æ•° attr ç”¨æ¥æ ‡ç¤ºæ˜¯ä¸²è¡Œè¿˜æ˜¯å¹¶è¡Œé˜Ÿåˆ—. å¯ä»¥ä» DISPATCH_QUEUE_SERIAL, DISPATCH_QUEUE_CONCURRENT äºŒè€…ä¸­å–å€¼.</p><p>å¦‚æœè¯¥å‚æ•°ä¼ å…¥ NULL, é»˜è®¤æ˜¯ DISPATCH_QUEUE_SERIAL ä¸²è¡Œé˜Ÿåˆ—.</p><h2 id="ä¸²è¡Œé˜Ÿåˆ—ä¸­çš„çº¿ç¨‹"><a href="#ä¸²è¡Œé˜Ÿåˆ—ä¸­çš„çº¿ç¨‹" class="headerlink" title="ä¸²è¡Œé˜Ÿåˆ—ä¸­çš„çº¿ç¨‹"></a>ä¸²è¡Œé˜Ÿåˆ—ä¸­çš„çº¿ç¨‹</h2><p>ä¸²è¡Œé˜Ÿåˆ—åˆ°åº•æ˜¯å¼€äº†ä¸€ä¸ªçº¿ç¨‹, è¿˜æ˜¯å¼€äº†å¤šä¸ªçº¿ç¨‹, æˆ‘ä»¬ä¸€æ¢ç©¶ç«Ÿ.</p><p>å…ˆçœ‹ä¾‹å­1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dispatch_queue_t serialQueue = dispatch_queue_create(&quot;com.veryitman&quot;, DISPATCH_QUEUE_SERIAL);</span><br><span class="line">    </span><br><span class="line">for (int i=0; i&lt;10; i++) &#123;</span><br><span class="line">    </span><br><span class="line">    dispatch_async(serialQueue, ^&#123;</span><br><span class="line">        NSLog(@&quot;dispatch_async. DISPATCH_QUEUE_SERIAL CurrentThread: %@&quot;, [NSThread currentThread]);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/upload/images/2018/02/12/1.jpg" alt="1"></p><p>å¯ä»¥çœ‹å‡º, åªå¼€å¯ä¸€ä¸ªæ–°çº¿ç¨‹.</p><p>å†çœ‹ä¾‹å­2</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">dispatch_queue_t serialQueue = dispatch_queue_create(&quot;com.veryitman&quot;, DISPATCH_QUEUE_SERIAL);</span><br><span class="line">    </span><br><span class="line">dispatch_async(serialQueue, ^&#123;</span><br><span class="line">    NSLog(@&quot;dispatch_async. DISPATCH_QUEUE_SERIAL CurrentThread: %@&quot;, [NSThread currentThread]);</span><br><span class="line">    sleep(2);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">dispatch_async(serialQueue, ^&#123;</span><br><span class="line">    NSLog(@&quot;dispatch_sync. DISPATCH_QUEUE_SERIAL CurrentThread: %@&quot;, [NSThread currentThread]);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img src="/upload/images/2018/02/12/2.jpg" alt="1"></p><p>å¯ä»¥çœ‹å‡º, ä¹Ÿåªå¼€å¯ä¸€ä¸ªæ–°çº¿ç¨‹.</p><p>æ”¹é€ ä¸€ä¸‹ä¾‹å­2, å°†å…¶ä¸­çš„ä¸€ä¸ªå¼‚æ­¥æ”¹ä¸ºåŒæ­¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">dispatch_queue_t serialQueue = dispatch_queue_create(&quot;com.veryitman&quot;, DISPATCH_QUEUE_SERIAL);</span><br><span class="line">    </span><br><span class="line">dispatch_async(serialQueue, ^&#123;</span><br><span class="line">    NSLog(@&quot;dispatch_async. DISPATCH_QUEUE_SERIAL CurrentThread: %@&quot;, [NSThread currentThread]);</span><br><span class="line">    sleep(2);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">dispatch_sync(serialQueue, ^&#123;</span><br><span class="line">    NSLog(@&quot;dispatch_sync. DISPATCH_QUEUE_SERIAL CurrentThread: %@&quot;, [NSThread currentThread]);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img src="/upload/images/2018/02/12/3.jpg" alt="1"></p><p>å¯ä»¥çœ‹å‡º, åŒæ­¥çš„æ‰§è¡Œåœ¨ä¸»çº¿ç¨‹, äºŒè€…å¹¶ä¸æ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œ.</p><p>æ‰€ä»¥, ä¸²è¡Œé˜Ÿåˆ—ä¸­æ‰§è¡Œçš„ä»£ç , ä¸ä¸€å®šéƒ½åœ¨å­çº¿ç¨‹ä¸­, å¦‚æœæ˜¯å¼‚æ­¥éƒ½æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œ.å¦‚æœæ˜¯åŒæ­¥çš„è¯, ä¼šåœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œ.</p><p><strong>åŒç†, å¹¶è¡Œé˜Ÿåˆ—ä¸­çš„å¼‚æ­¥æ‰§è¡Œä¼šå¼€å¯å¤šä¸ªçº¿ç¨‹æ¥æ‰§è¡Œ.</strong></p><h2 id="æ‰§è¡Œæ–¹å¼å’Œé˜Ÿåˆ—"><a href="#æ‰§è¡Œæ–¹å¼å’Œé˜Ÿåˆ—" class="headerlink" title="æ‰§è¡Œæ–¹å¼å’Œé˜Ÿåˆ—"></a>æ‰§è¡Œæ–¹å¼å’Œé˜Ÿåˆ—</h2><p>è¿™é‡Œçš„æ‰§è¡Œæ–¹å¼æŒ‡çš„æ˜¯åŒæ­¥æˆ–è€…å¼‚æ­¥æ‰§è¡Œ.</p><p>å…ˆçœ‹å¼‚æ­¥æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">/// å¼‚æ­¥å…¨å±€é˜Ÿåˆ—å’Œä¸»é˜Ÿåˆ—</span><br><span class="line">    &#123;</span><br><span class="line">        dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">            // 1</span><br><span class="line">            NSLog(@&quot;dispatch_async. mainQueue. isMainThread: %i&quot;, [NSThread isMainThread]);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        dispatch_async(dispatch_get_global_queue(0, 0), ^&#123;</span><br><span class="line">            // 0</span><br><span class="line">            NSLog(@&quot;dispatch_async. globalQueue. isMainThread: %i&quot;, [NSThread isMainThread]);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /// å¼‚æ­¥ä¸²è¡Œå’Œå¹¶è¡Œé˜Ÿåˆ—</span><br><span class="line">    &#123;</span><br><span class="line">        dispatch_async(dispatch_queue_create(&quot;&quot;, DISPATCH_QUEUE_SERIAL), ^&#123;</span><br><span class="line">            // 0</span><br><span class="line">            NSLog(@&quot;dispatch_async. DISPATCH_QUEUE_SERIAL. isMainThread: %i&quot;, [NSThread isMainThread]);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        dispatch_async(dispatch_queue_create(&quot;&quot;, DISPATCH_QUEUE_CONCURRENT), ^&#123;</span><br><span class="line">            // 0</span><br><span class="line">            NSLog(@&quot;dispatch_async. DISPATCH_QUEUE_CONCURRENT. isMainThread: %i&quot;, [NSThread isMainThread]);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><img src="/upload/images/2018/02/12/4.jpg" alt="1"></p><p>å†çœ‹åŒæ­¥æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">/// åŒæ­¥å…¨å±€é˜Ÿåˆ—å’Œä¸»é˜Ÿåˆ—</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">    #if 0</span><br><span class="line">        // ä¼šæ­»é”</span><br><span class="line">        dispatch_sync(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">            NSLog(@&quot;dispatch_sync. mainQueue. isMainThread: %i&quot;, [NSThread isMainThread]);</span><br><span class="line">        &#125;);</span><br><span class="line">    #endif</span><br><span class="line"></span><br><span class="line">        dispatch_sync(dispatch_get_global_queue(0, 0), ^&#123;</span><br><span class="line">            // 1</span><br><span class="line">            NSLog(@&quot;dispatch_sync. globalQueue. isMainThread: %i&quot;, [NSThread isMainThread]);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /// åŒæ­¥ä¸²è¡Œå’Œå¹¶è¡Œé˜Ÿåˆ—</span><br><span class="line">    &#123;</span><br><span class="line">        dispatch_sync(dispatch_queue_create(&quot;&quot;, DISPATCH_QUEUE_SERIAL), ^&#123;</span><br><span class="line">            // 1</span><br><span class="line">            NSLog(@&quot;dispatch_sync. DISPATCH_QUEUE_SERIAL. isMainThread: %i&quot;, [NSThread isMainThread]);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        dispatch_sync(dispatch_queue_create(&quot;&quot;, DISPATCH_QUEUE_CONCURRENT), ^&#123;</span><br><span class="line">            // 1</span><br><span class="line">            NSLog(@&quot;dispatch_sync. DISPATCH_QUEUE_CONCURRENT. isMainThread: %i&quot;, [NSThread isMainThread]);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><img src="/upload/images/2018/02/12/5.jpg" alt="1"></p><blockquote><p>å¾—å‡ºç»“è®º</p></blockquote><ul><li>ä»»ä½•é˜Ÿåˆ—çš„åŒæ­¥æ‰§è¡Œ, éƒ½æ²¡æœ‰å¼€å¯æ–°çº¿ç¨‹, åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œ.</li><li>ä¸»é˜Ÿåˆ—çš„åŒæ­¥æ‰§è¡Œä¼šé€ æˆæ­»é”.</li><li>ä¸»é˜Ÿåˆ—çš„å¼‚æ­¥æ‰§è¡Œ, æ²¡æœ‰å¼€å¯æ–°çº¿ç¨‹. åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œ.</li><li>ä¸²è¡Œå’Œå¹¶è¡Œä»¥åŠå…¨å±€é˜Ÿåˆ—çš„å¼‚æ­¥æ‰§è¡Œ, éƒ½ä¼šå¼€å¯æ–°çº¿ç¨‹.</li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><p><a href="http://blog.csdn.net/robbyo/article/details/8549904">è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«</a></p></li><li><p><a href="http://www.ruanyifeng.com/blog/2013/04/processes_and_threads.html">è¿›ç¨‹ä¸çº¿ç¨‹çš„ä¸€ä¸ªç®€å•è§£é‡Š</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS å¤šçº¿ç¨‹ è¿›ç¨‹ GCD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C/C++: å¦‚ä½•ç›¸äº’è°ƒç”¨</title>
      <link href="/2018/02/12/C-C-%E5%A6%82%E4%BD%95%E7%9B%B8%E4%BA%92%E8%B0%83%E7%94%A8/"/>
      <url>/2018/02/12/C-C-%E5%A6%82%E4%BD%95%E7%9B%B8%E4%BA%92%E8%B0%83%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>C++ ä¸­è°ƒç”¨ C æ¯”è¾ƒç®€å•. ä½†æ˜¯ C è°ƒç”¨ C++ ç¨å¾®å¤æ‚ä¸€äº›.</p><p>C è°ƒç”¨ C++ åˆ†ä¸ºå¯ä»¥è°ƒç”¨ C++ ç±»ä¸­çš„å‡½æ•°å’Œæ™®é€š cpp ä¸­çš„å‡½æ•°. æ— è®ºæ˜¯å“ªç§å‡½æ•°, æˆ‘ä»¬éƒ½å¯ä»¥ä½¿ç”¨å°è£…äº† C++ çš„æ–‡ä»¶ä½œä¸ºé€‚é…ä¾›ç»™ C æ¥ä½¿ç”¨.</p><p>ä¸‹é¢çœ‹å…·ä½“çš„ä¾‹å­.</p><h2 id="C-è°ƒç”¨-C"><a href="#C-è°ƒç”¨-C" class="headerlink" title="C++ è°ƒç”¨ C"></a>C++ è°ƒç”¨ C</h2><p>é¦–å…ˆåˆ›å»º CFile.h å’Œ CFile.c æ–‡ä»¶.</p><blockquote><p>CFile.h</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#ifndef CFile_h</span><br><span class="line">#define CFile_h</span><br><span class="line"></span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">extern void start_c(int cmd);</span><br><span class="line"></span><br><span class="line">#endif /* CFile_h */</span><br></pre></td></tr></table></figure><blockquote><p>CFile.c</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;CFile.h&quot;</span><br><span class="line"></span><br><span class="line">void start_c(int cmd) &#123;</span><br><span class="line">    </span><br><span class="line">    printf(&quot;start_c by cmd: %i\n&quot;, cmd);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ C++ æ–‡ä»¶ä¸­è°ƒç”¨ C ä»£ç , ç¤ºä¾‹å¦‚ä¸‹:</p><blockquote><p>main.cpp</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">extern &quot;C&quot; &#123;</span><br><span class="line">#include &quot;CFile.h&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main(int argc, const char * argv[]) &#123;</span><br><span class="line">    </span><br><span class="line">    start_c(1);</span><br><span class="line">    </span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°å¯¼å…¥ C æ–‡ä»¶çš„æ–¹å¼:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">extern &quot;C&quot; &#123;</span><br><span class="line">#include &quot;CFile.h&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœç›´æ¥å¯¼å…¥, å¦‚:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;CFile.h&quot;</span><br><span class="line"></span><br><span class="line">int main(int argc, const char * argv[]) &#123;</span><br><span class="line">    </span><br><span class="line">    start_c(1);</span><br><span class="line">    </span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘æŠ¥é”™:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Undefined symbols for architecture x86_64:</span><br><span class="line">  &quot;start_c(int)&quot;, referenced from:</span><br><span class="line">      _main in main.o</span><br><span class="line">ld: symbol(s) not found for architecture x86_64</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ <code>extern &quot;C&quot;</code> å‘Šè¯‰ç¼–è¯‘å™¨, è¦æŒ‰ç…§ C çš„é“¾æ¥çº¦å®šï¼Œè€Œä¸æ˜¯ C++ çš„é“¾æ¥çº¦å®š.</p><p>C ç¼–è¯‘å™¨ä¸æ”¯æŒ <code>extern &quot;C&quot;</code>.</p><h2 id="C-è°ƒç”¨æ™®é€š-C-çš„å‡½æ•°"><a href="#C-è°ƒç”¨æ™®é€š-C-çš„å‡½æ•°" class="headerlink" title="C è°ƒç”¨æ™®é€š C++ çš„å‡½æ•°"></a>C è°ƒç”¨æ™®é€š C++ çš„å‡½æ•°</h2><p>C è°ƒç”¨ C++ æœ‰ç‚¹æ›²æŠ˜.</p><blockquote><p>CPPFile.hpp</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#ifndef CPPFile_hpp</span><br><span class="line">#define CPPFile_hpp</span><br><span class="line"></span><br><span class="line">void start_cpp(int cmd);</span><br><span class="line"></span><br><span class="line">#endif /* CPPFile_hpp */</span><br></pre></td></tr></table></figure><blockquote><p>CPPFile.cpp</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;CPPFile.hpp&quot;</span><br><span class="line">#include &lt;iostream&gt;</span><br><span class="line"></span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">void start_cpp(int cmd) &#123;</span><br><span class="line">    </span><br><span class="line">    cout &lt;&lt; &quot;start_cpp by cmd: &quot; &lt;&lt; cmd &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦å†™ä¸€ä¸ªä¸­é—´çš„ cpp(CPPAdapter.cpp)æ–‡ä»¶, æä¾›æ–¹æ³•ç»™ C æ¥ä½¿ç”¨.</p><p>æ³¨æ„: è¿™é‡Œæ²¡æœ‰ <code>CPPAdapter.hpp</code> å¤´æ–‡ä»¶.</p><blockquote><p>CPPAdapter.cpp</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;CPPFile.hpp&quot;</span><br><span class="line"></span><br><span class="line">#ifdef __cplusplus</span><br><span class="line">extern &quot;C&quot; &#123;</span><br><span class="line">#endif</span><br><span class="line">    </span><br><span class="line">    void adapter_start_cpp(int cmd) &#123;</span><br><span class="line">        </span><br><span class="line">        //è°ƒç”¨ CPPFile ä¸­çš„æ–¹æ³•</span><br><span class="line">        start_cpp(cmd);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">#ifdef __cplusplus</span><br><span class="line">&#125;</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨ C ä¸­è°ƒç”¨ C++ çš„ä»£ç :</p><blockquote><p>CFile.c</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;CFile.h&quot;</span><br><span class="line"></span><br><span class="line">//å£°æ˜å‡½æ•°</span><br><span class="line">extern void adapter_start_cpp(int cmd);</span><br><span class="line"></span><br><span class="line">void start_c(int cmd) &#123;</span><br><span class="line">        </span><br><span class="line">    //è°ƒç”¨ c++ ä»£ç </span><br><span class="line">    adapter_start_cpp(5);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="C-è°ƒç”¨-C-ç±»ä¸­çš„æ–¹æ³•"><a href="#C-è°ƒç”¨-C-ç±»ä¸­çš„æ–¹æ³•" class="headerlink" title="C è°ƒç”¨ C++ ç±»ä¸­çš„æ–¹æ³•"></a>C è°ƒç”¨ C++ ç±»ä¸­çš„æ–¹æ³•</h2><p>å’Œä¸Šé¢ä¾‹å­çš„åŸç†ä¸€æ ·çš„.</p><blockquote><p>CPPClassFile.hpp</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#ifndef CPPClassFile_hpp</span><br><span class="line">#define CPPClassFile_hpp</span><br><span class="line"></span><br><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;string&gt;</span><br><span class="line"></span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">class Person &#123;</span><br><span class="line">private:</span><br><span class="line">    string name;</span><br><span class="line">    </span><br><span class="line">public:</span><br><span class="line">    Person();</span><br><span class="line">    ~Person();</span><br><span class="line">    </span><br><span class="line">    int setName(string name);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">#endif /* CPPClassFile_hpp */</span><br></pre></td></tr></table></figure><blockquote><p>CPPClassFile.cpp</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;CPPClassFile.hpp&quot;</span><br><span class="line"></span><br><span class="line">Person::Person() &#123;</span><br><span class="line">    </span><br><span class="line">    cout &lt;&lt; &quot;Person()&quot; &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person::~Person() &#123;</span><br><span class="line">    </span><br><span class="line">    cout &lt;&lt; &quot;~Person()&quot; &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int Person::setName(string name) &#123;</span><br><span class="line">    </span><br><span class="line">    this-&gt;name = name;</span><br><span class="line">    </span><br><span class="line">    cout &lt;&lt; &quot;Set name: &quot; &lt;&lt; name &lt;&lt; endl;</span><br><span class="line">    </span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>CPPAdapter.cpp</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;CPPFile.hpp&quot;</span><br><span class="line">#include &quot;CPPClassFile.hpp&quot;</span><br><span class="line"></span><br><span class="line">#ifdef __cplusplus</span><br><span class="line">extern &quot;C&quot; &#123;</span><br><span class="line">#endif</span><br><span class="line">    </span><br><span class="line">    void adapter_start_cpp(int cmd) &#123;</span><br><span class="line">        </span><br><span class="line">        //è°ƒç”¨ CPPFile ä¸­çš„æ–¹æ³•</span><br><span class="line">        start_cpp(cmd);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    int adapter_set_name(const char *cName) &#123;</span><br><span class="line">        </span><br><span class="line">        Person *person = new Person();</span><br><span class="line">        int ret = person-&gt;setName(cName);</span><br><span class="line">        delete person;</span><br><span class="line">        </span><br><span class="line">        return ret;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">#ifdef __cplusplus</span><br><span class="line">&#125;</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure><p>åœ¨ C ä¸­å¯ä»¥è°ƒç”¨äº†, å¦‚ä¸‹ä»£ç :</p><blockquote><p>CFile.c</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;CFile.h&quot;</span><br><span class="line"></span><br><span class="line">///å£°æ˜ CPPFile ä¸­çš„æ–¹æ³•</span><br><span class="line">extern void adapter_start_cpp(int cmd);</span><br><span class="line"></span><br><span class="line">///å£°æ˜ CPPClassFile ä¸­çš„æ–¹æ³•</span><br><span class="line">extern int adapter_set_name(const char *cName);</span><br><span class="line"></span><br><span class="line">void start_c(int cmd) &#123;</span><br><span class="line">    </span><br><span class="line">    printf(&quot;start_c by cmd: %i\n&quot;, cmd);</span><br><span class="line">    </span><br><span class="line">    //è°ƒç”¨ CPPFile ä¸­çš„æ–¹æ³•</span><br><span class="line">    adapter_start_cpp(5);</span><br><span class="line">    </span><br><span class="line">    //è°ƒç”¨ CPPClassFile ä¸­çš„æ–¹æ³•</span><br><span class="line">    adapter_set_name(&quot;www.veryitman.com&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="extern-â€œCâ€"><a href="#extern-â€œCâ€" class="headerlink" title="extern â€œCâ€"></a>extern â€œCâ€</h2><p><code>extern &quot;C&quot;</code> ä¸­çš„ â€œCâ€ å¹¶ä¸è¡¨ç¤º C è¯­è¨€ï¼Œâ€Câ€ è¡¨ç¤ºçš„æ˜¯ä¸€ç§é“¾æ¥çº¦å®š.</p><p><code>extern &quot;C&quot;</code> æŒ‡ä»¤æè¿°çš„æ˜¯ä¸€ç§é“¾æ¥çº¦å®šï¼Œå®ƒå¹¶ä¸å½±å“è°ƒç”¨å‡½æ•°çš„å®šä¹‰ï¼Œå³ä½¿åšäº†è¯¥å£°æ˜ï¼Œå¯¹å‡½æ•°ç±»å‹çš„æ£€æŸ¥å’Œå‚æ•°è½¬æ¢ä»è¦éµå¾ª C++ çš„æ ‡å‡†ï¼Œè€Œä¸æ˜¯ C çš„æ ‡å‡†.</p><p>ä¸åŒçš„ç¼–ç¨‹è¯­è¨€(ç¼–è¯‘å‹)é“¾æ¥ç‰¹æ€§æ˜¯ä¸åŒçš„ï¼Œè¿™ä¹Ÿå†³å®šäº†å®ƒä»¬ç¼–è¯‘åçš„é“¾æ¥ç¬¦å·çš„ä¸åŒ.</p><p>å¦‚å‡½æ•° <code>void function(int d)</code>ï¼ŒC è¯­è¨€ä¼šæŠŠå®ƒç¼–è¯‘æˆç±»ä¼¼ <code>_function</code> è¿™æ ·çš„ç¬¦å·ï¼ŒC é“¾æ¥å™¨åªè¦æ‰¾åˆ°è¯¥å‡½æ•°ç¬¦å·å°±å¯ä»¥é“¾æ¥æˆåŠŸ.</p><p>C++ ä¼šæŠŠè¿™ä¸ªå‡½æ•°ç¼–è¯‘æˆç±»ä¼¼ <code>_function_int</code> æˆ– <code>_xxx_functionIntxxx</code> è¿™æ ·çš„ç¬¦å·ï¼Œå³åœ¨ç¬¦å·ä¸Šå¢åŠ äº†ç±»å‹ä¿¡æ¯ï¼Œè¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆ C++ å¯ä»¥å®ç°å‡½æ•°é‡è½½äº†.</p><p>é‚£ä¹ˆï¼Œå¯¹äºç”¨ C ç¼–è¯‘å™¨ç¼–è¯‘æˆçš„åº“ï¼Œç”¨ C++ ç›´æ¥é“¾æ¥åŠ¿å¿…ä¼šå‡ºç°ä¸èƒ½è¯†åˆ«ç¬¦å·çš„é—®é¢˜ï¼Œç”¨ <code>extern &quot;C&quot;</code> å°±å¯ä»¥è§£å†³, æ­£å¦‚ä¸Šé¢çš„ä¾‹å­.</p><p>ç®€å•æ¥è¯´, <code>extern &quot;C&quot;</code> çš„ä½œç”¨å°±æ˜¯è®©ç¼–è¯‘å™¨çŸ¥é“è¦ä»¥ C è¯­è¨€çš„æ–¹å¼ç¼–è¯‘å’Œé“¾æ¥å‡½æ•°.</p><h2 id="cplusplus-å®"><a href="#cplusplus-å®" class="headerlink" title="__cplusplus å®"></a>__cplusplus å®</h2><p><code>__cplusplus</code> å®æ˜¯ C++ ç¼–è¯‘å™¨é»˜è®¤å®šä¹‰çš„.</p><p>ç±»ä¼¼å¦‚ä¸‹çš„ä»£ç :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#ifdef __cplusplus</span><br><span class="line">extern &quot;C&quot;&#123;</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">void fun(int, size_t);</span><br><span class="line"></span><br><span class="line">#ifdef __cplusplus</span><br><span class="line">&#125;</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure><p>åœ¨ C++ ä¸­, ç¼–è¯‘å™¨å°† fun æŒ‰ç…§ C çš„é“¾æ¥çº¦å®šæ¥ç¼–è¯‘, è€Œå¦‚æœæ˜¯ C ç¼–è¯‘å™¨, ç›´æ¥æŒ‰ç…§ C çš„é“¾æ¥çº¦å®šæ¥ç¼–è¯‘å³å¯.</p><p><code>__cplusplus</code> æ˜¯åœ¨ C++ ç¼–è¯‘å™¨ä¸­é»˜è®¤å®šä¹‰çš„,ï¼£è¯­è¨€ä¸æ”¯æŒ <code>extern &quot;ï¼£&quot;</code>.</p><p>ä¸Šé¢çš„ä»£ç å¾ˆå®ç”¨, ä¹Ÿæ˜¯ä¸€ç§ç¼–ç¨‹æŠ€å·§.</p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C C++ ç¼–ç¨‹è¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS APNs: Background Fetch</title>
      <link href="/2018/02/08/iOS-APNs-Background-Fetch/"/>
      <url>/2018/02/08/iOS-APNs-Background-Fetch/</url>
      
        <content type="html"><![CDATA[<p>åœ¨å‰é¢çš„å‡ ç¯‡æ–‡ç« ä¸­, ç»™å¤§å®¶ä»‹ç»äº†è·Ÿæ¨é€ç›¸å…³çš„å†…å®¹.</p><p>ä»Šå¤©è·Ÿå¤§å®¶èŠä¸€èŠ iOS7 æ–°åŠ å…¥çš„ <code>Background Fetch</code> åŠŸèƒ½.</p><p>è¯¥ç³»åˆ—åšå®¢:</p><blockquote><p><a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E8%BF%9C%E7%A8%8B%E6%8E%A8%E9%80%81/">iOS APNs: è¿œç¨‹æ¨é€</a><br><a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E6%9C%AC%E5%9C%B0%E6%8E%A8%E9%80%81/">iOS APNs: æœ¬åœ°æ¨é€</a><br><a href="http://www.veryitman.com/2017/08/07/iOS-APNs-%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/">iOS APNs: å¤„ç†æ•°æ®</a><br><a href="http://www.veryitman.com/2018/02/06/iOS-APNs-%E9%9D%99%E9%BB%98%E6%8E%A8%E9%80%81/">iOS APNs: é™é»˜æ¨é€</a><br>iOS APNs: Background Fetch(æœ¬ç¯‡)</p></blockquote><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>ä» <code>Background Fetch</code> å­—é¢ä¸Šæ¥çœ‹, å¤§è‡´æ„æ€æ˜¯å¯åœ¨åå°è·å–æ•°æ®.</p><p>åœ¨ iOS7 ä¸­ï¼ŒApple ä¸ºå¼€å‘è€…æä¾›äº†å¯ä»¥åœ¨åå°æ›´æ–°åº”ç”¨ç¨‹åºç•Œé¢å’Œå†…å®¹çš„ API, å³ <code>Background Fetch</code>.</p><p>è¯¥ç‰¹æ€§å…è®¸å¼€å‘è€…åœ¨ä¸€ä¸ªå‘¨æœŸé—´éš”åè¿›è¡Œç‰¹å®šçš„åŠ¨ä½œï¼Œå¦‚è·å–ç½‘ç»œå†…å®¹, æ›´æ–° UI æ“ä½œç­‰.</p><p>åŒæ—¶åœ¨ iOS7 ä¸­, ä¹ŸåŠ å…¥äº†å¦ä¸€ä¸ªç‰¹æ€§, å°±æ˜¯åšæ–‡ <a href="http://www.veryitman.com/2018/02/06/iOS-APNs-%E9%9D%99%E9%BB%98%E6%8E%A8%E9%80%81/">iOS APNs: é™é»˜æ¨é€</a> é‡Œé¢è¯´çš„é™é»˜æ¨é€.</p><p>è¿™äº›éƒ½æ˜¯å¯¹ iOS åå°å¤šä»»åŠ¡çš„è¡¥å……å’Œå®Œå–„, Apple ä¸€ç›´åœ¨ä¼˜åŒ–ç³»ç»Ÿä»è€Œå¢å¼ºç”¨æˆ·ä½“éªŒ.</p><h2 id="å¼€å¯-Background-Fetch"><a href="#å¼€å¯-Background-Fetch" class="headerlink" title="å¼€å¯ Background Fetch"></a>å¼€å¯ Background Fetch</h2><p><strong>1.éœ€è¦ APP æ”¯æŒ</strong></p><p>å¦‚ä¸‹å›¾æ‰€ç¤º, å‹¾é€‰å³å¯.</p><p><img src="/upload/images/2018/02/08/1.png" alt="1"></p><p><strong>2.è®¾ç½® fetch æ—¶é—´é—´éš”</strong></p><p>åœ¨ AppDelegate ä¸­è®¾ç½®.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123; </span><br><span class="line"></span><br><span class="line">// è®¾ç½® fetch æ—¶é—´é—´éš”</span><br><span class="line">    [application setMinimumBackgroundFetchInterval:UIApplicationBackgroundFetchIntervalMinimum];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>UIApplicationBackgroundFetchIntervalMinimum</code> æ˜¯ç³»ç»Ÿè‡ªå®šä¹‰çš„æ—¶é—´. å¦‚æœä¸è®¾ç½®, é»˜è®¤æ˜¯ <code>UIApplicationBackgroundFetchIntervalNever</code>, è¿™æ ·å°±ä¸ä¼šè®© <code>Background Fetch</code> ç”Ÿæ•ˆäº†.</p><p>å¯ä»¥æŸ¥çœ‹å¯¹ UIApplicationBackgroundFetchIntervalNever çš„å®˜æ–¹è§£é‡Š.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UIApplicationBackgroundFetchIntervalNever</span><br><span class="line"></span><br><span class="line">A fetch interval large enough to prevent fetch operations from occurring.</span><br></pre></td></tr></table></figure><p>å½“ç„¶, ä½ ä¹Ÿå¯ä»¥è®¾ç½®è‡ªå·±å®šä¹‰çš„æ—¶é—´çš„é—´éš”, ä½†æ˜¯åŸºæœ¬æ²¡æœ‰ä»€ä¹ˆä½œç”¨, å› ä¸ºè¿™ä¸ªæ—¶é—´é—´éš”å®Œå…¨ç”±ç³»ç»Ÿæ¥å†³å®š, ç³»ç»Ÿä¼šæ ¹æ®ä½ çš„ç”µé‡ä»¥åŠä½¿ç”¨é¢‘ç‡æ¥å†³å®š.</p><p>æ‰€ä»¥, å¯ä»¥ç†è§£ä¸º <code>setMinimumBackgroundFetchInterval</code> æ–¹æ³•åªæ˜¯å¼€å¯äº† <code>Background Fetch</code> åŠŸèƒ½.</p><p><strong>3.å¼€å¯äº†ç³»ç»Ÿåå°æ›´æ–°åŠŸèƒ½</strong></p><p>åœ¨ iOS ç³»ç»Ÿä¸­, è®¾ç½®&#x2F;é€šç”¨&#x2F;åå°åº”ç”¨åˆ·æ–°ä¸­ä¸€å®šè¦å¼€å¯å¯¹åº” APP çš„åŠŸèƒ½.</p><p>åˆ¤æ–­æ˜¯å¦å·²ç»å¼€å¯è¯¥åŠŸèƒ½çš„ç¤ºä¾‹ä»£ç :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if ([[UIApplication sharedApplication] backgroundRefreshStatus] != UIBackgroundRefreshStatusAvailable) &#123;</span><br><span class="line"></span><br><span class="line">//ä¸å¯ç”¨æç¤ºç”¨æˆ·</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤„ç†å›è°ƒ"><a href="#å¤„ç†å›è°ƒ" class="headerlink" title="å¤„ç†å›è°ƒ"></a>å¤„ç†å›è°ƒ</h2><p>åœ¨å®é™…çš„åº”ç”¨ç¯ä¸­ï¼Œ<code>Background Fetch</code> äº‹ä»¶æ˜¯ç”±ç³»ç»Ÿç®¡ç†çš„ï¼Œæˆ‘ä»¬å¼€å‘è€…æ˜¯æ— æ³•é¢„å…ˆçŸ¥é“ Fetch äº‹ä»¶è¾¾åˆ°çš„æ—¶æœºçš„. </p><p>ç½‘ä¸Šå¾ˆå¤šè¯´å¯ä»¥ä½¿ç”¨ Xcode æ¨¡æ‹Ÿè¿™ä¸ªäº‹ä»¶, ä¼°è®¡ä¹Ÿæ˜¯ä¹‹å‰çš„ç³»ç»Ÿå’Œ Xcode ç‰ˆæœ¬, ç°åœ¨çš„ Xcode9 è²Œä¼¼ä¸è¡Œäº†.</p><p>ä½†æ˜¯, ä½ çš„æ‰‹æœºåœ¨åå°ç­‰å‡ åˆ†é’Ÿ, æœ‰æ—¶å€™ä¼šè¢«ç³»ç»Ÿè§¦å‘è¯¥äº‹ä»¶, è§¦å‘å, å¯¹åº”çš„ç³»ç»Ÿå›è°ƒ(åœ¨ AppDelegate ä¸­)ä¼šè¢«è°ƒç”¨.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// Background fetch å›è°ƒ</span><br><span class="line">- (void)application:(UIApplication *)application</span><br><span class="line">performFetchWithCompletionHandler:(void (^)(UIBackgroundFetchResult))completionHandler &#123;</span><br><span class="line">    </span><br><span class="line">    MZLOG(@&quot;AppDelegate. Background fetch.&quot;);</span><br><span class="line">    </span><br><span class="line">    //å¯è¿›è¡Œå¯¹åº”çš„è€—æ—¶æ“ä½œ, å¦‚ä¸‹è½½ç­‰.</span><br><span class="line">    </span><br><span class="line">    completionHandler(UIBackgroundFetchResultNoData);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Background Fetch</code> ä¼šä¸ºæˆ‘ä»¬çš„ App äº‰å–æ›´å¤šçš„åå°æ—¶é—´, ä½†æ˜¯ä¸€èˆ¬æ˜¯å‡ åç§’å·¦å³, ä¸ä¼šå¤ªå¤š. æ‰€ä»¥, ä¸è¦åœ¨å›è°ƒä¸­åšå¤ªå¤šè€—æ—¶çš„æ“ä½œ.</p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> APNs è¿œç¨‹æ¨é€ BackgroundFetch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS APNs: é™é»˜æ¨é€</title>
      <link href="/2018/02/06/iOS-APNs-%E9%9D%99%E9%BB%98%E6%8E%A8%E9%80%81/"/>
      <url>/2018/02/06/iOS-APNs-%E9%9D%99%E9%BB%98%E6%8E%A8%E9%80%81/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹äººå·¥æ™ºèƒ½ç›¸å…³çš„çŸ¥è¯†ï¼Œæ— æ„ä¸­å‘ç°äº†ä¸€ä¸ªå·¨ç‰›çš„ <a href="https://www.cbedai.net/androidbluetooth">äººå·¥æ™ºèƒ½æ•™ç¨‹</a>ï¼Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p><p>æ•™ç¨‹ä¸ä»…æ˜¯é›¶åŸºç¡€ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œè€Œä¸”éå¸¸é£è¶£å¹½é»˜ï¼Œåƒçœ‹å°è¯´ä¸€æ ·ï¼è§‰å¾—å¤ªç‰›äº†ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶ã€‚ç‚¹ <a href="https://www.cbedai.net/androidbluetooth">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥çœ‹æ•™ç¨‹ã€‚</p><hr><p>ä»Šå¤©è·Ÿå¤§å®¶ä»‹ç»ä¸€ä¸‹ ios çš„é™é»˜æ¨é€åŠŸèƒ½ã€‚</p><p>é™é»˜æ¨é€ï¼Œç®€å•æ¥è¯´å°±æ˜¯é€šè¿‡æ¨é€å®ç°ç”¨æˆ·æ— æ„ŸçŸ¥çš„æ¶ˆæ¯é€šçŸ¥ã€‚</p><p>è¯¥ç³»åˆ—åšæ–‡:</p><blockquote><p><a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E8%BF%9C%E7%A8%8B%E6%8E%A8%E9%80%81/">iOS APNs: è¿œç¨‹æ¨é€</a><br><a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E6%9C%AC%E5%9C%B0%E6%8E%A8%E9%80%81/">iOS APNs: æœ¬åœ°æ¨é€</a><br><a href="http://www.veryitman.com/2017/08/07/iOS-APNs-%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/">iOS APNs: å¤„ç†æ•°æ®</a><br>iOS APNs: é™é»˜æ¨é€(æœ¬ç¯‡)</p></blockquote><h2 id="æ™®é€šæ¨é€"><a href="#æ™®é€šæ¨é€" class="headerlink" title="æ™®é€šæ¨é€"></a>æ™®é€šæ¨é€</h2><p>ä¾‹å¦‚å¾®ä¿¡ï¼Œå¥½å‹ç»™ä½ å‘é€äº†ä¸€æ¡æ¶ˆæ¯ï¼Œä½ çš„å¾®ä¿¡APP åœ¨åå°, æ­¤æ—¶ä¼šæ”¶åˆ°å¸¦å£°éŸ³çš„ä¸€ä¸ªæ¶ˆæ¯æç¤ºã€‚</p><p>è¿™æ¡æ¨é€æœºæ²¹æœ‰æ–‡å­—åˆæœ‰å£°éŸ³ï¼Œç‚¹å¼€è¿™ä¸ªæ¨é€å¯ä»¥ç›´æ¥æ‰“å¼€ APP.</p><p>ä»ç¨‹åºçš„è§’åº¦æ¥è®²ï¼Œè¿›å…¥ App åä¼šè°ƒç”¨ä¸‹é¢çš„æ–¹æ³•:</p><p>iOS10.0.x å’Œå…¶ä¹‹å‰çš„ç³»ç»Ÿè°ƒç”¨ä¸‹é¢çš„æ–¹æ³•:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo</span><br></pre></td></tr></table></figure><p>iOS10.0.x ä¹‹åçš„ç³»ç»Ÿï¼Œä¼šè°ƒç”¨å¦‚ä¸‹çš„æ–¹æ³•:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (void)application:(UIApplication *)application</span><br><span class="line">                    didReceiveRemoteNotification:(NSDictionary *)userInfo</span><br><span class="line">                    fetchCompletionHandler:(void (^)(UIBackgroundFetchResult result))completionHandler</span><br></pre></td></tr></table></figure><h2 id="é™é»˜æ¨é€çš„å¼‚åŒ"><a href="#é™é»˜æ¨é€çš„å¼‚åŒ" class="headerlink" title="é™é»˜æ¨é€çš„å¼‚åŒ"></a>é™é»˜æ¨é€çš„å¼‚åŒ</h2><p><strong>1.æ²¡æœ‰å¼¹å‡ºæ¡†</strong></p><p>æ²¡æœ‰æ¨é€çš„å¼¹æ¡†å‡ºç°ï¼Œç”¨æˆ·æ¯«æ— æ„ŸçŸ¥çš„æ¥æ”¶åˆ°äº†è¿™ä¸ªæ¨é€æ¶ˆæ¯. æœ‰ <code>æ¶¦ç‰©ç»†æ— å£°</code> çš„æ„Ÿè§‰ã€‚</p><p>è¯¥æ¨é€æ—¢æ²¡æœ‰æ–‡å­—åˆæ²¡æœ‰å£°éŸ³ã€‚</p><p><strong>2.éœ€è¦ç”¨æˆ·æˆæƒå…è®¸æ¨é€</strong></p><p>è¿™ä¸ªè·Ÿæ™®é€šæ¨é€ä¸€æ ·ï¼Œéƒ½éœ€è¦ç”¨æˆ·æˆæƒæ‰å¯ä»¥æ¨é€ã€‚</p><p><strong>3.ä¼šæ‰§è¡Œä»£ç†æ–¹æ³•</strong></p><p>é™é»˜æ¨é€æ¥çš„æ—¶å€™ï¼Œä¹Ÿèƒ½æ‰§è¡Œä¸Šé¢çš„å›è°ƒæ–¹æ³•ã€‚æ‰§è¡Œä¸Šé¢æ–¹æ³•çš„åœºæ™¯å¦‚ä¸‹:</p><blockquote><p>1.App åœ¨å‰å°.<br>2.App åœ¨åå°, ä½†æ˜¯æ²¡æœ‰è¢« kill æ‰.</p></blockquote><p><strong>4.iOS7 ä»¥åæ‰æœ‰çš„</strong></p><p>å¯¹äº iOS ä¹‹å‰æ˜¯æ²¡æœ‰é™é»˜æ¨é€çš„ã€‚</p><p><strong>5.å¯ä»¥å»¶é•¿åå°æ—¶é—´</strong></p><p>æ”¶åˆ°é™é»˜æ¨é€åï¼Œåœ¨åº”ç”¨ç¨‹åºæŒ‚èµ·ä¹‹å‰æœ‰ 30 ç§’å·¦å³å¯ä»¥æ‰§è¡Œç›¸å…³çš„æ“ä½œã€‚</p><p><strong>6.æ¨é€é¢‘ç‡çš„æ§åˆ¶</strong></p><p>é™é»˜çš„æ¨é€æ˜¯è‹¹æœæ¨é€æœåŠ¡å™¨æ§åˆ¶æ¨é€é¢‘ç‡çš„ã€‚</p><p>è‹¹æœæ¨é€æœåŠ¡æ ¹æ®åå°æ¨é€ä»»åŠ¡çš„èƒ½è€—(ç”¨ç”µé‡,æ¥æ”¶æƒ…å†µ)æ¥æ§åˆ¶åå°æ¨é€çš„æ¨é€é¢‘ç‡å’Œå»¶è¿Ÿæ—¶é—´ã€‚</p><hr><p><strong>æ€»ä¹‹</strong>, é™é»˜æ¨é€æ˜¯æ™®é€šæ¨é€çš„ä¸€ç§å˜ç§è€Œå·²ã€‚</p><p>æ— è®ºæ˜¯é™é»˜æ¨é€è¿˜æ˜¯æ™®é€šæ¨é€ï¼Œå¼€å‘è€…è¯ä¹¦é‡Œé¢å¿…é¡»å¼€é€š push ç›¸å…³çš„åŠŸèƒ½ï¼Œå¹¶ä¸”ä¹Ÿéœ€è¦ç”¨æˆ·å¼€å¯å…è®¸æ¨é€çš„æˆæƒã€‚</p><p>è¿™ä¸ªåœ¨ <a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E8%BF%9C%E7%A8%8B%E6%8E%A8%E9%80%81/">iOS APNs: è¿œç¨‹æ¨é€</a> é‡Œé¢å·²ç»ä»‹ç»è¿‡ï¼Œä¸åœ¨è¿™é‡Œèµ˜è¿°ã€‚</p><h2 id="æ¨é€çš„æ ¼å¼"><a href="#æ¨é€çš„æ ¼å¼" class="headerlink" title="æ¨é€çš„æ ¼å¼"></a>æ¨é€çš„æ ¼å¼</h2><p>æ™®é€šæ¨é€çš„æ ¼å¼ï¼Œå¤§è‡´æ˜¯è¿™ä¸ªæ ·å­:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">&quot;aps&quot;:</span><br><span class="line">&#123;</span><br><span class="line">&quot;alert&quot;:&quot;Testing.. (15),</span><br><span class="line">&quot;badge&quot;:1,</span><br><span class="line">&quot;sound&quot;:&quot;default&quot;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é™é»˜æ¨é€æ˜¯ä¸å…è®¸å¸¦ <code>alert</code> <code>badge</code>  <code>sound</code> ç­‰å­—æ®µçš„ï¼Œä½†æ˜¯å¿…é¡»åŒ…å« <code>&quot;content-available&quot;:1</code>.</p><p>ä¾‹å¦‚ä¸‹é¢çš„å½¢å¼éƒ½å¯ä»¥:</p><blockquote><p>å½¢å¼1</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">&quot;aps&quot;:</span><br><span class="line">&#123;</span><br><span class="line">&quot;content-available&quot;:1</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å½¢å¼2</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">&quot;aps&quot;:</span><br><span class="line">&#123;</span><br><span class="line">&quot;custom&quot;:&quot;open_profile_page&quot;</span><br><span class="line">&quot;content-available&quot;:1</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ custom æ˜¯è‡ªå·±å®šä¹‰çš„ï¼Œå¤§å®¶æ ¹æ®éœ€æ±‚è‡ªè¡Œæ‰©å±•å³å¯ã€‚</p><blockquote><p>å½¢å¼3</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;aps&quot; : &#123;</span><br><span class="line">        &quot;content-available&quot; : 1</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;acme1&quot; : &quot;bar&quot;,</span><br><span class="line">    &quot;acme2&quot; : 42</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ¥è‡ªè‹¹æœå¼€å‘è€… <a href="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CreatingtheNotificationPayload.html">æ–‡æ¡£</a> ã€‚</p><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><p>å…·ä½“çš„ä½¿ç”¨åœºæ™¯, éœ€è¦ç»“åˆæœ¬èº«çš„ä¸šåŠ¡å’ŒåŠŸèƒ½ç‰¹ç‚¹æ¥è¯´ã€‚</p><p>é™é»˜æ¨é€çš„å‰ææ˜¯ APP æ²¡æœ‰è¢«æ€æ­»ï¼Œå¯ä»¥é€šè¿‡å›è°ƒå‡½æ•°æ¥æ‰§è¡Œç›¸å…³çš„ä»£ç ã€‚</p><p>å¦å¤–é™é»˜æ¨é€ä¸ä¼šæ‰“æ‰°ç”¨æˆ·ï¼Œæ¯”å¦‚ç”¨æˆ·æ­£åœ¨æ¸¸æˆä¸­æˆ˜æ–—ï¼Œä½ é¢‘ç¹çš„ä½¿ç”¨æ™®é€šæ¨é€ç»™ä»–ï¼Œä¼°è®¡ä»–éƒ½è¦ç–¯äº†.ã€‚</p><p>æˆ‘ä¸ªäººä½¿ç”¨é™é»˜æ¨é€çš„åœºæ™¯å¤§è‡´æ˜¯è¿™æ ·çš„ï¼ŒAPP å°†è¦æŒ‚èµ·çš„æ—¶å€™, è¯·æ±‚æœåŠ¡å™¨å»å‘ä¸€æ¡é™é»˜æ¨é€ï¼Œç„¶åä½¿ç”¨æœ¬åœ°é€šçŸ¥çš„æ–¹å¼å”¤èµ·ç”¨æˆ·æ¥æ‰“å¼€ APPï¼Œä»è€Œä¿è¯ APP å¤„äºä¿æ´»çš„çŠ¶æ€ï¼Œè‡³å°‘é™é»˜æ¨é€å¯ä»¥å¢åŠ è¢«åå°æŒ‚èµ·çš„æ—¶é—´ã€‚</p><p>å…³äºæœ¬åœ°é€šçŸ¥çš„å†…å®¹ï¼Œå¯ä»¥å‚è€ƒä¹‹å‰çš„æ–‡ç«  <a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E6%9C%AC%E5%9C%B0%E6%8E%A8%E9%80%81/">iOS APNs: æœ¬åœ°æ¨é€</a>.</p><p>æ›´å¤šçš„ä½¿ç”¨åœºæ™¯ç­‰å¤§å®¶åœ¨ä¸šåŠ¡ä¸­å»æŒ–æ˜ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> APNs æ¨é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hi 2018, æˆ‘åˆæ¥äº†</title>
      <link href="/2018/02/02/Hi-2018-%E6%88%91%E5%8F%88%E6%9D%A5%E4%BA%86/"/>
      <url>/2018/02/02/Hi-2018-%E6%88%91%E5%8F%88%E6%9D%A5%E4%BA%86/</url>
      
        <content type="html"><![CDATA[<p>å¥½ä¹…æ²¡æœ‰æ›´æ–°è‡ªå·±çš„åšå®¢äº†, ä»¥å‰åšæŒä¸€å‘¨è‡³å°‘ä¸¤ä¸‰ç¯‡åšæ–‡çš„æˆ‘, ä» 2017 å¹´ 10 æœˆä»½åˆ°ç°åœ¨å±…ç„¶åœæ­¢äº†ã€‚ </p><p>å…¶å®, è¿™æ˜¯æœ‰åŸå› çš„â€¦</p><h2 id="æ•°æ®ä¸¢äº†"><a href="#æ•°æ®ä¸¢äº†" class="headerlink" title="æ•°æ®ä¸¢äº†"></a>æ•°æ®ä¸¢äº†</h2><p>2017 å¹´ 10 æœˆ 15 æ—¥æ™š, æˆ‘äº²æ‰‹æŠŠè‡ªå·±çš„ä¹‹å‰å†™çš„æ–‡ç« (åŸæ•°æ®)ç»™å¼„ä¸¢äº†ï¼Œæˆ‘è‡ªå·±æ­å»ºçš„åšå®¢ç³»ç»Ÿæ˜¯ä½¿ç”¨ GitHub + Hexo éƒ¨ç½²å’Œå‘å¸ƒçš„ã€‚</p><p>äº‹æƒ…å¤§è‡´ç»è¿‡æ˜¯è¿™æ ·çš„â€¦</p><p>Mac æ“ä½œç³»ç»Ÿæç¤º, æœ‰æ›´æ–°çš„ç³»ç»Ÿå¯ä»¥ä½¿ç”¨äº†, é—®æ˜¯å¦ç«‹å³å®‰è£…, åœ¨å…¬å¸çš„æ—¶å€™, æˆ‘å¿ƒæƒ³, æ›´æ–°å, è‡ªå·±å®‰è£…çš„ä¸€äº›åº“, ä¼°è®¡ä¹Ÿè¦é‡æ–°å®‰è£…, å«Œéº»çƒ¦å°±ç›´æ¥è·³è¿‡äº†ã€‚</p><p>è¿‡äº†å‡ å¤©, æˆ‘æ™šä¸Šä¸‹ç­å›å®¶, ç³»ç»Ÿåˆæç¤ºæˆ‘æ›´æ–°. å½“æ—¶, æˆ‘å°±æ²¡æœ‰å¿ä½, ç›´æ¥æ›´æ–°äº†, æ¯•ç«Ÿæ—©æ™šéƒ½è¦æ›´æ–°çš„, å†è¯´äº† MacOS è¿˜æ˜¯æ¯”è¾ƒè®©äººæ”¾å¿ƒçš„ã€‚</p><p>è¶ç”µè„‘æ›´æ–°ç³»ç»Ÿçš„æ—¶å€™, æˆ‘å°±å»æ´—äº†æ¾¡, å›æ¥å‘ç°ç³»ç»Ÿæ›´æ–°å·²ç»å®Œæˆäº†ã€‚</p><p>å¿ƒä¸­æƒ³æ­£å¥½å¯ä»¥æŠŠä¹‹å‰æ²¡æœ‰å®Œæˆçš„åšå®¢å»å®Œå–„ä¸€ä¸‹, è°çŸ¥é“â€¦å¤©ä¸é‚æˆ‘æ„¿å‘€! å†å»ä½¿ç”¨ Hexo çš„æ—¶å€™, æç¤ºæˆ‘å¤±è´¥, å±…ç„¶æ— æ³•ä½¿ç”¨äº†. è¿™å¯æŠŠæˆ‘æ€¥çš„å¤Ÿå‘›, ä¸€æ°”ä¹‹ä¸‹(è„‘å­ä¼°è®¡å½“æ—¶è¿›æ°´äº†), ç›´æ¥åˆ äº† Hexo ç›®å½•, æ˜¯é‚£ç§ç¨‹åºå‘˜å¼çš„æ¯«ä¸ç•™æƒ…çš„åˆ é™¤ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -fr ./hexo</span><br></pre></td></tr></table></figure><p>æ½‡æ´’çš„æ“ä½œå, é‡æ–°å®‰è£… Hexo, åˆæŠ˜è…¾äº†ä¸¤ä¸ªæ™šä¸Š, æœ€ç»ˆä¹Ÿæ˜¯å®‰è£…å¥½äº†, å¯ä»¥å†™ä¸œä¸œäº†ã€‚</p><p>ä½†æ˜¯å‘ç°ä» Github ä¸Šé¢ clone åçš„æ–‡ä»¶, æ— æ³•è¿˜åŸæˆè‡ªå·±å½“åˆçš„ MarkDown æ–‡ä»¶äº†ã€‚</p><p>é›ªèŠ±é‚£ä¸ªé£˜å•Šé£˜, åŒ—é£é‚£ä¸ªè§å‘€è§â€¦</p><p>ä¸€åˆ‡éƒ½æ™šäº†! ^^</p><p>å”¯ä¸€å€¼å¾—åº†å¹¸çš„æ˜¯, åŸæ¥è‡ªå·±çš„ç½‘ç«™åšæ–‡è¿˜åœ¨é‚£é‡Œã€‚</p><h2 id="è¿˜åŸæ•°æ®"><a href="#è¿˜åŸæ•°æ®" class="headerlink" title="è¿˜åŸæ•°æ®"></a>è¿˜åŸæ•°æ®</h2><p>ä»å“ªé‡Œè·Œå€’, å°±ä»å“ªé‡Œçˆ¬èµ·æ¥, æˆ‘å†³å®šæŠŠä¹‹å‰çš„æ•°æ®ä½¿ç”¨ <code>äººå·¥æ™ºèƒ½</code> çš„æ–¹å¼è¿˜åŸå›æ¥ã€‚</p><p>ğŸ˜†æˆ‘å°±æ˜¯é‚£ä¸ª <code>äººå·¥</code>, æ‰‹åŠ¨çš„å°† HTML è½¬æ¢ä¸º MarkDown æ–‡æ¡£, å‹æ ¹æ²¡æœ‰ä»€ä¹ˆ <code>æ™ºèƒ½</code>ã€‚</p><p>å¥½æ­¹é‚£ä¹Ÿæ˜¯è‡ªå·±ç†¬è¿‡å¤šå°‘ä¸ªæ—¥å¤œçš„æˆæœå‘€, æ²¡æœ‰åŠŸåŠ³ä¹Ÿæœ‰è‹¦åŠ³, æˆ‘ä¸å¿å¿ƒå°±è¿™æ ·è®©å®ƒä¸¢æ‰, å«ç€æ³ªä¹Ÿè¦æŠŠå®ƒä»¬ç»™æ‰¾å›æ¥!</p><p>è‡ªå·±ä¸‹åŠå¹´ä¹Ÿæ¯”è¾ƒå¿™, å‘¨æœ«éƒ½åœ¨åŠ ç­, åªèƒ½æ¯å¤©æ™šä¸Šå›å®¶æŠ½äº›æ—¶é—´è¿˜åŸä¸€ç‚¹, æœ‰æ—¶å€™å¤ªå›°, å°±æ¨è¿Ÿåˆ°ä¸‹ä¸ªæ™šä¸Š. å¤§æ¦‚ç”¨äº† 3 ä¸ªæœˆå·¦å³çš„æ—¶é—´, åŸºæœ¬è¿˜åŸå›æ¥äº†ã€‚</p><p>æ¯ç¯‡æ–‡ç« åŸºæœ¬éƒ½æœ‰é…å›¾, éƒ½æœ‰è·³è½¬é“¾æ¥, æ¢å¤èµ·æ¥, è¿˜æ˜¯éœ€è¦ä¸€ç‚¹æ—¶é—´å’Œæ¯…åŠ›çš„, ä¸­é€”æˆ‘ä¹Ÿæ”¾å¼ƒè¿‡, ä½†æ˜¯æƒ³æƒ³å®ƒä»¬å°±è¦è¿™æ ·çš„è¢«æˆ‘æŠ¹æ€äº†, å®åœ¨å¤ªå¯æ€œäº†, å°±åšæŒä¸‹æ¥äº†ã€‚</p><h2 id="åæ€å’Œæ€»ç»“"><a href="#åæ€å’Œæ€»ç»“" class="headerlink" title="åæ€å’Œæ€»ç»“"></a>åæ€å’Œæ€»ç»“</h2><p>è¿˜åŸä¹‹å‰çš„æ•°æ®, æ¯”å†™æ–°æ–‡ç« è¿˜ç´¯, ä¸»è¦æ˜¯å¿ƒç´¯.</p><p>åˆšå¼€å§‹çš„æ—¶å€™, æˆ‘æ¯ç¯‡éƒ½æƒ³ä¸€æ­¥åˆ°ä½çš„è¿˜åŸ, å‘ç°åšæŒå‡ ä¸ªæ™šä¸Š, æ•ˆç‡å¾ˆä½, å¾ˆå®¹æ˜“æ”¾å¼ƒã€‚</p><p>æœ€å, æˆ‘è°ƒèŠ‚äº†ä¸€ä¸‹å¿ƒæ€, åˆ† <code>è¿­ä»£</code> å»åšã€‚</p><p><strong>ç¬¬ä¸€ä¸ªé˜¶æ®µ</strong>, æŠŠ HTML æ–‡ç« æ‹·è´åˆ° MarkDown å·¥å…·ä¸­, ä¸åšä»»ä½•çš„ä¿®é¥°å’Œä¿®æ”¹.</p><p><strong>ç¬¬äºŒä¸ªé˜¶æ®µ</strong>, æ¢³ç† MarkDown æ–‡æ¡£, æŠŠç¼ºå¤±çš„å›¾ç‰‡è¡¥ä¸Šå»ã€‚</p><p><strong>ç¬¬ä¸‰ä¸ªé˜¶æ®µ</strong>, æŠŠæ–‡ç« ä¸­çš„é“¾æ¥å°½é‡è¡¥å…¨ã€‚</p><p>ç»è¿‡è¿™ä¸‰ä¸ªé˜¶æ®µå, æ–‡ç« åŸºæœ¬å·²ç»å¤åŸäº†, åªæ˜¯æ ¼å¼ä¸Šçœ‹èµ·æ¥æœ‰ç‚¹ç³Ÿç³•ã€‚</p><p><strong>ç¬¬å››ä¸ªé˜¶æ®µ</strong>, æ•´ç†æ–‡ç« çš„æ’ç‰ˆ, å¯¹æ¯”å·²ç»å‘å¸ƒçš„æ–‡ç« , æŸ¥æ¼è¡¥ç¼ºã€‚</p><p>ç¬¬å››ä¸ªé˜¶æ®µç»“æŸå, æ–‡ç« åŸºæœ¬éƒ½å¤æ´»äº†, æ¥ä¸‹æ¥å°±æ˜¯éƒ¨ç½²å’Œå‘å¸ƒäº†ã€‚</p><p><strong>ç¬¬äº”ä¸ªé˜¶æ®µ</strong>, æ•´ç† Hexo, é…ç½®ç›¸å…³çš„ä¸»é¢˜ã€‚</p><p><strong>ç¬¬å…­ä¸ªé˜¶æ®µ</strong>, æœ¬åœ°é¢„è§ˆå’Œå†æ¬¡æ ¡éªŒæ–‡ç« , ç»Ÿä¸€å‘å¸ƒã€‚</p><p>æ¯ä¸ªé˜¶æ®µ, æˆ‘éƒ½ç»™è‡ªå·±ä¸€ä¸ªå°ç›®æ ‡, ä¸æ–­çš„å»å®Œå–„, æœ€åå°†å„ä¸ªé˜¶æ®µçš„æˆæœä¸²è”èµ·æ¥, å°±å®Œæˆäº†. å½“è‡ªå·±é‡åˆ°å›°éš¾çš„æ—¶å€™, ä¸å¦¨åˆ†è§£ä¸€ä¸‹ä»»åŠ¡, ä¸æ–­çš„å»å®Œæˆæ¯ä¸ªå°ä»»åŠ¡, æ¯ä¸ªå®Œæˆçš„å°ä»»åŠ¡éƒ½æ˜¯å¯¹è‡ªå·±æœ€å¤§çš„å¥–åŠ±ã€‚</p><p>æ•´ä¸ªè¿˜åŸçš„è¿‡ç¨‹, åˆè®©æˆ‘é‡æ–°æ¢³ç†äº†ä¸€ä¸‹ä¹‹å‰çš„æ–‡ç« , åŒ…æ‹¬ç›®å½•è§„åˆ’å’Œæ–‡ç« ä¸­çš„æªè¾, ä¹Ÿå¯¹å›¾ç‰‡è¿›è¡Œäº†å‹ç¼©å’Œå¤„ç†. æ”¶è·é¢‡å¤šã€‚</p><p>å¦‚æœå½“åˆè‡ªå·±ä¸é‚£ä¹ˆå†²åŠ¨, å¦‚æœå½“åˆè‡ªå·±å¤‡ä»½äº†æ–‡ä»¶, åº”è¯¥å°±ä¸ä¼šæœ‰è¿™ä¹ˆä¸€ä¸ªè‰°è¾›çš„å†ç¨‹äº†ã€‚</p><blockquote><p>æ•°æ®å¤‡ä»½å¾ˆé‡è¦, å†²åŠ¨æ˜¯è¦ä»˜å‡ºä»£ä»·çš„ã€‚</p></blockquote><p>ç°åœ¨æˆ‘æŠŠåŸæ•°æ®ä¿å­˜åœ¨äº‘ç›˜ä¸­, æœ¬åœ°ä¹Ÿä¿ç•™ä¸€ä»½, å®šæœŸæ›´æ–°åˆ°äº‘ç›˜ä¸­. è¿™æ ·å°±å¯ä»¥é˜²æ­¢æ•°æ®ä¸¢å¤±äº†ã€‚</p><p>ç¥å¤§å®¶åœ¨ 2018 å‘å‘å‘, èº«ä½“å¥åº·, å¹¸ç¦å®‰åº·!</p><h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><p>æ¨èç»™ Mac ç”¨æˆ·ä¸€ä¸ªå›¾ç‰‡å‹ç¼©å·¥å…· <a href="https://imageoptim.com/mac">imageoptim</a>.</p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹  ç”Ÿæ´» åæ€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GCC: é™æ€åº“</title>
      <link href="/2017/10/08/GCC-%E9%9D%99%E6%80%81%E5%BA%93/"/>
      <url>/2017/10/08/GCC-%E9%9D%99%E6%80%81%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h2><p>å¦‚æœä½ å¯¹ GCC çš„ç¼–è¯‘ Cè¯­è¨€çš„æµç¨‹ä¸æ¸…æ¥š, å»ºè®®åœ¨é˜…è¯»æœ¬æ–‡ä¹‹å‰å…ˆå»çœ‹ä¸€ä¸‹ <a href="http://www.veryitman.com/2017/10/03/GCC-%E7%BC%96%E8%AF%91C%E8%AF%AD%E8%A8%80%E7%9A%84%E6%B5%81%E7%A8%8B/">GCC: ç¼–è¯‘Cè¯­è¨€çš„æµç¨‹</a> è¿™ç¯‡æ–‡ç« , ç¯‡å¹…çŸ­å°ç²¾æ‚, é˜…è¯»å, è‡³å°‘å¯ä»¥æ‰«æ‰«ç›²ğŸ˜œ.</p><p>æœ¬ç¯‡åšæ–‡ç”¨åˆ°çš„ä¸€äº›åŸºç¡€çŸ¥è¯†ç‚¹:</p><p><strong>1.GCC</strong></p><p>gcc -c é€‰é¡¹å«ä¹‰:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Only run preprocess, compile, and assemble steps</span><br></pre></td></tr></table></figure><p>æ˜¯ <code>-c</code> é€‰é¡¹åªæ˜¯è¿›è¡Œäº†é¢„å¤„ç†, ç¼–è¯‘, æ±‡ç¼–çš„é˜¶æ®µ, ä¸ä¼šè¿›è¡Œé“¾æ¥çš„æ“ä½œ.</p><p><strong>2.é™æ€åº“</strong></p><p>Linux ä¸Šçš„é™æ€åº“ï¼Œæœ¬è´¨æ˜¯ä¸€äº›ç›®æ ‡æ–‡ä»¶çš„å½’æ¡£æ–‡ä»¶.</p><p><strong>3.é™æ€åº“å’Œå…±äº«åº“åŒºåˆ«</strong></p><p>[1].ä½¿ç”¨å…±äº«åº“å¯ä»¥èŠ‚çœå†…å­˜.</p><blockquote><p>æ¯”å¦‚ libcï¼Œç³»ç»Ÿä¸­å‡ ä¹æ‰€æœ‰çš„è¿›ç¨‹éƒ½æ˜ å°„ libc åˆ°è‡ªå·±çš„è¿›ç¨‹åœ°å€ç©ºé—´ï¼Œè€Œ libc çš„åªè¯»éƒ¨åˆ†åœ¨ç‰©ç†å†…å­˜ä¸­åªéœ€è¦å­˜åœ¨ä¸€ä»½ï¼Œå°±å¯ä»¥è¢«æ‰€æœ‰è¿›ç¨‹å…±äº«ï¼Œè¿™å°±æ˜¯â€œå…±äº«åº“â€è¿™ä¸ªåç§°çš„ç”±æ¥äº†.</p></blockquote><p>[2].ä½¿ç”¨å…±äº«åº“å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å‡çº§åº“æ–‡ä»¶è€Œä¸éœ€è¦é‡æ–°ç¼–è¯‘åº”ç”¨ç¨‹åº.</p><p>[3].å…±äº«åº“å ç”¨æ›´å°‘çš„ä½“ç§¯.</p><blockquote><p>åœ¨è¿è¡Œæ—¶åšåŠ¨æ€é“¾æ¥.è€Œåœ¨é“¾æ¥é™æ€åº“æ—¶, é“¾æ¥å™¨ä¼šæŠŠé™æ€åº“ä¸­çš„ç›®æ ‡æ–‡ä»¶å–å‡ºæ¥å’Œå¯æ‰§è¡Œæ–‡ä»¶çœŸæ­£é“¾æ¥åœ¨ä¸€èµ·.</p></blockquote><h2 id="åˆ›å»ºæ­¥éª¤"><a href="#åˆ›å»ºæ­¥éª¤" class="headerlink" title="åˆ›å»ºæ­¥éª¤"></a>åˆ›å»ºæ­¥éª¤</h2><p>åˆ›å»ºé™æ€åº“çš„æ­¥éª¤å¦‚ä¸‹:</p><p>[1]. å†™æºæ–‡ä»¶.<br>[2]. é€šè¿‡ gcc -c x.c ç”Ÿæˆç›®æ ‡æ–‡ä»¶.<br>[2]. å½’æ¡£. ç”¨ ar å½’æ¡£ç›®æ ‡æ–‡ä»¶ï¼Œç”Ÿæˆé™æ€åº“.<br>[3]. å†™å¤´æ–‡ä»¶, ä¾¿äºä½¿ç”¨è€…çŸ¥é“æ€ä¹ˆä½¿ç”¨è¯¥é™æ€åº“.</p><p>ä½¿ç”¨é™æ€åº“æ—¶ï¼Œåœ¨æºç ä¸­åŒ…å«å¯¹åº”çš„å¤´æ–‡ä»¶ï¼Œé“¾æ¥æ—¶è®°å¾—é“¾æ¥è‡ªå·±çš„åº“.</p><p>ä¸‹é¢ç»“åˆå…·ä½“ä¾‹å­, å±•å¼€è®².</p><h2 id="å†™æºæ–‡ä»¶"><a href="#å†™æºæ–‡ä»¶" class="headerlink" title="å†™æºæ–‡ä»¶"></a>å†™æºæ–‡ä»¶</h2><p>ç›®å½•ç»“æ„<br><img src="/upload/images/2017/10/08/1.jpg" alt="1"></p><p>ç¤ºä¾‹æ–‡ä»¶éƒ½æ˜¯å¾ˆç®€å•çš„ä»£ç , é™„å½•å¯ä»¥æŸ¥çœ‹å®Œæ•´ç¤ºä¾‹.</p><h2 id="ç”Ÿæˆç›®æ ‡æ–‡ä»¶"><a href="#ç”Ÿæˆç›®æ ‡æ–‡ä»¶" class="headerlink" title="ç”Ÿæˆç›®æ ‡æ–‡ä»¶"></a>ç”Ÿæˆç›®æ ‡æ–‡ä»¶</h2><p>å°† libs ç›®å½•ä¸‹é¢çš„(c)æºæ–‡ä»¶è¿›è¡Œé¢„å¤„ç†, ç¼–è¯‘å’Œæ±‡ç¼–.<br>æ³¨æ„è¿™é‡Œæ²¡æœ‰è¿›è¡Œé“¾æ¥.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -c libs/person.c libs/eat.c libs/play.c libs/sleep.c</span><br></pre></td></tr></table></figure><p>æ‰§è¡ŒåŸå, ä¼šç”Ÿæˆå¯¹åº”çš„ .o æ–‡ä»¶.</p><h2 id="å½’æ¡£"><a href="#å½’æ¡£" class="headerlink" title="å½’æ¡£"></a>å½’æ¡£</h2><p><code>libperson.a</code> æ˜¯è¦ç”Ÿæˆçš„åº“æ–‡ä»¶.</p><p>åº“æ–‡ä»¶éƒ½ä»¥ lib å¼€å¤´, é™æ€åº“ä»¥. a ä¸ºåç¼€. æ‰€ä»¥ä¸€èˆ¬æ˜¯ lib+ åå­—.a</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ar rs libperson.a person.o sleep.o play.o eat.o</span><br></pre></td></tr></table></figure><p>ar: ç±»ä¼¼äº tar, ç”¨æ¥å¯¹æ–‡ä»¶è¿›è¡Œåº“æ‰“åŒ….</p><p>r é€‰é¡¹: å°†å…¶åé¢çš„æ–‡ä»¶åˆ—è¡¨æ·»åŠ åˆ°æ–‡ä»¶åŒ…(libperson.a)ä¸­, å¦‚æœ libperson.a ä¸å­˜åœ¨å°±åˆ›å»ºå®ƒ, å¦‚æœ libperson.a å·²ç»å­˜åœ¨ä¸”é‡Œé¢æœ‰åŒåçš„ç›®æ ‡æ–‡ä»¶å°±è¿›è¡Œæ›¿æ¢æ“ä½œ.</p><p>s é€‰é¡¹: ä¸ºé™æ€åº“åˆ›å»ºç´¢å¼•.è¿™ä¸ªç´¢å¼•ä¼šè¢«é“¾æ¥å™¨ä½¿ç”¨.</p><blockquote><p>ranlib å‘½ä»¤ä¹Ÿå¯ä»¥ä¸ºé™æ€åº“åˆ›å»ºç´¢å¼•. æ‰€ä»¥ä¸Šé¢çš„å‘½ä»¤å¯ä»¥ç­‰æ•ˆä¸ºä¸‹é¢çš„ä¸¤ä¸ªå‘½ä»¤.</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ar r libperson.a person.o sleep.o play.o eat.o</span><br><span class="line">ranlib libperson.a</span><br></pre></td></tr></table></figure><h2 id="å†™å¤´æ–‡ä»¶"><a href="#å†™å¤´æ–‡ä»¶" class="headerlink" title="å†™å¤´æ–‡ä»¶"></a>å†™å¤´æ–‡ä»¶</h2><p>å†™ä¸€ä¸ª person.h æ–‡ä»¶, ä¾¿äºè°ƒç”¨è€…æŸ¥çœ‹åº“å¦‚ä½•ä½¿ç”¨.</p><p>person.h</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#ifndef _PERSON_H</span><br><span class="line">#define _PERSON_H</span><br><span class="line">extern void init(int pUid);</span><br><span class="line">extern void eat();</span><br><span class="line">extern void play();</span><br><span class="line">extern void sleep();</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨é™æ€åº“</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc main.c -L. -lperson -Ilibs -o main</span><br></pre></td></tr></table></figure><p>-L é€‰é¡¹: å‘Šè¯‰ç¼–è¯‘å™¨å»å“ªé‡Œæ‰¾åº“æ–‡ä»¶, è¿™é‡Œçš„ _L. è¡¨ç¤ºåœ¨å½“å‰ç›®å½•.<br>å¦‚æœä¸ç”¨ -L é€‰é¡¹, å³ä½¿åº“æ–‡ä»¶åœ¨å½“å‰ç›®å½•, ç¼–è¯‘å™¨ä¹Ÿä¸ä¼šå»æ‰¾, æ‰€ä»¥è¯¥é€‰é¡¹ä¸èƒ½å°‘.</p><p>æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ld: library not found for -lperson</span><br><span class="line">clang: error: linker command failed with exit code 1 (use -v to see invocation)</span><br></pre></td></tr></table></figure><p>-lperson: å‘Šè¯‰ç¼–è¯‘å™¨è¦é“¾æ¥ libperson.a åº“.</p><p>-I: å‘Šè¯‰ç¼–è¯‘å™¨åˆ°å“ªé‡Œæ‰¾å¤´æ–‡ä»¶.<br>å¦‚æœä¸æŒ‡å®šå¤´æ–‡ä»¶çš„æŸ¥æ‰¾ç›®å½•, ä¹Ÿä¼šæŠ¥é”™:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">main.c:2:10: fatal error: &#x27;person.h&#x27; file not found</span><br><span class="line">#include &quot;person.h&quot;</span><br><span class="line">         ^~~~~~~~~~</span><br><span class="line">1 error generated.</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶çš„ç›®å½•ç»“æ„:<br><img src="/upload/images/2017/10/08/2.jpg" alt="1"></p><p>é“¾æ¥æˆåŠŸå, å¯ä»¥æ‰§è¡Œç”Ÿæˆçš„ main (å¯æ‰§è¡Œ)æ–‡ä»¶.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./main</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">uid: 101 eating</span><br><span class="line">uid: 101 playing</span><br><span class="line">uid: 101 has sleep</span><br></pre></td></tr></table></figure><h2 id="æœ‰è¶£çš„å®éªŒ"><a href="#æœ‰è¶£çš„å®éªŒ" class="headerlink" title="æœ‰è¶£çš„å®éªŒ"></a>æœ‰è¶£çš„å®éªŒ</h2><p>çŒœæƒ³ä¸€ä¸‹å¦‚æœæœ‰ä¸¤ä¸ªåº“ä¸€ä¸ªæ˜¯å…±äº«åº“, ä¸€ä¸ªæ˜¯é™æ€åº“, è€Œä¸”äºŒè€…é™¤äº†åç¼€ä¸ä¸€æ ·, åå­—éƒ½ä¸€æ ·å¦‚ libperson.a å’Œ libperson.so, é‚£ä¹ˆè°ƒç”¨æ–¹å¦‚ä½•æ¥é€‰æ‹©å¯¹åº”çš„åº“æ–‡ä»¶å‘¢?</p><p>æˆ‘ä»¬æŠŠ GCC: å…±äº«åº“ é‡Œé¢ç”Ÿæˆçš„å…±äº«åº“ libperson.so æ”¾åˆ°å½“å‰çš„ç›®å½•, é‡æ–°ç¼–è¯‘é“¾æ¥ main.c æ–‡ä»¶.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc main.c -L. -lperson -Ilibs -o main</span><br></pre></td></tr></table></figure><p>å†æ¬¡æ‰§è¡Œ .&#x2F;main, å¾—åˆ°ç»“æœæ˜¯è¿™æ ·çš„:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">From sharedlib.uid: 101 eating</span><br><span class="line">From sharedlib.uid: 101 playing</span><br><span class="line">From sharedlib.uid: 101 has sleep</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šçš„ç»“æœ, è¯´æ˜é“¾æ¥å™¨ä¼šä¼˜å…ˆé€‰æ‹©å…±äº«åº“å…¶æ¬¡æ‰æ˜¯é™æ€åº“.</p><blockquote><p>Linux(MacOS ä¹Ÿä¸€æ ·) çš„ GCC é»˜è®¤é“¾æ¥åŠ¨æ€åº“ï¼Œåªæœ‰å½“åŠ¨æ€åº“ä¸å­˜åœ¨æ—¶ï¼Œæ‰å»é“¾æ¥é™æ€åº“.<br>è‹¥æ˜¯éœ€è¦å¼ºåˆ¶æŒ‡å®šé™æ€åº“éœ€è¦æŒ‡å®šé€‰é¡¹ -static.ä½†æ˜¯åœ¨ MacOS ä¸Šé¢ä¸æ”¯æŒè¯¥é€‰é¡¹.</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -static main.c -L. -lperson -Ilibs -o main</span><br></pre></td></tr></table></figure><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p>ç¤ºä¾‹å®Œæ•´ä»£ç </p><blockquote><p>main.c</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &quot;person.h&quot;</span><br><span class="line">int main() &#123;</span><br><span class="line">    init(101);</span><br><span class="line">    eat();</span><br><span class="line">    play();</span><br><span class="line">    sleep();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>person.h</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#ifndef _PERSON_H</span><br><span class="line">#define _PERSON_H</span><br><span class="line">extern void init(int pUid);</span><br><span class="line">extern void eat();</span><br><span class="line">extern void play();</span><br><span class="line">extern void sleep();</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure><blockquote><p>person.c</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">int uid;</span><br><span class="line">void init(int pUid) &#123;</span><br><span class="line">    uid = pUid;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>eat.c</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">extern int uid;</span><br><span class="line">void eat() &#123;</span><br><span class="line">    printf(&quot;uid: %i eating\n&quot;, uid);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>play.c</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">extern int uid;</span><br><span class="line">void play() &#123;</span><br><span class="line">    printf(&quot;uid: %i playing\n&quot;, uid);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>sleep.c</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">extern int uid;</span><br><span class="line">void sleep() &#123;</span><br><span class="line">    printf(&quot;uid: %i has sleep\n&quot;, uid);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="GCC-ç³»åˆ—åšæ–‡"><a href="#GCC-ç³»åˆ—åšæ–‡" class="headerlink" title="GCC ç³»åˆ—åšæ–‡"></a>GCC ç³»åˆ—åšæ–‡</h2><p><a href="http://www.veryitman.com/2017/10/03/GCC-%E7%BC%96%E8%AF%91C%E8%AF%AD%E8%A8%80%E7%9A%84%E6%B5%81%E7%A8%8B/">GCC: ç¼–è¯‘ C è¯­è¨€çš„æµç¨‹</a></p><p><a href="http://www.veryitman.com/2017/10/07/GCC-Homebrew-%E5%AE%89%E8%A3%85-GCC-%E5%92%8C-Binutils/">GCC: Homebrew å®‰è£… GCC å’Œ Binutils</a></p><p><a href="http://www.veryitman.com/2017/10/07/GCC-%E5%85%B1%E4%BA%AB%E5%BA%93/">GCC: å…±äº«åº“</a></p><p><a href="http://www.veryitman.com/2017/10/08/GCC-%E9%9D%99%E6%80%81%E5%BA%93/">GCC: é™æ€åº“</a></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GCC ç¼–è¯‘å™¨ é™æ€åº“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GCC: å…±äº«åº“</title>
      <link href="/2017/10/07/GCC-%E5%85%B1%E4%BA%AB%E5%BA%93/"/>
      <url>/2017/10/07/GCC-%E5%85%B1%E4%BA%AB%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><p>å…±äº«åº“: åœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´éœ€è¦è°ƒç”¨åˆ°å…±äº«åº“çš„æ—¶å€™æ‰åŠ è½½åˆ°å†…å­˜é‡Œé¢ï¼Œå¯ä»¥è¢«å¤šä¸ªç¨‹åºå…±äº«ä½¿ç”¨.</p><p>åœ¨ MacOS ä¸Šé¢åˆ›å»ºå’Œä½¿ç”¨å…±äº«åº“è¦æ¯”åœ¨ Linux ä¸Šé¢ç®€å•.<br>åœ¨ Linux ä¸Šé¢è¿˜ä¼šç‰µæ‰¯åˆ°å…±äº«åº“è·¯å¾„é—®é¢˜, åœ¨ Mac ä¸Šé¢å°±æ²¡æœ‰è¿™æ ·çš„é—®é¢˜.</p><p>åœ¨ MacOS ä¸Šé¢ä½¿ç”¨çš„ GCC å…¶æœ¬è´¨æ˜¯ LLVM. ä½ å¯ä»¥åœ¨å‘½ä»¤è¡Œ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -v</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å¯¹åº”çš„è¾“å‡ºç»“æœ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Configured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/c++/4.2.1</span><br><span class="line">Apple LLVM version 9.0.0 (clang-900.0.37)</span><br><span class="line">Target: x86_64-apple-darwin16.7.0</span><br><span class="line">Thread model: posix</span><br><span class="line">InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin</span><br></pre></td></tr></table></figure><h2 id="åˆ›å»ºå…±äº«åº“æ­¥éª¤"><a href="#åˆ›å»ºå…±äº«åº“æ­¥éª¤" class="headerlink" title="åˆ›å»ºå…±äº«åº“æ­¥éª¤"></a>åˆ›å»ºå…±äº«åº“æ­¥éª¤</h2><p>[1].å†™æºæ–‡ä»¶.è¿™é‡Œä»¥ Cæ–‡ä»¶ä¸ºåŸºç¡€.<br>[2].å°†æºæ–‡ä»¶ç”Ÿæˆç›®æ ‡æ–‡ä»¶.<br>[3].åˆ›å»ºå…±äº«åº“.<br>[4].å†™å¤´æ–‡ä»¶, ä¾›è°ƒç”¨æ–¹ä½¿ç”¨.</p><p>ä¸‹é¢ç»“åˆå®ä¾‹æ¥åˆ†äº«ä¸€ä¸‹å¦‚ä½•åœ¨ Mac ä¸Šé¢åˆ›å»ºå…±äº«åº“.</p><h2 id="å†™æºæ–‡ä»¶"><a href="#å†™æºæ–‡ä»¶" class="headerlink" title="å†™æºæ–‡ä»¶"></a>å†™æºæ–‡ä»¶</h2><p>ç›®å½•ç»“æ„:<br><img src="/upload/images/2017/10/07/1.jpg" alt="1"></p><p>å¯¹åº”çš„å®Œæ•´ä»£ç å¯ä»¥çœ‹æ–‡æœ«çš„é™„å½•.</p><h2 id="ç”Ÿæˆç›®æ ‡æ–‡ä»¶"><a href="#ç”Ÿæˆç›®æ ‡æ–‡ä»¶" class="headerlink" title="ç”Ÿæˆç›®æ ‡æ–‡ä»¶"></a>ç”Ÿæˆç›®æ ‡æ–‡ä»¶</h2><p>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -Wall -c -fPIC libs/eat.c libs/play.c libs/sleep.c libs/person.c</span><br></pre></td></tr></table></figure><p>æ³¨æ„: <code>-fPIC</code> é€‰é¡¹ä¸€å®šè¦åŠ .</p><blockquote><p>PIC(position independent code), äº§ç”Ÿä½ç½®æ— å…³ç </p></blockquote><h2 id="ç”Ÿæˆå…±äº«åº“"><a href="#ç”Ÿæˆå…±äº«åº“" class="headerlink" title="ç”Ÿæˆå…±äº«åº“"></a>ç”Ÿæˆå…±äº«åº“</h2><p>è¿™é‡ŒæŠŠå…±äº«åº“æš‚ä¸”ç§°ä¹‹ä¸º <code>libperson.so</code>.</p><p>æ‰§è¡Œä¸‹é¢å‘½ä»¤åˆ›å»º:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -shared -fPIC eat.o play.o sleep.o person.o -o libperson.so</span><br></pre></td></tr></table></figure><h2 id="å†™å¤´æ–‡ä»¶"><a href="#å†™å¤´æ–‡ä»¶" class="headerlink" title="å†™å¤´æ–‡ä»¶"></a>å†™å¤´æ–‡ä»¶</h2><p>è¿™é‡Œå¤´æ–‡ä»¶ä¸»è¦æ˜¯ <code>person.h</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#ifndef _PERSON_H</span><br><span class="line">#define _PERSON_H</span><br><span class="line">extern void init(int pUid);</span><br><span class="line">extern void eat();</span><br><span class="line">extern void play();</span><br><span class="line">extern void sleep();</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨å…±äº«åº“"><a href="#ä½¿ç”¨å…±äº«åº“" class="headerlink" title="ä½¿ç”¨å…±äº«åº“"></a>ä½¿ç”¨å…±äº«åº“</h2><p>main.c æ˜¯ä½¿ç”¨æ–¹, ç¼–è¯‘é“¾æ¥å³å¯.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc main.c -L. -lperson -Ilibs -o main</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ main, æ‰§è¡Œç»“æœ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">From sharedlib.uid: 101 eating</span><br><span class="line">From sharedlib.uid: 101 playing</span><br><span class="line">From sharedlib.uid: 101 has sleep</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„:</strong><br>-L é€‰é¡¹, å‘Šè¯‰ç¼–è¯‘å™¨å»å“ªé‡Œæ‰¾åº“æ–‡ä»¶, è¿™é‡Œçš„ _L. è¡¨ç¤ºåœ¨å½“å‰ç›®å½•.</p><p>-lperson, è¡¨ç¤º libperson.so åº“.</p><p>-Ilibs å‘Šè¯‰ç¼–è¯‘å™¨å¤´æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•.</p><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p>ç¤ºä¾‹å®Œæ•´ä»£ç </p><blockquote><p>main.c</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &quot;person.h&quot;</span><br><span class="line">int main() &#123;</span><br><span class="line">    init(101);</span><br><span class="line">    eat();</span><br><span class="line">    play();</span><br><span class="line">    sleep();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>person.h</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#ifndef _PERSON_H</span><br><span class="line">#define _PERSON_H</span><br><span class="line">extern void init(int pUid);</span><br><span class="line">extern void eat();</span><br><span class="line">extern void play();</span><br><span class="line">extern void sleep();</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure><blockquote><p>person.c</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">int uid;</span><br><span class="line">void init(int pUid) &#123;</span><br><span class="line">    uid = pUid;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>eat.c</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">extern int uid;</span><br><span class="line">void eat() &#123;</span><br><span class="line">    printf(&quot;From sharedlib.uid: %i eating\n&quot;, uid);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>play.c</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">extern int uid;</span><br><span class="line">void play() &#123;</span><br><span class="line">    printf(&quot;From sharedlib.uid: %i playing\n&quot;, uid);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>sleep.c</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">extern int uid;</span><br><span class="line">void sleep() &#123;</span><br><span class="line">    printf(&quot;From sharedlib.uid: %i has sleep\n&quot;, uid);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="GCC-ç³»åˆ—åšæ–‡"><a href="#GCC-ç³»åˆ—åšæ–‡" class="headerlink" title="GCC ç³»åˆ—åšæ–‡"></a>GCC ç³»åˆ—åšæ–‡</h2><p><a href="http://www.veryitman.com/2017/10/03/GCC-%E7%BC%96%E8%AF%91C%E8%AF%AD%E8%A8%80%E7%9A%84%E6%B5%81%E7%A8%8B/">GCC: ç¼–è¯‘ C è¯­è¨€çš„æµç¨‹</a></p><p><a href="http://www.veryitman.com/2017/10/07/GCC-Homebrew-%E5%AE%89%E8%A3%85-GCC-%E5%92%8C-Binutils/">GCC: Homebrew å®‰è£… GCC å’Œ Binutils</a></p><p><a href="http://www.veryitman.com/2017/10/07/GCC-%E5%85%B1%E4%BA%AB%E5%BA%93/">GCC: å…±äº«åº“</a></p><p><a href="http://www.veryitman.com/2017/10/08/GCC-%E9%9D%99%E6%80%81%E5%BA%93/">GCC: é™æ€åº“</a></p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GCC ç¼–è¯‘å™¨ å…±äº«åº“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GCC: Homebrew å®‰è£… GCC å’Œ Binutils</title>
      <link href="/2017/10/07/GCC-Homebrew-%E5%AE%89%E8%A3%85-GCC-%E5%92%8C-Binutils/"/>
      <url>/2017/10/07/GCC-Homebrew-%E5%AE%89%E8%A3%85-GCC-%E5%92%8C-Binutils/</url>
      
        <content type="html"><![CDATA[<h2 id="æ–‡ç« èƒŒæ™¯"><a href="#æ–‡ç« èƒŒæ™¯" class="headerlink" title="æ–‡ç« èƒŒæ™¯"></a>æ–‡ç« èƒŒæ™¯</h2><p>å‰æ®µæ—¶é—´ï¼Œæœ‰ä¸ªåšå®¢ä¸Šé¢çš„å°ä¼™ä¼´ç»™æˆ‘å‘æ¥é‚®ä»¶ï¼Œé—®æˆ‘å…³äº GCC ç›¸å…³çš„çŸ¥è¯†ï¼Œå¯¹äº GCC æˆ‘ä¹Ÿåªæ˜¯å‡­ç€ä¹‹å‰çš„äº†è§£ï¼Œå›å¤ä»–äº†ã€‚ä¹¦åˆ°ç”¨æ—¶æ–¹æ¨å°‘å‘€ï¼</p><p>è¿™ä½å°ä¼™ä¼´è¿˜åœ¨è¯»å¤§å­¦ï¼Œè‡ªå­¦èƒ½åŠ›æ¯”è¾ƒå¼ºï¼Œè‡ªå·±å‡ºäº†å®Œæˆè¯¾æ—¶ä¹‹å¤–ï¼Œè¿˜ä¼šåœ¨ç½‘ä¸Šæ‰¾èµ„æ–™è‡ªå­¦ã€‚</p><p>æˆ‘è®°å¾—è‡ªå·±åœ¨å¤§å­¦çš„æ—¶å€™ï¼Œå¯¹ GCC ä¸€çªä¸é€šï¼ŒåªçŸ¥é“ Turbo-C å’Œé‚£äº›è¢«å¼ºåˆ¶è®°ä½çš„å…³é”®å­—ã€‚</p><p>æœ€åå‘Šè¯‰ä»–, æˆ‘ä¼šåšæŒæŠŠè‡ªå·±ä»¥å‰å­¦ä¹ è¿‡ç›¸å…³ GCC çš„çŸ¥è¯†ï¼Œä»¥åšå®¢çš„å½¢å¼è¾“å‡ºã€‚äºæ˜¯ã€‚å°±æœ‰äº† <a href="http://www.veryitman.com/categories/C-C/">GCC ç³»åˆ—</a> çš„æ–‡ç« ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åˆ°å¤§å®¶ã€‚</p><h2 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h2><p>è¿™ç¯‡åšå®¢ä¸»è¦åˆ†äº« macOS ä¸‹å®‰è£… GCC å’Œ Binutils å·¥å…·ã€‚</p><p>macOS ç»ˆç«¯ä¸‹è¾“å…¥ <code>gcc -v</code>, å…¶å®æ˜¯é“¾æ¥æŒ‡å‘äº† LLVM ç¼–è¯‘å™¨, ä¸æ˜¯ GNU çš„ GCC.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Configured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/c++/4.2.1</span><br><span class="line">Apple LLVM version 9.0.0 (clang-900.0.37)</span><br><span class="line">Target: x86_64-apple-darwin16.7.0</span><br><span class="line">Thread model: posix</span><br><span class="line">InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…-GCC"><a href="#å®‰è£…-GCC" class="headerlink" title="å®‰è£… GCC"></a>å®‰è£… GCC</h2><p>å…³äº GCC, å¯ä»¥å‚è€ƒ <a href="https://zh.wikipedia.org/wiki/GCC">ç»´åŸºç™¾ç§‘</a>.</p><p>æ‰§è¡Œä¸‹é¢å‘½ä»¤, å³å¯å¼€å§‹å®‰è£…:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew tap homebrew/versions</span><br></pre></td></tr></table></figure><p>ç„¶åæœç´¢ <code>gcc</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew search gcc</span><br></pre></td></tr></table></figure><p>æœç´¢ç»“æœä¸­ä¼šæ˜¾ç¤º gcc çš„ç‰ˆæœ¬ï¼Œå¯ä»¥é€‰æ‹©å®‰è£…ä¸€ä¸ªï¼Œå»ºè®®å®‰è£…æœ€æ–°ç‰ˆã€‚</p><p>è¿™é‡Œä»¥å®‰è£… gcc49 ä¸ºä¾‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install gcc49</span><br></pre></td></tr></table></figure><p>brew ä¼šè‡ªåŠ¨ä¸ºä½ å®‰è£…ç›¸å…³ä¾èµ–ï¼Œå¦‚ gmp4ã€mpfr2ã€libmpc08ã€isl011ã€cloog018.</p><p>è¿™é‡Œå®‰è£…éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´â€¦</p><p>çœ‹åˆ°ä¸‹é¢çš„å†…å®¹, è¡¨ç¤ºå®‰è£…å®Œæ¯•.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Pouring gcc49-4.9.2_1.yosemite.bottle.1.tar.gz</span><br><span class="line"></span><br><span class="line">/usr/local/Cellar/gcc49/4.9.2_1: 1138 files, 164M</span><br></pre></td></tr></table></figure><p>å®‰è£…æˆåŠŸå, å®‰è£…ç›®å½•åœ¨:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/Cellar/gcc49/4.9.2_1</span><br></pre></td></tr></table></figure><p>ä½ åœ¨ç»ˆç«¯ç›´æ¥è¾“å…¥ <code>gcc -v</code>ï¼Œå…¶å®è¿˜æ˜¯ LLVMï¼Œé‚£ä¹ˆå¦‚ä½•ä½¿ç”¨æˆ‘ä»¬ åˆšå®‰è£…çš„ gcc?</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/Cellar/gcc49/4.9.2_1/bin</span><br><span class="line"></span><br><span class="line">ls -l</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">c++-4.9</span><br><span class="line">cpp-4.9</span><br><span class="line">g++-4.9</span><br><span class="line">gcc-4.9</span><br><span class="line">gcc-ar-4.9</span><br><span class="line">gcc-nm-4.9</span><br><span class="line">gcc-ranlib-4.9</span><br><span class="line">gcov-4.9</span><br><span class="line">x86_64-apple-darwin14.3.0-c++-4.9</span><br><span class="line">x86_64-apple-darwin14.3.0-g++-4.9</span><br><span class="line">x86_64-apple-darwin14.3.0-gcc-4.9</span><br><span class="line">x86_64-apple-darwin14.3.0-gcc-4.9.2</span><br><span class="line">x86_64-apple-darwin14.3.0-gcc-ar-4.9</span><br><span class="line">x86_64-apple-darwin14.3.0-gcc-nm-4.9</span><br><span class="line">x86_64-apple-darwin14.3.0-gcc-ranlib-4.9</span><br></pre></td></tr></table></figure><p>Okï¼Œä½ åº”è¯¥æ˜ç™½äº†, åœ¨å‘½ä»¤è¡Œè¾“å…¥ <code>gcc-4.9 -v</code> å°±å¯ä»¥ä½¿ç”¨æˆ‘ä»¬åˆšå®‰è£…çš„ GCC äº†ï¼ŒåŒ…æ‹¬ g++ ç­‰å·¥å…·.</p><p>ä»¥åä½¿ç”¨ GNU çš„ GCC è¾“å…¥ <code>gcc-4.9</code> å°±å¥½äº†ã€‚</p><h2 id="å®‰è£…-Binutils"><a href="#å®‰è£…-Binutils" class="headerlink" title="å®‰è£… Binutils"></a>å®‰è£… Binutils</h2><p>å…³äº Binutils å¯ä»¥å‚è€ƒ <a href="https://zh.wikipedia.org/zh-cn/GNU_Binutils">ç»´åŸºç™¾ç§‘</a>.</p><p>æ‰§è¡Œä¸‹é¢å‘½ä»¤, ç›´æ¥å®‰è£…:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install binutils</span><br></pre></td></tr></table></figure><p>åŒç†:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/Cellar/binutils/2.25/bin</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä½ éœ€è¦çš„å·¥å…·:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">gaddr2line</span><br><span class="line">gar</span><br><span class="line">gc++filt</span><br><span class="line">gcoffdump</span><br><span class="line">gdlltool</span><br><span class="line">gdllwrap</span><br><span class="line">gelfedit</span><br><span class="line">gnlmconv</span><br><span class="line">gnm</span><br><span class="line">gobjcopy</span><br><span class="line">gobjdump</span><br><span class="line">granlib</span><br><span class="line">greadelf</span><br><span class="line">gsize</span><br><span class="line">gsrconv</span><br><span class="line">gstrings</span><br><span class="line">gstrip</span><br><span class="line">gsysdump</span><br><span class="line">gwindmc</span><br><span class="line">gwindres</span><br></pre></td></tr></table></figure><h2 id="ä¸ªäººæ„Ÿå—"><a href="#ä¸ªäººæ„Ÿå—" class="headerlink" title="ä¸ªäººæ„Ÿå—"></a>ä¸ªäººæ„Ÿå—</h2><p>åœ¨ macOS ä¸Šé¢ï¼Œå³ä½¿å®‰è£…äº† GNU çš„ GCCï¼Œä¹Ÿæ²¡æœ‰åœ¨ Linux ä¸Šé¢ç”¨çš„é‚£ä¹ˆçˆ½ï¼Œå¾ˆå¤š GCC çš„å‘½ä»¤é€‰é¡¹åœ¨ macOS ä¸Šé¢æ— æ³•ä½¿ç”¨ï¼Œä½†ä¸å¾—ä¸æ‰¿è®¤ LLVM æ˜¯æ¯”è¾ƒä¼˜ç§€çš„ç¼–è¯‘å™¨ã€‚</p><h2 id="é‡åˆ°é—®é¢˜"><a href="#é‡åˆ°é—®é¢˜" class="headerlink" title="é‡åˆ°é—®é¢˜"></a>é‡åˆ°é—®é¢˜</h2><p>gcc-4.9 ç¼–è¯‘ä»£ç æŠ¥é”™ï¼ŒæŠ¥é”™å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">main.c:<span class="number">9</span>:<span class="number">19</span>: fatal error: stdio.h: No such file or directory</span><br><span class="line"> <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line">                   ^</span><br><span class="line">compilation terminated.</span><br></pre></td></tr></table></figure><p>å¸è½½ <code>gcc</code> é‡æ–°å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ <code>gcc</code> å³å¯ï¼Œå¦‚æœä½ ä¸çŸ¥é“æœ€æ–°çš„ <code>gcc</code> ç‰ˆæœ¬æ˜¯å“ªä¸ªï¼Œå¯ä»¥ search ä¸€ä¸‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew search gcc</span><br></pre></td></tr></table></figure><p>æ˜¾ç¤ºç»“æœå¤§è‡´å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gcc        </span><br><span class="line">gcc@5                 </span><br><span class="line">gcc@7</span><br><span class="line">gcc@4.9                  </span><br><span class="line">gcc@6            </span><br><span class="line">i386-elf-gcc</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä»¥å®‰è£… <code>gcc@7</code> ä¸ºä¾‹ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// å¸è½½åŸæ¥çš„</span><br><span class="line">brew uninstall gcc</span><br><span class="line"></span><br><span class="line">// å®‰è£…æœ€æ–°ç‰ˆæœ¬</span><br><span class="line">brew install gcc@7</span><br></pre></td></tr></table></figure><h2 id="GCC-ç³»åˆ—åšæ–‡"><a href="#GCC-ç³»åˆ—åšæ–‡" class="headerlink" title="GCC ç³»åˆ—åšæ–‡"></a>GCC ç³»åˆ—åšæ–‡</h2><p><a href="http://www.veryitman.com/2017/10/03/GCC-%E7%BC%96%E8%AF%91C%E8%AF%AD%E8%A8%80%E7%9A%84%E6%B5%81%E7%A8%8B/">GCC: ç¼–è¯‘ C è¯­è¨€çš„æµç¨‹</a></p><p><a href="http://www.veryitman.com/2017/10/07/GCC-Homebrew-%E5%AE%89%E8%A3%85-GCC-%E5%92%8C-Binutils/">GCC: Homebrew å®‰è£… GCC å’Œ Binutils</a></p><p><a href="http://www.veryitman.com/2017/10/07/GCC-%E5%85%B1%E4%BA%AB%E5%BA%93/">GCC: å…±äº«åº“</a></p><p><a href="http://www.veryitman.com/2017/10/08/GCC-%E9%9D%99%E6%80%81%E5%BA%93/">GCC: é™æ€åº“</a></p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> brew GCC C ç¼–è¯‘å™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GCC: ç¼–è¯‘Cè¯­è¨€çš„æµç¨‹</title>
      <link href="/2017/10/03/GCC-%E7%BC%96%E8%AF%91C%E8%AF%AD%E8%A8%80%E7%9A%84%E6%B5%81%E7%A8%8B/"/>
      <url>/2017/10/03/GCC-%E7%BC%96%E8%AF%91C%E8%AF%AD%E8%A8%80%E7%9A%84%E6%B5%81%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>å†çœ‹ä¸‹æ–‡ä¹‹å‰ï¼Œå…ˆæ™®åŠä¸€ä¸‹ Linux å’Œ gcc çš„å†å²ï¼Œä¸‹é¢çš„è¿™æ®µå†…å®¹æ¥è‡ªäºç½‘ç»œã€‚</p><blockquote><p>æ—©åœ¨ 20 ä¸–çºª 70 å¹´ä»£ï¼ŒUNIX ç³»ç»Ÿæ˜¯å¼€æºè€Œä¸”å…è´¹çš„ã€‚ä½†æ˜¯åœ¨ 1979 å¹´æ—¶ï¼ŒAT&amp;T å…¬å¸å®£å¸ƒäº†å¯¹ UNIX ç³»ç»Ÿçš„å•†ä¸šåŒ–è®¡åˆ’ï¼Œéšä¹‹å¼€æºè½¯ä»¶ä¸šè½¬å˜æˆäº†ç‰ˆæƒå¼è½¯ä»¶äº§ä¸šï¼Œæºä»£ç è¢«å½“ä½œå•†ä¸šæœºå¯†ï¼Œæˆä¸ºä¸“åˆ©äº§å“ï¼Œäººä»¬å†ä¹Ÿä¸èƒ½è‡ªç”±åœ°äº«å—ç§‘æŠ€æˆæœã€‚</p></blockquote><blockquote><p>äºæ˜¯åœ¨ 1984 å¹´ï¼ŒRichard Stallman é¢å¯¹äºå¦‚æ­¤å°é—­çš„è½¯ä»¶åˆ›ä½œç¯å¢ƒï¼Œå‘èµ·äº† GNU æºä»£ç å¼€æ”¾è®¡åˆ’å¹¶åˆ¶å®šäº†è‘—åçš„ GPL è®¸å¯åè®®ã€‚</p></blockquote><blockquote><p>1987 å¹´æ—¶ï¼ŒGNU è®¡åˆ’è·å¾—äº†ä¸€é¡¹é‡å¤§çªç ´â€”gccç¼–è¯‘å™¨å‘å¸ƒï¼Œè¿™ä½¿å¾—ç¨‹åºå‘˜å¯ä»¥åŸºäºè¯¥ç¼–è¯‘å™¨ç¼–å†™å‡ºå±äºè‡ªå·±çš„å¼€æºè½¯ä»¶ã€‚</p></blockquote><blockquote><p>éšä¹‹ï¼Œåœ¨ 1991 å¹´10 æœˆï¼ŒèŠ¬å…°èµ«å°”è¾›åŸºå¤§å­¦çš„åœ¨æ ¡ç”Ÿ Linus Torvalds ç¼–å†™äº†ä¸€æ¬¾åä¸º Linux çš„æ“ä½œç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿå› å…¶è¾ƒé«˜çš„ä»£ç è´¨é‡ä¸”åŸºäº GNU GPL è®¸å¯åè®®çš„å¼€æ”¾æºä»£ç ç‰¹æ€§ï¼Œè¿…é€Ÿå¾—åˆ°äº† GNU è®¡åˆ’å’Œä¸€å¤§æ‰¹é»‘å®¢ç¨‹åºå‘˜çš„æ”¯æŒã€‚</p></blockquote><blockquote><p>éšå Linux ç³»ç»Ÿä¾¿è¿›å…¥äº†å¦‚ç«å¦‚è¼çš„å‘å±•é˜¶æ®µã€‚</p></blockquote><blockquote><p>1994 å¹´ 1 æœˆï¼ŒBob Young åœ¨ Linux ç³»ç»Ÿå†…æ ¸çš„åŸºç¡€ä¹‹ä¸Šï¼Œé›†æˆäº†ä¼—å¤šçš„æºä»£ç å’Œç¨‹åºè½¯ä»¶ï¼Œå‘å¸ƒäº†çº¢å¸½ç³»ç»Ÿå¹¶å¼€å§‹å‡ºå”®æŠ€æœ¯æœåŠ¡ï¼Œè¿™è¿›ä¸€æ­¥æ¨åŠ¨äº† Linux ç³»ç»Ÿçš„æ™®åŠã€‚</p></blockquote><blockquote><p>1998 å¹´ä»¥åï¼Œéšç€ GNU æºä»£ç å¼€æ”¾è®¡åˆ’å’Œ Linux ç³»ç»Ÿçš„ç»§ç»­ç«çƒ­ï¼Œä»¥ IBM å’Œ Intel ä¸ºé¦–çš„å¤šå®¶ IT ä¼ä¸šå·¨å¤´å¼€å§‹å¤§åŠ›æ¨åŠ¨å¼€æ”¾æºä»£ç è½¯ä»¶çš„å‘å±•ã€‚</p></blockquote><blockquote><p>åˆ°äº† 2017 å¹´å¹´åº•ï¼ŒLinux å†…æ ¸å·²ç»å‘å±•åˆ°äº† 4.13 ç‰ˆæœ¬ï¼Œå¹¶ä¸” Linux ç³»ç»Ÿç‰ˆæœ¬ä¹Ÿæœ‰æ•°ç™¾ä¸ªä¹‹å¤šï¼Œä½†å®ƒä»¬ä¾ç„¶éƒ½ä½¿ç”¨ Linus Torvalds å¼€å‘ã€ç»´æŠ¤çš„Linux ç³»ç»Ÿå†…æ ¸ã€‚RedHat å…¬å¸ä¹Ÿæˆä¸ºäº†å¼€æºè¡Œä¸šåŠ Linux ç³»ç»Ÿçš„å¸¦å¤´å…¬å¸ã€‚</p></blockquote><h2 id="å£°æ˜"><a href="#å£°æ˜" class="headerlink" title="å£°æ˜"></a>å£°æ˜</h2><p>è¿™ç¯‡åšæ–‡ <a href="http://blog.csdn.net/veryitman/article/details/7340668">makefile: gcc å·¥ä½œæµç¨‹</a> æ—©æœŸè¢«æˆ‘æ”¾åœ¨ CSDN ä¸Šé¢è¿‡.æ—¶éš”å¤šå¹´, ä»ä¸èƒ½å¿˜æ€€, ç°ä¹”è¿è‡³æ­¤.</p><p>æœ¬æ–‡æ¯”è¾ƒç®€å•, æ¯”è¾ƒé€‚åˆåˆå­¦è€….<br>æˆ‘åªæ˜¯è¯•å›¾ä»¥å®ä¾‹çš„æ–¹å¼ç»™å¤§å®¶è®²è§£ä¸€ä¸‹ GCC ç¼–è¯‘é“¾æ¥ Cè¯­è¨€ç¨‹åºçš„æµç¨‹, å¹¶æ²¡æœ‰é«˜æ·±çš„çŸ¥è¯†.</p><h2 id="ç¼–è¯‘æµç¨‹"><a href="#ç¼–è¯‘æµç¨‹" class="headerlink" title="ç¼–è¯‘æµç¨‹"></a>ç¼–è¯‘æµç¨‹</h2><p>C è¯­è¨€ç»è¿‡é¢„å¤„ç†ã€ç¼–è¯‘ã€è¿æ¥æœ€åç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶.</p><p>åœ¨ Linux çš„ GCC ä¸‹é¢ï¼Œçœ‹çœ‹å…¶å·¥ä½œæµç¨‹. æµç¨‹å›¾å¦‚ä¸‹ï¼š</p><p><img src="/upload/images/2017/10/03/1.jpg" alt="1"></p><p>é¢„å¤„ç†ï¼Œå°†åŒ…å«çš„ *.h æ–‡ä»¶æˆ–è€…ä¸€äº›é¢„å¤„ç†è¯­å¥ï¼ˆå¦‚ #defineï¼‰å¤„ç†ä¸€ä¸‹ï¼Œç„¶åå°† *.c æ–‡ä»¶ç”Ÿæˆ *.i çš„ä¸­é—´æ–‡ä»¶.</p><blockquote><p>æ³¨æ„äº† GCC ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆè¿™æ ·ä¸€ä¸ªæ–‡ä»¶ï¼Œå¦‚æœéœ€è¦ï¼Œè‡ªå·±åŠ  -E å‚æ•°å³å¯.</p></blockquote><p>ç¼–è¯‘ã€æ±‡ç¼–é˜¶æ®µç”Ÿæˆ *.o ç›®æ ‡æ–‡ä»¶ï¼Œæœ€åç»è¿‡é“¾æ¥ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶.</p><blockquote><p>æ³¨æ„ï¼šå¯æ‰§è¡Œæ–‡ä»¶ä¸ä¸€å®šæ˜¯ exe æ–‡ä»¶.</p></blockquote><h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><p>ä¸‹é¢ä»¥ä¸€ä¸ªå®ä¾‹ hello.cï¼Œè¯´æ˜è¿™ä¸ªè¿‡ç¨‹.</p><p><img src="/upload/images/2017/10/03/2.jpg" alt="1"></p><p>æºæ–‡ä»¶å¾ˆç®€å•ï¼Œè¿™é‡Œåªæ˜¯ä¸ºäº†è¯´æ˜é—®é¢˜.</p><p>åœ¨å‘½ä»¤è¡Œï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤å®Œæˆé¢„å¤„ç†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc  -E  hello.c  -o  hello.i</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä¹‹åï¼Œä½ å¯ä»¥æ‰“å¼€ hello.i æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°å¾ˆå¤š extern ä»¥åŠå°† MAX è§£é‡Šä¸º 20ï¼š<br><img src="/upload/images/2017/10/03/3.jpg" alt="1"></p><p>åœ¨å‘½ä»¤è¡Œï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤, å®Œæˆç¼–è¯‘é˜¶æ®µ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc  -S  hello.i  -o hello.s</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å¯ä»¥ç”Ÿæˆ *.s æ–‡ä»¶ï¼Œå…¶å®å°±æ˜¯ä¸€äº›æ±‡ç¼–è¯­å¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="/upload/images/2017/10/03/4.jpg" alt="1"></p><p>é‚£éº½ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›å…¥æ±‡ç¼–é˜¶æ®µäº†ï¼Œæ‰§è¡Œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc  -c  hello.s  -o hello.o</span><br></pre></td></tr></table></figure><p>æ‰“å¼€è¿™ä¸ª hello.o æ–‡ä»¶ï¼Œéƒ½æ˜¯ä¸€äº›æœºå™¨ç .</p><p>æœ€åä¸€ä¸ªè¿æ¥ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc hello.o -o hello</span><br></pre></td></tr></table></figure><p>åœ¨å½“å‰ç›®å½•å°±å¯ä»¥ç”Ÿæˆ hello è¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶.</p><p>æ‰§è¡Œ .&#x2F;helloï¼Œå°±ä¼šè¾“å‡ºï¼š<br><img src="/upload/images/2017/10/03/5.jpg" alt="1"></p><p>åˆ°æ­¤ï¼ŒGCC ç¼–è¯‘è¿æ¥ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶å®Œæ¯•ï¼</p><p>å½“å‰ç›®å½•ä¸‹é¢çš„æ–‡ä»¶ï¼š<br><img src="/upload/images/2017/10/03/6.jpg" alt="1"></p><p>ä»¥ä¸Šçš„æ­¥éª¤ï¼Œå…¶å®ä¸€å¥å‘½ä»¤å³å¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc  hello.c  -o  hello</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ç›®å½•å†…å®¹å¦‚ä¸‹ï¼š<br><img src="/upload/images/2017/10/03/7.jpg" alt="1"></p><p>è‡ªå·±åŠ¨æ‰‹æ„Ÿå—ä¸€ä¸‹ï¼Œä½ ä¼šæ”¶è·æ›´å¤šï¼</p><h2 id="GCC-ç³»åˆ—åšæ–‡"><a href="#GCC-ç³»åˆ—åšæ–‡" class="headerlink" title="GCC ç³»åˆ—åšæ–‡"></a>GCC ç³»åˆ—åšæ–‡</h2><p><a href="http://www.veryitman.com/2017/10/03/GCC-%E7%BC%96%E8%AF%91C%E8%AF%AD%E8%A8%80%E7%9A%84%E6%B5%81%E7%A8%8B/">GCC: ç¼–è¯‘ C è¯­è¨€çš„æµç¨‹</a></p><p><a href="http://www.veryitman.com/2017/10/07/GCC-Homebrew-%E5%AE%89%E8%A3%85-GCC-%E5%92%8C-Binutils/">GCC: Homebrew å®‰è£… GCC å’Œ Binutils</a></p><p><a href="http://www.veryitman.com/2017/10/07/GCC-%E5%85%B1%E4%BA%AB%E5%BA%93/">GCC: å…±äº«åº“</a></p><p><a href="http://www.veryitman.com/2017/10/08/GCC-%E9%9D%99%E6%80%81%E5%BA%93/">GCC: é™æ€åº“</a></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GCC C ç¼–è¯‘å™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS APNs: å¤„ç†æ•°æ®</title>
      <link href="/2017/08/07/iOS-APNs-%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/"/>
      <url>/2017/08/07/iOS-APNs-%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åšæ–‡: <a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E8%BF%9C%E7%A8%8B%E6%8E%A8%E9%80%81/">iOS ç»†è¯´æ¨é€: è¿œç¨‹æ¨é€</a> å’Œ <a href="http://www.veryitman.com/2017/08/07/iOS-APNs-%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/">iOS ç»†è¯´æ¨é€: æœ¬åœ°æ¨é€</a><br>åˆ†åˆ«ä»‹ç»äº† iOS çš„ä¸¤ç§å…¸å‹æ¨é€, iOS è¿˜æœ‰å¾ˆå¤šç±»å‹çš„æ¨é€, å¦‚é™é»˜æ¨é€, VOIP æ¨é€(iOS8)ç­‰, åé¢ä¼šæ…¢æ…¢ä»‹ç»ç»™å¤§å®¶.</p><p>ä»Šå¤©è·Ÿå¤§å®¶èŠèŠå…³äºå¦‚ä½•å¤„ç†æ¨é€çš„æ•°æ®(payload).</p><p>è¯¥ç³»åˆ—åšå®¢:</p><blockquote><p><a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E8%BF%9C%E7%A8%8B%E6%8E%A8%E9%80%81/">iOS APNs: è¿œç¨‹æ¨é€</a><br><a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E6%9C%AC%E5%9C%B0%E6%8E%A8%E9%80%81/">iOS APNs: æœ¬åœ°æ¨é€</a><br>iOS APNs: å¤„ç†æ•°æ®(æœ¬ç¯‡)<br><a href="http://www.veryitman.com/2018/02/06/iOS-APNs-%E9%9D%99%E9%BB%98%E6%8E%A8%E9%80%81/">iOS APNs: é™é»˜æ¨é€</a><br><a href="http://www.veryitman.com/2018/02/08/iOS-APNs-Background-Fetch/">iOS APNs: Background Fetch</a></p></blockquote><h2 id="æ¨é€çš„ä»£ç†å›è°ƒæ—¶æœº"><a href="#æ¨é€çš„ä»£ç†å›è°ƒæ—¶æœº" class="headerlink" title="æ¨é€çš„ä»£ç†å›è°ƒæ—¶æœº"></a>æ¨é€çš„ä»£ç†å›è°ƒæ—¶æœº</h2><p>è¿˜è®°å¾— AppDelegate é‡Œé¢å…³äºæ¨é€çš„å‡ ä¸ªä»£ç†æ–¹æ³•å§.<br>~ ä¼°è®¡ä½ ä¹Ÿå¿˜è®°äº†, æ²¡å…³ç³», æˆ‘ä»¬å†ä¸€èµ·æ•´ç†ä¸€ä¸‹.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo &#123;</span><br><span class="line">    </span><br><span class="line">    MZLOG(@&quot;markApp push. RemotePush userInfo: %@&quot;, userInfo);</span><br><span class="line">    </span><br><span class="line">    // å¯ä»¥æ ¹æ®æ¨é€å†…å®¹å†³å®šä¸‹ä¸€æ­¥çš„è¡Œä¸º</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•åœ¨æ¥æ”¶åˆ° RemotePush çš„æ—¶å€™, è°ƒç”¨æ—¶æœº:</p><p>1.APP åœ¨å‰å°è¿è¡Œçš„, RemotePush è¢«æ¨é€è¿‡æ¥äº†.<br>2.APP åœ¨åå°è¿è¡Œ, æ— è®ºæ˜¯å¦è¢«æŒ‚èµ·åªè¦æ²¡æœ‰è¢«æ€æ­», ç‚¹å‡»æ¨é€å†…å®¹.</p><p>ä»¥ä¸Šä¸¤ç§æƒ…å†µå‡å¯ä»¥è¿›å…¥ didReceiveRemoteNotification æ–¹æ³•.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- (void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification &#123;</span><br><span class="line">    </span><br><span class="line">    MZLOG(@&quot;App push. LocalPush notification: %@&quot;, notification);</span><br><span class="line">    </span><br><span class="line">    // å¯ä»¥æ ¹æ®æ¨é€å†…å®¹å†³å®šä¸‹ä¸€æ­¥çš„è¡Œä¸º</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•æ¥æ”¶åˆ° LocalPush çš„æ—¶å€™, è°ƒç”¨æ—¶æœº:</p><p>1.APP åœ¨å‰å°è¿è¡Œçš„, LocalPush è¢«æ¨é€è¿‡æ¥äº†.<br>2.APP åœ¨åå°è¿è¡Œ, æ— è®ºæ˜¯å¦è¢«æŒ‚èµ·åªè¦æ²¡æœ‰è¢«æ€æ­», ç‚¹å‡»æ¨é€å†…å®¹.</p><p>ä»¥ä¸Šä¸¤ç§æƒ…å†µå‡å¯ä»¥è¿›å…¥ didReceiveLocalNotification æ–¹æ³•.</p><p>è¿™ä¸¤ä¸ªå›è°ƒæ–¹æ³•, åˆ†åˆ«æ¥æ”¶ RemotePush å’Œ LocalPush çš„æ¨é€æ¶ˆæ¯.</p><p>æœ‰äº›äººä¼šé—®äº†, å‡å¦‚è¿™ä¸ªæ—¶å€™æˆ‘çš„åº”ç”¨åœ¨åå°, è¢«ç³»ç»Ÿæ€æ­»äº†æˆ–è€…è¢«ç”¨æˆ·åŒå‡» Home é”®æ€æ­»äº†, æ­¤æ—¶è¿œç¨‹æ¨é€è¿‡æ¥äº†, æˆ–è€…çŠ¶æ€æ é‡Œé¢æœ‰æœ¬åœ°æ¨é€çš„æ¶ˆæ¯, æˆ‘ç‚¹å‡»æ¨é€æ¶ˆæ¯, è¿™ä¸¤ä¸ªæ–¹æ³•ä¼šè¢«è°ƒç”¨å—?</p><p>ç±»ä¼¼è¿™ç§æ•ˆæœ, ä¸Šé¢æ˜¯ RemotePush, ä¸‹é¢æ˜¯ LocalPush.</p><p><img src="/upload/images/2017/08/07/1.jpg" alt="1"></p><p>æˆ‘è‚¯å®šçš„å‘Šè¯‰å¤§å®¶, åº”ç”¨è¢«æ€æ­»çš„æƒ…å†µä¸‹, ç‚¹å‡»æ¨é€å†…å®¹, didReceiveRemoteNotification å’Œ didReceiveLocalNotification éƒ½ä¸ä¼šè¢«è°ƒç”¨.</p><p>è¿™ä¸ªæ—¶å€™, AppDelegate ä¸­çš„å¦ä¸€ä¸ªæ–¹æ³•ä¸Šåœºäº†.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)application:(UIApplication *)application </span><br><span class="line">didFinishLaunchingWithOptions:(NSDictionary *)launchOptions</span><br></pre></td></tr></table></figure><p>çœ‹ä¸€ä¸‹ didFinishLaunchingWithOptions çš„å…·ä½“å®ç°, ç¤ºä¾‹ä»£ç å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123;</span><br><span class="line">    </span><br><span class="line">    /// å°†åº”ç”¨å›¾æ ‡çš„ badge æ¸…é›¶</span><br><span class="line">    &#123;</span><br><span class="line">        [[UIApplication sharedApplication] setApplicationIconBadgeNumber:1];</span><br><span class="line">        [[UIApplication sharedApplication] setApplicationIconBadgeNumber:0];</span><br><span class="line">        [[UIApplication sharedApplication] cancelAllLocalNotifications];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    if (nil != launchOptions) &#123;</span><br><span class="line">        /// å¤„ç† LocalPush</span><br><span class="line">        &#123;</span><br><span class="line">            // è¿™é‡Œå¯ä»¥å¾—åˆ° UILocalNotification å¯¹è±¡</span><br><span class="line">            id localPushNotify = [launchOptions objectForKey:UIApplicationLaunchOptionsLocalNotificationKey];</span><br><span class="line">            </span><br><span class="line">            MZLOG(@&quot;AppDelegate localPush: %@&quot;, localPushNotify);</span><br><span class="line">            </span><br><span class="line">            if (nil != localPushNotify) &#123;</span><br><span class="line">                if ([localPushNotify isKindOfClass:[UILocalNotification class]]) &#123;</span><br><span class="line">                    // è·å– userinfo æ•°æ®</span><br><span class="line">                    NSDictionary *userInfo = [(UILocalNotification *)localPushNotify userInfo];</span><br><span class="line">                    MZLOG(@&quot;AppDelegate localPush of UILocalNotification: %@&quot;, userInfo);</span><br><span class="line">                    </span><br><span class="line">                    // æ ¹æ® userInfo çš„å†…å®¹å¤„ç†å¦‚é¡µé¢è·³è½¬ç­‰</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        /// å¤„ç† RemotePush</span><br><span class="line">        &#123;</span><br><span class="line">            NSDictionary *remotePushNotify = [launchOptions objectForKey:UIApplicationLaunchOptionsRemoteNotificationKey];</span><br><span class="line">            MZLOG(@&quot;AppDelegate remotePush: %@&quot;, remotePushNotify);</span><br><span class="line">            </span><br><span class="line">            if (nil != remotePushNotify) &#123;</span><br><span class="line">                NSDictionary *remoteAps = [remotePushNotify objectForKey:@&quot;aps&quot;];</span><br><span class="line">                MZLOG(@&quot;AppDelegate remotePush. The aps&#x27; info, alert: %@, badge: %@, sound: %@&quot;,</span><br><span class="line">                      [remoteAps objectForKey:@&quot;alert&quot;],</span><br><span class="line">                      [remoteAps objectForKey:@&quot;badge&quot;], [remoteAps objectForKey:@&quot;sound&quot;]);</span><br><span class="line">// æ ¹æ®æ¨é€çš„å†…å®¹å¤„ç†å¦‚é¡µé¢è·³è½¬ç­‰</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    MZLOG(@&quot;AppDelegate. launchOptions: %@&quot;, launchOptions);</span><br><span class="line">    </span><br><span class="line">    return YES;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„æ‰“å°è¾“å‡ºå†…å®¹, å¦‚ä¸‹</p><p>æœ¬åœ°æ¨é€çš„å†…å®¹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> AppDelegate localPush of UILocalNotification: &#123;</span><br><span class="line">    &quot;user_info_key&quot; = &quot;user_info_value_json_str&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿œç¨‹æ¨é€çš„å†…å®¹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">aps = &#123;</span><br><span class="line">alert = &quot;Testing.. (2)&quot;;</span><br><span class="line">badge = 1;</span><br><span class="line">sound = default;</span><br><span class="line">      &#125;;</span><br><span class="line">            </span><br><span class="line">The aps&#x27; info, alert: Testing.. (19), badge: 1, sound: default</span><br></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰æ¨é€å†…å®¹"><a href="#è‡ªå®šä¹‰æ¨é€å†…å®¹" class="headerlink" title="è‡ªå®šä¹‰æ¨é€å†…å®¹"></a>è‡ªå®šä¹‰æ¨é€å†…å®¹</h2><blockquote><p>å¯¹äºæ¨é€çš„æ•°æ®æ ¼å¼, æ˜¯è‹¹æœè§„å®šçš„æ ¼å¼, æˆ‘ä»¬å¯ä»¥åœ¨å…¶åŸºç¡€ä¸Šæ·»åŠ æˆ‘ä»¬éœ€è¦çš„æ•°æ®.</p></blockquote><p>åœ¨ä»‹ç»ä¸‹é¢å†…å®¹ä¹‹å‰, å…ˆäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ payload.</p><blockquote><p>payload æ˜¯æ¨é€é€šçŸ¥çš„ä¸€éƒ¨åˆ†ï¼Œæ¯ä¸€æ¡æ¨é€é€šçŸ¥éƒ½åŒ…å«ä¸€ä¸ª Payload.<br>å®ƒåŒ…å«äº†ç³»ç»Ÿæé†’ç”¨æˆ·é€šçŸ¥åˆ°è¾¾çš„æ–¹å¼ï¼Œè¿˜å¯ä»¥æ·»åŠ è‡ªå®šä¹‰çš„æ•°æ®, å³é€šçŸ¥ä¸»è¦ä¼ é€’çš„æ•°æ®ä¸º payload.</p></blockquote><blockquote><p>Payload æœ¬èº«ä¸º JSON æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå®ƒå†…éƒ¨å¿…é¡»è¦åŒ…å«ä¸€ä¸ªé”®ä¸º aps çš„å­—å…¸.ä¹Ÿå°±æ˜¯è¯´ payload æ˜¯æ•´ä¸ªå­—ç¬¦ä¸².</p></blockquote><p>å…³äº payload çš„é™åˆ¶</p><p>åœ¨æ—©æœŸçš„æ¨é€ä¸­, payload ä¸èƒ½è¶…è¿‡ 256bytes, ä¸­é—´è¿˜ç»å†è¿‡æ¨é€çš„ payload æœ€å¤§ä¸º 2KB.<br>ç°åœ¨è‹¹æœæ”¯æŒæœ€å¤§ä¸º5KB(VOIP æ¨é€), å®˜æ–¹æ–‡æ¡£æœ‰è¯´, å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">For regular remote notifications, the maximum size is 4KB (4096 bytes)</span><br><span class="line">For Voice over Internet Protocol (VoIP) notifications, the maximum size is 5KB (5120 bytes)</span><br><span class="line">NOTE</span><br><span class="line">If you are using the legacy APNs binary interface to send notifications instead of an HTTP/2 request, the maximum payload size is 2KB (2048 bytes)</span><br></pre></td></tr></table></figure><p>ä¸Šé¢æ˜¯ <a href="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CreatingtheNotificationPayload.html#//apple_ref/doc/uid/TP40008194-CH10-SW1">å®˜æ–¹æ–‡æ¡£</a> çš„åŸæ–‡, å¤§æ¦‚æ„æ€æ˜¯:</p><blockquote><p>ç°åœ¨ APNs æ”¯æŒ payload ä¸º 4KB, å¦‚æœæ˜¯ VoIP æ¨é€çš„è¯, æ”¯æŒ 5KB. ä½†æ˜¯, å¦‚æœä½ ä½¿ç”¨ä¼ ç»Ÿçš„ APNs è€Œä¸æ˜¯ä½¿ç”¨ HTTP&#x2F;2 çš„è¯, æœ€å¤§æ”¯æŒ 2KB. ä¹Ÿå°±æ˜¯è¯´, æ¨é€çš„ payload å¤§å°å’Œ iOS ç³»ç»Ÿæ— å…³, è€Œæ˜¯å’Œåè®®æœ‰å…³.</p></blockquote><p>å¯ä»¥ä½¿ç”¨ä¸‹é¢ä»£ç , æŸ¥çœ‹ payload é•¿åº¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload.getBytes().length</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ­£å¸¸çš„æ¨é€å†…å®¹æ˜¯è¿™æ ·çš„, æ­£å¸¸æ ¼å¼:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;aps&quot;:&#123;&quot;alert&quot;:&quot;Testing.. (21)&quot;,&quot;badge&quot;:1,&quot;sound&quot;:&quot;default&quot;&#125;&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæƒ³å¯¹æ¨é€å†…å®¹åšè‡ªå®šä¹‰, å¯ä»¥è‡ªå·±æ·»åŠ é¢å¤–çš„æ•°æ®, å¦‚:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;aps&quot;:&#123;&quot;alert&quot;:&quot;Testing.. (21)&quot;,&quot;badge&quot;:1,&quot;sound&quot;:&quot;default&quot;&#125;, &quot;ext&quot;:&#123;&quot;key&quot;:&quot;value&quot;&#125;&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­, ext å°±æ˜¯é¢å¤–æ·»åŠ çš„æ•°æ®æ¨¡å‹.</p><p>åœ¨ APP æ”¶åˆ°è¿™æ ·çš„æ•°æ®æ¨¡å‹æ—¶, å¯ä»¥å¯¹åº”ä¸åŒçš„è¡Œä¸º.</p><p>å¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡éœ€æ±‚, è‡ªè¡Œå®šä¹‰æ•°æ®æ ¼å¼.</p><p>è‡ªå®šä¹‰çš„æ•°æ®æ ¼å¼, æ³¨æ„å†…å®¹çš„é•¿åº¦, åœ¨ä¸åŒçš„ iOS ç³»ç»Ÿä¸Šé¢, å¯¹äºæ¨é€çš„å†…å®¹æ˜¯æœ‰é•¿åº¦é™åˆ¶çš„.</p><h2 id="å†å” å¨å‡ å¥"><a href="#å†å” å¨å‡ å¥" class="headerlink" title="å†å” å¨å‡ å¥"></a>å†å” å¨å‡ å¥</h2><p>å…³äº iOS7 ä»¥åæ·»åŠ çš„æ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (void)application:(UIApplication *)application </span><br><span class="line">didReceiveRemoteNotification:(NSDictionary *)userInfo </span><br><span class="line">fetchCompletionHandler:(void (^)(UIBackgroundFetchResult))completionHandler</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ–¹æ³•ä¹Ÿæ˜¯åœ¨ AppDelegate ä¸­å®ç°çš„.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (void)application:(UIApplication *)application </span><br><span class="line">didReceiveRemoteNotification:(NSDictionary *)userInfo</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ–¹æ³•åœ¨ iOS3 å°±å·²ç»æœ‰äº†, å¯è°“æ˜¯å†å²æ‚ ä¹….æˆ‘å§‘ä¸”ç§°ä¹‹ä¸ºè¯¥æ–¹æ³•ä¸º FatherMethod, ä¸Šé¢é‚£ä¸ªæ–°åŠ å…¥çš„ç§°ä¹‹ä¸º SonMethod.</p><p><strong>æ³¨æ„äº‹é¡¹:</strong></p><p>[1]. å®ç°äº† FatherMethod, å³ä½¿ä½ å®ç°äº† SonMethod, SonMethod ä¹Ÿä¸ä¼šè¢«è°ƒç”¨.<br>[2]. SonMethod æ¯” FatherMethod å¤šäº†ä¸€ä¸ªå‚æ•° completionHandler, è¿™ä¸ªåœ¨åé¢ä¼šè¯´åˆ°.ä¸»è¦ç”¨äº Background Mode ä¸­çš„ Background Fetch.<br>[3]. æ¨é€è¢«è°ƒç”¨çš„æ—¶æœº, é™¤äº† FatherMethod çš„æ—¶æœºå¤–, è¿˜å¤šäº†ä¸€ç§æ—¶æœº, å°±æ˜¯åœ¨ APP è¢«æ€æ­»å, ç‚¹å‡»æ¨é€å†…å®¹æ‰“å¼€ APP, æ­¤æ—¶ APP å†æ¬¡å›åˆ°å‰å°çš„æ—¶å€™, è¯¥æ–¹æ³•ä¹Ÿä¼šè¢«è°ƒç”¨(didFinishLaunchingWithOptionsä¹Ÿä¼šè°ƒç”¨), æ‰€ä»¥åœ¨å¤„ç†è¿œç¨‹æ¨é€å†…å®¹çš„æ—¶å€™, è¦æ³¨æ„è¿™ä¸€ç‚¹.</p><p>é’ˆå¯¹æ³¨æ„äº‹é¡¹[3], ç›®å‰æˆ‘èƒ½ç»™å‡ºçš„æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆ:</p><p>ç¬¬ä¸€, åˆ¤æ–­æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡å¯åŠ¨ APP, å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡å¯åŠ¨ APP, ç»Ÿä¸€åœ¨didFinishLaunchingWithOptions ä¸­å¤„ç†, ä¸åœ¨ SonMethod ä¸­å¤„ç†.</p><p>ç¬¬äºŒ, è¿œç¨‹æ¨é€ç»Ÿä¸€åœ¨ SonMethod ä¸­å¤„ç†, didFinishLaunchingWithOptions ä¸­åªå¤„ç†åœ¨ APP è¢«æ€æ­»çš„æƒ…å†µä¸‹, ç”¨æˆ·ç‚¹å‡»æ¨é€æœ¬åœ°çš„å†…å®¹.</p><p>æˆ‘ä¸ªäººé‡‡ç”¨çš„æ˜¯ç¬¬äºŒä¸­æ–¹æ¡ˆ.</p><h2 id="æ„Ÿè°¢"><a href="#æ„Ÿè°¢" class="headerlink" title="æ„Ÿè°¢"></a>æ„Ÿè°¢</h2><p>åœ¨æ¨é€å·¥å…· NWPusher å’Œ Xcode çš„ Window&#x2F;Devices&#x2F;Console å¸®åŠ©ä¸‹, æ‰å¾—ä»¥å®Œå–„åšæ–‡.</p><p>NWPusher ç”¨æ¥å‘é€æ¨é€å†…å®¹.</p><p>Window&#x2F;Devices&#x2F;Console ç”¨äºæŸ¥çœ‹è¾“å‡ºæ—¥å¿—.</p><h2 id="å¿…çœ‹æ–‡æ¡£"><a href="#å¿…çœ‹æ–‡æ¡£" class="headerlink" title="å¿…çœ‹æ–‡æ¡£"></a>å¿…çœ‹æ–‡æ¡£</h2><p><a href="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CreatingtheNotificationPayload.html#//apple_ref/doc/uid/TP40008194-CH10-SW1">Creating the Remote Notification Payload</a></p><p><a href="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/PayloadKeyReference.html#//apple_ref/doc/uid/TP40008194-CH17-SW1">Payload Key Reference</a></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> APNs æ¨é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS APNs: æœ¬åœ°æ¨é€</title>
      <link href="/2017/08/06/iOS-APNs-%E6%9C%AC%E5%9C%B0%E6%8E%A8%E9%80%81/"/>
      <url>/2017/08/06/iOS-APNs-%E6%9C%AC%E5%9C%B0%E6%8E%A8%E9%80%81/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚æ‹¬"><a href="#æ¦‚æ‹¬" class="headerlink" title="æ¦‚æ‹¬"></a>æ¦‚æ‹¬</h2><p><code>iOS APNs: è¿œç¨‹æ¨é€</code> è¯´è¿‡è¿œç¨‹æ¨é€(RemotePush).</p><p>ä»Šå¤©è¯´è¯´æœ¬åœ°æ¨é€, æœ¬åœ°æ¨é€ä¹Ÿå°±æ˜¯å¹³æ—¶æ‰€è¯´çš„ LocalPush.</p><p>è¯¥ç³»åˆ—åšå®¢:</p><blockquote><ul><li><a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E8%BF%9C%E7%A8%8B%E6%8E%A8%E9%80%81/">iOS APNs: è¿œç¨‹æ¨é€</a></li></ul></blockquote><ul><li>iOS APNs: æœ¬åœ°æ¨é€(æœ¬ç¯‡)</li><li><a href="http://www.veryitman.com/2017/08/07/iOS-APNs-%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/">iOS APNs: å¤„ç†æ•°æ®</a></li><li><a href="http://www.veryitman.com/2018/02/06/iOS-APNs-%E9%9D%99%E9%BB%98%E6%8E%A8%E9%80%81/">iOS APNs: é™é»˜æ¨é€</a></li><li><a href="http://www.veryitman.com/2018/02/08/iOS-APNs-Background-Fetch/">iOS APNs: Background Fetch</a></li></ul><h2 id="ä¸šåŠ¡åœºæ™¯"><a href="#ä¸šåŠ¡åœºæ™¯" class="headerlink" title="ä¸šåŠ¡åœºæ™¯"></a>ä¸šåŠ¡åœºæ™¯</h2><p>åœ¨å…·ä½“å®ç°ä¹‹å‰, å…ˆè¯´ä¸€ä¸‹ä¸šåŠ¡åœºæ™¯.</p><p>å‡å¦‚ä½ çš„ APP å…·æœ‰ IM(å³æ—¶é€šè®¯) åŠŸèƒ½, è¿™ä¸ªæ—¶å€™, ä½ å¯ä»¥æ ¹æ®è¿æ¥æ¥åˆ¤æ–­ç”¨æˆ·æ˜¯å¦åœ¨çº¿, å¦‚æœä¸åœ¨çº¿, å¯ä»¥ä½¿ç”¨è¿œç¨‹æ¨é€å°†æ¨é€å†…å®¹å‘ŠçŸ¥ç”¨æˆ·.å¦‚æœåœ¨çº¿, å¯ä»¥é€šè¿‡ IM æŠŠå†…å®¹å‘Šè¯‰ APP, APP æ”¶åˆ°è¿™ä¸ªæ¶ˆæ¯å, å¯ä»¥ä½¿ç”¨æœ¬åœ°æ¨é€å‘ŠçŸ¥ç»™ç”¨æˆ·.</p><p>æ®è¯´ APNs æ¯å¤©è¦å¤„ç†çš„æ¨é€åœ¨äº¿çº§åˆ«, æ‰€ä»¥å¦‚æœå¯ä»¥ä½¿ç”¨ LocalPush å®Œæˆçš„ä¸šåŠ¡, æˆ‘å»ºè®®å¤§å®¶è¿˜æ˜¯ä¸è¦ä½¿ç”¨è¿œç¨‹æ¨é€, å†µä¸”è‹¹æœå¹¶ä¸ä¸€å®šä¿è¯è¿œç¨‹æ¨é€ä¸€å®šæˆåŠŸ, å¦‚æœç½‘ç»œæˆ–è€… APNs å‹åŠ›å¤§, æ¨é€ä¹Ÿä¼šå»¶æ—¶.</p><p>ç»™è‹¹æœå‡å°‘ç‚¹å‹åŠ›å§, å“ˆå“ˆ!</p><p>å†è¯´ä¸€ä¸ªä¸šåŠ¡åœºæ™¯, ä½ çš„ APP åœ¨åå°è¿è¡Œæ—¶é—´å¿«åˆ°è¦è¢«ç³»ç»ŸæŒ‚èµ·çš„æ—¶å€™äº†, ä½ å¯ä»¥å‘é€ä¸€ä¸ª LocalPush æ¥æç¤ºç”¨æˆ·æˆ–è€…åˆºæ¿€ç”¨æˆ·, å†æ¬¡å°† APP æ‹‰å›å‰å°è¿è¡Œ. è¿™æ ·å¯ä»¥ä¿è¯ APP å¯ä»¥æ­£å¸¸è¿è¡Œäº†.</p><p>ä¸Šé¢è¯´çš„ç¬¬äºŒä¸ªä¸šåŠ¡åœºæ™¯, æ˜¯ä»Šå¤©ä¾‹å­çš„åŸºç¡€, ä½ ä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…ä¸šåŠ¡åœºæ™¯æ¥ä½¿ç”¨ LocalPush åŠŸèƒ½.</p><h2 id="LocalPush-ç®€ä»‹"><a href="#LocalPush-ç®€ä»‹" class="headerlink" title="LocalPush ç®€ä»‹"></a>LocalPush ç®€ä»‹</h2><p>LocalPush å…è®¸ APP å‘ç”¨æˆ·å‘é€é€šçŸ¥, å¯¹äºç”¨æˆ·æ¥è¯´, å°±è·Ÿè¿œç¨‹æ¨é€æ˜¯ä¸€æ ·çš„, åŸºæœ¬æ²¡æœ‰æ„ŸçŸ¥, å¼€å‘è€…ä¹Ÿä¸å¸Œæœ›ç”¨æˆ·æœ‰æ„ŸçŸ¥.</p><p>æ¨é€æ•ˆæœå›¾:</p><p><img src="/upload/images/2017/08/06/1.png" alt="1"></p><blockquote><p>æ³¨æ„: å¦‚æœä½ çš„ APP åœ¨å‰å°, å‘é€ LocalPush æ˜¯ä¸ä¼šè¦ä¸Šè¿°æ•ˆæœçš„.<br>å¦‚æœåœ¨å‰å°, å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„å¼¹æ¡†æ¥æç¤ºç”¨æˆ·.</p></blockquote><p>LocalPush åŒæ ·éœ€è¦ç”¨æˆ·æˆæƒæ¨é€çš„æƒé™, å¦åˆ™ä¹Ÿæ— æ³•å‘é€æˆåŠŸ.è¿™ä¸ªè·Ÿè¿œç¨‹æ¨é€æ˜¯ä¸€æ ·çš„.</p><p>å¦å¤–, LocalPush éœ€è¦ APP åœ¨åå°æ²¡æœ‰è¢«æŒ‚èµ·çš„æƒ…å†µä¸‹, æ‰èƒ½å‘é€, å¦åˆ™æ— æ³•å¯ç”¨.</p><p>å‘é€ LocalPush çš„ä¸€ä¸ªå¥½å¤„æ˜¯ä¸éœ€è¦ç”¨æˆ·è¿æ¥ç½‘ç»œ, è¿™ä¸ªæ˜¯åŒºåˆ«äºè¿œç¨‹æ¨é€çš„, å› ä¸ºè¿œç¨‹æ¨é€å¿…é¡»è¦æ±‚ç”¨æˆ·è¿æ¥ç½‘ç»œçš„.å¾ˆå¤šå•æœºæ¸¸æˆæˆ–è€…å¼±è”ç½‘çš„æ¸¸æˆ, å‘é€çš„æ¨é€éƒ½æ˜¯ LocalPush, è€Œéè¿œç¨‹æ¨é€.</p><p>åœ¨é˜…è¯»ä¸‹é¢å†…å®¹ä¹‹å‰, å»ºè®®å¤§å®¶å…ˆçœ‹çœ‹ iOS åå°æ¨¡å¼ è¿™ç¯‡æ–‡ç« .æœ¬ç¯‡ä¹Ÿæ˜¯åŸºäºè¿™ä¸ªä¸ºåŸºç¡€çš„.</p><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><p>è¿™ä¸ªç¤ºä¾‹, å®ç°çš„åœºæ™¯å¦‚ä¸‹:</p><p>ç”¨æˆ·æ‰“å¼€ APP, æˆæƒäº†æ¨é€çš„æƒé™, ç”¨æˆ·è¯•ç©ä¸€ä¼šä¹‹å, å°† APP é€€åˆ°äº†åå°, APP ç›‘å¬é€€åˆ°åå°ä¹‹å, å»¶æ—¶ä¸€å®šæ—¶é—´å‘é€ LocalPush ç»™ç”¨æˆ·.</p><p>AppDelegate.m ä¸­ä½¿ç”¨åå°æ¨¡å¼</p><p>å…³äº MZBackgroundTask çš„å®ç°, é™„å½•ç»™å‡º.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- (void)applicationDidEnterBackground:(UIApplication *)application &#123;</span><br><span class="line">    </span><br><span class="line">    [[MZBackgroundTask sharedTask] startTask];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ViewController.m</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    </span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    [[NSNotificationCenter defaultCenter] addObserver:self</span><br><span class="line">                                             selector:@selector(onDidEnterBackground:)</span><br><span class="line">                                                 name:UIApplicationDidEnterBackgroundNotification</span><br><span class="line">                                               object:nil];</span><br><span class="line">&#125;</span><br><span class="line">- (void)onDidEnterBackground:(NSNotification *)notification &#123;</span><br><span class="line">    </span><br><span class="line">    MZLOG(@&quot;App Background. Enter onDidEnterBackground.&quot;);</span><br><span class="line">    </span><br><span class="line">    // ç­‰å¾… 6s å, è¿™ä¸ªæ—¶é—´å¯ä»¥æ ¹æ®å…·ä½“æƒ…å†µå»ä¿®æ”¹, è¿™é‡Œåªæ˜¯æ¨¡æ‹Ÿ</span><br><span class="line">    int delta = 6;</span><br><span class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(delta * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        </span><br><span class="line">        MZLOG(@&quot;App Background. Enter onDidEnterBackground diapatch.&quot;);</span><br><span class="line">        </span><br><span class="line">        if (UIApplicationStateBackground == [UIApplication sharedApplication].applicationState) &#123;</span><br><span class="line">            UILocalNotification *notification = [UILocalNotification new];</span><br><span class="line">            notification.alertBody = @&quot;èµ°, å»highå§!&quot;;</span><br><span class="line">            notification.soundName = UILocalNotificationDefaultSoundName;</span><br><span class="line">            // åº”ç”¨å›¾æ ‡ä¸Šé¢æ˜¾ç¤ºçš„æ•°å­—</span><br><span class="line">            notification.applicationIconBadgeNumber = notification.applicationIconBadgeNumber + 1;</span><br><span class="line">            // å¯ä»¥è‡ªå®šä¹‰æ•°æ®</span><br><span class="line">            notification.userInfo = @&#123;@&quot;user_info_key&quot;: @&quot;user_info_value_json_str&quot;&#125;;</span><br><span class="line">            </span><br><span class="line">            [[UIApplication sharedApplication] scheduleLocalNotification:notification];</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">        // æ˜¾ç¤ºè‡ªå®šä¹‰å¼¹æ¡†ç­‰</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°† APP ç‚¹å‡» Home é”®é€€åˆ°åå°, 6s åå¯ä»¥çœ‹åˆ°æ¨é€çš„æ•ˆæœ.</p><p>ç‚¹å‡»æ¨é€çš„æç¤ºæ¡†, å†æ¬¡æ‰“å¼€äº† APP, ä¼šæ‰§è¡Œ AppDelegate ä¸­çš„æ–¹æ³•, å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- (void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification &#123;</span><br><span class="line">    </span><br><span class="line">    MZLOG(@&quot;App push. notification: %@&quot;, notification);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰“å°å‡ºæ¥çš„ notification, å¦‚ä¸‹å›¾æ‰€ç¤º:</p><p><img src="/upload/images/2017/08/06/2.jpg" alt="1"></p><p>å…¶ä¸­, user_info æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„æ•°æ®éƒ¨åˆ†.</p><p>é™„å½•</p><blockquote><p>MZBackgroundTask å®ç°</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;MZBackgroundTask.h&quot;</span><br><span class="line"></span><br><span class="line">@implementation MZBackgroundTask</span><br><span class="line"></span><br><span class="line">+ (instancetype)sharedTask &#123;</span><br><span class="line">    </span><br><span class="line">    static MZBackgroundTask *_task;</span><br><span class="line">    static dispatch_once_t onceToken;</span><br><span class="line">    dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line">        _task = [[self alloc] init];</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    return _task;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)startTask &#123;</span><br><span class="line">    </span><br><span class="line">    if (![self _checkSupportBackgroundTask]) &#123;</span><br><span class="line">        MZLOG(@&quot;BackgroundTask. Current device don&#x27;t support backgroundTask.&quot;);</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    UIApplication *application = [UIApplication sharedApplication];</span><br><span class="line">    </span><br><span class="line">    __block UIBackgroundTaskIdentifier taskId;</span><br><span class="line">    </span><br><span class="line">    /// ç”³è¯·åå°æ‰§è¡Œ</span><br><span class="line">    /// æ³¨æ„: åœ¨iOS7å’Œè¯¥ç‰ˆæœ¬å‰ï¼Œåå°å¯ä»¥ç”¨ä¸‹é¢çš„çš„æ–¹å¼åœ¨åå°å­˜æ´»5-10åˆ†é’Ÿï¼Œåœ¨iOS8åŠåï¼Œæœ€å¤šå­˜æ´»3åˆ†é’Ÿ</span><br><span class="line">    &#123;</span><br><span class="line">        taskId = [application beginBackgroundTaskWithName:NSStringFromClass([self class]) expirationHandler:^&#123;</span><br><span class="line">            </span><br><span class="line">            MZLOG(@&quot;BackgroundTask. BackgroundTask is Over. The remained time: %f&quot;, application.backgroundTimeRemaining);</span><br><span class="line">            </span><br><span class="line">            [application endBackgroundTask:taskId];</span><br><span class="line">            </span><br><span class="line">            taskId = UIBackgroundTaskInvalid;</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    if (UIBackgroundTaskInvalid == taskId) &#123;</span><br><span class="line">        </span><br><span class="line">        MZLOG(@&quot;BackgroundTask. Apply backgroundTask failed.&quot;);</span><br><span class="line">        </span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    /// å¯ä»¥ç›‘æ§åå°ä»»åŠ¡å‰©ä½™çš„æ—¶é—´, é’ˆå¯¹ä¸šåŠ¡å¯ä»¥å»å¤„ç†</span><br><span class="line">    &#123;</span><br><span class="line">        dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</span><br><span class="line">            </span><br><span class="line">            while (true) &#123;</span><br><span class="line">                // å‰©ä½™å¯ä»¥åå°æ‰§è¡Œçš„æ—¶é—´</span><br><span class="line">                NSTimeInterval remainedTime = application.backgroundTimeRemaining;</span><br><span class="line">                MZLOG(@&quot;BackgroundTask. The remained time: %f&quot;, remainedTime);</span><br><span class="line">                </span><br><span class="line">                if (remainedTime &lt; 2) &#123;</span><br><span class="line">                    // å¯ä»¥å‘Šè¯‰å…¶ä»–ä¸šåŠ¡, åå°ä»»åŠ¡å³å°†ç»“æŸäº†</span><br><span class="line">                    break;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                // ç¡çœ (å»¶æ—¶)1s</span><br><span class="line">                [NSThread sleepForTimeInterval:1.f];</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            /// è¿™é‡Œå¯ä»¥åšä¸€äº›æ¸…é™¤å·¥ä½œ</span><br><span class="line">            &#123;</span><br><span class="line">                // clean up</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            [application endBackgroundTask:taskId];</span><br><span class="line">            </span><br><span class="line">            taskId = UIBackgroundTaskInvalid;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - Private.</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  å½“å‰è®¾å¤‡æ˜¯å¦æ”¯æŒåå°ä»»åŠ¡.</span><br><span class="line"> *</span><br><span class="line"> *  @return YES, æ”¯æŒåå°ä»»åŠ¡. å¦åˆ™, ä¸æ”¯æŒåå°ä»»åŠ¡.</span><br><span class="line"> */</span><br><span class="line">- (BOOL)_checkSupportBackgroundTask &#123;</span><br><span class="line">    </span><br><span class="line">    SEL sel = @selector(isMultitaskingSupported);</span><br><span class="line">    BOOL supportBTask = [[UIDevice currentDevice] respondsToSelector:sel];</span><br><span class="line">    </span><br><span class="line">    return supportBTask;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> APNs è¿œç¨‹æ¨é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS APNs: è¿œç¨‹æ¨é€</title>
      <link href="/2017/08/06/iOS-APNs-%E8%BF%9C%E7%A8%8B%E6%8E%A8%E9%80%81/"/>
      <url>/2017/08/06/iOS-APNs-%E8%BF%9C%E7%A8%8B%E6%8E%A8%E9%80%81/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h2><p>æœ¬ç¯‡åšæ–‡, ä½ é¦–å…ˆéœ€è¦çŸ¥é“çš„å†…å®¹:</p><blockquote><p>1.äº†è§£è¿‡ Push.<br>2.é˜…è¯»è¿‡ [iOS åå°æ¨¡å¼] è¿™ç¯‡æ–‡ç« .<br>3.ç”³è¯·è¿‡è‹¹æœè¯ä¹¦æˆ–è€…çŸ¥é“å¦‚ä½•ç”³è¯·å’Œåˆ¶ä½œè¯ä¹¦.<br>4.iOS å¼€å‘åŸºæœ¬çŸ¥è¯†.</p></blockquote><p>ä½ åœ¨è¿™ç¯‡åšæ–‡å°†ä¼šå­¦åˆ°:</p><blockquote><p>1.Push çš„å‘å±•å†ç¨‹.<br>2.å¼€æºæ¨é€å·¥å…· NWPusher çš„ä½¿ç”¨.<br>3.Push çš„åŸºæœ¬åŸç†.</p></blockquote><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>APNs, è‹¹æœæ¨é€é€šçŸ¥æœåŠ¡. å…¨ç§°æ˜¯: Apple Push Notification Service.</p><p>æ¨é€æŒ‡çš„æ˜¯ç”± APNs æœåŠ¡å™¨ã€ProviderServiceã€iOS ç³»ç»Ÿã€App æ„æˆçš„é€šè®¯ç³»ç»Ÿï¼Œä¹Ÿæ˜¯ç§»åŠ¨äº’è”ç½‘ä¸ä¼ ç»Ÿçš„ Web æœ€æ˜æ˜¾ä¸åŒçš„.</p><p>å®˜æ–¹æœ‰æ¯”è¾ƒè¯¦ç»†çš„æ–‡æ¡£ä»‹ç», å¯ä»¥æˆ³è¿™é‡Œ <a href="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/APNSOverview.html#//apple_ref/doc/uid/TP40008194-CH8-SW1">å®˜æ–¹æ–‡æ¡£</a> æŸ¥çœ‹.</p><p>è‹¹æœçš„æ–‡æ¡£å†™çš„ç¡®å®å¥½, ä½†æ˜¯ä½œä¸ºç¨‹åºå‘˜, æœ€é‡è¦çš„è¿˜æ˜¯è¦ç»“åˆç†è®ºå»å®è·µ.</p><p>æœ¬ç¯‡ç»“åˆè‡ªå·±çš„å®è·µå’Œå¯¹æ¨é€çš„ç†è§£, è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹æ¨é€ç›¸å…³çš„çŸ¥è¯†.</p><h2 id="Push-å‘å±•å†ç¨‹"><a href="#Push-å‘å±•å†ç¨‹" class="headerlink" title="Push å‘å±•å†ç¨‹"></a>Push å‘å±•å†ç¨‹</h2><p>iOS å†ç»å¾ˆå¤šç‰ˆæœ¬, ä¸€ç›´åœ¨ä¼˜åŒ–æˆ–è€…è¯´æ˜¯è¿›åŒ–æ¨é€ç›¸å…³çš„å†…å®¹, æ— è®ºæ˜¯ä»å®ç”¨æ€§å’ŒæŠ€æœ¯ä¸Šæ¥çœ‹, æ¨é€æ˜¯è‡³å…³é‡è¦çš„.</p><p>çœ‹ä¸€ä¸‹ push å‘å±•å†ç¨‹</p><ul><li><p>iOS 3 - å¼•å…¥æ¨é€é€šçŸ¥ UIApplication çš„ registerForRemoteNotificationTypes ä¸ UIApplicationDelegate çš„ application(:didRegisterForRemoteNotificationsWithDeviceToken:)ï¼Œapplication(:didReceiveRemoteNotification:)</p></li><li><p>iOS 4 - å¼•å…¥æœ¬åœ°é€šçŸ¥ scheduleLocalNotificationï¼ŒpresentLocalNotificationNow:ï¼Œ application(_:didReceive:)</p></li><li><p>iOS 5 - åŠ å…¥é€šçŸ¥ä¸­å¿ƒé¡µé¢</p></li><li><p>iOS 6 - é€šçŸ¥ä¸­å¿ƒé¡µé¢ä¸ iCloud åŒæ­¥</p></li><li><p>iOS 7 - åå°é™é»˜æ¨é€ application(_:didReceiveRemoteNotification:fetchCompletionHandle:)</p></li><li><p>iOS 8 - é‡æ–°è®¾è®¡ notification æƒé™è¯·æ±‚ï¼ŒActionable é€šçŸ¥ registerUserNotificationSettings(:)ï¼ŒUIUserNotificationAction ä¸ UIUserNotificationCategoryï¼Œapplication(:handleActionWithIdentifier:forRemoteNotification:completionHandler:) ç­‰</p></li><li><p>iOS 9 - Text Input actionï¼ŒåŸºäº HTTP&#x2F;2 çš„æ¨é€è¯·æ±‚ UIUserNotificationActionBehaviorï¼Œå…¨æ–°çš„ Provider API ç­‰</p></li><li><p>iOS 10- æ”¯æŒImages, GIFs, Audio and Videoç±»å‹, å¹¶ä¸”æœ‰ Notification Service Extension ä¸ Notification Content Extensionï¼Œå¯ä»¥å®ç°æ¨é€æ•°æ®åœ¨å±•ç¤ºå‰è¿›è¡Œä¸‹è½½æ›´æ–°ã€å®šåˆ¶é€šçŸ¥ UI, å¹¶ä¸”ç»Ÿä¸€äº†é€šçŸ¥ç±»å‹ï¼Œå…·æœ‰æ—¶é—´é—´éš”é€šçŸ¥ã€åœ°ç†ä½ç½®é€šçŸ¥å’Œæ—¥å†é€šçŸ¥.</p></li></ul><p>è¯¥ç³»åˆ—åšå®¢å…±åˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ†:</p><ul><li>iOS APNs: è¿œç¨‹æ¨é€(æœ¬ç¯‡)</li><li><a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E6%9C%AC%E5%9C%B0%E6%8E%A8%E9%80%81/">iOS APNs: æœ¬åœ°æ¨é€</a></li><li><a href="http://www.veryitman.com/2017/08/07/iOS-APNs-%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/">iOS APNs: å¤„ç†æ•°æ®</a></li><li><a href="http://www.veryitman.com/2018/02/06/iOS-APNs-%E9%9D%99%E9%BB%98%E6%8E%A8%E9%80%81/">iOS APNs: é™é»˜æ¨é€</a></li><li><a href="http://www.veryitman.com/2018/02/08/iOS-APNs-Background-Fetch/">iOS APNs: Background Fetch</a></li></ul><p>å¦‚æœéœ€è¦å®Œæ•´æºç çš„, å¯ä»¥é€šè¿‡é‚®ä»¶è”ç³»æˆ‘(<a href="mailto:&#118;&#x65;&#x72;&#105;&#x74;&#109;&#97;&#x6e;&#x40;&#x31;&#50;&#54;&#46;&#x63;&#111;&#x6d;">&#118;&#x65;&#x72;&#105;&#x74;&#109;&#97;&#x6e;&#x40;&#x31;&#50;&#54;&#46;&#x63;&#111;&#x6d;</a>), åç»­å®Œæˆåä¼šä¸Šä¼ åˆ° github.</p><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>å…ˆçœ‹å®˜æ–¹çš„æµç¨‹å›¾, å¦‚ä¸‹æ‰€ç¤º:</p><p><img src="/upload/images/2017/08/05/1.jpg" alt="1"></p><p>è¯¥æµç¨‹å›¾, ä¸»è¦è¯´æ˜çš„æ˜¯è‡ªå·± ä¸šåŠ¡æœåŠ¡å™¨(Provider) æ¨é€æ¶ˆæ¯åˆ°ç”¨æˆ·(Client APP) çš„æµç¨‹.</p><p>æ³¨æ„: è¿™é‡Œè¯´çš„ä»¥åŠæœ¬æ–‡åé¢è¯´çš„ ä¸šåŠ¡æœåŠ¡å™¨, ç»Ÿä¸€æŒ‡çš„æ˜¯å¯ä»¥å‘ APNs å‘é€æ¨é€æ¶ˆæ¯çš„æœåŠ¡å™¨.</p><p>ä¸‹é¢è¿™å¼ å›¾æ˜¯æ¯”è¾ƒå®Œæ•´çš„ä¸€å¼ æµç¨‹å›¾, è‡ªå·±ç”»çš„, å‡‘åˆçœ‹å§!</p><p><img src="/upload/images/2017/08/05/2.jpg" alt="1"></p><p>å¤§æ¦‚æµç¨‹, æˆ‘è¯¦ç»†è¯´ä¸€ä¸‹.</p><p>1.iOS è®¾å¤‡å¯åŠ¨åè¿æ¥ç½‘ç»œ, ä¼šä¸è‹¹æœæœåŠ¡å™¨å»ºç«‹ä¸€ä¸ªå®‰å…¨çš„é•¿è¿æ¥.<br>è¿™ä¸ªæ˜¯ç³»ç»Ÿç»´æŠ¤çš„, è¿™ä¹Ÿæ˜¯æ¨é€çš„å…³é”®.<br>2.ç”¨æˆ·æ‰“å¼€ app, æˆæƒäº†æ¨é€é€šçŸ¥çš„æƒé™.<br>3.æˆæƒæˆåŠŸå, APNs ä¼šå°† deviceToken è¿”å›ç»™ iOS ç»ˆç«¯.<br>4.ç»ˆç«¯å°†è¯¥ deviceToken è¿”å›ç»™æŒ‡å®šçš„ APP.<br>5.APP æ‹¿åˆ° deviceToken ä¸Šä¼ ç»™æˆ‘ä»¬è‡ªå·±çš„ä¸šåŠ¡æœåŠ¡å™¨.<br>6.ä¸šåŠ¡æœåŠ¡å™¨å‘ APNs å‘é€æ¨é€è¯·æ±‚, å¸¦ä¸Š deviceToken.<br>7.APNs æ¨é€å†…å®¹åˆ°æŒ‡å®šçš„ iOS ç»ˆç«¯.<br>8.iOS ç»ˆç«¯å°†å†…å®¹æ¨é€ç»™ç”¨æˆ·.</p><p>å…³äº deviceToken åé¢ä¼šè®².</p><h2 id="å…³äº-deviceToken"><a href="#å…³äº-deviceToken" class="headerlink" title="å…³äº deviceToken"></a>å…³äº deviceToken</h2><p>è¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹ deviceToken.</p><blockquote><p>deviceToken æ˜¯ NSData ç±»å‹çš„æ•°æ®, æ˜¯è‹¹æœæœåŠ¡å™¨æ ¹æ® è®¾å¤‡,è¯ä¹¦ç­‰ä¿¡æ¯å’Œä¸€å®šç®—æ³•ç”Ÿæˆçš„.<br>éœ€è¦å°†è¿™ä¸ª deviceToken ä¼ é€ç»™æˆ‘ä»¬çš„æœåŠ¡å™¨ç«¯, è¿™æ ·ä¸€ä¸ªç”¨æˆ·å¯¹è±¡å°±ç»‘å®šäº†ä¸€ä¸ª deviceToken.<br>å½“éœ€è¦ç»™ç”¨æˆ·æ¨é€æ¶ˆæ¯, é€šè¿‡è‡ªå·±çš„ä¸šåŠ¡æœåŠ¡å™¨, æ‰¾ç”¨æˆ·å¯¹åº”çš„ deviceToken å’Œè¦å‘é€çš„æ¨é€å†…å®¹, å‘é€åˆ°è‹¹æœçš„ APNs, ç„¶å APNs å°†æ¶ˆæ¯æ¨é€åˆ°è¯¥ deviceToken å¯¹åº”çš„æ‰‹æœºä¸Š.</p></blockquote><p>å…³äº deviceToken æ˜¯å¦å¯å˜çš„é—®é¢˜</p><p>ç½‘ä¸Šæœ‰äº›äººè¯´, deviceToken æ˜¯å¯å˜çš„, æœ‰äº›äººè¯´, deviceToken æ˜¯ä¸å¯å˜çš„, æˆ‘ä¹Ÿä¸çŸ¥é“ä»–ä»¬åˆ°åº•æœ‰æ²¡æœ‰å®è·µè¿‡, ä»Šå¤©æˆ‘è¦å‘Šè¯‰å¤§å®¶çš„æ˜¯, deviceToken æ˜¯å¯å˜çš„.</p><p>å¦‚å¸è½½é‡è£… app, deviceToken ä¼šå˜. æˆ‘çš„è®¾å¤‡ iphone6, iOS10.3.</p><p>ä¸‹é¢æ˜¯æˆ‘å®éªŒçš„æ•°æ®:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ç¬¬ä¸€æ¬¡å®‰è£…è¿è¡Œå¾—åˆ°çš„ deviceToken</span><br><span class="line"></span><br><span class="line">&lt;4e0f2928 5be0700c=&quot;&quot; 296bf7f1=&quot;&quot; 3b0837e4=&quot;&quot; bc9da6d1=&quot;&quot; 9fdb672e=&quot;&quot; f87446be=&quot;&quot; 1c098431=&quot;&quot;&gt;</span><br><span class="line">å¸è½½å, ç¬¬ä¸€æ¬¡å®‰è£…è¿è¡Œå¾—åˆ°çš„ deviceToken</span><br></pre></td></tr></table></figure><p>è¿™è¯´æ˜, deviceToken æ˜¯å¯å˜çš„.</p><h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>ä¸Šé¢åŸºæœ¬éƒ½æ˜¯ä¸€äº›ç†è®ºçŸ¥è¯†, ä¸‹é¢ç»“åˆä»£ç , å…·ä½“å®ç°.</p><h3 id="å·¥ç¨‹é…ç½®"><a href="#å·¥ç¨‹é…ç½®" class="headerlink" title="å·¥ç¨‹é…ç½®"></a>å·¥ç¨‹é…ç½®</h3><p>åœ¨å†™ä»£ç ä¹‹å‰, éœ€è¦é…ç½®ä¸€ä¸‹å·¥ç¨‹.å…³äºå¦‚ä½•åˆ›å»ºå¸¦æœ‰ push åŠŸèƒ½çš„è‹¹æœè¯ä¹¦çš„æ“ä½œ, å¤§å®¶è‡ªè¡Œå»ç½‘ä¸Šå­¦ä¹ , è¿™é‡Œä¸èµ˜è¿°.</p><p>ä¸è¿‡è¿™é‡Œè¦æé†’ä¸€ç‚¹, åˆ›å»ºçš„è¯ä¹¦ä¸€å®šè¦å’Œè‡ªå·±é¡¹ç›®çš„ appid ä¿æŒä¸€è‡´, å¦åˆ™æ— æ³•æ¨é€.</p><p>è¿™ä¸ª Demo å·¥ç¨‹çš„åå­—æ˜¯ MZPush.</p><p>å®‰è£…å¥½è¯ä¹¦, æ‰“å¼€å·¥ç¨‹, å¹¶èƒ½è®©å·¥ç¨‹è¯†åˆ«åˆ°.</p><p>åˆ‡æ¢åˆ° Target, ç‚¹å‡» Capabilities é€‰é¡¹.</p><p>æ­¥éª¤1: é…ç½® Push, æ‰“å¼€å¼€å…³å³å¯.</p><p><img src="/upload/images/2017/08/05/3.jpg" alt="1"></p><p>é…ç½®åå°æ¨¡å¼, æ‰“å¼€å¼€å…³, é€‰ä¸­Remote notifications.</p><p><img src="/upload/images/2017/08/05/4.jpg" alt="1"></p><p>ä¸è¿‡è¿™ä¸€æ­¥, ä¸æ˜¯å¿…é¡»çš„, å¦‚æœä½ ä¸é…ç½®, å·¥ç¨‹ä¼šæœ‰è­¦å‘Š.æˆ‘å»ºè®®æ˜¯é€‰ä¸Š, åœ¨åé¢çš„åšæ–‡ä¸­, å†ä»”ç»†è¯´è¯´è¿™ä¸ªä¸œè¥¿çš„å¥½å¤„.</p><p>è­¦å‘Šä¿¡æ¯å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">You&#x27;ve implemented -[&lt;UIApplicationDelegate&gt; application:didReceiveRemoteNotification:fetchCompletionHandler:], </span><br><span class="line">but you still need to add &quot;remote-notification&quot; to the list of your supported UIBackgroundModes in your Info.plist.</span><br></pre></td></tr></table></figure><p>æ­¥éª¤2: é…ç½®å®Œè¿™ä¸€æ­¥å,åœ¨ Info.plist ä¸­å¯ä»¥çœ‹åˆ°å¤šäº†ä¸€é¡¹å†…å®¹:</p><p><img src="/upload/images/2017/08/05/5.jpg" alt="1"></p><p>æ­¥éª¤3: é…ç½®å·¥ç¨‹æœ€å°å…¼å®¹ç‰ˆæœ¬</p><p><img src="/upload/images/2017/08/05/6.jpg" alt="1"></p><p>å› ä¸ºæˆ‘è¦å…¼å®¹ iOS7, æ‰€ä»¥åœ¨ Xcode8 ä¸­, è‡ªå·±æ‰‹åŠ¨æ”¹ä¸ºäº† 7.0.</p><p>æ­¥éª¤4: å…³é—­ Bitcode(å¯é€‰æ“ä½œ)</p><p><img src="/upload/images/2017/08/05/7.jpg" alt="1"></p><p>æ­¥éª¤5: é…ç½®æ”¯æŒ HTTP(å¯é€‰æ“ä½œ)</p><p>åœ¨ Info.plist ä¸­, æ·»åŠ å¦‚ä¸‹:</p><p><img src="/upload/images/2017/08/05/8.jpg" alt="1"></p><h3 id="ç”¨æˆ·æˆæƒ"><a href="#ç”¨æˆ·æˆæƒ" class="headerlink" title="ç”¨æˆ·æˆæƒ"></a>ç”¨æˆ·æˆæƒ</h3><p>è¯¢é—®ç”¨æˆ·æˆæƒçš„å®ç°</p><p>è¯¥å®ç°å…¼å®¹äº† iOS7.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">+ (void)applyPushPermission &#123;</span><br><span class="line">    </span><br><span class="line">    UIApplication *application = [UIApplication sharedApplication];</span><br><span class="line">    </span><br><span class="line">    if (MZSysVersion &lt;= 7.0) &#123;</span><br><span class="line">        UIRemoteNotificationType nType = UIRemoteNotificationTypeAlert|UIRemoteNotificationTypeBadge|UIRemoteNotificationTypeSound;</span><br><span class="line">        [application registerForRemoteNotificationTypes:nType];</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        UIUserNotificationType nType =  UIUserNotificationTypeBadge|UIUserNotificationTypeSound|UIUserNotificationTypeAlert;</span><br><span class="line">        UIUserNotificationSettings *nSettings = [UIUserNotificationSettings settingsForTypes:nType categories:nil];</span><br><span class="line">        [application registerUserNotificationSettings:nSettings];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³äºç”¨æˆ·æˆæƒ, åˆ†å‡ ç§æƒ…å†µæ¥çœ‹å¾….</p><p>æƒ…æ™¯ä¸€. ç”¨æˆ·ä¸å…è®¸ APP æ¨é€, å³ä¸æˆæƒ.</p><p>Appdelegate ä»£ç†è°ƒç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- (void)application:(UIApplication *)application didRegisterUserNotificationSettings:(UIUserNotificationSettings *)notificationSettings &#123;</span><br><span class="line">    </span><br><span class="line">    MZLOG(@&quot;App push. notificationSettings: %@&quot;, notificationSettings);</span><br><span class="line">    </span><br><span class="line">    [application registerForRemoteNotifications];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (void)application:(UIApplication *)application didFailToRegisterForRemoteNotificationsWithError:(NSError *)error</span><br></pre></td></tr></table></figure><p>error ä¿¡æ¯å¤§æ¦‚å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Error Domain=NSCocoaErrorDomain Code=3000 &quot;æœªæ‰¾åˆ°åº”ç”¨ç¨‹åºçš„â€œaps-environmentâ€çš„æˆæƒå­—ç¬¦ä¸²&quot;</span><br><span class="line">UserInfo=&#123;NSLocalizedDescription=æœªæ‰¾åˆ°åº”ç”¨ç¨‹åºçš„â€œaps-environmentâ€çš„æˆæƒå­—ç¬¦ä¸²&#125;</span><br></pre></td></tr></table></figure><p>æƒ…æ™¯äºŒ. ç”¨æˆ·å…è®¸æˆæƒäº†, åˆåˆ†ä¸ºä¸¤ç§æƒ…å†µ</p><p>1.ä½¿ç”¨å…·æœ‰ push åŠŸèƒ½çš„è¯ä¹¦</p><p>ä¸€å®šè¦æœ‰å¸¦æœ‰ push åŠŸèƒ½çš„è¯ä¹¦.</p><p>ä»£ç†è°ƒç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- (void)application:(UIApplication *)application didRegisterUserNotificationSettings:(UIUserNotificationSettings *)notificationSettings &#123;</span><br><span class="line">    </span><br><span class="line">    MZLOG(@&quot;App push. notificationSettings: %@&quot;, notificationSettings);</span><br><span class="line">    </span><br><span class="line">    [application registerForRemoteNotifications];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ–¹æ³•å¤§æ¦‚åœ¨ä¸Šé¢å›è°ƒ 1s åæ‰ä¼šè°ƒç”¨.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken &#123;</span><br><span class="line">    </span><br><span class="line">    MZLOG(@&quot;App push. deviceToken: %@&quot;, deviceToken);</span><br><span class="line">    </span><br><span class="line">    // æ ¼å¼åŒ–è¯¥æ•°æ®</span><br><span class="line">    NSString *deviceTokenStr = [NSString stringWithFormat:@&quot;%@&quot;, deviceToken];</span><br><span class="line">    deviceTokenStr = [deviceTokenStr stringByReplacingOccurrencesOfString:@&quot;&lt;&quot; withString:@&quot;&quot;];</span><br><span class="line">    deviceTokenStr = [deviceTokenStr stringByReplacingOccurrencesOfString:@&quot;&gt;&quot; withString:@&quot;&quot;];</span><br><span class="line">    deviceTokenStr = [deviceTokenStr stringByReplacingOccurrencesOfString:@&quot; &quot; withString:@&quot;&quot;];</span><br><span class="line">    MZLOG(@&quot;App push. deviceToken string: %@&quot;, deviceTokenStr);</span><br><span class="line">    </span><br><span class="line">    // å¯ä»¥ä¸Šä¼ è¯¥ token åˆ°è‡ªå·±çš„ä¸šåŠ¡æœåŠ¡å™¨</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ didRegisterForRemoteNotificationsWithDeviceToken æ–¹æ³•ä¸­å¯ä»¥å¾—åˆ° deviceToken ä¿¡æ¯:</p><p><img src="/upload/images/2017/08/05/9.jpg" alt="1"></p><p>æ³¨æ„: ä»£ç ä¸­å°† NSData çš„ deviceToken è½¬æ¢ä¸ºäº† NSString ç±»å‹çš„æ•°æ®ç±»å‹.</p><p>2.ä½¿ç”¨ä¸€èˆ¬çš„è¯ä¹¦, æ²¡æœ‰ push åŠŸèƒ½çš„è¯ä¹¦</p><p>è¿™ç§æƒ…å†µå’Œ <code>æƒ…æ™¯ä¸€</code> ä¸€æ ·.</p><h3 id="æ¨é€"><a href="#æ¨é€" class="headerlink" title="æ¨é€"></a>æ¨é€</h3><p>ä¸‡äº‹ä¿±å¤‡, åªæ¬ ä¸œé£äº†.</p><p>ä»Šå¤©æ²¡æœ‰å‡†å¤‡æ­å»ºä¸€ä¸ªè‡ªå·±çš„ä¸šåŠ¡æœåŠ¡å™¨å»æ¨é€, å¯ä»¥ä½¿ç”¨æ¨é€å·¥å…·æ¥æ›¿ä»£.</p><p>å®‰è£… <a href="https://github.com/noodlewerk/NWPusher">NWPusher</a> è¿™ä¸ªå·¥å…·, å¯ä»¥è¿›è¡Œæ¨é€æµ‹è¯•.</p><p>å®‰è£…æˆåŠŸå, æ‰“å¼€è¿™ä¸ª Mac APP, å¡«å†™ç›¸å…³ä¿¡æ¯.</p><p>ç‚¹å‡» push å³å¯æ¨é€.</p><p><img src="/upload/images/2017/08/05/10.jpg" alt="1"></p><p>åœ¨ Appdelegate ä¸­çš„ä»£ç†å›è°ƒä¸­, å¯ä»¥æ‰“å°æ¨é€å†…å®¹.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo &#123;</span><br><span class="line">    </span><br><span class="line">    MZLOG(@&quot;App push. userInfo: %@&quot;, userInfo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¨é€çš„å†…å®¹, å¦‚ä¸‹å›¾æ‰€ç¤º.</p><p><img src="/upload/images/2017/08/05/11.jpg" alt="1"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    aps =     &#123;</span><br><span class="line">        alert = &quot;Testing.. (6)&quot;;</span><br><span class="line">        badge = 1;</span><br><span class="line">        sound = default;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><p>1.<a href="https://onevcat.com/2016/08/notification/">æ´»ä¹…è§çš„é‡æ„ - iOS 10 UserNotifications æ¡†æ¶è§£æ</a></p><p>2.<a href="http://www.jianshu.com/p/ace1b422bad4">å›½å†… 90%ä»¥ä¸Šçš„ iOS å¼€å‘è€…ï¼Œå¯¹ APNs çš„è®¤è¯†éƒ½æ˜¯é”™çš„</a></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¨é€ APNs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS åå°æ¨¡å¼</title>
      <link href="/2017/07/30/iOS-%E5%90%8E%E5%8F%B0%E6%A8%A1%E5%BC%8F/"/>
      <url>/2017/07/30/iOS-%E5%90%8E%E5%8F%B0%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="åº”ç”¨çŠ¶æ€"><a href="#åº”ç”¨çŠ¶æ€" class="headerlink" title="åº”ç”¨çŠ¶æ€"></a>åº”ç”¨çŠ¶æ€</h2><p>æ¥è‡ªè‹¹æœå¼€å‘è€…æ–‡æ¡£ The App Life Cycle çš„å›¾.</p><p><img src="/upload/images/2017/07/30/Background1.jpg" alt="1"></p><p>ä¸‹é¢è¿™å¼ å›¾è¯´æ˜äº†åº”ç”¨ç¨‹åºçš„çŠ¶æ€, å¦‚ä¸‹æ‰€ç¤º:</p><p><img src="/upload/images/2017/07/30/Background2.jpg" alt="1"></p><p>å…·ä½“çš„è¯´ä¸€ä¸‹è¿™5ä¸­çŠ¶æ€:</p><p>1.Not running</p><blockquote><p>æœªè¿è¡Œ, ç¨‹åºæ²¡å¯åŠ¨æˆ–è€…è¢«ç³»ç»Ÿè¢«ç”¨æˆ·æ€æ­»</p></blockquote><p>2.Inactive</p><blockquote><p>æœªæ¿€æ´», ç¨‹åºåœ¨å‰å°è¿è¡Œï¼Œä¸è¿‡æ²¡æœ‰æ¥æ”¶åˆ°äº‹ä»¶.<br>åœ¨æ²¡æœ‰äº‹ä»¶å¤„ç†æƒ…å†µä¸‹ç¨‹åºé€šå¸¸åœç•™åœ¨è¿™ä¸ªçŠ¶æ€.</p></blockquote><p>3.Active</p><blockquote><p>æ¿€æ´», ç¨‹åºåœ¨å‰å°è¿è¡Œè€Œä¸”æ¥æ”¶åˆ°äº†äº‹ä»¶.<br>è¿™ä¹Ÿæ˜¯å‰å°çš„ä¸€ä¸ªæ­£å¸¸çš„æ¨¡å¼</p></blockquote><p>4.Backgroud</p><blockquote><p>åå°, ç¨‹åºåœ¨åå°è€Œä¸”èƒ½æ‰§è¡Œä»£ç ï¼Œå¤§å¤šæ•°ç¨‹åºè¿›å…¥è¿™ä¸ªçŠ¶æ€åä¼šåœ¨åœ¨è¿™ä¸ªçŠ¶æ€ä¸Šåœç•™ä¸€ä¼š.<br>æ—¶é—´åˆ°ä¹‹åä¼šè¿›å…¥æŒ‚èµ·çŠ¶æ€(Suspended). æœ‰çš„ç¨‹åºç»è¿‡ç‰¹æ®Šçš„è¯·æ±‚åå¯ä»¥é•¿æœŸå¤„äº Backgroud çŠ¶æ€.</p></blockquote><p>5.Suspended</p><blockquote><p>æŒ‚èµ·, ç¨‹åºåœ¨åå°ä¸èƒ½æ‰§è¡Œä»£ç .<br>ç³»ç»Ÿä¼šè‡ªåŠ¨æŠŠç¨‹åºå˜æˆè¿™ä¸ªçŠ¶æ€è€Œä¸”ä¸ä¼šå‘å‡ºé€šçŸ¥.<br>å½“æŒ‚èµ·æ—¶, ç¨‹åºè¿˜æ˜¯åœç•™åœ¨å†…å­˜ä¸­çš„, å½“ç³»ç»Ÿå†…å­˜ä½æ—¶, ç³»ç»Ÿå°±æŠŠæŒ‚èµ·çš„ç¨‹åºæ¸…é™¤æ‰, ä¸ºå‰å°ç¨‹åºæä¾›æ›´å¤šçš„å†…å­˜.</p></blockquote><p>å…³äº Backgroud çŠ¶æ€, æ˜¯æˆ‘ä»¬ä»Šå¤©è¦è¯´çš„é‡ç‚¹éƒ¨åˆ†.</p><h2 id="å¤šä»»åŠ¡ä»‹ç»"><a href="#å¤šä»»åŠ¡ä»‹ç»" class="headerlink" title="å¤šä»»åŠ¡ä»‹ç»"></a>å¤šä»»åŠ¡ä»‹ç»</h2><p>iOS çš„å¤šä»»åŠ¡æ˜¯åœ¨ iOS4 çš„æ—¶å€™è¢«å¼•å…¥çš„ï¼Œåœ¨æ­¤ä¹‹å‰ iOS çš„ APP éƒ½æ˜¯æŒ‰ä¸‹ Home é”®å°±è¢«å¹²æ‰äº†.<br>iOS4 è™½ç„¶å¼•å…¥äº†åå°å’Œå¤šä»»åŠ¡ï¼Œä½†æ˜¯å®é™…ä¸Šæ˜¯ä¼ªå¤šä»»åŠ¡ï¼Œä¸€èˆ¬çš„ APP åå°å¹¶ä¸èƒ½æ‰§è¡Œè‡ªå·±çš„ä»£ç ï¼Œåªæœ‰å°‘æ•°å‡ ç±»æœåŠ¡åœ¨é€šè¿‡æ³¨å†Œåå¯ä»¥çœŸæ­£åœ¨åå°è¿è¡Œï¼Œå¹¶ä¸”åœ¨æäº¤åˆ° AppStore çš„æ—¶å€™ä¹Ÿä¼šè¢«ä¸¥æ ¼å®¡æ ¸æ˜¯å¦æœ‰è¶Šæƒè¡Œä¸ºï¼Œè¿™ç§é™åˆ¶ä¸»è¦æ˜¯å‡ºäºå¯¹äºè®¾å¤‡çš„ç»­èˆªå’Œå®‰å…¨ä¸¤æ–¹é¢è¿›è¡Œçš„è€ƒè™‘.ä¹‹åç»è¿‡iOS5 å’Œ iOS6 çš„é€æ¸å‘å±•ï¼Œåå°èƒ½è¿è¡Œçš„æœåŠ¡çš„ç§ç±»è™½ç„¶å‡ºç°äº†å¢åŠ ï¼Œä½†æ˜¯ iOS åå°çš„æœ¬è´¨å¹¶æ²¡æœ‰å˜åŒ–.<br>åœ¨iOS7ä¹‹å‰ï¼Œç³»ç»Ÿæ‰€æ¥å—çš„åº”ç”¨å¤šä»»åŠ¡å¯ä»¥å¤§è‡´åˆ†ä¸ºå‡ ç§ï¼š</p><ul><li>åå°å®ŒæˆæŸäº›èŠ±è´¹æ—¶é—´çš„ç‰¹å®šä»»åŠ¡.</li><li>åå°æ’­æ”¾éŸ³ä¹ç­‰.</li><li>ä½ç½®æœåŠ¡.</li><li>IPç”µè¯(VOIP).</li><li>Newsstand.</li></ul><p>iOS7 åå°ä»»åŠ¡ç”³è¯·çš„æœ€é•¿æ—¶é—´ 10åˆ†é’Ÿ.<br>iOS8+ åå°ä»»åŠ¡ç”³è¯·æœ€é•¿æ—¶é—´ 3åˆ†é’Ÿ.</p><h2 id="ç¤ºä¾‹-APP-é€€åˆ°åå°ä¼šè¢«æŒ‚èµ·"><a href="#ç¤ºä¾‹-APP-é€€åˆ°åå°ä¼šè¢«æŒ‚èµ·" class="headerlink" title="ç¤ºä¾‹: APP é€€åˆ°åå°ä¼šè¢«æŒ‚èµ·"></a>ç¤ºä¾‹: APP é€€åˆ°åå°ä¼šè¢«æŒ‚èµ·</h2><p>ä»Šå¤©è·Ÿå¤§å®¶åˆ†äº«çš„æ˜¯ä¸€èˆ¬åº”ç”¨å¦‚ä½•åœ¨åå°å»¶é•¿ç”Ÿå‘½å‘¨æœŸçš„çŸ¥è¯†, å…³äºå…¶ä»–ç‰¹æ®Šçš„ App å¦‚ä¸Šé¢æåˆ°çš„5ä¸­æƒ…å†µ, ä¸æ˜¯ä»Šå¤©è®¨è®ºçš„é‡ç‚¹.</p><p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªä¾‹å­, ä¾‹å­å¾ˆç®€å•.</p><blockquote><p>è¿™é‡Œè¦è¯´æ˜ä¸€ä¸‹æ¦‚å¿µ, ç›´æ¥é”å±å’Œç‚¹å‡» Home é”®, éƒ½ä¼šå¯¼è‡´åº”ç”¨å¤„äºåå°æ¨¡å¼, è¿™é‡Œä¸ºäº†è¯´æ˜é—®é¢˜, ç»Ÿä¸€ç‚¹<br>å‡» Home ä½œä¸ºä»£åè¯.</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    </span><br><span class="line">    [super viewDidLoad];    </span><br><span class="line">    </span><br><span class="line">    [[NSNotificationCenter defaultCenter] addObserver:self</span><br><span class="line">                                             selector:@selector(onDidEnterBackground:)</span><br><span class="line">                                                 name:UIApplicationDidEnterBackgroundNotification</span><br><span class="line">                                               object:nil];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)onDidEnterBackground:(NSNotification *)notification &#123;</span><br><span class="line">    </span><br><span class="line">    MZLOG(@&quot;App Background. Enter onDidEnterBackground.&quot;);</span><br><span class="line">    </span><br><span class="line">    int delta = 1;</span><br><span class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(delta * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        </span><br><span class="line">        MZLOG(@&quot;App Background. Enter onDidEnterBackground diapatch.&quot;);</span><br><span class="line">        </span><br><span class="line">        UILocalNotification *notification = [UILocalNotification new];</span><br><span class="line">        notification.fireDate = [NSDate dateWithTimeIntervalSinceNow:3];</span><br><span class="line">        notification.alertBody = @&quot;èµ°, å»highå§!&quot;;</span><br><span class="line">        notification.soundName = UILocalNotificationDefaultSoundName;</span><br><span class="line">        // å¯ä»¥è‡ªå®šä¹‰æ•°æ®</span><br><span class="line">        notification.userInfo = @&#123;@&quot;user_info_key&quot;: @&quot;user_info_value_json_str&quot;&#125;;</span><br><span class="line">        </span><br><span class="line">        [[UIApplication sharedApplication] scheduleLocalNotification:notification];</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>UIApplicationDidEnterBackgroundNotification</code> å¯ä»¥ç›‘å¬åˆ°ç”¨æˆ·å°† APP é€€åˆ°åå°.</p><p>å½“ APP é€€åˆ°åå°, ä¼šè°ƒç”¨ onDidEnterBackground è¿™ä¸ªæ–¹æ³•.</p><p>åœ¨ onDidEnterBackground è¿™ä¸ªæ–¹æ³•ä¸­, æˆ‘æ•…æ„å»¶æ—¶æ‰§è¡Œä»£ç , è¿™é‡Œä½¿ç”¨çš„æ˜¯ dispatch_after.</p><p>ç¼–è¯‘è¿è¡Œè¿™ä¸ªå·¥ç¨‹, è¿è¡ŒæˆåŠŸå, å¯ä»¥ç‚¹å‡» Home é”®å°†åº”ç”¨é€€åˆ°åå°.</p><p>å¯ä»¥åœ¨ Xcode çš„æ§åˆ¶å°çœ‹åˆ° App Background. Enter onDidEnterBackground. çš„æ‰“å°ä¿¡æ¯, ä½†æ˜¯è¿Ÿè¿Ÿä¸è§ dispatch_after é‡Œé¢çš„ä»£ç æ‰§è¡Œ.</p><p>è¿™é‡Œè¯´æ˜, APP é€€åˆ°åå°åè¢«ç³»ç»ŸæŒ‚èµ·äº†.</p><p>å¦å¤–ä¸€ä¸ªä¾‹å­å°±æ˜¯ä½¿ç”¨ NSTimer, åœ¨ APP é€€åˆ°åå°å, ä¹Ÿä¼šè¢«ç»ˆæ­¢.</p><p>å®Œæ•´ä¾‹å­, ä¸€ä¼šåœ¨æ–‡ç« åå°é™„å½•ç»™å‡º.</p><h2 id="é€šè¿‡åå°æ¨¡å¼å»¶é•¿-APP-è¿è¡Œ"><a href="#é€šè¿‡åå°æ¨¡å¼å»¶é•¿-APP-è¿è¡Œ" class="headerlink" title="é€šè¿‡åå°æ¨¡å¼å»¶é•¿ APP è¿è¡Œ"></a>é€šè¿‡åå°æ¨¡å¼å»¶é•¿ APP è¿è¡Œ</h2><p>ä¸Šé¢çš„ä¾‹å­å……åˆ†è¯´æ˜äº†, åœ¨æˆ‘ä»¬æ²¡æœ‰åšä»»ä½•å¤„ç†çš„æƒ…å†µä¸‹, iOS ç³»ç»Ÿåœ¨ APP é€€åˆ°åå°çš„æƒ…å†µä¸‹, ä¼šè¢«ç³»ç»ŸæŒ‚èµ·, ä»è€Œç»ˆæ­¢ APP çš„ä»£ç è¡Œä¸º.</p><p>ä¸‹é¢é€šè¿‡å®ä¾‹, æ¥å¼€å¯åå°ä»»åŠ¡, è®© APP å°½å¯èƒ½çš„å»¶é•¿å£°æ˜å‘¨æœŸ.</p><p>åœ¨å·¥ç¨‹çš„åŸºç¡€ä¸Š, æ–°å»ºä¸€ä¸ªæ–‡ä»¶ <code>MZBackgroundTask</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@interface MZBackgroundTask : NSObject</span><br><span class="line">+ (instancetype)sharedTask;</span><br><span class="line">- (void)startTask;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>å…·ä½“å®ç°, åªç»™å‡ºå…³é”®ä»£ç .</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">- (void)startTask &#123;</span><br><span class="line">    </span><br><span class="line">    if (![self _checkSupportBackgroundTask]) &#123;</span><br><span class="line">        </span><br><span class="line">        MZLOG(@&quot;BackgroundTask. Current device don&#x27;t support backgroundTask.&quot;);</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    UIApplication *application = [UIApplication sharedApplication];</span><br><span class="line">    </span><br><span class="line">    __block UIBackgroundTaskIdentifier taskId;</span><br><span class="line">    </span><br><span class="line">    /// ç”³è¯·åå°æ‰§è¡Œ</span><br><span class="line">    /// æ³¨æ„: åœ¨iOS7å’Œè¯¥ç‰ˆæœ¬å‰ï¼Œåå°å¯ä»¥ç”¨ä¸‹é¢çš„çš„æ–¹å¼åœ¨åå°å­˜æ´»5-10åˆ†é’Ÿï¼Œåœ¨iOS8åŠåï¼Œæœ€å¤šå­˜æ´»3åˆ†é’Ÿ</span><br><span class="line">    &#123;</span><br><span class="line">        taskId = [application beginBackgroundTaskWithName:NSStringFromClass([self class]) expirationHandler:^&#123;</span><br><span class="line">            </span><br><span class="line">            MZLOG(@&quot;BackgroundTask. BackgroundTask is Over. The remained time: %f&quot;, application.backgroundTimeRemaining);</span><br><span class="line">            </span><br><span class="line">            [application endBackgroundTask:taskId];</span><br><span class="line">            </span><br><span class="line">            taskId = UIBackgroundTaskInvalid;</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    if (UIBackgroundTaskInvalid == taskId) &#123;</span><br><span class="line">        </span><br><span class="line">        MZLOG(@&quot;BackgroundTask. Apply backgroundTask failed.&quot;);</span><br><span class="line">        </span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    /// å¯ä»¥ç›‘æ§åå°ä»»åŠ¡å‰©ä½™çš„æ—¶é—´, é’ˆå¯¹ä¸šåŠ¡å¯ä»¥å»å¤„ç†</span><br><span class="line">    &#123;</span><br><span class="line">        dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</span><br><span class="line">            </span><br><span class="line">            __block NSTimeInterval remainedTime;</span><br><span class="line">            </span><br><span class="line">            while (true) &#123;</span><br><span class="line">                </span><br><span class="line">                // å‰©ä½™å¯ä»¥åå°æ‰§è¡Œçš„æ—¶é—´</span><br><span class="line">                dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                    </span><br><span class="line">                    // application.backgroundTimeRemaining å¿…é¡»åœ¨ä¸»çº¿ç¨‹è·å–</span><br><span class="line">                    remainedTime = application.backgroundTimeRemaining;</span><br><span class="line">                    </span><br><span class="line">                    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</span><br><span class="line">                       </span><br><span class="line">                        MZLOG(@&quot;BackgroundTask. The remained time: %f&quot;, remainedTime);</span><br><span class="line">                        </span><br><span class="line">                        if (remainedTime &lt; 10) &#123;</span><br><span class="line">                            </span><br><span class="line">                            // å¯ä»¥å‘Šè¯‰å…¶ä»–ä¸šåŠ¡, åå°ç”³è¯·çš„æ—¶é—´å³å°†ç»“æŸäº†</span><br><span class="line">                        &#125;</span><br><span class="line">                        </span><br><span class="line">                        if (remainedTime &lt; 2) &#123;</span><br><span class="line">                            </span><br><span class="line">                            /// è¿™é‡Œå¯ä»¥åšä¸€äº›æ¸…é™¤å·¥ä½œ</span><br><span class="line">                            &#123;</span><br><span class="line">                                // clean up</span><br><span class="line">                            &#125;</span><br><span class="line">                            </span><br><span class="line">                            [application endBackgroundTask:taskId];</span><br><span class="line">                            </span><br><span class="line">                            taskId = UIBackgroundTaskInvalid;</span><br><span class="line">                            </span><br><span class="line">                            return;</span><br><span class="line">                        &#125;</span><br><span class="line">                        </span><br><span class="line">                        // ç¡çœ (å»¶æ—¶)1s</span><br><span class="line">                        [NSThread sleepForTimeInterval:1.f];</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>startTask å¼€å¯åå°ä»»åŠ¡.</p><p>åœ¨ AppDelegate ä¸­, è°ƒç”¨è¿™ä¸ªæ–¹æ³•.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- (void)applicationDidEnterBackground:(UIApplication *)application &#123;</span><br><span class="line">    </span><br><span class="line">    [[MZBackgroundTask sharedTask] startTask];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†æ¬¡è¿è¡Œå·¥ç¨‹, å¯ä»¥æ ¹æ®æ—¥å¿—çœ‹å‡º, ä¹‹å‰çš„ dispatch_after å’Œ timer å¯ä»¥è¿è¡Œäº†, å¹¶ä¸”å¯ä»¥è¿è¡Œ3åˆ†é’Ÿ(180s).</p><p>æ ¹æ® backgroundTimeRemaining è¿™ä¸ªå±æ€§, å¯ä»¥çœ‹å‡ºå…·ä½“çš„åå°å¯æ‰§è¡Œçš„å‰©ä½™æ—¶é—´.</p><p><img src="/upload/images/2017/07/30/Background3.jpg" alt="1"></p><p>æ³¨æ„: æˆ‘æµ‹è¯•çš„æ—¶å€™ä½¿ç”¨çš„æ˜¯ iOS10 è®¾å¤‡.</p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>é™¤äº†è‹¹æœè§„å®šçš„å‡ ç§ç±»å‹(å¦‚å®šä½, å½•éŸ³, VOIP ç­‰)çš„åº”ç”¨å¤–, å…¶ä»– APP æƒ³ç”³è¯·æ›´å¤šçš„åå°é©»ç•™æ—¶é—´, å°±éœ€è¦ä¸€äº› <code>æ—é—¨å·¦é“</code> çš„æ–¹æ³•äº†.</p><p>è‹¹æœå¯¹åå°æ“ä½œåšäº†è¿™ä¹ˆå¤šé™åˆ¶, ä¹Ÿæ˜¯ä»ç”¨æˆ·çš„è§’åº¦å‡ºå‘, å¦‚å®‰å…¨, çœç”µ, çœæµé‡ç­‰.</p><p>æ¯”å¦‚, åœ¨åå°æ’­æ”¾æ²¡æœ‰å£°éŸ³çš„éŸ³ä¹.</p><p>å†æ¯”å¦‚, ç”³è¯·å®šä½æœåŠ¡çš„æƒé™, è¿™æ ·ä¹Ÿå¯ä»¥ä¿æŒ APP åœ¨åå°ä¸è¢«æŒ‚èµ·.<br>ä½†æ˜¯, ä¾ç…§è‹¹æœä¸€è´¯çš„å®¡æ ¸åšæ³•æ¥çœ‹ï¼Œå¦‚æœå£°æ˜äº†éœ€è¦æŸé¡¹åå°æƒé™ï¼Œä½ å´æ²¡æœ‰ç›¸å…³å®ç°çš„è¯ï¼Œä¼šç›´æ¥è¢«æ‹’æ‰çš„.</p><p>è¿™äº›æ˜¯æŠ€æœ¯ä¸Šçš„å®ç°, æˆ‘æ²¡æœ‰æ¨èå¤§å®¶è¿™ä¹ˆå¹², ç°åœ¨è‹¹æœå®¡æ ¸æ¯”ä»¥å‰è¿˜è¦ä¸¥æ ¼, å¤§å®¶è¿˜æ˜¯æ‚ ç€ç‚¹å¹²å§.å¦‚æœä½ çš„ APP ä¸éœ€è¦ä¸Šæ¶åˆ° AppStore çš„è¯, å°±å°½æƒ…çš„æ”¾çºµå§â€¦</p><h2 id="æ¨èåšæ–‡"><a href="#æ¨èåšæ–‡" class="headerlink" title="æ¨èåšæ–‡"></a>æ¨èåšæ–‡</h2><p>1.<a href="http://www.jianshu.com/p/50ff7a3a0fcd">iOSå®ç°æ— é™åå°backgroundçš„æ–¹æ³•</a></p><p>2.<a href="https://onevcat.com/2013/08/ios7-background-multitask/">WWDC 2013 Sessionç¬”è®° - iOS7ä¸­çš„å¤šä»»åŠ¡</a></p><p>iOS åœ¨åå°çš„æ—¶å€™å¦‚æœä¸ä½¿ç”¨åå°æ¨¡å¼, socket ä¹Ÿä¼šè¢«ç³»ç»Ÿå…³é—­è¿æ¥, æ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨çš„ IM åŠŸèƒ½.<br>ä½¿ç”¨åå°æ¨¡å¼å, å‘ç³»ç»Ÿç”³è¯·çš„æ—¶é—´(3åˆ†é’Ÿå†…), socket è¿˜æ˜¯æ²¡æœ‰è¢«å…³é—­çš„, é™¤éæ–­ç½‘æˆ–è€…è¢«è·¯ç”±å™¨ç»™æ–­å¼€äº†, åœ¨ç”³è¯·çš„è¿™æ®µæ—¶é—´å†…, socekt è¿˜æ˜¯å¯ä»¥ä½¿ç”¨çš„, å¦‚æœæƒ³æŒç»­çš„ä¿æŒ socket è¿æ¥, å°±éœ€è¦å»äº†è§£ä¸€ä¸‹ VOIP Socket ç›¸å…³çš„çŸ¥è¯†äº†, å®è·µè¿‡å, åˆ†äº«ç»™å¤§å®¶.</p><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p>ä¸‹é¢æ˜¯å…·ä½“çš„å®ç°ä»£ç .</p><blockquote><p>ViewController.m</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">@interface ViewController ()</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong) NSTimer *timer;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@implementation ViewController</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    </span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    [[NSNotificationCenter defaultCenter] addObserver:self</span><br><span class="line">                                             selector:@selector(onDidEnterBackground:)</span><br><span class="line">                                                 name:UIApplicationDidEnterBackgroundNotification</span><br><span class="line">                                               object:nil];</span><br><span class="line">    </span><br><span class="line">    // æ¯éš”ä¸€ç§’æ‰§è¡Œä¸€æ¬¡</span><br><span class="line">    _timer = [NSTimer scheduledTimerWithTimeInterval:1</span><br><span class="line">                                              target:self</span><br><span class="line">                                            selector:@selector(onTimerDidRun:)</span><br><span class="line">                                            userInfo:nil repeats:YES];</span><br><span class="line">    </span><br><span class="line">    [[NSRunLoop currentRunLoop] addTimer:self.timer forMode:NSRunLoopCommonModes];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - Callback.</span><br><span class="line"></span><br><span class="line">- (void)onTimerDidRun:(id)sender &#123;</span><br><span class="line">    </span><br><span class="line">    MZLOG(@&quot;App Background. Timer Running.&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)onDidEnterBackground:(NSNotification *)notification &#123;</span><br><span class="line">    </span><br><span class="line">    MZLOG(@&quot;App Background. Enter onDidEnterBackground.&quot;);</span><br><span class="line">    </span><br><span class="line">    int delta = 1;</span><br><span class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(delta * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        </span><br><span class="line">        MZLOG(@&quot;App Background. Enter onDidEnterBackground diapatch.&quot;);</span><br><span class="line">        </span><br><span class="line">        UILocalNotification *notification = [UILocalNotification new];</span><br><span class="line">        notification.fireDate = [NSDate dateWithTimeIntervalSinceNow:3];</span><br><span class="line">        notification.alertBody = @&quot;èµ°, å»highå§!&quot;;</span><br><span class="line">        notification.soundName = UILocalNotificationDefaultSoundName;</span><br><span class="line">        // å¯ä»¥è‡ªå®šä¹‰æ•°æ®</span><br><span class="line">        notification.userInfo = @&#123;@&quot;user_info_key&quot;: @&quot;user_info_value_json_str&quot;&#125;;</span><br><span class="line">        </span><br><span class="line">        [[UIApplication sharedApplication] scheduleLocalNotification:notification];</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - SetupViews.</span><br><span class="line"></span><br><span class="line">- (void)_setupViews &#123;</span><br><span class="line">    </span><br><span class="line">    self.view.backgroundColor = [UIColor purpleColor];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>MZBackgroundTask.m</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;MZBackgroundTask.h&quot;</span><br><span class="line"></span><br><span class="line">@implementation MZBackgroundTask</span><br><span class="line"></span><br><span class="line">+ (instancetype)sharedTask &#123;</span><br><span class="line">    </span><br><span class="line">    static MZBackgroundTask *_task;</span><br><span class="line">    static dispatch_once_t onceToken;</span><br><span class="line">    dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line">        _task = [[self alloc] init];</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    return _task;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)startTask &#123;</span><br><span class="line">    </span><br><span class="line">    if (![self _checkSupportBackgroundTask]) &#123;</span><br><span class="line">        </span><br><span class="line">        MZLOG(@&quot;BackgroundTask. Current device don&#x27;t support backgroundTask.&quot;);</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    UIApplication *application = [UIApplication sharedApplication];</span><br><span class="line">    </span><br><span class="line">    __block UIBackgroundTaskIdentifier taskId;</span><br><span class="line">    </span><br><span class="line">    /// ç”³è¯·åå°æ‰§è¡Œ</span><br><span class="line">    /// æ³¨æ„: åœ¨iOS7å’Œè¯¥ç‰ˆæœ¬å‰ï¼Œåå°å¯ä»¥ç”¨ä¸‹é¢çš„çš„æ–¹å¼åœ¨åå°å­˜æ´»5-10åˆ†é’Ÿï¼Œåœ¨iOS8åŠåï¼Œæœ€å¤šå­˜æ´»3åˆ†é’Ÿ</span><br><span class="line">    &#123;</span><br><span class="line">        taskId = [application beginBackgroundTaskWithName:NSStringFromClass([self class]) expirationHandler:^&#123;</span><br><span class="line">            </span><br><span class="line">            MZLOG(@&quot;BackgroundTask. BackgroundTask is Over. The remained time: %f&quot;, application.backgroundTimeRemaining);</span><br><span class="line">            </span><br><span class="line">            [application endBackgroundTask:taskId];</span><br><span class="line">            </span><br><span class="line">            taskId = UIBackgroundTaskInvalid;</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    if (UIBackgroundTaskInvalid == taskId) &#123;</span><br><span class="line">        </span><br><span class="line">        MZLOG(@&quot;BackgroundTask. Apply backgroundTask failed.&quot;);</span><br><span class="line">        </span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    /// å¯ä»¥ç›‘æ§åå°ä»»åŠ¡å‰©ä½™çš„æ—¶é—´, é’ˆå¯¹ä¸šåŠ¡å¯ä»¥å»å¤„ç†</span><br><span class="line">    &#123;</span><br><span class="line">        dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</span><br><span class="line">            </span><br><span class="line">            __block NSTimeInterval remainedTime;</span><br><span class="line">            </span><br><span class="line">            while (true) &#123;</span><br><span class="line">                </span><br><span class="line">                // å‰©ä½™å¯ä»¥åå°æ‰§è¡Œçš„æ—¶é—´</span><br><span class="line">                dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                    </span><br><span class="line">                    // application.backgroundTimeRemaining å¿…é¡»åœ¨ä¸»çº¿ç¨‹è·å–</span><br><span class="line">                    remainedTime = application.backgroundTimeRemaining;</span><br><span class="line">                    </span><br><span class="line">                    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</span><br><span class="line">                       </span><br><span class="line">                        MZLOG(@&quot;BackgroundTask. The remained time: %f&quot;, remainedTime);</span><br><span class="line">                        </span><br><span class="line">                        if (remainedTime &lt; 10) &#123;</span><br><span class="line">                            </span><br><span class="line">                            // å¯ä»¥å‘Šè¯‰å…¶ä»–ä¸šåŠ¡, åå°ç”³è¯·çš„æ—¶é—´å³å°†ç»“æŸäº†</span><br><span class="line">                        &#125;</span><br><span class="line">                        </span><br><span class="line">                        if (remainedTime &lt; 2) &#123;</span><br><span class="line">                            </span><br><span class="line">                            /// è¿™é‡Œå¯ä»¥åšä¸€äº›æ¸…é™¤å·¥ä½œ</span><br><span class="line">                            &#123;</span><br><span class="line">                                // clean up</span><br><span class="line">                            &#125;</span><br><span class="line">                            </span><br><span class="line">                            [application endBackgroundTask:taskId];</span><br><span class="line">                            </span><br><span class="line">                            taskId = UIBackgroundTaskInvalid;</span><br><span class="line">                            </span><br><span class="line">                            return;</span><br><span class="line">                        &#125;</span><br><span class="line">                        </span><br><span class="line">                        // ç¡çœ (å»¶æ—¶)1s</span><br><span class="line">                        [NSThread sleepForTimeInterval:1.f];</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - Private.</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  å½“å‰è®¾å¤‡æ˜¯å¦æ”¯æŒåå°ä»»åŠ¡.</span><br><span class="line"> *</span><br><span class="line"> *  @return YES, æ”¯æŒåå°ä»»åŠ¡. å¦åˆ™, ä¸æ”¯æŒåå°ä»»åŠ¡.</span><br><span class="line"> */</span><br><span class="line">- (BOOL)_checkSupportBackgroundTask &#123;</span><br><span class="line">    </span><br><span class="line">    SEL sel = @selector(isMultitaskingSupported);</span><br><span class="line">    BOOL supportBTask = [[UIDevice currentDevice] respondsToSelector:sel];</span><br><span class="line">    </span><br><span class="line">    return supportBTask;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åå°æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨ Charles</title>
      <link href="/2017/07/23/%E4%BD%BF%E7%94%A8-Charles/"/>
      <url>/2017/07/23/%E4%BD%BF%E7%94%A8-Charles/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h2><p>Charles æ˜¯ Mac ä¸Šé¢æ¯”è¾ƒå¥½ç”¨çš„æŠ“åŒ…å·¥å…·.</p><p>åœ¨ä½¿ç”¨å¾®ä¿¡ç™»å½• SDK çš„æ—¶å€™, æˆ‘æƒ³çœ‹çœ‹å¾®ä¿¡è¯·æ±‚çš„å†…å®¹, ä»¥åŠå…¶æˆæƒè¿‡ç¨‹, å‘ç°åªè¦è¿æ¥ Charles, è·³è½¬åˆ°å¾®ä¿¡ä¹‹åæ— æ³•æ‰“å¼€å¾®ä¿¡çš„æˆæƒç™»å½•é¡µé¢, æç¤ºç½‘ç»œä¸å¯ç”¨.</p><p>ç»è¿‡ç ”ç©¶, æ˜¯éœ€è¦ä½¿ç”¨ Charles é…ç½® HTTPS, é…ç½®å®Œæˆå, å°±å¯ä»¥éšå¿ƒæ‰€æ¬²äº†.</p><p>æ‰€ä»¥, ä»Šå¤©è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹ Charles ä½¿ç”¨çš„ä¸¤ä¸ªç‚¹:</p><ul><li>Charles çš„ HTTPS é…ç½®.</li><li>ä½¿ç”¨ Charles æ¨¡æ‹Ÿ(æ…¢)ç½‘ç»œ.</li></ul><h2 id="å·¥å…·å’Œç³»ç»Ÿ"><a href="#å·¥å…·å’Œç³»ç»Ÿ" class="headerlink" title="å·¥å…·å’Œç³»ç»Ÿ"></a>å·¥å…·å’Œç³»ç»Ÿ</h2><ul><li>iPhone: iOS 10.3.</li><li>Mac OS: 10.12.5.</li><li>Charles: 4.0.2.</li></ul><h2 id="æŠ“å–-HTTPS-è¯·æ±‚"><a href="#æŠ“å–-HTTPS-è¯·æ±‚" class="headerlink" title="æŠ“å– HTTPS è¯·æ±‚"></a>æŠ“å– HTTPS è¯·æ±‚</h2><p><strong>1.Mac å®‰è£…è¯ä¹¦</strong></p><blockquote><p>æ‰“å¼€ Charles, åœ¨ Help é€‰é¡¹ä¸­é€‰æ‹© SSL Proxying, å¦‚ä¸‹å›¾æ‰€ç¤º:</p></blockquote><p><img src="/upload/images/2017/07/23/1.jpg" alt="1"></p><p><strong>2.Mac ä¿¡ä»»è¯ä¹¦</strong></p><blockquote><p>æ‰“å¼€ Keychain Access (é’¥åŒ™ä¸²), æ‰¾åˆ°åˆšæ‰å®‰è£…çš„è¯ä¹¦, ä¿¡ä»»è¯ä¹¦, å¦‚å›¾:</p></blockquote><p><img src="/upload/images/2017/07/23/2.jpg" alt="1"></p><p><strong>3.ç»™ iPhone å®‰è£…è¯ä¹¦</strong></p><blockquote><p>æ‰“å¼€ Charles, åœ¨ Help é€‰é¡¹ä¸­é€‰æ‹© SSL Proxying, æ“ä½œå¦‚å›¾:</p></blockquote><p><img src="/upload/images/2017/07/23/3.jpg" alt="1"></p><p>åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­, å¯ä»¥çœ‹åˆ° <code>chls.pro/ssl</code></p><p><img src="/upload/images/2017/07/23/4.jpg" alt="1"></p><p>æ‰‹æœºè®¾ç½®ä»£ç†, è¿æ¥ Charles</p><blockquote><p>ä¸€å®šè¦è®°ä½: æ‰‹æœºä¸€å®šè¦è®¾ç½®ä»£ç†, å¦åˆ™å®‰è£…è¯ä¹¦ä¼šå¤±è´¥.</p></blockquote><p>æ‰“å¼€æ‰‹æœºçš„ Safari æµè§ˆå™¨, è¾“å…¥ <code>chls.pro/ssl</code> è¿™ä¸ªåœ°å€.</p><p><img src="/upload/images/2017/07/23/5.jpg" alt="1"></p><p>è®¾ç½®ä¿¡ä»»è¯ä¹¦, å¦‚ä¸‹å›¾:</p><p><img src="/upload/images/2017/07/23/6.jpg" alt="1"></p><p><img src="/upload/images/2017/07/23/7.jpg" alt="1"></p><h2 id="æ¨¡æ‹Ÿä»»æ„ç½‘ç»œ"><a href="#æ¨¡æ‹Ÿä»»æ„ç½‘ç»œ" class="headerlink" title="æ¨¡æ‹Ÿä»»æ„ç½‘ç»œ"></a>æ¨¡æ‹Ÿä»»æ„ç½‘ç»œ</h2><p>Charles ç»™æˆ‘ä»¬æä¾›äº†å¯ä»¥æ¨¡æ‹Ÿä»»ä½•ç½‘é€Ÿçš„ç½‘ç»œç¯å¢ƒçš„æ¡ä»¶.</p><p><img src="/upload/images/2017/07/23/8.jpg" alt="1"></p><p>æ‰“å¼€ Throttle Settings, ç„¶å Enable Throttling</p><p><img src="/upload/images/2017/07/23/9.jpg" alt="1"></p><p>å¯ä»¥çœ‹åˆ°å¾ˆå¤šç±»å‹çš„ç½‘ç»œä¾›ä½ é€‰æ‹©.</p><p>Add Preset å¯ä»¥è‡ªå·±è‡ªå®šä¹‰ä¸€ä¸ªç½‘ç»œç¯å¢ƒ.</p><p>è¿™ä¸ªåŠŸèƒ½éå¸¸å®ç”¨, å¯ä»¥è®©æˆ‘ä»¬æ¨¡æ‹Ÿæ…¢ç½‘ç»œç¯å¢ƒ, æ›´å¥½åœ°è°ƒè¯•è‡ªå·±çš„ç¨‹åº.</p><h2 id="é‡åˆ°éº»çƒ¦"><a href="#é‡åˆ°éº»çƒ¦" class="headerlink" title="é‡åˆ°éº»çƒ¦"></a>é‡åˆ°éº»çƒ¦</h2><p>1.æŠ“å– HTTPS çš„è¯·æ±‚å‡ºç°é”™è¯¯</p><p>é”™è¯¯æ—¥å¿—å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SSLHandshake: Received fatal alert: unknown_ca</span><br><span class="line">Charles Proxy will even offer a helpful suggestion:</span><br><span class="line">You may need to configure your browser or application to trust the Charles Root Certificate. See SSL Proxying in the Help menu.</span><br></pre></td></tr></table></figure><p><img src="/upload/images/2017/07/23/10.jpg" alt="1"></p><p>è¿™ç§é”™è¯¯ä¸€èˆ¬æ˜¯å‡ºç°åœ¨ iOS10 ä¸Šé¢.</p><p>è¯·åœ¨å…³äºæœ¬æœºé‡Œé¢å†è®¾ç½®ä¸€æ¬¡ è¯ä¹¦ä¿¡ä»»è®¾ç½®, å³å¯.</p><p><img src="/upload/images/2017/07/23/11.jpg" alt="1"></p><p>2.ç³»ç»Ÿå‡çº§å, è®¾ç½®çš„ HTTPS æŠ“åŒ…å¤±æ•ˆ</p><p>æŒ‰ç…§ä¸Šè¿°æ–¹æ³•, é‡æ–°è®¾ç½®ä¸€æ¬¡å³å¯.</p>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Charles MacOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cocos2d-js: åœ¨ iOS ä¸Šè¿è¡Œ</title>
      <link href="/2017/07/23/Cocos2d-js-%E5%9C%A8-iOS-%E4%B8%8A%E8%BF%90%E8%A1%8C/"/>
      <url>/2017/07/23/Cocos2d-js-%E5%9C%A8-iOS-%E4%B8%8A%E8%BF%90%E8%A1%8C/</url>
      
        <content type="html"><![CDATA[<p>åœ¨æˆ‘çš„åšæ–‡ <a href="http://www.veryitman.com/2017/05/14/2017-05-14-Cocos2d-js-%E9%A6%96%E6%AC%A1%E5%9C%A8-Mac-%E4%B8%8A%E9%9D%A2%E8%BF%90%E8%A1%8C/">Cocos2d-js: é¦–æ¬¡åœ¨ Mac ä¸Šé¢è¿è¡Œ</a> è¿™ç¯‡æ–‡ç« ä¸­, ä»‹ç»äº† Cocos2d ç›¸å…³çš„çŸ¥è¯†, å¹¶ä¸”ä½¿ç”¨Cocos2dx åˆ›å»ºäº†ä¸€ä¸ª JS çš„ç®€å•æ¸¸æˆé¡¹ç›®.</p><p>ä»Šå¤©è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹, å¦‚ä½•åœ¨ ios è®¾å¤‡ä¸Šé¢è¿è¡Œä¸€ä¸ª JS æ¸¸æˆé¡¹ç›®.</p><p>è¯¥æ¸¸æˆé¡¹ç›®(è´ªåƒè›‡)æ¥è‡ªç½‘ç»œèµ„æº, åªä¾›æ¼”ç¤ºä½¿ç”¨, ä¸æä¾›ä»»ä½•å…³äºæ¸¸æˆçš„èµ„æº.</p><h2 id="å½“åˆçš„æƒ³å½“ç„¶"><a href="#å½“åˆçš„æƒ³å½“ç„¶" class="headerlink" title="å½“åˆçš„æƒ³å½“ç„¶"></a>å½“åˆçš„æƒ³å½“ç„¶</h2><p>åœ¨ Mac ä¸Šé¢ so easy çš„ç¼–è¯‘å¹¶è¿è¡Œäº† JS æ¸¸æˆ, æˆ‘æƒ³åœ¨ iOS è®¾å¤‡ä¸Šåº”è¯¥ä¹Ÿå¾ˆç®€å•çš„å°±å¯ä»¥è¿è¡Œèµ·æ¥, ä½†æ˜¯æˆ‘å‘ç°æˆ‘ç®€å•ä¸åŠ æ€è€ƒçš„æƒ³æ³•, æ˜¯è¡Œä¸é€šçš„.</p><p>åšæ–‡ <a href="http://www.veryitman.com/2017/05/14/2017-05-14-Cocos2d-js-%E9%A6%96%E6%AC%A1%E5%9C%A8-Mac-%E4%B8%8A%E9%9D%A2%E8%BF%90%E8%A1%8C/">Cocos2d-js: é¦–æ¬¡åœ¨ Mac ä¸Šé¢è¿è¡Œ</a> åœ¨ FireFox æµè§ˆå™¨ä¸Šé¢å¯ä»¥ç›´æ¥è¿è¡Œ <code>index.html</code>, ä½†æ˜¯åœ¨ Chrome æµè§ˆå™¨ä¸Šé¢å°±æ²¡é‚£ä¹ˆé¡ºåˆ©.</p><p>æƒ³åˆ°è¿™é‡Œ, æˆ‘å°±å—åˆ°äº†å¯å‘, è«é iOS è®¾å¤‡ä¸Šé¢éœ€è¦è‡ªå·±æ­å»ºä¸€å¥— Web Server?</p><h2 id="æ­å»º-Web-Server"><a href="#æ­å»º-Web-Server" class="headerlink" title="æ­å»º Web Server"></a>æ­å»º Web Server</h2><p>æ—¢ç„¶æƒ³åˆ°äº†è¿™ä¸€æ­¥, æ¥ä¸‹æ¥å°±æ˜¯æ‰¾æ–¹æ¡ˆå®æ–½äº†.</p><p><a href="https://github.com/robbiehanson/CocoaHTTPServer">CocoaHTTPServer</a> è¿™ä¸ªå¯ä»¥æ»¡è¶³æˆ‘çš„éœ€æ±‚, äºæ˜¯, æˆ‘å°±ç›´æ¥æ‹¿æ¥ä½¿ç”¨äº†.</p><p>é¡¹ç›®ä¸­, æˆ‘ä½¿ç”¨äº† Cocoapods æ¥ç®¡ç†ç¬¬ä¸‰æ–¹åº“.åœ¨ podfile ä¸­ç›´æ¥æ·»åŠ ä¸‹é¢çš„ä»£ç :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod &#x27;CocoaHTTPServer&#x27;, &#x27;~&gt; 2.3&#x27;</span><br></pre></td></tr></table></figure><p>ç„¶å pod install å³å¯.</p><p>1.åœ¨ ViewController ä¸­å¯¼å…¥å¤´æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;HTTPServer.h&gt;</span><br><span class="line">ViewController å£°æ˜éƒ¨åˆ†</span><br><span class="line"></span><br><span class="line">@interface ViewController () &lt;WKNavigationDelegate&gt;</span><br><span class="line">@property (nonatomic, strong) WKWebView *webView;</span><br><span class="line">@property (nonatomic, strong) HTTPServer *localHttpServer;</span><br><span class="line">@property (nonatomic, strong) WKWebViewConfiguration *wbConfig;</span><br><span class="line">//ç”¨äºè°ƒè¯•çš„ UILabel</span><br><span class="line">@property (nonatomic, strong) IBOutlet UILabel *loadingLb;</span><br><span class="line">@property (nonatomic, assign) BOOL startServerSuccess;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>2.é…ç½® Web Server</p><p>æ ¸å¿ƒå®ç°å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"> - (void)_configLocalHttpServer</span><br><span class="line">&#123;</span><br><span class="line">    NSString *webPath = [[NSBundle mainBundle] pathForResource:@&quot;crazySnake&quot; ofType:nil];</span><br><span class="line">    _localHttpServer = [[HTTPServer alloc] init];</span><br><span class="line">    [_localHttpServer setType:@&quot;_http.tcp&quot;];</span><br><span class="line">    </span><br><span class="line">    NSFileManager *fileManager = [[NSFileManager alloc] init];</span><br><span class="line">    NSLog(@&quot;%@&quot;, webPath);</span><br><span class="line">    </span><br><span class="line">    if (![fileManager fileExistsAtPath:webPath]) &#123;</span><br><span class="line">        NSLog(@&quot;File path error!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        NSString *webLocalPath = webPath;</span><br><span class="line">        [_localHttpServer setDocumentRoot:webLocalPath];</span><br><span class="line">        NSLog(@&quot;webLocalPath:%@&quot;, webLocalPath);</span><br><span class="line">        [self _startWebServer];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">- (void)_startWebServer</span><br><span class="line">&#123;</span><br><span class="line">    self.loadingLb.hidden = NO;</span><br><span class="line">    </span><br><span class="line">    NSError *error;</span><br><span class="line">    if ([_localHttpServer start:&amp;error]) &#123;</span><br><span class="line">        NSLog(@&quot;Started HTTP Server on port %hu&quot;, [_localHttpServer listeningPort]);</span><br><span class="line">        self.port = [NSString stringWithFormat:@&quot;%d&quot;, [_localHttpServer listeningPort]];</span><br><span class="line">        </span><br><span class="line">        self.loadingLb.text = @&quot;Start Server Successfully.&quot;;</span><br><span class="line">        </span><br><span class="line">        _startServerSuccess = YES;</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        NSLog(@&quot;Error starting HTTP Server: %@&quot;, error);</span><br><span class="line">        </span><br><span class="line">        self.loadingLb.text = @&quot;Start Server failed.&quot;;</span><br><span class="line">        </span><br><span class="line">        _startServerSuccess = NO;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>_configLocalHttpServer</code> æ˜¯é…ç½® HTTPServer çš„æ–¹æ³•, <code>_startWebServer</code> æ˜¯å¼€å¯ Web Server çš„æ–¹æ³•.</p><p>è¿™æ ·è°ƒç”¨ <code>_configLocalHttpServer</code> å°±å¯ä»¥å¼€å¯åœ¨è®¾å¤‡ä¸Šé¢å¼€å¯ä¸€ä¸ª Web Server äº†.</p><h2 id="Xcode-å¯¼å…¥-JS-æ¸¸æˆé¡¹ç›®"><a href="#Xcode-å¯¼å…¥-JS-æ¸¸æˆé¡¹ç›®" class="headerlink" title="Xcode å¯¼å…¥ JS æ¸¸æˆé¡¹ç›®"></a>Xcode å¯¼å…¥ JS æ¸¸æˆé¡¹ç›®</h2><p>é¦–å…ˆçœ‹ä¸€ä¸‹æˆ‘çš„å·¥ç¨‹å’Œèµ„æºç›®å½•ç»“æ„, å¦‚å›¾:</p><p><img src="/upload/images/2017/07/23/2_1.jpg" alt="1"></p><p>ä»”ç»†çœ‹ä¸€ä¸‹, <code>crazySnake</code> è¿™ä¸ªæ–‡ä»¶å¤¹æ˜¯è“è‰²çš„, ä¸æ˜¯é»„è‰²çš„.</p><p>è¿™é‡Œç‰¹åˆ«æ³¨æ„, å¯¼å…¥è¿™ä¸ª crazySnake æ–‡ä»¶å¤¹çš„æ—¶å€™, Options ä¸€å®šè¦é€‰æ‹© <code>Create folder reference</code>.</p><p>ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåš?</p><p>ç»†å¿ƒçš„æœ‹å‹å¯ä»¥å‘ç°, ä½¿ç”¨ <code>Create folder reference </code>å¯¼å…¥çš„æ–‡ä»¶å¤¹, åœ¨é¡¹ç›®æ‰“åŒ…ç”Ÿæˆçš„ archive çš„æ–‡ä»¶ä¸­(è‡ªå·±å¯ä»¥è§£å‹çœ‹)æ˜¯å¯ä»¥çœ‹åˆ° crazySnake è¿™ä¸ªæ–‡ä»¶å¤¹çš„, å¦‚æœä¸æ˜¯è¿™ç§æ–¹å¼, è€Œæ˜¯ä½¿ç”¨ Create groups æ–¹å¼(åœ¨ Xcode ä¸­æ˜¾ç¤ºé»„è‰²), åœ¨ archive ä¸­æ˜¯çœ‹ä¸åˆ° crazySnake è¿™ä¸ªæ–‡ä»¶å¤¹çš„, è€Œæ˜¯å°†é‡Œé¢çš„æ–‡ä»¶æ‰“æ•£æ”¾åœ¨ archive çš„æ ¹ç›®å½•ä¸‹é¢äº†.</p><blockquote><p>æ€»ä¹‹, ä¸€å¥è¯, <code>Create folder reference</code> æ–¹å¼å¯¼å…¥çš„æ–‡ä»¶å¤¹åœ¨æ‰“åŒ…åè¿˜æ˜¯åŸæ¥çš„æ–‡ä»¶å¤¹, ä¸ä¼šå°†æ–‡ä»¶å¤¹é‡Œé¢çš„æ–‡ä»¶æ‰“æ•£.</p></blockquote><p>è¯•æƒ³ä¸€ä¸‹, å¦‚æœå¤šåŠ å…¥å‡ ä¸ªè¿™æ ·çš„ç›®å½•, éƒ½æ‰“æ•£åœ¨æ ¹ç›®å½•ä¸‹é¢, æˆ‘ä»¬å°±ä¸å¥½ç®¡ç†è¿™ä¸ªæ–‡ä»¶å¤¹é‡Œé¢çš„æ–‡ä»¶äº†.</p><h2 id="é…ç½®-WKWebView"><a href="#é…ç½®-WKWebView" class="headerlink" title="é…ç½® WKWebView"></a>é…ç½® WKWebView</h2><blockquote><p>è¿™é‡Œæˆ‘ä½¿ç”¨äº† WKWebView è€Œä¸æ˜¯ UIWebView ä½œä¸ºåŠ è½½ HTML çš„å®¹å™¨.<br>å½“ç„¶, ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ UIWebView.</p></blockquote><p>ä¸»è¦çš„æ ¸å¿ƒä»£ç å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    self.navigationController.navigationBarHidden = YES;</span><br><span class="line">    </span><br><span class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(0.5 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        self.loadingLb.text = @&quot;Config server...&quot;;</span><br><span class="line">        [self _configLocalHttpServer];</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    /// å¢åŠ çš„è°ƒå¼æ–¹æ³•: å¯ä»¥é‡æ–°å¯åŠ¨ web server.</span><br><span class="line">    &#123;</span><br><span class="line">        SEL sel = @selector(_configLocalHttpServer);</span><br><span class="line">        UITapGestureRecognizer *gesture = [[UITapGestureRecognizer alloc] initWithTarget:self</span><br><span class="line">                                                                                  action:sel];</span><br><span class="line">        [self.loadingLb addGestureRecognizer:gesture];</span><br><span class="line">        self.loadingLb.userInteractionEnabled = YES;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">- (void)viewDidAppear:(BOOL)animated</span><br><span class="line">&#123;</span><br><span class="line">    [super viewDidAppear:animated];</span><br><span class="line">    </span><br><span class="line">    // é…ç½® WKWebView</span><br><span class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(2 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        </span><br><span class="line">        _wbConfig = [[WKWebViewConfiguration alloc] init];</span><br><span class="line">        self.wbConfig.userContentController = [[WKUserContentController alloc] init];</span><br><span class="line">        </span><br><span class="line">        _webView = [[WKWebView alloc] initWithFrame:self.view.bounds configuration:self.wbConfig];</span><br><span class="line">        </span><br><span class="line">        _webView.frame = self.view.bounds;</span><br><span class="line">        _webView.scrollView.showsHorizontalScrollIndicator = NO;</span><br><span class="line">        _webView.scrollView.showsVerticalScrollIndicator   = NO;</span><br><span class="line">        </span><br><span class="line">        [self.view addSubview:self.webView];</span><br><span class="line">        self.webView.frame = self.view.bounds;</span><br><span class="line">        self.webView.navigationDelegate = self;</span><br><span class="line">        </span><br><span class="line">        if (self.startServerSuccess) &#123;</span><br><span class="line">            self.loadingLb.hidden = YES;</span><br><span class="line">            </span><br><span class="line">            NSString *gameUrl = [[NSBundle mainBundle] pathForResource:@&quot;index&quot;</span><br><span class="line">                                                                ofType:@&quot;html&quot;</span><br><span class="line">                                                           inDirectory:@&quot;crazySnake&quot;];</span><br><span class="line">            NSURL *url = [NSURL fileURLWithPath:gameUrl];</span><br><span class="line">            </span><br><span class="line">            url = [NSURL URLWithString:[NSString stringWithFormat:@&quot;http://127.0.0.1:%@/index.html&quot;, self.port]];</span><br><span class="line">            [self.webView loadRequest:[NSURLRequest requestWithURL:url]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»£ç å¾ˆç®€å•, å°±æ˜¯ä½¿ç”¨ WKWebView åŠ è½½ä¸€ä¸ª HTML æ–‡ä»¶å¹¶å¯åŠ¨ Web Server.</p><h2 id="è¿è¡Œé¡¹ç›®"><a href="#è¿è¡Œé¡¹ç›®" class="headerlink" title="è¿è¡Œé¡¹ç›®"></a>è¿è¡Œé¡¹ç›®</h2><p>æ¥ä¸‹æ¥, å°±æ˜¯è§è¯å¥‡è¿¹çš„æ—¶åˆ»äº†â€¦</p><p>ä¸Šé¢é…ç½®äº† Web Server å’Œ åŠ è½½ html çš„ WKWebView, ç°åœ¨å¯ä»¥ç›´æ¥è¿è¡Œé¡¹ç›®çœ‹æ•ˆæœäº†.</p><p>æ— è®ºä½ æ˜¯åœ¨æ¨¡æ‹Ÿå™¨è¿˜æ˜¯åœ¨çœŸæœºä¸Šé¢éƒ½å¯ä»¥è¿è¡Œè¿™ä¸ª JS æ¸¸æˆé¡¹ç›®äº†.</p><p><img src="/upload/images/2017/07/23/2_2.jpg" alt="1"></p><h2 id="å†™åœ¨æœ€å"><a href="#å†™åœ¨æœ€å" class="headerlink" title="å†™åœ¨æœ€å"></a>å†™åœ¨æœ€å</h2><p>ä¸Šé¢çš„ä¾‹å­æœ¬äººäº²è‡ªå®è·µè¿‡çš„, ç»™å¤§å®¶æä¾›äº†ä¸€ä¸ªå®ç°æ€è·¯, ç®—æ˜¯æŠ›ç –å¼•ç‰.</p><p>å¦‚æœæƒ³åšå¥½è¿™ä¸ªæ¨¡å¼, è¿˜éœ€è¦å¾ˆå¤šå·¥ä½œè¦åš, è¿™é‡Œåˆ—å‡ºæ¥ç»™å¤§å®¶åˆ†äº«ä¸€ä¸‹.</p><blockquote><p>1.æ¸¸æˆèµ„æºåŒ…ç®¡ç†å’Œä¸‹è½½.<br>2.æ¸¸æˆä¸­éœ€è¦å’Œ Native çš„äº¤äº’é€»è¾‘.<br>3.æ•°æ®åŠ å¯†.<br>4.ç§»åŠ¨ç«¯æ¸¸æˆæœ¬èº«çš„åŠ è½½ä¼˜åŒ–.</p></blockquote><p>å¦‚æœä½ æœ‰æ›´å¥½çš„æ–¹æ¡ˆå’Œæƒ³æ³•, æˆ‘å¾ˆä¹æ„é‚®ä»¶ (<a href="mailto:&#x76;&#101;&#x72;&#121;&#x69;&#x74;&#109;&#97;&#x6e;&#x40;&#x31;&#x32;&#x36;&#46;&#99;&#x6f;&#x6d;">&#x76;&#101;&#x72;&#121;&#x69;&#x74;&#109;&#97;&#x6e;&#x40;&#x31;&#x32;&#x36;&#46;&#99;&#x6f;&#x6d;</a>) ä¸ä½ æ²Ÿé€š, éå¸¸æ„Ÿè°¢!</p><p>ä»£ç ç¤ºä¾‹æˆ‘æ”¾åœ¨äº† GitHub, ç‚¹å‡» <a href="https://github.com/veryitman/MZMWPlay">MZMWPlay</a> å‰å¾€ä¸‹è½½ä½“éªŒ.</p>]]></content>
      
      
      <categories>
          
          <category> Game </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cocos Cocos2d-js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android: Chrome è°ƒè¯• WEB é¡µé¢</title>
      <link href="/2017/06/01/Android-Chrome-%E8%B0%83%E8%AF%95-WEB-%E9%A1%B5%E9%9D%A2/"/>
      <url>/2017/06/01/Android-Chrome-%E8%B0%83%E8%AF%95-WEB-%E9%A1%B5%E9%9D%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>åœ¨ Mac OS ä¸Šé¢é€šè¿‡ Safari è°ƒè¯• iOS è®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨çš„ WEB é¡µé¢, æ¯”è¾ƒæ–¹ä¾¿.</p><p>å…³äºå…·ä½“å¦‚ä½•ä½¿ç”¨ Safari æ¥è°ƒè¯• iOS è®¾å¤‡, å¯ä»¥å‚è€ƒ [Safari çš„å¼€å‘è€…æ¨¡å¼] è¿™ç¯‡æ–‡ç« .</p><p>è‡ªä»è¸ä¸Šå¼€å‘çš„é“è·¯, ç”µè„‘ä¸Šå°±å®‰è£…äº† Chrome æµè§ˆå™¨, å¹¶ä¸”ä¸€ç›´ä¿æŒç€æ›´æ–°, Chrome ä»¥å…¶ç®€å•è®¾è®¡å’Œé«˜æ•ˆçš„ç”¨æ³•å¸å¼•äº†å¤§æ‰¹å¼€å‘è€….</p><p>ä½¿ç”¨ Chrome è°ƒè¯• Android è®¾å¤‡çš„ WEB é¡µé¢, æ˜“å¦‚åæŒ.</p><h2 id="Chrome-è°ƒè¯•æ¡ä»¶"><a href="#Chrome-è°ƒè¯•æ¡ä»¶" class="headerlink" title="Chrome è°ƒè¯•æ¡ä»¶"></a>Chrome è°ƒè¯•æ¡ä»¶</h2><p>ä½¿ç”¨è¿™é¡¹æŠ€èƒ½çš„æ¡ä»¶å¦‚ä¸‹:</p><blockquote><p>1.Android è®¾å¤‡ç³»ç»Ÿæœ€ä½ä¸º4.4, ä¹Ÿå°±æ˜¯ android-19</p></blockquote><blockquote><p>2.Chrome æœ€å¥½ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„, ä»¥å‰çš„ç‰ˆæœ¬ä¸æ”¯æŒ, æœ€ä½å…¼å®¹ç‰ˆæœ¬ç›®å‰å°šä¸æ¸…æ¥š.</p></blockquote><blockquote><p>3.é…ç½® Android WebView, ä½¿å…¶æ”¯æŒ Debug å’Œä½¿èƒ½ JavaScript åŠŸèƒ½.</p></blockquote><blockquote><p>4.è®¾å¤‡å’Œ PC é€šè¿‡ USB è¿æ¥æ­£å¸¸, ä¸”æ”¯æŒ USB è°ƒè¯•çš„.</p></blockquote><p>æˆ‘ç›®å‰ä½¿ç”¨çš„è®¾å¤‡å’Œ Chrome ç‰ˆæœ¬ä¿¡æ¯å¦‚ä¸‹:</p><blockquote><p>Android è®¾å¤‡: 5.1.1ç‰ˆæœ¬<br>Chrome: Version 58.0.3029.110 (64-bit)</p></blockquote><p>æˆ‘ä»¬åœ¨åœ°å€æ ä¸­è¾“å…¥:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chrome://inspect</span><br></pre></td></tr></table></figure><p>å°±å¯ä»¥æ‰“å¼€è®¾å¤‡åˆ—è¡¨ç•Œé¢.<br><img src="/upload/images/2017/06/01/14962450324558.jpg" alt="1"></p><p>å¯ä»¥çœ‹åˆ°æˆ‘çš„ Android è®¾å¤‡å·²ç»æ˜¾ç¤ºå‡ºæ¥äº†.</p><p>ä¸‹é¢ä¸¾ä¸ªä¾‹å­è¯´æ˜è¯¥è°ƒè¯•å·¥å…·çš„ä½¿ç”¨.</p><h2 id="ç®€å•çš„-Android-å·¥ç¨‹ç¤ºä¾‹"><a href="#ç®€å•çš„-Android-å·¥ç¨‹ç¤ºä¾‹" class="headerlink" title="ç®€å•çš„ Android å·¥ç¨‹ç¤ºä¾‹"></a>ç®€å•çš„ Android å·¥ç¨‹ç¤ºä¾‹</h2><p>è¯¥å·¥ç¨‹åªæœ‰ä¸€ä¸ª Activity, ä½¿ç”¨ WebView åŠ è½½æœ¬åœ° HTML æ–‡ä»¶.</p><h4 id="1-åˆ›å»º-assets-ç›®å½•"><a href="#1-åˆ›å»º-assets-ç›®å½•" class="headerlink" title="1. åˆ›å»º assets ç›®å½•"></a>1. åˆ›å»º assets ç›®å½•</h4><p>å·¥ç¨‹åˆ‡æ¢åˆ° Project Files è§†å›¾<br><img src="/upload/images/2017/06/01/14962453176556.jpg" alt="1"></p><p>è¿™æ ·å°±å¯ä»¥åœ¨ src&#x2F;main ç›®å½•ä¸‹æ–°å»ºäº† assets æ–‡ä»¶å¤¹äº†.</p><h4 id="2-åˆ›å»º-HTML-æ–‡ä»¶"><a href="#2-åˆ›å»º-HTML-æ–‡ä»¶" class="headerlink" title="2. åˆ›å»º HTML æ–‡ä»¶"></a>2. åˆ›å»º HTML æ–‡ä»¶</h4><blockquote><p>è¯¥ HTML æ–‡ä»¶, å‘½åä¸º local.html, æ”¾åœ¨ assets ç›®å½•ä¸‹é¢.</p></blockquote><p>local.html æºæ–‡ä»¶:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;button onclick=&quot;myFunction()&quot;&gt;Click me&lt;/button&gt;</span><br><span class="line">&lt;p id=&quot;demo&quot;&gt;&lt;/p&gt;</span><br><span class="line">&lt;p&gt;A function is triggered when the button is clicked.&lt;/p&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    function myFunction() &#123;</span><br><span class="line">        console.log(&#x27;js console.&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h4 id="3-åœ¨-Activity-ä¸­é…ç½®-WebView"><a href="#3-åœ¨-Activity-ä¸­é…ç½®-WebView" class="headerlink" title="3.åœ¨ Activity ä¸­é…ç½® WebView."></a>3.åœ¨ Activity ä¸­é…ç½® WebView.</h4><p>Activity.java æºæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">public class MZWebPage extends AppCompatActivity &#123;</span><br><span class="line">    private WebView webView;</span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_mzweb_page);</span><br><span class="line">        webView = (WebView) this.findViewById(R.id.ui_web_view);</span><br><span class="line">        // è®¾ç½® WebView çš„ Debug ä¸ºå¯ç”¨çŠ¶æ€</span><br><span class="line">        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) &#123;</span><br><span class="line">            WebView.setWebContentsDebuggingEnabled(true);</span><br><span class="line">        &#125;</span><br><span class="line">        WebSettings settings = webView.getSettings();</span><br><span class="line">        </span><br><span class="line">        // è®¾ç½® JavaScript å¯ä»¥ä½¿ç”¨, å¦åˆ™åœ¨ HTML ä¸­æ— æ³•è°ƒç”¨ JavaScript ä»£ç </span><br><span class="line">        settings.setJavaScriptEnabled(true);</span><br><span class="line">        // æœ¬åœ°æ–‡ä»¶</span><br><span class="line">        String url = &quot;file:///android_asset/local.html&quot;;</span><br><span class="line">        webView.loadUrl(url);</span><br><span class="line">        webView.setWebViewClient(new WebViewClient() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public boolean shouldOverrideUrlLoading(WebView view, WebResourceRequest request) &#123;</span><br><span class="line">                return super.shouldOverrideUrlLoading(view, request);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        // è®¾ç½®æ¸²æŸ“è§†å›¾</span><br><span class="line">        webView.setWebChromeClient(new WebChromeClient());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„ xml å¸ƒå±€æ–‡ä»¶:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;LinearLayout</span><br><span class="line">    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">    xmlns:tools=&quot;http://schemas.android.com/tools&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;</span><br><span class="line">    tools:context=&quot;demo.droidsdk.near.idreamsky.com.nearsdk.MZWebPage&quot;&gt;</span><br><span class="line">    &lt;WebView</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;</span><br><span class="line">        android:id=&quot;@+id/ui_web_view&quot;&gt;</span><br><span class="line">    &lt;/WebView&gt;</span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure><h4 id="4-è¿è¡Œç¨‹åº"><a href="#4-è¿è¡Œç¨‹åº" class="headerlink" title="4. è¿è¡Œç¨‹åº"></a>4. è¿è¡Œç¨‹åº</h4><p>åœ¨ Chrome ä¸­è¾“å…¥ chrome:&#x2F;&#x2F;inspect æ‰“å¼€, å¯ä»¥çœ‹åˆ°æ­£åœ¨è¿è¡Œçš„ local.html.<br><img src="/upload/images/2017/06/01/14962458882973.jpg" alt="1"></p><p>ç‚¹å‡» <code>inspect</code>, è¿›å…¥è°ƒè¯•ç•Œé¢.</p><p>åœ¨è°ƒè¯•ç•Œé¢, ç‚¹å‡»é¡µé¢çš„ Click me, æŒ‰é’®, å¯¹åº”çš„ä¼šæœ‰ log è¾“å‡º.<br><img src="/upload/images/2017/06/01/14962459967493.jpg" alt="1"></p><h4 id="5-è°ƒè¯•å‡ºé”™çš„-HTML"><a href="#5-è°ƒè¯•å‡ºé”™çš„-HTML" class="headerlink" title="5.è°ƒè¯•å‡ºé”™çš„ HTML"></a>5.è°ƒè¯•å‡ºé”™çš„ HTML</h4><p>ä¿®æ”¹ä¸€ä¸‹ local.html æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;button onclick=&quot;myFunction()&quot;&gt;Click me&lt;/button&gt;</span><br><span class="line">&lt;p id=&quot;demo&quot;&gt;&lt;/p&gt;</span><br><span class="line">&lt;p&gt;A function is triggered when the button is clicked.&lt;/p&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    function myFunction() &#123;</span><br><span class="line">        console.log(&#x27;js console.&#x27; + var_error);</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥çœ‹å‡º <code>var_error</code> æ˜¯ä¸€ä¸ªä¸å­˜åœ¨çš„å˜é‡.</p><p>é‡æ–°è¿è¡Œ, ç‚¹å‡» Click me, å¯ä»¥çœ‹åˆ°å³ä¾§çš„ error:<br><img src="/upload/images/2017/06/01/14962461463698.jpg" alt="1"></p><p>å…³äº Chrome å¼€å‘è€…å·¥å…·çš„æ›´å¤šä½¿ç”¨, å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ <a href="https://developers.google.com/web/tools/chrome-devtools/?hl=zh-cn">Chrome å¼€å‘è€…å·¥å…·</a>.</p>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Chrome Web Debug </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿æŒä½ çš„å¥½ä¹ æƒ¯</title>
      <link href="/2017/05/29/%E4%BF%9D%E6%8C%81%E4%BD%A0%E7%9A%84%E5%A5%BD%E4%B9%A0%E6%83%AF/"/>
      <url>/2017/05/29/%E4%BF%9D%E6%8C%81%E4%BD%A0%E7%9A%84%E5%A5%BD%E4%B9%A0%E6%83%AF/</url>
      
        <content type="html"><![CDATA[<p><img src="/upload/images/2017/05/29/1.jpeg" alt="1"></p><p>æ˜å¤©å°±æ˜¯ä¼ ç»Ÿçš„ç«¯åˆèŠ‚äº†, æå‰ç¥å¤§å®¶ç«¯åˆå®‰åº·!</p><p>ä»Šå¤©è€å©†è®©æˆ‘å¸®å¿™æŠŠç²½å¶å­æ´—æ´—, è¯´è¦åŒ…ç²½å­, æˆ‘å¬è¯åœ°æŠŠåˆšä¹°æ¥çš„ç²½å¶å­æ´—äº†ä¸ªå¹²å‡€, é‚£éƒ½æ˜¯å¸¦æœ‰ç»¿è‰²çš„å¶å­, ç”Ÿæœºå‹ƒå‹ƒ, è®©æˆ‘ä»æŒ‡å°–ä¸­æ„Ÿåˆ°æ— æ¯”çš„æ¸©é¦¨å’Œæ— å°½çš„å¸Œæœ›.</p><p>å°çš„æ—¶å€™, æˆ‘å¾ˆäº«å—å¦ˆå¦ˆä¸ºæˆ‘ä»¬åŒ…ç²½å­çš„è¿‡ç¨‹, è¯´å®è¯, æˆ‘ä¸æ˜¯å¾ˆå–œæ¬¢åƒç²½å­, ä½†æ˜¯ç‰¹åˆ«å–œæ¬¢ç²½å­é”…é‡Œé¢çš„ç…®é¸¡è›‹, ç‰¹åˆ«ç¾å‘³.</p><p>è€å®¶çš„ç²½å­æ²¡æœ‰ä»€ä¹ˆç‰¹è‰², å°±æ˜¯ç®€ç®€å•å•çš„ç³¯ç±³è¢«åŒ…åœ¨å¶å­ä¸­, ç„¶åæ”¾åœ¨é”…é‡Œæ…¢æ…¢çš„ç…®, ç†Ÿäº†ä¹‹å, è˜¸ç‚¹ç™½ç³–å°±å¯ä»¥åƒäº†.</p><p>åˆ°äº†å—æ–¹ä¹‹å, æˆ‘æ‰å‘ç°ä¸–ç•Œä¸ŠåŸæ¥æœ‰å„ç§å„æ ·çš„ç²½å­, çº¢æ£çš„, ç»¿è±†çš„, çŒªè‚‰é¦…çš„, é¸¡è‚‰é¦…çš„â€¦ç­‰ç­‰!</p><p>è¿™äº›éƒ½æ˜¯å¶å‘çš„å›å¿†, å’Œä»Šå¤©çš„æ¨æ–‡æ²¡æœ‰å…³ç³», ä¸ä¿¡, ä½ æ¥ç€å¾€ä¸‹çœ‹.</p><h2 id="å…»æˆé˜…è¯»çš„ä¹ æƒ¯"><a href="#å…»æˆé˜…è¯»çš„ä¹ æƒ¯" class="headerlink" title="å…»æˆé˜…è¯»çš„ä¹ æƒ¯"></a>å…»æˆé˜…è¯»çš„ä¹ æƒ¯</h2><p>æˆ‘ä¸æ˜¯ä¸€ä¸ªèªæ˜çš„å­©å­, ç›´åˆ°å°å­¦ä¸‰å¹´çº§, æˆ‘æ‰çœŸæ­£çš„å¼€å§‹æ˜ç™½å­¦ä¹ åˆ°åº•æ˜¯æ€ä¹ˆä¸€å›äº‹, ç”¨è€å®¶äººçš„è¯è¯´ç®—æ˜¯å¼€çªäº†.</p><p>åæ¥æˆ‘å¾ˆé¡ºåˆ©çš„ä¸Šäº†åˆä¸­, å®¶é‡Œçš„å¤§éƒ¨åˆ†æ”¶å…¥è¦é åº„å®¶, ä¸€å¹´å››å­£èƒ½å¤Ÿé£è°ƒé›¨é¡ºçš„è¯, ä¹Ÿèƒ½è¿‡ä¸ªä¸é”™çš„å¹´, è‡³å°‘èƒ½æŠŠå­¦è´¹ç»™äº¤ä¸Š.</p><p>åˆä¸­äºŒå¹´çº§çš„æ—¶å€™, æˆ‘è¾å­¦äº†, ä¹Ÿè®¸æ˜¯å‘½è¿çš„å®‰æ’å§, å½“æ—¶è‡ªå·±ä¹Ÿæ²¡æœ‰å¤šæƒ³, æ¯…ç„¶å†³å®šä¸‹å­¦å»å¯»æ‰¾å¦ä¸€ç§äººç”Ÿ.</p><p>äºæ˜¯, æˆ‘é€‰æ‹©äº†ç†å‘è¿™ä¸ªè¡Œä¸š. å’Œå¸ˆå‚…åœ¨é£é£é›¨é›¨ä¸­åº¦è¿‡äº†ä¸€å¹´å¤šçš„æ—¶é—´, åœ¨å½“æ—¶çš„å†œæ‘, ä¸ä¸Šå­¦æœ‰é—¨æ‰‹è‰ºä¹Ÿç®—æ˜¯å¯¹è‡ªå·±å’Œçˆ¶æ¯æœ‰ä¸ªäº¤ä»£.</p><p>æˆ‘çš„å†…å¿ƒä»ç„¶æ¸´æœ›å»ä¸Šå­¦, è™½ç„¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¦å»ä¸Šå­¦ä¹Ÿä¸çŸ¥é“ä¸Šå­¦åèƒ½å¹²ä»€ä¹ˆ, ä½†æ˜¯å¿ƒé‡Œé¢æ€»æ˜¯è§‰å¾—è‡ªå·±ä¸èƒ½æ”¾å¼ƒå­¦ä¸š.åœ¨ç†å‘çš„ä¸€å¹´å¤šæ—¶é—´é‡Œ, æˆ‘æ²¡æœ‰æ”¾å¼ƒè¿‡å­¦ä¹ .<br>å†¥å†¥ä¹‹ä¸­è‡ªæœ‰å®‰æ’, å¦ˆå¦ˆæœ‰æ¬¡é—®æˆ‘: â€œè¿˜æƒ³å»ä¸Šå­¦ä¸?â€, æˆ‘æƒ³éƒ½æ²¡æƒ³å°±æƒ…ä¸è‡ªç¦çš„ç‚¹å¤´äº†, å¦ˆå¦ˆåˆè¯´:â€æˆ‘å°±çŸ¥é“ä½ æ²¡æœ‰æ”¾å¼ƒ, å»ç»§ç»­ä¸Šå­¦å§, ä¸è¦ç•™ä¸‹é—æ†¾!â€.å½“æ—¶çš„æˆ‘ç”­ææœ‰å¤šé«˜å…´äº†.</p><p>å†æ¬¡å›åˆ°æ ¡å›­çš„æˆ‘æ¯”ä»¥å‰æ›´åŠ åŠªåŠ›å’Œæ‹¼å‘½äº†, æ›´åŠ æ‡‚å¾—å¦‚ä½•çæƒœè¿™æ¥ä¹‹ä¸æ˜“çš„å­¦ä¹ æœºä¼šäº†.</p><p>ç›´åˆ°å¤§å­¦æ¯•ä¸š, å‚åŠ å·¥ä½œä»¥åŠæœ‰äº†å­©å­å, æˆ‘ä¹Ÿèƒ½ä¿æŒè‡ªæˆ‘å­¦ä¹ å’Œè‡ªæˆ‘æ¿€åŠ±çš„çŠ¶æ€, ä¿æŒå¥½çš„é˜…è¯»ä¹ æƒ¯, è®©æˆ‘å—ç›Šç»ˆèº«.</p><p>æœ‰æ¬¡å­©å­æ—©æ™¨èµ·åºŠå¿™å®Œå, å°±å¼€å§‹ååœ¨é‚£é‡Œçœ‹ä¹¦, æœ‰å¥½å‡ æ¬¡æ™šä¸Š, æˆ‘ä¹Ÿå‘ç°ä»–æ´—å®Œæ¾¡å, ååœ¨é‚£é‡Œçœ‹ä¹¦, æˆ–è€…æ˜¯åšæ‰‹å·¥, æˆ–æ˜¯ç”»ç”».</p><p>æˆ‘æ„Ÿåˆ°å¾ˆå¥½å¥‡, å†³å®šæ‰¾ä¸ªæœºä¼šé—®é—®ä»–.</p><p>æœ‰ä¸€ä¸ªå‘¨æœ«çš„ä¸Šåˆ, æ—©é¤è¿‡å, æˆ‘å°±æŠŠä»–æ‹‰åˆ°èº«è¾¹, å’Œä»–ä¸€èµ·çœ‹å„¿ç«¥è¯»ç‰©, é—®ä»–:â€å®è´, ä½ ä¸ºä»€ä¹ˆå–œæ¬¢çœ‹ä¹¦å‘¢?â€, ä»–è¯´:â€çˆ¸çˆ¸, æ˜¯ä½ å½±å“äº†æˆ‘, ä½ å–œæ¬¢çœ‹ä¹¦, æˆ‘ä¹Ÿå–œæ¬¢çœ‹ä¹¦.â€, çœ‹ç€ä»–ä¸€å‰¯å¤©çœŸçš„æ ·å­, æˆ‘çœŸçš„ä¸æ•¢ç›¸ä¿¡å‡ å²çš„å­©å­èƒ½è¯´å‡ºè¿™æ ·çš„è¯, ä½†æˆ‘å†…å¿ƒæ„Ÿåˆ°æ— æ¯”çš„æ¬£æ…°.åŸæ¥å¥½çš„ä¹ æƒ¯ä¼šä¼ æŸ“ç»™è‡ªå·±èº«è¾¹çš„äºº, å¹¶ä¸”èƒ½è®©ä½ æ„Ÿåˆ°è‡ªè±ª.</p><h2 id="åšæŒå†™åšå®¢"><a href="#åšæŒå†™åšå®¢" class="headerlink" title="åšæŒå†™åšå®¢"></a>åšæŒå†™åšå®¢</h2><p>å†™åšå®¢æˆ–è€…æ˜¯ç”Ÿæ´»æ—¥è®°, ç¡®å®å¾ˆâ€æµªè´¹â€æ—¶é—´, ç”šè‡³ä¼šå ç”¨ä½ ä»»ä½•ä¼‘æ¯çš„æ—¶é—´, å†™åšå®¢å¶å°”ä¹Ÿä¼šè®©ä½ æŠ“è€³æŒ è…®, æ„Ÿå¹:â€ä¹¦åˆ°ç”¨æ—¶æ–¹æ¨å°‘â€!</p><p>æ‰€ä»¥, è¯», å†™ä¸èƒ½åˆ†å®¶, æ›´åº”è¯¥æ˜¯å°†äºŒè€…ç´§å¯†çš„è”åˆåœ¨ä¸€èµ·.<br>å¤šé˜…è¯»å¤šå†™, æ‰ä¼šè®©ä½ æ›´åŠ çš„é€šé€, å½“ç„¶äº†, æˆ‘åªæ˜¯å–œæ¬¢å†™, å†™çš„è´¨é‡ä¹Ÿå¾ˆä¸€èˆ¬, åªæ˜¯ä¸ºäº†æ»¡è¶³å†…å¿ƒçš„é‚£ä¸€ç‚¹ç‚¹å¯¹çŸ¥è¯†çš„æ¸´æœ›.</p><p>å†™çš„å¤šäº†, ä½ å°±æ›´åŠ æ„¿æ„å»æ€è€ƒäº†, æ€è€ƒå¤šäº†, å¾ˆå¤šäº‹æƒ…ä½ å°±çœ‹å¼€äº†, å¯¹ä½ çš„ç”Ÿæ´»å’Œå·¥ä½œéƒ½æœ‰å¥½å¤„.</p><p>ä»09å¹´åˆ°ç°åœ¨æˆ‘ä¸€ç›´åšæŒå†™åšå®¢, åˆšå¼€å§‹ä¹Ÿæ˜¯æ— ä»ä¸‹ç¬”, ä¸çŸ¥é“è‡ªå·±åˆ°åº•è¯¥å†™ä¸€å†™ä»€ä¹ˆä¸œè¥¿, å†™äº†ä¹‹å, æ˜¯ä¸æ˜¯åˆ«äººçœ‹äº†ä¼šå˜²ç¬‘æˆ‘, è¯¸å¦‚æ­¤ç±»çš„æ‹…å¿ƒå¤ªå¤šå¤ªå¤š, åæ¥æˆ‘ä¹Ÿæƒ³æ˜ç™½äº†, ä½ å†™çš„å†å¥½ä¹Ÿæœ‰äººæ¯”ä½ å†™å¾—å¥½, ä¹Ÿä¼šæœ‰äººè¯´ä½ å†™çš„ä¸å¥½.é‚£æˆ‘ä½•å¿…å»è®¡è¾ƒè¿™ä¹ˆäº›ä¸ªäº‹å„¿äº†, åªç®¡åŠ¨æ‰‹å†™å§!</p><p>ç„¶å, å°±åœ¨åšå®¢ç½‘ç«™ä¸Šé¢è€•è€˜, æŠ€æœ¯çš„, åæ§½çš„, ç”Ÿæ´»çš„æˆ‘éƒ½å–œæ¬¢å†™, ä¸ç®¡ä½ å–œä¸å–œæ¬¢çœ‹, å®ƒéƒ½åœ¨é‚£é‡Œ, å“ˆå“ˆ!</p><p>æˆ‘æŠŠåšå®¢å½“åšè‡ªå·±çš„æœ‹å‹, å¿ƒæƒ…å¥½äº¦æˆ–æ˜¯ä¸å¥½çš„æ—¶å€™, æˆ‘éƒ½ä¼šå‘ä»–å€¾è¯‰, å¸Œæœ›è‡ªå·±å†™ä¸‹çš„ä¸œè¥¿æˆ–å¤šæˆ–å°‘èƒ½å¸®åŠ©ä¸€äº›äºº, è¿™ä¹Ÿè®¸æ˜¯æˆ‘åšæŒå†™åšå®¢çš„æœ€å¤§åŠ¨åŠ›äº†.</p><p>å¦‚æœä½ ä¹Ÿå–œæ¬¢å†™åšå®¢æˆ–è€…æ˜¯å‡†å¤‡å†™åšå®¢, å°±å¼€å§‹åŠ¨æ‰‹å†™å§, ä¸è¦å†çŠ¹è±«äº†.</p><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>è¿™ä¸ªä¸–ç•Œä¸Š, æ²¡å¤šå°‘äººå–œæ¬¢å¬åˆ«äººå•°å—¦, å³ä½¿å¬äº†ä½ çš„å•°å—¦, ä¹Ÿä¸ä¸€å®šä¼šä»˜å‡ºå®è·µ, å³ä½¿ä½ æ˜¯é•¿è€…æˆ–è€…æ˜¯æ™ºè€…, å†µä¸”æˆ‘åªæ˜¯ä¸€ä»‹å¹³æ°‘.</p><p>ä½†æ˜¯æˆ‘è¿˜æ˜¯è¦å•°å—¦ä¸€å¥:â€ä¿æŒæŒç»­å­¦ä¹ çš„ä¹ æƒ¯, ä¼šæ¶ˆè€—ä½ çš„å‹¤å¥‹, ä½†ä¼šè®©ä½ å—ç›Šç»ˆç”Ÿâ€, ä¿¡ä¸ä¿¡ç”±ä½ !</p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ€è€ƒ ç”Ÿæ´» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Safari çš„å¼€å‘è€…æ¨¡å¼</title>
      <link href="/2017/05/15/Safari-%E7%9A%84%E5%BC%80%E5%8F%91%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
      <url>/2017/05/15/Safari-%E7%9A%84%E5%BC%80%E5%8F%91%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¾ç½®-Safari"><a href="#è®¾ç½®-Safari" class="headerlink" title="è®¾ç½® Safari"></a>è®¾ç½® Safari</h2><p>1.æ‰“å¼€ Safari çš„ Preference<br><img src="/upload/images/2017/05/15/14948249631231.jpg" alt="1"></p><p>2.åˆ‡æ¢åˆ° Advanced é€‰é¡¹<br><img src="/upload/images/2017/05/15/14948250437147.jpg" alt="1"></p><p>å°† <code>Show Develop menu in menu bar</code> é€‰ä¸­.</p><p>å¯ä»¥çœ‹åˆ° Safari å¤šäº† Develop é€‰é¡¹<br><img src="/upload/images/2017/05/15/14948254198174.jpg" alt="1"></p><h2 id="è®¾ç½®è®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨"><a href="#è®¾ç½®è®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨" class="headerlink" title="è®¾ç½®è®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨"></a>è®¾ç½®è®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨</h2><h3 id="åœ¨-iphoneæˆ–è€…æ¨¡æ‹Ÿå™¨-ä¸­è®¾ç½®-Safari"><a href="#åœ¨-iphoneæˆ–è€…æ¨¡æ‹Ÿå™¨-ä¸­è®¾ç½®-Safari" class="headerlink" title="åœ¨ iphoneæˆ–è€…æ¨¡æ‹Ÿå™¨ ä¸­è®¾ç½® Safari"></a>åœ¨ iphoneæˆ–è€…æ¨¡æ‹Ÿå™¨ ä¸­è®¾ç½® Safari</h3><h4 id="æ‰“å¼€-Safari-çš„é«˜çº§é€‰é¡¹"><a href="#æ‰“å¼€-Safari-çš„é«˜çº§é€‰é¡¹" class="headerlink" title="æ‰“å¼€ Safari çš„é«˜çº§é€‰é¡¹"></a>æ‰“å¼€ Safari çš„é«˜çº§é€‰é¡¹</h4><p><img src="/upload/images/2017/05/15/14948252328005.jpg" alt="1"></p><h4 id="æ‰“å¼€-Web-æ£€æŸ¥å™¨"><a href="#æ‰“å¼€-Web-æ£€æŸ¥å™¨" class="headerlink" title="æ‰“å¼€ Web æ£€æŸ¥å™¨"></a>æ‰“å¼€ Web æ£€æŸ¥å™¨</h4><p><img src="/upload/images/2017/05/15/14948252717169.jpg" alt="1"></p><p>ä¸Šé¢è®¾ç½®å®Œæ¯•å, è¿è¡Œä½ çš„ç¨‹åº, åœ¨ Safari çš„ Develop ä¸­å¯ä»¥çœ‹åˆ°å¯¹åº”è®¾å¤‡, ä»è€Œå¯ä»¥è°ƒè¯• HTML é¡µé¢äº†.<br><img src="/upload/images/2017/05/15/14948259031169.jpg" alt="1"></p><p>åœ¨è°ƒè¯•çª—å£ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å½“å‰æ­£åœ¨åŠ è½½ç½‘é¡µçš„å„ç§ä¿¡æ¯ï¼Œå¦‚æºç ã€è¯·æ±‚å¤´ã€å›¾ç‰‡ã€åŠ è½½çš„èµ„æºä¸è„šæœ¬ã€æ§åˆ¶å°è¾“å‡ºç­‰.</p><p>ä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹ç½‘é¡µçš„ CSS æ ·å¼å’Œå¸ƒå±€ç­‰è¿›è¡Œä¿®æ”¹ï¼Œè€Œä¸ç”¨é‡æ–°è¿è¡Œ App.<br><img src="/upload/images/2017/05/15/14948635711574.jpg" alt="1"></p><p>ä½¿ç”¨ Safari çš„å¼€å‘è€…æ¨¡å¼, å¯ä»¥å¸®åŠ©æˆ‘ä»¬è°ƒè¯•å‰ç«¯é¡µé¢, è§£å†³ä¸€äº›é—®é¢˜, æ¯”è¾ƒæ–¹ä¾¿.</p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS Safari </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS: è‡ªå®šä¹‰ UIWebView å’Œ WKWebView çš„ UserAgent</title>
      <link href="/2017/05/14/iOS-%E8%87%AA%E5%AE%9A%E4%B9%89-UIWebView-%E5%92%8C-WKWebView-%E7%9A%84-UserAgent/"/>
      <url>/2017/05/14/iOS-%E8%87%AA%E5%AE%9A%E4%B9%89-UIWebView-%E5%92%8C-WKWebView-%E7%9A%84-UserAgent/</url>
      
        <content type="html"><![CDATA[<h2 id="å¯¼è¨€"><a href="#å¯¼è¨€" class="headerlink" title="å¯¼è¨€"></a>å¯¼è¨€</h2><p>åœ¨ iOS8, è‹¹æœæ¨å‡ºäº† WKWebView, ç›®çš„å¾ˆæ˜æ˜¾: å–ä»£ UIWebView.</p><p>éšç€æ—¶é—´çš„æ¨ç§», è¶Šæ¥è¶Šå¤šçš„åº”ç”¨å¼€å§‹æœ€ä½ç‰ˆæœ¬æ”¯æŒä¸º iOS8, å¤§å®¶ä¹Ÿçº·çº·çš„å¼€å§‹ä½¿ç”¨ WKWebView ç»„ä»¶.</p><p>åœ¨ iOS10.x ç‰ˆæœ¬ä¸Š, UIWebView çš„è¡¨ç°ä¸å°½å¦‚äººæ„, åœ¨æˆ‘ä»¬çš„åå°æ—¥å¿—å’Œç”¨æˆ·åé¦ˆ, å­˜åœ¨å¾ˆå¤šè«åå…¶å¦™çš„ crash ä»¥åŠå¡é¡¿ç°è±¡, å†…å­˜é£™å‡ç­‰é—®é¢˜. é’ˆå¯¹ä¸åŒçš„ JS æ¸¸æˆå¼•æ“, UIWebView è¡¨ç°ä¹Ÿä¸å¤Ÿå¥½, æ‰€ä»¥æ˜¯æ—¶å€™ä½¿ç”¨ WKWebView äº†.</p><p>ä½†æ˜¯è¯åˆè¯´å›æ¥, å¦‚æœä½ æœ€ä½ç‰ˆæœ¬æ”¯æŒ iOS8, ä¹Ÿä¸èƒ½å®Œå…¨æ”¾å¼ƒ UIWebView, WKWebView æœ‰ä¸€éƒ¨åˆ† API åªæœ‰ iOS9+ æ‰æœ‰, å¦‚æœä½ çš„åº”ç”¨åœ¨ iOS8 è¿è¡Œè€Œä½¿ç”¨ iOS9 çš„ API, è‚¯å®šä¼š crash.</p><p>ä¾‹å¦‚:</p><blockquote><p>1.æ¸…é™¤ç¼“å­˜.<br>2.è®¾ç½® user-agent.</p></blockquote><p>ä»Šå¤©è¦è¯´çš„æ˜¯å…³äºè®¾ç½®è‡ªå®šä¹‰ UIWebView å’Œ WKWebView çš„ UserAgent é—®é¢˜.</p><h2 id="WKWebView-UserAgent"><a href="#WKWebView-UserAgent" class="headerlink" title="WKWebView UserAgent"></a>WKWebView UserAgent</h2><h4 id="é»˜è®¤çš„-UserAgent"><a href="#é»˜è®¤çš„-UserAgent" class="headerlink" title="é»˜è®¤çš„ UserAgent"></a>é»˜è®¤çš„ UserAgent</h4><p>ä½¿ç”¨ä¸‹é¢çš„ä»£ç , å¯ä»¥è¾“å‡º WKWebView çš„é»˜è®¤ UserAgent.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidload </span><br><span class="line">&#123;</span><br><span class="line">[self.wkWebView evaluateJavaScript:@&quot;navigator.appName&quot; completionHandler:^(id __nullable appName, NSError * __nullable error) &#123;</span><br><span class="line">        NSLog(@&quot;navigator.appName: %@&quot;, appName);</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    [self.wkWebView evaluateJavaScript:@&quot;navigator.userAgent&quot; completionHandler:^(id __nullable userAgent, NSError * __nullable error) &#123;</span><br><span class="line">    NSLog(@&quot;navigator.userAgent: %@&quot;, userAgent);</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>navigator.appName æ— è®ºåœ¨ iOS8, iOS9 è¿˜æ˜¯ iOS10, è¾“å‡ºç»“æœéƒ½æ˜¯ä¸€è‡´çš„.</p><p>navigator.userAgent åœ¨ä¸åŒçš„ iOS ç³»ç»Ÿä¸Šé¢è¾“å‡ºç»“æœç•¥æœ‰ä¸åŒ.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// iOS 8.3</span><br><span class="line">// Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Mobile/12F70</span><br><span class="line">// iOS 9.0</span><br><span class="line">// Mozilla/5.0 (iPhone; CPU iPhone OS 9_0 like Mac OS X) AppleWebKit/601.1.32 (KHTML, like Gecko) Mobile/13A4254v</span><br><span class="line">// iOS 10.x</span><br><span class="line">//Mozilla/5.0 (iPhone; CPU iPhone OS 10_3 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E269</span><br></pre></td></tr></table></figure><h4 id="è‡ªå®šä¹‰-UserAgent"><a href="#è‡ªå®šä¹‰-UserAgent" class="headerlink" title="è‡ªå®šä¹‰ UserAgent"></a>è‡ªå®šä¹‰ UserAgent</h4><p>ä¿®æ”¹é»˜è®¤çš„ UserAgent, éœ€è¦ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">self.wkWebView.customUserAgent = @&quot;CustomUserAgent&quot;</span><br></pre></td></tr></table></figure><p>è¿™æ ·, å°±æ”¹å˜äº†å…¶é»˜è®¤çš„ UserAgent å€¼äº†.</p><p>ç‰¹åˆ«éœ€è¦æ³¨æ„: customUserAgent æ˜¯ iOS9 ä¹‹åæ‰æœ‰çš„å­—æ®µ.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/*! @abstract The custom user agent string or nil if no custom user agent string has been set.</span><br><span class="line">*/</span><br><span class="line">@property (nullable, nonatomic, copy) NSString *customUserAgent API_AVAILABLE(macosx(10.11), ios(9.0));</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥åœ¨ iOS8.x, å¦‚æœä½ æƒ³æ”¹å˜ UserAgent, è¿˜æ˜¯è¦ä½¿ç”¨ UIWebView.</p><h2 id="HTML-ä½¿ç”¨-UserAgent"><a href="#HTML-ä½¿ç”¨-UserAgent" class="headerlink" title="HTML ä½¿ç”¨ UserAgent"></a>HTML ä½¿ç”¨ UserAgent</h2><p>HTML ä¸­å¯ä»¥æ ¹æ®è‡ªå®šä¹‰çš„ UserAgent, åšå‡ºä¸åŒçš„è¡Œä¸º, å¦‚è‡ªå®šçš„ UserAgent å¯ä»¥åŒ…æ‹¬åº”ç”¨çš„ç‰ˆæœ¬å·, HTML å¯ä»¥æ ¹æ®ä¸åŒçš„ç‰ˆæœ¬æ¥åšç‰ˆæœ¬åŒºåˆ†ç­‰é€»è¾‘.</p><p>åœ¨ HTML ä¸­, å¯ä»¥ä½¿ç”¨ JS æ¥è·å– UserAgent çš„å€¼.</p><p>Demo.html</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot; xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset=&quot;utf-8&quot; /&gt;</span><br><span class="line">        &lt;title&gt;user-agent&lt;/title&gt;</span><br><span class="line">        &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">            function getUserAgent() &#123;</span><br><span class="line">                var ug = navigator.userAgent;</span><br><span class="line">                document.getElementById(&quot;mySpan&quot;).innerHTML = ug;</span><br><span class="line">            &#125;</span><br><span class="line">        &lt;/script&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;h1&gt;æ˜¾ç¤º user-agent&lt;/h1&gt;</span><br><span class="line">        &lt;p&gt;&lt;span style=&quot;font-size:30px&quot; id=&quot;mySpan&quot;&gt;..&lt;/span&gt;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;&lt;input type=&quot;button&quot; value=&quot;ç‚¹å‡»æ˜¾ç¤º user-agent&quot; onclick=&quot;getUserAgent()&quot;  class=&quot;button&quot;/&gt;&lt;/p&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        .button &#123;</span><br><span class="line">            background-color: #4C0950;</span><br><span class="line">            border: none;</span><br><span class="line">            color: white;</span><br><span class="line">            padding: 15px 32px;</span><br><span class="line">            text-align: center;</span><br><span class="line">            text-decoration: none;</span><br><span class="line">            display: inline-block;</span><br><span class="line">            font-size: 40px;</span><br><span class="line">            margin: 20px 200px 100px 300px;</span><br><span class="line">            cursor: pointer;</span><br><span class="line">            border-radius: 15;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ WKWebView åŠ è½½è¯¥ Demo.html æ–‡ä»¶, æ•ˆæœå›¾å¦‚ä¸‹:<br><img src="/upload/images/2017/05/14/webView.jpg" alt="1"></p><h2 id="UIWebView-UserAgent"><a href="#UIWebView-UserAgent" class="headerlink" title="UIWebView UserAgent"></a>UIWebView UserAgent</h2><h4 id="é»˜è®¤çš„-UserAgent-1"><a href="#é»˜è®¤çš„-UserAgent-1" class="headerlink" title="é»˜è®¤çš„ UserAgent"></a>é»˜è®¤çš„ UserAgent</h4><p>ä½¿ç”¨ä¸‹é¢çš„ä»£ç , å¯ä»¥è¾“å‡º UIWebView çš„é»˜è®¤ UserAgent.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">NSString *appName = [self.webView stringByEvaluatingJavaScriptFromString:@&quot;navigator.appName&quot;];</span><br><span class="line">NSLog(@&quot;navigator.appName: %@&quot;, appName);</span><br><span class="line">    </span><br><span class="line">NSString *userAgent = [self.webView stringByEvaluatingJavaScriptFromString:@&quot;navigator.userAgent&quot;];</span><br><span class="line">NSLog(@&quot;navigator.userAgent %@&quot;, userAgent);</span><br></pre></td></tr></table></figure><p>æ‰“å°è¾“å‡ºç»“æœå’Œ WKWebView çš„ç»“æœä¸€è‡´.</p><h4 id="è®¾ç½®è‡ªå®šçš„-UserAgent"><a href="#è®¾ç½®è‡ªå®šçš„-UserAgent" class="headerlink" title="è®¾ç½®è‡ªå®šçš„ UserAgent"></a>è®¾ç½®è‡ªå®šçš„ UserAgent</h4><p>è®¾ç½®ä¸€ä¸ª key ä¸º @â€UserAgentâ€ çš„æœ¬åœ°å­˜å‚¨å³å¯.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[[NSUserDefaults standardUserDefaults] registerDefaults:@&#123;@&quot;UserAgent&quot;:@&quot;CustomUserAgent-UIWebView&quot;&#125;];</span><br><span class="line">    </span><br><span class="line">NSString *appName = [self.webView stringByEvaluatingJavaScriptFromString:@&quot;navigator.appName&quot;];</span><br><span class="line">NSLog(@&quot;navigator.appName: %@&quot;, appName);</span><br><span class="line">    </span><br><span class="line">NSString *userAgent = [self.webView stringByEvaluatingJavaScriptFromString:@&quot;navigator.userAgent&quot;];</span><br><span class="line">NSLog(@&quot;navigator.userAgent %@&quot;, userAgent);</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±æ”¹å˜äº† UIWebView çš„é»˜è®¤ UserAgent äº†.</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>åº”ç”¨æœ€ä½ç‰ˆæœ¬æ”¯æŒ iOS7&#x2F;8 çš„å¼€å‘è€…ä»¬, å¯ä»¥è€ƒè™‘ UIWebView å’Œ WKWebView å¹¶å­˜çš„å¼€å‘æ¨¡å¼. iOS9åŠä»¥ä¸Šçš„å¼€å‘è€…ä½ ä»¬, å¯ä»¥å®Œå…¨æ”¾å¼ƒ UIWebView, å¤§èƒ†çš„æ‹¥æŠ± WKWebView äº†.</p><p>ç§»æ¤ UIWebView åˆ° WKWebView çš„æˆæœ¬ä¸ç®—å¤§.<br>å¦‚æœä½ ç°åœ¨æœ‰æ—¶é—´, å¯ä»¥å¼€å§‹ç€æ‰‹åšè¿™äº›äº‹äº†.å‰ç«¯å’Œå®¢æˆ·ç«¯éœ€è¦è€ƒè™‘ä¹‹å‰äº¤äº’é‚£éƒ¨åˆ†çš„é€»è¾‘, å³ JS è°ƒç”¨ Native æˆ–è€… Native è°ƒç”¨ JS çš„éœ€è¦åšäº›è°ƒæ•´, å› ä¸º WKWebView çš„è°ƒç”¨æ–¹å¼å’Œ UIWebView ä¸ä¸€æ ·äº†, å‰ç«¯é¡µé¢è¦è€ƒè™‘ç‰ˆæœ¬å…¼å®¹æ€§.</p><p>æ–°çš„ WKWebView è™½ç„¶å­˜åœ¨ä¸€äº›å‘, ä½†æ˜¯ä½¿ç”¨å®ƒäº¦æ˜¯å¤§åŠ¿æ‰€è¶‹, æ­£æ‰€è°“ å­˜åœ¨å³åˆç†, ä½ æ²¡æœ‰ç†ç”±æ‹’ç»å®ƒ.</p><p>åç»­, æˆ‘ä¼šå†™ä¸€å†™åœ¨ WKWebView ä¸Šé¢é‡åˆ°çš„ä¸€äº›é—®é¢˜, åˆ†äº«ç»™å¤§å®¶.</p><p>ä¹‹å‰æˆ‘ä¹Ÿå†™è¿‡ä¸€ç¯‡æ–‡ç« , æ˜¯å…³äº UIWebView ç¼“å­˜çš„, ä¸å¦¨, ä½ ä¹Ÿç…ç… [iOS: èŠèŠ UIWebView ç¼“å­˜].</p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> UIWebView WKWebView UserAgent </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cocos2d-js: é¦–æ¬¡åœ¨ Mac ä¸Šé¢è¿è¡Œ</title>
      <link href="/2017/05/14/Cocos2d-js-%E9%A6%96%E6%AC%A1%E5%9C%A8-Mac-%E4%B8%8A%E9%9D%A2%E8%BF%90%E8%A1%8C/"/>
      <url>/2017/05/14/Cocos2d-js-%E9%A6%96%E6%AC%A1%E5%9C%A8-Mac-%E4%B8%8A%E9%9D%A2%E8%BF%90%E8%A1%8C/</url>
      
        <content type="html"><![CDATA[<h2 id="Cocos2d-js-ä»‹ç»"><a href="#Cocos2d-js-ä»‹ç»" class="headerlink" title="Cocos2d-js ä»‹ç»"></a>Cocos2d-js ä»‹ç»</h2><p>å¦‚æœä½ æ˜¯åˆšæ¥è§¦ Cocos2d-js å¼€å‘çš„äºº, ä¸€å®šä¼šè¢« Cocos2d-js å’Œ Cocos2d-HTML5 ä»¥åŠ Cocos2d-x æå¾—æ™•å¤´è½¬å‘.</p><p>ä¸‹é¢ç®€å•ä»‹ç»ä¸€ä¸‹ Cocos2d-js çš„å‰ä¸–ä»Šç”Ÿ.</p><p>ç›®å‰ Cocos2d-x æ”¯æŒä½¿ç”¨ C++ã€Luaã€Javascript è¯­è¨€æ¥è¿›è¡Œå¼€å‘ï¼Œä¸”å†…ç½® JavaScript å¼•æ“ï¼Œé€šè¿‡ C++ è§£æ Javascript å»æ‰§è¡Œ.</p><p>Cocos2d-HTML5 æ˜¯ä½¿ç”¨ JavaScript è¿›è¡Œå¼€å‘ï¼Œæœ€ç»ˆè¿è¡Œåœ¨æµè§ˆå™¨é‡Œçš„.</p><p>v3.0 åï¼ŒCocos2d-HTML5 å’Œ Cocos2d-x JSBinding è¢«åˆåˆ°äº†ä¸€èµ·ï¼Œç§°ä½œ Cocos2d-JS.</p><p>ä¸ Cocos2d-HTML5 ä¸åŒçš„æ˜¯ï¼ŒCocos2d-js å¼€å‘çš„ç¨‹åºä¸ä»…èƒ½è¿è¡Œåœ¨æµè§ˆå™¨é‡Œï¼Œè¿˜èƒ½ç¼–è¯‘è¿è¡Œåœ¨ Mac OSX, Windows, iOS, Android å¹³å°ä¸Š.</p><p>ä» Cocos2d-x v3.7 ç‰ˆæœ¬ä¹‹å, js ç‰ˆæœ¬è¢«åˆå¹¶åˆ° Cocos2d-x ä¸­äº†.</p><p>å…·ä½“å¯ä»¥çœ‹ <a href="https://github.com/cocos2d/cocos2d-x/blob/cocos2d-x-3.7/docs/RELEASE_NOTES.md">Release Note</a> è¿™ä¸ªè¯´æ˜.</p><p>è¿™ä¸ªç‰ˆæœ¬çš„å‘å¸ƒæ—¥æœŸæ˜¯åœ¨2015å¹´7æœˆ21.</p><p>åŸæ¥çš„ Cocos2d-js ç‰ˆæœ¬åœ¨ [GitHub] ä¸Šé¢å·²ç»åœæ­¢æ›´æ–°äº†.</p><p>è¯´æ˜å¦‚ä¸‹:</p><blockquote><p>2&#x2F;27&#x2F;2016 - This repository is no longer active.<br>Cocos2d-JS was merged with Cocos2d-x starting at version 3.7.</p></blockquote><p>å¯ä»¥çœ‹å‡º, Cocos2d-js åŸæ¥ç‹¬ç«‹çš„é¡¹ç›®è¢«åˆå¹¶åˆ°äº† Cocos2d-x ä¸­äº†.</p><p>ç°åœ¨ä½¿ç”¨ Cocos2d-x ä¸ä»…å¯ä»¥åˆ›å»º cpp é¡¹ç›®å’Œ lua é¡¹ç›®, ä¹Ÿå¯ä»¥åˆ›å»º js é¡¹ç›®äº†.</p><p>å®˜æ–¹æœ‰è¯´æ˜çš„:</p><blockquote><p>Cocos2d-JS is Cocos2d-x engineâ€™s JavaScript version that includes Cocos2d-html5 and Cocos2d-x JavaScript Bindings.</p></blockquote><p>è‡³äºä»€ä¹ˆæ˜¯ Cocos2d-x JavaScript Bindings, å¤§å®¶è‡ªè¡Œ google, è¿™é‡Œä¸èµ˜è¿°.</p><p>å…³ç³»å›¾å¤§æ¦‚å¦‚ä¸‹:<br><img src="/upload/images/2017/05/14/3.png" alt="1"></p><p>Cocos2d-x æ¡†æ¶å›¾<br><img src="/upload/images/2017/05/14/4.jpg" alt="1"></p><h2 id="æ­å»º-Cocos2d-js-å¼€å‘ç¯å¢ƒ"><a href="#æ­å»º-Cocos2d-js-å¼€å‘ç¯å¢ƒ" class="headerlink" title="æ­å»º Cocos2d-js å¼€å‘ç¯å¢ƒ"></a>æ­å»º Cocos2d-js å¼€å‘ç¯å¢ƒ</h2><h4 id="1-ä¸‹è½½-Cocos2d-x"><a href="#1-ä¸‹è½½-Cocos2d-x" class="headerlink" title="1.ä¸‹è½½ Cocos2d-x"></a>1.ä¸‹è½½ Cocos2d-x</h4><p>å¯ä»¥åœ¨å®˜ç½‘ä¸‹è½½æœ€æ–°çš„ Release åŒ…, ç‚¹å‡» ä¸‹è½½åœ°å€, æˆ‘ä¸‹è½½çš„æœ€æ–°åŒ…æ˜¯ cocos2d-x-3.15.</p><p>ä¸‹è½½è§£å‹å³å¯, è¿™é‡Œæˆ‘æŠŠ cocos2d-x-3.15 ä¿®æ”¹ä¸º cocos2d-x.</p><h4 id="è®¾ç½®ç¯å¢ƒå˜é‡"><a href="#è®¾ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="è®¾ç½®ç¯å¢ƒå˜é‡"></a>è®¾ç½®ç¯å¢ƒå˜é‡</h4><p>åœ¨ cocos2d-x ç›®å½•, æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python setup.py</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå®Œæ¯•å, å¯ä»¥çœ‹åˆ° â€˜~&#x2F;.bash_profile&#96; çš„å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Add environment variable COCOS_CONSOLE_ROOT for cocos2d-x</span><br><span class="line">export COCOS_CONSOLE_ROOT=/Users/mark/workspace/mzProjs/c2dx/cocos2d-x/tools/cocos2d-console/bin</span><br><span class="line">export PATH=$COCOS_CONSOLE_ROOT:$PATH</span><br><span class="line"># Add environment variable COCOS_TEMPLATES_ROOT for cocos2d-x</span><br><span class="line">export COCOS_TEMPLATES_ROOT=/Users/mark/workspace/mzProjs/c2dx/cocos2d-x/templates</span><br><span class="line">export PATH=$COCOS_TEMPLATES_ROOT:$PATH</span><br></pre></td></tr></table></figure><p>è¿™é‡Œ, æ²¡æœ‰çœ‹åˆ°æˆ‘çš„ <code>ANT_ROOT</code> è·¯å¾„, å…¶å®è¯¥è„šæœ¬æ™ºèƒ½çš„æ‰¾åˆ° <code>/usr/local/Cellar/ant/1.9.7/bin</code>, ä½†æ˜¯æˆ‘ä¸æƒ³ä½¿ç”¨è¿™ä¸ª ant, æƒ³ä½¿ç”¨è‡ªå·±ä¸‹è½½çš„ ant, ä¿®æ”¹è¯¥æ–‡ä»¶å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># Add environment variable COCOS_CONSOLE_ROOT for cocos2d-x</span><br><span class="line">export COCOS_CONSOLE_ROOT=/Users/mark/workspace/mzProjs/c2dx/cocos2d-x/tools/cocos2d-console/bin</span><br><span class="line">export PATH=$COCOS_CONSOLE_ROOT:$PATH</span><br><span class="line"># Add environment variable ANT_ROOT for cocos2d-x</span><br><span class="line">export ANT_ROOT=/Users/mark/developer/apache/apache-ant-1.10.1/bin</span><br><span class="line">export PATH=$ANT_ROOT:$PATH</span><br><span class="line"># Add environment variable COCOS_TEMPLATES_ROOT for cocos2d-x</span><br><span class="line">export COCOS_TEMPLATES_ROOT=/Users/mark/workspace/mzProjs/c2dx/cocos2d-x/templates</span><br><span class="line">export PATH=$COCOS_TEMPLATES_ROOT:$PATH</span><br></pre></td></tr></table></figure><p>æœ€åæ‰§è¡Œ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bash_profile</span><br></pre></td></tr></table></figure><p>ä½¿ç¯å¢ƒå˜é‡ç«‹å³ç”Ÿæ•ˆ.</p><h4 id="åˆ›å»º-js-å·¥ç¨‹"><a href="#åˆ›å»º-js-å·¥ç¨‹" class="headerlink" title="åˆ›å»º js å·¥ç¨‹"></a>åˆ›å»º js å·¥ç¨‹</h4><p>cd åˆ°ä»»æ„ç›®å½•, æ‰§è¡Œ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cocos new HelloJs -l js -d .</span><br></pre></td></tr></table></figure><blockquote><p>new HelloJs è¡¨ç¤ºå·¥ç¨‹åå­—ä¸º HelloJs<br>-l js è¡¨ç¤ºåˆ›å»º js å·¥ç¨‹.<br>-d . è¡¨ç¤ºåœ¨å½“å‰è·¯å¾„åˆ›å»ºè¯¥å·¥ç¨‹</p></blockquote><p>å¯ä»¥çœ‹åˆ°ä¸‹é¢åˆ›å»ºå·¥ç¨‹çš„è¿‡ç¨‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Copy template into /Users/mark/workspace/mzProjs/c2dx/works/HelloJs</span><br><span class="line">Copying directory from cocos root directory...</span><br><span class="line">Copying files from template directory...</span><br><span class="line">Copying Cocos2d-x files...</span><br><span class="line">Rename project name from &#x27;HelloJavascript&#x27; to &#x27;HelloJs&#x27;</span><br><span class="line">Replace the project name from &#x27;HelloJavascript&#x27; to &#x27;HelloJs&#x27;</span><br><span class="line">Replace the project package name from &#x27;org.cocos2dx.hellojavascript&#x27; to &#x27;org.cocos2dx.HelloJs&#x27;</span><br><span class="line">Replace the Mac bundle id from &#x27;org.cocos2dx.hellojavascript&#x27; to &#x27;org.cocos2dx.HelloJs&#x27;</span><br><span class="line">Replace the iOS bundle id from &#x27;org.cocos2dx.hellojavascript&#x27; to &#x27;org.cocos2dx.HelloJs&#x27;</span><br></pre></td></tr></table></figure><p>å·¥ç¨‹ç›®å½•:<br><img src="/upload/images/2017/05/14/1.jpg" alt="1"></p><h4 id="å·¥ç¨‹å‘å¸ƒ"><a href="#å·¥ç¨‹å‘å¸ƒ" class="headerlink" title="å·¥ç¨‹å‘å¸ƒ"></a>å·¥ç¨‹å‘å¸ƒ</h4><p>å°†ä¸Šé¢çš„å·¥ç¨‹ç¼–è¯‘å‘å¸ƒ.</p><p>ç¼–è¯‘å‘å¸ƒ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cocos compile -p web -m release</span><br></pre></td></tr></table></figure><blockquote><p>-p web è¡¨ç¤ºç¼–è¯‘ web å¹³å°.<br>-m release è¡¨ç¤ºç¼–è¯‘ä¸º release æ¨¡å¼.</p></blockquote><p>ç¼–è¯‘è¾“å‡º:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Building mode: release</span><br><span class="line">running: &#x27;/Users/mark/developer/apache/apache-ant-1.10.1/bin/ant -f /Users/mark/workspace/mzProjs/c2dx/works/HelloJs/publish/html5/build.xml&#x27;</span><br><span class="line">Buildfile: /Users/mark/workspace/mzProjs/c2dx/works/HelloJs/publish/html5/build.xml</span><br><span class="line">compile:</span><br><span class="line">   [jscomp] Compiling 156 file(s) with 42 extern(s)</span><br><span class="line">   [jscomp] 0 error(s), 0 warning(s)</span><br><span class="line">BUILD SUCCESSFUL</span><br><span class="line">Total time: 8 seconds</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ åœ¨è¿™ä¸€æ­¥ç¼–è¯‘æŠ¥é”™, æˆ–è€…æ‰§è¡Œä¸ä¸‹å», ä¸€èˆ¬éƒ½æ˜¯æ²¡æœ‰åœ¨ç¯å¢ƒå˜é‡ä¸­é…ç½®å¥½ ant.</p><p>ç¼–ç¨‹æˆåŠŸå, ä¼šå¤šå‡º publish ç›®å½•:<br><img src="/upload/images/2017/05/14/2.jpg" alt="1"></p><h4 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h4><p>æ‰§è¡Œ cocos run å‘½ä»¤æ¥åœ¨ç³»ç»Ÿé»˜è®¤çš„æµè§ˆå™¨ä¸Šé¢è¿è¡Œ.</p><p>cd åˆ°å·¥ç¨‹ç›®å½•, æ‰§è¡Œ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cocos run -p web -s . --port 9009</span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¼šå¸®æˆ‘ä»¬åœ¨æœ¬åœ°å¯åŠ¨ä¸€ä¸ª webServer æ¥è¿è¡Œç¤ºä¾‹, ç›´æ¥æ‰“å¼€äº†é»˜è®¤ä½¿ç”¨çš„æµè§ˆå™¨.</p><blockquote><p>-s: è¡¨ç¤ºå½“å‰éœ€è¦æ‰§è¡Œçš„æºç è·¯å¾„<br>â€“port: æŒ‡å®šç«¯å£, å¦‚æœä¸æŒ‡å®šç«¯å£, é»˜è®¤åœ¨ 8000 ç«¯å£æ‰§è¡Œ.</p></blockquote><p>æ›´å¤š cocos run å‘½ä»¤å¯ä»¥, ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥æŸ¥çœ‹å¸®åŠ©:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cocos run --help</span><br></pre></td></tr></table></figure><h2 id="æœ¬åœ°è¿è¡Œ-index-html-çš„é—®é¢˜"><a href="#æœ¬åœ°è¿è¡Œ-index-html-çš„é—®é¢˜" class="headerlink" title="æœ¬åœ°è¿è¡Œ index.html çš„é—®é¢˜"></a>æœ¬åœ°è¿è¡Œ index.html çš„é—®é¢˜</h2><p>ä½ å¯ä»¥ç”¨ç«ç‹æµè§ˆå™¨(FireFox)æ‰“å¼€æœ¬åœ°å·¥ç¨‹ç›®å½•ä¸­çš„ index.html, å³å¯çœ‹åˆ°è¿è¡Œæ•ˆæœäº†.<br>FireFox åº”è¯¥æ˜¯åœ¨æœ¬åœ°å¯åŠ¨äº†ä¸€ä¸ª WebServer æ¥è¿è¡Œ.</p><p>åœ¨ chrome ä¸­ç›´æ¥è¿è¡Œ index.html, æ— æ³•çœ‹åˆ°æœ€ç»ˆæ•ˆæœ, ä¸€ç›´å¡åœ¨ loading ç•Œé¢.</p><p>æ‰“å¼€ inspect, å¯ä»¥çœ‹åˆ°æŠ¥é”™ä¿¡æ¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">XMLHttpRequest cannot load file:/xx/publish/html5/project.json.</span><br><span class="line">Cross origin requests are only supported for protocol schemes: http, data, chrome, chrome-extension, https.</span><br></pre></td></tr></table></figure><p>ç½‘ä¸Šæœ‰äººè®¨è®ºè¿‡è¿‡é—®é¢˜, è¯´æ˜¯ chrome è·¨åŸŸä¸æ”¯æŒ file åè®®ï¼Œé‚£ä¹ˆå³ä½¿ä½ å…è®¸ chrome è·¨åŸŸæ”¯æŒ, ç›´æ¥è¿è¡Œæœ¬åœ°çš„ index.html è¿˜æ˜¯æŠ¥é”™:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">game.min.js:54 Uncaught TypeError: Cannot read property &#x27;modules&#x27; of null</span><br></pre></td></tr></table></figure><p>åœ¨ MacOS ä¸Šé¢å…è®¸ chrome è·¨åŸŸè®¿é—®æ–‡ä»¶çš„æ–¹æ³•:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open /Applications/Google\ Chrome.app --args --allow-file-access-from-files</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡º, åœ¨è¿™æ–¹é¢, FireFox åšçš„æ¯” chrome å¥½.</p><h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><blockquote><p>æ›´æ–°æ—¶é—´ 2017-10-15</p></blockquote><p>åœ¨å¾®ä¿¡å…¬ä¼—å·ä¸Šé¢çœ‹åˆ° <a href="https://mp.weixin.qq.com/s?__biz=MjM5ODAxNTM2NA==&mid=2659646056&idx=1&sn=239871c3775ae12af5edf9ac2381b0b2">ä¸€æ‹›æ•™ä½ è¾¨åˆ« Cocosã€Cocos2dã€Cocos2d-x</a> è¿™ç¯‡æ–‡ç« , å¤§å®¶å¯ä»¥çœ‹çœ‹, å¯¹ cocos ä¼šæœ‰æ›´åŠ æ·±å…¥çš„äº†è§£.</p>]]></content>
      
      
      <categories>
          
          <category> Game </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cocos cocos2d-js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°å°ç¯®çƒé˜Ÿ</title>
      <link href="/2017/04/29/%E5%B0%8F%E5%B0%8F%E7%AF%AE%E7%90%83%E9%98%9F/"/>
      <url>/2017/04/29/%E5%B0%8F%E5%B0%8F%E7%AF%AE%E7%90%83%E9%98%9F/</url>
      
        <content type="html"><![CDATA[<p><img src="/upload/images/2017/04/29/hua.jpeg" alt="1"></p><p>ç¯®çƒ, æˆ‘æœ€å–œæ¬¢çš„ä¸€é¡¹ä½“è‚²è¿åŠ¨, å¤§å­¦çš„ä¸šä½™æ—¶é—´åŸºæœ¬éƒ½â€æ³¡â€åœ¨çƒåœº, å‹æ ¹ä¸çŸ¥é“ä»€ä¹ˆæ˜¯ç´¯.</p><p>æ¯•ä¸šåçš„ç¬¬ä¸€ä»½å·¥ä½œ, åšçš„æ¯”è¾ƒå¼€å¿ƒ, å¤§å®¶å¹´é¾„ç›¸ä»¿, å…´è¶£ç›¸æŠ•.</p><p>å°å°çš„å›¢é˜Ÿ, æ²¡æœ‰ä»»ä½•çº·äº‰, å¤§å®¶äº’ç›¸å­¦ä¹ , æ°›å›´åŠå…¶èæ´½.</p><p>æ¯ä¸ªå‘¨äº”æˆ‘ä»¬å‡ ä¸ªäººéƒ½ä¼šæå‰ä¸‹ç­å»æ‰“ä¸€åœºç¯®çƒ, å®Œäº‹å, ä¸€èµ·å–ç‚¹å°é…’, é‚£æ—¥å­ç”­ææœ‰å¤šä»–NNDçš„æƒ¬æ„.</p><p>å…¬å¸è§£æ•£å, å¤§å®¶å„å¥”ä¸œè¥¿, äº‹è¿‡å¢ƒè¿, å„æœ‰å„çš„å·¥ä½œå’Œç”Ÿæ´», èšåœ¨ä¸€èµ·çš„æ—¥å­ä¹Ÿæ˜¯å°‘ä¹‹åˆå°‘, ä»¥å‰çš„æ—¥å­åªèƒ½æ€€å¿µäº†.</p><p>äººæ€»éœ€è¦ä¸€äº›éå·¥ä½œä¹‹å¤–çš„å…´è¶£, æ•´å¤©å›´ç»•ç€å·¥ä½œ, æ—©æ™šéƒ½ä¼šç–¯æ‰.</p><p>æœ‰äº›äººå–œæ¬¢æ³¡æ³¡å›¾ä¹¦é¦†, æœ‰äº›äººå–œæ¬¢æ‰“æ‰“æ¸¸æˆ, æœ‰äº›äººå–œæ¬¢è·‘è·‘æ­¥, æœ‰äº›äººå–œæ¬¢å”±å”±æ­Œâ€¦</p><p>ä¸ç®¡æ€ä¹ˆæ ·, ä½ éœ€è¦æŸç§çˆ±å¥½, æ¥æ¶¦è‰²ä¸€ä¸‹ä½ çš„ç”Ÿæ´», æˆ‘é€‰æ‹©äº†ç¯®çƒè¿åŠ¨.</p><p>ä¸‹é¢, æ¥è¯´è¯´ç¯®çƒé˜Ÿä¸­å…¸å‹çš„å‡ ç§äºº, å¤§å®¶ç»“åˆè‡ªå·±çš„å·¥ä½œå’Œç”Ÿæ´», æ€è€ƒä¸€ä¸‹å§~</p><h2 id="å•æ‰“ç‹¬æ–—"><a href="#å•æ‰“ç‹¬æ–—" class="headerlink" title="å•æ‰“ç‹¬æ–—"></a>å•æ‰“ç‹¬æ–—</h2><p>ç¯®çƒè¿åŠ¨æ˜¯ä¸€é¡¹é›†ä½“è¿åŠ¨, éœ€è¦æ¯ä¸ªäººå‘æŒ¥è‡ªå·±åº”æœ‰çš„æ°´å¹³, æ‰èƒ½å‘æŒ¥å›¢é˜Ÿçš„åŠ›é‡.</p><p>æœ‰äº›äººå–œæ¬¢å•æ‰“ç‹¬æ–—, å®Œå…¨ä¸è€ƒè™‘å›¢é˜Ÿä¸­å…¶ä»–æˆå‘˜çš„æ„Ÿå—, åªè¦çƒåˆ°äº†ä»–æ‰‹ä¸­, å…¶ä»–äººåªèƒ½çœ‹ä»–çš„è¡¨æ¼”, ä»»å‡­ä½ å–Šç ´å—“å­, ä»–ä¹Ÿä¸ä¼šç†ä½ .</p><p>è¿™ç§äºº, å…¶å®æ˜¯æœ‰ä¸€å®šèƒ½åŠ›çš„äºº, ä¸ç„¶ä¹Ÿä¸ä¼šä¹Ÿä¸å¯èƒ½è¿™ä¹ˆåš, åªæ˜¯ä»–ä»¬è§‰å¾—å‡­ä¸€å·±ä¹‹åŠ›å°±å¯ä»¥è®©å¤§å®¶é«˜æ­£æ— å¿§äº†, è‡ªå·±æ²¡æœ‰æ€è€ƒè¿‡è¿™æ ·åšæ˜¯ä¸æ˜¯æœ€åˆé€‚çš„.</p><p>ä¹…è€Œä¹…ä¹‹, å¤§å®¶çœ‹ç€ä»–çš„â€è¡¨æ¼”â€, å†ä¹Ÿä¸æƒ³å‘æŒ¥äº†, å•æ‰“ç‹¬æ–—çš„äººæ…¢æ…¢çš„ä¹Ÿç´¯äº†, æœ€åå¤§å®¶éƒ½èº«å¿ƒç–²æƒ«, çƒé˜Ÿè¢«å¯¹æ–¹è½»è€Œæ˜“ä¸¾åœ°æ‰“è´¥.</p><h2 id="â€œæŒ‡æŒ¥å®˜â€"><a href="#â€œæŒ‡æŒ¥å®˜â€" class="headerlink" title="â€œæŒ‡æŒ¥å®˜â€"></a>â€œæŒ‡æŒ¥å®˜â€</h2><p>çƒé˜Ÿä¸­æœ‰ä¸€ç§äºº, è‡ªå·±ä¸åŠªåŠ›, æ€»æ˜¯å–œæ¬¢é¢æŒ‡æ°”ä½¿, ç»å¸¸å¬åˆ°ä»–ä»¬è¯´è¿™æ ·çš„è¯:</p><blockquote><p>ä½ å¿«ç‚¹è·‘å‘€, ç§¯æç‚¹â€¦<br>æ­»æ­»åœ°é˜²ç€ä»–, ä¸è¦è®©ä»–è¿›æ”», å¿«â€¦<br>ä½ ä¼ çƒç»™æˆ‘å‘€, è®©ä½ åˆ«ç€æ€¥, å¥½äº†å§, è¾“äº†å§â€¦<br>è¾“äº†, éƒ½æ€ªä½ â€¦</p></blockquote><p>å¬åˆ°è¿™äº›è¯, å†å¥½è„¾æ°”çš„äººä¼°è®¡éƒ½éš¾ä»¥æ¥å—, è„¾æ°”ä¸å¥½çš„ç›´æ¥å¼€å§‹æ‰“ä»–äº†å§!</p><p>è¿™ç§äººæœ€ä¸å—å¾…è§, ä¹Ÿæœ€é­äººå”¾éª‚, è¿™ç§äººåœ¨å®é™…å·¥ä½œä¸­, å¯èƒ½æ˜¯ä½ çš„é¢†å¯¼.</p><h2 id="å·æ‡’çš„"><a href="#å·æ‡’çš„" class="headerlink" title="å·æ‡’çš„"></a>å·æ‡’çš„</h2><p>ç¯®çƒè¿åŠ¨çš„ç¡®å¾ˆæ¶ˆè€—ä½“åŠ›, å¦‚æœåœ¨ä¸‡ç®­é½å‘çš„æ—¶åˆ», æœ‰äººæ•…æ„æ‰é“¾å­, é‚£å°†æ˜¯åŠŸäºä¸€ç¯‘.</p><p>å¤§å®¶åœ¨æ‰“çƒçš„æ—¶å€™, éƒ½åœ¨ä¸ºâ€è£èª‰â€è€Œæˆ˜, ä½†æ˜¯ååæœ‰äººä¼šä½¿ç‚¹å°å¿ƒçœ¼, èƒ½å°‘è·‘ä¸€æ­¥å°±å°‘è·‘ä¸€æ­¥, èƒ½æ”¾å¯¹æ–¹èµ°å°±æ”¾å¯¹æ–¹èµ°, ç»å¯¹ä¸ä¼¤å®³å¯¹æ–¹ä¸€æ¯›ä¸€çº¿. æ˜æ˜å¯ä»¥ç¨å¾®åŠªåŠ›ä¸€ä¸‹, å°±å¯ä»¥æ‹¿åˆ°ç¯®æ¿, ååè®©å¯¹æ–¹æ¯”è‡ªå·±è¿˜çŸ®å°çš„è½»è€Œæ˜“ä¸¾çš„æ‹¿èµ°äº†ç¯®æ¿.</p><p>è¦çŸ¥é“æ¯”è‡ªå·±çŸ®å°çš„é‚£ä¸ªäºº, åªæ˜¯åŠªåŠ›çš„è·³äº†ä¸€ä¸‹.</p><p>çƒåœºä¸Šè™½ç„¶ä¸æ˜¯è®©ä½ æ‹¼ä¸ªä½ æ­»æˆ‘æ´», ä¸è¦æ±‚ä½ å…¨åŠ›ä»¥èµ´, ä½†æ˜¯å°½åŠ›è€Œä¸ºæ€»æ˜¯è¦æœ‰çš„, è¿™æ˜¯ä¸€ç§æ€åº¦.</p><p>åœ¨å®é™…å·¥ä½œä¸­, è¿™ç§â€é˜Ÿå‹â€æ¯”æ¯”çš†æ˜¯, ä½†æ˜¯ä¸ä¸€å®šé­äººæ¨, æœ‰äº›è¿˜æ˜¯å¾ˆæ‹›äººå–œæ¬¢çš„, æ¯•ç«Ÿä»–ä»¬æ²¡æœ‰æŠ¢ä½ çš„åŠŸåŠ³, å¤„å¤„è®©ç€ä½ , æ²¡æœ‰ä»–ä»¬çš„è¿™äº›æ‰€è°“çš„ä»˜å‡º, å“ªèƒ½è¡¬æ‰˜å‡ºä½ çš„å…‰èŠ’.</p><h2 id="é¼“åŠ±ä½ çš„"><a href="#é¼“åŠ±ä½ çš„" class="headerlink" title="é¼“åŠ±ä½ çš„"></a>é¼“åŠ±ä½ çš„</h2><p>ä¸Šé¢è¯´çš„éƒ½æ˜¯ä¸€äº›â€è´Ÿèƒ½é‡â€, å¤§å®¶ä¸€ç¬‘è€Œè¿‡å§.ä¸‹é¢è¯´ç‚¹æ­£èƒ½é‡çš„.</p><p>åœ¨çƒé˜Ÿä¸­, è¿˜æœ‰ä¸€ç§è¿™æ ·çš„äºº, ä»–ä¼šå¯Ÿè¨€è§‚è‰², è§‰å¾—ä½ ç´¯äº†, å°±å‘Šè¯‰å¤§å®¶: â€œæˆ‘ä»¬åº”è¯¥èŠ‚å¥æ…¢ä¸€ç‚¹, ç¼“å†²ä¸€ä¸‹.â€,</p><p>å½“ä½ æ‰‹æ„Ÿä¸å¥½çš„æ—¶å€™, ä»–ä¼šå‘Šè¯‰ä½ , æ²¡äº‹, å¤šæ¥å‡ æ¬¡å°±å¥½äº†, ä¸è¦æœ‰å‹åŠ›.</p><p>å½“ä½ é˜²å®ˆé‡åˆ°å›°éš¾æ—¶, ä»–ä¼šé»˜é»˜çš„ç»™ä½ è¡¥é˜², ç»™ä½ æ¥åŠ›, æœ€å¤§ç¨‹åº¦çš„ç»™ä½ ä¿¡å¿ƒ.</p><p>å½“å¤§å®¶å£«æ°”ä¸é«˜çš„æ—¶å€™, ä»–ä¼šç«™å‡ºæ¥æŠ•å‡ ä¸ªæ¼‚äº®çš„çƒ, æŠ‘æˆ–ç»™å¯¹æ–¹ä¸€ä¸ªå®Œç¾çš„ç›–å¸½, å¹¶ä¸”é¼“åŠ±å¤§å®¶ä¸è¦æ”¾å¼ƒ, ç»™å¤§å®¶ä¿¡å¿ƒ, åšå¤§å®¶åšå›ºçš„åç›¾.</p><p>è¿™ç§äººé™¤äº†è‡ªå·±æœ‰ä¸€å®šçš„èƒ½åŠ›å¤–, è¿˜èƒ½é¡¾å…¨å¤§å±€, å¹¶ä¸”å¯ä»¥å¸®åŠ©é˜Ÿå‹, å¸®åŠ©å›¢é˜Ÿæ¸¡è¿‡éš¾å…³, ç¡®å®éš¾å¾—.</p><h2 id="æ¸´æœ›è¿›æ­¥çš„"><a href="#æ¸´æœ›è¿›æ­¥çš„" class="headerlink" title="æ¸´æœ›è¿›æ­¥çš„"></a>æ¸´æœ›è¿›æ­¥çš„</h2><p>çƒé˜Ÿä¸­, å­˜åœ¨ä¸€äº›æ–°äºº, æˆ–è€…æ˜¯æ¸´æœ›è‡ªå·±èƒ½æŠ•å‡ºæ¼‚äº®å¼§çº¿çƒçš„äºº, ä»–ä»¬æ¯”ä¸ä¸Šé‚£äº›èµ„å†è€ä¸”ç»éªŒä¸°å¯Œçš„å‰è¾ˆ, ä½†æ˜¯ä»–ä»¬å†…å¿ƒæœ‰ä¸€ä»½ä¿¡å¿µ: â€œæˆ‘è¦å˜å¼º!â€.</p><p>è¿™ç§äºº, è·Ÿä½ è®¨è®ºçƒæŠ€, è™šå¿ƒå‘ä½ å­¦ä¹ ä¸€åˆ‡å¯ä»¥æé«˜çƒæŠ€çš„æ–¹æ³•, å³ä½¿åœ¨è§‚ä¼—å¸­ä¸Š, ä»–ä»¬ä¹Ÿèƒ½èšç²¾ä¼šç¥çš„è§‚çœ‹, è‡ªå·±é¢†æ‚Ÿå…¶ä¸­çš„å¥¥å¦™. åªè¦ä½ çº¦ä»–å‡ºæ¥æ‰“çƒ, ä»–éƒ½åœ¨ç¬¬ä¸€æ—¶é—´å‡ºç°åœ¨çƒåœº, å› ä¸ºä»–ä¸æƒ³æ”¾å¼ƒå­¦ä¹ çš„æœºä¼š.</p><p>ä¹…è€Œä¹…ä¹‹, è¿™äº›äººä¼šå˜å¾—è¶Šæ¥è¶Šå‰å®³, é€šè¿‡ä¸æ–­çš„å­¦ä¹ å’Œæ‘¸ç´¢, æœ‰äº†ä¸€å¥—è‡ªå·±çš„æ‰“æ³•, æ­¥ä¼ç¨³å¥, å†ä¹Ÿä¸æ˜¯é‚£ç§æ¥çƒä¸ç¨³, ä¼ çƒé¢‘é¢‘å¤±è¯¯çš„â€æ¯›å¤´å°å­â€äº†.</p><p>è¿™ç§äºº, å€¼å¾—æˆ‘ä»¬å»æŒ–æ˜å’Œé¼“åŠ±, å¦‚æœä½ æ­£å¥½æ˜¯é‚£ä¸ªèµ„å†è€ä¸”ç»éªŒä¸°å¯Œçš„å‰è¾ˆ, å°±ä¼ æˆâ€çœŸç»â€ç»™ä»–ä»¬å§.<br>å¯¹äºä½ æ¥è¯´, æœ‰äººæ„¿æ„è·Ÿä½ å­¦ä¹ , è·Ÿä½ åˆ†äº«, ä¹Ÿæ˜¯ç¾äº‹ä¸€æ¡©.</p><p>ä½•ä¹è€Œä¸ä¸ºå‘¢?</p><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>ä¸ç®¡ä½ é‡åˆ°ä»€ä¹ˆæ ·çš„é˜Ÿå‹, å¦‚æœä½ æ„¿æ„, è¯·èƒ¸æ€€å®‡å®™(å½“ç„¶ä¸æ˜¯ å­™è¿åŸ é‚£ç§å•Š).</p><p>ä¸‡äº‹ä¸‡ç‰©çš†æœ‰è”ç³», æ„¿ä½ èƒ½å¶å°”æ”¾ä¸‹æ‰‹ä¸­çš„å·¥ä½œ, å»é€‰æ‹©å’Œçˆ±ä¸Šå¦ä¸€ç§ä¹è¶£.</p><p>äº”ä¸€æ”¾å‡äº†, ç¥å¤§å®¶èŠ‚æ—¥å¿«ä¹!</p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç”Ÿæ´» æ€è€ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS: åº”ç”¨å†…æ‰“å¼€ AppStore</title>
      <link href="/2017/04/15/iOS-%E5%BA%94%E7%94%A8%E5%86%85%E6%89%93%E5%BC%80-AppStore/"/>
      <url>/2017/04/15/iOS-%E5%BA%94%E7%94%A8%E5%86%85%E6%89%93%E5%BC%80-AppStore/</url>
      
        <content type="html"><![CDATA[<h2 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h2><p>æˆ‘ä»¬çš„ App éœ€è¦åœ¨ AppStore ä¸Šé¢æ‰“å¼€æŸä¸ª App æˆ–è€…æ¸¸æˆ, ç›®çš„æœ€å¸¸è§çš„æœ‰:</p><blockquote><p>1.è¯„åˆ†è¯„è®º.<br>2.æ¨èä¸‹è½½(App æˆ–è€…æ¸¸æˆ).</p></blockquote><p>å¾ˆå¤šå¼€å‘è€…çŸ¥é“æ‰“å¼€ AppStore åªéœ€è¦ä¸€å¥ä»£ç :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@&quot;itunes app url&quot;]];</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¾ˆç®€å•çš„æ‰“å¼€ AppStore äº†, ä½†æ˜¯äº§å“ç»ç†é—®äº†, èƒ½åœ¨æˆ‘ä»¬åº”ç”¨å†…æ‰“å¼€ AppStore å—?</p><p>ä½ å½“æ—¶æ‡µé€¼äº†å—?</p><p>ä¸è¦æ‡µé€¼, ä»¥ååªè¦é‡åˆ°ç±»ä¼¼è¿™ç§é—®é¢˜, ä½ å°±é—®äº§å“ç»ç†å“ªä¸ª APP è¿™æ ·åšäº†?<br>ç„¶å, ä»–å°±ç»™ä½ çœ‹åˆ«äººå®¶çš„æ•ˆæœ, ä½ å°±ç†ç›´æ°”å£®åœ°è¯´: â€œåˆ«äººå¯ä»¥åšåˆ°çš„, æˆ‘ä»¬ä¹Ÿå¯ä»¥åšåˆ°!â€.</p><p>åº”ç”¨å†…æ‰“å¼€ AppStore ä¹Ÿå¾ˆç®€å•.<br>åœ¨ iOS6ä¹‹å, è‹¹æœå·²ç»ç»™æˆ‘ä»¬æä¾›äº† <a href="https://developer.apple.com/reference/storekit/skstoreproductviewcontroller#//apple_ref/doc/c_ref/SKStoreProductViewController">SKStoreProductViewController</a>, å¤§å®¶çœ‹ä¸€ä¸‹æ–‡æ¡£, ä½ å°±ç¬‘äº†.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SKStoreProductViewController</span><br><span class="line">/* View controller to display iTunes Store product information */</span><br></pre></td></tr></table></figure><h2 id="åº”ç”¨å†…æ‰“å¼€-AppStore"><a href="#åº”ç”¨å†…æ‰“å¼€-AppStore" class="headerlink" title="åº”ç”¨å†…æ‰“å¼€ AppStore"></a>åº”ç”¨å†…æ‰“å¼€ AppStore</h2><p>è¿™é‡Œæˆ‘ä»¥åœ¨åº”ç”¨å†…æ‰“å¼€ <code>å¾®ä¿¡</code> ä¸ºä¾‹å­.</p><p>æ•ˆæœå›¾å¦‚ä¸‹:<br><img src="/upload/images/2017/04/15/eff_appstore_1.png" alt="1"></p><p>ä»æ•ˆæœå›¾å¯ä»¥çœ‹å‡º, ç”¨æˆ·åœ¨è‡ªå·±çš„åº”ç”¨å†…æ‰“å¼€ AppStore å, ä¸ä»…å¯ä»¥ä¸‹è½½æˆ–è€…æ‰“å¼€å¾®ä¿¡, è¿˜å¯ä»¥ç›´æ¥è¯„è®ºè¯„åˆ†, ç®€ç›´çˆ½(ä¹Ÿéš¾æ€ªäº§å“ç»ç†è¿™ä¹ˆå¹²).</p><p>é‚£æˆ‘ä»¬è¯´ä¸€ä¸‹å¦‚ä½•å®ç°ä¸Šé¢çš„æ•ˆæœ.</p><p>å®ç°æ–¹æ¡ˆå’Œæ­¥éª¤</p><p>1.åŒ…å«å¤´æ–‡ä»¶ <code>#import &lt;StoreKit/StoreKit.h&gt;</code></p><p>2.å®ç° <code>SKStoreProductViewControllerDelegate</code></p><p>å…·ä½“ä»£ç :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">- (void)openAppFromAppStore:(NSString *)appid</span><br><span class="line">&#123;</span><br><span class="line">if (nil == appid || appid.length &lt;= 0) &#123;</span><br><span class="line">return;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// åŠ ä¸ª loading</span><br><span class="line"></span><br><span class="line">SKStoreProductViewController *store = [[SKStoreProductViewController alloc] init];</span><br><span class="line">    </span><br><span class="line">    store.delegate = self;</span><br><span class="line">    </span><br><span class="line">    NSDictionary&lt;NSString *, id&gt; *parameters = @&#123;SKStoreProductParameterITunesItemIdentifier: appid&#125;;</span><br><span class="line"></span><br><span class="line">    [store loadProductWithParameters:parameters completionBlock:^(BOOL result, NSError *error) &#123;</span><br><span class="line">    </span><br><span class="line">        // ç»“æŸ loading</span><br><span class="line">        </span><br><span class="line">        if (error) &#123;</span><br><span class="line">            </span><br><span class="line">            NSLog(@&quot;error %@ with userInfo %@&quot;, error, [error userInfo]);</span><br><span class="line">            </span><br><span class="line">            // æç¤ºç”¨æˆ·å‘ç”Ÿäº†é”™è¯¯</span><br><span class="line">            </span><br><span class="line">            // æˆ–è€…é€šè¿‡ URL æ‰“å¼€ AppStore App.</span><br><span class="line">            </span><br><span class="line">            // NSString *url = @&quot;https://itunes.apple.com/in/app/wechat/id414478124?mt=8&quot;;</span><br><span class="line">            </span><br><span class="line">            //[[UIApplication sharedApplication] openURL:[NSURL URLWithString:url]];</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">            </span><br><span class="line">            [self presentViewController:store animated:YES completion:^&#123;</span><br><span class="line">            &#125;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line">/// ç”¨æˆ·ç‚¹å‡»å–æ¶ˆä¼šæ‰§è¡Œè¯¥æ–¹æ³•</span><br><span class="line">- (void)productViewControllerDidFinish:(SKStoreProductViewController *)viewController</span><br><span class="line">&#123;</span><br><span class="line">    [viewController dismissViewControllerAnimated:YES completion:^&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨(@â€414478124â€ æ˜¯ å¾®ä¿¡ çš„)æ–¹å¼:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[self openAppFromAppStore:@&quot;414478124&quot;];</span><br></pre></td></tr></table></figure><h2 id="ä¿®æ”¹-AppStore-çš„å¯¼èˆªæ "><a href="#ä¿®æ”¹-AppStore-çš„å¯¼èˆªæ " class="headerlink" title="ä¿®æ”¹ AppStore çš„å¯¼èˆªæ "></a>ä¿®æ”¹ AppStore çš„å¯¼èˆªæ </h2><p>äº§å“ç»ç†è¯´, æ—¢ç„¶ä½ å·²ç»å®ç°äº†ä¸Šé¢çš„åŠŸèƒ½, çœ‹çœ‹èƒ½ä¸èƒ½æŠŠ AppStore çš„å¯¼èˆªæ æ”¹ä¸€ä¸ªç‰›é€¼çš„é¢œè‰², å°±åƒä¸Šé¢çš„å¤§çº¢è‰².</p><p>~</p><p>å¯ä»¥, å¹²!</p><p>ç›´æ¥ä¸Šä»£ç :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">- (void)openAppFromAppStore:(NSString *)appid</span><br><span class="line">&#123;</span><br><span class="line">if (nil == appid || appid.length &lt;= 0) &#123;</span><br><span class="line">return;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// åŠ ä¸ª loading</span><br><span class="line"></span><br><span class="line">// å¯¼èˆªæ ä¸Šé¢çš„æ–‡å­—å’Œå›¾ç‰‡é¢œè‰²å˜äº†</span><br><span class="line">[[UINavigationBar appearance] setTintColor:[UIColor greenColor]];</span><br><span class="line">    </span><br><span class="line">    // å¯¼èˆªæ çš„å¤§çº¢è‰²å‡ºæ¥äº†</span><br><span class="line">    [[UINavigationBar appearance] setBarTintColor:[UIColor redColor]];</span><br><span class="line">    </span><br><span class="line">    [UINavigationBar appearanceWhenContainedIn:[SKStoreProductViewController class], nil];</span><br><span class="line"></span><br><span class="line">SKStoreProductViewController *store = [[SKStoreProductViewController alloc] init];</span><br><span class="line">    </span><br><span class="line">    store.delegate = self;</span><br><span class="line">    </span><br><span class="line">    NSDictionary&lt;NSString *, id&gt; *parameters = @&#123;SKStoreProductParameterITunesItemIdentifier: appid&#125;;</span><br><span class="line"></span><br><span class="line">    [store loadProductWithParameters:parameters completionBlock:^(BOOL result, NSError *error) &#123;</span><br><span class="line">        </span><br><span class="line">        // ç»“æŸ loading</span><br><span class="line">        </span><br><span class="line">        if (error) &#123;</span><br><span class="line">            </span><br><span class="line">            NSLog(@&quot;error %@ with userInfo %@&quot;, error, [error userInfo]);</span><br><span class="line">            </span><br><span class="line">            // æç¤ºç”¨æˆ·å‘ç”Ÿäº†é”™è¯¯</span><br><span class="line">            </span><br><span class="line">            // æˆ–è€…é€šè¿‡ URL æ‰“å¼€ AppStore App.</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">            </span><br><span class="line">            [self presentViewController:store animated:YES completion:^&#123;</span><br><span class="line">            &#125;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><p>1.æ‰“å¼€ <code>SKStoreProductViewController</code> ç›®å‰åªèƒ½ä½¿ç”¨ <code>present</code> æ–¹å¼, ä¸å¯ä»¥ä½¿ç”¨ <code>push</code> çš„æ–¹å¼.</p><p>å¦åˆ™ä¼šæŠ¥é”™:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//Terminating app due to uncaught exception &#x27;SKUnsupportedPresentationException&#x27;,</span><br><span class="line">//reason: &#x27;SKStoreProductViewController must be used in a modal view controller&#x27;</span><br></pre></td></tr></table></figure><p>2.åŠ å…¥ loading</p><p>åœ¨åº”ç”¨å†…æ‰“å¼€ AppStore, ä¸ºäº†ä¸è®©ç”¨æˆ·å‚»ç­‰(ç½‘ç»œä¸å¥½çš„æ—¶å€™, æ‰“å¼€å¾ˆæ…¢), å¯ä»¥åŠ å…¥ loading, ç¼“è§£ä¸€ä¸‹ç”¨æˆ·æ€¥èºçš„å¿ƒæƒ….</p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AppStore iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‰¾åˆä¼™äºº, ä¸æ˜“</title>
      <link href="/2017/03/26/%E6%89%BE%E5%90%88%E4%BC%99%E4%BA%BA-%E4%B8%8D%E6%98%93/"/>
      <url>/2017/03/26/%E6%89%BE%E5%90%88%E4%BC%99%E4%BA%BA-%E4%B8%8D%E6%98%93/</url>
      
        <content type="html"><![CDATA[<p>æ—©åœ¨é«˜ä¸­æ—¶æœŸ, è¯»è¿‡ &lt;ä¸‰è¨€&gt; ä¸­çš„ &lt;è­¦ä¸–é€šè¨€&gt;, ç¬¬ä¸€ç« å†™çš„æ˜¯ <code>ä¿ä¼¯ç‰™æ‘”ç´è°¢çŸ¥éŸ³</code>, è®²çš„æ˜¯é’Ÿå­æœŸå’Œä¿ä¼¯ç‰™çš„æ•…äº‹.</p><p>è¯»å®Œä¹‹å, æ•´ä¸ªäººéƒ½è§‰å¾—éš¾å—, å¿ƒç†æœ‰è¯´ä¸å‡ºçš„æ»‹å‘³, çœ¼æ³ªç«Ÿå¤ºçœ¶è€Œå‡º.</p><p>æµä¼ çš„è¿™é¦–è¯—, å¯ä»¥æ„Ÿå—ä¸‹.</p><blockquote><p>æ‘”ç¢ç‘¶ç´å‡¤å°¾å¯’ï¼Œå­æœŸä¸åœ¨å¯¹è°å¼¹ï¼<br>æ˜¥é£æ»¡é¢çš†æœ‹å‹ï¼Œæ¬²è§…çŸ¥éŸ³éš¾ä¸Šéš¾ã€‚<br>åŠ¿åˆ©äº¤æ€€åŠ¿åˆ©å¿ƒï¼Œæ–¯æ–‡è°å¤å¿µçŸ¥éŸ³ï¼<br>ä¼¯ç‰™ä¸ä½œé’ŸæœŸé€ï¼Œåƒå¤ä»¤äººè¯´ç ´ç´ã€‚</p></blockquote><p>è‡ªå·±å·¥ä½œä¹‹å, å¯¹ <code>æ¬²è§…çŸ¥éŸ³éš¾ä¸Šéš¾</code> è¿™å¥è¯å°¤ä¸ºèµåŒ.</p><p>å¹´å°‘è½»ç‹‚çš„ä½ , è—ç€è¦æ”¹å˜ä¸–ç•Œçš„å¿ƒ, æ®‹é…·çš„ç°å®ä¼šæŠ¹å»ä½ å‡¸èµ·çš„æ£±è§’, å²æœˆå’Œç¯å¢ƒä¼šè®©ä½ å˜å¾—è¶Šå‘ä¸å®‰.</p><p>ä¸å®‰çš„ä¸–ç•Œ, è®©ä½ èŒ«ç„¶.</p><p>äºæ˜¯, ç‚¹ä¸Šä¸€æ”¯çƒŸ, å›é¡¾æŠ˜è…¾çš„äººç”Ÿ, ç¬‘å¹: åˆ«äººç¬‘æˆ‘å¤ªç–¯ç™«, æˆ‘ç¬‘ä»–äººçœ‹ä¸ç©¿.</p><p>å¯æƒœ, æˆ‘ä»¬ä¸æ˜¯å”å¯…, æ²¡æœ‰è¿™ä»½æ´’è„±å’Œå¥”æ”¾, æ¯•ç«Ÿæ—¶ä»£ä¹Ÿå¤§ç›¸å¾„åº­.</p><p>~ å¥½äº†, å›åˆ°ç°å®ä¸­æ¥.</p><p>åˆšæ¯•ä¸š, ä½ ä¼šæŠŠä¸»è¦ç²¾åŠ›æ”¾åœ¨å¦‚ä½•æŠŠå·¥ä½œåšå¥½, ç»´æŒè‡ªå·±çš„ç”Ÿè®¡ä¸Šé¢, å¦‚æœèƒ½è·Ÿèº«è¾¹çš„å¤§ç‰›å­¦åˆ°ä¸€äº›ä¸“ä¸šçŸ¥è¯†, å†è‹¦å†ç´¯, ä½ éƒ½æ˜¯å¼€å¿ƒçš„.</p><p>æ¸æ¸åœ°, ä½ å‘ç°çŸ¥è¯†(ä¸“ä¸šçš„å’Œéä¸“ä¸šçš„çŸ¥è¯†)çœŸæ˜¯è¦æ´»åˆ°è€å­¦åˆ°è€, æ°¸æ— æ­¢å¢ƒ, æ— æ³•åƒæ­¦ä¾ ç‰‡é‡Œé¢æ¼”å¾—é‚£æ ·ç§»èŠ±æ¥æœ¨, æ–—è½¬æ˜Ÿç§». å‘œå‘¼, è„šè¸å®åœ°çš„åšå¥½æœ¬èŒå·¥ä½œ, é¡ºä¾¿èƒ½æ‹“å±•ä¸€ä¸‹è‡ªå·±çš„äº¤é™…åœˆ, æ‰©å¤§è‡ªå·±çš„çŸ¥è¯†é¢, è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„.</p><p>å„è¡Œå„ä¸šéƒ½æœ‰éå¸¸çªå‡ºçš„äººæ‰, å¾ˆå¤šæ—¶å€™, æˆ‘ä»¬åªèƒ½æœ›æ´‹å…´å¹.</p><p>å¦‚æœä½ èƒ½é‡åˆ°ä¸€ä¸ªè‚¯ä¸ä½ åˆ†äº«å’Œäº¤æµ, æˆ–è€…æ˜¯æ„¿æ„å°†è‡ªå·±çš„å®è·µåˆ†äº«ç»™ä½ çš„äºº, é‚£ä½ ç®—æ˜¯ä¸Šè¾ˆå­ç§¯äº†å¤§å¾·äº†. é˜¿å¼¥é™€ä½›!</p><p>æˆ‘æŠŠè¿™æ ·çš„äººç§°ä¹‹ä¸º <code>æ©äºº</code>, ä¹Ÿç®—æ˜¯ <code>çŸ¥éŸ³</code>.</p><p>ä»¥å‰, å¾ˆå¤šæœ‹å‹ä¼šé—®å¦‚æœå°†æ¥è‡ªå·±å¼€å…¬å¸, æ˜¯å¦æ„¿æ„æ¥å—ç°åœ¨çš„è‡ªå·±, æˆ‘çš„å›ç­”æ˜¯ä¸€å®šæ¥å—. å¦‚æœè¿˜æœ‰äººé—®è¿™ä¸ªé—®é¢˜, æˆ‘ä¼šå¦å¤–å†è¿½åŠ ä¸€ä¸ªé—®é¢˜:</p><blockquote><p>å¦‚æœä½ å¼€å…¬å¸, ä½ æ˜¯å¦æ„¿æ„æ¥å—å’Œä½ ç°åœ¨ä¸€èµ·å·¥ä½œçš„åŒäº‹?æˆ–è€…è¯´ä½ æ˜¯å¦æ„¿æ„è®©ä»–æˆä¸ºä½ çš„åˆä¼™äºº?</p></blockquote><p>è¿™äº›é—®é¢˜, çœ‹ä¼¼ç©ç¬‘, å®åˆ™å¾ˆç°å®å¾ˆæ®‹é…·, ä¸€æ—¦ä½ å†³å®šè¦å»åšæˆæŸä»¶äº‹æƒ…, ç«‹å¿—è¦å®ç°è‡ªå·±çš„æŠ±è´Ÿå’Œç†æƒ³çš„æ—¶å€™, ä½ çš„ç«‹åœºä¼šå’Œå…¶ä»–äººåƒå·®å¤–åˆ«.é¦–å…ˆè¦è€ƒè™‘çš„æ˜¯è¦å’Œè°ä¸€èµ·å…±è°‹äº‹, æ‰èƒ½çœŸæ­£çš„å¸®åˆ°è‡ªå·±, å¹¶ä¸”ä¹Ÿèƒ½å¸®åˆ°åˆ«äºº.å› ä¸ºé€‰æ‹©æ˜¯åŒå‘çš„, èƒ½æ‰¾åˆ°å’Œä½ ä¸€æ‹å³åˆçš„äºº, ä¹Ÿç¡®å®ä¸æ˜“.ä½†æ„¿ä»»ä½•ä¸€ä¸ªæ¸´æœ›æˆåŠŸå¹¶ä»˜å‡ºè¡ŒåŠ¨çš„äºº, èƒ½æ‰¾åˆ°è‡ªå·±çš„åˆä¼™äºº, æ‰¾åˆ°è‡ªå·±çš„çŸ¥éŸ³.</p><p>çœŸæ­£çš„æˆåŠŸè€…, ä¸æ˜¯æ²‰æµ¸åœ¨å¤šå°‘äººè®©ä½ æˆåŠŸçš„å–œæ‚¦ä¸­, è€Œæ˜¯ä½ è®©å¤šå°‘äººå’Œä½ ä¸€èµ·åˆ†äº«äº†æˆåŠŸçš„å–œæ‚¦çš„äºº.</p><p>è¯´åˆ°è¿™é‡Œ, æœ¬äººåªæ˜¯æƒ³è¯´æ˜ç™½ä¸€ä¸ªé“ç†, é€ç»™å³å°†æˆ–è€…å·²ç»åœ¨èŒåœºå¥‹æ–—çš„äºº:</p><blockquote><p>è¸è¸å®å®çš„åšäº‹å¹¶æ²¡æœ‰é”™, ä½†æ˜¯æ‰¾åˆ°å€¼å¾— â€œæ‰˜ä»˜ç»ˆèº«â€ çš„äººç¡®å®ä¸æ˜“, ä½ ç°åœ¨èƒ½åšçš„åªæœ‰ç”¨çŸ¥è¯†æ¥æ­¦è£…è‡ªå·±, è®©è‡ªå·±å˜å¼º.</p></blockquote><p>åœ¨èŒåœºä¸­, ä½ ä¼šé‡åˆ°å¾ˆå¤šè®©ä½ ä¸çˆ½çš„äººæˆ–è€…äº‹. è®°ä½, è¦åšåˆ° <code>å¯¹äº‹ä¸å¯¹äºº</code>, ä¸è¦å¤ªå§”å±ˆè‡ªå·±, å¤§ä¸ˆå¤«èƒ½å±ˆèƒ½ä¼¸, è¯¥å‡ºæ‰‹æ—¶å°±å‡ºæ‰‹, æ²¡æœ‰ä»€ä¹ˆå¤§ä¸äº†.</p><p>å¦‚æœçœŸçš„è§‰å¾—æœ‰äº›äººæˆ–è€…æœ‰äº›äº‹ä¸å€¼å¾—ä½ æµªè´¹æ—¶é—´, å°±ç¦»å®ƒä»¬è¿œç‚¹. æƒ¹ä¸èµ·ä½†å¯ä»¥èº²å¾—èµ·, ä½ è¯´å‘¢?</p><p>é…Œä¸€å£¶å°é…’, è€å¤«èŠå‘å°‘å¹´ç‹‚!</p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ€è€ƒ ç”Ÿæ´» åˆä¼™äºº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®©è‡ªå·±å˜å¼º</title>
      <link href="/2017/03/10/%E8%AE%A9%E8%87%AA%E5%B7%B1%E5%8F%98%E5%BC%BA/"/>
      <url>/2017/03/10/%E8%AE%A9%E8%87%AA%E5%B7%B1%E5%8F%98%E5%BC%BA/</url>
      
        <content type="html"><![CDATA[<p>å½“ä½ è¯»åˆ°è¿™ç¯‡æ–‡ç« çš„æ—¶å€™, æˆ‘å…¶å®è¿˜ä¸çŸ¥é“ã€æ€ä¹ˆè®©è‡ªå·±å˜å¼ºã€.<br>å…·ä½“è¯´, å°±æ˜¯æ²¡æœ‰ä¸€å¥—è®©ä½ æˆ–è€…è®©ä»–å˜å¼ºçš„æ­¦æ—ç§˜ç±.</p><p>åªèƒ½ç»“åˆè‡ªå·±ç»å†çš„äº‹, åˆ†äº«ç»™å¤§å®¶, å¸Œæœ›èƒ½æ„ŸåŒèº«å—!</p><p>è¿™å‡ å¤©åŠ ç­åŠ åœ°æœ‰ç‚¹çŒ›, æµ‘ç„¶ä¸çŸ¥å‘¨æœ«è½®å›äº†.<br>å¿ƒç†æ€»æ˜¯åœ¨å¿µå¨, å¥½ä¹…æ²¡æœ‰åœ¨å…¬ä¼—å·æ¶‚é¸¦äº†, æ‰‹ç—’ç—’äº†.<br>è¶ä»Šæ™šå›æ¥æ—©(22:30å›åˆ°å®¶), å°±åŠ¨ç¬”äº†.</p><p>ã€è®©è‡ªå·±å˜å¼ºã€, è¿™å¥è¯è¯´ç€å¾ˆç®€å•, ä½†ä¸æ˜¯ä»»ä½•äººéƒ½èƒ½æ„è¯†åˆ°è¿™å‡ ä¸ªå­—å¸¦æ¥çš„åŠ›é‡.</p><p>åœ¨ã€Œæ˜æœé‚£äº›äº‹å„¿ã€ä¸­æœ‰è¿™ä¹ˆä¸€æ®µ:</p><blockquote><p>æˆ‘ä»¬ç»å¸¸ä¼šäº§ç”Ÿä¸€ä¸ªç–‘é—®ï¼Œé‚£å°±æ˜¯æ€æ ·æ‰èƒ½è·å¾—å…¶ä»–å›½å®¶åŠå…¶äººæ°‘çš„å°Šé‡ï¼Œåœ¨ä¸–ç•Œä¸Šé£å…‰è‡ªè±ªä¸€æŠŠï¼Œå…¶å®ç­”æ¡ˆå¾ˆç®€å•â€”â€”å›½å®¶å¼ºå¤§ã€‚</p></blockquote><p>çœ‹åˆ°è¿™é‡Œ, æ„Ÿè§¦é¢‡æ·±.</p><h2 id="åœ¨å›¢é˜Ÿä¸­æˆé•¿"><a href="#åœ¨å›¢é˜Ÿä¸­æˆé•¿" class="headerlink" title="åœ¨å›¢é˜Ÿä¸­æˆé•¿"></a>åœ¨å›¢é˜Ÿä¸­æˆé•¿</h2><p>å›¢é˜Ÿæˆé•¿çš„ä¸»è§‚æ¡ä»¶æ˜¯å›¢é˜Ÿçš„æˆå‘˜è¦æˆé•¿, ä¸ç„¶å›¢é˜Ÿå“ªé‡Œæ¥çš„æˆé•¿.</p><p>å¦‚æœä½ æ˜¯ä½œä¸ºä¸€ä¸ªå›¢é˜Ÿæˆ–è€…å°ç»„çš„è´Ÿè´£äºº, ä¼šé¢ä¸´å„ç§å„æ ·çš„é—®é¢˜, æ¯”å¦‚éœ€è¦è·Ÿå›¢é˜Ÿä»¥å¤–çš„éƒ¨é—¨è°ˆåˆä½œ, éœ€è¦è·Ÿè€æ¿æ±‡æŠ¥å·¥ä½œ, è¿˜è¦å¤„ç†å†…éƒ¨çš„é—®é¢˜ç­‰ç­‰è¯¸å¦‚æ­¤ç±»!</p><p>æˆ‘è§‰å¾—å®‰é‚¦éœ€å®‰å†…, ä¹Ÿå°±æ˜¯è¯´è¦å…ˆæå®šå›¢é˜Ÿå†…éƒ¨çš„å„ç§äº‹ç‰©, äººæ˜¯æ¯”è¾ƒå¤æ‚çš„æ„Ÿæƒ…åŠ¨ç‰©, ä½ ä¸å¥½ä¹Ÿä¸èƒ½æ§åˆ¶åˆ«äººçš„æƒ…ç»ª. æ‰€ä»¥, éœ€è¦å¯¹äº‹ä¸å¯¹äºº!ä½ ä¸èƒ½è¯´, ä½ çœ‹ä»–é•¿å¾—ä¸å¥½çœ‹, å°±çŸ¥é“å·¥ä½œåšä¸å¥½ç±»ä¼¼çš„è¯.</p><p>è¿™æ ·ä¸€è¯´, åŸºæœ¬ä¸¤ä¸ªäººå°±ç»“ä¸‹äº†æ¢å­.è¿Ÿæ—©ä¼šçˆ†å‘.</p><p>é¦–å…ˆ, è¦ç»™å›¢é˜Ÿæˆå‘˜å¸Œæœ›, è®©å¤§å®¶éƒ½è®¤è¯†åˆ°æœ‰ç»Ÿä¸€çš„ç›®æ ‡.</p><p>å…¶æ¬¡, è®©æ¯ä¸ªäººç»™å‡ºå·¥ä½œå’Œå®è¡Œè®¡åˆ’, åˆ¶å®šè‡ªå·±çš„è€ƒæ ¸ç›®æ ‡.å¯¹åšå‡ºçªå‡ºè´¡çŒ®çš„æˆå‘˜å¥–åŠ±, æ¯ä¸ªäººéƒ½éœ€è¦å¾—åˆ°å°Šé‡, è€Œå¥–åŠ±æ˜¯æœ€å¤§çš„å°Šé‡.</p><p>æœ€å, åŠ å¼ºä¸å›¢é˜Ÿæˆå‘˜ä¹‹é—´çš„æ²Ÿé€š, äº’ç›¸å¸®åŠ©, è®©å¤§å®¶èƒ½å¤Ÿç›¸äº’ä¿¡ä»»å’Œé¼“åŠ±, è‰¯å¥½æœ‰æ•ˆçš„æ²Ÿé€š, äº‹åŠåŠŸå€.</p><p>ä½œä¸ºå›¢é˜Ÿè´Ÿè´£äºº, è‚¯å®šå¸Œæœ›æ‰‹ä¸‹çš„äººå„ä¸ªéªå‹‡å–„æˆ˜, ç™¾æˆ˜ç™¾èƒœ, ä½†æ˜¯ç°å®ä¸­å¾ˆéš¾åšåˆ°, å…¶å®ä¹Ÿæ²¡æœ‰å¿…è¦.<br>è¥¿æ¸¸è®°å‘Šè¯‰æˆ‘ä»¬, å”åƒ§å¸¦é¢†çš„å›¢é˜Ÿæ‰æ˜¯æœ€å¥½çš„å›¢é˜Ÿ.</p><h2 id="å°‘åŸ‹æ€¨å¤šç»™äºˆå¸®åŠ©"><a href="#å°‘åŸ‹æ€¨å¤šç»™äºˆå¸®åŠ©" class="headerlink" title="å°‘åŸ‹æ€¨å¤šç»™äºˆå¸®åŠ©"></a>å°‘åŸ‹æ€¨å¤šç»™äºˆå¸®åŠ©</h2><p>æ¯ä¸ªäººç”Ÿæ´»å’Œå·¥ä½œçš„ç¯å¢ƒä¸ä¸€æ ·, åœ¨ä¸åŒçš„åœ°ç‚¹ä¸åŒçš„æ—¶é—´é¢å¯¹ä¸åŒçš„äº‹æƒ…, éƒ½ä¼šæœ‰ä¸åŒçš„çœ‹æ³•.</p><p>ä¸–ç•Œä¸Šä»»ä½•ä¸€ç§é€‰æ‹©, éƒ½æ˜¯å‘½ä¸­æ³¨å®šçš„, æ²¡æœ‰äººèƒ½å¼ºè¿«ä½ å»åšå‡ºä»»ä½•é”™è¯¯çš„é€‰æ‹©, é™¤äº†ä½ è‡ªå·±.</p><p>åœ¨è‡ªå·±æ‰€å¤„çš„ç¯å¢ƒä¸­, è¦ä¹ˆä½ èƒ½æ”¹å˜ç¯å¢ƒä½¿å…¶æ¥é€‚åº”è‡ªå·±, è¦ä¹ˆå°±ç¦»å¼€è¿™ä¸ªè‡ªå·±ä¸é€‚åº”çš„ç¯å¢ƒ, ä¸è¦å»æŠ±æ€¨.</p><p>å”‰å£°å¹æ°”, ä¸ä»…ä»…å½±å“è‡ªå·±çš„å·¥ä½œæ•ˆç‡å’Œç”Ÿæ´»è´¨é‡, è¿˜ä¼šå½±å“åˆ°åˆ«äºº.<br>æˆå¤©åœ¨æŠ±æ€¨, è§‰å¾—è°è°éƒ½ä¸è¡Œ, è‡ªå·±æ‰æ˜¯æœ€ç‰›é€¼çš„, æ—¥è¡Œè§ä¹…, ä½ å°±æ˜¯é‚£ä¸ªå……æ»¡è´Ÿèƒ½é‡çš„äºº, å½“åˆ«äººè§‰æ‚Ÿåˆ°çš„æ—¶å€™, å°±ä¼šç¦»ä½ è€Œå», å²‚ä¸å’ç”±è‡ªå–?!æˆ‘æƒ³è¿™ä¹Ÿæ˜¯å¾®ä¿¡æœ‹å‹åœˆåªæœ‰ç‚¹èµæ²¡æœ‰éç‚¹èµçš„åŸå› å§!</p><p>å¦‚æœè§‰å¾—è‡ªå·±çš„åŒäº‹æˆ–è€…æœ‹å‹æœ‰æ‰€æ¬ ç¼º, å°±æƒ³åŠæ³•å»å¸®åŠ©ä»–, é¼“åŠ±ä»–, æŠŠä½ è®¤ä¸ºä¸€äº›å¥½çš„æ–¹å¼å’Œæ–¹æ³•ä¼ æˆç»™ä»–. è¯´ä¸å®šå“ªå¤©å› ä¸ºä½ çš„ä¸€å¥è¯æˆ–è€…ä¸€ä¸ªæ–¹æ³•, ä»–å°±èµ°ä¸Šäººç”Ÿå·…å³°äº†, å“ˆå“ˆ!</p><p>ä»ç°åœ¨å¼€å§‹, å¿˜è®°åŸ‹æ€¨, ç»™äºˆåˆ«äººæ›´å¤šçš„å¸®åŠ©å’Œé¼“åŠ±.</p><h2 id="åŸ¹å…»è‡ªå·±çš„ä¸“æ³¨åŠ›"><a href="#åŸ¹å…»è‡ªå·±çš„ä¸“æ³¨åŠ›" class="headerlink" title="åŸ¹å…»è‡ªå·±çš„ä¸“æ³¨åŠ›"></a>åŸ¹å…»è‡ªå·±çš„ä¸“æ³¨åŠ›</h2><p>ä¸“æ³¨åŠ›, æ˜¯ä¸€ä¸ªå¾ˆç¥å¥‡çš„ä¸œè¥¿.</p><p>å¦‚æœä¸€ä¸ªäººæ²¡æœ‰ä¸“æ³¨åŠ›, å¾ˆéš¾å†æœ‰æ‰€çªç ´, æ®è¯´ç‰›é¡¿æ˜¯åœ¨åšæ¢¦çš„æ—¶å€™, å‘æ˜äº†å¾ˆå¤šæŠ˜ç£¨å¹¿å¤§é’å°‘å¹´çš„ç‰›é¡¿å®šå¾‹çš„.</p><p>æ¯ä¸ªäººåœ¨è‡ªå·±çš„è¡Œä¸šä¸Š, å¤šå°‘éƒ½æœ‰çŸ­æ¿. æœ‰çŸ­æ¿æ˜¯æƒ…æœ‰å¯åŸçš„, ä½†æ˜¯é¦–å…ˆä½ å¾—è®¤è¯†åˆ°è‡ªå·±çš„çŸ­æ¿, ç„¶åå†æŒ‡å®šè®¡åˆ’å»çªç ´ä»–.</p><blockquote><p>è¦æƒ³è¿›æ­¥, å¿…é¡»é¢å¯¹è‡ªå·±çš„ä¸è¶³.</p></blockquote><p>æ¯”å¦‚, å·¥ä½œä¸Šéœ€è¦ä½ å­¦ä¼šæŸç§æŠ€æœ¯, å¦‚æœåœ¨æŸä¸ªæ—¶é—´ç‚¹, ä½ æ²¡æœ‰å­¦ä¼š, å¯èƒ½å°±ä¼šä¸¢æ‰é¥­ç¢—, ä½ å°±ä¼šä¸é¡¾ä¸€åˆ‡çš„å»å­¦ä¹ , ç›´åˆ°å­¦ä¼šä¼šç”¨ä¸ºæ­¢. è¿™ä¸ªè¿‡ç¨‹, ä½ å°±æ˜¯åœ¨ä¸“æ³¨è¿™ä»¶äº‹æƒ…, å›å¤´æƒ³æƒ³å’¬å’¬ç‰™, è¿˜æ˜¯å¯ä»¥åŠåˆ°çš„, æ²¡æœ‰ä»€ä¹ˆå¤§ä¸äº†çš„.</p><p>æ¯å¤©ç»™è‡ªå·±ä¸€ç‚¹æ—¶é—´, ä¸“æ³¨å»åšä¸€ä»¶äº‹æƒ…, åšæŒä¸‹æ¥, ä½ ä¼šå‘ç°, å­¦ä¹ å’Œè¿›æ­¥å°±æ˜¯ feel feel å€å„¿çˆ½.</p><h2 id="æœ€ååˆ†äº«ç»™å¤§å®¶ä¸€å¥è¯"><a href="#æœ€ååˆ†äº«ç»™å¤§å®¶ä¸€å¥è¯" class="headerlink" title="æœ€ååˆ†äº«ç»™å¤§å®¶ä¸€å¥è¯:"></a>æœ€ååˆ†äº«ç»™å¤§å®¶ä¸€å¥è¯:</h2><blockquote><p>ä¸èƒ½æ”¹å˜åˆ«äººçš„æ—¶å€™, è¯•ç€æ”¹å˜ä¸€ä¸‹è‡ªå·±æˆ–è®¸å°±èƒ½æŠŠäº‹æƒ…å˜é€šäº†.</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éšç¬” ç”Ÿæ´» åæ€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Tomcat8 é…ç½® HTTPS</title>
      <link href="/2017/02/15/Tomcat8-%E9%85%8D%E7%BD%AE-HTTPS/"/>
      <url>/2017/02/15/Tomcat8-%E9%85%8D%E7%BD%AE-HTTPS/</url>
      
        <content type="html"><![CDATA[<p>åšå®¢ [Tomcat8 åŸŸåé…ç½®] ä»‹ç»äº†å¦‚ä½•åœ¨æœ¬åœ°é…ç½® Tomcat8 çš„åŸŸåä»¥åŠé€šè¿‡åŸŸåæ¥è®¿é—®å¯¹åº”çš„èµ„æº.</p><p>ä»Šå¤©ç»§ç»­è·Ÿå¤§å®¶åˆ†äº«å¦‚ä½•é…ç½® Tomcat8 çš„ HTTPS (å•å‘è®¤è¯), æœ¬ç¯‡åšå®¢çš„ä¸»è¦å†…å®¹å¦‚ä¸‹:</p><blockquote><p>1.é…ç½® Tomcat çš„ HTTPS.<br>2.é€šè¿‡ HTTPS + ip çš„æ–¹å¼æ¥è®¿é—®èµ„æº.<br>3.é€šè¿‡ HTTPS + åŸŸå çš„æ–¹å¼æ¥è®¿é—®èµ„æº.</p></blockquote><h2 id="é…ç½®è¦æ±‚"><a href="#é…ç½®è¦æ±‚" class="headerlink" title="é…ç½®è¦æ±‚"></a>é…ç½®è¦æ±‚</h2><p>1.å®‰è£…äº† JDK, å¹¶é…ç½®äº†å…¶ç›¸å…³çš„ç¯å¢ƒå˜é‡.å¯å‚è€ƒ Mac é…ç½® JDK1.8.</p><p>2.å®‰è£…äº† Tomcat8, å¹¶é…ç½®äº†å…¶ç›¸å…³çš„ç¯å¢ƒå˜é‡.å¯å‚è€ƒ Mac é…ç½® Tomcat8.</p><h2 id="ç”Ÿæˆè¯ä¹¦"><a href="#ç”Ÿæˆè¯ä¹¦" class="headerlink" title="ç”Ÿæˆè¯ä¹¦"></a>ç”Ÿæˆè¯ä¹¦</h2><blockquote><p>è·å–è¯ä¹¦å¯ä»¥å»è´­ä¹°, è¿™é‡Œæ˜¯åœ¨æœ¬åœ°æœºå™¨æ­å»º, ä½¿ç”¨ JDK è‡ªå¸¦çš„å·¥å…· keytool ç”Ÿæˆå³å¯.</p></blockquote><p>æ‰“å¼€ mac ç»ˆç«¯, æ‰§è¡Œ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -v -genkey -alias tomcat -keyalg RSA -keystore ~/Desktop/tomcat.keystore</span><br></pre></td></tr></table></figure><p>ç´§æ¥ç€, ä¼šå‡ºç°ä¸€äº›è®©ä½ è¾“å…¥ä¿¡æ¯çš„äº¤äº’ä¿¡æ¯, ç¬¬ä¸€ä¸ªæ˜¯è®©ä½ è¾“å…¥ å¯†é’¥åº“å¯†ç (å£ä»¤), æˆ‘è¾“å…¥çš„æ˜¯ 1234567, å…¶ä»–ä¿¡æ¯å¯ä»¥ä»»æ„è¾“å…¥å†…å®¹, åœ¨æœ€åä¸€æ­¥, é—®ä½ ç”Ÿæˆçš„ å¯†é’¥å£ä»¤ å’Œ å¯†é’¥åº“çš„å£ä»¤ æ˜¯å¦ç›¸åŒ, å¦‚æœç›¸åŒå°±ç›´æ¥å›è½¦, æˆ‘è¿™é‡Œæ˜¯ç›´æ¥å›è½¦çš„, å³å¯†ç ç›¸åŒ, éƒ½æ˜¯ 1234567.</p><p>è¿™æ ·å°±ç”Ÿæˆäº†æ‰€è°“çš„è¯ä¹¦.</p><h2 id="é…ç½®-HTTPS"><a href="#é…ç½®-HTTPS" class="headerlink" title="é…ç½® HTTPS"></a>é…ç½® HTTPS</h2><blockquote><p>é€šè¿‡ä¿®æ”¹ server.xml æ¥é…ç½®.</p></blockquote><p>å°† tomcat.keystore æ–‡ä»¶å¤åˆ¶åˆ° Tomcat çš„ conf ç›®å½•.</p><p>ä¿®æ”¹ server.xml æ–‡ä»¶, å¢åŠ ä¸€ä¸ª Connector, å†…å®¹å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Connector port=&quot;8443&quot; protocol=&quot;org.apache.coyote.http11.Http11NioProtocol&quot;  </span><br><span class="line">           maxThreads=&quot;150&quot; SSLEnabled=&quot;true&quot; scheme=&quot;https&quot; secure=&quot;true&quot;  </span><br><span class="line">           clientAuth=&quot;false&quot; sslProtocol=&quot;TLS&quot; keystoreFile=&quot;conf/tomcat.keystore&quot; keystorePass=&quot;1234567&quot;/&gt;</span><br></pre></td></tr></table></figure><p>æ³¨æ„, keystoreFile æ˜¯è¯ä¹¦æ–‡ä»¶, keystorePass æ˜¯å¯†ç , è¿™é‡Œé…ç½®ä¸€å®šè¦æ­£ç¡®.</p><h2 id="é…ç½®-HTTPS-IP"><a href="#é…ç½®-HTTPS-IP" class="headerlink" title="é…ç½® HTTPS + IP"></a>é…ç½® HTTPS + IP</h2><p>é…ç½®ä¸€ä¸ªè™šæ‹Ÿä¸»æœº, ä¿®æ”¹ server.xml æ–‡ä»¶, å¢åŠ  Host:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;Host name=&quot;192.168.1.103&quot; debug=&quot;0&quot; appBase=&quot;webapps&quot; unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot; xmlValidation=&quot;false&quot;  xmlNamespaceAware=&quot;false&quot;&gt;</span><br><span class="line">&lt;Context path=&quot;&quot; docBase=&quot;test&quot; debug=&quot;0&quot; reloadable=&quot;true&quot; crossContext=&quot;true&quot;/&gt;</span><br><span class="line">&lt;Logger className=&quot;org.apache.catalina.logger.FileLogger&quot; directory=&quot;logs&quot; prefix=&quot;tot_log.&quot; suffix=&quot;.txt&quot; timestamp=&quot;true&quot;/&gt;</span><br><span class="line">&lt;/Host&gt;</span><br></pre></td></tr></table></figure><p>é…ç½® name&#x3D;â€192.168.1.103â€ æ˜¯ä½ æœ¬æœºçš„ ip åœ°å€.</p><p>è¿™ä¸ªåœ¨åšå®¢ [iOS: èŠèŠ UIWebView ç¼“å­˜] ä¸­æœ‰è¯¦ç»†çš„ä»‹ç», è¿™é‡Œä¸å†èµ˜è¿°.</p><p>å¯åŠ¨ Tomcat, è¿›è¡Œæµ‹è¯•.</p><p>è¿™é‡Œéœ€è¦åˆ° Tomcat çš„ bin ç›®å½•ä¸‹, æ‰§è¡Œ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo startup.sh</span><br></pre></td></tr></table></figure><p>å¯åŠ¨æˆåŠŸå, æ‰“å¼€æµè§ˆå™¨, è¾“å…¥: <a href="https://192.168.1.103:8443/test.html">https://192.168.1.103:8443/test.html</a>, è¿™ä¸ªæ—¶å€™, ä¼šå¼¹å‡ºå¦‚ä¸‹çš„è­¦å‘Š(æç¤ºä¸å®‰å…¨):<br><img src="/upload/images/2017/02/15/1.png" alt="1"></p><p>ç›´æ¥ç‚¹å‡» Advanced åå†ç‚¹å‡» Proceed to 192.168.1.103:8443(unsafe) å¤„ç†å³å¯çœ‹åˆ°é¡µé¢å†…å®¹.</p><h2 id="é…ç½®-HTTPS-åŸŸå"><a href="#é…ç½®-HTTPS-åŸŸå" class="headerlink" title="é…ç½® HTTPS + åŸŸå"></a>é…ç½® HTTPS + åŸŸå</h2><p>ä¿®æ”¹ server.xml, å¢åŠ  Connector:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Connector port=&quot;8443&quot; protocol=&quot;org.apache.coyote.http11.Http11NioProtocol&quot;  </span><br><span class="line">          maxThreads=&quot;150&quot; SSLEnabled=&quot;true&quot; scheme=&quot;https&quot; secure=&quot;true&quot;  </span><br><span class="line">          clientAuth=&quot;false&quot; sslProtocol=&quot;TLS&quot; keystoreFile=&quot;conf/tomcat.keystore&quot; keystorePass=&quot;1234567&quot;/&gt;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ server.xml, å¢åŠ  Host:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;Host name=&quot;www.mark.com&quot; debug=&quot;0&quot; appBase=&quot;webapps&quot; unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot; xmlValidation=&quot;false&quot;  xmlNamespaceAware=&quot;false&quot;&gt;</span><br><span class="line">&lt;Context path=&quot;&quot; docBase=&quot;test&quot; debug=&quot;0&quot; reloadable=&quot;true&quot; crossContext=&quot;true&quot;/&gt;</span><br><span class="line">&lt;Logger className=&quot;org.apache.catalina.logger.FileLogger&quot; directory=&quot;logs&quot; prefix=&quot;tot_log.&quot; suffix=&quot;.txt&quot; timestamp=&quot;true&quot;/&gt;</span><br><span class="line">&lt;/Host&gt;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ &#x2F;etc&#x2F;host æ–‡ä»¶, å¢åŠ :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 www.mark.com</span><br></pre></td></tr></table></figure><p>å¯åŠ¨ Tomcat, åœ¨ bin ç›®å½•, æ‰§è¡Œ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shutdown.sh</span><br><span class="line">sudo startup.sh</span><br></pre></td></tr></table></figure><p>å¯åŠ¨æˆåŠŸå, æ‰“å¼€æµè§ˆå™¨, è¾“å…¥ <a href="https://www.mark.com:8443/test.html">https://www.mark.com:8443/test.html</a>, å¦‚æœå¼¹å‡ºè­¦å‘Š, å¯ä»¥åƒå¦‚ä¸Šå¤„ç†æ¥æ˜¾ç¤ºé¡µé¢å†…å®¹.</p><p>å¦‚æœä½ è¿™é‡Œé…ç½®å¤±è´¥äº†, è¯·ä¿®æ”¹ä¸€ä¸‹ç«¯å£å·, å¦‚å°† 8443 æ”¹ä¸º 8433.<br>é‡å¯ Tomcat åœ¨è¯•ä¸€ä¸‹.</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>Apache å®˜æ–¹æ–‡æ¡£: <a href="https://tomcat.apache.org/tomcat-8.0-doc/ssl-howto.html">ssl-howto</a></p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tomcat Java Apache </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Tomcat8 åŸŸåé…ç½®</title>
      <link href="/2017/02/13/Tomcat8-%E5%9F%9F%E5%90%8D%E9%85%8D%E7%BD%AE/"/>
      <url>/2017/02/13/Tomcat8-%E5%9F%9F%E5%90%8D%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<p>åšå®¢ [Mac é…ç½® Tomcat8] ä»‹ç»äº†åœ¨ Mac ä¸‹å®‰è£…å’Œå¯åŠ¨ Tomcat.</p><p>æ¥ä¸‹æ¥ä»‹ç», å¦‚ä½•åœ¨æœ¬åœ°é…ç½® Tomcat8 çš„åŸŸå.</p><p>ç½‘ä¸Šæœ‰å¾ˆå¤šå…³äº Tomcat å¦‚ä½•é…ç½®å•åŸŸåæˆ–è€…å¤šåŸŸåçš„æ–‡ç« , å¾ˆå¤šéƒ½æ˜¯ç¿»è¯‘æˆ–è€…å¤åˆ¶åˆ«äººçš„, æ ¹æœ¬æ²¡æœ‰å®è·µè¿‡, å®³äººä¸æµ…!</p><p>ç»“åˆè‡ªå·±çš„å®è·µ, æŠŠé…ç½®çš„æ•´ä¸ªè¿‡ç¨‹åˆ†äº«ç»™å¤§å®¶, å¸Œæœ›èƒ½å¸®åˆ°ä½ .</p><p>ä¸‹é¢è¿›å…¥æ­£é¢˜.</p><h2 id="ä¿®æ”¹ç«¯å£"><a href="#ä¿®æ”¹ç«¯å£" class="headerlink" title="ä¿®æ”¹ç«¯å£"></a>ä¿®æ”¹ç«¯å£</h2><p>åœ¨ Tomcat çš„å®‰è£…(å…¶å®æ˜¯è§£å‹çš„)ç›®å½• &#x2F;conf ä¸‹æœ‰ server.xml æ–‡ä»¶.</p><p>å°†ä¸‹é¢å†…å®¹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Connector port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot;</span><br><span class="line">              connectionTimeout=&quot;20000&quot;</span><br><span class="line">              redirectPort=&quot;8443&quot; /&gt;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸º:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Connector port=&quot;80&quot; protocol=&quot;HTTP/1.1&quot;</span><br><span class="line">              connectionTimeout=&quot;20000&quot;</span><br><span class="line">              redirectPort=&quot;8443&quot; /&gt;</span><br></pre></td></tr></table></figure><h2 id="æ·»åŠ -web-é¡¹ç›®"><a href="#æ·»åŠ -web-é¡¹ç›®" class="headerlink" title="æ·»åŠ  web é¡¹ç›®"></a>æ·»åŠ  web é¡¹ç›®</h2><blockquote><p>è¿™ä¸€æ­¥ä¸»è¦æ˜¯ä¸ºäº†åé¢æµ‹è¯•.</p></blockquote><p>å¾ˆç®€å•, åœ¨ Tomcat çš„å®‰è£…ç›®å½• webapps ä¸‹é¢æ–°å»º test æ–‡ä»¶å¤¹, é‡Œé¢åˆ›å»ºä¸€ä¸ª html æ–‡ä»¶å³å¯.<br>è¿™é‡Œå°†å…¶å‘½åä¸º test.html.</p><p>test.html å†…å®¹è§åé¢çš„é™„å½•å³å¯.</p><h2 id="é…ç½®åŸŸå"><a href="#é…ç½®åŸŸå" class="headerlink" title="é…ç½®åŸŸå"></a>é…ç½®åŸŸå</h2><blockquote><p>å¢åŠ è™šæ‹Ÿä¸»æœºé…ç½®.è¿˜éœ€è¦ä¿®æ”¹ server.xml æ–‡ä»¶.</p></blockquote><p>åœ¨ server.xml æ–‡ä»¶ä¸­, åœ¨æ ‡ç­¾ <Engine> å’Œ</Engine> ä¹‹é—´å¢åŠ ä¸‹é¢çš„å†…å®¹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;Host name=&quot;www.mark.com&quot; debug=&quot;0&quot; appBase=&quot;webapps&quot; unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot; xmlValidation=&quot;false&quot;  xmlNamespaceAware=&quot;false&quot;&gt;</span><br><span class="line">    &lt;Context path=&quot;&quot; docBase=&quot;test&quot; debug=&quot;0&quot; reloadable=&quot;true&quot; crossContext=&quot;true&quot;/&gt;</span><br><span class="line">    &lt;Logger className=&quot;org.apache.catalina.logger.FileLogger&quot; directory=&quot;logs&quot; prefix=&quot;tot_log.&quot; suffix=&quot;.txt&quot; timestamp=&quot;true&quot;/&gt;</span><br><span class="line">&lt;/Host&gt;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­, <a href="http://www.mark.com/">www.mark.com</a> æ˜¯æˆ‘è‡ªå·±ä»»æ„å–çš„ä¸€ä¸ªåŸŸå, docBase&#x3D;â€testâ€ æ˜¯æŒ‡å‘ä¸Šé¢æ–°å»ºçš„ test ç›®å½•.</p><h2 id="é…ç½®åŸŸåè§£æ"><a href="#é…ç½®åŸŸåè§£æ" class="headerlink" title="é…ç½®åŸŸåè§£æ"></a>é…ç½®åŸŸåè§£æ</h2><p>ç”±äºéƒ¨ç½²åœ¨æœ¬åœ°, éœ€è¦ä¿®æ”¹ host.</p><p>ä¿®æ”¹ &#x2F;etc&#x2F;host æ–‡ä»¶, éœ€è¦ sudo æƒé™:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/host</span><br></pre></td></tr></table></figure><p>å¢åŠ å¦‚ä¸‹å†…å®¹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 www.mark.com</span><br></pre></td></tr></table></figure><h2 id="éªŒè¯é…ç½®"><a href="#éªŒè¯é…ç½®" class="headerlink" title="éªŒè¯é…ç½®"></a>éªŒè¯é…ç½®</h2><blockquote><p>è¿™ä¸€æ­¥, éªŒè¯é…ç½®æ˜¯å¦ç”Ÿæ•ˆ.</p></blockquote><p>å¯åŠ¨ Tomcat, è¿™é‡Œçš„æ“ä½œæ¯”è¾ƒç‰¹æ®Š, éœ€è¦ sudo æƒé™æ¥å¯åŠ¨ Tomcat, å¦åˆ™ä¼šæŠ¥ä¸‹é¢çš„é”™è¯¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">org.apache.coyote.AbstractProtocol.init Failed to initialize end point associated with ProtocolHandler [&quot;http-nio-80&quot;]</span><br><span class="line"> java.net.SocketException: Permission denied</span><br></pre></td></tr></table></figure><p>å› ä¸º, åªæœ‰ root ç”¨æˆ·æ‰å¯ä»¥ä½¿ç”¨ 1024 ä»¥ä¸‹çš„ç«¯å£å·.</p><p>æ­£ç¡®å§¿åŠ¿:</p><p>cd è¿›å…¥ Tomcat çš„ bin ç›®å½•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd ~/Tomcat/bin</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo startup.sh</span><br></pre></td></tr></table></figure><p>æˆåŠŸå, æ‰“å¼€æµè§ˆå™¨, è¾“å…¥ <a href="http://www.mark.com/test.html">http://www.mark.com/test.html</a>, å³å¯çœ‹åˆ°é¡µé¢å†…å®¹.</p><h2 id="é…ç½®å¦ä¸€ä¸ªåŸŸå"><a href="#é…ç½®å¦ä¸€ä¸ªåŸŸå" class="headerlink" title="é…ç½®å¦ä¸€ä¸ªåŸŸå"></a>é…ç½®å¦ä¸€ä¸ªåŸŸå</h2><p>å¯ä»¥é…ç½®å¦å¤–çš„ä¸€ä¸ªåŸŸå, æ¯”å¦‚ <a href="http://www.ithome.com/">www.ithome.com</a>, å³å¤šå¢åŠ ä¸€ä¸ªè™šæ‹Ÿä¸»æœºé…ç½®.</p><p>åœ¨ server.xml å¢åŠ :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;Host name=&quot;www.ithome.com&quot; debug=&quot;0&quot; appBase=&quot;webapps&quot; unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot; xmlValidation=&quot;false&quot;  xmlNamespaceAware=&quot;false&quot;&gt;</span><br><span class="line">    &lt;Context path=&quot;&quot; docBase=&quot;test&quot; debug=&quot;0&quot; reloadable=&quot;true&quot; crossContext=&quot;true&quot;/&gt;</span><br><span class="line">    &lt;Logger className=&quot;org.apache.catalina.logger.FileLogger&quot; directory=&quot;logs&quot; prefix=&quot;tot_log.&quot; suffix=&quot;.txt&quot; timestamp=&quot;true&quot;/&gt;</span><br><span class="line">&lt;/Host&gt;</span><br></pre></td></tr></table></figure><p>é…ç½® DNS, åŒç†ä¿®æ”¹ etc&#x2F;host æ–‡ä»¶:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 www.ithome.com</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡º, åœ¨æµè§ˆå™¨è¾“å…¥ <a href="http://www.ithome.com/test.html">http://www.ithome.com/test.html</a> å’Œ <a href="http://www.mark.com/test.html">http://www.mark.com/test.html</a> æ•ˆæœæ˜¯ä¸€æ ·çš„.</p><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p>test.html æ–‡ä»¶å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;p&gt;</span><br><span class="line">&lt;em&gt;Sample&lt;/em&gt; text&lt;/p&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">Now I input another line, with fancy&lt;u&gt;&lt;strong&gt;&lt;em&gt;styles&lt;/em&gt;&lt;/strong&gt;</span><br><span class="line">&lt;/u&gt;.&lt;/p&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">&lt;em&gt;Sample&lt;/em&gt; text&lt;/p&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">Now I input another line, with fancy &lt;u&gt;&lt;strong&gt;&lt;em&gt;styles&lt;/em&gt;&lt;/strong&gt;</span><br><span class="line">&lt;/u&gt;.&lt;/p&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">    mark.zhang is an itman.</span><br><span class="line">&lt;/p&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">.button &#123;</span><br><span class="line">    background-color: #4CAF50;</span><br><span class="line">    border: none;</span><br><span class="line">    color: white;</span><br><span class="line">    padding: 15px 32px;</span><br><span class="line">    text-align: center;</span><br><span class="line">    text-decoration: none;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    font-size: 86px;</span><br><span class="line">    margin: 50px 200px 100px 300px;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">    border-radius: 15;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">   &lt;button type=&quot;button&quot; onclick=&quot;myFunction()&quot; class=&quot;button&quot;&gt;Try it&lt;/button&gt;</span><br><span class="line">&lt;/p&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">   function myFunction() &#123;</span><br><span class="line">       alert(&quot;Blog: www.veryitman.com&quot;);</span><br><span class="line">   &#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tomcat Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ATS: HTTPS è®¤è¯</title>
      <link href="/2017/02/08/ATS-HTTPS-%E8%AE%A4%E8%AF%81/"/>
      <url>/2017/02/08/ATS-HTTPS-%E8%AE%A4%E8%AF%81/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åœ¨ <a href="http://www.veryitman.com/2017/02/06/ATS-HTTP-HTTPS-%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D/">ATS: HTTP&#x2F;HTTPS åè®®ä»‹ç»</a> ä¸­ä»‹ç»äº†ä¸€äº›å…³äº HTTP&#x2F;HTTPS çš„æ¦‚å¿µä»¥åŠç›¸å…³çš„åŸºæœ¬çŸ¥è¯†ã€‚</p><p>ä»Šå¤©æ¥èŠèŠå…³äº HTTPS çš„è®¤è¯æ–¹å¼å’Œè¿‡ç¨‹ã€‚</p><p>è¯´ HTTPS è®¤è¯å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹å‡ ä¸ªç›¸å…³æ¦‚å¿µã€‚</p><h2 id="å…³äºåŠ å¯†çš„å‡ ä¸ªæ¦‚å¿µ"><a href="#å…³äºåŠ å¯†çš„å‡ ä¸ªæ¦‚å¿µ" class="headerlink" title="å…³äºåŠ å¯†çš„å‡ ä¸ªæ¦‚å¿µ"></a>å…³äºåŠ å¯†çš„å‡ ä¸ªæ¦‚å¿µ</h2><h4 id="1-SSL-åè®®åŠ å¯†æ–¹å¼"><a href="#1-SSL-åè®®åŠ å¯†æ–¹å¼" class="headerlink" title="1. SSL åè®®åŠ å¯†æ–¹å¼"></a>1. SSL åè®®åŠ å¯†æ–¹å¼</h4><blockquote><p>SSL æ—¢ç”¨äº†å¯¹ç§°åŠ å¯†ï¼Œä¹Ÿç”¨äº†éå¯¹ç§°åŠ å¯†ã€‚</p></blockquote><p>åœ¨å»ºç«‹ä¼ è¾“é“¾è·¯æ—¶, SSL é¦–å…ˆå¯¹å¯¹ç§°åŠ å¯†çš„å¯†é’¥ä½¿ç”¨å…¬é’¥è¿›è¡Œéå¯¹ç§°åŠ å¯†ï¼Œé“¾è·¯å»ºç«‹å¥½ä¹‹åï¼ŒSSL å¯¹ä¼ è¾“å†…å®¹ä½¿ç”¨å¯¹ç§°åŠ å¯†ã€‚</p><p>ä¸‹é¢æ˜¯ä¸¤ç§åŠ å¯†æ–¹å¼çš„å¯¹æ¯”ï¼š</p><p>1.1ã€å¯¹ç§°åŠ å¯†</p><blockquote><p>å¯¹ç§°åŠ å¯†é‡‡ç”¨äº†å¯¹ç§°å¯†ç ç¼–ç æŠ€æœ¯ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯æ–‡ä»¶åŠ å¯†å’Œè§£å¯†ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ï¼Œå³åŠ å¯†å¯†é’¥ä¹Ÿå¯ä»¥ç”¨ä½œè§£å¯†å¯†é’¥ï¼Œè¿™ç§æ–¹æ³•åœ¨å¯†ç å­¦ä¸­å«åš <code>å¯¹ç§°åŠ å¯†ç®—æ³•</code>ï¼Œå¯¹ç§°åŠ å¯†ç®—æ³•ä½¿ç”¨èµ·æ¥ç®€å•å¿«æ·ï¼Œå¯†é’¥è¾ƒçŸ­ï¼Œä¸”ç ´è¯‘å›°éš¾ï¼Œé™¤äº†æ•°æ®åŠ å¯†æ ‡å‡†ï¼ˆDESï¼‰ï¼Œå¦ä¸€ä¸ªå¯¹ç§°å¯†é’¥åŠ å¯†ç³»ç»Ÿæ˜¯å›½é™…æ•°æ®åŠ å¯†ç®—æ³•ï¼ˆIDEAï¼‰ï¼Œå®ƒæ¯” DES çš„åŠ å¯†æ€§å¥½ï¼Œè€Œä¸”å¯¹è®¡ç®—æœºåŠŸèƒ½è¦æ±‚ä¹Ÿæ²¡æœ‰é‚£ä¹ˆé«˜ã€‚<br>IDEA åŠ å¯†æ ‡å‡†ç”± PGPï¼ˆPretty Good Privacyï¼‰ç³»ç»Ÿä½¿ç”¨ã€‚</p></blockquote><p>è¯¥åŠ å¯†æ–¹å¼ï¼Œé€Ÿåº¦å¿«ï¼Œå¯åŠ å¯†å†…å®¹è¾ƒå¤§ï¼Œç”¨æ¥åŠ å¯†ä¼šè¯è¿‡ç¨‹ä¸­çš„æ¶ˆæ¯ã€‚</p><p>1.2ã€éå¯¹ç§°åŠ å¯†</p><blockquote><p>1976å¹´ï¼Œç¾å›½å­¦è€… Dime å’Œ Henman ä¸ºè§£å†³ä¿¡æ¯å…¬å¼€ä¼ é€å’Œå¯†é’¥ç®¡ç†é—®é¢˜ï¼Œæå‡ºä¸€ç§æ–°çš„å¯†é’¥äº¤æ¢åè®®ï¼Œå…è®¸åœ¨ä¸å®‰å…¨çš„åª’ä½“ä¸Šçš„é€šè®¯åŒæ–¹äº¤æ¢ä¿¡æ¯ï¼Œå®‰å…¨åœ°è¾¾æˆä¸€è‡´çš„å¯†é’¥ï¼Œè¿™å°±æ˜¯â€œå…¬å¼€å¯†é’¥ç³»ç»Ÿâ€ã€‚<br>ç›¸å¯¹äº <code>å¯¹ç§°åŠ å¯†ç®—æ³•</code> è¿™ç§æ–¹æ³•ä¹Ÿå«åš <code>éå¯¹ç§°åŠ å¯†ç®—æ³•</code>ã€‚<br>ä¸å¯¹ç§°åŠ å¯†ç®—æ³•ä¸åŒï¼Œéå¯¹ç§°åŠ å¯†ç®—æ³•éœ€è¦ä¸¤ä¸ªå¯†é’¥ï¼šå…¬å¼€å¯†é’¥ï¼ˆpublickeyï¼‰å’Œç§æœ‰å¯†é’¥ï¼ˆprivatekeyï¼‰. å…¬å¼€å¯†é’¥ä¸ç§æœ‰å¯†é’¥æ˜¯ä¸€å¯¹ï¼Œå¦‚æœç”¨å…¬å¼€å¯†é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œåªæœ‰ç”¨å¯¹åº”çš„ç§æœ‰å¯†é’¥æ‰èƒ½è§£å¯†ï¼›å¦‚æœç”¨ç§æœ‰å¯†é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œé‚£ä¹ˆåªæœ‰ç”¨å¯¹åº”çš„å…¬å¼€å¯†é’¥æ‰èƒ½è§£å¯†ã€‚<br>å› ä¸ºåŠ å¯†å’Œè§£å¯†ä½¿ç”¨çš„æ˜¯ä¸¤ä¸ªä¸åŒçš„å¯†é’¥ï¼Œæ‰€ä»¥è¿™ç§ç®—æ³•å«ä½œéå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚</p></blockquote><p>è¯¥åŠ å¯†æ–¹å¼ï¼Œé€Ÿåº¦è¾ƒæ…¢ï¼Œèƒ½æä¾›æ›´å¥½çš„èº«ä»½è®¤è¯æŠ€æœ¯ï¼Œç”¨æ¥åŠ å¯†å¯¹ç§°åŠ å¯†çš„å¯†é’¥ã€‚</p><h4 id="2-æ•°å­—è¯ä¹¦"><a href="#2-æ•°å­—è¯ä¹¦" class="headerlink" title="2. æ•°å­—è¯ä¹¦"></a>2. æ•°å­—è¯ä¹¦</h4><p>ä¸€ç§æ–‡ä»¶çš„åç§°ï¼Œå¥½æ¯”ä¸€ä¸ªæœºæ„æˆ–äººçš„ç­¾åå°±å¥½æ¯”ä¸€ä¸ªå…¬å¸çš„å…¬ç« ä¸€æ ·ï¼Œèƒ½å¤Ÿè¯æ˜è¿™ä¸ªæœºæ„æˆ–äººçš„çœŸå®æ€§ï¼Œå…¶ä¸­åŒ…å«çš„ä¿¡æ¯ï¼Œç”¨äºå®ç°ä¸Šè¿°åŠŸèƒ½ã€‚</p><p>CA è¯ä¹¦ï¼ˆå³æ•°å­—è¯ä¹¦ï¼‰æ˜¯ç”± CAï¼ˆCertification Authorityï¼Œè¯ä¹¦é¢å‘æœºæ„ï¼‰æœºæ„å‘å¸ƒçš„æ•°å­—è¯ä¹¦ã€‚å…¶å†…å®¹åŒ…å«ç”µå­ç­¾è¯æœºå…³çš„ä¿¡æ¯ã€å…¬é’¥ç”¨æˆ·ä¿¡æ¯ã€å…¬é’¥ã€ç­¾åå’Œæœ‰æ•ˆæœŸã€‚è¿™é‡Œçš„å…¬é’¥æ˜¯æœåŠ¡ç«¯çš„å…¬é’¥ã€ç­¾åæ˜¯æŒ‡ç”¨ <code>hash</code> æ•£åˆ—å‡½æ•°è®¡ç®—å…¬å¼€çš„æ˜æ–‡ä¿¡æ¯çš„ä¿¡æ¯æ‘˜è¦ï¼Œç„¶åé‡‡ç”¨ CA çš„ç§é’¥å¯¹ä¿¡æ¯æ‘˜è¦è¿›è¡ŒåŠ å¯†ï¼ŒåŠ å¯†å®Œçš„å¯†æ–‡å°±æ˜¯ç­¾åã€‚ å³ <code>è¯ä¹¦ =  å…¬é’¥ + ç­¾å +ç”³è¯·è€…å’Œé¢å‘è€…çš„ä¿¡æ¯</code>ã€‚ å®¢æˆ·ç«¯ä¸­å› ä¸ºåœ¨æ“ä½œç³»ç»Ÿä¸­å°±é¢„ç½®äº† CA çš„å…¬é’¥ï¼Œæ‰€ä»¥æ”¯æŒè§£å¯†ç­¾åï¼ˆå› ä¸ºç­¾åä½¿ç”¨ CA çš„ç§é’¥åŠ å¯†çš„ï¼‰ã€‚</p><p><strong>æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦ CA è®¤è¯æœºæ„é¢å‘è¯ä¹¦ï¼Ÿ</strong></p><p>HTTP åè®®è¢«è®¤ä¸ºä¸å®‰å…¨æ˜¯å› ä¸ºä¼ è¾“è¿‡ç¨‹å®¹æ˜“è¢«ç›‘å¬è€…å‹¾çº¿ç›‘å¬ã€ä¼ªé€ é€šä¿¡æ–¹ä»¥åŠçªƒå–ç½‘ç»œé€šä¿¡å†…å®¹ï¼Œè€Œ HTTPS åè®®ä¸»è¦è§£å†³çš„ä¾¿æ˜¯ç½‘ç»œä¼ è¾“çš„å®‰å…¨æ€§é—®é¢˜ã€‚</p><p>æˆ‘ä»¬å‡è®¾ä¸å­˜åœ¨è®¤è¯æœºæ„ï¼Œä»»ä½•äººéƒ½å¯ä»¥åˆ¶ä½œè¯ä¹¦ï¼Œè¿™å¸¦æ¥çš„å®‰å…¨é£é™©ä¾¿æ˜¯ç»å…¸çš„ <a href="https://baike.baidu.com/item/%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB">ä¸­é—´äººæ”»å‡»</a>ï¼ˆMan-in-the-MiddleAttackï¼Œç®€ç§° â€œMITM<em>æ”»å‡»</em>â€ï¼‰é—®é¢˜ã€‚</p><p>æ¨èå¤§å®¶çœ‹çœ‹ <a href="https://zhuanlan.zhihu.com/p/103456919">ç½‘ç»œä¸–ç•ŒèƒŒåçš„â€œåŠŸè‡£â€â€”â€”CA è®¤è¯</a> è¿™ç¯‡æ–‡ç« ã€‚</p><h4 id="3-åŠ å¯†å’Œè®¤è¯"><a href="#3-åŠ å¯†å’Œè®¤è¯" class="headerlink" title="3. åŠ å¯†å’Œè®¤è¯"></a>3. åŠ å¯†å’Œè®¤è¯</h4><p>åŠ å¯†æ˜¯æŒ‡é€šä¿¡åŒæ–¹ä¸ºäº†é˜²æ­¢æ•æ„Ÿä¿¡æ¯åœ¨ä¿¡é“ä¸Šè¢«ç¬¬ä¸‰æ–¹çªƒå¬è€Œæ³„æ¼ï¼Œå°†æ˜æ–‡é€šè¿‡åŠ å¯†å˜æˆå¯†æ–‡ï¼Œå¦‚æœç¬¬ä¸‰æ–¹æ— æ³•è§£å¯†çš„è¯ï¼Œå°±ç®—è·å¾—å¯†æ–‡ä¹Ÿæ— èƒ½ä¸ºåŠ›ã€‚</p><p>è®¤è¯æ˜¯æŒ‡é€šä¿¡åŒæ–¹ä¸ºäº†ç¡®è®¤å¯¹æ–¹æ˜¯å€¼å¾—ä¿¡ä»»çš„æ¶ˆæ¯å‘é€æˆ–æ¥å—æ–¹ï¼Œè€Œä¸æ˜¯ä½¿ç”¨å‡èº«ä»½çš„éæ³•è€…ï¼Œé‡‡å–çš„ç¡®è®¤èº«ä»½çš„æ–¹å¼ã€‚</p><p>åªæœ‰åŒæ—¶è¿›è¡Œäº†åŠ å¯†å’Œè®¤è¯æ‰èƒ½ä¿è¯é€šä¿¡çš„å®‰å…¨ï¼Œå› æ­¤åœ¨ SSL é€šä¿¡åè®®ä¸­è¿™ä¸¤è€…(åŠ å¯†å’Œè®¤è¯)éƒ½è¢«ä½¿ç”¨ã€‚</p><p>åŠ å¯†ä¸€èˆ¬ä½¿ç”¨ <code>å¯¹ç§°åŠ å¯†ç®—æ³•</code> å’Œ <code>ä¸å¯¹ç§°åŠ å¯†ç®—æ³•</code>ï¼Œæœ€å¸¸è§çš„ç®—æ³•éå¯¹ç§°åŠ å¯†å°±æ˜¯ RSA åŠ å¯†ç®—æ³•ã€‚</p><h4 id="4-æ¶ˆæ¯æ‘˜è¦"><a href="#4-æ¶ˆæ¯æ‘˜è¦" class="headerlink" title="4. æ¶ˆæ¯æ‘˜è¦"></a>4. æ¶ˆæ¯æ‘˜è¦</h4><p>è¿™ä¸ªæŠ€æœ¯ä¸»è¦æ˜¯ä¸ºäº†é¿å…æ¶ˆæ¯è¢«ç¯¡æ”¹ï¼Œæ¶ˆæ¯æ‘˜è¦ä¹Ÿç§°ä¹‹ä¸ºæ•°å­—æ‘˜è¦ã€‚</p><p>æ¶ˆæ¯æ‘˜è¦æ˜¯æŠŠä¸€æ®µä¿¡æ¯é€šè¿‡æŸç§ä¸å¯é€†çš„ç®—æ³•ï¼Œå¾—å‡ºä¸€ä¸²å­—ç¬¦ä¸²ã€‚è¿™ä¸ªå­—ç¬¦ä¸²å°±æ˜¯æ¶ˆæ¯çš„æ‘˜è¦ï¼Œå¦‚æœæ¶ˆæ¯è¢«ç¯¡æ”¹(å‘ç”Ÿäº†å˜åŒ–)ï¼Œé‚£ä¹ˆæ‘˜è¦ä¹Ÿä¸€å®šä¼šå‘ç”Ÿå˜åŒ–ï¼Œå½“ç„¶äº†å¦‚æœä¸¤ä¸ªä¸åŒçš„æ¶ˆæ¯ç”Ÿæˆçš„æ‘˜è¦æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆè¿™å°±å«å‘ç”Ÿäº† <code>ç¢°æ’</code>ã€‚å¥½çš„æ‘˜è¦ç®—æ³•æ˜¯æ²¡æœ‰äººèƒ½ä»ä¸­æ‰¾åˆ° <code>ç¢°æ’</code> æˆ–è€…è¯´æåº¦éš¾æ‰¾åˆ°ã€‚</p><p>æ¶ˆæ¯æ‘˜è¦çš„ç®—æ³•ä¸»è¦æœ‰ MD2ã€MD4ã€MD5ã€SHA-1ã€SHA-256ã€RIPEMD128ã€RIPEMD160 ç­‰ï¼Œåœ¨è¯ä¹¦é¢†åŸŸï¼Œä¸€èˆ¬éƒ½æ˜¯ç”¨ SHA(å®‰å…¨å“ˆå¸Œç®—æ³•)ã€‚æ¶ˆæ¯æ‘˜è¦ç®—æ³•çš„ä¸»è¦ç‰¹å¾æ˜¯åŠ å¯†è¿‡ç¨‹ä¸éœ€è¦å¯†é’¥ï¼Œå¹¶ä¸”ç»è¿‡åŠ å¯†çš„æ•°æ®æ— æ³•è¢«è§£å¯†ï¼Œåªæœ‰è¾“å…¥ç›¸åŒçš„æ˜æ–‡æ•°æ®ç»è¿‡ç›¸åŒçš„æ¶ˆæ¯æ‘˜è¦ç®—æ³•æ‰èƒ½å¾—åˆ°ç›¸åŒçš„å¯†æ–‡ã€‚</p><p>æ•°å­—è¯ä¹¦ã€åŠ å¯†å’Œè®¤è¯ã€æ¶ˆæ¯æ‘˜è¦ä¸‰ä¸ªæŠ€æœ¯ç»“åˆèµ·æ¥ï¼Œå°±æ˜¯åœ¨ HTTPS ä¸­å¹¿æ³›åº”ç”¨çš„è¯ä¹¦ï¼ˆcertificateï¼‰ï¼Œè¯ä¹¦æœ¬èº«æºå¸¦äº†åŠ å¯†&#x2F;è§£å¯†çš„ä¿¡æ¯ï¼Œå¹¶ä¸”å¯ä»¥æ ‡è¯†è‡ªå·±çš„èº«ä»½ï¼Œä¹Ÿè‡ªå¸¦æ¶ˆæ¯æ‘˜è¦ã€‚</p><h2 id="HTTPS-è®¤è¯æ–¹å¼"><a href="#HTTPS-è®¤è¯æ–¹å¼" class="headerlink" title="HTTPS è®¤è¯æ–¹å¼"></a>HTTPS è®¤è¯æ–¹å¼</h2><p>åˆ†ä¸ºå•å‘å’ŒåŒå‘è®¤è¯ã€‚</p><h3 id="å•å‘è®¤è¯"><a href="#å•å‘è®¤è¯" class="headerlink" title="å•å‘è®¤è¯"></a>å•å‘è®¤è¯</h3><blockquote><p>å•å‘è®¤è¯è¾ƒç®€å•ï¼Œåªéœ€è¦å®¢æˆ·ç«¯æ ¡éªŒæœåŠ¡ç«¯çš„è¯ä¹¦çš„åˆæ³•æ€§å³å¯ã€‚æ¢å¥è¯è¯´ï¼Œåªéœ€è¦å®¢æˆ·ç«¯éªŒè¯ SSL æœåŠ¡å™¨èº«ä»½ï¼Œä¸éœ€è¦æœåŠ¡ç«¯éªŒè¯ SSL å®¢æˆ·ç«¯èº«ä»½ã€‚ ä¹Ÿå°±æ˜¯è¯´å•å‘è®¤è¯ä¸éœ€è¦å®¢æˆ·ç«¯ä¿å­˜ CA è¯ä¹¦å³å•å‘è®¤è¯ SSL åè®®ä¸éœ€è¦å®¢æˆ·æ‹¥æœ‰ CA è¯ä¹¦ã€‚</p></blockquote><p>è¯¥è®¤è¯è¿‡ç¨‹ä½¿ç”¨ä¸‹é¢çš„æµç¨‹å›¾æ¥è¡¨ç¤º:<br><img src="/upload/images/2017/02/08/HTTPS_Single.png" alt="1"></p><h3 id="åŒå‘è®¤è¯"><a href="#åŒå‘è®¤è¯" class="headerlink" title="åŒå‘è®¤è¯"></a>åŒå‘è®¤è¯</h3><blockquote><p> åŒå‘è®¤è¯å’Œå•å‘è®¤è¯åŸç†åŸºæœ¬ä¸€è‡´ï¼Œä½†æ˜¯éœ€è¦åŒæ–¹éƒ½æ ¡éªŒå¯¹æ–¹çš„è¯ä¹¦çš„åˆæ³•æ€§ã€‚æ¢å¥è¯è¯´ï¼Œ è¦æ±‚æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯åŒæ–¹éƒ½æœ‰è¯ä¹¦ï¼Œå®¢æˆ·ç«¯éœ€è¦æ ¡éªŒæœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯ä¹Ÿéœ€è¦æ ¡éªŒå®¢æˆ·ç«¯ã€‚ ä¹Ÿå°±æ˜¯è¯´åŒå‘è®¤è¯éœ€è¦å®¢æˆ·ç«¯ã€æœåŠ¡ç«¯éƒ½è¦ä¿å­˜è¯ä¹¦ã€‚</p></blockquote><p>è¯¥è®¤è¯è¿‡ç¨‹ä½¿ç”¨ä¸‹é¢çš„æµç¨‹å›¾æ¥è¡¨ç¤ºï¼š<br><img src="/upload/images/2017/02/08/HTTPS_Double.png" alt="1"></p><p>è¿™é‡Œæ€»ç»“ä¸€ä¸‹åŒå‘é€šä¿¡çš„æµç¨‹ğŸ¤¦â€ã€‚</p><p><strong>ç¬¬1æ­¥ï¼šå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘èµ·è¯·æ±‚</strong></p><blockquote><p>è¿™ä¸ªè¿‡ç¨‹ä¸»è¦åšäº†ä¸‹é¢ä¸¤ä»¶äº‹æƒ…ï¼š</p></blockquote><p>â‘ ã€å®¢æˆ·ç«¯ç”Ÿæˆéšæœºæ•° R1 å‘é€ç»™æœåŠ¡ç«¯ï¼›</p><p>â‘¡ã€å‘Šè¯‰æœåŠ¡ç«¯è‡ªå·±æ”¯æŒå“ªäº›åŠ å¯†ç®—æ³•ï¼›</p><p><strong>ç¬¬2æ­¥ï¼šæœåŠ¡å™¨å‘å®¢æˆ·ç«¯å‘é€æ•°å­—è¯ä¹¦</strong></p><p>â‘ ã€æœåŠ¡ç«¯ç”Ÿæˆéšæœºæ•° R2ï¼›</p><p>â‘¡ã€ä»å®¢æˆ·ç«¯æ”¯æŒçš„åŠ å¯†ç®—æ³•ä¸­é€‰æ‹©ä¸€ç§åŒæ–¹éƒ½æ”¯æŒçš„åŠ å¯†ç®—æ³•ï¼ˆæ­¤ç®—æ³•ç”¨äºåé¢çš„ä¼šè¯å¯†é’¥ç”Ÿæˆï¼‰;</p><p>â‘¢ã€æœåŠ¡ç«¯æŠŠè¯ä¹¦ã€éšæœºæ•° R2 å’Œä¼šè¯å¯†é’¥ç”Ÿæˆç®—æ³•ï¼Œä¸€èµ·å‘ç»™å®¢æˆ·ç«¯ï¼›</p><p><strong>ç¬¬3æ­¥ï¼šå®¢æˆ·ç«¯éªŒè¯æ•°å­—è¯ä¹¦</strong></p><p>â‘ ã€éªŒè¯è¯ä¹¦çš„å¯é æ€§ï¼Œå…ˆç”¨ CA çš„å…¬é’¥è§£å¯†è¢«åŠ å¯†è¿‡åçš„è¯ä¹¦ï¼Œèƒ½è§£å¯†åˆ™è¯´æ˜è¯ä¹¦æ²¡æœ‰é—®é¢˜ï¼Œç„¶åé€šè¿‡è¯ä¹¦é‡Œæä¾›çš„æ‘˜è¦ç®—æ³•å¯¹æ•°æ®è¿›è¡Œæ‘˜è¦è®¡ç®—ï¼Œç„¶åé€šè¿‡è‡ªå·±ç”Ÿæˆçš„æ‘˜è¦ä¸æœåŠ¡ç«¯å‘é€çš„æ‘˜è¦æ¯”å¯¹ï¼Œæ¯”å¯¹å¦‚æœä¸€è‡´è¡¨ç¤ºé€šä¿¡å†…å®¹æ²¡æœ‰è¢«ä¿®æ”¹ï¼›</p><p>â‘¡ã€éªŒè¯è¯ä¹¦åˆæ³•æ€§ï¼ŒåŒ…æ‹¬è¯ä¹¦æ˜¯å¦åŠé”€ã€æ˜¯å¦åˆ°æœŸã€åŸŸåæ˜¯å¦åŒ¹é…ï¼Œé€šè¿‡ååˆ™è¿›è¡Œåé¢çš„æµç¨‹ï¼›</p><p>â‘¢ã€è·å¾—è¯ä¹¦çš„å…¬é’¥ã€ä¼šè¯å¯†é’¥ç”Ÿæˆç®—æ³•ã€éšæœºæ•° R2ï¼ˆæœåŠ¡ç«¯ç”Ÿæˆçš„ï¼‰ï¼›</p><p>â‘£ã€å®¢æˆ·ç«¯ç”Ÿæˆç¬¬ä¸‰ä¸ªéšæœºæ•° R3ï¼›</p><p>â‘¤ã€æ ¹æ®ä¼šè¯ç§˜é’¥ç®—æ³•ä½¿ç”¨ R1ã€R2ã€R3 ç”Ÿæˆä¼šè¯ç§˜é’¥ï¼›</p><p>â‘¥ã€ç”¨æœåŠ¡ç«¯è¯ä¹¦çš„å…¬é’¥åŠ å¯†éšæœºæ•° R3 å¹¶å‘é€ç»™æœåŠ¡ç«¯ï¼›</p><p><strong>ç¬¬4æ­¥ï¼šæœåŠ¡å™¨å¾—åˆ°ä¼šè¯å¯†é’¥</strong></p><p>â‘ ã€æœåŠ¡å™¨ç”¨ç§é’¥è§£å¯†å®¢æˆ·ç«¯å‘è¿‡æ¥çš„éšæœºæ•° R3ï¼›</p><p>â‘¡ã€æ ¹æ®ä¼šè¯ç§˜é’¥ç®—æ³•ä½¿ç”¨ R1ã€R2ã€R3 ç”Ÿæˆä¼šè¯ç§˜é’¥ï¼›</p><p><strong>ç¬¬5æ­¥ï¼šå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯è¿›è¡ŒåŠ å¯†ä¼šè¯</strong></p><p>â‘ ã€å®¢æˆ·ç«¯å‘é€åŠ å¯†æ•°æ®ç»™æœåŠ¡ç«¯ï¼Œå®¢æˆ·ç«¯åŠ å¯†æ•°æ®åå‘é€ç»™æœåŠ¡ç«¯ã€‚</p><p>â‘¡ã€æœåŠ¡ç«¯å“åº”å®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯ç”¨ä¼šè¯å¯†é’¥è§£å¯†å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼Œç„¶åç”¨ä¼šè¯å¯†é’¥æŠŠå“åº”çš„æ•°æ®åŠ å¯†å‘é€ç»™å®¢æˆ·ç«¯ï¼›</p><p>â‘¢ã€å®¢æˆ·ç«¯ç”¨ä¼šè¯å¯†é’¥è§£å¯†æœåŠ¡ç«¯å“åº”çš„æ•°æ®ï¼›</p><p>ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œå‰4æ­¥å±äºåŒæ–¹çš„é€šä¿¡æ¡æ‰‹è¿‡ç¨‹ï¼Œç¬¬5æ­¥æ‰è¿›è¡ŒçœŸæ­£çš„é€šä¿¡ã€‚åœ¨æ¡æ‰‹çš„è¿‡ç¨‹ä¸­ä½¿ç”¨äº† <strong>éå¯¹ç§°åŠ å¯†</strong> ä¸»è¦ç”¨äºç”Ÿæˆåç»­é€šä¿¡çš„å¯†é’¥ï¼Œåœ¨åç»­çš„æ•°æ®é€šä¿¡ä¸­ä½¿ç”¨äº† <strong>å¯¹ç§°åŠ å¯†</strong>ã€‚</p><h3 id="éšæœºæ•°çš„äº§ç”Ÿ"><a href="#éšæœºæ•°çš„äº§ç”Ÿ" class="headerlink" title="éšæœºæ•°çš„äº§ç”Ÿ"></a>éšæœºæ•°çš„äº§ç”Ÿ</h3><p>ä¸ç®¡æ˜¯å•å‘è®¤è¯ï¼Œè¿˜æ˜¯åŒå‘è®¤è¯ï¼Œéƒ½æœ‰éšæœºæ•°çš„äº§ç”Ÿå’Œå‘é€ï¼Œå…¶ä¸­ R1ã€R2 éƒ½æ˜¯æ˜æ–‡ä¼ è¾“ï¼Œåªæœ‰ R3 æ˜¯åŠ å¯†ä¼ è¾“çš„ã€‚</p><p>R1ï¼šClient Randomï¼Œæ˜¯ç”±å®¢æˆ·ç«¯äº§ç”Ÿçš„éšæœºæ•°ï¼›</p><p>R2ï¼šServer Randomï¼Œæ˜¯ç”±æœåŠ¡ç«¯äº§ç”Ÿçš„éšæœºæ•°ï¼›</p><p>R3ï¼šæ˜¯å®¢æˆ·ç«¯äº§ç”Ÿçš„ä¸”ä½¿ç”¨å¯†é’¥åŠ å¯†çš„éšæœºæ•°ï¼Œä¹Ÿç§°ä¹‹ä¸º Premaster secretï¼›</p><p>ä¸»å¯†é’¥ï¼ˆMaster Secretï¼‰æ˜¯ç”±é¢„å¤‡ä¸»å¯†é’¥ Premaster secret å³ R3ã€R1 å’Œ R2 é€šè¿‡ PRFï¼ˆPredoRandomFunctionï¼Œä¼ªéšæœºæ•°å‡½æ•°ï¼‰ å‡½æ•°ç”Ÿæˆçš„ï¼ˆä¸è¿‡åœ¨ TLS 1.3 ä¸­ï¼Œä¸å†ä½¿ç”¨ PRF è¿™ç§ç®—æ³•äº†ï¼Œè€Œæ˜¯é‡‡ç”¨æ›´æ ‡å‡†çš„ HKDF ç®—æ³•æ¥è¿›è¡Œå¯†é’¥çš„æ¨å¯¼ï¼‰ï¼Œåç»­å®¢æˆ·ç«¯ã€æœåŠ¡ç«¯ä½¿ç”¨çš„ <strong>ä¼šè¯å¯†é’¥</strong> åˆ™æ˜¯ç”±ä¸»å¯†é’¥æ ¹æ®ä¸€å®šçš„ç®—æ³•ç”Ÿæˆçš„ã€‚å¦å¤–è¦æ³¨æ„çš„æ˜¯ï¼Œä¼šè¯å¯†é’¥ä¹Ÿä¼šå˜çš„ï¼Œåªæ˜¯åœ¨å½“å‰æŸä¸ªä¼šè¯ä¸­å®ƒæ˜¯ä¸å˜çš„å¦å¤–å»ºç«‹ä¼šè¯åå®ƒåˆæ”¹å˜äº†ã€‚</p><p>éšæœºæ•°çš„äº§ç”Ÿæµç¨‹å›¾:<br><img src="/upload/images/2017/02/08/HTTPS_Random.png" alt="1"></p><p>æ— è®ºæ˜¯å•å‘è®¤è¯è¿˜æ˜¯åŒå‘è®¤è¯éƒ½ä¼šç”Ÿæˆä¸‰ä¸ªéšæœºæ•°å³ä¸Šè¿°æµç¨‹ä¸­çš„ R1ã€R2ã€R3ï¼Œæ ¹æ®ä¸‰ä¸ªéšæœºæ•°åˆ›å»ºä¸€ä¸ªå¯¹ç§°åŠ å¯†çš„ç§˜é’¥ã€‚å‰ä¸¤ä¸ªéšæœºæ•°å¯ä»¥è¢«æŠ“åŒ…æ‹¿åˆ°ï¼Œä½†ç¬¬ä¸‰ä¸ªéšæœºæ•°å·²ç»ä½¿ç”¨éå¯¹ç§°åŠ å¯†ç®—æ³•åŠ å¯†è¿‡ï¼Œæ‰€ä»¥æœ€ç»ˆç”Ÿæˆçš„ç§˜é’¥æ˜¯ä¿å¯†çš„ã€‚å¯¹ç§°ç§˜é’¥çš„å®‰å…¨é ç¬¬ä¸‰ä¸ªéšæœºæ•°çš„ä¸å¯ç ´è§£æ¥ä¿è¯ã€‚ç†è®ºä¸Šæ¥è¯´ï¼Œåªè¦æœåŠ¡å™¨çš„å…¬é’¥è¶³å¤Ÿé•¿ï¼Œé‚£ä¹ˆ R3ï¼ˆä¹Ÿè¢«ç§°ä¹‹ä¸º <code>Premaster secret</code>ï¼‰ å¯ä»¥ä¿è¯ä¸è¢«ç ´è§£ã€‚ä½†æ˜¯ä¸ºäº†è¶³å¤Ÿå®‰å…¨ï¼Œå¯ä»¥è€ƒè™‘æŠŠæ¡æ‰‹é˜¶æ®µçš„ç®—æ³•ä»é»˜è®¤çš„ RSA ç®—æ³•æ”¹ä¸º <code>Diffie-Hellman</code> ç®—æ³•ï¼ˆç®€ç§° <code>DH</code> ç®—æ³•ï¼‰ã€‚</p><p><strong>æˆ‘ä»¬æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šä¸ºä½•éœ€è¦ç”Ÿæˆ3ä¸ªéšæœºæ•°ï¼Œ1ä¸ªä¸è¡Œå—ï¼Ÿ</strong></p><p>1ã€å¹¶ä¸æ˜¯æ¯ä¸ªä¸»æœºéƒ½èƒ½äº§ç”Ÿå®Œå…¨çš„éšæœºæ•°ï¼Œæœ‰å¾ˆå¤šäº§ç”Ÿçš„éšæœºæ•°åªæ˜¯å¼±éšæœºæ•°è€Œå·²å¦‚èŒƒå›´å°å¯èƒ½è¢«çŒœæµ‹ï¼Œè¿™æ ·å°±ä¸å®‰å…¨äº†ï¼›</p><p>2ã€ç”¨ 3 ä¸ªéšæœºæ•°ä¸€èµ·ç”Ÿæˆå¯†é’¥èƒ½ä½¿å¾—ä¼ªéšæœºæ•°æ›´æ¥è¿‘éšæœºï¼›</p><p>å¤§å®¶å¯ä»¥çœ‹çœ‹ <a href="https://halfrost.com/https-key-cipher/">TLS ä¸­çš„å¯†é’¥è®¡ç®—</a> è¿™ç¯‡æ–‡ç« ï¼Œé‡Œé¢è¯¦ç»†çš„è®²è§£äº†éšæœºæ•°ç”Ÿæˆçš„åŸç†ä»¥åŠä¸åŒ TLS ç‰ˆæœ¬ç”Ÿæˆä¼šè¯å¯†é’¥çš„å·®å¼‚ã€‚</p><h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><p><strong>æ¨èåœ¨çº¿æµç¨‹å›¾å·¥å…·</strong>:</p><p><a href="http://www.veryitman.com/2017/02/08/www.processon.com">ProcessOn</a>.</p><p><strong>æ¨èåšæ–‡</strong>:</p><p>1ã€<a href="http://www.ruanyifeng.com/blog/2014/09/illustration-ssl.html">å›¾è§£SSL&#x2F;TLSåè®®</a></p><p>2ã€<a href="http://www.ruanyifeng.com/blog/2011/02/seven_myths_about_https.html">HTTPSçš„ä¸ƒä¸ªè¯¯è§£(è¯‘æ–‡)</a></p><p>3ã€<a href="http://blog.sina.com.cn/s/blog_56d8ea900100bzpr.html">å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ä»‹ç»å’ŒåŒºåˆ«</a></p><p>4ã€<a href="https://mp.weixin.qq.com/s/LKcdq4HATB05LZUJ7beojw">ä½ è¿HTTPS åŸç†æ²¡ææ‡‚ï¼Œè¿˜ç»™æˆ‘è®²â€œä¸­é—´äººæ”»å‡»â€</a></p><p>æœ¬æ–‡ä¸­å‚è€ƒäº†ä¸Šé¢æ–‡ç« çš„éƒ¨åˆ†å†…å®¹ï¼Œæ„Ÿè°¢ä»¥ä¸Šæ–‡ç« ä½œè€…ä»¬ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
          <category> ç½‘ç»œåè®® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP HTTPS TLS SSL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ATS: HTTP/HTTPS åè®®ä»‹ç»</title>
      <link href="/2017/02/06/ATS-HTTP-HTTPS-%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D/"/>
      <url>/2017/02/06/ATS-HTTP-HTTPS-%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D/</url>
      
        <content type="html"><![CDATA[<p>è‹¹æœåœ¨2017å¹´è¦æ±‚ App å¿…é¡»æ”¯æŒ <code>HTTPS</code>ï¼Œä¸è¿‡, è¿™ä¸ªè¦æ±‚,ï¼Œæœ€ååˆè¢«è‹¹æœè‡ªå·±å»¶æœŸäº†ã€‚æˆ‘åªèƒ½è¯´ï¼Œè‹¹æœçš„å¼€å‘å“¥å“¥ä»¬çœŸä¼šç©â€¦<br>ä½†æ˜¯ä¸ç®¡æ€ä¹ˆè¯´ï¼Œä½œä¸ºä¸€ååˆæ ¼çš„ç¨‹åºå‘˜è¿˜æ˜¯æœ‰ä¹‰åŠ¡å’Œè´£ä»»äº†è§£å¹¶ç†è§£ HTTPS æ•´ä¸ªé€šä¿¡è¿‡ç¨‹ä»¥åŠåŸç†çš„ã€‚</p><p>è¯¥ç³»åˆ—åšå®¢ä»‹ç» iOS ä¸Šé¢çš„ ATS ä»¥åŠç›¸å…³çš„ HTTPS çŸ¥è¯†ï¼Œåˆ†ä¸ºä¸¤ç¯‡æ¥åˆ†äº«ã€‚</p><p>æœ¬ç¯‡æ˜¯ç¬¬ä¸€ç¯‡ï¼Œç¬¬äºŒç¯‡ï¼š<a href="http://www.veryitman.com/2017/02/08/ATS-HTTPS-%E8%AE%A4%E8%AF%81/">ATS: HTTPS è®¤è¯</a> ã€‚</p><p>ä»Šå¤©å…ˆç®€å•äº†è§£ä¸€ä¸‹ HTTPS ä»¥åŠç›¸å…³çš„çŸ¥è¯†ã€‚</p><h2 id="ç›¸å…³åè¯"><a href="#ç›¸å…³åè¯" class="headerlink" title="ç›¸å…³åè¯"></a>ç›¸å…³åè¯</h2><p>å…ˆäº†è§£ä¸€ä¸‹ç›¸å…³çš„å¸¸ç”¨åè¯ã€‚</p><h4 id="1-HTTP"><a href="#1-HTTP" class="headerlink" title="1.HTTP"></a>1.HTTP</h4><p>HyperText Transfer Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®ã€‚</p><h4 id="2-HTTPS"><a href="#2-HTTPS" class="headerlink" title="2.HTTPS"></a>2.HTTPS</h4><p>Hyper Text Transfer Protocol over Secure Socket Layerï¼Œå®‰å…¨çš„è¶…æ–‡æœ¬ä¼ è¾“åè®®ã€‚</p><h4 id="3-SSL"><a href="#3-SSL" class="headerlink" title="3.SSL"></a>3.SSL</h4><p>Secure Socket Layerï¼Œå®‰å…¨å¥—æ¥å­—å±‚ã€‚</p><h4 id="4-TLS"><a href="#4-TLS" class="headerlink" title="4.TLS"></a>4.TLS</h4><p>Transport Layer Securityï¼Œä¼ è¾“å±‚å®‰å…¨.å…¶å‰èº«å°±æ˜¯ SSL.</p><h4 id="5-ATS"><a href="#5-ATS" class="headerlink" title="5.ATS"></a>5.ATS</h4><p>App Transport Securityï¼Œåº”ç”¨ä¼ è¾“å®‰å…¨ã€‚</p><h2 id="åè®®ä»‹ç»"><a href="#åè®®ä»‹ç»" class="headerlink" title="åè®®ä»‹ç»"></a>åè®®ä»‹ç»</h2><h3 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h3><p>HTTP å…¨ç§°æ˜¯ <code>HyperText Transfer Protocol</code>ï¼Œå³è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œæ˜¯äº’è”ç½‘ä¸Šä½¿ç”¨æœ€å¹¿æ³›çš„ä¸€ç§åè®®ï¼Œæ‰€æœ‰ WWW æ–‡ä»¶å¿…é¡»éµå¾ªçš„æ ‡å‡†ã€‚</p><p>HTTP åè®®ä¼ è¾“çš„æ•°æ®éƒ½æ˜¯æœªåŠ å¯†çš„, ä¹Ÿå°±æ˜¯æ˜æ–‡çš„ï¼Œå› æ­¤ä½¿ç”¨ HTTP åè®®ä¼ è¾“éšç§ä¿¡æ¯éå¸¸ä¸å®‰å…¨ã€‚é»˜è®¤ä½¿ç”¨ TCP ç«¯å£ <code>80</code>.</p><h3 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h3><p>å®‰å…¨çš„è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œ<code>Hyper Text Transfer Protocol over Secure Socket Layer</code>ï¼Œç½‘æ™¯å…¬å¼è®¾è®¡äº† SSL(Secure Socket Layer) åè®®ç”¨äºå¯¹ HTTP åè®®ä¼ è¾“çš„æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œä¿è¯ä¼šè¯è¿‡ç¨‹ä¸­çš„å®‰å…¨æ€§ã€‚</p><p>HTTPS åè®®é»˜è®¤ä½¿ç”¨ TCP çš„ <code>443</code>  ç«¯å£ã€‚</p><h3 id="æ‹†åˆ†-HTTPS"><a href="#æ‹†åˆ†-HTTPS" class="headerlink" title="æ‹†åˆ† HTTPS"></a>æ‹†åˆ† HTTPS</h3><h4 id="SSL-åè®®åŠ å¯†æ–¹å¼"><a href="#SSL-åè®®åŠ å¯†æ–¹å¼" class="headerlink" title="SSL åè®®åŠ å¯†æ–¹å¼"></a>SSL åè®®åŠ å¯†æ–¹å¼</h4><p>SSL åè®®å³ç”¨åˆ°äº†å¯¹ç§°åŠ å¯†ä¹Ÿç”¨åˆ°äº†éå¯¹ç§°åŠ å¯†(å…¬é’¥åŠ å¯†)ï¼Œåœ¨å»ºç«‹ä¼ è¾“é“¾è·¯æ—¶ï¼ŒSSL é¦–å…ˆå¯¹å¯¹ç§°åŠ å¯†çš„å¯†é’¥ä½¿ç”¨å…¬é’¥è¿›è¡Œéå¯¹ç§°åŠ å¯†ï¼ˆä¸»è¦ç”¨äºè¯ä¹¦æ ¡éªŒï¼Œè¿™é‡ŒæŒ‡çš„è¯ä¹¦æ˜¯CAè®¤è¯æœºæ„é¢å‘çš„è¯ä¹¦ä¹Ÿå°±æ˜¯å¸¸è¯´çš„æ•°å­—è¯ä¹¦ï¼‰ï¼Œé“¾è·¯å»ºç«‹å¥½ä¹‹åï¼ŒSSL å¯¹ä¼ è¾“å†…å®¹ä½¿ç”¨å¯¹ç§°åŠ å¯†ã€‚</p><blockquote><p>1ã€å¯¹ç§°åŠ å¯†ï¼ˆé€šä¿¡åŒæ–¹ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥è§£å¯†ï¼‰<br>é€Ÿåº¦é«˜ï¼Œå¯åŠ å¯†å†…å®¹è¾ƒå¤§ï¼Œç”¨æ¥åŠ å¯†ä¼šè¯è¿‡ç¨‹ä¸­çš„æ¶ˆæ¯ã€‚</p></blockquote><blockquote><p>2ã€éå¯¹ç§°åŠ å¯†ï¼ˆé€šä¿¡åŒæ–¹ä½¿ç”¨ä¸åŒå¯†é’¥è§£å¯†æˆ–è€…è§£å¯†ï¼‰<br>åŠ å¯†é€Ÿåº¦è¾ƒæ…¢ï¼Œä½†èƒ½æä¾›æ›´å¥½çš„èº«ä»½è®¤è¯æŠ€æœ¯ï¼Œç”¨æ¥åŠ å¯†å¯¹ç§°åŠ å¯†çš„å¯†é’¥ã€‚</p></blockquote><h4 id="HTTP-SSL"><a href="#HTTP-SSL" class="headerlink" title="HTTP+SSL"></a>HTTP+SSL</h4><p>HTTPSï¼Œå¯ä»¥çœ‹åšæ˜¯ HTTP+SSLï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥æŠŠé‡ç‚¹åœ¨ SSL ä¸Šé¢ã€‚</p><h4 id="HTTPS-1"><a href="#HTTPS-1" class="headerlink" title="HTTPS"></a>HTTPS</h4><p>åœ¨ HTTP åŸºç¡€ä¸Šæå‡ºçš„ä¸€ç§å®‰å…¨çš„ HTTP åè®®ï¼Œå› æ­¤å¯ä»¥ç§°ä¸ºå®‰å…¨çš„è¶…æ–‡æœ¬ä¼ è¾“åè®®ã€‚</p><p>HTTP åè®®ç›´æ¥æ”¾ç½®åœ¨ TCP åè®®ä¹‹ä¸Šï¼Œè€Œ HTTPS æå‡ºåœ¨ HTTP å’Œ TCP ä¸­é—´åŠ ä¸Šä¸€å±‚åŠ å¯†å±‚ã€‚</p><p>ä»å‘é€ç«¯çœ‹ï¼Œè¿™ä¸€å±‚è´Ÿè´£æŠŠ HTTP çš„å†…å®¹åŠ å¯†åé€åˆ°ä¸‹å±‚çš„ TCPï¼Œä»æ¥æ”¶æ–¹çœ‹ï¼Œè¿™ä¸€å±‚è´Ÿè´£å°† TCP é€æ¥çš„æ•°æ®è§£å¯†è¿˜åŸæˆ HTTP çš„å†…å®¹ã€‚</p><h4 id="SSL-Secure-Socket-Layer"><a href="#SSL-Secure-Socket-Layer" class="headerlink" title="SSL(Secure Socket Layer)"></a>SSL(Secure Socket Layer)</h4><p>æ˜¯ Netscape å…¬å¸è®¾è®¡çš„ä¸»è¦ç”¨äº WEB çš„å®‰å…¨ä¼ è¾“åè®®.<br>å®ƒåœ¨ HTTPS åè®®æ ˆä¸­è´Ÿè´£å®ç°ä¸Šé¢æåˆ°çš„åŠ å¯†å±‚.</p><p>ä¸€ä¸ª HTTPS åè®®æ ˆå¤§è‡´æ˜¯è¿™æ ·çš„ï¼š<br><img src="/upload/images/2017/02/06/HTTP+SSL.png" alt="1"></p><h4 id="TLS"><a href="#TLS" class="headerlink" title="TLS"></a>TLS</h4><p>HTTPSï¼Œä¹Ÿç§°ä½œ HTTP over TLS.</p><p>TLS (ä¼ è¾“å±‚å®‰å…¨, Transport Layer Security) çš„å‰èº«æ˜¯ SSLï¼Œ<code>TLS 1.0</code> é€šå¸¸è¢«æ ‡ç¤ºä¸º <code>SSL 3.1</code>ï¼Œ<code>TLS 1.1</code> ä¸º <code>SSL 3.2</code>ï¼Œ<code>TLS 1.2</code> ä¸º <code>SSL 3.3</code>.</p><blockquote><p>è‹¹æœ ATS (App Transport Security)ï¼Œè¦æ±‚æ”¯æŒ HTTPS çš„ TLS ç‰ˆæœ¬æœ€ä½ä¸º V1.2.</p></blockquote><p>ä¸‹å›¾æè¿°äº†åœ¨ TCP&#x2F;IP åè®®æ ˆä¸­ TLS(å„å­åè®®ï¼‰å’Œ HTTP çš„å…³ç³»:<br><img src="/upload/images/2017/02/06/tcp-ip-model.png" alt="1"></p><p>å…¶ä¸­ Handshake protocolï¼ŒChange Ciper Spec protocol å’Œ Alert protocol ç»„æˆäº† SSL Handshaking Protocols.</p><p>SSL å’Œ TLS çš„å‘å±•å†å²:</p><blockquote><p>1994å¹´ï¼ŒNetScape å…¬å¸è®¾è®¡äº† SSL åè®®ï¼ˆSecure Sockets Layerï¼‰çš„ 1.0 ç‰ˆï¼Œä½†æ˜¯æœªå‘å¸ƒã€‚</p></blockquote><blockquote><p>1995å¹´ï¼ŒNetScape å…¬å¸å‘å¸ƒ SSL 2.0 ç‰ˆï¼Œå¾ˆå¿«å‘ç°æœ‰ä¸¥é‡æ¼æ´ã€‚</p></blockquote><blockquote><p>1996å¹´ï¼ŒSSL 3.0 ç‰ˆé—®ä¸–ï¼Œå¾—åˆ°å¤§è§„æ¨¡åº”ç”¨ã€‚</p></blockquote><blockquote><p>1999å¹´ï¼Œäº’è”ç½‘æ ‡å‡†åŒ–ç»„ç»‡ ISOC æ¥æ›¿ NetScape å…¬å¸ï¼Œå‘å¸ƒäº† SSL çš„å‡çº§ç‰ˆ TLS 1.0 ç‰ˆã€‚</p></blockquote><blockquote><p>2006å¹´å’Œ2008å¹´ï¼ŒTLS è¿›è¡Œäº†ä¸¤æ¬¡å‡çº§ï¼Œåˆ†åˆ«ä¸º TLS 1.1 ç‰ˆå’Œ TLS 1.2 ç‰ˆ.æœ€æ–°çš„å˜åŠ¨æ˜¯2011å¹´ TLS 1.2 çš„ä¿®è®¢ç‰ˆã€‚</p></blockquote><blockquote><p>TLS 1.3 æ”¹åŠ¨ä¼šæ¯”è¾ƒå¤§ï¼Œç›®å‰è¿˜åœ¨è‰æ¡ˆé˜¶æ®µã€‚</p></blockquote><h2 id="HTTP-å’Œ-HTTPS-åŒºåˆ«"><a href="#HTTP-å’Œ-HTTPS-åŒºåˆ«" class="headerlink" title="HTTP å’Œ HTTPS åŒºåˆ«"></a>HTTP å’Œ HTTPS åŒºåˆ«</h2><p>HTTPS å’Œ HTTP çš„åŒºåˆ«ä¸»è¦ä¸ºä»¥ä¸‹å››ç‚¹:</p><p>1ã€HTTPS åè®®éœ€è¦åˆ° CA ç”³è¯·è¯ä¹¦ï¼Œä¸€èˆ¬å…è´¹è¯ä¹¦å¾ˆå°‘ï¼Œéœ€è¦äº¤è´¹ï¼Œè´¹ç”¨è¶Šé«˜é‚£ä¹ˆå®‰å…¨æ€§ä¼šè¶Šå¥½ï¼Œæ‰€è°“ä¸€åˆ†ä»·é’±ä¸€åˆ†è´§åœ¨è¿™é‡Œè¢«ä½“ç°çš„æ·‹æ¼“å°½è‡´ã€‚</p><p>2ã€HTTP æ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œä¿¡æ¯æ˜¯æ˜æ–‡ä¼ è¾“ï¼ŒHTTPS åˆ™æ˜¯å…·æœ‰å®‰å…¨æ€§çš„ SLL&#x2F;TLS åŠ å¯†ä¼ è¾“åè®®(éå¯¹ç§°åŠ å¯†)ã€‚</p><p>3ã€HTTP å’Œ HTTPS ä¸åŒçš„è¿æ¥æ–¹å¼ï¼Œç”¨çš„ç«¯å£ä¹Ÿä¸ä¸€æ ·ï¼Œå‰è€…æ˜¯ 80ï¼Œåè€…æ˜¯ 443.</p><p>4ã€HTTP çš„è¿æ¥å¾ˆç®€å•ï¼Œæ˜¯æ— çŠ¶æ€çš„ï¼›HTTPS åè®®æ˜¯ç”± SSL+HTTP åè®®æ„å»ºçš„å¯è¿›è¡ŒåŠ å¯†ä¼ è¾“ã€èº«ä»½è®¤è¯çš„ç½‘ç»œåè®®ï¼Œæ¯” HTTP åè®®æ›´åŠ å®‰å…¨ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
          <category> ç½‘ç»œåè®® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ATS HTTP HTTPS SSL TLS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RN: Yarn</title>
      <link href="/2017/02/05/RN-Yarn/"/>
      <url>/2017/02/05/RN-Yarn/</url>
      
        <content type="html"><![CDATA[<p>React Native æ­£å¼ç‰ˆå·²ç»æ›´æ–°åˆ° 0.41.1 äº†.</p><p>æœ€è¿‘ä½¿ç”¨ <code>react-native-cli</code> æ¥åˆ›å»º React Native å·¥ç¨‹, æç¤ºå¦‚ä¸‹ä¿¡æ¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">This will walk you through creating a new React Native project in /Users/mark/workspace/mzProjs/ReactNative/LatestRN</span><br><span class="line">Installing react-native...</span><br><span class="line">Consider installing yarn to make this faster: https://yarnpkg.com</span><br></pre></td></tr></table></figure><p>å…¶å® Yarn ä¹Ÿä¸€ç›´åœ¨æ›´æ–°, æœ€æ–°ç‰ˆæœ¬ v0.20.0.</p><p>å®˜ç½‘å¯¹åº”çš„æœ‰ä¸­æ–‡ç‰ˆæœ¬å’Œä¸­æ–‡æ–‡æ¡£, å¯ä»¥ <a href="http://yarnpkg.top/">ç‚¹æ­¤è¿›å…¥</a>.</p><h2 id="Yarn-ç®€ä»‹"><a href="#Yarn-ç®€ä»‹" class="headerlink" title="Yarn ç®€ä»‹"></a>Yarn ç®€ä»‹</h2><p>ä¸€å¥è¯ä»‹ç»:</p><blockquote><p>A new package manager for JavaScript</p></blockquote><p>Yarn æ˜¯ä¸€ä¸ªä¾èµ–ç®¡ç†å·¥å…·ï¼Œå®ƒèƒ½å¤Ÿç®¡ç†ä½ çš„ä»£ç ï¼Œå¹¶ä¸å…¨ä¸–ç•Œçš„å¼€å‘è€…åˆ†äº«ä½ çš„ä»£ç .</p><p>Yarn æ˜¯é«˜æ•ˆã€å®‰å…¨å’Œå¯é .</p><blockquote><p>1.é«˜æ•ˆ: ä½¿ç”¨äº†ç¼“å­˜, å¯ä»¥å¾ˆå¿«çš„è·å–å·²ç» download çš„åŒ….<br>2.å®‰å…¨: åœ¨ä»£ç è¢«æ‰§è¡Œä¹‹å‰ï¼Œä¼šä½¿ç”¨CheckSumç®—æ³•éªŒè¯æ¯ä¸€ä¸ªä¾èµ–åŒ…çš„å®Œæ•´æ€§.<br>3.å¯é : åœ¨ä¸åŒå¹³å°(windows&#x2F;mac&#x2F;linux)åªè¦æ˜¯åŒä¸€ä»½é…ç½®æ–‡ä»¶, æ‰§è¡Œç»“æœæ˜¯ä¸€æ ·çš„.</p></blockquote><p>è¿˜æœ‰å¾ˆå¤šç‰¹æ€§:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Offline Mode</span><br><span class="line">If you&#x27;ve installed a package before, you can install it again without any internet connection.</span><br><span class="line">Deterministic</span><br><span class="line">The same dependencies will be installed the same exact way across every machine regardless of install order.</span><br><span class="line">Network Performance</span><br><span class="line">Yarn efficiently queues up requests and avoids request waterfalls in order to maximize network utilization.</span><br><span class="line">Same Packages</span><br><span class="line">Install any package from npm and keep your package workflow the same.</span><br><span class="line">Network Resilience</span><br><span class="line">A single request failing won&#x27;t cause an install to fail. Requests are retried upon failure.</span><br><span class="line">Flat Mode</span><br><span class="line">Resolve mismatching versions of dependencies to a single version to avoid creating duplicates.</span><br></pre></td></tr></table></figure><p>Yarn èƒ½å¤Ÿè®©ä½ ä½¿ç”¨å…¶ä»–å¼€å‘è€…å¼€å‘çš„ä»£ç ï¼Œè®©ä½ æ›´å®¹æ˜“çš„å¼€å‘è½¯ä»¶.</p><p>ä»£ç æ˜¯é€šè¿‡ä¾èµ–åŒ… (æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºç»„ä»¶). åœ¨æ¯ä¸€ä¸ªä¾èµ–ä¸­ä¼šå®šä¹‰ä¸€ä¸ª package.json æ–‡ä»¶ï¼Œç”¨æ¥æè¿°è¿™ä¸ªä¾èµ–åŒ…ä¸­æ‰€æœ‰è¦è¢«åˆ†äº«çš„ä»£ç .</p><p>Yarn æ˜¯å¼€æºçš„, ç‚¹å‡» <a href="http://yarnpkg.top/">Github</a> äº†è§£æ›´å¤š.</p><p>å¯¹æ¯” npm å’Œ yarn, å¯ä»¥é˜…è¯»æ–‡ç« :<br><a href="https://www.sitepoint.com/yarn-vs-npm/">Yarn vs npm: Everything You Need to Know</a></p><p>ä¸­æ–‡ç‰ˆ:<br><a href="https://gold.xitu.io/entry/580de578bf22ec0058330692">è¯‘ Yarn vs npm: ä½ éœ€è¦çŸ¥é“çš„ä¸€åˆ‡</a></p><h2 id="å®‰è£…-Yarn"><a href="#å®‰è£…-Yarn" class="headerlink" title="å®‰è£… Yarn"></a>å®‰è£… Yarn</h2><p>å…·ä½“å®‰è£…çš„æ•™ç¨‹, å¯ä»¥å‚è€ƒå®˜ç½‘çš„ <a href="http://yarnpkg.top/Installation.html">å®‰è£…æ•™ç¨‹</a>.</p><p>åœ¨ MacOS ä¸Šé¢ä½¿ç”¨ Homebrew å®‰è£…å¾ˆæ–¹ä¾¿, ä¸¤ä¸ªå‘½ä»¤å³å¯å®Œæˆ.</p><p>ä¸‹é¢å…·ä½“è¯´è¯´æ“ä½œæ­¥éª¤.</p><p>å¼ºçƒˆå¼€å‘åŒäº‹è´­ä¹°ä¸€ä¸ª VPN, è¿™ä¸ªå¹´å¤´æ²¡æœ‰ VPN, æ—¥å­ä¸å¥½è¿‡.</p><p>1.æ›´æ–° brew</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew update --verbose</span><br></pre></td></tr></table></figure><p>æœ€ååŠ ä¸Šå‚æ•° <code>--verbose</code>, ä¸ç„¶ç­‰å¾…çš„è¿‡ç¨‹å¾ˆç…ç†¬, æ²¡æœ‰ä»»ä½•æç¤ºä¿¡æ¯.</p><p>2.å®‰è£… yarn</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install yarn</span><br></pre></td></tr></table></figure><p>åœ¨å®‰è£…è¿‡ç¨‹ä¸­, å¦‚æœæç¤ºå¦‚ä¸‹ä¿¡æ¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Please note by default only English locale support is provided. If you need</span><br><span class="line">full locale support you should either rebuild with full icu:</span><br><span class="line">  `brew reinstall node --with-full-icu`</span><br><span class="line">or add full icu data at runtime following:</span><br><span class="line">  https://github.com/nodejs/node/wiki/Intl#using-and-customizing-the-small-icu-build</span><br></pre></td></tr></table></figure><p>å¯ä»¥é‡æ–°å®‰è£…å·²ç»å®‰è£…çš„ node, æ‰§è¡Œå‘½ä»¤:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew reinstall node --with-full-icu</span><br></pre></td></tr></table></figure><p>åœ¨æ‰§è¡Œä¸Šé¢å®‰è£…å‘½ä»¤çš„æ—¶å€™, å¦‚æœå¡ä½ä¸åŠ¨æˆ–è€…å¾ˆä¹…, Ctrl+C ç»ˆæ­¢å½“å‰çš„æ“ä½œ, é‡æ–°æ“ä½œä¸€éå³å¯.</p><p>å®‰è£…æˆåŠŸå, å¯ä»¥æŸ¥çœ‹å®‰è£…çš„ç‰ˆæœ¬ä¿¡æ¯, æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn --verbose</span><br></pre></td></tr></table></figure><p>ä¼šæ˜¾ç¤ºå¦‚ä¸‹ä¿¡æ¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yarn install v0.20.0</span><br><span class="line">verbose Performing &quot;GET&quot; request to &quot;https://yarnpkg.com/latest-version&quot;.</span><br><span class="line">[1/4] ğŸ”  Resolving packages...</span><br><span class="line">success Already up-to-date.</span><br><span class="line">âœ¨  Done in 0.29s.</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ brew å®‰è£… Yarn å, ä¸éœ€è¦è®¾ç½®ç¯å¢ƒå˜é‡.</p><h2 id="Yarn-ä¸-React-Native"><a href="#Yarn-ä¸-React-Native" class="headerlink" title="Yarn ä¸ React Native"></a>Yarn ä¸ React Native</h2><p>åœ¨ <code>React Native 0.37</code> ç‰ˆæœ¬ä¸­å·²ç»åŠ å…¥äº†å¯¹ Yarn çš„æ”¯æŒ.</p><p>å¯ä»¥åœ¨ React Native çš„å®˜æ–¹çš„è¿™ç¯‡ <a href="https://facebook.github.io/react-native/blog/2016/11/08/introducing-button-yarn-and-a-public-roadmap.html">Blog</a> æ‰¾åˆ°æ›´å¤šä¿¡æ¯.</p><p>ç”¨ Yarn åˆ›å»º React Native å·¥ç¨‹</p><p>æ—¢ç„¶ RN å·²ç»æ”¯æŒäº† Yarn, é‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨ Yarn æ¥ç®¡ç†å’Œåˆ›å»º RN å·¥ç¨‹äº†.</p><p>ä½¿ç”¨ Yarn, å¿…é¡»æ»¡è¶³å‡ ä¸ªæ¡ä»¶:</p><blockquote><p>1.react-native-cli çš„ç‰ˆæœ¬ä¸èƒ½å°äº 1.2.0 ç‰ˆæœ¬.<br>2.React Natvie å¿…é¡»æ˜¯ 0.37 åŠä»¥ä¸Šçš„ç‰ˆæœ¬.</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native init MZLatestRN</span><br></pre></td></tr></table></figure><p>å½“ä½ å®‰è£…å¥½ Yarn å, æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤å¯ä»¥å‡ºç°æç¤ºä¿¡æ¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">This will walk you through creating a new React Native project in ~/workspace/Projs/ReactNative/MZLatestRN</span><br><span class="line">Using yarn v0.20.0</span><br><span class="line">Installing react-native...</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡º, RN ä¼šä½¿ç”¨ Yarn æ¥åˆ›å»ºå·¥ç¨‹.</p><p>å…¶ä¸­, <code>~/workspace/Projs/ReactNative</code> æ˜¯æˆ‘æœ¬åœ°çš„å·¥ä½œç›®å½•. <code>MZLatestRN</code> æ˜¯è¦åˆ›å»ºçš„ RN å·¥ç¨‹åç§°.</p><p>å¦‚æœä½ çš„ç½‘ç»œå¥½çš„è¯, å¤§æ¦‚1åˆ†é’Ÿå°±å¯ä»¥åˆ›å»ºæˆåŠŸ.</p><p>å·¥ç¨‹ç›®å½•:<br><img src="/upload/images/2017/02/05/1.png" alt="1"></p><p>å¯ä»¥çœ‹å‡ºå¤šäº† <code>yarn.lock</code> æ–‡ä»¶.</p><p>Yarn è¿˜åœ¨èŒå£®æˆé•¿, å¸Œæœ›å®ƒè¶Šæ¥è¶Šå¥½, æ›´å¤šçš„ä½¿ç”¨å’Œå·¥ä½œåŸç†å¯ä»¥å‚è€ƒ <a href="https://yarnpkg.com/docs">å®˜æ–¹ Doc</a>, ä»‹ç»çš„å¾ˆè¯¦ç»†.</p>]]></content>
      
      
      <categories>
          
          <category> ReactNative </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ReactNative iOS Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®‰è£… PHP é‡åˆ°çš„é—®é¢˜</title>
      <link href="/2017/02/02/%E5%AE%89%E8%A3%85-PHP-%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/"/>
      <url>/2017/02/02/%E5%AE%89%E8%A3%85-PHP-%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åœ¨åšå®¢ <a href="http://www.veryitman.com/2017/02/02/PHP-%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87/">PHP å¼€å‘å‡†å¤‡</a> ä»‹ç»äº†å®‰è£…å¹¶éƒ¨ç½² PHP ç¨‹åºåˆ° Nginx.</p><p>ä»Šå¤©åˆ†äº«åœ¨å®‰è£…ä¸­é‡åˆ°çš„é—®é¢˜å’Œå…¶ä»–å·¥å…·çš„å®‰è£…, ä»¥åŠå¸¸ç”¨çš„æ“ä½œ, åŒ…æ‹¬ MySQL, Nginx ç­‰.</p><h2 id="pecl-å®‰è£…"><a href="#pecl-å®‰è£…" class="headerlink" title="pecl å®‰è£…"></a>pecl å®‰è£…</h2><blockquote><p>PEAR æ˜¯ PHP æ‰©å±•ä¸åº”ç”¨åº“(PHP Extension and Application Repository) çš„ç¼©å†™ã€‚å®ƒæ˜¯ä¸€ä¸ª PHP æ‰©å±•åŠåº”ç”¨çš„ä¸€ä¸ªä»£ç ä»“åº“ï¼Œç®€å•åœ°è¯´ï¼ŒPEAR å°±æ˜¯ PHP çš„ CPAN.</p></blockquote><blockquote><p>PECL (PHP Extension Community Library)ï¼ŒPHP çš„æ‰©å±•åº“ï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—å·²çŸ¥çš„æ‰©å±•åº“ï¼Œç”± C++ ç­‰å…¶ä»–è¯­è¨€ç¼–å†™è€Œæˆï¼Œä»¥ .so å½¢å¼å‡ºç°ï¼Œ.so ä¸ºå…±äº«åº“, æ˜¯ shared object, ç”¨äºåŠ¨æ€è¿æ¥çš„, å’Œ dll å·®ä¸å¤šï¼Œä¸ºæ¯” PEAR æ›´å¿«ï¼Œä½†æ˜¯ä¸ PEAR ä¸åŒçš„æ˜¯ï¼ŒPECL éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šé…ç½®å¹¶è¢«æ³¨å†Œåˆ°ä¸»æœºä¸­.</p></blockquote><blockquote><p>æœ€ç›´æ¥çš„è¡¨è¿°: PEAR æ˜¯ PHP çš„ä¸Šå±‚æ‰©å±•ï¼ŒPECL æ˜¯ PHP çš„åº•å±‚æ‰©å±•.</p></blockquote><p>ä¸‹é¢è¯´å¦‚ä½•å®‰è£… pecl å’Œ pear.</p><p>1.ä¸‹è½½ pear</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -O http://pear.php.net/go-pear.phar</span><br></pre></td></tr></table></figure><p>2.å®‰è£… pear</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo php -d detect_unicode=0 go-pear.phar</span><br></pre></td></tr></table></figure><p>3.æ‰§è¡Œä»¥ä¸Šå‘½ä»¤åä¼šè¿›è¡Œå®‰è£…è¿‡ç¨‹ï¼Œä¼šæœ‰ä¸€äº›é…ç½®é€‰é¡¹</p><p>è¾“å…¥1ï¼Œå›è½¦ï¼Œé…ç½® pear è·¯å¾„ä¸ºï¼š<code>/usr/local/pear</code><br>è¾“å…¥4ï¼Œå›è½¦ï¼Œé…ç½®å‘½ä»¤è·¯å¾„ä¸ºï¼š<code>/usr/local/bin</code></p><p>4.å›è½¦ä¸¤æ¬¡ï¼Œå…¶ä»–è®©å…¶é»˜è®¤ï¼Œå®‰è£…å®Œæˆ.</p><p>5.å¯ä»¥é€šè¿‡å‘½ä»¤æ£€æŸ¥ pear æ˜¯å¦å®‰è£…æˆåŠŸ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pear version</span><br></pre></td></tr></table></figure><p>æˆ–è€…æ‰§è¡Œ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pecl version</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ç±»ä¼¼ä¿¡æ¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PEAR Version: 1.10.1</span><br><span class="line">PHP Version: 5.6.27</span><br><span class="line">Zend Engine Version: 2.6.0</span><br></pre></td></tr></table></figure><h2 id="å¸¸ç”¨æ“ä½œ"><a href="#å¸¸ç”¨æ“ä½œ" class="headerlink" title="å¸¸ç”¨æ“ä½œ"></a>å¸¸ç”¨æ“ä½œ</h2><h4 id="MySQL-æ“ä½œ"><a href="#MySQL-æ“ä½œ" class="headerlink" title="MySQL æ“ä½œ"></a>MySQL æ“ä½œ</h4><p>åŸºæœ¬æ“ä½œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql.server start #å¯åŠ¨</span><br><span class="line">mysql.server stop  #åœæ­¢</span><br><span class="line">mysql -u root -p   #ç”¨ user å’Œ pwd è¿æ¥</span><br><span class="line">php-fpm ç›¸å…³æ“ä½œ</span><br></pre></td></tr></table></figure><p>1.è¿è¡Œ php-fpm</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo php-fpm -D</span><br></pre></td></tr></table></figure><p>2.å…³é—­ php-fpm</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo killall php-fpm</span><br></pre></td></tr></table></figure><p>3.æŸ¥çœ‹ php-fpm è¿è¡ŒçŠ¶æ€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo lsof -Pni4 | grep LISTEN | grep php</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° (fpm é»˜è®¤åœ¨ 9000 ç«¯å£)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">php-fpm  84200   root  8u  IPv4 0x91959c43a1ea5abd  0t0  TCP 127.0.0.1:9000 (LISTEN)</span><br><span class="line">php-fpm  84201   _www  0u  IPv4 0x91959c43a1ea5abd  0t0  TCP 127.0.0.1:9000 (LISTEN)</span><br><span class="line">php-fpm  84202   _www  0u  IPv4 0x91959c43a1ea5abd  0t0  TCP 127.0.0.1:9000 (LISTEN)</span><br><span class="line">php-fpm  84203   _www  0u  IPv4 0x91959c43a1ea5abd  0t0  TCP 127.0.0.1:9000 (LISTEN)</span><br></pre></td></tr></table></figure><p>4.php-fpm å¼€æœºå¯åŠ¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ln -sfv /usr/local/opt/php56/*.plist ~/Library/LaunchAgents</span><br><span class="line">launchctl load ~/Library/LaunchAgents/homebrew.mxcl.php56.plist</span><br></pre></td></tr></table></figure><h4 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h4><p>1.æµ‹è¯•é…ç½®æ˜¯å¦æœ‰è¯­æ³•é”™è¯¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -t</span><br></pre></td></tr></table></figure><p>2.å¯åŠ¨ nginx</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nginx</span><br></pre></td></tr></table></figure><p>3.é‡æ–°åŠ è½½é…ç½®|é‡å¯|åœæ­¢|é€€å‡º nginx</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -s reload|reopen|stop|quit</span><br></pre></td></tr></table></figure><p>4.å¼€æœºå¯åŠ¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ln -sfv /usr/local/opt/nginx/*.plist ~/Library/LaunchAgents</span><br><span class="line">launchctl load ~/Library/LaunchAgents/homebrew.mxcl.nginx.plist</span><br></pre></td></tr></table></figure><p>5.nginx ç›‘å¬ 80 ç«¯å£ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo chown root:wheel /usr/local/Cellar/nginx/1.6.0_1/bin/nginx</span><br><span class="line">sudo chmod u+s /usr/local/Cellar/nginx/1.6.0_1/bin/nginx</span><br></pre></td></tr></table></figure><h2 id="å¸¸ç”¨ç›®å½•"><a href="#å¸¸ç”¨ç›®å½•" class="headerlink" title="å¸¸ç”¨ç›®å½•"></a>å¸¸ç”¨ç›®å½•</h2><p>å› ä¸ºä½¿ç”¨äº† Homebrew å®‰è£…çš„ PHP, é…ç½®æ–‡ä»¶çš„ç›®å½•ä¸æ˜¯å¸¸è§„çš„ &#x2F;etc</p><p>è¿™é‡Œæœ‰å‡ ä¸ªç›®å½•éœ€è¦çŸ¥é“, å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/private/etc</span><br><span class="line">/usr/local/etc/php/5.6</span><br><span class="line">/usr/local/var/www</span><br></pre></td></tr></table></figure><h2 id="é‡åˆ°é—®é¢˜"><a href="#é‡åˆ°é—®é¢˜" class="headerlink" title="é‡åˆ°é—®é¢˜"></a>é‡åˆ°é—®é¢˜</h2><p>1.æ‰§è¡Œ sudo php-fpm -D æŠ¥ php56-intl&#x2F;intl.so åŠ è½½é—®é¢˜</p><p>warning çš„å†…å®¹å¤§è‡´å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">NOTICE: PHP message: PHP Warning:  PHP Startup: Unable to load dynamic library &#x27;/usr/local/opt/php56-intl/intl.so&#x27; - dlopen(/usr/local/opt/php56-intl/intl.so, 9): image not found in Unknown on line 0</span><br><span class="line">&lt;br /&gt;</span><br><span class="line">&lt;b&gt;Warning&lt;/b&gt;:  PHP Startup: Unable to load dynamic library &#x27;/usr/local/opt/php56-intl/intl.so&#x27; - dlopen(/usr/local/opt/php56-intl/intl.so, 9): image not found in &lt;b&gt;Unknown&lt;/b&gt; on line &lt;b&gt;0&lt;/b&gt;&lt;br /&gt;</span><br><span class="line">Unknown(0) : Warning - PHP Startup: Unable to load dynamic library &#x27;/usr/local/opt/php56-intl/intl.so&#x27; - dlopen(/usr/local/opt/php56-intl/intl.so, 9): image not found</span><br><span class="line">[31-Dec-2016 22:40:38] NOTICE: PHP message: PHP Warning:  PHP Startup: mcrypt: Unable to initialize module</span><br><span class="line">Module compiled with build ID=API20131226,NTS</span><br><span class="line">PHP    compiled with build ID=API20131226,NTS,debug</span><br><span class="line">These options need to match</span><br><span class="line"> in Unknown on line 0</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ¡ˆ: æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤, å³å¯è§£å†³.æ–¹æ¡ˆæ¥æº <a href="https://github.com/Homebrew/homebrew-php/issues/2544">Github</a>.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew reinstall --build-from-source php56-intl</span><br></pre></td></tr></table></figure><p>2.æ‰§è¡Œ sudo php-fpm -D æŠ¥ PHP Startup: mcrypt: Unable to initialize module</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">31-Dec-2016 22:56:51] NOTICE: PHP message: PHP Warning:  PHP Startup: mcrypt: Unable to initialize module</span><br><span class="line">Module compiled with build ID=API20131226,NTS</span><br><span class="line">PHP    compiled with build ID=API20131226,NTS,debug</span><br><span class="line">These options need to match</span><br><span class="line"> in Unknown on line 0</span><br><span class="line">&lt;br /&gt;</span><br><span class="line">&lt;b&gt;Warning&lt;/b&gt;:  PHP Startup: mcrypt: Unable to initialize module</span><br><span class="line">Module compiled with build ID=API20131226,NTS</span><br><span class="line">PHP    compiled with build ID=API20131226,NTS,debug</span><br><span class="line">These options need to match</span><br><span class="line"> in &lt;b&gt;Unknown&lt;/b&gt; on line &lt;b&gt;0&lt;/b&gt;&lt;br /&gt;</span><br><span class="line">Unknown(0) : Warning - PHP Startup: mcrypt: Unable to initialize module</span><br><span class="line">Module compiled with build ID=API20131226,NTS</span><br><span class="line">PHP    compiled with build ID=API20131226,NTS,debug</span><br><span class="line">These options need to match</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ¡ˆ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew reinstall --build-from-source php56-intl</span><br></pre></td></tr></table></figure><p>3.è¿æ¥ mysql</p><p>ä½¿ç”¨ <code>mysql -u root -p</code> è¿æ¥ mysql, æç¤º Canâ€™t connect to local MySQL server through socket â€˜&#x2F;tmp&#x2F;mysql.sock é”™è¯¯.</p><p>è§£å†³æ–¹æ¡ˆ: å¯åŠ¨ mysql</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql.server start</span><br></pre></td></tr></table></figure><p>é‡æ–°è¿æ¥å³å¯.</p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP MySql nginx php-fpm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP å¼€å‘å‡†å¤‡</title>
      <link href="/2017/02/02/PHP-%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87/"/>
      <url>/2017/02/02/PHP-%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87/</url>
      
        <content type="html"><![CDATA[<p><strong>æ³¨æ„</strong>ï¼šè¿™ç¯‡æ–‡ç« æ˜¯åŸºäº Homebrew å®‰è£… php5.6 ä»¥åŠ nginx å’Œ mysql çš„ä»‹ç»ï¼Œå®‰è£…é«˜ç‰ˆæœ¬çš„ php è¯·ç»•è¡Œã€‚</p><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>äº²è‡ªå®è·µåœ¨ MacOS ä¸Šé¢å®‰è£… PHP5.6+MySQL+Nginx.</p><p>å°†è‡ªå·±é‡åˆ°çš„é—®é¢˜å’Œå¯¹åº”çš„è§£å†³æ–¹æ¡ˆ, åˆ†äº«å‡ºæ¥, å¸Œæœ›èƒ½å¸®åˆ°ä½ .</p><p>MacOS ä¸Šé¢æ­å»º PHP å¼€å‘ç¯å¢ƒ, ä½¿ç”¨ Homebrew æ¥å®‰è£…å¯¹åº”çš„å¼€å‘å¥—ä»¶, å°±æ›´åŠ ç®€å•äº†.</p><p>è¿™ç¯‡åšå®¢çš„ç›®çš„å°±æ˜¯å®‰è£… PHP å¼€å‘ç¯å¢ƒ, å¹¶å°†ç¬¬ä¸€ä¸ª PHP ç¨‹åºéƒ¨ç½²åœ¨ Nginx ä¸Šé¢.</p><p>å¦‚æœåœ¨å®‰è£…å’Œä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜, å¯ä»¥æŸ¥çœ‹è¿™ç¯‡åšå®¢: <a href="http://www.veryitman.com/2017/02/02/%E5%AE%89%E8%A3%85-PHP-%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/">Mac PHP å®‰è£…é‡åˆ°çš„é—®é¢˜</a>.</p><p>ä¸‹é¢å¼€å§‹ä»‹ç»å…·ä½“çš„å®‰è£…æ­¥éª¤.</p><h2 id="ä¸€-å®‰è£…-Homebrew"><a href="#ä¸€-å®‰è£…-Homebrew" class="headerlink" title="ä¸€. å®‰è£… Homebrew"></a>ä¸€. å®‰è£… Homebrew</h2><p>è¿™ä¸ªå¤§å®¶å¯ä»¥è‡ªè¡Œè®¿é—® <a href="http://brew.sh/">Homebrew</a> äº†è§£, è¿™é‡Œä¸å†æ¶‰åŠå…·ä½“çš„å®‰è£…è¿‡ç¨‹å’Œæ–¹æ³•.</p><h2 id="äºŒ-å®‰è£…-php56"><a href="#äºŒ-å®‰è£…-php56" class="headerlink" title="äºŒ. å®‰è£… php56"></a>äºŒ. å®‰è£… php56</h2><blockquote><p>1.åŠ å…¥å®˜æ–¹æº</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">brew tap homebrew/dupes</span><br><span class="line">brew tap homebrew/versions</span><br><span class="line">brew tap homebrew/php</span><br></pre></td></tr></table></figure><blockquote><p>2.å®‰è£… PHP</p></blockquote><p>é»˜è®¤å®‰è£…ä¼šè¿è¡Œåœ¨ Apache ä¸‹.<br>è€Œæˆ‘ä»¬è¦ä½¿å®ƒè¿è¡Œåœ¨ PHP-fpm ä¸‹ï¼Œæ‰€ä»¥è¦å¢åŠ å‚æ•°:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--with-fpm --without-apache</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æ‰€æœ‰å®‰è£…å‚æ•°å¯ä»¥è¾“å…¥:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew option php56</span><br></pre></td></tr></table></figure><p>è¿›è¡ŒæŸ¥çœ‹ï¼Œå‚è€ƒå®‰è£…æŒ‡ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">brew install php56 \</span><br><span class="line">--without-snmp \</span><br><span class="line">--without-apache \</span><br><span class="line">--with-debug \</span><br><span class="line">--with-fpm \</span><br><span class="line">--with-intl \</span><br><span class="line">--with-homebrew-curl \</span><br><span class="line">--with-homebrew-libxslt \</span><br><span class="line">--with-homebrew-openssl \</span><br><span class="line">--with-imap \</span><br><span class="line">--with-mysql \</span><br><span class="line">--with-tidy</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä½¿ç”¨äº†ä¸‹é¢çš„é€‰é¡¹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">with-homebrew-curl</span><br></pre></td></tr></table></figure><p>æˆ‘è¯•è¿‡ä¸å¸¦æ­¤é€‰é¡¹, å®‰è£… PHP56 ä¼šå¤±è´¥, æ‰¾ä¸åˆ° curl.</p><p>å®‰è£…æˆåŠŸå, å¯ä»¥æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php -v</span><br><span class="line">php-fpm -v</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶çœ‹åˆ°æ˜¯çš„ç³»ç»Ÿè‡ªå¸¦çš„ç‰ˆæœ¬.</p><p>ä¸‹é¢ä¸€æ­¥æ˜¯å¢åŠ ç¯å¢ƒå˜é‡, å®Œæˆååœ¨çœ‹ç‰ˆæœ¬ä¿¡æ¯, å³å¯.</p><blockquote><p>3.é…ç½® PHP ç¯å¢ƒå˜é‡</p></blockquote><p>é…ç½®ç¯å¢ƒå˜é‡çš„ç›®çš„æ˜¯è¦ä½¿ç”¨ brew å®‰è£…çš„ PHP å’Œ PHP-fpm, ä¸ä½¿ç”¨ MacOS è‡ªå¸¦çš„ PHP ç‰ˆæœ¬.</p><p><code>/usr/local/sbin/</code> ä¸‹é¢æ˜¯æˆ‘ä»¬ brew å®‰è£…çš„ PHP, å…¶å®ä»–æ˜¯ä¸€ä¸ªè½¯è¿æ¥æŒ‡å‘:<br><code>/usr/local/Cellar/php56/5.6.27_4/sbin</code></p><p><code>/usr/local/bin/</code> ä¸‹é¢ä¹Ÿæ˜¯ brew å®‰è£…çš„ PHP, æŒ‡å‘:<br><code>/usr/local/Cellar/php56/5.6.27_4/bin</code></p><p>vim ~&#x2F;.bash_profile å¢åŠ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=&quot;/usr/local/sbin:$PATH&quot;</span><br></pre></td></tr></table></figure><p>ä½¿å…¶ç«‹å³ç”Ÿæ•ˆ, æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bash_profile</span><br></pre></td></tr></table></figure><p>æˆ–è€…é‡å¯ç»ˆç«¯.</p><p>å¦‚æœæƒ³çœ‹ç³»ç»Ÿçš„ PHP ç‰ˆæœ¬å¯ä»¥è¿™æ ·:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/php -v</span><br></pre></td></tr></table></figure><blockquote><p>4.é…ç½® php-fpm</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /private/etc/php-fpm.conf.default /private/etc/php-fpm.conf</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /private/etc/php-fpm.conf</span><br></pre></td></tr></table></figure><p>æ‰¾åˆ° error_log é¡¹ï¼Œæ·»åŠ ä¸‹é¢é…ç½®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">error_log = /usr/local/var/log/php-fpm.log</span><br><span class="line">pid = /usr/local/var/run/php-fpm.pid</span><br></pre></td></tr></table></figure><p>å¦åˆ™ä¼šæŠ¥:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FPM initialization failed</span><br></pre></td></tr></table></figure><h2 id="ä¸‰-å®‰è£…-nginx"><a href="#ä¸‰-å®‰è£…-nginx" class="headerlink" title="ä¸‰. å®‰è£… nginx"></a>ä¸‰. å®‰è£… nginx</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install nginx</span><br></pre></td></tr></table></figure><p>åˆ›å»ºæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /usr/local/var/logs/nginx</span><br><span class="line">mkdir -p /usr/local/etc/nginx/sites-available</span><br><span class="line">mkdir -p /usr/local/etc/nginx/sites-enabled</span><br><span class="line">mkdir -p /usr/local/etc/nginx/conf.d</span><br><span class="line">mkdir -p /usr/local/etc/nginx/ssl</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir -p /var/www</span><br><span class="line">sudo chown :staff /var/www</span><br><span class="line">sudo chmod 775 /var/www</span><br><span class="line">vi /var/www/info.php</span><br><span class="line">vi /var/www/index.html</span><br><span class="line">vi /var/www/403.html</span><br><span class="line">vi /var/www/404.html</span><br></pre></td></tr></table></figure><p>æ”¹å˜ nginx.conf é…ç½®æ–‡ä»¶</p><p>è¯¥é…ç½®æ–‡ä»¶åœ¨ <code>/usr/local/etc/nginx/nginx.conf</code> ä¸‹é¢.</p><p>æˆ‘çš„é…ç½®:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1;</span><br><span class="line"> </span><br><span class="line">error_log  /usr/local/etc/nginx/logs/error.log debug;</span><br><span class="line">pid        /usr/local/var/run/nginx.pid;</span><br><span class="line"> </span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  256;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">http &#123;</span><br><span class="line">    include             mime.types;</span><br><span class="line">    default_type        application/octet-stream;</span><br><span class="line"> </span><br><span class="line">    log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br><span class="line">                      &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class="line">                      &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br><span class="line"> </span><br><span class="line">    access_log  /usr/local/etc/nginx/logs/access.log  main;</span><br><span class="line"> </span><br><span class="line">    sendfile            on;</span><br><span class="line"> </span><br><span class="line">    keepalive_timeout   65;</span><br><span class="line"> </span><br><span class="line">    index index.html index.php;</span><br><span class="line"> </span><br><span class="line">    include /usr/local/etc/nginx/sites-enabled/*; </span><br><span class="line">    include /usr/local/etc/nginx/conf.d/*;</span><br><span class="line">     server &#123;</span><br><span class="line">        listen       8080;</span><br><span class="line">        server_name  localhost;</span><br><span class="line">        #charset koi8-r;</span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line">        location / &#123;</span><br><span class="line">            root   ~/projs/phpdev/nginx/nginx_sites/; #webçš„æ ¹ç›®å½•</span><br><span class="line">            index  index.php index.html index.htm; #åŠ index.php</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">root   ~/projs/phpdev/nginx/nginx_sites/; #webçš„æ ¹ç›®å½•</span><br><span class="line">index  index.php index.html index.htm; #åŠ index.php</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é…ç½®äº†æˆ‘çš„ web ç›®å½•å’Œæ”¯æŒçš„æ–‡ä»¶.</p><h2 id="å››-è¿è¡Œ-PHP"><a href="#å››-è¿è¡Œ-PHP" class="headerlink" title="å››. è¿è¡Œ PHP"></a>å››. è¿è¡Œ PHP</h2><p>åˆ›å»º index.php</p><p>å¯åŠ¨ PHP-fpm</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo php-fpm</span><br></pre></td></tr></table></figure><p>æˆ–è€…ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼æ¥å¯åŠ¨ PHP-fpm</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo php-fpm -D</span><br></pre></td></tr></table></figure><p>å¯åŠ¨ Nginx</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nginx</span><br></pre></td></tr></table></figure><p>ç¼–è¾‘ index.php</p><p>åœ¨ web ç›®å½•(æˆ‘é…ç½®çš„) <code>/Users/mark/workspace/mzProjs/phpdev/nginx/nginx_sites/</code> æ–°å»ºæ–‡ä»¶ <code>index.php</code>.</p><p>index.php é‡Œé¢å¯ä»¥ç¼–å†™ä»£ç :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- lang: php --&gt;</span><br><span class="line">&lt;!-- ~/nginx_sites/index.php --&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">    echo &quot;Hello PHP&quot;;</span><br><span class="line">    echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">    </span><br><span class="line">    echo &quot;å­¦ä¹  php&quot;;</span><br><span class="line">    echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">    echo phpinfo();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æ‰“å¼€æµè§ˆå™¨, ä½ ä¼šçœ‹åˆ°ä¸‹é¢çš„é¡µé¢:<br><img src="/upload/images/2017/02/02/php1.png" alt="1"></p><p>ä¹Ÿå¯ä»¥åœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºå…¶ä»– php æ–‡ä»¶, å¦‚ mark.php æ–‡ä»¶.</p><p>æµè§ˆå™¨ä¸­è¾“å…¥:<br><a href="http://localhost:8080/mark.php">http://localhost:8080/mark.php</a> å¯ä»¥æ‰§è¡Œç›¸å¯¹åº”çš„æ–‡ä»¶.</p><p>è¿™é‡Œçš„ <code>mark.php</code> æ˜¯è‡ªå·±æ–°å»ºçš„ php æ–‡ä»¶.</p><h2 id="äº”-å®‰è£…-MySQL"><a href="#äº”-å®‰è£…-MySQL" class="headerlink" title="äº”. å®‰è£… MySQL"></a>äº”. å®‰è£… MySQL</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install mysql</span><br></pre></td></tr></table></figure><p>ç­‰å¾…å®‰è£…æˆåŠŸåï¼Œç›´æ¥å¯åŠ¨å’Œè¿æ¥æ•°æ®åº“ã€‚</p><ul><li>å¯åŠ¨ mysql</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql.server start</span><br></pre></td></tr></table></figure><ul><li>è¿æ¥ mysql</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP MySql nginx php-fpm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿‡å¹´å›å®¶è¿™å‡ å¤©</title>
      <link href="/2017/01/31/%E8%BF%87%E5%B9%B4%E5%9B%9E%E5%AE%B6%E8%BF%99%E5%87%A0%E5%A4%A9/"/>
      <url>/2017/01/31/%E8%BF%87%E5%B9%B4%E5%9B%9E%E5%AE%B6%E8%BF%99%E5%87%A0%E5%A4%A9/</url>
      
        <content type="html"><![CDATA[<p>ä»æ”¾å‡å›å®¶åˆ°ç°åœ¨å·²ç»ä¸€ä¸ªå¤šæ˜ŸæœŸäº†, æ„Ÿè§¦é¢‡å¤š.</p><p>ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªæ„Ÿè§¦:</p><blockquote><p>1.å¥åº·æœ€é‡è¦.<br>2.åšæŒåšå¥½ä¸€ä»¶äº‹æƒ….<br>3.æ„Ÿæ©.</p></blockquote><p><img src="/upload/images/2017/01/31/1.jpeg" alt="1"></p><h2 id="å¥åº·"><a href="#å¥åº·" class="headerlink" title="å¥åº·"></a>å¥åº·</h2><p>å‰ä¸¤å¹´å›å®¶, è¿˜èƒ½è§ç€å¾ˆå¤šé•¿è¾ˆ, äº’ç›¸å˜˜å¯’é—®æš–, å®¶é•¿é‡ŒçŸ­çš„é—²èŠ, å¦‚ä»Šæœ‰äº›å·²ç¦»æˆ‘è¿œå».</p><p>æ— æƒ…çš„ç–¾ç—…å¤ºèµ°äº†å°šæœªèŠ±ç”²çš„ä»–ä»¬, è®©äººä¸ç¦æ„Ÿå¹ç”Ÿå‘½çš„è„†å¼±.</p><p>æˆ‘å°çš„æ—¶å€™, å¾ˆå–œæ¬¢å’Œé•¿è¾ˆä»¬èŠå¤©.</p><p>ä¸»è¦æ˜¯ä»–ä»¬è®², æˆ‘åšä¸€ä¸ªå°å°çš„å¬ä¼—, è§‰å¾—ä»–ä»¬æ‡‚å¾—ç‰¹åˆ«å¤š, ä»å¤©æ–‡åˆ°åœ°é‡Œ, ä»æ–‡å­¦åˆ°è‰ºæœ¯, è®²çš„æœ‰å£°æœ‰è‰².<br>æ¯é€¢å¤å­£, æˆ‘éƒ½ä¼šæ¬ç€å°æ¿å‡³, åœ¨å±‹å‰çš„è€æ ‘ä¸‹, çº ç¼ ä»–ä»¬, é€¼ç€åš·ç€è®©ä»–ä»¬ç»™æˆ‘è®²æ•…äº‹, ç”­ææœ‰å¤šé«˜å…´.</p><p>å¦‚ä»Š, è€æ ‘çŠ¹åœ¨, ä»–ä»¬å·²ä¸åœ¨äººä¸–.ç¹ç‰©æ€äºº.</p><p>å†œæ‘å¤§éƒ¨åˆ†äºº, ä¸å¤ªå…³æ³¨è‡ªå·±çš„å¥åº·, å”¯ä¸€è¡¡é‡è‡ªå·±èº«ä½“çŠ¶å†µçš„æ ‡å‡†å°±æ˜¯ <code>ç±³é¥­é¦’å¤´èƒ½åƒå¤šå°‘</code>.</p><p>å¾ˆå¤šäºº, æ˜æ˜å·²ç»æ„Ÿè§‰åˆ°èº«ä½“ä¸é€‚, ä¹Ÿä¸æ„¿æ„å»åŒ»é™¢åšæ£€æŸ¥, å°±è¿™æ ·æ—¥ç§¯æœˆç´¯æˆç–¾.<br>ç­‰å®åœ¨å¿å—ä¸äº†æ‰å»åŒ»é™¢æ£€æŸ¥, ä¸ºæ—¶å·²æ™š.</p><p>å¹³æ—¶ä¸æ³¨æ„è‡ªå·±çš„èº«ä½“, èº«ä½“æ—©æ™šéƒ½ä¼šè®©ä½ æ³¨æ„.</p><p>æ— è®ºå¹³æ—¶å·¥ä½œå†å¿™, ä¹Ÿè¦åšæŒé”»ç‚¼, æ²¡æœ‰å¥åº·çš„ä½“é­„, å…¶ä»–çš„éƒ½æ˜¯æ‰¯æ·¡.</p><h2 id="åšæŒ"><a href="#åšæŒ" class="headerlink" title="åšæŒ"></a>åšæŒ</h2><p>å†œæ‘è¿™å‡ å¹´é¼“åŠ±å¹´è½»äººåœ¨å®¶åˆ›ä¸š, æå…»æ®–. æœ‰å¾ˆå¤šäººæ”¾å¼ƒäº†æ‰“å·¥, å›å®¶æ‹¿ç€è¡¥è´´å¼€å§‹æœ‰æ¨¡æœ‰æ ·çš„åˆ›ä¸š.</p><p>å‰å‡ å¹´å›è€å®¶, çœ‹åˆ°å„ç§æå…»æ®–çš„, æœ‰å…»é¸¡å…»é¸­å…»é¹…çš„, æœ‰å…»ç¾Šå…»çŒªå…»ç‰›çš„, å¦‚é›¨åæ˜¥ç¬‹, éåœ°å¼€èŠ±.</p><p>ä½†æ˜¯ä»Šå¹´å›å®¶, çœ‹åˆ°å¾ˆå¤šè’å‡‰çš„æˆ¿å­, æ— äººé—®æ´¥.</p><p>æˆ‘é—®è¿‡å‡ ä¸ªå°ä¼™å­(ä¹‹å‰åœ¨å®¶æå…»æ®–çš„äºº, æœ€åæ”¾å¼ƒäº†çš„).ä»–ä»¬è·Ÿæˆ‘è¯´çš„åŸºæœ¬éƒ½ä¸€æ ·, å¤ªç´¯äº†, æ”¶ç›Šæ…¢!<br>æå…»æ®–, çš„ç¡®å¾ˆç´¯, ä¹Ÿå¾ˆæ¯ç‡¥æ— å‘³, æ¯å¤©å’Œè¿™äº›ä¸ä¼šè¯´è¯çš„åŠ¨ç‰©ä»¬å¾…åœ¨ä¸€èµ·, å–‚å®ƒä»¬åƒå–, ç®¡ä»–ä»¬æ¸©é¥±, å®åœ¨ä¹å‘³.</p><p>å¦å¤–æœ‰ä¸¤ä¸ªå¹´è½»äºº, ä»å¼€å§‹å…»æ®–åˆ°ç°åœ¨å·²ç»åšæŒäº”å…­å¹´äº†, æå¾—é£ç”Ÿæ°´èµ·, å®¶é‡Œç›–èµ·äº†æ¥¼æˆ¿, å–äº†å·§åª³å¦‡, ç”Ÿäº†èƒ–å°å­, ä¸€å®¶äººå…¶ä¹èè.<br>ä»–ä»¬è·Ÿæˆ‘è¯´çš„åŸºæœ¬ä¸€æ ·, åªè¦åšæŒ, å°±æœ‰æ”¶è·!</p><p>è¿™ä¸¤ä¸ªåšæŒä¸‹æ¥çš„å¹´è½»äºº, ä»–ä»¬ç›¸ä¿¡è‡ªå·±èƒ½å¤ŸæŠŠè¿™ä»½äº‹ä¸šåšå¥½, ä»–ä»¬æŠŠåˆ«äººçœ¼ä¸­çš„è„æ´»ç´¯æ´»å½“åšä¸€ç§å¿«ä¹, ä¸€ç§äº«å—!</p><p>åˆšå¼€å§‹, å¾ˆè‰°éš¾, ä»–ä»¬ä¹Ÿæƒ³è¿‡æ”¾å¼ƒ, ä½†æ˜¯åˆèˆä¸å¾—è¿™å‡ å¹´çš„ä»˜å‡º, äºæ˜¯å°±åšæŒä¸‹æ¥äº†, å¹¶ä¸”æ”¶è·äº†ä¸å°‘æ„æƒ³ä¸åˆ°çš„çŸ¥è¯†, ä¸ç®¡æ˜¯ç‰©è´¨ä¸Šè¿˜æ˜¯ç²¾ç¥ä¸Šéƒ½å¾—åˆ°äº†æ»¡è¶³.</p><p>ä¸–ä¸Š, æ²¡æœ‰ä¸€å¸†é£é¡ºçš„äº‹ä¸š.</p><p>åªè¦è‡ªå·±å–œæ¬¢, æ„Ÿå…´è¶£çš„è¡Œä¸š, å°±å€¼å¾—ä½ å»åšæŒ.<br>å¦‚æœä½ ä»å†…å¿ƒéƒ½ä¸æ„Ÿå…´è¶£, è¶æ—©æ”¾å¼ƒ, å› ä¸ºä½ å¾ˆéš¾åšæŒä¸‹æ¥.</p><p>æƒ³æŠ•æœºå–å·§çš„æˆå°±ä¸€ä»½äº‹ä¸š, åªæœ‰ç¥è¯æ•…äº‹é‡Œæœ‰å§!</p><p>ä¸ç»ä¸€ç•ªå¯’å½»éª¨, å“ªå¾—æ¢…èŠ±æ‰‘é¼»é¦™!</p><h2 id="æ„Ÿæ©"><a href="#æ„Ÿæ©" class="headerlink" title="æ„Ÿæ©"></a>æ„Ÿæ©</h2><p>å°çš„æ—¶å€™, å®¶é‡Œå¾ˆæ‹®æ®, æˆ‘èƒ½å¤ŸæŠŠå¤§å­¦å¿µå®Œ, ç®€ç›´å°±æ˜¯å¤©æ„.</p><p>çˆ¶æ¯æ°¸è¿œåªä¼šå¯¹æˆ‘è¯´ä¸€å¥è¯, åªè¦ä½ æƒ³ä¸Šå­¦, æˆ‘ä»¬å°±æ”¯æŒåˆ°åº•.</p><p>æˆ‘çŸ¥é“å®¶é‡Œçš„ç»æµæƒ…å†µ, æ‰€ä»¥åœ¨å­¦ä¹ ä¸Šä¹Ÿæ˜¯ä¸é—ä½™åŠ›, æ¯æ¬¡æ”¾å­¦é™¤äº†å¸®çˆ¸çˆ¸å¦ˆå¦ˆå¹²å†œæ´», å°±æ˜¯å®Œæˆå®¶åº­ä½œä¸š, ç»ƒå­—èƒŒä¹¦.</p><p>é‚£ä¸ªæ—¶å€™, ä¸çŸ¥é“å“ªæ¥çš„ç‹ åŠ², å³ä½¿æ˜¯å¯’å†¬è…Šæœˆ, ä¹Ÿè¦åšæŒå†™ä½œä¸š, å³ä½¿æ˜¯æ‰‹éƒ½å†»è‚¿äº†, ä¹Ÿè¦ç»ƒå­—.</p><p>å½“æˆ‘æ¥åˆ°é‡ç‚¹é«˜ä¸­é€šçŸ¥ä¹¦çš„é‚£å¤©, çˆ¶äº²é«˜å…´çš„åˆä¸æ‹¢å˜´, å¿ƒç†å……æ»¡äº†éª„å‚².</p><p>æˆ‘èƒ½æ„Ÿè§‰åˆ°â€¦â€¦</p><p>ç„¶è€Œè€ƒä¸Šé«˜ä¸­, æ¥ä¸‹æ¥å°±æ˜¯å‡‘é’±äº¤å­¦è´¹, éš”å£æœ‰ä¸ªä¼¯ä¼¯, ä»–è¯´å­¦è´¹ä¸å¤Ÿ, ç®—ä»–çš„.<br>é‚£ä¸ªæ—¶å€™, å¤§å®¶å®¶é‡Œéƒ½ä¸å®½è£•, èƒ½å€Ÿé’±ç»™ä½ çš„, ç®€ç›´å°±æ˜¯å¤§æ©äºº.<br>ä¸€ç›´åˆ°ç°åœ¨, æˆ‘éƒ½å¾ˆæ„Ÿæ¿€ä»–, æ¯å¹´è¿‡å¹´å›å®¶, æˆ‘éƒ½ä¼šç»™ä¼¯ä¼¯ä¹°ç‚¹ç¤¼ç‰©, ç»™ä¸ªçº¢åŒ…, é™ªä»–èŠèŠå¤©.ä»–è¿˜å¼€ç©ç¬‘çš„è¯´, å½“å¹´è‡ªå·±çš„æŠ•èµ„, ç®—æ˜¯æœ‰äº†å›æŠ¥äº†.</p><p>è¿™è¾ˆå­, æˆ‘ä»¬æœ€åº”è¯¥æ„Ÿè°¢çš„æ˜¯æˆ‘ä»¬è‡ªå·±çš„çˆ¶æ¯, å…»è‚²æˆ‘ä»¬æˆäºº, é€æˆ‘ä»¬è¯»ä¹¦ä¸Šå­¦. è¿‡å¹´å›å®¶, è¦å¤šé™ªé™ªä»–ä»¬, çæƒœå’Œä»–ä»¬åœ¨ä¸€èµ·çš„æ¯ä¸€åˆ».</p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç”Ÿæ´» åæ€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ æ‚è°ˆ</title>
      <link href="/2017/01/27/%E5%AD%A6%E4%B9%A0%E6%9D%82%E8%B0%88/"/>
      <url>/2017/01/27/%E5%AD%A6%E4%B9%A0%E6%9D%82%E8%B0%88/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©æ˜¯ä¸­å›½ä¼ ç»ŸèŠ‚æ—¥, å¤§å¹´ä¸‰å, ç¥å¤§å®¶æ–°å¹´å¿«ä¹, èº«ä½“å¥åº·, å¹¸ç¦ç¾æ»¡.</p><h2 id="å¼•å­"><a href="#å¼•å­" class="headerlink" title="å¼•å­"></a>å¼•å­</h2><p>æœ€è¿‘æ— è®ºæ˜¯æœ‹å‹è¿˜æ˜¯åŒäº‹æˆ–è€…åšå‹, éƒ½é—®è¿‡æˆ‘å…³äºå­¦ä¹ æ–¹é¢çš„äº‹æƒ….</p><p>æ¢è®¨çš„é—®é¢˜å¤§æ¦‚åˆ†ä¸ºå¦‚ä¸‹å‡ ç§:</p><p>æ€ä¹ˆæœ‰æ•ˆçš„å­¦ä¹ æ–°çŸ¥è¯†?<br>æ€ä¹ˆå¿«é€ŸæŒæ¡æ–°çŸ¥è¯†?<br>æ˜¯å¦æœ‰å¿…è¦æ¯å¤©å­¦ä¹ ?<br>å¦‚ä½•åšæŒå­¦ä¹ ?<br>è°ˆåˆ°å…³äºå­¦ä¹ çš„è¯é¢˜, æˆ‘ä¹Ÿä¸æ˜¯ä»€ä¹ˆä¸“å®¶, æ›´ä¸æ˜¯å¿ƒç†å’¨è¯¢å¸ˆ, åªæ˜¯è°ˆè°ˆä¸ªäººçš„ä¸€äº›çœ‹æ³•å’Œç»å†, å¸Œæœ›èƒ½ç»™å¤§å®¶å¸¦æ¥ä¸€ç‚¹ç‚¹çš„å¸®åŠ©.</p><p>ä¸è¦åªæ˜¯å˜´ä¸Šè¯´ <code>æˆ‘æ„Ÿå…´è¶£</code>, å¦‚æœæ²¡æœ‰é©±åŠ¨å’Œç›®æ ‡, å…´è¶£æ°¸è¿œéƒ½åªæ˜¯å…´è¶£.</p><h2 id="ä½ ä¸ºä»€ä¹ˆå­¦ä¹ å®ƒ"><a href="#ä½ ä¸ºä»€ä¹ˆå­¦ä¹ å®ƒ" class="headerlink" title="ä½ ä¸ºä»€ä¹ˆå­¦ä¹ å®ƒ"></a>ä½ ä¸ºä»€ä¹ˆå­¦ä¹ å®ƒ</h2><p>å­¦ä¹ çŸ¥è¯†ä¹‹å‰, é—®é—®è‡ªå·±ä¸ºä»€ä¹ˆè¦å­¦å®ƒ? å¤§éƒ¨åˆ†äººå­¦ä¹ æ–°ä¸œè¥¿éƒ½æ˜¯ä¸ºäº†å·¥ä½œæˆ–è€…ä¸ºäº†æ›´å¥½çš„å·¥ä½œæˆ–è€…ä¸ºäº†è½¬è¡Œæˆ–è€…å…¶ä»–ç›®çš„, ä¹Ÿæœ‰ä¸€éƒ¨åˆ†äººæ˜¯ä¸ºäº†å…´è¶£çˆ±å¥½.</p><p>è¿™é‡Œæˆ‘åªè°ˆä¸ºäº†å·¥ä½œè€Œå»å­¦ä¹ æ–°çŸ¥è¯†çš„å†…å®¹, å…¶ä»–æ–¹é¢çš„æˆ‘è‡ªå·±ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå¿ƒå¾—ä½“ä¼š, ä¸èƒ½ä¹±è¯´.</p><p>æ—¢ç„¶ä¸ºäº†å·¥ä½œæˆ–è€…æ›´å¥½çš„å·¥ä½œæ¥å­¦ä¹ , é‚£ä¹ˆæˆ‘ä»¬å°±æ˜ç¡®äº†ç›®æ ‡, å¦‚æœä½ å·²ç»æœ‰äº†ç›®æ ‡, æ­å–œä½ , ä½ å³å°†æˆåŠŸäº†.</p><p>æœ‰ä¸€äº›äººè¯´, æˆ‘å­¦ä¹ å®ƒ, è¿™ä¸ªä¸œè¥¿ä¸ä¸€å®šå“ªå¤©å°±æœ‰ç”¨äº†, æˆ‘æ€•å°†æ¥å¤±ä¸š.<br>è¿™ä¸­æ‹…å¿ƒä¸æ˜¯åœ¨æäººå¿§å¤©, ç‰¹åˆ«æ˜¯åœ¨äº’è”ç½‘çš„æ—¶ä»£, å¦‚æœä¸å­¦ä¹ å¾ˆå®¹æ˜“å°±è½ä¼å•¦, å›æ‹…å¿ƒå®Œå…¨åœ¨ç†!</p><p>ä½†æ˜¯, å½“ä¸‹ä½ æœ€åº”è¯¥è€ƒè™‘çš„æ˜¯ç›®å‰æŒæ¡çš„æŠ€èƒ½æ˜¯å¦å·²ç»ç†Ÿç»ƒäº†, æ˜¯å¦æ˜¯èƒ½å¤Ÿç‹¬å½“ä¸€é¢äº†, å¦‚æœæ·±å­¦ä¸‹å»ä¼šä¸ä¼šæ›´æœ‰å‰é€”? å¦‚æœæ˜¯, è¯·ä½ æ·±å…¥å»å­¦ä¹ , ä¸è¦å¤ªæäººå¿§å¤©äº†!</p><p>åœ¨ç²¾é’»ä¸€é—¨å­¦é—®çš„æƒ…å†µä¸‹, å¯ä»¥æ‰©å¤§è‡ªå·±çš„çŸ¥è¯†é¢, è€Œä¸æ˜¯ <code>åƒç€ç¢—é‡Œçœ‹ç€é”…é‡Œ</code> çš„, è¦è„šè¸å®åœ°çš„å¤§æ­¥å‘å‰.</p><h2 id="åšæŒå­¦ä¹ "><a href="#åšæŒå­¦ä¹ " class="headerlink" title="åšæŒå­¦ä¹ "></a>åšæŒå­¦ä¹ </h2><p>ä¸Šé¢çš„æ‰¯æ·¡æœ‰ç‚¹å¤šå•Š.å›æ­£é¢˜.</p><p>æ—¢ç„¶ææ¸…æ¥šäº†ä¸ºä»€ä¹ˆå­¦ä¹ å®ƒ, æ¥ä¸‹æ¥å°±æ˜¯æå®šå®ƒ.</p><p>ä½ éœ€è¦æœ‰åšæŒå­¦ä¹ çš„æ€åº¦å’Œè¡ŒåŠ¨, ä¸ç„¶ä¸€åˆ‡éƒ½ä¼šæˆä¸ºäº‘çƒŸ. é‚£ä¹ˆå½“åˆå’¬ç‰™åˆ‡é½¿çš„æŠ±è´Ÿ, ç»“æœéƒ½æ˜¯å†²åŠ¨çš„æƒ©ç½š.</p><p>å­¦ä¹ æ–°çŸ¥è¯†çš„å‰æœŸæ˜¯å¾ˆç´¯çš„, ä½†æ˜¯åªè¦ä½ æ„å¿—è¶³å¤Ÿåšå®š, ä¸€å®šå¯ä»¥å…‹æœç§ç§å›°éš¾.</p><p>è®°å¾—å½“åˆæ¥æ‰‹ä¸€ä¸ªäºŒæ‰‹é¡¹ç›®, é¡¹ç›®ä¹Ÿæ˜¯è¶³å¤Ÿå¤æ‚, å¹¶ä¸”æœ‰å¾ˆå¤šå¼•æ“ä¹‹å‰éƒ½æ²¡æœ‰ç”¨è¿‡, ä¸Šé¢é¢†å¯¼é€¼å¾—æ¯”è¾ƒç´§, æ²¡åŠæ³•, åªèƒ½å°†å…¶æ‹¿ä¸‹, æ¯å¤©æ™šä¸ŠæŒ‘ç¯å¤œæˆ˜, åœ¨ log çš„æµ·æ´‹é‡Œé¨æ¸¸.</p><p>å¾ˆå¿«è‡ªå·±æŒæ¡äº†æ–°çš„çŸ¥è¯†, ç»“åˆé¡¹ç›®, ä¸æ–­çš„å»è°ƒè¯•å’Œæ€»ç»“, æœ€ç»ˆæŒ‰æœŸå®Œæˆéœ€æ±‚, å›è¿‡å¤´æƒ³æƒ³, æƒ³è¦åšæŒåšå¥½ä¸€ä»¶äº‹æƒ…, é™¤äº†è‡ªèº«çš„è‡ªæˆ‘çº¦æŸ, è¿˜éœ€è¦å¤–ç•Œç¯å¢ƒçš„ å€’é€¼.</p><p>å½“ä½ åšæŒä¸ä½çš„æ—¶å€™, é—®é—®è‡ªå·±, æ˜¯å¦å·²ç»åˆ°äº†æé™, å¦‚æœæ„Ÿåˆ°ç´¯äº†, é€‚å½“çš„æ”¾æ¾ä¸€ä¸‹, æ¯”å¦‚å‡ºå»è·‘ä¸ªæ­¥, æ‰“ä¸ªçƒæˆ–è€…æ‰¾æœ‹å‹å™å™æ—§.</p><p>é€‚å½“çš„ç»™è‡ªå·±ä¸€ç‚¹å‹åŠ›, äº‹åŠåŠŸå€.</p><h2 id="å­¦ä¹ çš„æ¸ é“"><a href="#å­¦ä¹ çš„æ¸ é“" class="headerlink" title="å­¦ä¹ çš„æ¸ é“"></a>å­¦ä¹ çš„æ¸ é“</h2><p>åˆšå¼€å§‹å­¦ä¹ æ–°çŸ¥è¯†, å¤§å®¶éƒ½æ¸´æœ›æœ‰ä¸€äº›å¤§ç‰›èƒ½å¤ŸæŒ‡å¯¼è‡ªå·±, æˆ–è€…èƒ½å¤Ÿä»å‰è¾ˆé‚£é‡Œè·å–ä¸€äº›æ­¦æ—ç§˜ç±, è¿™äº›éƒ½æ˜¯å­¦ä¹ çš„æ¸ é“.</p><p>æœ‰äº›å°ä¼™ä¼´åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­, ä¼šé‡åˆ°å„ç§å„æ ·çš„å›°éš¾, æ¯”å¦‚åœ¨å­¦ä¹ ä¸€é—¨çŸ¥è¯†çš„æ—¶å€™, å‘ç°ç«Ÿç„¶è¿˜éœ€è¦å­¦ä¹ å¦ä¸€é—¨æ–°çŸ¥è¯†, çœŸæ˜¯æ—¥äº†ç‹—äº†!<br>åˆ°è¿™é‡Œ, å¯èƒ½æœ‰äº›äººå°±ä¼šæƒ…ä¸è‡ªç¦çš„é€‰æ‹©äº†æ”¾å¼ƒ, å˜´ä¸Šè¯´è¿˜åœ¨å­¦ä¹ , å…¶å®å¿ƒé‡Œå·²ç»ç–²å€¦.</p><p>è¿˜æœ‰ä¸€äº›åˆå­¦è€…, ä»–ä»¬æ²¡æœ‰ä»€ä¹ˆç»éªŒ, å¦‚æœä¸»åŠ¨æ€§å†å·®ç‚¹, åŠ¨è¾„é‡åˆ°é—®é¢˜å°±é—®, æ ¹æœ¬æ²¡æœ‰è¿‡æ€è€ƒ, å“ªæ€•æ˜¯ä¸€ç‚¹ç‚¹çš„æ€è€ƒéƒ½æ²¡æœ‰.å…¶å®ä»–ä»¬ä¸æ˜¯ä¸æƒ³æ, å°±æ€•æé”™äº†.ä»…ä»…æ˜¯å› ä¸ºæ€•, å°±æˆ›ç„¶è€Œæ­¢äº†!<br>è¿™ç§äºº, ç¡®å®å¯æƒœ, æ‰€ä»¥ä»–ä»¬éœ€è¦æ›´å¤šçš„æŒ‡å¯¼å’Œæ•™è‚².è¿™é‡Œæé†’å¤§å®¶, å­¦ä¹ çŸ¥è¯†, ä¸è¦æ€•çŠ¯é”™, å¤§èƒ†çš„å»è¯•é”™, åœ¨é”™è¯¯ä¸­æˆé•¿, è¿™æ ·ä½ æ‰èƒ½æœ‰æ‰€æ”¶è·.</p><p>è®°å¾—ä»¥å‰ä¸ºäº†å®‰è£… linux, æˆ‘æŠŠåŠå…¬å®¤çš„åŠå…¬ç”µè„‘éƒ½æ ¼å¼åŒ–äº†, ç»„é•¿å·®ç‚¹è¦å¼€é™¤æˆ‘äº†, ç°åœ¨æƒ³æƒ³è™½ç„¶æŒ¨äº†éª‚, ä½†æ˜¯æŒºå€¼å¾—.</p><p>ç°åœ¨äº’è”ç½‘å¾ˆå‘è¾¾, æƒ³å­¦ä¹ çš„ä¸œè¥¿åŸºæœ¬ç½‘ä¸Šéƒ½æœ‰, ä½ å¯ä»¥æ²¡æœ‰æ™ºå•†, æ²¡æœ‰æƒ…å•†, ä½†æ˜¯ä½ ä¸€å®šè¦æœ‰ <code>æœå•† (æœç´¢èƒ½åŠ›)</code>.<br>å½“ä½ è‡ªå·±ç»è¿‡æ€è€ƒ, æ— æ³•è§£å†³é—®é¢˜, å°±å»æœç´¢ç›¸å…³çš„çŸ¥è¯†, å¦‚æœæœç´¢ä¹Ÿå¤±è´¥äº†, å†å»è¯·æ•™åˆ«äºº, è¿™æ ·ä½ å°±å¯ä»¥ä»ä¸­æ”¶è·æ„å¤–çš„æƒŠå–œ.</p><p>æ‰€ä»¥, å­¦ä¹ æ¸ é“çš„é‡è¦æ¥æºä¹‹ä¸€å°±æ˜¯åœ¨äº’è”ç½‘æœç´¢, åŸ¹å…»è‡ªå·±çš„æœç´¢èƒ½åŠ›å¾ˆé‡è¦, æˆ‘å»ºè®®å¤§å®¶ä½¿ç”¨è°·æ­Œæµè§ˆå™¨, ç„¶åä½¿ç”¨ google çš„æœç´¢å¼•æ“, æ­å»ºä¸€å¥—ç¿»å¢™çš„ VPN, è¿™æ ·ä½ å¯ä»¥åœ¨çŸ¥è¯†çš„æµ·æ´‹é‡Œçˆ½ç¿».</p><p>å¦å¤–ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„å­¦ä¹ æ¸ é“å°±æ˜¯ä½ è®¤ä¸ºçš„ç‰›äºº, å‘ä»–ä»¬å­¦ä¹ ç›¸å…³çš„å­¦ä¹ æ–¹æ³•, é—®ä»–ä»¬æ˜¯æ€ä¹ˆå­¦ä¹ çš„, ç„¶åç»“åˆè‡ªå·±çš„å®é™…æƒ…å†µåŠ ä»¥è¿ç”¨, è·Ÿä»–ä»¬å¤šäº¤æµ.</p><h2 id="å¯¹è‡ªå·±â€™ç‹ â€™ä¸€äº›"><a href="#å¯¹è‡ªå·±â€™ç‹ â€™ä¸€äº›" class="headerlink" title="å¯¹è‡ªå·±â€™ç‹ â€™ä¸€äº›"></a>å¯¹è‡ªå·±â€™ç‹ â€™ä¸€äº›</h2><p>æˆ‘ä¹‹å‰æœ‰ä¸ªåä¹ æƒ¯, å–œæ¬¢æ™šä¸Šèººåœ¨åºŠä¸Šçœ‹è§†é¢‘, è¿™äº›è§†é¢‘å¯èƒ½æ˜¯ä¼˜é…·æˆ–è€…è…¾è®¯è§†é¢‘å®¢æˆ·ç«¯çš„, ä¹Ÿæœ‰å¯èƒ½æ˜¯æ–°é—»ç±»çš„ app æ¥æºçš„è§†é¢‘.<br>è§†é¢‘åªè¦çœ‹èµ·æ¥, æ—¶é—´å°±ä¸å—æ§åˆ¶äº†.ç¬¬äºŒå¤©æ—©æ™¨èµ·åºŠä¹Ÿå¾ˆå›°éš¾.</p><p>æœ€åè‡ªå·±æŠŠè§†é¢‘ç±»å’Œæ–°é—»ç±» app å…¨éƒ¨å¸è½½æ‰äº†, ç„¶åæŠŠç›®æ ‡è½¬ç§»åˆ° stackoverflow å’Œ github ä¸Šé¢.<br>é‚£é‡Œæ‰æ˜¯ç¨‹åºå‘˜çš„ä¸–ç•Œ, åªæœ‰ä½ æƒ³ä¸åˆ°çš„, æ²¡æœ‰åšä¸åˆ°çš„.</p><p>ä¸ºäº†å­¦ä¹ æ–°çŸ¥è¯†, ä½ éœ€è¦å¯¹è‡ªå·±ç‹ ä¸€ç‚¹, æ¯å¤©æ‹¿ç‚¹æ—¶é—´å‡ºæ¥æ€»ç»“å’Œå­¦ä¹ , ä¸€ä¸ªæœˆä¸€ä¸ªå­£åº¦ä¸€å¹´ä¸‹æ¥, ä½ æ¯”åˆ«äººéƒ½è¿›æ­¥äº†å¾ˆå¤š.</p><p>å…»æˆä¸€ä¸ªå¥½ä¹ æƒ¯, ç»ˆç”Ÿå—ç›Š.</p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹  ç”Ÿæ´» åæ€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS: èŠèŠ UIWebView ç¼“å­˜</title>
      <link href="/2017/01/15/iOS-%E8%81%8A%E8%81%8A-UIWebView-%E7%BC%93%E5%AD%98/"/>
      <url>/2017/01/15/iOS-%E8%81%8A%E8%81%8A-UIWebView-%E7%BC%93%E5%AD%98/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨å¼€å‘é¡¹ç›®è¿‡ç¨‹ä¸­, ä¸€äº›è‹¥äº¤äº’çš„é¡µé¢ä¼šä½¿ç”¨ HTML å±•ç¤º.</p><p>åœ¨ iOS ä¸­, ä½¿ç”¨ UIWebView çš„é¢‘ç‡è¿˜æ˜¯æ¯”è¾ƒé«˜çš„.</p><p>ä»Šå¤©è·Ÿå¤§å®¶èŠèŠ UIWebView ç¼“å­˜ç›¸å…³çš„è¯é¢˜.</p><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><p>æˆ‘ä»Šå¤©ä½¿ç”¨ Tomcat æ¥ä½œä¸º web å®¹å™¨, åœ¨æœ¬æœºæ­å»ºä¸€ä¸ª web æœåŠ¡å™¨, ç„¶åä½¿ç”¨ iPhone è®¿é—®è¯¥ web é¡µé¢, å±•ç¤ºå’Œæ¢³ç† UIWebview å…³äºç¼“å­˜çš„é—®é¢˜.</p><p>å¦‚æœä½ å¯¹ Tomcat è¿˜ä¸ç†Ÿæ‚‰, å¸Œæœ›ä½ å¯ä»¥å…ˆå»å¤§æ¦‚äº†è§£ä¸€ä¸‹, å¦‚ä½•åœ¨ Mac os ä¸Šé¢å®‰è£…å’Œä½¿ç”¨ Tomcat, å¯ä»¥å‚è€ƒæˆ‘çš„åšæ–‡: [Mac é…ç½® Tomcat8].</p><blockquote><p>Tomcat æ˜¯ä¸€ä¸ªå¼€æ”¾æºä»£ç ã€è¿è¡Œ servlet å’Œ JSP Web åº”ç”¨è½¯ä»¶çš„åŸºäº Java çš„ Web åº”ç”¨è½¯ä»¶å®¹å™¨.<br>Tomcat Server æ˜¯æ ¹æ® servlet å’Œ JSP è§„èŒƒæ‰§è¡Œçš„ï¼Œå› æ­¤å¯ä»¥è¯´ Tomcat Server å®è¡Œäº† Apache-Jakarta è§„èŒƒï¼Œä¸”æ¯”ç»å¤§å¤šæ•°å•†ä¸šåº”ç”¨è½¯ä»¶æœåŠ¡å™¨è¦å¥½.<br>ä½†æ˜¯ Tomcat å¯¹é™æ€æ–‡ä»¶ã€é«˜å¹¶å‘çš„å¤„ç†æ¯”è¾ƒå¼±.</p></blockquote><p>å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™, æˆ‘ä½¿ç”¨çš„ç‰ˆæœ¬åˆ†åˆ«æ˜¯ <code>apache-tomcat-8.5.8</code>, <code>jdk1.8</code>.</p><h2 id="é…ç½®-Tomcat"><a href="#é…ç½®-Tomcat" class="headerlink" title="é…ç½® Tomcat"></a>é…ç½® Tomcat</h2><h3 id="ä¿®æ”¹-server-xml-æ–‡ä»¶"><a href="#ä¿®æ”¹-server-xml-æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹ server.xml æ–‡ä»¶"></a>ä¿®æ”¹ server.xml æ–‡ä»¶</h3><p>æ–‡ä»¶åœ¨ Tomcat çš„æ ¹ç›®å½•çš„ conf ç›®å½•ä¸‹, å¦‚æˆ‘çš„æ–‡ä»¶åœ¨è¿™ä¸ªç›®å½•:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apache-tomcat-8.5.8/conf/server.xml</span><br></pre></td></tr></table></figure><p>å¢åŠ å¦‚ä¸‹å†…å®¹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;Host name=&quot;&lt;your local ip&gt;&quot; debug=&quot;0&quot; appBase=&quot;&lt;base dir&gt;&quot; unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot; xmlValidation=&quot;false&quot;  xmlNamespaceAware=&quot;false&quot;&gt;</span><br><span class="line">&lt;Context path=&quot;&quot; docBase=&quot;&lt;html file path&gt;&quot; debug=&quot;0&quot; reloadable=&quot;true&quot; crossContext=&quot;true&quot;/&gt;</span><br><span class="line">&lt;Logger className=&quot;org.apache.catalina.logger.FileLogger&quot; directory=&quot;logs&quot; prefix=&quot;tot_log.&quot; suffix=&quot;.txt&quot; timestamp=&quot;true&quot;/&gt;</span><br><span class="line">&lt;/Host&gt;</span><br></pre></td></tr></table></figure><p>æ³¨æ„:<br>1.å°†ä¸Šè¿°å†…å®¹æ”¾åˆ° <code>&lt;/Host&gt;</code> å’Œ <code>&lt;/Engine&gt;</code> èŠ‚ç‚¹ä¸­é—´.<br>2.å°† <code>name=&quot;&lt;your local ip&gt;&quot;</code> ä¸­çš„ <your local ip> æ”¹ä¸ºä½ æœ¬æœºçš„ ip åœ°å€.<br>æŸ¥çœ‹æœ¬æœºçš„ ip åœ°å€æ–¹æ³•å¾ˆç®€å•:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifconfig | grep &quot;inet &quot; | grep -v 127.0.0.1</span><br></pre></td></tr></table></figure><p>3.å°† appBase&#x3D;â€<base dir>â€œ ä¸­çš„ <base dir> æ”¹ä¸ºä½ çš„ web ç›®å½•.<br>4.å°† docBase&#x3D;â€<html file path>â€œ ä¸­çš„ <html file path> æ”¹ä¸ºä½ çš„ html ç›®å½•.</p><p>æˆ‘çš„é…ç½®å¦‚ä¸‹(éƒ¨åˆ†):</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;Host name=&quot;localhost&quot;  appBase=&quot;webapps&quot;</span><br><span class="line">            unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot;&gt;</span><br><span class="line">        &lt;!-- SingleSignOn valve, share authentication between web applications</span><br><span class="line">             Documentation at: /docs/config/valve.html --&gt;</span><br><span class="line">        &lt;!--</span><br><span class="line">        &lt;Valve className=&quot;org.apache.catalina.authenticator.SingleSignOn&quot; /&gt;</span><br><span class="line">        --&gt;</span><br><span class="line">        &lt;!-- Access log processes all example.</span><br><span class="line">             Documentation at: /docs/config/valve.html</span><br><span class="line">             Note: The pattern used is equivalent to using pattern=&quot;common&quot; --&gt;</span><br><span class="line">        &lt;Valve className=&quot;org.apache.catalina.valves.AccessLogValve&quot; directory=&quot;logs&quot;</span><br><span class="line">               prefix=&quot;localhost_access_log&quot; suffix=&quot;.txt&quot;</span><br><span class="line">               pattern=&quot;%h %l %u %t &amp;quot;%r&amp;quot; %s %b&quot; /&gt;</span><br><span class="line">&lt;/Host&gt;</span><br><span class="line">        &lt;!--mark é…ç½®é™æ€ç½‘é¡µ. [BEGIN] --&gt;</span><br><span class="line">        &lt;Host name=&quot;192.168.1.103&quot; debug=&quot;0&quot; appBase=&quot;webapps&quot; unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot; xmlValidation=&quot;false&quot;  xmlNamespaceAware=&quot;false&quot;&gt;</span><br><span class="line">            &lt;Context path=&quot;&quot; docBase=&quot;test&quot; debug=&quot;0&quot; reloadable=&quot;true&quot; crossContext=&quot;true&quot;/&gt;</span><br><span class="line">            &lt;Logger className=&quot;org.apache.catalina.logger.FileLogger&quot; directory=&quot;logs&quot; prefix=&quot;tot_log.&quot; suffix=&quot;.txt&quot; timestamp=&quot;true&quot;/&gt;</span><br><span class="line">        &lt;/Host&gt;</span><br><span class="line">        &lt;!--mark é…ç½®é™æ€ç½‘é¡µ. [END] --&gt;</span><br><span class="line">    &lt;/Engine&gt;</span><br><span class="line">  &lt;/Service&gt;</span><br><span class="line">&lt;/Server&gt;</span><br></pre></td></tr></table></figure><p>æå®šä¸Šé¢çš„é…ç½®, æ¥ä¸‹æ¥å¯ä»¥é…ç½®ç›¸å…³ç›®å½•äº†.</p><p>åœ¨ Tomcat çš„æ ¹ç›®å½•æœ‰ä¸ªæ–‡ä»¶å¤¹ webapps, åœ¨ webapps ç›®å½•ä¸‹æ–°å»ºç›®å½• test å³å¯.</p><h2 id="æ„å»º-HTML-é¡µé¢"><a href="#æ„å»º-HTML-é¡µé¢" class="headerlink" title="æ„å»º HTML é¡µé¢"></a>æ„å»º HTML é¡µé¢</h2><p>åœ¨ test ç›®å½•, æ–°å»ºä¸€ä¸ª html æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch test.html</span><br></pre></td></tr></table></figure><p>æ–‡ä»¶å†…å®¹å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"> &lt;p&gt;</span><br><span class="line">&lt;em&gt;Sample&lt;/em&gt; text&lt;/p&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">Now I input another line, with fancy&lt;u&gt;&lt;strong&gt;&lt;em&gt;styles&lt;/em&gt;&lt;/strong&gt;</span><br><span class="line">&lt;/u&gt;.&lt;/p&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">&lt;em&gt;Sample&lt;/em&gt; text&lt;/p&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">Now I input another line, with fancy &lt;u&gt;&lt;strong&gt;&lt;em&gt;styles&lt;/em&gt;&lt;/strong&gt;</span><br><span class="line">&lt;/u&gt;.&lt;/p&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">    mark.zhang is itman.</span><br><span class="line">&lt;/p&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">.button &#123;</span><br><span class="line">    background-color: #4CAF50;</span><br><span class="line">    border: none;</span><br><span class="line">    color: white;</span><br><span class="line">    padding: 15px 32px;</span><br><span class="line">    text-align: center;</span><br><span class="line">    text-decoration: none;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    font-size: 86px;</span><br><span class="line">    margin: 50px 200px 100px 300px;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">    border-radius: 15;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">   &lt;button type=&quot;button&quot; onclick=&quot;myFunction()&quot; class=&quot;button&quot;&gt;Try it&lt;/button&gt;</span><br><span class="line">&lt;/p&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">   function myFunction() &#123;</span><br><span class="line">       alert(&quot;Blog: www.veryitman.com&quot;);</span><br><span class="line">   &#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>æ­å»ºå®Œæˆå, å¯åŠ¨ Tomcat æœåŠ¡å™¨.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">startup.sh</span><br></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨é‡Œé¢é€šè¿‡ ip:port&#x2F;test.html çš„æ–¹å¼æ¥è®¿é—®è¯¥é¡µé¢.</p><p>çœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„æ•ˆæœå³è¡¨ç¤ºæ­å»ºæˆåŠŸ:</p><p><img src="/upload/images/2017/01/15/html.png" alt="1"></p><h2 id="å®¢æˆ·ç«¯è®¿é—®"><a href="#å®¢æˆ·ç«¯è®¿é—®" class="headerlink" title="å®¢æˆ·ç«¯è®¿é—®"></a>å®¢æˆ·ç«¯è®¿é—®</h2><p>å®¢æˆ·ç«¯è®¿é—®è¯¥é¡µé¢, ä½¿ç”¨ UIWebview æ¥è¯·æ±‚(HTTP åè®®)é¡µé¢å†…å®¹.</p><p>ä¸€èˆ¬è¯·æ±‚ä¼šä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ (instancetype)requestWithURL:(NSURL *)URL;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•çš„æè¿°å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Creates and returns a URL request for a specified URL with default cache policy and timeout value.</span><br><span class="line">The default cache policy is NSURLRequestUseProtocolCachePolicy and the default timeout interval is 60 seconds.</span><br></pre></td></tr></table></figure><p>å¤§æ¦‚æ„æ€æ˜¯ä½¿ç”¨çš„ç¼“å­˜ç­–ç•¥æ˜¯æ ¹æ®åè®®æ¥çš„, å³ NSURLRequestUseProtocolCachePolicy. è¶…æ—¶æ—¶é—´é»˜è®¤æ˜¯60s.</p><p>ä¹Ÿå°±æ˜¯è¯´ç±»ä¼¼å¦‚ä¸‹çš„è¯·æ±‚:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NSURLRequest *urlReq = [NSURLRequest requestWithURL:url cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:60.f];</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¦‚æœåè®®æ”¯æŒç¼“å­˜çš„è¯, UIWebview è¯·æ±‚åˆ°çš„æ•°æ®å°±æ˜¯ç¼“å­˜æ•°æ®.è¯¥ç¼“å­˜æ˜¯éœ€è¦ WEB æœåŠ¡å™¨æ”¯æŒçš„.</p><p>è¿™é‡Œæˆ‘æ²¡æœ‰é…ç½® Tomcat çš„ç¼“å­˜.å¯ä»¥æŠ“åŒ…çœ‹ä¸‹:</p><p><img src="/upload/images/2017/01/15/rsp1.png" alt="2"></p><p>åç»­åšå®¢ä¼šåˆ†åˆ«ä¸ºå¤§å®¶ä»‹ç»åœ¨ Tomcat å’Œ Nginx é…ç½®ç¼“å­˜ä¸‹, å®¢æˆ·ç«¯ UIWebview è¯·æ±‚çš„ç›¸å…³é—®é¢˜.</p><p>å®¢æˆ·ç«¯æ˜¾ç¤ºé¡µé¢æ•ˆæœ:<br><img src="/upload/images/2017/01/15/c1.jpeg" alt="2"></p><p>ViewController ä»£ç :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;ViewController.h&quot;</span><br><span class="line"></span><br><span class="line">static NSString * const H5Url = @&quot;http://192.168.1.104:8080/test.html&quot;;</span><br><span class="line"></span><br><span class="line">@interface ViewController () &lt;UIWebViewDelegate&gt;</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong) UIWebView *webView;</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong) UIButton *refBtn;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation ViewController</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    _webView = [[UIWebView alloc] init];</span><br><span class="line">    CGSize boundsSize = self.view.bounds.size;</span><br><span class="line">    self.webView.frame = CGRectMake(0, 20, boundsSize.width, boundsSize.height);</span><br><span class="line">    self.webView.backgroundColor = [UIColor whiteColor];</span><br><span class="line">    self.webView.scrollView.showsHorizontalScrollIndicator = NO;</span><br><span class="line">    self.webView.scrollView.showsVerticalScrollIndicator   = NO;</span><br><span class="line">    self.webView.scalesPageToFit = YES;</span><br><span class="line">    self.webView.delegate = self;</span><br><span class="line">    [self.view addSubview:self.webView];</span><br><span class="line">    </span><br><span class="line">    UIButton *refreshBtn = [UIButton buttonWithType:UIButtonTypeCustom];</span><br><span class="line">    [self.view addSubview:refreshBtn];</span><br><span class="line">    [refreshBtn addTarget:self action:@selector(onRefreshWebView) forControlEvents:UIControlEventTouchUpInside];</span><br><span class="line">    refreshBtn.backgroundColor = [UIColor redColor];</span><br><span class="line">    refreshBtn.layer.masksToBounds = YES;</span><br><span class="line">    refreshBtn.layer.cornerRadius = 5.f;</span><br><span class="line">    refreshBtn.frame = CGRectMake(50, 250, 200, 50);</span><br><span class="line">    [refreshBtn setTitle:@&quot;åˆ·æ–°é¡µé¢&quot; forState:UIControlStateNormal];</span><br><span class="line">    _refBtn = refreshBtn;</span><br><span class="line">    </span><br><span class="line">    [self loadDataUsingCache];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)webView:(UIWebView *)webView didFailLoadWithError:(NSError *)error</span><br><span class="line">&#123;</span><br><span class="line">    NSLog(@&quot;didFailLoadWithError: %@&quot;, error);</span><br><span class="line">    </span><br><span class="line">    [self hideLoading];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request</span><br><span class="line"> navigationType:(UIWebViewNavigationType)navigationType</span><br><span class="line">&#123;</span><br><span class="line">    NSLog(@&quot;shouldStartLoadWithRequest: %@&quot;, request);</span><br><span class="line">    return YES;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)webViewDidStartLoad:(UIWebView *)webView</span><br><span class="line">&#123;</span><br><span class="line">    NSLog(@&quot;webViewDidStartLoad&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)webViewDidFinishLoad:(UIWebView *)webView</span><br><span class="line">&#123;</span><br><span class="line">    NSLog(@&quot;webViewDidFinishLoad&quot;);</span><br><span class="line">    </span><br><span class="line">    [self hideLoading];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//åˆ·æ–°é¡µé¢.</span><br><span class="line">- (void)onRefreshWebView</span><br><span class="line">&#123;</span><br><span class="line">    // æ–¹å¼1: ä¸ä½¿ç”¨ç¼“å­˜è¯·æ±‚æ•°æ®</span><br><span class="line">    //[self loadDataNoUsingCache];</span><br><span class="line">    </span><br><span class="line">    // æ–¹å¼2: æ¸…é™¤ NSCache ç¼“å­˜, å†è¯·æ±‚æ•°æ®</span><br><span class="line">    [self clearAllCache];</span><br><span class="line">    [self loadDataUsingCache];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)loadDataUsingCache</span><br><span class="line">&#123;</span><br><span class="line">    [self showLoading];</span><br><span class="line">    </span><br><span class="line">    NSURL *url = [NSURL URLWithString:H5Url];</span><br><span class="line">    </span><br><span class="line">    NSURLRequest *urlReq = [NSURLRequest requestWithURL:url</span><br><span class="line">                                            cachePolicy:NSURLRequestReturnCacheDataDontLoad</span><br><span class="line">                                        timeoutInterval:10.f];</span><br><span class="line">    </span><br><span class="line">    [self.webView loadRequest:urlReq];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)loadDataWithProtocol</span><br><span class="line">&#123;</span><br><span class="line">    [self showLoading];</span><br><span class="line">    </span><br><span class="line">    NSURL *url = [NSURL URLWithString:H5Url];</span><br><span class="line">    </span><br><span class="line">    [NSURLRequest requestWithURL:url];</span><br><span class="line">    </span><br><span class="line">    NSURLRequest *urlReq = [NSURLRequest requestWithURL:url</span><br><span class="line">                                            cachePolicy:NSURLRequestUseProtocolCachePolicy</span><br><span class="line">                                        timeoutInterval:60.f];</span><br><span class="line">    </span><br><span class="line">    [self.webView loadRequest:urlReq];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)loadDataNoUsingCache</span><br><span class="line">&#123;</span><br><span class="line">    [self showLoading];</span><br><span class="line">    </span><br><span class="line">    NSURL *url = [NSURL URLWithString:H5Url];</span><br><span class="line">    NSURLRequest *urlReq = [NSURLRequest requestWithURL:url</span><br><span class="line">                                            cachePolicy:NSURLRequestReloadIgnoringCacheData</span><br><span class="line">                                        timeoutInterval:20.0];</span><br><span class="line">    [self.webView loadRequest:urlReq];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)clearAllCache</span><br><span class="line">&#123;</span><br><span class="line">    // remove cache rsp</span><br><span class="line">    [[NSURLCache sharedURLCache] removeAllCachedResponses];</span><br><span class="line">    </span><br><span class="line">    [[NSURLCache sharedURLCache] setDiskCapacity:0];</span><br><span class="line">    [[NSURLCache sharedURLCache] setMemoryCapacity:0];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)showLoading</span><br><span class="line">&#123;</span><br><span class="line">    [self.refBtn setTitle:@&quot;åˆ·æ–°ä¸­...&quot; forState:UIControlStateNormal];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)hideLoading</span><br><span class="line">&#123;</span><br><span class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(2 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        [self.refBtn setTitle:@&quot;åˆ·æ–°é¡µé¢&quot; forState:UIControlStateNormal];</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ³¨æ„ä¸‹é¢çš„ ä¸‰ä¸ªæ–¹æ³• :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// ä½¿ç”¨ç¼“å­˜æ•°æ®, å¦‚æœæœ‰ç¼“å­˜çš„è¯</span><br><span class="line">// ä½¿ç”¨è¿™ä¸ªæ–¹æ³•, æ”¹å˜ HTML æˆ–è€… JS ä»£ç </span><br><span class="line">// é¡µé¢ä¸ä¼šæ‹‰å–æœ€æ–°æ•°æ®, è¿˜æ˜¯ä½¿ç”¨ä¹‹å‰è¯·æ±‚åˆ°çš„æ•°æ®.</span><br><span class="line">// é™¤éé‡æ–°åˆ·æ–°</span><br><span class="line">- (void)loadDataUsingCache;</span><br><span class="line">// ä½¿ç”¨åè®®ç¼“å­˜, éœ€è¦ web æœåŠ¡å™¨æ”¯æŒ.</span><br><span class="line">- (void)loadDataWithProtocol;</span><br><span class="line">// ä¸ä½¿ç”¨ç¼“å­˜, åŠ è½½æ•°æ®</span><br><span class="line">- (void)loadDataNoUsingCache;</span><br></pre></td></tr></table></figure><p>å¦å¤–, åˆ·æ–° UIWebview çš„æ–¹å¼å¦‚ä¸‹, æœ‰ ä¸¤ç§æ–¹å¼ æ¥åˆ·æ–°é¡µé¢:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> *  åˆ·æ–°é¡µé¢.</span><br><span class="line"> */</span><br><span class="line">- (void)onRefreshWebView</span><br><span class="line">&#123;</span><br><span class="line">    // æ–¹å¼1: ä¸ä½¿ç”¨ç¼“å­˜è¯·æ±‚æ•°æ®</span><br><span class="line">    //[self loadDataNoUsingCache];</span><br><span class="line">    </span><br><span class="line">    // æ–¹å¼2: æ¸…é™¤ NSCache ç¼“å­˜, å†è¯·æ±‚æ•°æ®</span><br><span class="line">    [self clearAllCache];</span><br><span class="line">    [self loadDataUsingCache];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§åˆ·æ–°æ–¹å¼, ä¼šé‡æ–°åŠ è½½æ•°æ®.<br>ä½†æ˜¯ä¸é€‚åˆå¤šå±‚çº§çš„ HTML é¡µé¢, æ¯”å¦‚ä½ çš„ HTML é¡µé¢æœ‰å¾ˆå¤šå±‚, æƒ³åˆ·æ–°å½“å‰é¡µé¢, å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// é‡æ–°åŠ è½½å½“å‰é¡µé¢</span><br><span class="line">[self.webView reload];</span><br></pre></td></tr></table></figure><h2 id="é™„åŠ "><a href="#é™„åŠ " class="headerlink" title="é™„åŠ "></a>é™„åŠ </h2><p>æŸ¥çœ‹æœ¬æœº IP çš„ shell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">ifconfig | grep &quot;inet &quot; | grep -v 127.0.0.1</span><br></pre></td></tr></table></figure><p>åœæ­¢ Tomcat çš„è¿è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shutdown.sh</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS UIWebView </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>f8app</title>
      <link href="/2017/01/01/f8app/"/>
      <url>/2017/01/01/f8app/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦æ¢è®¨çš„æ˜¯å¦‚ä½•ç¼–è¯‘å’Œè¿è¡Œ f8app.</p><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p><code>f8app</code> æ˜¯ Facebook å¼€æºçš„, åŸºäº React Native å¼€å‘çš„ä¸€æ¬¾ App.</p><p>ä»£ç åŸºæœ¬éƒ½æ˜¯ js çš„, å¾ˆå°‘æœ‰åŸç”Ÿçš„ä»£ç .</p><p><code>f8app</code> æ˜¯å€Ÿé‰´å’Œå­¦ä¹  React Native çš„ä¸Šå¥½èµ„æ–™.</p><p>åŸæ–‡ä»‹ç»:</p><blockquote><p>This is the entire source code of the official F8 app of 2016, available on Google Play and the App Store.</p></blockquote><p>é¡¹ç›®å¼€æºåœ°å€: <a href="https://github.com/fbsamples/f8app">Github</a></p><h2 id="ç¼–è¯‘è¿è¡Œ"><a href="#ç¼–è¯‘è¿è¡Œ" class="headerlink" title="ç¼–è¯‘è¿è¡Œ"></a>ç¼–è¯‘è¿è¡Œ</h2><h3 id="ç¯å¢ƒè¦æ±‚"><a href="#ç¯å¢ƒè¦æ±‚" class="headerlink" title="ç¯å¢ƒè¦æ±‚"></a>ç¯å¢ƒè¦æ±‚</h3><ul><li>å®‰è£…å’Œé…ç½®äº† React Native å¼€å‘ç¯å¢ƒ.</li><li>Xcode 7.3 +</li><li>CocoaPods (only for iOS) 1.0+</li><li>MongoDB (needed to run Parse Server locally)</li></ul><h3 id="æºç æ„å»º"><a href="#æºç æ„å»º" class="headerlink" title="æºç æ„å»º"></a>æºç æ„å»º</h3><p>ä¸‹è½½æºç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/fbsamples/f8app.git</span><br></pre></td></tr></table></figure><p>ä¸‹è½½å®Œæˆå, è¿›å…¥ä¸‹è½½çš„ f8app ç›®å½•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd f8app</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯ iOS çš„è¯, éœ€è¦è¿›å…¥ iOS ç›®å½•æ‰§è¡Œ <code>pod install</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ios</span><br><span class="line">pod install</span><br></pre></td></tr></table></figure><p>åœ¨é¡¹ç›® f8app ç›®å½•ä¸‹è¿è¡Œ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure><p>æ‰“å¼€æµè§ˆå™¨è¾“å…¥åœ°å€ <a href="http://localhost:8080/">http://localhost:8080</a>, å¯ä»¥çœ‹åˆ° graphql çš„ç•Œé¢.</p><h3 id="å®‰è£…-MongoDB"><a href="#å®‰è£…-MongoDB" class="headerlink" title="å®‰è£… MongoDB"></a>å®‰è£… MongoDB</h3><p>ä½¿ç”¨ Homebrew æ¥å®‰è£….</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install mongodb</span><br></pre></td></tr></table></figure><h3 id="å¯¼å…¥æ•°æ®"><a href="#å¯¼å…¥æ•°æ®" class="headerlink" title="å¯¼å…¥æ•°æ®"></a>å¯¼å…¥æ•°æ®</h3><p>å¯¼å…¥ä¾‹å­æ•°æ®.</p><p>æ³¨æ„:<br>åœ¨æºç çš„è·¯å¾„å³ <code>~/yourpath/f8app</code> ä¸‹é¢æ‰§è¡Œ, ä¸‹é¢æ“ä½œæ²¡æœ‰ç‰¹æ®Šè¯´æ˜éƒ½æ˜¯åœ¨æºç æ ¹ç›®å½•ä¸‹é¢æ“ä½œ.<br>ä½ å¯ä»¥å¤šå¼€å‡ ä¸ªç»ˆç«¯ç«¯å£æ¥è¿›è¡Œæ“ä½œ.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run import-data</span><br></pre></td></tr></table></figure><p>å¯¼å…¥ä¾‹å­æ•°æ®, ä¼šæŠ¥ä¸‹é¢çš„ é”™è¯¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">error: Uncaught internal server error. &#123; [MongoError: connect ECONNREFUSED 127.0.0.1:27017]</span><br><span class="line">name: &#x27;MongoError&#x27;,</span><br><span class="line">message: &#x27;connect ECONNREFUSED 127.0.0.1:27017&#x27; &#125; Error: connect ECONNREFUSED 127.0.0.1:27017</span><br><span class="line">at Object.exports._errnoException (util.js:893:11)</span><br><span class="line">at exports._exceptionWithHostPort (util.js:916:20)</span><br><span class="line">at TCPConnectWrap.afterConnect as oncomplete</span><br></pre></td></tr></table></figure><p>éœ€è¦å®‰è£… <code>mongodb-runner</code></p><p>å®‰è£…æ–¹æ³•å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo npm install -g parse-server mongodb-runner</span><br></pre></td></tr></table></figure><p>è¿è¡Œ <code>mongodb-runner</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongodb-runner start</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ‰§è¡Œå®Œæ¯•å, éœ€è¦ç­‰å¾…ä¸€ä¼š.</p><p>ä½ ä¼šçœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Starting a MongoDB deployment to test against...</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¿è¡Œç»“æŸå, ä½ å¯ä»¥æŸ¥çœ‹ MongoDB æ˜¯å¦åœ¨è¿è¡Œ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsof -iTCP:27017 -sTCP:LISTEN</span><br></pre></td></tr></table></figure><p>ä¼šæ˜¾ç¤ºå½“å‰æ­£åœ¨è¿è¡Œçš„ä¿¡æ¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">COMMAND   PID USER   FD   TYPE             DEVICE    SIZE/OFF  NODE  NAME</span><br><span class="line">mongod  86824 mark    7u  IPv4    0x91959c43a65644ed      0t0  TCP *:27017 (LISTEN)</span><br></pre></td></tr></table></figure><p>åœæ­¢ mongodb è¿è¡Œçš„æ–¹å¼å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongodb-runner stop</span><br></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹æ•°æ®"><a href="#æŸ¥çœ‹æ•°æ®" class="headerlink" title="æŸ¥çœ‹æ•°æ®"></a>æŸ¥çœ‹æ•°æ®</h2><p><a href="http://localhost:8080/dashboard">Parse Dashboard</a></p><p><a href="http://localhost:8080/graphql">GraphiQL</a></p><h3 id="å¯åŠ¨-react-native"><a href="#å¯åŠ¨-react-native" class="headerlink" title="å¯åŠ¨ react-native"></a>å¯åŠ¨ react-native</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native start</span><br></pre></td></tr></table></figure><h3 id="è¿è¡Œ-f8app"><a href="#è¿è¡Œ-f8app" class="headerlink" title="è¿è¡Œ f8app"></a>è¿è¡Œ f8app</h3><p>Android:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">react-native run-android</span><br><span class="line">adb reverse tcp:8081 tcp:8081   # required to ensure the Android app can</span><br><span class="line">adb reverse tcp:8080 tcp:8080   # access the Packager and GraphQL server</span><br></pre></td></tr></table></figure><p>iOS:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native run-ios</span><br></pre></td></tr></table></figure><p>å¦‚æœå‡ºç°çº¢è‰²èƒŒæ™¯çš„ error æç¤º, å¯ä»¥ä¸ç®¡, ç›´æ¥ Dismiss å³å¯.</p><p>ç„¶åå¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç•Œé¢:</p><p><img src="/upload/images/2017/01/01/f8app.jpg" alt="1"></p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>1.åœ¨è¿è¡Œåå…³é—­ç™»å½•æŒ‰é’®, æŠ¥é”™: </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AppEventsLogger.logEvent</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ¡ˆ:</p><p>åœ¨ <code>/js/store/track.js</code> æ–‡ä»¶çš„ç¬¬ 43 è¡Œ, æ³¨é‡Šæ‰ log, å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">case &#x27;SKIPPED_LOGIN&#x27;:</span><br><span class="line">      //AppEventsLogger.logEvent(&#x27;Skip login&#x27;, 1);</span><br><span class="line">      break;</span><br></pre></td></tr></table></figure><p>åœ¨æ¨¡æ‹Ÿå™¨ä¸Šé¢é‡æ–° Reload å³å¯.</p>]]></content>
      
      
      <categories>
          
          <category> ReactNative </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS Android JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†è§ 2016</title>
      <link href="/2016/12/31/%E5%86%8D%E8%A7%81-2016/"/>
      <url>/2016/12/31/%E5%86%8D%E8%A7%81-2016/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©æ˜¯2016å¹´çš„æœ€åä¸€å¤©ï¼Œæ­£å¥½èµ¶ä¸Šæ”¾å‡ï¼Œç»™è‡ªå·±çš„è¿™ä¸€å¹´åšä¸ªå°ç»“ã€‚</p><p>2016ï¼Œç»§ç»­åšé¡¹ç›®ï¼Œä½œä¸ºä¸€åè½¯ä»¶å·¥ç¨‹å¸ˆï¼Œä¸åœåœ°åœ¨å­¦ä¹ ã€‚</p><p>2016ï¼Œå­¦ä¹ åˆ°äº†å¾ˆå¤šå…³äºäº§å“å’Œè¿è¥ç›¸å…³çš„çŸ¥è¯†ã€‚çŸ¥é“äº† <code>å€’é€¼</code> çš„ä½œç”¨.</p><p>2016ï¼Œè¯»äº†20æœ¬éæŠ€æœ¯ç±»ä¹¦ç±ï¼Œå…»æˆäº†è¯»ä¹¦çš„ä¹ æƒ¯ï¼Œå¹¶æŠŠè¯»ä¹¦çš„å¥½å¤„è®²ç»™èº«è¾¹çš„äººå¬ã€‚</p><p>2016ï¼Œå¼€å§‹å‡è‚¥ï¼Œæ³¨æ„é”»ç‚¼èº«ä½“ï¼Œå‡ ä¹æ¯å‘¨éƒ½æœ‰ä¸€æ¬¡ä»å…¬å¸åˆ°å®¶çš„æ­¥è¡Œï¼Œä¸€æ¬¡ç¯®çƒæˆ–è€…è·‘æ­¥è¿åŠ¨ã€‚</p><p>2016ï¼Œè´­ä¹°äº†åŸŸåï¼Œå»ºç«‹äº†è‡ªå·±çš„ <a href="file:///Users/mark/Desktop/backups/public/2016/12/31/veryitman.com">åšå®¢ç½‘ç«™</a>ã€‚</p><p>2016ï¼Œå„¿å­å¤§äº†ä¸€å²ï¼Œè‡ªå·±è€äº†ä¸€å²ï¼Œå®¶åº­ä¾æ—§å¹¸ç¦ç€ã€‚æ¸æ¸åœ°ç†è§£äº†åšçˆ¶äº²çš„è´£ä»»ã€‚</p><p>2016ï¼Œå¯¹è‡ªå·±å½±å“æœ€å¤§çš„å‡ å¥è¯ï¼Œåˆ†äº«ç»™å¤§å®¶:</p><p><strong>1. æŠ€æœ¯è¦ç»™äº§å“æä¾›æœ€å¤§çš„è‡ªç”±åº¦.</strong></p><p><strong>2. ä¸è¦è½»æ˜“çš„è¯´ NO.</strong></p><p><strong>3. è¦ä¸æ–­çš„è®©è‡ªå·±å€¼é’±, è€Œä¸æ˜¯ç®€å•çš„ä¸ºäº†é‡‘é’±è€Œè·³æ§½.</strong></p><p><strong>4. ä¸è¦æ€»æ˜¯æŠ±æ€¨ä½ çš„äº§å“è®¾è®¡æ˜¯ç‹—å±, å­¦ä¼šå’Œäº§å“æ²Ÿé€šæ›´ä¼˜çš„æ–¹æ¡ˆ.</strong></p><p><strong>5. å…³æ³¨ç»†èŠ‚, æŠŠäº§å“åšå¥½.</strong></p><p><strong>6. å¤šå…³æ³¨åˆ«äººçš„ä¼˜ç‚¹.</strong></p><p><strong>7. è®©å¯¹æ–¹æŠŠè¯è¯´å®Œ.</strong></p><p><strong>8. å¤šçœ‹ä¹¦, å¤šæ€è€ƒ.</strong></p><p>æ„Ÿè°¢æ‰€æœ‰é™ªä¼´å’Œæ”¯æŒæˆ‘çš„æœ‹å‹ï¼ŒåŒäº‹ï¼Œäº²äººï¼</p><p>ç¥æ„¿æ‰€æœ‰äºº2017å¹¸ç¦ã€å¥åº·ã€å¿«ä¹ï¼</p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éšç¬” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac é…ç½® Tomcat8</title>
      <link href="/2016/11/26/Mac-%E9%85%8D%E7%BD%AE-Tomcat8/"/>
      <url>/2016/11/26/Mac-%E9%85%8D%E7%BD%AE-Tomcat8/</url>
      
        <content type="html"><![CDATA[<h2 id="Tomcat-ç®€ä»‹"><a href="#Tomcat-ç®€ä»‹" class="headerlink" title="Tomcat ç®€ä»‹"></a>Tomcat ç®€ä»‹</h2><p>Tomcat æ˜¯ä¸€ä¸ª Web æœåŠ¡å™¨.</p><blockquote><p>Web æœåŠ¡å™¨æ˜¯æŒ‡ä¸ºç‰¹å®šç»„ä»¶æä¾›æœåŠ¡çš„ä¸€ä¸ªæ ‡å‡†åŒ–çš„è¿è¡Œæ—¶çš„ç¯å¢ƒ.<br>å¯ä¸ºç»„ä»¶æä¾›äº‹åŠ¡å¤„ç†, æ•°æ®è®¿é—®, å®‰å…¨æ€§å’ŒæŒä¹…æ€§ç­‰æœåŠ¡.</p></blockquote><p>Tomcat æ˜¯å…è´¹ä¸”å¼€æºçš„, ä»–æ˜¯ Apache è½¯ä»¶åŸºé‡‘ä¼š Jakarta é¡¹ç›®ä¸­çš„å…¶ä¸­ä¸€ä¸ªå­é¡¹ç›®.ç”± Apache, Sun å’Œå…¶ä»–ä¸€äº›å…¬å¸åŠä¸ªäººå…±åŒå¼€å‘å®Œæˆ.</p><p>Tomcat ä¹Ÿæ˜¯ä½¿ç”¨æœ€ä¸ºå¹¿æ³›çš„ JSP æœåŠ¡å™¨.</p><blockquote><p>JSP æ˜¯ Java Server Pages çš„ç®€ç§°, æ˜¯åœ¨ä¼ ç»Ÿçš„ HTML æ–‡ä»¶ä¸­æ’å…¥ Java ç¨‹åºæ®µå’Œ JSP æ ‡è®°çš„ä¸€ç§åŠ¨æ€ç½‘é¡µæŠ€æœ¯.</p></blockquote><h2 id="ä¸‹è½½-Tomcat"><a href="#ä¸‹è½½-Tomcat" class="headerlink" title="ä¸‹è½½ Tomcat"></a>ä¸‹è½½ Tomcat</h2><p>å‰å¾€ <a href="http://tomcat.apache.org/download-80.cgi">è¿™é‡Œ</a> å¯ä»¥ä¸‹è½½ Tomcat.</p><p>æˆ‘ç›®å‰å®‰è£…çš„æ˜¯ 8.5.8 ç‰ˆæœ¬çš„.</p><p><img src="/upload/images/2016/11/26/tomcat1.png" alt="1"></p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>å…ˆå®‰è£… JDK, å®‰è£…æ•™ç¨‹å¯ä»¥å‚è€ƒ <a href="http://www.veryitman.com/2016/11/26/Mac-%E9%85%8D%E7%BD%AE-Tomcat8/">Mac é…ç½® JDK1.8</a> è¿™ç¯‡æ–‡ç« .</p><p>è§£å‹ä¸‹è½½çš„ tar.gz å³å¯.</p><p>æœ€å¥½è§£å‹åˆ°è‡ªå·±çš„å·¥ä½œç›®å½•, å¦‚:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/workspace/developr/</span><br></pre></td></tr></table></figure><h2 id="é…ç½®ç¯å¢ƒå˜é‡"><a href="#é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="é…ç½®ç¯å¢ƒå˜é‡"></a>é…ç½®ç¯å¢ƒå˜é‡</h2><p>ç¼–è¾‘ <code>/etc/profile</code> æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br></pre></td></tr></table></figure><p>æ·»åŠ å¦‚ä¸‹å˜é‡:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">JRE_HOME=$JAVA_HOME</span><br><span class="line">TOMCAT_HOME=/Users/mark/developer/apache/apache-tomcat-8.5.8</span><br><span class="line">PATH=$JAVA_HOME/bin:$TOMCAT_HOME/bin:$PATH</span><br><span class="line">export JRE_HOME</span><br><span class="line">export PATH</span><br></pre></td></tr></table></figure><p>å…¶ä¸­çš„ JAVA_HOME æ˜¯ <a href="http://www.veryitman.com/2016/11/26/Mac-%E9%85%8D%E7%BD%AE-Tomcat8/">Mac é…ç½® JDK1.8</a> è¿™ç¯‡æ–‡ç« é‡Œé¢è®¾ç½®çš„ JDK çš„ç¯å¢ƒå˜é‡.</p><p>é…ç½®ç¯å¢ƒå˜é‡çš„ç›®çš„, å¯ä»¥è®©æˆ‘ä»¬æ–¹ä¾¿çš„ä½¿ç”¨ Tomcat çš„å‘½ä»¤.</p><h2 id="æ£€éªŒå®‰è£…æ˜¯å¦æˆåŠŸ"><a href="#æ£€éªŒå®‰è£…æ˜¯å¦æˆåŠŸ" class="headerlink" title="æ£€éªŒå®‰è£…æ˜¯å¦æˆåŠŸ"></a>æ£€éªŒå®‰è£…æ˜¯å¦æˆåŠŸ</h2><p>ä½¿ <code>/etc/profile</code> é…ç½®æ–‡ä»¶ç«‹å³ç”Ÿæ•ˆ.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure><p>å¦‚æœæ²¡æœ‰ç”Ÿæ•ˆ, é‡å¯ç»ˆç«¯å³å¯.</p><p>å¼€å¯ Tomcat æœåŠ¡, æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">startup.sh</span><br></pre></td></tr></table></figure><p>è¯¥å‘½ä»¤åœ¨ Tomcat çš„å®‰è£…ç›®å½•çš„ bin ç›®å½•ä¸‹é¢.</p><p>æ‰§è¡Œå, å¯ä»¥çœ‹åˆ°:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Using CATALINA_BASE:   /Users/mark/developer/apache/apache-tomcat-8.5.8</span><br><span class="line">Using CATALINA_HOME:   /Users/mark/developer/apache/apache-tomcat-8.5.8</span><br><span class="line">Using CATALINA_TMPDIR: /Users/mark/developer/apache/apache-tomcat-8.5.8/temp</span><br><span class="line">Using JRE_HOME:        /Library/Java/JavaVirtualMachines/jdk1.8.0_112.jdk/Contents/Home</span><br><span class="line">Using CLASSPATH:       /Users/mark/developer/apache/apache-tomcat-8.5.8/bin/bootstrap.jar:/Users/mark/developer/apache/apache-tomcat-8.5.8/bin/tomcat-juli.jar</span><br><span class="line">Tomcat started.</span><br></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨é‡Œé¢æ‰“å¼€: <a href="http://localhost:8080/">http://localhost:8080/</a></p><p>å³å¯çœ‹åˆ°ä¸€åªå¯çˆ±çš„ Tom çŒ«.</p><p>æ‰§è¡Œ <code>shutdown.sh</code> å¯ä»¥å…³é—­ Tomcat.</p>]]></content>
      
      
      <categories>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tomcat Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac å®‰è£…å’Œä½¿ç”¨ infer</title>
      <link href="/2016/11/26/Mac-%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8-infer/"/>
      <url>/2016/11/26/Mac-%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8-infer/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>infer æ˜¯ Facebook å¼€æºçš„ä¸€æ¬¾ä»£ç é™æ€æ£€æŸ¥å·¥å…·, æºç å¯ä»¥åœ¨ <a href="https://github.com/facebook/infer">Github</a> ä¸Šé¢è·å–.</p><p>æ”¯æŒ Java&#x2F;C&#x2F;OC ç­‰è¯­è¨€, æ”¯æŒ Gradle, Buck, Maven, Xcodebuild, Make ç­‰.</p><p>æˆ‘ä¸€èˆ¬ç”¨æ¥åˆ†æ iOS å’Œ Android å·¥ç¨‹.</p><p>å¯ä»¥åœ¨ <a href="http://fbinfer.com/docs/getting-started.html">è¿™é‡Œ</a> æŸ¥çœ‹ Start.</p><h2 id="å®‰è£…-infer"><a href="#å®‰è£…-infer" class="headerlink" title="å®‰è£… infer"></a>å®‰è£… infer</h2><p>åªè¦ä½ ç”¨ Homebrew, mac ä¸‹å®‰è£… infer å¾ˆç®€å•:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew update</span><br><span class="line">brew install infer</span><br></pre></td></tr></table></figure><p>åœ¨æ—©æœŸç‰ˆæœ¬, infer ä¸æ”¯æŒ brew å®‰è£…. å®‰è£…èµ·æ¥å„ç§é—®é¢˜, ç°åœ¨ infer æ”¯æŒäº† brew å®‰è£…, å¾ˆæ–¹ä¾¿.</p><p>è¿™é‡Œæˆ‘ä½¿ç”¨çš„ infer ç‰ˆæœ¬æ˜¯ 0.9.4.</p><p>å®‰è£…æˆåŠŸå, å¯ä»¥æŸ¥çœ‹å®‰è£…ç‰ˆæœ¬:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">infer -version</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Infer version v0.9.4</span><br><span class="line">Copyright 2009 - present Facebook. All Rights Reserved.</span><br><span class="line">Mac:public mark$ infer --version</span><br><span class="line">Infer version v0.9.4</span><br><span class="line">Copyright 2009 - present Facebook. All Rights Reserved.</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸ªé—®é¢˜, æœ‰æ—¶å€™ brew æ— æ³•æ›´æ–°æœ€æ–°çš„ infer, æˆ‘ç›®å‰çš„è§£å†³æ–¹æ¡ˆæ˜¯å…ˆå¸è½½ä¹‹å‰å®‰è£…çš„ infer, ç„¶åå†é‡æ–°å®‰è£….</p><p>å¸è½½ infer</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew uninstall infer</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…-xcpretty"><a href="#å®‰è£…-xcpretty" class="headerlink" title="å®‰è£… xcpretty"></a>å®‰è£… xcpretty</h2><p><a href="https://github.com/supermarin/xcpretty">xcpretty</a> æ˜¯ä¸€æ¬¾æ ¼å¼åŒ– xcodebuild è¾“å‡ºç»“æœçš„å·¥å…·.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">â–¸ Building X/N [(Release)]</span><br><span class="line">â–¸ Check Dependencies</span><br><span class="line">â–¸ Copying Info.plist</span><br><span class="line">â–¸ Running script &#x27;[CP] Check Pods Manifest.lock&#x27;</span><br><span class="line">â–¸ Running script &#x27;Replace PaySdk&#x27;</span><br><span class="line">â–¸ Compiling User.m</span><br></pre></td></tr></table></figure><p>ä»0.9.4ç‰ˆæœ¬å, infer é»˜è®¤ä½¿ç”¨äº† xcpretty.</p><p>å¯ä»¥ä½¿ç”¨ gem å®‰è£… xcpretty å·¥å…·:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem install xcpretty</span><br></pre></td></tr></table></figure><p>å¦‚æœæ²¡æœ‰å®‰è£…æˆåŠŸ, æˆ–è€…æç¤ºæƒé™ä¸å¤Ÿ, é‚£å°±è¿™æ ·æŠ˜è…¾:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem install xcpretty</span><br></pre></td></tr></table></figure><p>æƒ³äº†è§£æ›´å¤šå…³äº xcpretty çš„ä½¿ç”¨å¯ä»¥å» <a href="https://github.com/supermarin/xcpretty">github</a>.</p><h2 id="ä½¿ç”¨-infer"><a href="#ä½¿ç”¨-infer" class="headerlink" title="ä½¿ç”¨ infer"></a>ä½¿ç”¨ infer</h2><h3 id="iOS-é¡¹ç›®ä½¿ç”¨-infer"><a href="#iOS-é¡¹ç›®ä½¿ç”¨-infer" class="headerlink" title="iOS é¡¹ç›®ä½¿ç”¨ infer"></a>iOS é¡¹ç›®ä½¿ç”¨ infer</h3><p>infer çš„æ–‡æ¡£å†™çš„ä¹Ÿè¾ƒå…¨é¢.</p><p>å¯ä»¥åœ¨ <a href="http://fbinfer.com/docs/infer-workflow.html">è¿™é‡Œ</a> æŸ¥çœ‹ä½¿ç”¨æ–¹æ³•.</p><p>1.åˆ†æ Cocoapods é¡¹ç›®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">infer -- xcodebuild -workspace N.xcworkspace -scheme NSchema</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ N.xcworkspace æ˜¯ä½ çš„ workspace åç§°, NSchema æ˜¯ä½ éœ€è¦æ£€æŸ¥çš„ Schema åç§°.</p><p>2.åˆ†æ .xcodeproj</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">infer -- xcodebuild -target targetName -configuration Debug -sdk iphonesimulator</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ targetName æ˜¯é¡¹ç›®çš„ target åç§°, å¿…é¡»æŒ‡å®š.</p><p>åˆ†ææˆåŠŸå, infer ä¼šæœ‰è¾“å‡ºæŠ¥å‘Š.</p><p>è¯¥æŠ¥å‘Šåœ¨ä½ çš„é¡¹ç›®ç›®å½•ä¸‹, åç§°æ˜¯ infer-out.</p><p>bug.txt æ˜¯ä»¥æ–‡æœ¬æ–¹å¼è¾“å‡ºçš„ issue æ–‡æ¡£.<br>å¦å¤–è¿˜æœ‰ csv æ ¼å¼çš„ issue æ–‡æ¡£.</p><h3 id="Android-Gradle-å·¥ç¨‹ä½¿ç”¨-infer"><a href="#Android-Gradle-å·¥ç¨‹ä½¿ç”¨-infer" class="headerlink" title="Android Gradle å·¥ç¨‹ä½¿ç”¨ infer"></a>Android Gradle å·¥ç¨‹ä½¿ç”¨ infer</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gradle clean</span><br><span class="line">infer -- gradle build</span><br></pre></td></tr></table></figure><h2 id="å…¶ä»–ç”¨æ³•"><a href="#å…¶ä»–ç”¨æ³•" class="headerlink" title="å…¶ä»–ç”¨æ³•"></a>å…¶ä»–ç”¨æ³•</h2><p>infer è¿˜æœ‰å¾ˆå¤šé«˜çº§çš„ç”¨æ³•, æ¯”å¦‚å¯ä»¥å¢é‡æ£€æŸ¥.</p><p>å¢é‡æ£€æŸ¥çš„åŠŸèƒ½ä¾èµ–äºä½ çš„ç¼–è¯‘å™¨æ˜¯å¦æ”¯æŒ.</p><p>infer å¢é‡æ£€æŸ¥çš„é€‰é¡¹æ˜¯ â€“reactive.</p><blockquote><p>ä¹‹å‰çš„ç‰ˆæœ¬æ˜¯ â€“incremental é€‰é¡¹.<br>è‡ªä» v0.8.0 ç‰ˆæœ¬åä½¿ç”¨äº† â€“reactive é€‰é¡¹.</p></blockquote><p>å¯ä»¥è¿™æ ·æ¥è¿›è¡Œå¢é‡æ£€æŸ¥:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">infer --reactive -- xcodebuild -workspace N.xcworkspace -scheme NSchema</span><br></pre></td></tr></table></figure><p>infer è¿˜æœ‰å¾ˆå¤šé«˜çº§ç”¨æ³•, å¯ä»¥åœ¨ <a href="http://fbinfer.com/docs/advanced-features.html">Advanced usage</a> ä¸­å»æŸ¥é˜…å’Œä½¿ç”¨.</p><p>å†ä½¿ç”¨è¿‡ç¨‹ä¸­, éšç€ MacOS, Xcode çš„å‡çº§, infer ä¼šé¢ä¸´æ›´å¤šçš„æŒ‘æˆ˜, å¦‚æœé‡åˆ°é—®é¢˜, ç¬¬ä¸€æ—¶é—´å» <a href="https://github.com/facebook/infer">GitHub</a>  ä¸Šé¢æ  issue.</p>]]></content>
      
      
      <categories>
          
          <category> MacOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MacOS infer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac é…ç½® JDK1.8</title>
      <link href="/2016/11/26/Mac-%E9%85%8D%E7%BD%AE-JDK1-8/"/>
      <url>/2016/11/26/Mac-%E9%85%8D%E7%BD%AE-JDK1-8/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸‹è½½-JDK"><a href="#ä¸‹è½½-JDK" class="headerlink" title="ä¸‹è½½ JDK"></a>ä¸‹è½½ JDK</h2><p>åœ¨ <a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html">è¿™é‡Œä¸‹è½½</a> jdk.</p><p>ä¸‹è½½ç‰ˆæœ¬æ˜¯ 1.8u112, ä¿¡æ¯å¦‚ä¸‹:</p><p><img src="/upload/images/2016/11/26/jdk1.png" alt="1"></p><h2 id="å®‰è£…-JDK"><a href="#å®‰è£…-JDK" class="headerlink" title="å®‰è£… JDK"></a>å®‰è£… JDK</h2><p>ä¸‹è½½å®Œæˆå, ç›´æ¥åŒå‡»å®‰è£…å³å¯.</p><h2 id="é…ç½®-Path"><a href="#é…ç½®-Path" class="headerlink" title="é…ç½® Path"></a>é…ç½® Path</h2><p>æˆåŠŸå®‰è£…å, ç›®å½•<br><code>/Library/Java/JavaVirtualMachines/jdk1.8.0_112.jdk/</code> å°±ä¼šå­˜åœ¨.</p><p>ç¼–è¾‘ <code>/etc/profile</code> æ–‡ä»¶:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br></pre></td></tr></table></figure><p>æ·»åŠ å¦‚ä¸‹ä»£ç :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_112.jdk/Contents/Home</span><br><span class="line">CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</span><br><span class="line">PATH=$JAVA_HOME/bin:$PATH</span><br><span class="line">export JAVA_HOME</span><br><span class="line">export CLASSPATH</span><br><span class="line">export PATH</span><br></pre></td></tr></table></figure><p>ä¿å­˜æ–‡ä»¶.</p><p>ä½¿è¿™ä¸ªæ–‡ä»¶ç«‹å³ç”Ÿæ•ˆ.å¯ä»¥ source ä¸€ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure><h2 id="æ£€éªŒ"><a href="#æ£€éªŒ" class="headerlink" title="æ£€éªŒ"></a>æ£€éªŒ</h2><p>æ‰§è¡Œä¸‹é¢å‘½ä»¤æ¥æ£€éªŒ jdk æ˜¯å¦å®‰è£…æˆåŠŸ.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹ä¿¡æ¯, æ ‡ç¤ºé…ç½® JDK æˆåŠŸ.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java version â€œ1.8.0_112â€</span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_112-b16)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.112-b16, mixed mode)</span><br></pre></td></tr></table></figure><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MacOS java jdk </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GameDevelopment: ä¸ Cocos2d çš„å†ç›¸é€¢</title>
      <link href="/2016/11/12/GameDevelopment-%E4%B8%8E-Cocos2d-%E7%9A%84%E5%86%8D%E7%9B%B8%E9%80%A2/"/>
      <url>/2016/11/12/GameDevelopment-%E4%B8%8E-Cocos2d-%E7%9A%84%E5%86%8D%E7%9B%B8%E9%80%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¤è¯†-Cocos2d"><a href="#è®¤è¯†-Cocos2d" class="headerlink" title="è®¤è¯† Cocos2d"></a>è®¤è¯† Cocos2d</h2><p>ç›¸ä¿¡å¾ˆå¤šäººå¬è¯´è¿‡ cocos2d-x è¿™ä¸ªå¼•æ“, ä½†å¬è¿‡ <a href="http://cocos2d-objc.org/">cocos2d-objc</a> çš„äººåº”è¯¥ä¸å¤š.</p><p>cocos2d-objc æ˜¯ cocos ç³»åˆ—çš„ objective-c ç‰ˆæœ¬.<br>å¼€å‘è¯­è¨€æ˜¯ OC.åœ¨ iOS ä¸Šé¢ä½¿ç”¨è¯¥ç‰ˆæœ¬çš„å¼•æ“, åŸºæœ¬æ˜¯æ— ç¼è¿æ¥(å†™çš„æ²¡æœ‰ä»€ä¹ˆéšœç¢).</p><p>æ¬£èµä¸€ä¸‹ cocos2d-objc çš„ logo, å¦‚å›¾:<br><img src="/upload/images/2016/11/12/1.png" alt="1"></p><p>å¦‚æœä½ å¯¹ OC ç‰ˆæ„Ÿå…´è¶£, å¯ä»¥é€šè¿‡åšæ–‡ <a href="http://blog.csdn.net/veryitman/article/details/44993643">coco2d-iphone: ç¯å¢ƒæ­å»º</a> å»äº†è§£.</p><p>cocos2d-x ç›®å‰æ”¯æŒ JavaScript, lua, c++ ç­‰ä¸»æµè¯­è¨€æ¥å¼€å‘.<br>cocos è¿˜åœ¨è¿…çŒ›å‘å±•ä¸­, ä¸æ–­çš„å®Œå–„å¼€å‘å·¥å…·, å¹¿å¤§æ¸¸æˆå¼€å‘è€…ä¾ç„¶çƒ­åŠ›è´¡çŒ®, ç¨‹åºçŒ¿ä»¬åœ¨æ¸¸æˆçš„æˆ˜åœºæŒ¥æ´’é’æ˜¥.</p><p>ç°åœ¨ cocos çš„å¼€å‘è€…ä¼šå¾—åˆ°æ›´å¤šçš„æ”¯æŒ.</p><p>ä¸‹é¢ç»™å¼ å›¾æ¥å±•ç¤º cocos å®¶æ—åŠå…¶å‘å±•:<br><img src="/upload/images/2016/11/12/2.png" alt="1"></p><h2 id="ç”±-libgdx-è½¬å‘-Cocos2d"><a href="#ç”±-libgdx-è½¬å‘-Cocos2d" class="headerlink" title="ç”± libgdx è½¬å‘ Cocos2d"></a>ç”± libgdx è½¬å‘ Cocos2d</h2><p>å‡ å¹´å‰, é‚£ä¸ªæ—¶å€™è¿˜åœ¨å¼€å‘æ£‹ç‰Œæ¸¸æˆ, å½“æ—¶è‡ªå·±ä¹Ÿæ˜¯åˆšåˆšæ¥è§¦æ¸¸æˆå¼€å‘è¿™ä¸ªã€Œé«˜é€¼æ ¼ã€çš„è¡Œä¸š, ä¹‹å‰è‡ªå·±æ˜¯ä¸ªçº¯ App å¼€å‘è€….</p><p>å†…å¿ƒè¿˜æ˜¯è›®æ¿€åŠ¨çš„, å¿ƒæƒ³å¯èƒ½è¦èµ°ä¸Šäººç”Ÿå·…å³°äº†â€¦</p><p>æ£‹ç‰Œæ¸¸æˆ, å½“æ—¶ä½¿ç”¨çš„æ˜¯ java çš„æ¸¸æˆå¼•æ“ <a href="https://libgdx.badlogicgames.com/">libgdx</a> 0.X.X çš„ç‰ˆæœ¬, è¯¥å¼•æ“å’Œ Android åŸºæœ¬ä¹Ÿæ˜¯æ— ç¼è¿æ¥, Api è®¾è®¡çš„å¾ˆå¥½.</p><p>ç°åœ¨ libgdx ä¹Ÿå‘å±•åˆ°äº†1.6.x ç‰ˆæœ¬äº†, å·¥å…·ä¹Ÿå®Œå–„äº†å¾ˆå¤š.</p><p>è™½ç„¶ libgdx ä¹Ÿå¯ä»¥è·¨å¹³å°, ä½†æ˜¯æœ€ç»ˆæˆ‘ä»¬è¿˜æ˜¯é€‰æ‹©äº† cocos2d-x æ¥ç§»æ¤è¯¥æ¸¸æˆ.å…¶ä¸­åŸå› æ˜¯å› ä¸º cocos2d-x å¤ªç«äº†, äººä¹Ÿå¥½æ‰¾.</p><p>æ”¹ä¸º cocos2d-x çš„ç‰ˆæœ¬ä¹‹å, æˆ‘å°±è¢«å®‰æ’åˆ°äº†å¦å¤–ä¸€ä¸ªé¡¹ç›®, ä¹Ÿæ˜¯ä¸€ä¸ªæ£‹ç‰Œæ¸¸æˆ, è¯¥æ¸¸æˆç°åœ¨åœ¨è…¾è®¯çš„å¾®ä¿¡æ¸¸æˆé‡Œé¢è¿è¥.</p><p>è¿™ä¸ªæ¸¸æˆæ˜¯ cocos2d-objc çš„å¼•æ“å†™çš„, è‡ªå·±ä¹Ÿä¸ä¼š objc, äºæ˜¯ç¡¬ç€å¤´çš®å­¦ä¹ , å¾ˆå¿«çš„å°±ä¸Šæ‰‹äº†è¿™ä¸ªé¡¹ç›®.å†™çš„ä¹Ÿæ˜¯é£ç”Ÿæ°´èµ·.</p><p>cocos2d-objc, ç°åœ¨ä¹Ÿæ”¯æŒè·¨å¹³å°, å¹¶ä¸”æœ‰ xcode çš„æ’ä»¶, å¯ä»¥åœ¨ xcode é‡Œé¢å†™ Android çš„ä»£ç , è°ƒè¯•å¼€å‘ç­‰.</p><p>å› ä¸ºæ¥è§¦ cocos2d, åé¢å°±ç›´æ¥å¼€æ iOS å¼€å‘äº†.</p><h2 id="å†æ¬¡ä½¿ç”¨-Cocos2d"><a href="#å†æ¬¡ä½¿ç”¨-Cocos2d" class="headerlink" title="å†æ¬¡ä½¿ç”¨ Cocos2d"></a>å†æ¬¡ä½¿ç”¨ Cocos2d</h2><p>äº’è”ç½‘ IT ä¸šçš„å‘å±•, åˆºæ¿€äº†å„ä¸ªè¡Œä¸šçš„å‘å±•, ä¹Ÿä¿ƒè¿›å’Œæ¿€å‘äº†æ–°ç”Ÿçš„æŠ€æœ¯, åœ¨è¿™ä¸ªè¡Œä¸š, æ¯ä¸ªäººéƒ½èƒ½ä½“ä¼š <code>æ´»åˆ°è€å­¦åˆ°è€</code> è¿™å¥è¯çš„å«ä¹‰.</p><p>è¿™ä¸¤å¹´, HTML5 çš„å‘å±•, è®©å¾ˆå¤šç¨‹åºå‘˜é‡æ–°è®¤è¯†äº† JavaScript çš„é‡è¦æ€§. ç‰¹åˆ«æ˜¯æœ€è¿‘ ReactNative çš„å‘å±•, jsPacth çš„å¼€æº, å¾®ä¿¡å°ç¨‹åºçš„æ¨å‡º, è®© JavaScript ç«å¾—ä¸è¦ä¸è¦çš„.</p><p>è¯´å®è¯, æ˜¯æ—¶å€™å¼€å§‹å­¦ä¹ å‰ç«¯ç›¸å…³çš„æŠ€æœ¯äº†, è‡³å°‘ä½ éœ€è¦å»äº†è§£.</p><p>cocos2d-js çš„å‘å±•, ç»™ HTML æ¸¸æˆå¼€å‘å¸¦æ¥äº†å¾ˆå¤šä¾¿åˆ©. æœ€è¿‘æˆ‘ä»¬éœ€è¦å¼€å‘ H5 çš„æ¸¸æˆ, ç›´æ¥æ‹¿èµ· coco2d-x(æ”¯æŒ JavaScript) å°±æ’¸èµ·.</p><p>å» <a href="https://github.com/cocos2d/cocos2d-x">GitHub</a> ä¸Šé¢ç›´æ¥ clone æœ€æ–°ç‰ˆå°±å¯ä»¥, æŒ‰ç…§ README.md æ¥æ­å»ºç¯å¢ƒå°±å¥½äº†.</p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>è¿™ç¯‡åšå®¢ä¹Ÿæ˜¯æœ‰æ„Ÿè€Œå‘, æ²¡æœ‰å®è´¨æ€§çš„å†…å®¹.</p><p>ä¸»è¦ç›®çš„æ˜¯æƒ³å‘Šè¯‰å¤§å®¶, æŠ€æœ¯çš„å‘å±•æ—¥æ–°æœˆå¼‚, æƒ³åœ¨è¿™é‡Œå¤§å±•æ‹³è„š, ä½ éœ€è¦ä¿æŒä¸€é¢—å¹´è½»çš„å¿ƒ, ä¸æ€•è‹¦, å‹‡å¾€ç›´å‰çš„ç²¾ç¥.</p><p>æˆ‘ä»¬éœ€è¦å­¦ä¹ çš„æŠ€æœ¯æœ‰å¾ˆå¤š, æˆ‘è®¤ä¸º, è¦æ ¹æ®é¡¹ç›®æœ¬èº«çš„å‘å±•æ¥é€‚åº¦çš„å­¦ä¹ , åˆ‡è®°ç›²ç›®çš„å­¦ä¹ , å­¦ä¹ ä¸€é—¨æ–°æŠ€æœ¯ä¹‹å, è¦åŠæ—¶çš„è¿ç”¨åœ¨é¡¹ç›®å½“ä¸­, å¹¶åˆ†äº«ç»™ä½ èº«è¾¹çš„äºº.</p><blockquote><p>ä¸æ‹’ç»ä¸æ’æ–¥æ–°æŠ€æœ¯, åšæŒå­¦ä¹ å’Œä¹äºåˆ†äº«, åº”è¯¥æ˜¯å¿…å¤‡çš„æŠ€èƒ½.</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Game </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cocos2d Game </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac install Cocoapods</title>
      <link href="/2016/11/08/Mac-install-Cocoapods/"/>
      <url>/2016/11/08/Mac-install-Cocoapods/</url>
      
        <content type="html"><![CDATA[<h2 id="å£°æ˜"><a href="#å£°æ˜" class="headerlink" title="å£°æ˜"></a>å£°æ˜</h2><p>è¿™ç¯‡åšå®¢åŸæœ¬è¢«æˆ‘å‘è¡¨åœ¨ <a href="http://blog.csdn.net/veryitman/article/details/50769069">CSDN</a> .</p><p>é‚£é‡Œä¸å†æ›´æ–°, ç°åœ¨åœ¨è¿™é‡ŒåšæŒç»­æ›´æ–°.</p><h2 id="å¯¼å¼•"><a href="#å¯¼å¼•" class="headerlink" title="å¯¼å¼•"></a>å¯¼å¼•</h2><p>å¦‚æœä½ çš„ Mac OSX å‡çº§åˆ° 10.11.x+, å¹¶ä¸”éœ€è¦å®‰è£… Cocoapods, å¯ä»¥å‚è€ƒæœ¬åšå®¢.</p><h2 id="å®‰è£…-ruby"><a href="#å®‰è£…-ruby" class="headerlink" title="å®‰è£… ruby"></a>å®‰è£… ruby</h2><p>Mac ç³»ç»Ÿè‡ªå¸¦äº† ruby, ä½†æ˜¯å»ºè®®å¤§å®¶ä½¿ç”¨ Homebrew å®‰è£… ruby.</p><p>å› ä¸º Cocoapods å‡çº§éœ€è¦å¯¹åº”çš„ ruby ç‰ˆæœ¬ä¹Ÿè¦å‡çº§, ä½¿ç”¨ Homebrew æ¯”è¾ƒæ–¹ä¾¿.</p><p>å®‰è£… ruby:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install ruby</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å½“å‰å®‰è£…çš„ ruby ç‰ˆæœ¬:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby -v</span><br></pre></td></tr></table></figure><p>ä¼šå¾—åˆ°ç±»ä¼¼ä¸‹é¢çš„ä¿¡æ¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby 2.3.1p112 (2016-04-26 revision 54768) [x86_64-darwin15]</span><br></pre></td></tr></table></figure><p>gem æ˜¯ç®¡ç† Ruby åº“å’Œç¨‹åºçš„æ ‡å‡†åŒ….<br>å®‰è£…äº† ruby, è‡ªå¸¦äº† gem å·¥å…·.</p><p>å¯ä»¥ä½¿ç”¨ <code>gem -v</code> æŸ¥çœ‹ gem ç‰ˆæœ¬.</p><h2 id="å®‰è£…-Cocoapods"><a href="#å®‰è£…-Cocoapods" class="headerlink" title="å®‰è£… Cocoapods"></a>å®‰è£… Cocoapods</h2><p>1.ç§»é™¤åŸæ¥çš„æº, ä¸ç®¡ä»¥å‰æ˜¯å¦å®‰è£…è¿‡ Cocoapods.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem sources --remove http://ruby.taobao.org/</span><br></pre></td></tr></table></figure><p>2.é‡æ–°æ·»åŠ æº, æ³¨æ„æ˜¯ https.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem sources -a https://gems.ruby-china.org/</span><br></pre></td></tr></table></figure><p>ä¹‹å‰ <a href="https://ruby.taobao.org/">taobao çš„æº</a> å¥½åƒå·²ç»ä¸è¡Œäº†.</p><p><strong>æ³¨æ„ï¼š</strong>æ·»åŠ æºä¹‹å‰åœ¨æµè§ˆå™¨æ‰“å¼€ <code>https://gems.ruby-china.org/</code> è¿™ä¸ªåœ°å€çœ‹ä¸€çœ‹æ˜¯å¦èƒ½è®¿é—®ï¼Œå¦‚æœä¸èƒ½è®¿é—®å°±ä¿®æ”¹ä¸€ä¸‹ä¸º <code>https://gems.ruby-china.com</code> è¿™ä¸ªåœ°å€ã€‚</p><p>3.æŸ¥çœ‹æ˜¯å¦æ·»åŠ æˆåŠŸ, è¯¥æ­¥éª¤å¯é€‰.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem sources -l</span><br></pre></td></tr></table></figure><p>å®‰è£…, ä½¿ç”¨ root æƒé™å®‰è£….</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem install -n /usr/local/bin cocoapods</span><br></pre></td></tr></table></figure><p>è¿™ç§å®‰è£…æ–¹å¼, ä¼šå®‰è£…æœ€æ–°çš„ release ç‰ˆæœ¬.</p><p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢ä¸¤ç§æ–¹å¼æ¥å®‰è£….</p><p>æŒ‡å®šç‰ˆæœ¬å®‰è£…:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem install -n /usr/local/bin cocoapods -v 1.0.0</span><br></pre></td></tr></table></figure><p>å®‰è£…æœ€æ–°çš„ release beta ç‰ˆæœ¬:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem install -n /usr/local/bin cocoapods --pre</span><br></pre></td></tr></table></figure><h2 id="å¸è½½-Cocoapods"><a href="#å¸è½½-Cocoapods" class="headerlink" title="å¸è½½ Cocoapods"></a>å¸è½½ Cocoapods</h2><p>å¸è½½ Cocoapods åªéœ€æ‰§è¡Œ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem uninstall cocoapods</span><br></pre></td></tr></table></figure><p>å¦‚æœæƒ³åˆ é™¤æœ¬åœ°çš„ pod repo, å¯ä»¥è¿™æ ·:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -fr ~/.cocoapods/</span><br></pre></td></tr></table></figure><h2 id="å»ºç«‹æœ¬åœ°-repo"><a href="#å»ºç«‹æœ¬åœ°-repo" class="headerlink" title="å»ºç«‹æœ¬åœ° repo"></a>å»ºç«‹æœ¬åœ° repo</h2><p>å®‰è£…å®Œ Cocoapods å, éœ€è¦å»ºç«‹æœ¬åœ°çš„ repo.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod setup</span><br></pre></td></tr></table></figure><p>å³ä½¿ä½ ç°åœ¨ä¸æ‰§è¡Œ pod setup, åé¢è¿›è¡Œ pod install æˆ–è€… pod update çš„æ—¶å€™, ä¹Ÿä¼šè‡ªåŠ¨çš„è¿›è¡Œ pod setup.</p><p>æ‰§è¡Œ pod setup çš„ç›®çš„æ˜¯å°†æ‰€æœ‰ç¬¬ä¸‰æ–¹çš„ podspec ç´¢å¼•æ–‡ä»¶æ›´æ–°åˆ°æœ¬åœ°çš„ <code>~/.cocoapods/repos</code> ç›®å½•ä¸­.</p><h2 id="å®‰è£…ä½¿ç”¨ä¸­é‡åˆ°çš„é—®é¢˜"><a href="#å®‰è£…ä½¿ç”¨ä¸­é‡åˆ°çš„é—®é¢˜" class="headerlink" title="å®‰è£…ä½¿ç”¨ä¸­é‡åˆ°çš„é—®é¢˜"></a>å®‰è£…ä½¿ç”¨ä¸­é‡åˆ°çš„é—®é¢˜</h2><p>é—®é¢˜1: å‘½ä»¤è¡Œæ‰§è¡Œ pod å‘ç”Ÿ: pod command not found, ä½†æ˜¯ sudo pod å´å¯ä»¥æ‰§è¡Œ.</p><p>è§£å†³æ–¹æ¡ˆå³å¦‚ä¸‹æ­¥éª¤:</p><p>[1].å¸è½½åŸæœ‰çš„ Cocoapods</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem uninstall cocoapods</span><br></pre></td></tr></table></figure><p>[2].é‡æ–°å®‰è£… Cocoapods</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem install -n /usr/local/bin cocoapods</span><br></pre></td></tr></table></figure><p>[3].èµ‹äºˆ&#x2F;usr&#x2F;local&#x2F;binç»™äºˆæ‰§è¡Œä¸è¯»å–æƒé™:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod -R +rx /usr/local/bin/</span><br></pre></td></tr></table></figure><blockquote><p>å»ºè®®æœ€å¥½ä½¿ç”¨ä»£(fanq)ç†(qiang).</p></blockquote><p>é—®é¢˜2: æ›´æ–° gem è¿‡ç¨‹ä¸­, é‡åˆ°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Operation not permitted - /usr/bin/update_rubygems</span><br></pre></td></tr></table></figure><p>å¯ä»¥é€šè¿‡é€šè¿‡ brew å®‰è£… ruby è§£å†³.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install ruby</span><br></pre></td></tr></table></figure><p>é—®é¢˜3: pod setup å¤±è´¥</p><p>å¤±è´¥æç¤ºä¿¡æ¯ç±»ä¼¼:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Cloning into &#x27;master&#x27;...</span><br><span class="line">error: RPC failed; curl 56 SSLRead() return error -36</span><br><span class="line">fatal: The remote end hung up unexpectedly</span><br><span class="line">fatal: early EOF</span><br><span class="line">fatal: index-pack failed</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ¡ˆ: æ›´æ–° gem</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem update --system</span><br></pre></td></tr></table></figure><p>é—®é¢˜4: æ·»åŠ æº, æç¤ºå¦‚ä¸‹é—®é¢˜</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source https://gems.ruby-china.org/ already present in the cache</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè¯´æ˜ä½ å·²ç»æ·»åŠ è¿‡è¯¥æº, å¯ä»¥ä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem sources -l</span><br></pre></td></tr></table></figure><p>æ¥æŸ¥çœ‹å·²ç»æ·»åŠ çš„æº.</p><h2 id="å¸¸ç”¨æ“ä½œ"><a href="#å¸¸ç”¨æ“ä½œ" class="headerlink" title="å¸¸ç”¨æ“ä½œ"></a>å¸¸ç”¨æ“ä½œ</h2><p>1.æ›´æ–° gem</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem update --system</span><br></pre></td></tr></table></figure><p>2.pod repo update</p><p>æ›´æ–°æœ¬åœ°ä»“åº“.</p><p>3.pod search xxx</p><p>æœç´¢ cocoapods é¡¹ç›®.</p><p>4.pod list</p><p>åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„åº“.</p><p>5.pod install</p><p>æ ¹æ® podfile å’Œ podfile.lockæ¥å®‰è£…åº“.</p><p>é»˜è®¤ä¼šæ‰§è¡Œ pod repo update.</p><p>å¯ä»¥åŠ å…¥å‚æ•° <code>â€“no-repo-update</code> ä¸æ‰§è¡Œ pod repo update.</p><p>6.pod update</p><p>æ›´æ–°å·²å®‰è£…çš„åº“åˆ°æœ€æ–°ç‰ˆæœ¬, å¹¶ä¸”åˆ›å»ºæ–°çš„ Podfile.lock æ–‡ä»¶.</p><p>è¯¥å‘½ä»¤ä¹Ÿä¼šé»˜è®¤ä¼šæ‰§è¡Œ pod repo update.</p><p>å¯ä»¥åŠ å…¥å‚æ•° â€“no-repo-update ä¸æ‰§è¡Œ pod repo update.</p><h2 id="æ›´æ–°è®°å½•"><a href="#æ›´æ–°è®°å½•" class="headerlink" title="æ›´æ–°è®°å½•"></a>æ›´æ–°è®°å½•</h2><p>2017-01-04 æ›´æ–°</p><blockquote><p>å‡çº§ ruby åˆ° 2.4 ç‰ˆæœ¬å, cocoapods æ— æ³•ä½¿ç”¨äº†.</p></blockquote><p>å‡çº§çš„ ruby ç‰ˆæœ¬ä¿¡æ¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby 2.4.0p0 (2016-12-24 revision 57164) [x86_64-darwin15]</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨ä»»ä½• pod å‘½ä»¤éƒ½æŠ¥é”™:</span><br><span class="line"></span><br><span class="line">/usr/local/Cellar/ruby/2.4.0/lib/ruby/2.4.0/rubygems.rb:270:in `find_spec_for_exe&#x27;: can&#x27;t find gem cocoapods (&gt;= 0.a) (Gem::GemNotFoundException)</span><br><span class="line">from /usr/local/Cellar/ruby/2.4.0/lib/ruby/2.4.0/rubygems.rb:298:in `activate_bin_path&#x27;</span><br><span class="line">from /usr/local/bin/pod:22:in `&lt;main&gt;&#x27;</span><br></pre></td></tr></table></figure><p>æŸ¥æ‰¾å„ç§è§£å†³æ–¹æ¡ˆ, æœ€ç»ˆè¿˜æ˜¯æ²¡æœ‰è§£å†³.</p><p>ä½ å¯ä»¥åœ¨ <a href="https://cocoapods.org/app">è¿™é‡Œ</a> ä¸‹è½½ Cocoapods çš„ Mac ç‰ˆæœ¬ App ä½¿ç”¨.</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> MacOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CocoaPods, iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cocoapods é—®é¢˜é›†é”¦</title>
      <link href="/2016/11/08/Cocoapods-%E9%97%AE%E9%A2%98%E9%9B%86%E9%94%A6/"/>
      <url>/2016/11/08/Cocoapods-%E9%97%AE%E9%A2%98%E9%9B%86%E9%94%A6/</url>
      
        <content type="html"><![CDATA[<h2 id="æ‰¿è¯º"><a href="#æ‰¿è¯º" class="headerlink" title="æ‰¿è¯º"></a>æ‰¿è¯º</h2><p>æœ¬æ–‡ä¼šæŒç»­æ›´æ–°, åˆ†äº«åœ¨ä½¿ç”¨ cocoapods è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ.</p><p>æ¬¢è¿å¤§å®¶è¡¥å…….</p><h2 id="å®‰è£…é—®é¢˜"><a href="#å®‰è£…é—®é¢˜" class="headerlink" title="å®‰è£…é—®é¢˜"></a>å®‰è£…é—®é¢˜</h2><p>å¯ä»¥é˜…è¯»åšå®¢ <a href="http://www.veryitman.com/2016/11/08/2016-11-08-Mac-install-Cocoapods/">Mac å®‰è£… Cocoapods</a>.</p><h2 id="pod-search-é—®é¢˜"><a href="#pod-search-é—®é¢˜" class="headerlink" title="pod search é—®é¢˜"></a>pod search é—®é¢˜</h2><blockquote><p>pod search æ— æ³•æœç´¢åˆ°æŒ‡å®šçš„é¡¹ç›®</p></blockquote><p>é—®é¢˜æè¿°: æ‰§è¡Œ pod search [Name], å‡ºç°ç±»ä¼¼ä¸‹é¢çš„æç¤º:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[!] Unable to find a pod with name, author, summary, or description matching `[Name]`</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ¡ˆ: åˆ é™¤ search_index.json æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm ~/Library/Caches/CocoaPods/search_index.json</span><br></pre></td></tr></table></figure><p>ç„¶å, é‡æ–°æ‰§è¡Œ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod search é¡¹ç›®åç§°</span><br></pre></td></tr></table></figure><p>å¦‚æœè¿™æ ·è¡Œä¸é€šçš„è¯, å¯ä»¥è¿™æ ·:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rm -rf ~/.cocoapods</span><br><span class="line">rm ~/Library/Caches/CocoaPods/search_index.json</span><br><span class="line">pod setup</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ çš„ç½‘ç»œä¸å¥½, éœ€è¦æ¼«é•¿çš„ç­‰å¾…â€¦</p><p>è¿™ä¸ªæ—¶å€™, å¯ä»¥å»æŠ½åŠç›’çƒŸäº†. Orzâ€¦</p><h2 id="pod-setup-é—®é¢˜"><a href="#pod-setup-é—®é¢˜" class="headerlink" title="pod setup é—®é¢˜"></a>pod setup é—®é¢˜</h2><blockquote><p>pod setup å¡æ­»</p></blockquote><p>é—®é¢˜æè¿°:</p><p>pod setup ä¼šåœ¨æœ¬åœ°å»ºç«‹ cocoapods ä»“åº“.</p><p>åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­, ä½ å¯ä»¥åœ¨ <code>~/.cocoapods/repos</code> ä½¿ç”¨<br><code>du -sh *</code> æ¥çœ‹ repos ç›®å½•çš„å¤§å°å˜åŒ–.</p><p>å¦‚æœè§‚å¯Ÿå¥½ä¹…, å¤§å°æ²¡æœ‰å˜åŒ–, æœ€ç»ˆä¼šå‡ºç°ç±»ä¼¼ä¸‹é¢çš„é”™è¯¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Cloning into &#x27;master&#x27;...</span><br><span class="line">error: RPC failed; curl 56 SSLRead() return error -36</span><br><span class="line">fatal: The remote end hung up unexpectedly</span><br><span class="line">fatal: early EOF</span><br><span class="line">fatal: index-pack failed</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ¡ˆï¼Œå¦‚ä¸‹ï¼š</p><p>å…ˆæ›´æ–° gem</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem update --system</span><br></pre></td></tr></table></figure><p>å†é‡æ–°æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod setup</span><br></pre></td></tr></table></figure><h2 id="pod-install-é—®é¢˜"><a href="#pod-install-é—®é¢˜" class="headerlink" title="pod install é—®é¢˜"></a>pod install é—®é¢˜</h2><p>æ— æ³•ä½¿ç”¨ï¼ŒæŠ¥ç±»ä¼¼ä¸‹é¢çš„ä¸¤ç§é”™è¯¯ä¿¡æ¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">can&#x27;t find gem cocoapods (&gt;= 0.a) with executable pod (Gem::GemNotFoundException)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">While executing gem ... (TypeError) </span><br><span class="line">no implicit conversion of nil into String</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ¡ˆï¼Œå¦‚ä¸‹ï¼š</p><p><strong>1. é‡æ–°å®‰è£… ruby</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew reinstall ruby</span><br></pre></td></tr></table></figure><p><strong>2. gem æ›´æ–°</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rm /usr/local/bin/update_rubygems</span><br><span class="line"></span><br><span class="line">sudo gem update --system</span><br></pre></td></tr></table></figure><p><strong>3. é‡æ–°å®‰è£… Cocoapods å¹¶é‡æ–°æ·»åŠ æº</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo gem uninstall cocoapods</span><br><span class="line"></span><br><span class="line">sudo gem install -n /usr/local/bin cocoapods</span><br><span class="line"></span><br><span class="line">gem sources -a https://gems.ruby-china.org/</span><br></pre></td></tr></table></figure><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> MacOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CocoaPods, iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cocoapods ç®¡ç†å¼€æºé¡¹ç›®</title>
      <link href="/2016/11/01/Cocoapods-%E7%AE%A1%E7%90%86%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/"/>
      <url>/2016/11/01/Cocoapods-%E7%AE%A1%E7%90%86%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><p>åœ¨è¿›è¡Œä¸‹é¢å·¥ä½œä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ åšäº†ä¸‹é¢ä¸‰ä»¶äº‹æƒ…ï¼š</p><p><strong>1. åˆ›å»ºæˆ–è€…å·²ç»æœ‰äº† github è´¦å·.</strong><br><strong>2. äº†è§£å’Œç†Ÿæ‚‰å¦‚ä½•åœ¨ github ä¸Šé¢åˆ›å»º Repository.</strong><br><strong>3. MacOS ä¸Šé¢å®‰è£…äº† Cocoapods.</strong></p><p>å¦‚æœä½ è¿˜æ²¡æœ‰ä½¿ç”¨ Cocoapods, å»ºè®®çœ‹çœ‹ <a href="http://www.veryitman.com/2016/11/08/Mac-install-Cocoapods/">Mac OSX 10.11.1+ å®‰è£… Cocoapods</a> è¿™ç¯‡åšå®¢.</p><p>åœ¨åšå®¢ <a href="http://www.veryitman.com/2016/09/25/iOS-%E9%A1%B9%E7%9B%AE-%E6%89%93%E9%80%A0%E6%9C%AC%E5%9C%B0-pod-%E5%BA%93/">iOS é¡¹ç›®: æ‰“é€ æœ¬åœ° pod åº“</a> é‡Œé¢æœ‰ä»‹ç»å¦‚ä½•æ‰“é€ æœ¬åœ°çš„ pod åº“ï¼Œä¸éœ€è¦å€ŸåŠ©ä»»ä½•ä»“åº“å°±å¯ä»¥å®Œæˆï¼Œæ“ä½œç®€å•ï¼Œé€‚åˆé¡¹ç›®ç»„å†…ä½¿ç”¨ã€‚</p><p>ä»Šå¤©ç»™å¤§å®¶åˆ†äº«å¦‚ä½•å°†ä»£ç å¼€æºå¹¶æ”¾åˆ° pod åº“ä¸­ï¼Œä¾›åˆ«äººä½¿ç”¨ã€‚è¿™ç§æ–¹å¼å±äºæ‰“é€ å…¬å…±ï¼ˆPublic repoï¼‰ä»“åº“ï¼Œ ä»»ä½•äººéƒ½å¯ä»¥æœç´¢åˆ°ä½ è´¡çŒ®çš„åº“å¹¶ä½¿ç”¨ä½ çš„åº“ã€‚åé¢ä¼šè·Ÿå¤§å®¶åˆ†äº«å¦‚ä½•æ‰“é€ ç§æœ‰ï¼ˆPrivate repoï¼‰ï¼Œæ•¬è¯·æœŸå¾…ã€‚</p><p>è¿™ç¯‡åšå®¢æ˜¯åŸºäºä¸€ä¸ªå®é™…ä¾‹å­ <a href="https://github.com/veryitman/MZInsetLabel">MZInsetLabel</a> æ¥è¯´æ˜çš„ï¼ŒæœŸå¾…ä¸ä¼˜ç§€çš„ä½ äº¤æµè®¨è®ºã€‚</p><h2 id="åˆ›å»º-Repository-å¹¶å®Œå–„é¡¹ç›®"><a href="#åˆ›å»º-Repository-å¹¶å®Œå–„é¡¹ç›®" class="headerlink" title="åˆ›å»º Repository å¹¶å®Œå–„é¡¹ç›®"></a>åˆ›å»º Repository å¹¶å®Œå–„é¡¹ç›®</h2><p><strong>1. åœ¨ Github ä¸Šé¢åˆ›å»º Repositoryï¼Œå–åä¸º MZInsetLabel.</strong></p><p><strong>2. å°†è¯¥å·¥ç¨‹ clone åˆ°æœ¬åœ°ç£ç›˜.</strong></p><p><strong>3. å†™ä»£ç ï¼Œè¿™é‡Œæˆ‘åªå†™äº† MZInsetLabel.h | .m æ–‡ä»¶.</strong></p><p><strong>4. åˆ›å»º podspec æ–‡ä»¶.</strong></p><p>ä½¿ç”¨ä¸‹é¢å‘½ä»¤ï¼Œå³å¯äº§ç”Ÿè¯¥æ–‡ä»¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod spec create MZInsetLabel</span><br></pre></td></tr></table></figure><p>åœ¨å½“å‰ç›®å½•ä¼šç”Ÿæˆ <code>MZInsetLabel.podspec</code> æ–‡ä»¶ã€‚æŒ‰ç…§æ–‡ä»¶è§„èŒƒå’Œå®é™…æƒ…å†µå¡«å†™å³å¯ï¼Œå¦‚æœä¸çŸ¥é“æ€ä¹ˆå¡«å†™ï¼Œå¯ä»¥åœ¨ Github ä¸Šé¢æ‰¾ä¸€ä¸ªå¼€æºé¡¹ç›®å‚è€ƒå³å¯ã€‚</p><blockquote><p>æ³¨æ„: Tag ç‰ˆæœ¬å·ä¸è¦é”™è¯¯.</p></blockquote><p>æœ€ç»ˆå†…å®¹å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Pod::Spec.new do |s|</span><br><span class="line">  s.name         = &quot;MZInsetLabel&quot;</span><br><span class="line">  s.version      = &quot;0.2.0&quot;</span><br><span class="line">  s.summary      = &quot;MZInsetLabel is subClass of UILabel.&quot;</span><br><span class="line">  s.description  = &lt;&lt;-DESC</span><br><span class="line">                        MZInsetLabel is a sub class of UILabel that can be set insets.</span><br><span class="line">                   DESC</span><br><span class="line">  s.homepage     = &quot;http://www.veryitman.com&quot;</span><br><span class="line">  s.license      = &quot;MIT&quot;</span><br><span class="line">  s.author       = &#123; &quot;veryitman&quot; =&gt; &quot;veryitman@126.com&quot; &#125;</span><br><span class="line">  s.platform     = :ios, &quot;7.0&quot;</span><br><span class="line">  s.source = &#123; :git =&gt; &quot;https://github.com/veryitman/MZInsetLabel.git&quot;, :tag =&gt; &quot;#&#123;s.version&#125;&quot; &#125;</span><br><span class="line">  s.source_files  = &quot;*.&#123;h,m&#125;&quot;</span><br><span class="line">  s.framework  = &quot;UIKit&quot;</span><br><span class="line">  s.requires_arc = true</span><br><span class="line">end</span><br></pre></td></tr></table></figure><h2 id="é¡¹ç›®æ£€æµ‹"><a href="#é¡¹ç›®æ£€æµ‹" class="headerlink" title="é¡¹ç›®æ£€æµ‹"></a>é¡¹ç›®æ£€æµ‹</h2><p>æ£€æŸ¥è¯¥ podspec æ–‡ä»¶ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod lib lint MZInsetLabel.podspec</span><br></pre></td></tr></table></figure><blockquote><p>â€“verbose å¯ä»¥è¾“å‡ºæ›´åŠ è¯¦ç»†çš„å†…å®¹</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod lib lint MZInsetLabel.podspec --verbose</span><br></pre></td></tr></table></figure><p>æ­£ç¡®çš„è¯, ä½ å¯ä»¥çœ‹åˆ°ä¸‹å›¾å¦‚æ‰€ç¤ºçš„å†…å®¹ï¼š<br><img src="/upload/images/2016/11/1/1.jpg" alt="1"></p><p>åœ¨æ£€æµ‹çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæœ‰ä¸€äº›è­¦å‘Šå¯¼è‡´æ— æ³•éªŒè¯é€šè¿‡ï¼Œå¯ä»¥ä½¿ç”¨ <code>--allow-warnings</code> å‚æ•°è§„é¿è¿™äº› warningï¼Œä½†æˆ‘è¿˜æ˜¯å»ºè®®å¤§å®¶å°½é‡å°† warning ä¿®æ”¹å¥½ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod lib lint --allow-warnings</span><br></pre></td></tr></table></figure><p><code>pod lib lint *.podspec</code> æ˜¯åªä»æœ¬åœ°éªŒè¯ä½ çš„ pod èƒ½å¦é€šè¿‡éªŒè¯.</p><p><code>pod spec lint*..podspec</code> æ˜¯ä»æœ¬åœ°å’Œè¿œç¨‹éªŒè¯ä½ çš„ pod èƒ½å¦é€šè¿‡éªŒè¯.</p><p>å¤§å®¶å¯è‡ªè¡Œé€‰æ‹©è¿™ä¸¤ç§æ–¹å¼ã€‚</p><h2 id="æ·»åŠ é¡¹ç›®åˆ°-Github-Repository"><a href="#æ·»åŠ é¡¹ç›®åˆ°-Github-Repository" class="headerlink" title="æ·»åŠ é¡¹ç›®åˆ°  Github Repository"></a>æ·»åŠ é¡¹ç›®åˆ°  Github Repository</h2><p>å°†æœ¬åœ°çš„ä»£ç  push åˆ° Github çš„ Repository, å°±æ˜¯åˆšæ‰åˆ›å»ºçš„ MZInsetLabel.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git add `æ–‡ä»¶`æˆ–è€…`æ–‡ä»¶å¤¹`</span><br><span class="line"></span><br><span class="line">git commit -m &quot;Init&quot;</span><br><span class="line"></span><br><span class="line">git push</span><br></pre></td></tr></table></figure><p>åœ¨ä½ çš„ Github Repository ä¸Šé¢åˆ›å»ºä¸€ä¸ª Release ä½œä¸º Tagï¼ˆ0.1.0ç‰ˆæœ¬ï¼‰ï¼Œå¦‚å›¾æ‰€ç¤º:<br><img src="/upload/images/2016/11/1/2.jpg" alt="1"></p><h2 id="æ¨é€åˆ°-cocoapods"><a href="#æ¨é€åˆ°-cocoapods" class="headerlink" title="æ¨é€åˆ° cocoapods"></a>æ¨é€åˆ° cocoapods</h2><p><strong>1. æ³¨å†Œ trunk</strong></p><blockquote><p>pod trunk register ä½ çš„é‚®ç®± â€˜ç”¨æˆ·åâ€™ â€“description&#x3D;â€™ç®€å•æè¿°â€™</p></blockquote><p>å®Œæ•´å‘½ä»¤å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod trunk register veryitman@126.com &#x27;veryitman&#x27; --description=&#x27;mark&#x27;</span><br></pre></td></tr></table></figure><p><strong>2. æ‰“å¼€é‚®ç®±, æ¿€æ´»é‚®ä»¶, ç‚¹å‡»é“¾æ¥æ¿€æ´»</strong></p><p><strong>3. æ£€æŸ¥æ³¨å†Œä¿¡æ¯</strong></p><p>æ‰§è¡Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod trunk me</span><br></pre></td></tr></table></figure><p><strong>4.æ·»åŠ åˆ° cocoapods</strong></p><p>æ‰§è¡Œä¸‹é¢å‘½ä»¤, å³å¯.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod trunk push MZInsetLabel.podspec</span><br></pre></td></tr></table></figure><p>æˆåŠŸçš„æ•ˆæœå›¾:</p><p><img src="/upload/images/2016/11/1/3.jpg" alt="1"></p><p><img src="/upload/images/2016/11/1/4.png" alt="1"></p><h2 id="éªŒè¯ä½¿ç”¨"><a href="#éªŒè¯ä½¿ç”¨" class="headerlink" title="éªŒè¯ä½¿ç”¨"></a>éªŒè¯ä½¿ç”¨</h2><p><strong>1. æ£€æŸ¥æ˜¯å¦å¯ä»¥æœç´¢åˆ°</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod search MZInsetLabel</span><br></pre></td></tr></table></figure><p>å¦‚æœæœç´¢ä¸åˆ°, è¯·æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod setup</span><br></pre></td></tr></table></figure><p><strong>2. åœ¨é¡¹ç›®ä¸­å¯ä»¥ä½¿ç”¨è¯¥é¡¹ç›®</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod &#x27;MZInsetLabel&#x27;, &#x27;~&gt; 0.1.0&#x27;</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨ä½ çš„æµ‹è¯•é¡¹ç›®ä¸­ï¼Œæ‰§è¡Œ <code>pod install</code> å³å¯ã€‚</p><h2 id="å¯èƒ½é‡åˆ°çš„éº»çƒ¦"><a href="#å¯èƒ½é‡åˆ°çš„éº»çƒ¦" class="headerlink" title="å¯èƒ½é‡åˆ°çš„éº»çƒ¦"></a>å¯èƒ½é‡åˆ°çš„éº»çƒ¦</h2><p><strong>1. æ‰§è¡Œ <code>pod trunk push *.podspec</code> æ—¶, å¥½ä¹…æ²¡ååº”?</strong></p><blockquote><p>è¿™ç§æƒ…å†µ, å¤§å¤šæ•°éƒ½æ˜¯å› ä¸ºä½ çš„ç½‘ç»œä¸ç»™åŠ›é€ æˆçš„, å¦‚æœä½ ç¡®å®šä½ çš„ç½‘ç»œæ²¡é—®é¢˜, é‚£ä¹ˆè¯·ç¿»å¢™.</p></blockquote><p><strong>2. æ‰§ è¡Œ <code>pod trunk push *.podspec</code> æ—¶æŠ¥é”™?</strong></p><p>æŠ¥é”™ä¿¡æ¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR | [iOS] unknown: Encountered an unknown error (Simulator iPhone 4s is not available.) during validation.</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé”™è¯¯æ˜¯å› ä¸º, æ›´æ–°äº† xcode8 ä¹‹åä¸å†æ”¯æŒ ios7 çš„ç¼˜æ•….</p><p>è§£å†³æ–¹æ¡ˆ(æˆ‘çš„), å‡çº§ cocoapods.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem install -n /usr/local/bin cocoapods</span><br></pre></td></tr></table></figure><p><strong>3. pod trunk push å¤±è´¥</strong></p><p>å¤±è´¥æç¤ºä¿¡æ¯ç±»ä¼¼:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Cloning into &#x27;master&#x27;...</span><br><span class="line">error: RPC failed; curl 56 SSLRead() return error -36</span><br><span class="line">fatal: The remote end hung up unexpectedly</span><br><span class="line">fatal: early EOF</span><br><span class="line">fatal: index-pack failed</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ¡ˆ: æ›´æ–° gem</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem update --system</span><br></pre></td></tr></table></figure><h2 id="Git-å‘½ä»¤è¡Œæ“ä½œ"><a href="#Git-å‘½ä»¤è¡Œæ“ä½œ" class="headerlink" title="Git å‘½ä»¤è¡Œæ“ä½œ"></a>Git å‘½ä»¤è¡Œæ“ä½œ</h2><p><strong>1. å‘è¿œç¨‹ Repository æ·»åŠ  tag</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git tag -m &quot;æ³¨é‡Š&quot; 0.0.1</span><br><span class="line"></span><br><span class="line">git push --tags</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œåï¼Œå¯ä»¥çœ‹åˆ° Github Repository ä¸Šä¼šå¤šä¸€ä¸ªå¯¹åº”çš„ tag ç‰ˆæœ¬ã€‚</p><p><strong>2.åˆ é™¤æœ¬åœ° Tag</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git tag --delete [TagName]</span><br></pre></td></tr></table></figure><p>å¦‚:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git tag --delete 0.0.1</span><br></pre></td></tr></table></figure><p><strong>3. åˆ é™¤è¿œç¨‹ Tag</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push --delete origin [TagName]</span><br></pre></td></tr></table></figure><p>å¦‚:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push --delete origin 0.0.1</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨ Github ä¸Šé¢å¦‚æœä½ ä¸å°å¿ƒæ‰“é”™äº† Release, ç„¶ååˆ é™¤è¯¥ Release.<br>ä½ ä¼šå‘ç°, tag æ— æ³•åˆ é™¤.ä½¿ç”¨ä¸Šé¢æ–¹å¼å¦¥å¦¥çš„è§£å†³.</p></blockquote><p>å¦‚æœä½ åˆ é™¤ tagï¼Œæƒ³é‡æ–°æ‰“ä¸€ä¸ªç›¸åŒçš„ tagï¼Œéœ€è¦å…ˆåˆ é™¤æœ¬åœ°çš„ tagï¼Œå¦åˆ™ä¼šå¤±è´¥ã€‚</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS cocoapods </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS: è°ˆè°ˆ frame å’Œ bounds</title>
      <link href="/2016/10/22/iOS-%E8%B0%88%E8%B0%88-frame-%E5%92%8C-bounds/"/>
      <url>/2016/10/22/iOS-%E8%B0%88%E8%B0%88-frame-%E5%92%8C-bounds/</url>
      
        <content type="html"><![CDATA[<h2 id="èµ·å› "><a href="#èµ·å› " class="headerlink" title="èµ·å› "></a>èµ·å› </h2><p>å¤§å®¶çŸ¥é“, æˆ‘ä»¬å¯ä»¥è®¾ç½® view çš„å››ä¸ªè§’æˆ–è€…å…¶ä¸­ä¸€ä¸ªæˆ–è€…å‡ ä¸ªä¸ºåœ†è§’.</p><p>ä½¿ç”¨çš„æ–¹æ³•:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">+ (instancetype)bezierPathWithRoundedRect:(CGRect)rect </span><br><span class="line">byRoundingCorners:(UIRectCorner)corners </span><br><span class="line">cornerRadii:(CGSize)cornerRadii;</span><br></pre></td></tr></table></figure><p>æ‹–å¥½ç•Œé¢å…ƒç´ ä¹‹å, åœ¨ä»£ç ä¸­æ¥ä¿®æ”¹å…¶ä¸ºåœ†è§’, å±…ç„¶å¤±è´¥äº†.</p><p>æƒ³è¦çš„æ•ˆæœæ˜¯è¿™æ ·çš„:<br><img src="/upload/images/2016/10/23/02.png" alt="1"></p><p>ä½†æ˜¯æœ€ç»ˆæ˜¯è¿™æ ·çš„:<br><img src="/upload/images/2016/10/23/01.png" alt="1"></p><p>äºæ˜¯æ€»ç»“äº†ä¸€ä¸‹, åˆ†äº«ç»™å¤§å®¶.</p><h2 id="è®¾ç½®åœ†è§’"><a href="#è®¾ç½®åœ†è§’" class="headerlink" title="è®¾ç½®åœ†è§’"></a>è®¾ç½®åœ†è§’</h2><p>è¿™é‡Œåˆ†ä¸¤ç§æƒ…å†µ.</p><p><strong>ç¬¬ä¸€ç§:</strong> åªæ”¾ç½®æ§ä»¶, ä¸è®¾ç½®çº¦æŸ.</p><p>1.storyboard ä¸­æ‹–å¥½æ§ä»¶.</p><p>æ³¨æ„: è¿™é‡Œæˆ‘å¹¶æ²¡æœ‰è®¾ç½®ä»»ä½•çº¦æŸ.</p><p>2.vc ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">@interface ViewController ()</span><br><span class="line"></span><br><span class="line">@property (strong, nonatomic) IBOutlet UILabel *lb;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation ViewController</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    [self changeLbCorner];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)changeLbCorner</span><br><span class="line">&#123;</span><br><span class="line">   UIBezierPath *maskPath = [UIBezierPath bezierPathWithRoundedRect:self.lb.frame</span><br><span class="line">                                                  byRoundingCorners:UIRectCornerTopRight|UIRectCornerBottomRight</span><br><span class="line">                                                        cornerRadii:CGSizeMake(7, 7)];</span><br><span class="line">   CAShapeLayer *maskLayer = [[CAShapeLayer alloc] init];</span><br><span class="line">   maskLayer.frame = _lb.bounds;</span><br><span class="line">   maskLayer.path = maskPath.CGPath;</span><br><span class="line">   self.lb.layer.mask  = maskLayer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>ä»£ç ç¼–è¯‘è¿è¡Œåˆ°æ¨¡æ‹Ÿå™¨(iphone6), çœ‹ä¸åˆ°ä»»ä½•ä¸œè¥¿.</p><p>log æ—¥å¿—æ˜¾ç¤º lb çš„ä¿¡æ¯å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[ViewController viewDidLoad]:</span><br><span class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;136, 39&#125;&#125; </span><br><span class="line">lb.frame: &#123;&#123;39, 89&#125;, &#123;136, 39&#125;&#125;</span><br></pre></td></tr></table></figure><p>ä½ç½®ä¿¡æ¯æ˜¯æ­£ç¡®çš„, å’¨è¯¢æ£€æŸ¥å‘ç°æ˜¯å‚æ•°ä¼ å…¥é”™è¯¯, ä¿®æ”¹ changeLbCorner æ–¹æ³•:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- (void)changeLbCorner</span><br><span class="line">&#123;</span><br><span class="line">    UIBezierPath *maskPath = [UIBezierPath bezierPathWithRoundedRect:self.lb.bounds</span><br><span class="line">                                                   byRoundingCorners:UIRectCornerTopRight|UIRectCornerBottomRight</span><br><span class="line">                                                         cornerRadii:CGSizeMake(7, 7)];</span><br><span class="line">    CAShapeLayer *maskLayer = [[CAShapeLayer alloc] init];</span><br><span class="line">    maskLayer.frame = _lb.bounds;</span><br><span class="line">    maskLayer.path = maskPath.CGPath;</span><br><span class="line">    self.lb.layer.mask  = maskLayer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œåªæ˜¯å°† <code>self.lb.frame</code> æ”¹æˆäº† <code>self.lb.bounds</code>.</p><p>å†æ¬¡è¿è¡Œå¯ä»¥çœ‹åˆ°æ•ˆæœ:<br><img src="/upload/images/2016/10/23/02.png" alt="1"></p><p><strong>ç¬¬äºŒç§:</strong> æ”¾ç½®æ§ä»¶å¹¶è®¾ç½®çº¦æŸ.</p><p>1.è®¾ç½® lb è·ç¦»çˆ¶ view å·¦è¾¹å’Œä¸Šè¾¹çš„çº¦æŸ.<br>2.è¿è¡Œä¸Šé¢çš„ä»£ç , å‘ç°, lb å¹¶æ²¡æœ‰è¢«è®¾ç½®ä¸ºåœ†è§’.<br>å¹¶ä¸” lb çš„å®½åº¦å’Œé«˜åº¦å˜å°äº†, å˜æˆäº†æ–‡å­—çš„å®é™…çš„å®½é«˜.<br><img src="/upload/images/2016/10/23/04.png" alt="1"></p><p>çœ‹ log:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[ViewController viewDidLoad]:</span><br><span class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;136, 39&#125;&#125; </span><br><span class="line">lb.frame: &#123;&#123;39, 89&#125;, &#123;136, 39&#125;&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®è¿™ä¸ªæ—¶å€™, (ä»ä¸Šé¢å›¾ä¸­å¯ä»¥çœ‹å‡º) è¿™é‡Œçš„ä¿¡æ¯æ˜¯é”™è¯¯çš„.</p><p>æ­£ç¡®çš„ä¿¡æ¯åº”è¯¥æ˜¯è¿™æ ·çš„(åœ¨ viewDidAppear ä¸­)æ‰“å°ä¿¡æ¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[ViewController viewDidAppear]:</span><br><span class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;58.5, 19.5&#125;&#125; </span><br><span class="line">lb.frame: &#123;&#123;39, 89&#125;, &#123;58.5, 19.5&#125;&#125;</span><br></pre></td></tr></table></figure><p>äºæ˜¯, å°†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[self changeLbCorner];</span><br></pre></td></tr></table></figure><p>æ”¾åˆ° viewDidAppear ä¸­, åœ†è§’å°±æ­£å¸¸äº†.</p><p>æ¥ä¸‹æ¥, æˆ‘ä»¬æŠŠ lb çš„å®½é«˜(136*39)çº¦æŸä¹ŸåŠ ä¸Š.</p><p>çœ‹ä¸€ä¸‹, viewDidLoad å’Œ viewDidAppear æ–¹æ³•ä¸­æ‰“å°çš„ä¿¡æ¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[ViewController viewDidLoad]</span><br><span class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;1000, 1000&#125;&#125; </span><br><span class="line">lb.frame: &#123;&#123;0, 0&#125;, &#123;1000, 1000&#125;&#125;</span><br><span class="line">[ViewController viewDidAppear:]</span><br><span class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;136, 39&#125;&#125; </span><br><span class="line">lb.frame: &#123;&#123;39, 89&#125;, &#123;136, 39&#125;&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡º, viewDidLoad ä¸­é”™çš„ä¸€å¡Œç³Šæ¶‚.</p><p>è¿™é‡Œä¹Ÿè¯´æ˜ä¸€ä¸ªé—®é¢˜:</p><blockquote><p>xib æˆ–è€… storyboard ä¸­è®¾ç½®è¿‡çº¦æŸ(ç°å®å¼€å‘ä¸­, åŸºæœ¬éƒ½ä¼šè®¾ç½®çº¦æŸ)çš„ç»„ä»¶, åœ¨ viewDidLoad ä¸­å¹¶æ²¡æœ‰å®Œå…¨ layout, åªæ˜¯é¢„åŠ è½½äº†è¿™äº›ç»„ä»¶.<br>æƒ³è·å–ç»„ä»¶å¦‚ frame ä½• bounds ä¿¡æ¯, åœ¨ viewDidLoad ä¸­æ˜¯ä¸åˆé€‚ç”šè‡³æ˜¯é”™è¯¯çš„.</p></blockquote><p>é‚£ä¹ˆ, é—®é¢˜æ¥äº†, å“ªé‡Œåˆé€‚å“ªé‡Œæ­£ç¡®.</p><p>ä¸Šé¢å¦‚æœä½ è®¤çœŸçœ‹äº†, åœ¨ viewDidAppear ä¸­æ˜¯å¯ä»¥æ­£ç¡®è·å–çš„, é‚£ä¹ˆè¿˜æœ‰æ²¡æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥è·å–å‘¢?</p><h2 id="VC-ç”Ÿå‘½å‘¨æœŸå‡½æ•°"><a href="#VC-ç”Ÿå‘½å‘¨æœŸå‡½æ•°" class="headerlink" title="VC ç”Ÿå‘½å‘¨æœŸå‡½æ•°"></a>VC ç”Ÿå‘½å‘¨æœŸå‡½æ•°</h2><p>è¦å›ç­”ä¸Šé¢çš„é—®é¢˜, å¤§å®¶è¦çŸ¥é“ vc çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°.</p><p>ä¸Šé¢çš„ä¾‹å­, å¯ä»¥çœ‹å‡º: å½“å‡½æ•° ViewDidLoad è¢«è°ƒç”¨çš„æ—¶å€™ï¼ŒIBQutlets å·²ç»è¢«è¿æ¥ï¼Œä½†View è¿˜æ²¡æœ‰è¢«åŠ è½½å‡ºæ¥ï¼Œæ— æ³•è·å– frame ç­‰ä¿¡æ¯.<br>å¯ä»¥åœ¨ viewDidLoad ä¸­å®Œæˆåœ¨ IB ä¸­ä¸èƒ½å®Œæˆçš„ view çš„è‡ªå®šä¹‰ã€‚</p><p>å…³äº loadView å’Œ viewDidLoad åœ¨åé¢åšå®¢è·Ÿå¤§å®¶åˆ†äº«.</p><p>ä»Šå¤©è¦è¯´çš„æ˜¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">viewDidLayoutSubviews</span><br></pre></td></tr></table></figure><p><code>viewDidLayoutSubviews</code> åœ¨ VC å­è§†å›¾ä½ç½®æˆ–è€…å°ºå¯¸ (position|size) è¢«æ”¹å˜çš„æ—¶å€™è¢«è°ƒç”¨.</p><p>ç›´åˆ° AutoLayout å·²ç»å®Œæˆå·¥ä½œçš„æ—¶å€™æ‰ä¼šè¢«ç¡®å®šï¼Œæ‰€ä»¥åœ¨æ‰§è¡Œå®Œ AutoLayout ä¹‹åä¼šè°ƒç”¨æ­¤æ–¹æ³•. æ¢å¥è¯è¯´, view çš„ frame å’Œ bounds è¿™ä¸ªæ—¶å€™æ˜¯æ­£ç¡®å¯ä»¥è·å–çš„.</p><p><code>viewDidLayoutSubviews</code> è¿™ä¸ªæ–¹æ³•åœ¨ <code>viewDidAppear</code> ä¹‹å‰è¢«è°ƒç”¨, æœ‰å¯èƒ½ä¼šè¢«è°ƒç”¨å¤šæ¬¡.</p><p>å³ä¾èµ– bounds æˆ–è€… frame çš„æ“ä½œï¼Œéƒ½åº”è¯¥æ”¾åœ¨<code>viewDidLayoutSubviews</code> ä¸­ï¼Œè€Œä¸æ˜¯ <code>viewDidLoad</code> æˆ– <code>viewWillAppear</code> ä¸­.</p><p>æ”¹å˜åçš„ä»£ç å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;ViewController.h&quot;</span><br><span class="line"></span><br><span class="line">#define MZLog(fmt, ...) NSLog((@&quot;%s\n&quot; fmt), __FUNCTION__, ##__VA_ARGS__)</span><br><span class="line">#define MZLogLbInfo \</span><br><span class="line">MZLog(@&quot;lb.bounds: %@ \nlb.frame: %@&quot;, NSStringFromCGRect(self.lb.bounds), NSStringFromCGRect(self.lb.frame))</span><br><span class="line"></span><br><span class="line">@interface ViewController ()</span><br><span class="line"></span><br><span class="line">@property (strong, nonatomic) IBOutlet UILabel *lb;</span><br><span class="line">@property (strong, nonatomic) IBOutlet UILabel *displayedText;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation ViewController</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    MZLogLbInfo;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewWillAppear:(BOOL)animated</span><br><span class="line">&#123;</span><br><span class="line">    [super viewWillAppear:animated];</span><br><span class="line">    </span><br><span class="line">    MZLogLbInfo;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewWillLayoutSubviews</span><br><span class="line">&#123;</span><br><span class="line">    [super viewWillLayoutSubviews];</span><br><span class="line">    </span><br><span class="line">    MZLogLbInfo;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewDidLayoutSubviews</span><br><span class="line">&#123;</span><br><span class="line">    [super viewDidLayoutSubviews];</span><br><span class="line">    </span><br><span class="line">    MZLogLbInfo;</span><br><span class="line">    </span><br><span class="line">    [self changeLbCorner];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewDidAppear:(BOOL)animated</span><br><span class="line">&#123;</span><br><span class="line">    [super viewDidAppear:animated];</span><br><span class="line">    </span><br><span class="line">    MZLogLbInfo;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark Callback.</span><br><span class="line"></span><br><span class="line">- (void)changeLbCorner</span><br><span class="line">&#123;</span><br><span class="line">    UIBezierPath *maskPath = [UIBezierPath bezierPathWithRoundedRect:self.lb.bounds</span><br><span class="line">                                                   byRoundingCorners:UIRectCornerTopRight|UIRectCornerBottomRight</span><br><span class="line">                                                         cornerRadii:CGSizeMake(7, 7)];</span><br><span class="line">    CAShapeLayer *maskLayer = [[CAShapeLayer alloc] init];</span><br><span class="line">    maskLayer.frame = _lb.bounds;</span><br><span class="line">    maskLayer.path = maskPath.CGPath;</span><br><span class="line">    self.lb.layer.mask  = maskLayer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>æ‰“å°çš„ log å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[ViewController viewDidLoad]</span><br><span class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;1000, 1000&#125;&#125; </span><br><span class="line">lb.frame: &#123;&#123;0, 0&#125;, &#123;1000, 1000&#125;&#125;</span><br><span class="line">[ViewController viewWillAppear:]</span><br><span class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;1000, 1000&#125;&#125; </span><br><span class="line">lb.frame: &#123;&#123;0, 0&#125;, &#123;1000, 1000&#125;&#125;</span><br><span class="line">[ViewController viewWillLayoutSubviews]</span><br><span class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;1000, 1000&#125;&#125; </span><br><span class="line">lb.frame: &#123;&#123;0, 0&#125;, &#123;1000, 1000&#125;&#125;</span><br><span class="line">[ViewController viewDidLayoutSubviews]</span><br><span class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;136, 39&#125;&#125; </span><br><span class="line">lb.frame: &#123;&#123;39, 89&#125;, &#123;136, 39&#125;&#125;</span><br><span class="line">[ViewController viewWillLayoutSubviews]</span><br><span class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;136, 39&#125;&#125; </span><br><span class="line">lb.frame: &#123;&#123;39, 89&#125;, &#123;136, 39&#125;&#125;</span><br><span class="line">[ViewController viewDidLayoutSubviews]</span><br><span class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;136, 39&#125;&#125; </span><br><span class="line">lb.frame: &#123;&#123;39, 89&#125;, &#123;136, 39&#125;&#125;</span><br><span class="line">[ViewController viewDidAppear:]</span><br><span class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;136, 39&#125;&#125; </span><br><span class="line">lb.frame: &#123;&#123;39, 89&#125;, &#123;136, 39&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="frame-å’Œ-bounds"><a href="#frame-å’Œ-bounds" class="headerlink" title="frame å’Œ bounds"></a>frame å’Œ bounds</h2><p>ä¸Šé¢çš„ä¾‹å­, å¤§å®¶çœ‹åˆ°ç”±äºä¼ å…¥äº† frame è€Œä¸æ˜¯ bounds é€ æˆè®¾ç½®åœ†è§’å¤±è´¥.</p><p>ä¸‹é¢è¯´è¯´ frame å’Œ bounds.</p><h3 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h3><p>ä»ç½‘ä¸Šâ€å·â€è¿‡æ¥çš„å›¾</p><p><img src="/upload/images/2016/10/23/03.jpg" alt="1"></p><blockquote><p>1.frame</p></blockquote><p>è¯¥ view åœ¨çˆ¶ view åæ ‡ç³»ç»Ÿä¸­çš„ä½ç½®å’Œå¤§å°(å‚ç…§ç‚¹æ˜¯ï¼Œçˆ¶åæ ‡ç³»ç»Ÿ).</p><blockquote><p>2.bounds</p></blockquote><p>è¯¥ view åœ¨æœ¬åœ°åæ ‡ç³»ç»Ÿä¸­çš„ä½ç½®å’Œå¤§å°(å‚ç…§ç‚¹æ˜¯ï¼Œæœ¬åœ°åæ ‡ç³»ç»Ÿï¼Œå°±ç›¸å½“äº view è‡ªå·±çš„åæ ‡ç³»ç»Ÿï¼Œä»¥(0,0)ç‚¹ä¸ºèµ·ç‚¹).<br>å…¶å®æœ¬åœ°åæ ‡ç³»ç»Ÿçš„å…³é”®å°±æ˜¯è¦çŸ¥é“çš„å®ƒçš„åŸç‚¹(0,0).</p><p>bounds é»˜è®¤å€¼æ˜¯(0, 0, width, height).é™¤éæ‰‹åŠ¨æ”¹å˜ bounds çš„å€¼.</p><p>å•çº¯çš„ä»æ¦‚å¿µä¸Šé¢, å¾ˆéš¾ç†è§£äºŒè€…çš„åŒºåˆ«.</p><p>æä¾›ä¸€ä¸ªä¾‹å­, ä¾‹å­å¤§æ¦‚æ˜¯è¿™æ ·çš„:<br>redView æ˜¯ yellowView çš„çˆ¶è§†å›¾, yellowView æ˜¯ blueView çš„çˆ¶è§†å›¾.</p><p>é€šè¿‡æ”¹å˜ redView çš„ bounds ä¼šå½±å“å­è§†å›¾çš„ä½ç½®(ä¸æ˜¯frame).<br>å°† redView çš„ bounds èµ·ç‚¹è®¾ä¸º(-20, -20), å­è§†å›¾ç›¸å¯¹äº redView çš„æœ¬åœ°åæ ‡(0, 0), ä¹Ÿå°±éœ€è¦å¾€ä¸‹å¢åŠ 20, è¿™æ ·, yellowView å°±å¾€ä¸‹ç§»åŠ¨äº†.</p><h3 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾:"></a>æ•ˆæœå›¾:</h3><p><img src="/upload/images/2016/10/23/05.png" alt="1"></p><p><img src="/upload/images/2016/10/23/06.png" alt="1"></p><p><img src="/upload/images/2016/10/23/07.png" alt="1"></p><h3 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;ViewController.h&quot;</span><br><span class="line"></span><br><span class="line">#define MZLog(fmt, ...) NSLog((@&quot;%s\n&quot; fmt), __FUNCTION__, ##__VA_ARGS__)</span><br><span class="line">#define MZLogLbInfo \</span><br><span class="line">MZLog(@&quot;lb.bounds: %@ \nlb.frame: %@&quot;, NSStringFromCGRect(self.lb.bounds), NSStringFromCGRect(self.lb.frame))</span><br><span class="line"></span><br><span class="line">@interface ViewController ()</span><br><span class="line"></span><br><span class="line">@property (strong, nonatomic) IBOutlet UILabel *lb;</span><br><span class="line">@property (strong, nonatomic) IBOutlet UILabel *displayedText;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation ViewController</span><br><span class="line">&#123;</span><br><span class="line">    UIView *redView;</span><br><span class="line">    UIView *yellowView;</span><br><span class="line">    UIView *blueView;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    MZLogLbInfo;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    // å°† redView æ·»åŠ åˆ° self.view</span><br><span class="line">    &#123;</span><br><span class="line">        redView = [[UIView alloc] initWithFrame:CGRectMake(100, 200, 120, 120)];</span><br><span class="line">        redView.backgroundColor = [UIColor redColor];</span><br><span class="line">        [self.view addSubview:redView];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // å°† yellowView æ·»åŠ åˆ° redView</span><br><span class="line">    &#123;</span><br><span class="line">        yellowView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 90, 90)];</span><br><span class="line">        yellowView.backgroundColor = [UIColor yellowColor];</span><br><span class="line">        [redView addSubview:yellowView];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // å°† blueView æ·»åŠ åˆ° yellowView</span><br><span class="line">    &#123;</span><br><span class="line">        blueView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 60, 60)];</span><br><span class="line">        blueView.backgroundColor = [UIColor blueColor];</span><br><span class="line">        [yellowView addSubview:blueView];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    [self logViewInfo];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewWillAppear:(BOOL)animated</span><br><span class="line">&#123;</span><br><span class="line">    [super viewWillAppear:animated];</span><br><span class="line">    </span><br><span class="line">    MZLogLbInfo;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewWillLayoutSubviews</span><br><span class="line">&#123;</span><br><span class="line">    [super viewWillLayoutSubviews];</span><br><span class="line">    </span><br><span class="line">    MZLogLbInfo;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewDidLayoutSubviews</span><br><span class="line">&#123;</span><br><span class="line">    [super viewDidLayoutSubviews];</span><br><span class="line">    </span><br><span class="line">    MZLogLbInfo;</span><br><span class="line">    </span><br><span class="line">    [self changeLbCorner];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewDidAppear:(BOOL)animated</span><br><span class="line">&#123;</span><br><span class="line">    [super viewDidAppear:animated];</span><br><span class="line">    </span><br><span class="line">    MZLogLbInfo;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark Callback.</span><br><span class="line"></span><br><span class="line">- (void)changeLbCorner</span><br><span class="line">&#123;</span><br><span class="line">    UIBezierPath *maskPath = [UIBezierPath bezierPathWithRoundedRect:self.lb.bounds</span><br><span class="line">                                                   byRoundingCorners:UIRectCornerTopRight|UIRectCornerBottomRight</span><br><span class="line">                                                         cornerRadii:CGSizeMake(7, 7)];</span><br><span class="line">    CAShapeLayer *maskLayer = [[CAShapeLayer alloc] init];</span><br><span class="line">    maskLayer.frame = _lb.bounds;</span><br><span class="line">    maskLayer.path = maskPath.CGPath;</span><br><span class="line">    self.lb.layer.mask  = maskLayer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (IBAction)doResetAction:(id)sender</span><br><span class="line">&#123;</span><br><span class="line">    [UIView animateWithDuration:1.0f animations:^&#123;</span><br><span class="line">        [redView setBounds:CGRectMake(0, 0, 120, 120)];</span><br><span class="line">        [yellowView setBounds:CGRectMake(0, 0, 90, 90)];</span><br><span class="line">    &#125; completion:^(BOOL finished) &#123;</span><br><span class="line">        [self logViewInfo];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (IBAction)doChangeRedViewBounds:(id)sender</span><br><span class="line">&#123;</span><br><span class="line">    [UIView animateWithDuration:1.0f animations:^&#123;</span><br><span class="line">        [redView setBounds:CGRectMake(-20, -20, 120, 120)];</span><br><span class="line">    &#125; completion:^(BOOL finished) &#123;</span><br><span class="line">        [self logViewInfo];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (IBAction)doChangeYellowViewBounds:(id)sender</span><br><span class="line">&#123;</span><br><span class="line">    [UIView animateWithDuration:1.0f animations:^&#123;</span><br><span class="line">        [yellowView setBounds:CGRectMake(-20, -20, 90, 90)];</span><br><span class="line">    &#125; completion:^(BOOL finished) &#123;</span><br><span class="line">        [self logViewInfo];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark Display Debug Info.</span><br><span class="line"></span><br><span class="line">- (void)logViewInfo</span><br><span class="line">&#123;</span><br><span class="line">    NSString *log4rView = [NSString stringWithFormat:@&quot;RedView\nframe:%@ \nbounds:%@&quot;,</span><br><span class="line">                           NSStringFromCGRect(redView.frame), NSStringFromCGRect(redView.bounds)];</span><br><span class="line">    NSString *log4yView = [NSString stringWithFormat:@&quot;YellowView\nframe:%@ \nbounds:%@&quot;,</span><br><span class="line">                           NSStringFromCGRect(yellowView.frame), NSStringFromCGRect(yellowView.bounds)];</span><br><span class="line">    NSString *log4bView = [NSString stringWithFormat:@&quot;BlueView\nframe:%@ \nbounds:%@&quot;,</span><br><span class="line">                           NSStringFromCGRect(blueView.frame), NSStringFromCGRect(blueView.bounds)];</span><br><span class="line">    </span><br><span class="line">    NSString *log = [NSString stringWithFormat:@&quot;%@\n%@\n%@&quot;, log4rView, log4yView, log4bView];</span><br><span class="line">    [self display:log];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)display:(NSString *)content</span><br><span class="line">&#123;</span><br><span class="line">    self.displayedText.text = content;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>frame, æè¿°çš„æ˜¯å½“å‰è§†å›¾åœ¨å…¶çˆ¶è§†å›¾ä¸­çš„ä½ç½®å’Œå¤§å°.<br>bounds, æè¿°çš„æ˜¯å½“å‰è§†å›¾åœ¨å…¶è‡ªèº«åæ ‡ç³»ç»Ÿä¸­çš„ä½ç½®å’Œå¤§å°.</li></ul><p>æ‰€ä»¥, bounds é»˜è®¤æ˜¯ <code>(0, 0, frame.size.width, frame.size.height)</code></p><p>å¦å¤–, è¿˜æœ‰ä¸€ä¸ª <code>center</code> æè¿°çš„æ˜¯å½“å‰è§†å›¾çš„ä¸­å¿ƒç‚¹åœ¨å…¶çˆ¶è§†å›¾ä¸­çš„ä½ç½®.</p><ul><li>bounds å’Œ frame æ˜¯ä¸¤ä¸ªä¸ç­‰åŒçš„æ¦‚å¿µ, æ”¹å˜ bounds ä¼šå½±å“å­è§†å›¾çš„ä½ç½®(äººçœ¼çœ‹åˆ°å…¶æ”¹å˜äº†ä½ç½®), è®¾ç½® bounds å¯ä»¥ä¿®æ”¹è‡ªå·±åæ ‡ç³»çš„åŸç‚¹ä½ç½®. ä½†æ˜¯ä¸ä¼šæ”¹å˜å­è§†å›¾çš„ bounds å’Œ frame.</li></ul><blockquote><p>æ˜ç™½ä¸Šé¢çš„é“ç†å¾ˆé‡è¦, iOS ä¸­æ»šåŠ¨è§†å›¾èƒ½è®©ä½ çœ‹åˆ°å…¶ä¸­çš„å†…å®¹, æ­£æ˜¯åˆ©ç”¨äº† contentoffset å’Œ bounds å±æ€§.</p></blockquote><blockquote><p>è¿™é‡Œä»¥ tableView ä¸ºä¾‹å­, å½“æˆ‘ä»¬å‘ä¸Šæ»šåŠ¨ tableView, tableView çš„ contentOffset å’Œ bounds çš„åæ ‡éƒ½æ˜¯æ­£æ•°, ç›¸å½“äºå…¶æœ¬åœ°åæ ‡(0, 0)æ”¹å˜äº†å³å¢åŠ äº†(åæ ‡ç³»å¾€ä¸‹ä¸ºå¢åŠ ), é‚£ä¹ˆå…¶å­è§†å›¾å°±ä¼šå‘ä¸Šå».</p></blockquote><blockquote><p>å‘ä¸‹æ»‘åŠ¨æ—¶, ä¹Ÿæ˜¯åŒä¸€ä¸ªé“ç†.<br>å¯ä»¥é€šè¿‡è¿è¡Œ <a href="https://github.com/veryitman/iOSDemo/tree/master/na">å®Œæ•´ Demo</a> ä¸­[æŸ¥çœ‹ TableView]æŒ‰é’®æ¥æ‰“å¼€ä¾‹å­, çœ‹æ—¥å¿—.</p></blockquote><ul><li><p>æ”¹å˜å­è§†å›¾æ‰€æœ‰çˆ¶è§†å›¾çš„ bounds, å­è§†å›¾çš„ä½ç½®æ˜¯ç´¯åŠ æ”¹å˜çš„.<br>å¦‚ä¸Šé¢æ”¹å˜ redView å’Œ yellowView çš„ bounds, blueView çš„ä½ç½®ç›¸å¯¹ redView å¾€ä¸‹ç§»åŠ¨äº† 40.</p></li><li><p>å½“åŒä¸€ä¸ªè§†å›¾çš„ bounds å¤§äº frame, ä¼šå¯¼è‡´ frame è¢«æ’‘å¤§ï¼Œframe çš„ x, y, width, height éƒ½ä¼šè¢«æ”¹å˜. åä¹‹, bounds å°äº frame, frame ä¹Ÿä¼šå˜å°.</p></li></ul><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><ol><li><p>GitHub ä¸Šé¢å¯ä»¥ä¸‹è½½ <a href="https://github.com/veryitman/iOSDemo/tree/master/na">å®Œæ•´ Demo</a></p></li><li><p>æ¨èä¹‹å‰å†™åœ¨ CSDN ä¸Šçš„åšæ–‡: <a href="http://blog.csdn.net/veryitman/article/details/51622235">iOS UI æŠ€å·§: è§†å›¾æ— æ³•è¢«ç‚¹å‡»</a></p></li></ol><p>å¯å…³æ³¨æˆ‘çš„å¾®ä¿¡å…¬ä¼—å·:<br><img src="/upload/me/qrcode_wx.jpg" alt="1"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS frame bounds </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RN: æ¨¡æ‹Ÿ Mobx</title>
      <link href="/2016/10/11/RN-%E6%A8%A1%E6%8B%9F-Mobx/"/>
      <url>/2016/10/11/RN-%E6%A8%A1%E6%8B%9F-Mobx/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>çœ‹è¿‡ [React Native ä½¿ç”¨ Mobx] è¿™ç¯‡åšå®¢çš„åŒå­¦, å¯¹ Mobx åº”è¯¥æœ‰äº†ä¸€ä¸ªç®€å•ç›´è§‚çš„è®¤è¯†.</p><p>å…¶å®, æˆ‘ä»¬å®Œå…¨å¯ä»¥ä½¿ç”¨ RN ä¸­çš„ State æ¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœ.</p><p>ä»Šå¤©çš„ä¸»è¦å†…å®¹æ˜¯ä½¿ç”¨ State æ¥æ¨¡æ‹Ÿ Mobx, ä¹Ÿç®—æ˜¯å¯¹ Mobx çš„è¿›ä¸€æ­¥è®¤è¯†.</p><p>æ•ˆæœ</p><p>å®ç°æ•ˆæœå’Œ [React Native ä½¿ç”¨ Mobx] ä¸­çš„æ•ˆæœä¸€è‡´, åªæ˜¯ä»£ç æ²¡æœ‰ä½¿ç”¨ Mobx æ¡†æ¶.</p><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><h3 id="LegacyCounter-js"><a href="#LegacyCounter-js" class="headerlink" title="LegacyCounter.js"></a>LegacyCounter.js</h3><blockquote><p>Add å’Œ Minus ä¸¤ä¸ªæŒ‰é’®åˆ†åˆ«è§¦å‘å„è‡ªçš„å›è°ƒ, æ¥æ›´æ–° state.<br>ä½¿ç”¨ state çš„å˜åŒ–æ¥åˆ°è¾¾æ›´æ–° View (è®¡æ•°çš„ Text ä¼šç›¸åº”çš„åšå‡ºå˜åŒ–)çš„ç›®çš„.</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * æ¨¡æ‹Ÿ Mobx åœ¨ ReactNative ä¸Šçš„ä¸€ä¸ªå°ä¾‹å­.</span><br><span class="line"> * </span><br><span class="line"> * state -&gt; view</span><br><span class="line"> */</span><br><span class="line">&#x27;use strict&#x27;;</span><br><span class="line">import React, &#123; Component &#125; from &#x27;react&#x27;;</span><br><span class="line">import &#123;</span><br><span class="line">  StyleSheet,</span><br><span class="line">  View,</span><br><span class="line">  Text,</span><br><span class="line">  TouchableHighlight</span><br><span class="line">&#125; from &#x27;react-native&#x27;;</span><br><span class="line">class LegacyCounter extends Component &#123;</span><br><span class="line">    //æ„é€ æ–¹æ³•</span><br><span class="line">    constructor(props) &#123;</span><br><span class="line">        super(props);</span><br><span class="line">    </span><br><span class="line">        this.state = &#123;</span><br><span class="line">            //è®¡æ•°</span><br><span class="line">            counter: 0</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    render () &#123;</span><br><span class="line">        return (</span><br><span class="line">          &lt;View style = &#123;styles.container&#125;&gt;</span><br><span class="line">            &#123;/*åŠ ä¸€*/&#125;</span><br><span class="line">            &lt;TouchableHighlight</span><br><span class="line">                onPress = &#123;() =&gt; &#123;this.setState(&#123;</span><br><span class="line">                    counter: ++this.state.counter</span><br><span class="line">                &#125;)&#125;&#125;&gt;</span><br><span class="line">                &lt;Text&gt;Add&lt;/Text&gt;</span><br><span class="line">            &lt;/TouchableHighlight&gt;</span><br><span class="line">            &#123;/* æ˜¾ç¤ºå¤„ç†ç»“æœ */&#125;</span><br><span class="line">            &lt;Text style = &#123;styles.resultTxtStyle&#125;&gt;</span><br><span class="line">            &#123;this.state.counter&#125;</span><br><span class="line">            &lt;/Text&gt;</span><br><span class="line">            &#123;/*å‡ä¸€*/&#125;</span><br><span class="line">            &lt;TouchableHighlight </span><br><span class="line">                onPress = &#123;() =&gt; &#123;this.setState(&#123;</span><br><span class="line">                    counter: --this.state.counter</span><br><span class="line">                &#125;)&#125;&#125;&gt;</span><br><span class="line">                &lt;Text&gt;Minus&lt;/Text&gt;</span><br><span class="line">            &lt;/TouchableHighlight&gt;</span><br><span class="line">          &lt;/View&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">export default class LegacyComponent extends Component &#123;</span><br><span class="line">    render () &#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;View style = &#123;&#123;flex: 1, marginTop: 64&#125;&#125;&gt;</span><br><span class="line">            </span><br><span class="line">                &lt;LegacyCounter/&gt;</span><br><span class="line">            &lt;/View&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">/* æ ·å¼å®šä¹‰ */</span><br><span class="line">const styles = StyleSheet.create(&#123;</span><br><span class="line">    container: &#123;</span><br><span class="line">        flexDirection: &#x27;row&#x27;,</span><br><span class="line">        justifyContent: &#x27;space-around&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">    resultTxtStyle: &#123;</span><br><span class="line">        fontSize: 22, </span><br><span class="line">        color: &#x27;red&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="index-ios-js"><a href="#index-ios-js" class="headerlink" title="index.ios.js"></a>index.ios.js</h3><blockquote><p>è¿™ä¸ªæ–‡ä»¶å¾ˆç®€å•, åªæ˜¯è°ƒç”¨ LegacyCounter ä¸­çš„ç»„ä»¶.</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &#x27;react&#x27;;</span><br><span class="line">//å¼•å…¥è‡ªå®šä¹‰æ¨¡å—</span><br><span class="line">import LegacyComponent from &#x27;./js/Mobx/LegacyCounter&#x27;</span><br><span class="line">import &#123;</span><br><span class="line">  AppRegistry</span><br><span class="line">&#125; from &#x27;react-native&#x27;;</span><br><span class="line">class RNMobxDemo extends Component &#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        return(</span><br><span class="line">            &lt;LegacyComponent/&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">AppRegistry.registerComponent(&#x27;RNMobxDemo&#x27;, () =&gt; MZRNTutorial);</span><br></pre></td></tr></table></figure><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº RN ä¸­ State çš„çŸ¥è¯†, è¯·ç§»æ­¥å®˜æ–¹æ–‡æ¡£æŸ¥é˜… State çš„ç”¨æ³•.</p><p>åç»­ä¼šç»™å¤§å®¶å¸¦æ¥æ›´å¤šå…³äº RN è¿™äº›æ–¹é¢çš„ä¸œè¥¿.</p>]]></content>
      
      
      <categories>
          
          <category> ReactNative </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS Android ReactNative </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RN: ä½¿ç”¨ Mobx</title>
      <link href="/2016/10/06/RN-%E4%BD%BF%E7%94%A8-Mobx/"/>
      <url>/2016/10/06/RN-%E4%BD%BF%E7%94%A8-Mobx/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¥ç”±"><a href="#æ¥ç”±" class="headerlink" title="æ¥ç”±"></a>æ¥ç”±</h2><p>åœ¨ <a href="https://jsfiddle.net/24u7juu0/">JSFiddler</a> ä¸Šé¢çœ‹åˆ° React ç»“åˆ Mobx çš„ä¸€ä¸ªå°ä¾‹å­.</p><p>çˆ±ä¸é‡Šæ‰‹, é‚æ‹¿æ¥æ”¹é€ ä¸€ä¸‹, è®©å…¶èƒ½åœ¨ RN ä¸Šé¢ä¸€å±•é›„é£.</p><p>ä¹‹å‰å¬è¿‡ Mobx, è¯´æ˜¯è¦æ›¿ä»£ Redux, åæ­£æˆ‘æ˜¯ä¸çŸ¥é“è¿™äº›ä¸œä¸œ, ç¬¬ä¸€æ¬¡å¬è¯´æ²¡æœ‰ä»€ä¹ˆæ„Ÿè§‰!<br>å¦‚ä»Šåˆå†æ¬¡å¶é‡ Mobx, å†³å®šè®¤çœŸå­¦ä¹ ä¸€ä¸‹å®ƒ.</p><h2 id="Mobx-ç®€ä»‹"><a href="#Mobx-ç®€ä»‹" class="headerlink" title="Mobx ç®€ä»‹"></a>Mobx ç®€ä»‹</h2><p>Mobx çš„ <a href="https://github.com/mobxjs/mobx">github</a> åœ°å€.<br>ç›®å‰å…³äºä»–å’Œ React Native çš„(ä¸­æ–‡)èµ„æ–™ä¸å¤š, å¤§å¤šæ•°æ˜¯å…³äº React çš„.</p><p>çœ‹æ¥æƒ³å­¦å¥½ React Native, è¿˜æ˜¯è¦åšå¥½ React çš„åŠŸè¯¾å‘€!</p><p>å®˜ç½‘ç»™äº†ä¸€ä¸ª Mobx çš„å›¾:<br><img src="/upload/images/2016/10/08/rn_mobx_ef4.png" alt="1"></p><p>æˆ‘ä¹Ÿæ˜¯åˆšæ¥è§¦è¿™ä¸ªã€Œç‰›é€¼é—ªé—ªã€çš„ Mobx, å…±å‹‰!</p><h2 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h2><p>ä»Šå¤©çš„ä¾‹å­å¾ˆç®€å•, æ•ˆæœå›¾å¦‚ä¸‹<br><img src="/upload/images/2016/10/08/rn_mobx_ef1.png" alt="1"></p><p>ç‚¹å‡» Add<br><img src="/upload/images/2016/10/08/rn_mobx_ef3.png" alt="1"></p><p>ç‚¹å‡» Minus<br><img src="/upload/images/2016/10/08/rn_mobx_ef2.png" alt="1"></p><p>ä¸‹é¢å…·ä½“è¯´è¯´å¦‚ä½•æå®šè¿™ä¸ª Demo.</p><h2 id="å‡†å¤‡ã€Œææ–™ã€"><a href="#å‡†å¤‡ã€Œææ–™ã€" class="headerlink" title="å‡†å¤‡ã€Œææ–™ã€"></a>å‡†å¤‡ã€Œææ–™ã€</h2><p>è¿™é‡Œå‡è®¾ä½ å·²ç»å…·å¤‡ React Native çš„åŸºæœ¬å¼€å‘ç¯å¢ƒ, è‡³å°‘æˆåŠŸè¿è¡Œè¿‡ä¸€æ¬¡ React Native çš„ç¨‹åº.</p><h3 id="1-åˆ›å»º-React-Native-é¡¹ç›®"><a href="#1-åˆ›å»º-React-Native-é¡¹ç›®" class="headerlink" title="1.åˆ›å»º React Native é¡¹ç›®"></a>1.åˆ›å»º React Native é¡¹ç›®</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native init RNMobxDemo</span><br></pre></td></tr></table></figure><p>ä½ ä¹Ÿå¯ä»¥ç»™ä½ çš„å·¥ç¨‹å–ä¸€ä¸ªä½ å–œæ¬¢çš„åå­—.<br>è¿™é‡Œå§‘ä¸”ç§°ä¹‹ä¸º RNMobxDemo</p><h3 id="2-å®‰è£…-mobx-å’Œ-mobx-react"><a href="#2-å®‰è£…-mobx-å’Œ-mobx-react" class="headerlink" title="2.å®‰è£… mobx å’Œ mobx-react"></a>2.å®‰è£… mobx å’Œ mobx-react</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i mobx mobx-react --save</span><br></pre></td></tr></table></figure><h3 id="3-Counter-js"><a href="#3-Counter-js" class="headerlink" title="3.Counter.js"></a>3.Counter.js</h3><blockquote><p>è¯¥æ–‡ä»¶ä½¿ç”¨äº† mobx å’Œ mobx-react çš„ç»„ä»¶.</p></blockquote><p>å…·ä½“ä»£ç :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">&#x27;use strict&#x27;;</span><br><span class="line">import React, &#123; Component &#125; from &#x27;react&#x27;;</span><br><span class="line">import &#123;</span><br><span class="line">  StyleSheet,</span><br><span class="line">  View,</span><br><span class="line">  Text,</span><br><span class="line">  TouchableHighlight</span><br><span class="line">&#125; from &#x27;react-native&#x27;;</span><br><span class="line">import &#123; observer &#125; from &#x27;mobx-react/native&#x27;;</span><br><span class="line">import &#123; observable &#125; from &#x27;mobx&#x27;;</span><br><span class="line">// è¢«è§‚å¯Ÿè€…, è§‚å¯Ÿ counter å˜é‡  </span><br><span class="line">const storer = observable(&#123;</span><br><span class="line">    counter: 0</span><br><span class="line">&#125;);</span><br><span class="line">//---------------------------------</span><br><span class="line">//  ES6 å†™æ³•: Arrow Function</span><br><span class="line">//---------------------------------</span><br><span class="line">storer.plus =  () =&gt; &#123;</span><br><span class="line">    storer.counter ++;</span><br><span class="line">&#125;;</span><br><span class="line">storer.minus = () =&gt; &#123;</span><br><span class="line">    storer.counter --;</span><br><span class="line">&#125;;</span><br><span class="line">class Counter extends Component &#123;</span><br><span class="line">    render () &#123;</span><br><span class="line">        return (</span><br><span class="line">          &lt;View style = &#123;styles.container&#125;&gt;</span><br><span class="line">            &#123;/*åŠ ä¸€*/&#125;</span><br><span class="line">            &lt;TouchableHighlight</span><br><span class="line">                onPress = &#123;() =&gt; &#123;this.props.store.plus()&#125;&#125;&gt;</span><br><span class="line">                &lt;Text&gt;Add&lt;/Text&gt;</span><br><span class="line">            &lt;/TouchableHighlight&gt;</span><br><span class="line">            &#123;/* æ˜¾ç¤ºå¤„ç†ç»“æœ */&#125;</span><br><span class="line">            &lt;Text style = &#123;styles.resultTxtStyle&#125;&gt;</span><br><span class="line">            &#123;this.props.store.counter&#125;</span><br><span class="line">            &lt;/Text&gt;</span><br><span class="line">            &#123;/*å‡ä¸€*/&#125;</span><br><span class="line">            &lt;TouchableHighlight </span><br><span class="line">                onPress = &#123;() =&gt; &#123;storer.minus()&#125;&#125;&gt;</span><br><span class="line">                &lt;Text&gt;Minus&lt;/Text&gt;</span><br><span class="line">            &lt;/TouchableHighlight&gt;</span><br><span class="line">          &lt;/View&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">// ä½¿ç”¨ observer åˆ›å»º</span><br><span class="line">const CounterComponent = observer(Counter);</span><br><span class="line">export default class ReactionsComponent extends Component &#123;</span><br><span class="line">    render () &#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;View style = &#123;&#123;flex: 1, marginTop: 64&#125;&#125;&gt;</span><br><span class="line">            </span><br><span class="line">                &lt;CounterComponent store = &#123;storer&#125; /&gt; </span><br><span class="line">            &lt;/View&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">/* æ ·å¼å®šä¹‰ */</span><br><span class="line">const styles = StyleSheet.create(&#123;</span><br><span class="line">    container: &#123;</span><br><span class="line">        flexDirection: &#x27;row&#x27;,</span><br><span class="line">        justifyContent: &#x27;space-around&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">    resultTxtStyle: &#123;</span><br><span class="line">        fontSize: 22, </span><br><span class="line">        color: &#x27;red&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="4-index-ios-js"><a href="#4-index-ios-js" class="headerlink" title="4.index.ios.js"></a>4.index.ios.js</h3><blockquote><p>è¯¥æ–‡ä»¶ä½¿ç”¨è‡ªå®šä¹‰çš„ç»„ä»¶ ReactionsComponent</p></blockquote><p>å…·ä½“ä»£ç å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &#x27;react&#x27;;</span><br><span class="line">//å¼•å…¥è‡ªå®šä¹‰æ¨¡å—</span><br><span class="line">import ReactionsComponent from &#x27;./js/Mobx/Counter&#x27;</span><br><span class="line">import &#123;</span><br><span class="line">  AppRegistry</span><br><span class="line">&#125; from &#x27;react-native&#x27;;</span><br><span class="line">class RNMobxDemo extends Component &#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        return(</span><br><span class="line">            &lt;ReactionsComponent/&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">AppRegistry.registerComponent(&#x27;RNMobxDemo&#x27;, () =&gt; MZRNTutorial);</span><br></pre></td></tr></table></figure><p>Mobx æ”¯æŒã€Œæ³¨è§£ã€.</p><p>è¿™é‡Œçš„æ³¨è§£å°±æ˜¯ ES7 ä¸­çš„ decorators (è£…é¥°è€…æ¨¡å¼).</p><p>ä¸‹é¢ä»£ç æ˜¯ä½¿ç”¨æ³¨è§£çš„æ–¹å¼æ¥å£°æ˜, ä½†æ˜¯ä½ éœ€è¦å®‰è£…ç›¸å…³çš„æ’ä»¶(babel plugin)æ¥æ”¯æŒ.</p><p>å®‰è£…è¯¥æ’ä»¶å¾ˆç®€å•, åœ¨é¡¹ç›®æ ¹ç›®å½•æŒ‰ç…§ä¸‹é¢æ­¥éª¤å³å¯:</p><blockquote><p>Step 1: åˆ›å»º .babelrc æ–‡ä»¶</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch .babelrc</span><br></pre></td></tr></table></figure><blockquote><p>Step 2: ç¼–è¾‘ .babelrc æ–‡ä»¶</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> &#x27;presets&#x27;: [&#x27;react-native&#x27;],</span><br><span class="line"> &#x27;plugins&#x27;: [&#x27;transform-decorators-legacy&#x27;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Step 3: å®‰è£…æ’ä»¶</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i babel-plugin-transform-decorators-legacy babel-preset-react-native-stage-0 --save-dev</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ã€ŒCounter.jsã€, ä»£ç å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">&#x27;use strict&#x27;;</span><br><span class="line">import React, &#123; Component &#125; from &#x27;react&#x27;;</span><br><span class="line">import &#123;</span><br><span class="line">  StyleSheet,</span><br><span class="line">  View,</span><br><span class="line">  Text,</span><br><span class="line">  TouchableHighlight</span><br><span class="line">&#125; from &#x27;react-native&#x27;;</span><br><span class="line">import &#123; observer &#125; from &#x27;mobx-react/native&#x27;;</span><br><span class="line">import &#123; observable &#125; from &#x27;mobx&#x27;;</span><br><span class="line">// è¢«è§‚å¯Ÿè€…, è§‚å¯Ÿ counter å˜é‡  </span><br><span class="line">const storer = observable(&#123;</span><br><span class="line">    counter: 0</span><br><span class="line">&#125;);</span><br><span class="line">//---------------------------------</span><br><span class="line">//  ES6 å†™æ³•: Arrow Function</span><br><span class="line">//---------------------------------</span><br><span class="line">storer.plus =  () =&gt; &#123;</span><br><span class="line">    storer.counter ++;</span><br><span class="line">&#125;;</span><br><span class="line">storer.minus = () =&gt; &#123;</span><br><span class="line">    storer.counter --;</span><br><span class="line">&#125;;</span><br><span class="line">@observer //ä½¿ç”¨@æ–¹å¼æ¥å‰ç½®å£°æ˜</span><br><span class="line">class Counter extends Component &#123;</span><br><span class="line">    render () &#123;</span><br><span class="line">        return (</span><br><span class="line">          &lt;View style = &#123;styles.container&#125;&gt;</span><br><span class="line">            &#123;/*åŠ ä¸€*/&#125;</span><br><span class="line">            &lt;TouchableHighlight</span><br><span class="line">                onPress = &#123;() =&gt; &#123;this.props.store.plus()&#125;&#125;&gt;</span><br><span class="line">                &lt;Text&gt;Add&lt;/Text&gt;</span><br><span class="line">            &lt;/TouchableHighlight&gt;</span><br><span class="line">            &#123;/* æ˜¾ç¤ºå¤„ç†ç»“æœ */&#125;</span><br><span class="line">            &lt;Text style = &#123;styles.resultTxtStyle&#125;&gt;</span><br><span class="line">            &#123;this.props.store.counter&#125;</span><br><span class="line">            &lt;/Text&gt;</span><br><span class="line">            &#123;/*å‡ä¸€*/&#125;</span><br><span class="line">            &lt;TouchableHighlight </span><br><span class="line">                onPress = &#123;() =&gt; &#123;storer.minus()&#125;&#125;&gt;</span><br><span class="line">                &lt;Text&gt;Minus&lt;/Text&gt;</span><br><span class="line">            &lt;/TouchableHighlight&gt;</span><br><span class="line">          &lt;/View&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">export default class ReactionsComponent extends Component &#123;</span><br><span class="line">    render () &#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;View style = &#123;&#123;flex: 1, marginTop: 64&#125;&#125;&gt;</span><br><span class="line">            </span><br><span class="line">                &lt;Counter store = &#123;storer&#125; /&gt;</span><br><span class="line">            &lt;/View&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">/* æ ·å¼å®šä¹‰ */</span><br><span class="line">const styles = StyleSheet.create(&#123;</span><br><span class="line">    container: &#123;</span><br><span class="line">        flexDirection: &#x27;row&#x27;,</span><br><span class="line">        justifyContent: &#x27;space-around&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">    resultTxtStyle: &#123;</span><br><span class="line">        fontSize: 22, </span><br><span class="line">        color: &#x27;red&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä»ä¾‹å­å¯ä»¥çœ‹å‡º, storer ç›¸å½“äº state, å½“ state å‘ç”Ÿæ”¹å˜äº†, è§†å›¾ View ä¹Ÿè·Ÿç€å˜åŒ–.<br>ä¹Ÿå°±æ˜¯çŠ¶æ€é©±åŠ¨.</p><p>Android å¼€å‘çš„åŒå­¦åº”è¯¥çŸ¥é“ Adapter å’Œ notifyDatasetChanged çš„æœºåˆ¶, å½“æ•°æ®æºå‘ç”Ÿå˜åŒ–çš„æ—¶å€™, å¯ä»¥é€šçŸ¥è§†å›¾è¿›è¡Œåˆ·æ–°æ“ä½œ.</p><p>è¿™é‡Œçš„ Mobx ä¹Ÿå¯ä»¥è¿™ä¹ˆç®€å•çš„ç†è§£.</p><p>Mobx çš„å¼ºå¤§ä¹‹å¤„è¿˜æœ‰å¾ˆå¤š, éœ€è¦æ…¢æ…¢å­¦ä¹ å’ŒæŒ–æ˜.</p>]]></content>
      
      
      <categories>
          
          <category> ReactNative </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS Android ReactNative </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RN: 0.34 è¿è¡Œåœ¨ Android çš„é—®é¢˜</title>
      <link href="/2016/09/26/RN-0-34-%E8%BF%90%E8%A1%8C%E5%9C%A8-Android-%E7%9A%84%E9%97%AE%E9%A2%98/"/>
      <url>/2016/09/26/RN-0-34-%E8%BF%90%E8%A1%8C%E5%9C%A8-Android-%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©é—²æ¥æ— äº‹, æƒ³ä½¿ç”¨ RN å·¥ç¨‹åœ¨ Android è®¾å¤‡ä¸Šé¢è·‘è·‘.</p><p>æƒ³çœ‹çœ‹è¿è¡Œæ•ˆæœæ€ä¹ˆæ ·?!</p><h2 id="é€‚åˆè¯»è€…"><a href="#é€‚åˆè¯»è€…" class="headerlink" title="é€‚åˆè¯»è€…"></a>é€‚åˆè¯»è€…</h2><ul><li>æœ‰ Android å¼€å‘åŸºç¡€.</li><li>ä¼šä½¿ç”¨ Android Studio.</li><li>åˆçº§ React Native çš„å¼€å‘è€….</li></ul><h2 id="å¼€å‘ç¯å¢ƒå’Œå·¥å…·"><a href="#å¼€å‘ç¯å¢ƒå’Œå·¥å…·" class="headerlink" title="å¼€å‘ç¯å¢ƒå’Œå·¥å…·"></a>å¼€å‘ç¯å¢ƒå’Œå·¥å…·</h2><ul><li>Android Studio 2.2</li><li>ReactNative 0.34</li><li>Android æ¨¡æ‹Ÿå™¨</li><li>Mac æ“ä½œç³»ç»Ÿ</li></ul><h2 id="é¢„æœŸæ•ˆæœ"><a href="#é¢„æœŸæ•ˆæœ" class="headerlink" title="é¢„æœŸæ•ˆæœ"></a>é¢„æœŸæ•ˆæœ</h2><p>ä¸å‡ºæ‰€æ–™, çœŸçš„ä¸èƒ½ä¸€å¸†é£é¡ºçš„ Run.</p><p>åœ¨æˆ‘çš„åšå®¢ ReactNative: ä¸ä¸€æ ·çš„ HelloWorld ä¸­å±•ç¤ºäº† RN åœ¨ iOS ä¸Šé¢çš„è¿è¡Œæƒ…å†µ.</p><p>ä»Šå¤©è¿˜æ˜¯è¿™ä¸ªä¾‹å­, éƒ¨ç½²å’Œè¿è¡Œåˆ° Android ä¸Šé¢.</p><p>æ•ˆæœå¦‚ä¸‹:<br><img src="/upload/images/2016/9/26/rn_and_eff_01.png" alt="1"></p><p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­, é‡åˆ°å‡ ä¸ªé—®é¢˜.</p><p>ç‰¹æ­¤è®°å½•.</p><h2 id="é—®é¢˜æè¿°å’Œè§£å†³"><a href="#é—®é¢˜æè¿°å’Œè§£å†³" class="headerlink" title="é—®é¢˜æè¿°å’Œè§£å†³"></a>é—®é¢˜æè¿°å’Œè§£å†³</h2><h3 id="é—®é¢˜1-ç›´æ¥è¿è¡Œ-crash"><a href="#é—®é¢˜1-ç›´æ¥è¿è¡Œ-crash" class="headerlink" title="é—®é¢˜1: ç›´æ¥è¿è¡Œ crash"></a>é—®é¢˜1: ç›´æ¥è¿è¡Œ crash</h3><p>log æè¿°(éƒ¨åˆ†)</p><blockquote><p>E&#x2F;AndroidRuntime: FATAL EXCEPTION: main<br>Process: com.mzrntutorial, PID: 5849<br>java.lang.RuntimeException:<br>Unable to start activity ComponentInfo{com.mzrntutorial&#x2F;com.mzrntutorial.MainActivity}: java.lang.ClassCastException: android.app.Application cannot be cast to com.facebook.react.ReactApplication<br>at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2416)<br>at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2476)     </p></blockquote><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ:"></a>è§£å†³æ–¹æ¡ˆ:</h3><p>Manifest.xml é…ç½® Application åç§°</p><p>android:name&#x3D;â€.MainApplicationâ€</p><h3 id="é—®é¢˜2"><a href="#é—®é¢˜2" class="headerlink" title="é—®é¢˜2:"></a>é—®é¢˜2:</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">could not get batchedbridge make sure your bundle is packaged correctly</span><br></pre></td></tr></table></figure><p>è§£å†³é—®é¢˜1å, å†æ¬¡è¿è¡Œ, ä¼šæŠ¥é—®é¢˜2.<br>è¯¥é—®é¢˜æ˜¯å› ä¸ºæ²¡æœ‰å¯åŠ¨æœ¬åœ°çš„ server.</p><p>ä½¿ç”¨ Xcode å¯ä»¥è‡ªåŠ¨è¿è¡Œæœ¬åœ° server.<br>å¯ä»¥å‚è€ƒåšå®¢ React Native å¦‚ä½•å¯åŠ¨ local server</p><h3 id="è§£å†³æ–¹æ¡ˆ-1"><a href="#è§£å†³æ–¹æ¡ˆ-1" class="headerlink" title="è§£å†³æ–¹æ¡ˆ:"></a>è§£å†³æ–¹æ¡ˆ:</h3><p>æ‰‹åŠ¨å¯åŠ¨ server.</p><p>cd é¡¹ç›®æ ¹ç›®å½•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native start</span><br></pre></td></tr></table></figure><h3 id="é—®é¢˜3"><a href="#é—®é¢˜3" class="headerlink" title="é—®é¢˜3:"></a>é—®é¢˜3:</h3><blockquote><p>æ¨¡æ‹Ÿå™¨æ²¡æœ‰ menu æŒ‰é”®, æ— æ³• Reload</p></blockquote><p>è¿™ä¸ªå…¶å®ä¸æ˜¯ä»€ä¹ˆå¤§é—®é¢˜, ä½†æ˜¯å¯¹äºåˆå­¦è€…, ä¹Ÿç®—æ˜¯ä¸€ä¸ªé—®é¢˜.</p><p>æ–°ç‰ˆçš„ Android SDK åˆ›å»ºçš„æ¨¡æ‹Ÿå™¨æ²¡æœ‰ menu æŒ‰é”®äº†</p><h3 id="è§£å†³æ–¹æ¡ˆ-2"><a href="#è§£å†³æ–¹æ¡ˆ-2" class="headerlink" title="è§£å†³æ–¹æ¡ˆ:"></a>è§£å†³æ–¹æ¡ˆ:</h3><p>è¿ç»­æŒ‰ä¸¤æ¬¡å­—æ¯ r å³å¯åˆ·æ–°.</p><p>è¿™äº›é—®é¢˜, FB åé¢è‚¯å®šä¼šè§£å†³çš„.<br>é˜¿é—¨!</p><h2 id="é™„å½•-ä»£ç "><a href="#é™„å½•-ä»£ç " class="headerlink" title="é™„å½•(ä»£ç )"></a>é™„å½•(ä»£ç )</h2><p>index.ios.js</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &#x27;react&#x27;;</span><br><span class="line">import &#123;getPlatformString, isIOS&#125; from &#x27;./js/Generals/Utils/IDSRNPlatformUtil&#x27;;</span><br><span class="line">import MZButton from &#x27;./js/ReactUIKit/MZButton&#x27;</span><br><span class="line">import &#123;</span><br><span class="line">  AppRegistry,</span><br><span class="line">  StyleSheet,</span><br><span class="line">  Text,</span><br><span class="line">  View,</span><br><span class="line">  Platform,</span><br><span class="line">  TouchableOpacity,</span><br><span class="line">  TouchableHighlight</span><br><span class="line">&#125; from &#x27;react-native&#x27;;</span><br><span class="line">// è°ƒç”¨å…¶ä»–æ¨¡å—æ–¹æ³•</span><br><span class="line">var os = getPlatformString();</span><br><span class="line">var iosPlatform = isIOS();//when run on &#x27;ios&#x27; true</span><br><span class="line">class MZRNTutorial extends Component &#123;</span><br><span class="line">  constructor(props)</span><br><span class="line">  &#123;</span><br><span class="line">      super(props);</span><br><span class="line">      this.state = &#123;status:1&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  customPressHandler = () =&gt; &#123;</span><br><span class="line">      alert(&#x27;å½“å‰çŠ¶æ€: &#x27; + this.state.status);</span><br><span class="line">      this.state.status = 2;</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    console.log(&#x27;render ...&#x27;);</span><br><span class="line">    return (</span><br><span class="line">      &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class="line">        &lt;Text style=&#123;styles.welcome&#125;&gt;</span><br><span class="line">          Near use React Native!</span><br><span class="line">        &lt;/Text&gt;</span><br><span class="line">        &lt;Text style=&#123;styles.instructions&#125;&gt;</span><br><span class="line">          To get started, edit index.android.js</span><br><span class="line">        &lt;/Text&gt;</span><br><span class="line">        &lt;Text style=&#123;styles.instructions&#125;&gt;</span><br><span class="line">          Press &#x27;R&#x27; twice to reload,&#123;&#x27;\n&#x27;&#125;</span><br><span class="line">          or shake for dev menu</span><br><span class="line">        &lt;/Text&gt;</span><br><span class="line">        &#123;/* æ˜¾ç¤ºå½“å‰å¹³å°ä¿¡æ¯*/&#125;</span><br><span class="line">        &lt;Text style=&#123;styles.welcome&#125;&gt;</span><br><span class="line">            current os: &#123;Platform.OS&#125;</span><br><span class="line">        &lt;/Text&gt;</span><br><span class="line">        &#123;/*</span><br><span class="line">        &lt;TouchableOpacity</span><br><span class="line">            style=&#123;styles.button&#125;</span><br><span class="line">            onPress=&#123;this.customPressHandler&#125;</span><br><span class="line">            &gt;</span><br><span class="line">            &lt;Text style=&#123;styles.buttonText&#125;&gt;ç¡®å®š&lt;/Text&gt;</span><br><span class="line">        &lt;/TouchableOpacity&gt;</span><br><span class="line">        */&#125;</span><br><span class="line">        &lt;MZButton text=&quot;ç¡®å®š?&quot; bgColor=&quot;green&quot; dianjishijian=&#123;()=&gt;&#123;alert(&#x27;å±…ç„¶ç‚¹å‡»ç¡®å®š?!&#x27;)&#125;&#125;&gt;</span><br><span class="line">        &lt;/MZButton&gt;</span><br><span class="line">      &lt;/View&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">const styles = StyleSheet.create(&#123;</span><br><span class="line">  button: &#123;</span><br><span class="line">    height: 40,</span><br><span class="line">    width: 150,</span><br><span class="line">    borderRadius: 20,</span><br><span class="line">    justifyContent: &#x27;center&#x27;,</span><br><span class="line">    backgroundColor: &#x27;green&#x27;,</span><br><span class="line">    overflow: &#x27;hidden&#x27;</span><br><span class="line">  &#125;,</span><br><span class="line">  buttonText: &#123;</span><br><span class="line">    textAlign: &#x27;center&#x27;,</span><br><span class="line">    color: &#x27;white&#x27;</span><br><span class="line">  &#125;,</span><br><span class="line">  container: &#123;</span><br><span class="line">    flex: 1,</span><br><span class="line">    justifyContent: &#x27;center&#x27;,</span><br><span class="line">    alignItems: &#x27;center&#x27;,</span><br><span class="line">    backgroundColor: &#x27;#F5FCFF&#x27;,</span><br><span class="line">  &#125;,</span><br><span class="line">  welcome: &#123;</span><br><span class="line">    fontSize: 20,</span><br><span class="line">    textAlign: &#x27;center&#x27;,</span><br><span class="line">    margin: 10,</span><br><span class="line">  &#125;,</span><br><span class="line">  instructions: &#123;</span><br><span class="line">    textAlign: &#x27;center&#x27;,</span><br><span class="line">    color: &#x27;#333333&#x27;,</span><br><span class="line">    marginBottom: 5,</span><br><span class="line">  &#125;,</span><br><span class="line">  flowRight: &#123;</span><br><span class="line">   flexDirection: &#x27;row&#x27;,</span><br><span class="line">   alignItems: &#x27;center&#x27;,</span><br><span class="line">   alignSelf: &#x27;stretch&#x27;</span><br><span class="line"> &#125;,</span><br><span class="line">&#125;);</span><br><span class="line">AppRegistry.registerComponent(&#x27;MZRNTutorial&#x27;, () =&gt; MZRNTutorial);</span><br></pre></td></tr></table></figure><p>MZButton.js</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &#x27;react&#x27;;</span><br><span class="line">import &#123;</span><br><span class="line">  StyleSheet,</span><br><span class="line">  Text,</span><br><span class="line">  View,</span><br><span class="line">  Platform,</span><br><span class="line">  TouchableOpacity</span><br><span class="line">&#125; from &#x27;react-native&#x27;;</span><br><span class="line">//-----------------------------------------------------</span><br><span class="line">//å¤–éƒ¨ä½¿ç”¨è¯¥æ¨¡å—, ES6éœ€è¦ä½¿ç”¨å…³é”®å­— export default</span><br><span class="line">//-----------------------------------------------------</span><br><span class="line">export default class MZButton extends Component</span><br><span class="line">&#123;</span><br><span class="line">    constructor(props)</span><br><span class="line">    &#123;</span><br><span class="line">        super(props);</span><br><span class="line">        this.state = &#123;status:1&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    costumPressHandler = () =&gt; &#123;</span><br><span class="line">        alert(&#x27;å½“å‰çŠ¶æ€:&#x27; + this.state.status);</span><br><span class="line">        const &#123;dianjishijian&#125; = this.props;</span><br><span class="line">        dianjishijian();</span><br><span class="line">    &#125;;</span><br><span class="line">    // ä½¿ç”¨å±æ€§å€¼è®¾ç½®èƒŒæ™¯é¢œè‰²</span><br><span class="line">    // style=&#123;[styles.button], &#123;backgroundColor:this.props.beijingyanse&#125;&#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        //è§£æ„</span><br><span class="line">        const &#123;text, bgColor&#125; = this.props;</span><br><span class="line">        return (</span><br><span class="line">            &lt;TouchableOpacity</span><br><span class="line">                style=&#123;[styles.button], &#123;backgroundColor:bgColor&#125;&#125;</span><br><span class="line">                onPress = &#123;this.costumPressHandler&#125;</span><br><span class="line">                &gt;</span><br><span class="line">                &lt;Text style=&#123;styles.buttonText&#125;&gt;</span><br><span class="line">                    &#123;/* ä½¿ç”¨å±æ€§å€¼ */&#125;</span><br><span class="line">                    &#123;this.props.text&#125;</span><br><span class="line">                &lt;/Text&gt;</span><br><span class="line">            &lt;/TouchableOpacity&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">const styles = StyleSheet.create(&#123;</span><br><span class="line">    button: &#123;</span><br><span class="line">      height: 40,</span><br><span class="line">      width: 150,</span><br><span class="line">      borderRadius: 20,</span><br><span class="line">      justifyContent: &#x27;center&#x27;,</span><br><span class="line">      backgroundColor: &#x27;green&#x27;,</span><br><span class="line">      overflow: &#x27;hidden&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">    buttonText: &#123;</span><br><span class="line">      textAlign: &#x27;center&#x27;,</span><br><span class="line">      color: &#x27;white&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>IDSRNPlatformUtil.js</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &#x27;react&#x27;;</span><br><span class="line">import &#123;</span><br><span class="line">    Platform</span><br><span class="line">&#125; from &#x27;react-native&#x27;;</span><br><span class="line">export function getPlatformString()</span><br><span class="line">&#123;</span><br><span class="line">    console.log(Platform.OS);</span><br><span class="line">    </span><br><span class="line">    return Platform.OS;</span><br><span class="line">&#125;</span><br><span class="line">export function isIOS()</span><br><span class="line">&#123;</span><br><span class="line">    return Platform.OS === &#x27;ios&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">export function isAndroid()</span><br><span class="line">&#123;</span><br><span class="line">    return Platform.OS == &#x27;android&#x27;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ReactNative </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android ReactNative </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS é¡¹ç›®: æ‰“é€ æœ¬åœ° pod åº“</title>
      <link href="/2016/09/25/iOS-%E9%A1%B9%E7%9B%AE-%E6%89%93%E9%80%A0%E6%9C%AC%E5%9C%B0-pod-%E5%BA%93/"/>
      <url>/2016/09/25/iOS-%E9%A1%B9%E7%9B%AE-%E6%89%93%E9%80%A0%E6%9C%AC%E5%9C%B0-pod-%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç¯‡çš„å§Šå¦¹ç¯‡ <a href="http://www.veryitman.com/2016/11/01/Cocoapods-%E7%AE%A1%E7%90%86%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/">Cocoapods ç®¡ç†å¼€æºé¡¹ç›®</a> å·²å‡†å¤‡å®Œæ¯•ï¼Œç›´æˆ³ <a href="http://www.veryitman.com/2016/11/01/Cocoapods-%E7%AE%A1%E7%90%86%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/">é“¾æ¥</a> å³å¯è¾¾åˆ°ã€‚</p><h2 id="Cocoapods-ç®¡ç†ä»£ç çš„å¿…è¦æ€§"><a href="#Cocoapods-ç®¡ç†ä»£ç çš„å¿…è¦æ€§" class="headerlink" title="Cocoapods ç®¡ç†ä»£ç çš„å¿…è¦æ€§"></a>Cocoapods ç®¡ç†ä»£ç çš„å¿…è¦æ€§</h2><p>é¡¹ç›®åˆ°äº†ä¸€å®šè§„æ¨¡, ä»£ç ç»„ç»‡å’Œç»“æ„æ˜¾å¾—å°¤ä¸ºé‡è¦.</p><p>é‡æ„é¡¹ç›®ç»“æ„ï¼Œå¯ä»¥ä»åˆ†ç¦»ä»£ç å¼€å§‹ï¼Œä»£ç åˆ†ç¦»ï¼Œå¯ä»¥æŠŠå¸¸ç”¨ç¨³å®šçš„ç»„ä»¶å°è£…æŠ½ç¦»å‡ºæ¥.</p><p>åˆ†ç¦»ä»£ç , å¸¸ç”¨çš„æœ‰å‡ ç§æ–¹å¼:</p><blockquote><ol><li>æ”¾åˆ°ä¸åŒçš„æ–‡ä»¶å¤¹, ç®¡ç†å’Œç»„ç»‡ä»£ç .</li><li>ä½¿ç”¨ framework çš„æ–¹å¼, æä¾›ç»™é¡¹ç›®ä½¿ç”¨.</li><li>å·¥å…·ç®¡ç†å¦‚ Cocoapods.</li></ol></blockquote><p>è¿™å‡ ç§æ–¹å¼, å„æœ‰æ‰€é•¿, å„æœ‰ä¼˜åŠ£, æ— æ‰€è°“å¥½ä¸å, æ ¹æ®è‡ªå·±çš„é¡¹ç›®ç‰¹ç‚¹æ¥ç»„ç»‡å³å¯.</p><p>æˆ‘çš„åšæ³•æ˜¯ä½¿ç”¨ cocoapods æ¥ç®¡ç†.</p><p>ä¸‹é¢è¿›å…¥ä»Šå¤©çš„ä¸»é¢˜:</p><blockquote><p>ä½¿ç”¨ cocoapods ç®¡ç†è‡ªå·±çš„æœ¬åœ°ä»£ç .</p></blockquote><p>åšå®¢ <a href="http://blog.csdn.net/veryitman/article/details/50769069">Mac OSX 10.11.1+ å®‰è£… Cocoapods</a><br>ä»‹ç»äº†å¦‚ä½•åœ¨æœ€æ–°ç‰ˆ MacOS ä¸­å®‰è£… Cocoapods ä»¥åŠæ³¨æ„äº‹é¡¹, å¹¶ä¸”ä½œè€…ä¿è¯æŒç»­ã€Œæ›´æ–°, æ›´æ­£ã€å†…å®¹.</p><h2 id="åˆ›å»ºå·¥ç¨‹"><a href="#åˆ›å»ºå·¥ç¨‹" class="headerlink" title="åˆ›å»ºå·¥ç¨‹"></a>åˆ›å»ºå·¥ç¨‹</h2><p>ä½¿ç”¨ Xcode åˆ›å»ºä¸€ä¸ªå·¥ç¨‹, å·¥ç¨‹åå°±èµ·ä¸º <code>TestPods</code> å§.</p><blockquote><p>å·¥ç¨‹ç›®å½•å¯ä»¥é˜²æ­¢åœ¨æ¡Œé¢æˆ–è€…ä½ å–œæ¬¢çš„ç›®å½•ä¸‹é¢éƒ½å¯ä»¥.</p></blockquote><p>åœ¨ TestPods ä¸‹é¢åˆ›å»º LocalLib ç›®å½•, ç”¨æ¥æ”¾ç½®åˆ†ç¦»çš„ä»£ç .å½“ç„¶, ä½ ä¹Ÿå¯ä»¥å°† LocalLib è¿™ä¸ªç›®å½•æ”¾åˆ°å…¶ä»–ç›®å½•.</p><p>åœ¨ LocalLib ä¸‹é¢, æˆ‘çš„ pod åº“ä»£ç åç§°ä¸º download.</p><p>å¯ä»¥æ–°å»ºè¿™ä¸ªç›®å½•.</p><p>ç›®å½•å¦‚ä¸‹:<br><img src="/upload/images/2016/9/25/pod_lib_dir.png" alt="1"></p><h2 id="åˆ›å»º-podspec-æ–‡ä»¶"><a href="#åˆ›å»º-podspec-æ–‡ä»¶" class="headerlink" title="åˆ›å»º podspec æ–‡ä»¶"></a>åˆ›å»º podspec æ–‡ä»¶</h2><p>åœ¨ download ç›®å½•ä¸‹é¢, åˆ›å»º podspec æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod spec create download</span><br></pre></td></tr></table></figure><p>åˆ›å»ºå®Œæˆå, ä¼šç”Ÿæˆ download.podspec æ–‡ä»¶.</p><p>å…·ä½“å†…å®¹, åˆ›å»ºå, å¤§å®¶å¯ä»¥è‡ªè¡ŒæŸ¥çœ‹.</p><h2 id="ä¿®æ”¹-podspec-æ–‡ä»¶"><a href="#ä¿®æ”¹-podspec-æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹ podspec æ–‡ä»¶"></a>ä¿®æ”¹ podspec æ–‡ä»¶</h2><p>ä¿®æ”¹ download.podspec, ä¸»è¦ä¿®æ”¹å‡ ä¸ªå…³é”®åœ°æ–¹:</p><blockquote><p>æºç ä½ç½®<br>æºç ç‰ˆæœ¬</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">â€•â€•â€• Source Location â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•#</span><br><span class="line">  #</span><br><span class="line">  #  Specify the location from where the source should be retrieved.</span><br><span class="line">  #  Supports git, hg, bzr, svn and HTTP.</span><br><span class="line">  #</span><br><span class="line">  s.source       = &#123; :git =&gt; &quot;&quot;, :tag =&gt; &quot;0.0.1&quot; &#125;</span><br><span class="line">  # â€•â€•â€• Source Code â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•#</span><br><span class="line">  #</span><br><span class="line">  #  CocoaPods is smart about how it includes source code. For source files</span><br><span class="line">  #  giving a folder will include any swift, h, m, mm, c &amp; cpp files.</span><br><span class="line">  #  For header files it will include any header in the folder.</span><br><span class="line">  #  Not including the public_header_files will make all headers public.</span><br><span class="line">  #</span><br><span class="line">  s.source_files  = &quot;Source&quot;, &quot;Source/**/*.&#123;h,m&#125;&quot;</span><br><span class="line">  s.exclude_files = &quot;Source/Exclude&quot;</span><br></pre></td></tr></table></figure><p>å¦å¤–, é…ç½®å¥½ç›¸å…³æè¿°ä¿¡æ¯, ä¸è¦åŒ…å« â€˜Exampleâ€™ çš„å­—æ ·, ä¸ç„¶, æ–°ç‰ˆçš„ Cocoapods æ‰§è¡Œ pod install æ—¶å€™, ä¼šæŠ¥å‡ºè­¦å‘Šå’Œé”™è¯¯.</p><p>è¿™æ ·, å·¥ç¨‹å¯ä»¥ä½¿ç”¨ pods åº“äº†.</p><h2 id="å·¥ç¨‹ä½¿ç”¨-pod-åº“"><a href="#å·¥ç¨‹ä½¿ç”¨-pod-åº“" class="headerlink" title="å·¥ç¨‹ä½¿ç”¨ pod åº“"></a>å·¥ç¨‹ä½¿ç”¨ pod åº“</h2><p>å°† TestPods æ”¹ä¸º cocoapods é¡¹ç›®.</p><p>åœ¨ TestPods ç›®å½•, æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod init</span><br></pre></td></tr></table></figure><p>ä¼šç”Ÿæˆ Podfile ç­‰æ–‡ä»¶.</p><p>ä¿®æ”¹ Podfile æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># Uncomment this line to define a global platform for your project</span><br><span class="line"># platform :ios, &#x27;7.0&#x27;</span><br><span class="line"># Uncomment this line if you&#x27;re using Swift</span><br><span class="line"># use_frameworks!</span><br><span class="line">target &#x27;TestPods&#x27; do</span><br><span class="line">pod &#x27;download&#x27;, :path =&gt; &#x27;./LocalLib/download/&#x27;</span><br><span class="line">#pod &#x27;core_lib_spec&#x27;, :svn =&gt; &#x27;http://svn.ids111.com/o2o/client/ios/trunks/master/Frameworks/CoreLibrary&#x27;</span><br><span class="line">end</span><br><span class="line">target &#x27;TestPodsTests&#x27; do</span><br><span class="line">end</span><br><span class="line">target &#x27;TestPodsUITests&#x27; do</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p>å…³é”®æ˜¯æŒ‡æ˜ pod åº“çš„ä½ç½®.<br>è·¯å¾„ä¸€å®šè¦æ­£ç¡®.å¦åˆ™æ— æ³•æ‰¾åˆ°è¯¥åº“.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod &#x27;download&#x27;, :path =&gt; &#x27;./LocalLib/download/&#x27;</span><br></pre></td></tr></table></figure><p>åœ¨ TestPods ä¸‹é¢, pod install å³å¯.</p><p>å¦‚æœ, pod install æŠ¥é”™, ä¸€èˆ¬éƒ½æ˜¯ä½ çš„ pod åº“çš„é…ç½®æ–‡ä»¶(.podspec)é‡Œé¢å†™çš„ä¸ç¬¦åˆè¦æ±‚.</p><p>æ ¹æ®æŠ¥é”™ä¿¡æ¯, åŠ ä»¥ä¿®æ”¹å³å¯.</p><p>xcode æ‰“å¼€å·¥ç¨‹.<br><img src="/upload/images/2016/9/25/pod_lib_pro.png" alt="1"></p><h2 id="ç¤ºä¾‹ä¸‹è½½"><a href="#ç¤ºä¾‹ä¸‹è½½" class="headerlink" title="ç¤ºä¾‹ä¸‹è½½"></a>ç¤ºä¾‹ä¸‹è½½</h2><p>å·¥ç¨‹ç¤ºä¾‹ä»£ç , å¯ä»¥ <a href="http://download.csdn.net/download/androidbluetooth/9520262">æˆ³è¿™é‡Œä¸‹è½½</a> ç©è€!</p><hr><p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p><p><img src="/upload/me/qrcode_wx.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS Cocoapods </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RN: å¦‚ä½•å¯åŠ¨ local server</title>
      <link href="/2016/09/22/RN-%E5%A6%82%E4%BD%95%E5%90%AF%E5%8A%A8-local-server/"/>
      <url>/2016/09/22/RN-%E5%A6%82%E4%BD%95%E5%90%AF%E5%8A%A8-local-server/</url>
      
        <content type="html"><![CDATA[<p>ä½¿ç”¨ <code>react-native init</code> åˆ›å»ºçš„å·¥ç¨‹, åœ¨ xcode ä¸­è¿è¡Œä¼šè‡ªåŠ¨å¯åŠ¨ä¸€ä¸ª RN çš„æœ¬åœ° Server.</p><p>åƒä¸‹é¢å›¾ç‰‡å±•ç¤ºè¿™æ ·:<br><img src="/upload/images/2016/9/22/rn_1.png" alt="1"></p><p>é‚£ä¹ˆ, è¿™é‡Œé—®é¢˜æ¥äº†.</p><p>æ¯”å¦‚, æˆ‘æƒ³æš‚æ—¶ä¸å¯åŠ¨è¿™ä¸ªæœ¬åœ° Server, é‚£ä¹ˆå¦‚ä½•å…³é—­å‘¢?</p><p>ä¸‹é¢è·Ÿå¤§å®¶ä¸€èµ·æ¢è®¨å’Œè¿½ç©¶ä¸€ä¸‹.</p><h2 id="æ‰¾åˆ°å¯åŠ¨çš„æ ¹æº"><a href="#æ‰¾åˆ°å¯åŠ¨çš„æ ¹æº" class="headerlink" title="æ‰¾åˆ°å¯åŠ¨çš„æ ¹æº"></a>æ‰¾åˆ°å¯åŠ¨çš„æ ¹æº</h2><p>å¯åŠ¨è¿™ä¸ªç»ˆç«¯çš„æ˜¯åœ¨ä¸€ä¸ª React.xcodeproj å·¥ç¨‹çš„ ã€ŒBuild Phasesã€ä¸­è„šæœ¬é‡Œé¢é…ç½®çš„.</p><p>è„šæœ¬å†…å®¹å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if nc -w 5 -z localhost 8081 ; then</span><br><span class="line">  if ! curl -s &quot;http://localhost:8081/status&quot; | grep -q &quot;packager-status:running&quot; ; then</span><br><span class="line">    echo &quot;Port 8081 already in use, packager is either not running or not running correctly&quot;</span><br><span class="line">    exit 2</span><br><span class="line">  fi</span><br><span class="line">else</span><br><span class="line">  open &quot;$SRCROOT/../packager/launchPackager.command&quot; || echo &quot;Can&#x27;t start packager automatically&quot;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p>çœŸæ­£èµ·ä½œç”¨çš„æ˜¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open &quot;$SRCROOT/../packager/launchPackager.command&quot;</span><br></pre></td></tr></table></figure><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å…³é—­è¿™ä¸ªè‡ªå¯åŠ¨äº†, ç¤ºä¾‹ä»£ç å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">if nc -w 5 -z localhost 8081 ; then</span><br><span class="line">  if ! curl -s &quot;http://localhost:8081/status&quot; | grep -q &quot;packager-status:running&quot; ; then</span><br><span class="line">    echo &quot;Port 8081 already in use, packager is either not running or not running correctly&quot;</span><br><span class="line">    exit 2</span><br><span class="line">  fi</span><br><span class="line">else</span><br><span class="line">#open &quot;$SRCROOT/../packager/launchPackager.command&quot; || echo &quot;Can&#x27;t start packager automatically&quot;</span><br><span class="line">    echo &quot;Nothing...&quot;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><h2 id="çœ‹çœ‹-launchPackager-command"><a href="#çœ‹çœ‹-launchPackager-command" class="headerlink" title="çœ‹çœ‹ launchPackager.command"></a>çœ‹çœ‹ launchPackager.command</h2><p>è¿™ä¸ªæ–‡ä»¶åœ¨ã€Œnode_modules&#x2F;react-native&#x2F;packager&#x2F;ã€ä¸‹é¢.</p><p>è¯¥æ–‡ä»¶æ˜¯å¯åŠ¨å¦å¤–ä¸€ä¸ªè„šæœ¬ packager.sh, æ ¸å¿ƒä»£ç :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ./packager.sh</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆæ‰§è¡Œ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node &quot;$THIS_DIR/../local-cli/cli.js&quot; start &quot;$@&quot;</span><br></pre></td></tr></table></figure><p>å¤§å®¶æœ‰å…´è¶£å¯ä»¥å»çœ‹çœ‹æºç , ä¸€æ¢ç©¶ç«Ÿ.</p>]]></content>
      
      
      <categories>
          
          <category> ReactNative </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ReactNative iOS Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RN: åˆ›å»ºiOSå·¥ç¨‹ä»£ç çš„indenté—®é¢˜</title>
      <link href="/2016/09/19/RN-%E5%88%9B%E5%BB%BAiOS%E5%B7%A5%E7%A8%8B%E4%BB%A3%E7%A0%81%E7%9A%84indent%E9%97%AE%E9%A2%98/"/>
      <url>/2016/09/19/RN-%E5%88%9B%E5%BB%BAiOS%E5%B7%A5%E7%A8%8B%E4%BB%A3%E7%A0%81%E7%9A%84indent%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h2 id="èµ·å› "><a href="#èµ·å› " class="headerlink" title="èµ·å› "></a>èµ·å› </h2><p>ä½¿ç”¨æœ€æ–°ç‰ˆRN(0.33)æ¥åˆ›å»ºå·¥ç¨‹, å¤§å®¶å¯ä»¥å‘ç°, OC ä»£ç çš„é€€æ ¼å˜æˆäº†ä¸¤ä¸ªç©ºæ ¼.<br>å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions</span><br><span class="line">&#123;</span><br><span class="line">  NSURL *jsCodeLocation;</span><br><span class="line">  jsCodeLocation = [[RCTBundleURLProvider sharedSettings] jsBundleURLForBundleRoot:@&quot;index.ios&quot; fallbackResource:nil];</span><br><span class="line">  RCTRootView *rootView = [[RCTRootView alloc] initWithBundleURL:jsCodeLocation</span><br><span class="line">                                                      moduleName:@&quot;Mark&quot;</span><br><span class="line">                                               initialProperties:nil</span><br><span class="line">                                                   launchOptions:launchOptions];</span><br><span class="line">  rootView.backgroundColor = [[UIColor alloc] initWithRed:1.0f green:1.0f blue:1.0f alpha:1];</span><br><span class="line">  self.window = [[UIWindow alloc] initWithFrame:[UIScreen mainScreen].bounds];</span><br><span class="line">  UIViewController *rootViewController = [UIViewController new];</span><br><span class="line">  rootViewController.view = rootView;</span><br><span class="line">  self.window.rootViewController = rootViewController;</span><br><span class="line">  [self.window makeKeyAndVisible];</span><br><span class="line">  return YES;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ— è®ºä½ å›è½¦æˆ–è€… tab æˆ–è€…æ ¼å¼åŒ–(<code>å³é”®/Structure/Re-Indent</code>)ä»£ç , ä¼šå‘ç°, éƒ½æ˜¯è¿™ç§è°ƒè°ƒ.</p><p>é¢å¯¹è¿™çªå¦‚å…¶æ¥çš„å˜åŒ–, æˆ‘å¼€å§‹è§‰å¾—æœ‰ç‚¹æ·¡æ·¡çš„å¿§ä¼¤.</p><p>å¯¹äºä¸€ç›´ä½¿ç”¨ <code>tab width = 4</code> çš„æˆ‘æ¥è¯´, æ— æ³•å¿å—. å¿…é¡»æ”¹è¿‡æ¥.</p><h2 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h2><p>æ‰“å¼€ Xcode çš„ preferences, çœ‹åˆ°å…¶ã€è®¾ç½®ã€æ­£å¸¸çš„ä¸è¦ä¸è¦çš„.</p><p>æ‰€ä»¥å¯ä»¥æ–­å®šä¸æ˜¯ Xcode çš„é—®é¢˜.</p><p><img src="/upload/images/2016/9/19/xcode_pref.png" alt="1"></p><p>å› ä¸ºå‡çº§äº† Xcode åˆ°æœ€æ–°ç‰ˆ Xcode8, è¿˜ä»¥ä¸ºæ˜¯ Xcode8 çš„ bug, æ‰“å¼€ä¹‹å‰çš„ React Native å·¥ç¨‹æˆ–è€…å…¶ä»– Xcode å·¥ç¨‹, å°±æ²¡æœ‰è¿™ä¸ªã€Œè›‹ç–¼ã€çš„é—®é¢˜.</p><p>æœ€ç»ˆçŒœæƒ³æ˜¯å·¥ç¨‹é…ç½®æ–‡ä»¶å¼•èµ·çš„â€¦</p><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>æ—¢ç„¶å’Œ Xcode æ²¡æœ‰å…³ç³», é‚£ä¹ˆé—®é¢˜å°±ä¸€å®šå‡ºç°åœ¨é…ç½®æ–‡ä»¶ä¸Šé¢.</p><p>ç½ªé­ç¥¸é¦– <code>project.pbxproj</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">indentWidth = 2;</span><br><span class="line">sourceTree = &quot;&lt;group&gt;&quot;;</span><br><span class="line">tabWidth = 2;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸º:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">indentWidth = 4;</span><br><span class="line">sourceTree = &quot;&lt;group&gt;&quot;;</span><br><span class="line">tabWidth = 4;</span><br></pre></td></tr></table></figure><p>æˆ–è€…ç›´æ¥åˆ é™¤:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">indentWidth = 2;</span><br><span class="line">tabWidth = 2;</span><br></pre></td></tr></table></figure><p>å…³é—­å·¥ç¨‹, é‡å¯ Xcode å°±å¯ä»¥äº†.</p>]]></content>
      
      
      <categories>
          
          <category> ReactNative </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ReactNative iOS Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RN: Mac é…ç½® ES6 ç®€æ˜“å¼€å‘ç¯å¢ƒ</title>
      <link href="/2016/09/16/RN-Mac-%E9%85%8D%E7%BD%AE-ES6-%E7%AE%80%E6%98%93%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/"/>
      <url>/2016/09/16/RN-Mac-%E9%85%8D%E7%BD%AE-ES6-%E7%AE%80%E6%98%93%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/</url>
      
        <content type="html"><![CDATA[<h2 id="åˆ›å»ºæ–‡ä»¶å¤¹-ES6"><a href="#åˆ›å»ºæ–‡ä»¶å¤¹-ES6" class="headerlink" title="åˆ›å»ºæ–‡ä»¶å¤¹ ES6"></a>åˆ›å»ºæ–‡ä»¶å¤¹ ES6</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ES6</span><br><span class="line">-lib</span><br><span class="line">-src</span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥ä»»æ„å–ä¸€ä¸ªä½ å–œæ¬¢çš„ç›®å½•åç§°.</p><h3 id="åˆå§‹åŒ–é¡¹ç›®"><a href="#åˆå§‹åŒ–é¡¹ç›®" class="headerlink" title="åˆå§‹åŒ–é¡¹ç›®"></a>åˆå§‹åŒ–é¡¹ç›®</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init</span><br></pre></td></tr></table></figure><p>å¡«å†™é¡¹ç›®ä¿¡æ¯.</p><p>æŸ¥çœ‹ä¸€ä¸‹ package.json</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat package.json</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;es6tutorials&quot;,</span><br><span class="line">  &quot;version&quot;: &quot;1.0.0&quot;,</span><br><span class="line">  &quot;description&quot;: &quot;Tutorial&quot;,</span><br><span class="line">  &quot;main&quot;: &quot;index.js&quot;,</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;keywords&quot;: [</span><br><span class="line">    &quot;es6&quot;,</span><br><span class="line">    &quot;.etc&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;author&quot;: &quot;mark.zhang&quot;,</span><br><span class="line">  &quot;license&quot;: &quot;MIT&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›®å½•ç»“æ„å¦‚ä¸‹</p><p><img src="/upload/images/2016/9/10/1.jpg" alt="1"></p><h3 id="å®‰è£…-babel-cli"><a href="#å®‰è£…-babel-cli" class="headerlink" title="å®‰è£… babel-cli"></a>å®‰è£… babel-cli</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev babel-cli</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥å…¨å±€å®‰è£…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install babel-cli -g</span><br></pre></td></tr></table></figure><p>å…¨å±€å®‰è£…ä¸Šåï¼Œä¼šå®‰è£…å¦‚ä¸‹å››ä¸ªç¨‹åºåˆ°å…¨å±€ç¯å¢ƒä¸­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">babel</span><br><span class="line">babel-node</span><br><span class="line">babel-doctor</span><br><span class="line">babel-external-helpers</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…-babel-core"><a href="#å®‰è£…-babel-core" class="headerlink" title="å®‰è£… babel-core"></a>å®‰è£… babel-core</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install babel-core --save</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…-ES2015-æ’ä»¶"><a href="#å®‰è£…-ES2015-æ’ä»¶" class="headerlink" title="å®‰è£… ES2015 æ’ä»¶"></a>å®‰è£… ES2015 æ’ä»¶</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install babel-preset-es2015</span><br></pre></td></tr></table></figure><p>ç¼–å†™é…ç½®æ–‡ä»¶ .babelrc</p><p>æ³¨æ„è¯¥æ–‡ä»¶æœ‰ä¸ªç‚¹ç¬¦å·.</p><p>åœ¨å·¥ç¨‹ç›®å½•ä¸‹æ–°å»ºè¯¥æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch .babelrc</span><br></pre></td></tr></table></figure><p>å†™å…¥å¦‚ä¸‹å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;presets&quot;: [</span><br><span class="line">      &quot;es2015&quot;,</span><br><span class="line">    ],</span><br><span class="line">    &quot;plugins&quot;: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–å†™æµ‹è¯•ä»£ç  tutorials.js</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">function test()</span><br><span class="line">&#123;</span><br><span class="line">    console.log(a);</span><br><span class="line">    var a = 0;</span><br><span class="line">&#125;</span><br><span class="line">test();</span><br><span class="line">var a = [];</span><br><span class="line">for (var i = 0; i &lt; 10; i++) &#123;</span><br><span class="line">  var c = i;</span><br><span class="line">  a[i] = function () &#123;</span><br><span class="line">    console.log(c);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line">a[6](); // 9</span><br><span class="line">var b = [];</span><br><span class="line">for (var i=0; i&lt;10; i++) &#123;</span><br><span class="line">    let c = i; //let æ˜¯ es6ä¸­çš„å…³é”®å­—</span><br><span class="line">    b[i] = function() &#123;</span><br><span class="line">        console.log(c)</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line">b[6]();</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">babel src/tutorials.js</span><br></pre></td></tr></table></figure><p>è¿è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">babel-node src/tutorials.js</span><br></pre></td></tr></table></figure><p><img src="/upload/images/2016/9/10/2.jpg" alt="1"></p><p>è¿™é‡Œå¯ä»¥ä¸‹è½½ <a href="https://github.com/veryitman/ES6Tutorials">å·¥ç¨‹æºç </a>.</p><h2 id="å…¶ä»–æ“ä½œ"><a href="#å…¶ä»–æ“ä½œ" class="headerlink" title="å…¶ä»–æ“ä½œ"></a>å…¶ä»–æ“ä½œ</h2><h3 id="1-å°†-ES6-è¯­æ³•çš„æ–‡ä»¶è½¬æ¢ä¸º-ES5-çš„è¯­æ³•"><a href="#1-å°†-ES6-è¯­æ³•çš„æ–‡ä»¶è½¬æ¢ä¸º-ES5-çš„è¯­æ³•" class="headerlink" title="1.å°† ES6 è¯­æ³•çš„æ–‡ä»¶è½¬æ¢ä¸º ES5 çš„è¯­æ³•"></a>1.å°† ES6 è¯­æ³•çš„æ–‡ä»¶è½¬æ¢ä¸º ES5 çš„è¯­æ³•</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">babel -d lib/ src/</span><br></pre></td></tr></table></figure><p>åœ¨ lib ç›®å½•ä¸‹ä¼šç”Ÿæˆ src ç›®å½•ä¸­å¯¹åº”çš„æ–‡ä»¶.</p><h3 id="2-è¿›å…¥äº¤äº’æ¨¡å¼"><a href="#2-è¿›å…¥äº¤äº’æ¨¡å¼" class="headerlink" title="2.è¿›å…¥äº¤äº’æ¨¡å¼"></a>2.è¿›å…¥äº¤äº’æ¨¡å¼</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">babel-node</span><br></pre></td></tr></table></figure><p>ä¸¤æ¬¡ ctrl+c é€€å‡º</p><h3 id="3-æ£€æŸ¥babelçŠ¶å†µ"><a href="#3-æ£€æŸ¥babelçŠ¶å†µ" class="headerlink" title="3.æ£€æŸ¥babelçŠ¶å†µ"></a>3.æ£€æŸ¥babelçŠ¶å†µ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">babel-doctor</span><br></pre></td></tr></table></figure><p>æ£€æŸ¥ä»¥ä¸‹å†…å®¹</p><ul><li><p>é…ç½®æ–‡ä»¶.babelrc</p></li><li><p>æ˜¯å¦æœ‰é‡å¤çš„babelå®‰è£…åŒ…ï¼Œæ¯”å¦‚è¯´å®‰è£…äº†5å’Œ6</p></li><li><p>babelå®‰è£…åŒ…æ˜¯å¦å·²ç»å‡çº§åˆ°äº†æœ€æ–°ç‰ˆ</p></li><li><p>npm &gt;&#x3D; 3.3.0</p></li></ul><p><img src="/upload/images/2016/9/10/3.jpg" alt="1"></p><h3 id="4-å¸è½½å…¨å±€çš„-babel-cli"><a href="#4-å¸è½½å…¨å±€çš„-babel-cli" class="headerlink" title="4.å¸è½½å…¨å±€çš„ babel-cli"></a>4.å¸è½½å…¨å±€çš„ babel-cli</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm uninstall --global babel-cli</span><br></pre></td></tr></table></figure><h2 id="æ„Ÿè°¢"><a href="#æ„Ÿè°¢" class="headerlink" title="æ„Ÿè°¢"></a>æ„Ÿè°¢</h2><ul><li><p><a href="https://babeljs.io/docs/usage/cli/">Babel comes with a built-in CLI which can be used to compile files from the command line.</a></p></li><li><p>é˜®ä¸€å³°è€å¸ˆçš„ <a href="https://www.gitbook.com/book/wohugb/ecmascript-6/details">ECMAScript 6å…¥é—¨</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> ReactNative </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ReactNative </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS: æ‰‹æœºæ˜¯å¦è®¾ç½®ç½‘ç»œä»£ç†</title>
      <link href="/2016/09/16/iOS-%E6%89%8B%E6%9C%BA%E6%98%AF%E5%90%A6%E8%AE%BE%E7%BD%AE%E7%BD%91%E7%BB%9C%E4%BB%A3%E7%90%86/"/>
      <url>/2016/09/16/iOS-%E6%89%8B%E6%9C%BA%E6%98%AF%E5%90%A6%E8%AE%BE%E7%BD%AE%E7%BD%91%E7%BB%9C%E4%BB%A3%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="æƒ…æ™¯"><a href="#æƒ…æ™¯" class="headerlink" title="æƒ…æ™¯"></a>æƒ…æ™¯</h2><p>é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­, ä¼šé‡åˆ°ä¸‹é¢è¿™æ ·ä¸€ç§æƒ…æ™¯:</p><blockquote><p>äº§å“æˆ–è€…è®¾è®¡åŒäº‹éœ€è¦ä½“éªŒç›®å‰äº§å“å¼€å‘çš„è¿›åº¦, ç„¶åè¦æ±‚å¼€å‘äººå‘˜, å°†ç°åœ¨çš„ç‰ˆæœ¬ç»™ä»–ä»¬ä½“éªŒ.<br>åšè¿‡ç¨‹åºå¼€å‘çš„äººéƒ½çŸ¥é“, å¼€å‘ç‰ˆæœ¬ä¼šæœ‰ä¸å°‘é—®é¢˜.<br>è¿™æ—¶, äº§å“å’Œè®¾è®¡åŒäº‹å°±ä¼šæŠ±æ€¨, æ€ä¹ˆç™»å½•ä¸äº†, è¿™é‡Œæ²¡æœ‰æ•°æ®äº†!<br>æœ‰ä¸ªå°ä¼™ä¼´è¢«æŠ˜è…¾çš„å®åœ¨å—ä¸äº†, è¿ç½‘é¡µéƒ½æ‰“ä¸å¼€äº†.<br>æœ€åæ‰¾åˆ°åŸå› :<br>ä»–æ‰‹æœºè¢«ä¹‹å‰çš„ç¨‹åºçŒ¿è®¾ç½®äº†ç½‘ç»œä»£ç†, ä»£ç†åˆ°ç¨‹åºçŒ¿å“¥å“¥çš„ç”µè„‘ä¸Šæ¥æŠ“åŒ…è°ƒè¯•é—®é¢˜, å¿˜è®°å–æ¶ˆè®¾ç½®äº†.</p></blockquote><p>å‡å¦‚å¯ä»¥åˆ¤æ–­å½“å‰æ‰‹æœºæ˜¯å¦è®¾ç½®äº†ç½‘ç»œä»£ç†, å°±å¯ä»¥å¾ˆå¥½åœ°è§£å†³ä¸Šé¢æƒ…æ™¯ä¸­æåˆ°çš„é—®é¢˜äº†.</p><h2 id="æ‰¾åˆ°çº¿ç´¢"><a href="#æ‰¾åˆ°çº¿ç´¢" class="headerlink" title="æ‰¾åˆ°çº¿ç´¢"></a>æ‰¾åˆ°çº¿ç´¢</h2><p>åœ¨ ASIHttpRequest ä¸­æ‰¾åˆ°å¦‚ä¸‹æ–¹æ³•:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)configureProxies</span><br><span class="line">&#123;</span><br><span class="line">// Have details of the proxy been set on this request</span><br><span class="line">if (![self isPACFileRequest] &amp;&amp; (![self proxyHost] &amp;&amp; ![self proxyPort])) &#123;</span><br><span class="line">// If not, we need to figure out what they&#x27;ll be</span><br><span class="line">NSArray *proxies = nil;</span><br><span class="line">// Have we been given a proxy auto config file?</span><br><span class="line">if ([self PACurl]) &#123;</span><br><span class="line">// If yes, we&#x27;ll need to fetch the PAC file asynchronously, so we stop this request to wait until we have the proxy details.</span><br><span class="line">[self fetchPACFile];</span><br><span class="line">return NO;</span><br><span class="line">// Detect proxy settings and apply them</span><br><span class="line">&#125; else &#123;</span><br><span class="line">#if TARGET_OS_IPHONE</span><br><span class="line">NSDictionary *proxySettings = [NSMakeCollectable(CFNetworkCopySystemProxySettings()) autorelease];</span><br><span class="line">#else</span><br><span class="line">NSDictionary *proxySettings = [NSMakeCollectable(SCDynamicStoreCopyProxies(NULL)) autorelease];</span><br><span class="line">#endif</span><br><span class="line">proxies = [NSMakeCollectable(CFNetworkCopyProxiesForURL((CFURLRef)[self url], (CFDictionaryRef)proxySettings)) autorelease];</span><br><span class="line">// Now check to see if the proxy settings contained a PAC url, we need to run the script to get the real list of proxies if so</span><br><span class="line">NSDictionary *settings = [proxies objectAtIndex:0];</span><br><span class="line">if ([settings objectForKey:(NSString *)kCFProxyAutoConfigurationURLKey]) &#123;</span><br><span class="line">[self setPACurl:[settings objectForKey:(NSString *)kCFProxyAutoConfigurationURLKey]];</span><br><span class="line">[self fetchPACFile];</span><br><span class="line">return NO;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">if (!proxies) &#123;</span><br><span class="line">[self setReadStream:nil];</span><br><span class="line">[self failWithError:[NSError errorWithDomain:NetworkRequestErrorDomain code:ASIInternalErrorWhileBuildingRequestType userInfo:[NSDictionary dictionaryWithObjectsAndKeys:@&quot;Unable to obtain information on proxy servers needed for request&quot;,NSLocalizedDescriptionKey,nil]]];</span><br><span class="line">return NO;</span><br><span class="line">&#125;</span><br><span class="line">// I don&#x27;t really understand why the dictionary returned by CFNetworkCopyProxiesForURL uses different key names from CFNetworkCopySystemProxySettings/SCDynamicStoreCopyProxies</span><br><span class="line">// and why its key names are documented while those we actually need to use don&#x27;t seem to be (passing the kCF* keys doesn&#x27;t seem to work)</span><br><span class="line">if ([proxies count] &gt; 0) &#123;</span><br><span class="line">NSDictionary *settings = [proxies objectAtIndex:0];</span><br><span class="line">[self setProxyHost:[settings objectForKey:(NSString *)kCFProxyHostNameKey]];</span><br><span class="line">[self setProxyPort:[[settings objectForKey:(NSString *)kCFProxyPortNumberKey] intValue]];</span><br><span class="line">[self setProxyType:[settings objectForKey:(NSString *)kCFProxyTypeKey]];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return YES;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¸ç ´é“é‹æ— è§…å¤„â€¦</p><p>åˆ¤æ–­ iphone æ˜¯å¦è®¾ç½®ç½‘ç»œä»£ç†çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">+ (BOOL)hasSetProxy</span><br><span class="line">&#123;</span><br><span class="line">    BOOL proxy = NO;</span><br><span class="line">    </span><br><span class="line">    NSDictionary *proxySettings = (__bridge NSDictionary *)(CFNetworkCopySystemProxySettings());</span><br><span class="line">    NSURL *url = [NSURL URLWithString:@&quot;http://www.baidu.com&quot;];</span><br><span class="line">    NSArray *proxies = (__bridge NSArray *)(CFNetworkCopyProxiesForURL((__bridge CFURLRef)(url),</span><br><span class="line">                                                                       (__bridge CFDictionaryRef)(proxySettings)));</span><br><span class="line">    MZLOG(@&quot;proxies:%@&quot;, proxies);</span><br><span class="line">    NSDictionary *settings = proxies[0];</span><br><span class="line">    MZLOG(@&quot;kCFProxyHostNameKey: %@&quot;, [settings objectForKey:(NSString *)kCFProxyHostNameKey]);</span><br><span class="line">    MZLOG(@&quot;kCFProxyPortNumberKey: %@&quot;, [settings objectForKey:(NSString *)kCFProxyPortNumberKey]);</span><br><span class="line">    MZLOG(@&quot;kCFProxyTypeKey: %@&quot;, [settings objectForKey:(NSString *)kCFProxyTypeKey]);</span><br><span class="line">    if ([[settings objectForKey:(NSString *)kCFProxyTypeKey] isEqualToString:@&quot;kCFProxyTypeNone&quot;]) &#123;</span><br><span class="line">        proxy = NO;</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        proxy = YES;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    return proxy;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç”¨æˆ·ä½“éªŒ"><a href="#ç”¨æˆ·ä½“éªŒ" class="headerlink" title="ç”¨æˆ·ä½“éªŒ"></a>ç”¨æˆ·ä½“éªŒ</h2><p>åˆ¤æ–­å¦‚æœè®¾ç½®äº†ä»£ç†, æç¤ºç”¨æˆ·, å¸®ä»–ç›´æ¥è·³åˆ° wifi è®¾ç½®ç•Œé¢.</p><p>ä¸‹é¢è¯´è¯´å¦‚ä½•è·³åˆ°ç³»ç»Ÿçš„ wifi è®¾ç½®ç•Œé¢.</p><p>1.é…ç½® URL TYPES</p><p><img src="/upload/images/2016/9/16/1.jpeg" alt="1"></p><p>æ³¨æ„è¿™é‡Œçš„é…ç½®æ˜¯ <code>prefs</code>.</p><p>2.openURL</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">NSString * urlString = @&quot;prefs:root=WIFI&quot;;</span><br><span class="line">NSURL *url = [NSURL URLWithString:urlString];</span><br><span class="line">UIApplication *app = [UIApplication sharedApplication];</span><br><span class="line">if ([app canOpenURL:[NSURL URLWithString:urlString]]) &#123;</span><br><span class="line"> </span><br><span class="line">    if ([[UIDevice currentDevice].systemVersion doubleValue] &gt;= 10.0) &#123;</span><br><span class="line">    </span><br><span class="line">    [app openURL:url options:@&#123;&#125; completionHandler:nil];</span><br><span class="line">    &#125; </span><br><span class="line">    else &#123;</span><br><span class="line">    </span><br><span class="line">    [app openURL:url];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦å¤–, è·³è½¬åˆ°ç³»ç»Ÿå…¶ä»–ç•Œé¢çš„ URL å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">1.ç³»ç»Ÿè®¾ç½®</span><br><span class="line">prefs:root=INTERNET_TETHERING</span><br><span class="line">2.WIFIè®¾ç½®</span><br><span class="line">prefs:root=WIFI</span><br><span class="line">3.è“ç‰™è®¾ç½®</span><br><span class="line">prefs:root=Bluetooth</span><br><span class="line">4.ç³»ç»Ÿé€šçŸ¥</span><br><span class="line">prefs:root=NOTIFICATIONS_ID</span><br><span class="line">5.é€šç”¨è®¾ç½®</span><br><span class="line">prefs:root=General</span><br><span class="line">6.æ˜¾ç¤ºè®¾ç½®</span><br><span class="line">prefs:root=DISPLAY&amp;BRIGHTNESS</span><br><span class="line">7.å£çº¸è®¾ç½®</span><br><span class="line">prefs:root=Wallpaper</span><br><span class="line">8.å£°éŸ³è®¾ç½®</span><br><span class="line">prefs:root=Sounds</span><br><span class="line">9.éšç§è®¾ç½®</span><br><span class="line">prefs:root=privacy</span><br><span class="line">10.æ‰“å¼€ APP Store</span><br><span class="line">prefs:root=STORE</span><br><span class="line">11.æ‰“å¼€ Notes</span><br><span class="line">prefs:root=NOTES</span><br><span class="line">12.æ‰“å¼€ Safari</span><br><span class="line">prefs:root=Safari</span><br><span class="line">13.æ‰“å¼€ Music</span><br><span class="line">prefs:root=MUSIC</span><br><span class="line">14.æ‰“å¼€ photo</span><br><span class="line">prefs:root=Photos</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS proxy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸ CSDN çš„è¯€åˆ«</title>
      <link href="/2016/09/10/%E4%B8%8E-CSDN-%E7%9A%84%E8%AF%80%E5%88%AB/"/>
      <url>/2016/09/10/%E4%B8%8E-CSDN-%E7%9A%84%E8%AF%80%E5%88%AB/</url>
      
        <content type="html"><![CDATA[<p>å†™è¿™ä¸ªè¯é¢˜, å†…å¿ƒè¿˜æ˜¯è›®æ²‰é‡çš„.</p><p>å‡ å¹´å‰ä¸ CSDN ä¸æœŸè€Œé‡, åœ¨é‡Œé¢å„ç§æŠ˜è…¾, ç¿»é˜…å¤§ç‰›ä»¬çš„åšå®¢, å†™è¯„è®º, ç”šè‡³æ‰“å°å‡ºæ¥. åœ¨æŠ€æœ¯è®ºå›ä¸åœåœ°â€çŒæ°´â€, è®¢é˜… CSDN æ‚å¿—, å‡†å¤‡ç»ƒå°±ä¸€èº«æ­¦è‰º.</p><p>äº’è”ç½‘çš„è“¬å‹ƒå‘å±•, è®©æˆ‘åŸæ¥ä¸å®‰çš„å¿ƒæœ‰äº†æ›´åŠ ç‹‚èºçš„å†²åŠ¨.</p><p>åœ¨æŸä¸ªå¤œæ·±äººé™çš„å¤œæ™š, å¼€å¯äº†å¥‹ç¬”ç–¾ä¹¦çš„å†ç¨‹, è¸ä¸Šäº† CSDN çš„åšå®¢ä¹‹æ—….<br>è¿™ä¹ˆå¤šå¹´ä»¥æ¥, CSDN å°±åƒæˆ‘çš„ä¸€ä¸ªæœ‹å‹, ä¸ç®¡æ˜¯å®¶é•¿é‡ŒçŸ­, è¿˜æ˜¯æŠ€æœ¯è®¨è®º, å„ç§å¿ƒé…¸, æˆ‘éƒ½ä¼šè®°å½•åœ¨é‚£é‡Œ.</p><p>ä¸€åšæŒå°±æ˜¯å‡ å¹´â€¦</p><p>å¦‚ä»Š, è¦ç¦»å¼€ CSDN çš„åšå®¢äº†, ä¸å‡†å¤‡åœ¨é‚£é‡Œç»§ç»­â€™è€•è€˜â€™äº†.<br>æ€»ç»“èµ·æ¥æœ‰å¦‚ä¸‹å‡ ä¸ªåŸå› :</p><blockquote><ol><li>æ–‡ç« è¢«ä»»æ„çš„è½¬è½½, æ²¡ç»è¿‡æœ¬äººçš„å…è®¸.æˆ‘åœ¨è®ºå›ä¹Ÿé—®è¿‡è¯¥äº‹, æ²¡æœ‰ä»»ä½•å›åº”, å¾ˆå¤±æœ›!</li><li>å¹¿å‘Šè¶Šæ¥è¶Šå¤š.</li><li>ç›¸æ¯”ä»¥å‰, å¾ˆéš¾æ‰¾åˆ°è®©äººæ»¡æ„çš„æœ‰è´¨é‡çš„æ–‡ç« .</li></ol></blockquote><p>å†è§, CSDN! è¯·åŸè°…æˆ‘çš„ä¸è¾è€Œåˆ«!</p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç”Ÿæ´» å†™ä½œ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
